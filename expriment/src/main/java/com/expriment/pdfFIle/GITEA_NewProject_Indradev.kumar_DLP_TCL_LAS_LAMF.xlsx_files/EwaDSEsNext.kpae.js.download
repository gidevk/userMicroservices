'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1109:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1110:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{constructor(b,e){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=e}tt(){return this.command}}Object(r.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[123])},1111:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1112:function(r,B,a){a.d(B,"a",function(){return"FieldInfoListContextLoaded"});a.d(B,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(B,"d",function(){return"Days from Today"});a.d(B,"g",function(){return"Years from Today"});a.d(B,"c",function(){return"Day of the Week"});a.d(B,"f",function(){return"Month of the Year"});a.d(B,"e",function(){return"End of Month"});a.d(B,"b",function(){return"Next Day"})},1113:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>
{c.a.ni(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1114:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}.DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1115:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);var c;(function(b){b[b.anyValue=0]="anyValue";b[b.wholeNumber=1]="wholeNumber";b[b.decimal=2]="decimal";b[b.list=3]="list";b[b.date=4]="date";b[b.time=5]="time";b[b.textLength=6]="textLength";b[b.custom=7]="custom"})(c||(c={}));Object(r.b)("DataValidationRuleType",c)},1117:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".ewa-facp-text-box{position:absolute}")}},1118:function(r,B,a){a.d(B,"b",function(){return"MinorThemeFont"});
a.d(B,"a",function(){return"MajorThemeFont"})},1120:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1121:function(r,B,a){a.d(B,"a",function(){return l});r=a(0);B=a(242);var c=a(5),b=a(33),e=a(11),f=a(21),d=a(35),h=a(4);class l extends B.a{constructor(k){super(document.createElement("div"));this.oR=this.yJa=this.xJa=this.zJa=this.BJa=this.AJa=!1;this.XI=null;this.visible=void 0;this.yqc=(w,n)=>{this.Ht(w,n)};this.wMa=()=>{this.gb.textBox.oF=!0};this.Fza=()=>{this.Ty(!0)};this.mCf=()=>{this.gb.textBox.focus()};this.Gg=()=>{f.h(this.$).inRangePicker||(this.ye=!1)};this.$=k;f.h(k)&&f.h(k).ha&&f.h(this.$).ha.vA(this.Gg);
this.jl=b.a.O4(k)}get bI(){return this.ku.bI}get ye(){return this.ku.ye}set ye(k){this.ku.ye=k}get gb(){return this.XI}set gb(k){(this.XI=k)&&this.XI.D3d.add(this)}get TNh(){return b.a.dN()?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(k){if(this.visible===k)return k;this.visible=k;return super.set_visible(k)}Ht(){this.LCa(!1);this.ku.Ht()}dispose(){this.$&&f.h(this.$)&&f.h(this.$).ha&&f.h(this.$).ha.TF(this.Gg);this.$=null;super.dispose()}Wh(k,
w,n=!1){k=!1;if((this.f2a||n)&&!this.Fxa()&&this.get_visible()&&this.ye)switch(this.jl&&this.PEc(w),w){case 1872288872:this.ye=!1;k=!0;break;case -798660877:this.ku.jB(1);k=!0;break;case 137938150:this.ku.jB(-1);k=!0;break;case 2091832999:this.ku.jB(this.bI-1);k=!0;break;case 742457698:this.ku.jB(-(this.bI-1));k=!0;break;case 125627505:k=this.Ty(!1);break;case 267796030:b.a.O4(this.$)&&(k=this.Ty(!1))}return k}LCa(k){if(this.ye||k){var w=f.h(this.$);k=w.domElement;var n=this.XI.textBox.domElement,
x=d.a(this.$).Jh(n.offsetHeight),m=d.a(this.$).Jh(n.offsetTop),u=d.a(this.$).Jh(n.offsetWidth);n=d.a(this.$).Jh(n.offsetLeft);w=w.Ul;var t=h.AFrameworkApplication.sa&&h.AFrameworkApplication.sa.Qa.kf,y=$get(this.$.Cb+c.a.i1a,this.$.domElement);t&&(y=document.getElementById("EditorContainer"));var v=new Sys.UI.Point(w?this.ku.acc:0,w?this.TNh:l.vbi);x=y.offsetTop+v.y+(b.a.dN()&&w?0:x+m);this.$.a_||(m=$get(c.a.Vsa,this.$.domElement),x+=m&&!t?m.offsetHeight:0);m=this.domElement;m.style.top=e.HelperMethods.zc(x);
n=y.offsetLeft+n+v.x;!b.a.dN()&&this.$.isChromeRtl?m.style.right=e.HelperMethods.zc(w?this.ku.acc:k.offsetLeft+k.offsetWidth-n-u):m.style.left=e.HelperMethods.zc(n)}}TTa(k){this.ku&&(k&&!this.oR?(this.ku.O9(this.mCf),this.ku.J0b(this.wMa),this.ku.xpb(this.Fza),this.oR=!0):this.oR&&(this.ku.Qda(this.mCf),this.ku.Ovc(this.wMa),this.ku.aLb(this.Fza),this.oR=!1))}PEc(k){switch(k){case -798660877:case 137938150:case 2091832999:case 742457698:this.AJa=!0;break;case 125627505:this.zJa=!0;break;case 267796030:b.a.O4(this.$)&&
(this.xJa=!0)}}}l.acc=0;l.vbi=1;Object(r.a)(l,"AutoCompleteControl",B.a,[278])},1122:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c extends Sys.EventArgs{constructor(b,e=0,f="",d=""){super();this.length=b;this.selectedIndex=e;this.aG=f;this.description=d}}Object(r.a)(c,"ListEventArgs",Sys.EventArgs,[])},1123:function(r,B,a){a.d(B,"a",function(){return m});r=a(0);var c=a(15),b=a(27);B=a(861);var e=a(791),f=a(5),d=a(73),h=a(33),l=a(12),k=a(1),w=a(120),n=a(21),x=a(936);class m extends B.a{constructor(u,
t){super(u,t,new x.a(e.a.listItem,e.a.uEb,e.a.xEb,e.a.yEb));this.mfc=!1;this.onb=this.ap=null;this.I0e=!1;this.visible=void 0;this.YBa(!0);this.I0e=k.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get acc(){if(h.a.dN()){var u=document.getElementById(this.$.Cb+f.a.H0e);return!this.I0e||u?l.DOMElementExtensions.getBoundingClientRect(u).x:0}u=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.wBd):document.getElementById(this.$.Cb+
f.a.wBd+"-"+f.a.azf);c.ULS.shipAssertTag(537170323,0,!!u||this.$.wF,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return u?u.offsetWidth:0}get oe(){return this.onb}set oe(u){this.onb=u}get ye(){return void 0!==this.visible?this.visible&&0<this.ap.length:(this.visible=l.DOMElementExtensions.isVisible(this.Nf))&&0<this.ap.length}set ye(u){this.visible!==u&&(l.DOMElementExtensions.setVisible(this.Nf,u),l.DOMElementExtensions.setVisible(this.uUa,u),this.visible=
u);const t=n.h(this.$).view;u?this.mfc||(t.Vs(this.zHa.yqc),this.mfc=!0):(this.ap.length=0,this.mfc&&(t.Xq(this.zHa.yqc),this.mfc=!1))}Xya(){var u=460;const t=n.h(this.$);var y=t.domElement,v=this.uUa.style;const A=this.Nf.offsetTop+this.Jj.offsetHeight*this.Jj.sectionRowIndex-this.Nf.scrollTop;v.width="auto";v.whiteSpace="nowrap";v.position="absolute";const z=y.offsetLeft+y.offsetWidth-(this.domElement.offsetLeft+this.Nf.offsetLeft+this.Nf.offsetWidth+3);y=this.domElement.offsetLeft-3-(y.offsetLeft+
this.acc);u=Math.min(this.uUa.offsetWidth,u,Math.max(z,y));l.DOMElementExtensions.Sv(this.uUa,u);v.whiteSpace="";v.position="absolute";A+3>this.Nf.offsetTop+this.Nf.offsetHeight||A<this.Nf.offsetTop||(u=this.Nf.offsetLeft-3-this.uUa.offsetWidth,v=this.Nf.offsetLeft+this.Nf.offsetWidth+3,l.DOMElementExtensions.updatePosition(this.uUa,y>z!==t.rtl?u:v,A,!1))}jB(u){super.jB(u);this.Xya()}Ht(){this.Xya()}Msa(){const u=this.An,t=this.Nf,y=3===d.a.zb||b.a.lp,v=y?this.qFb:this.bI;this.ye=!0;t.style.height=
"auto";this.zHa.set_visible(!0);this.apb(u,y);this.ap.length>v&&(l.DOMElementExtensions.SI(t,Math.floor(t.offsetHeight*v/this.ap.length)),t.style.overflowY="auto");l.DOMElementExtensions.Sv(t,u.offsetWidth+(this.ap.length>v?w.a.Ku:0))}}Object(r.a)(m,"AutoCompleteListBox",B.a,[])},1124:function(r,B,a){a.d(B,"a",function(){return n});r=a(0);var c=a(229),b=a(13),e=a(113),f=a(243);B=a(242);var d=a(751),h=a(5),l=a(52),k=a(12),w=a(77);class n extends B.a{constructor(x,m,u,t,y,v,A,z,C,H){super(document.createElement("a"));
this.ox=!1;this.jd=I=>{this.raiseEvent("ClickButton",I);return!0};this.onKeyDown=I=>{this.raiseEvent("KeyDown",I);return!1};this.Nw=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.GN=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=I=>{w.g(I);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=I=>{w.g(I);this.focused=!0;this.raiseEvent("Focus")};this.uvh=z;this.Iqh=C;this.aJ=n.ob(this.domElement,m,u,t,y,v,A,H);this.Gc.la("contextmenu",I=>{w.g(I)});this.enable();
this.focused=this.hovered=!1;x.appendChild(this.domElement)}AYc(x){this.get_events().addHandler("ClickButton",x)}qNd(x){this.get_events().removeHandler("ClickButton",x)}MYc(x){this.get_events().addHandler("KeyDown",x)}DNd(x){this.get_events().removeHandler("KeyDown",x)}W0b(x){this.get_events().addHandler("PointerOver",x)}NNd(x){this.get_events().removeHandler("PointerOver",x)}V0b(x){this.get_events().addHandler("PointerOut",x)}MNd(x){this.get_events().removeHandler("PointerOut",x)}gpb(x){this.get_events().addHandler("Blur",
x)}LKb(x){this.get_events().removeHandler("Blur",x)}O9(x){this.get_events().addHandler("Focus",x)}Qda(x){this.get_events().removeHandler("Focus",x)}get Gl(){return this.aJ}get isEnabled(){return this.ox}enable(){this.domElement&&(this.domElement.classList.remove(d.a.lU),this.domElement.style.cursor="",c.a.instance.ta(b.a.click,this.domElement,this.jd),e.KeyInputManager.instance.ta(b.a.Vb,this.domElement,this.onKeyDown),f.a.instance.ta(b.a.pointerOver,this.domElement,this.Nw),f.a.instance.ta(b.a.pointerOut,
this.domElement,this.GN),this.Gc.Mi("blur")||this.Gc.la("blur",this.onBlur),this.Gc.Mi("focus")||this.Gc.la("focus",this.onFocus),this.domElement.title=this.uvh,this.ox=!0)}disable(){this.domElement&&(this.domElement.classList.add(d.a.lU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Aa(b.a.click,this.domElement,this.jd),e.KeyInputManager.instance.Aa(b.a.Vb,this.domElement,this.onKeyDown),f.a.instance.Aa(b.a.pointerOver,this.domElement,this.Nw),f.a.instance.Aa(b.a.pointerOut,this.domElement,
this.GN)),this.domElement.title=this.Iqh,this.ox=!1)}dispose(){this.isEnabled&&(c.a.instance.Aa(b.a.click,this.domElement,this.jd),e.KeyInputManager.instance.Aa(b.a.Vb,this.domElement,this.onKeyDown),f.a.instance.Aa(b.a.pointerOver,this.domElement,this.Nw),f.a.instance.Aa(b.a.pointerOut,this.domElement,this.GN),this.ox=!1);k.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static ob(x,m,u,t,y,v,A,z){x.removeAttribute("Href");x.setAttribute(h.a.Jd,h.a.Ws);x.className=m;x.tabIndex=
z;m=document.createElement("span");m.className=A;m.classList.add(u);m.tabIndex=-1;x.appendChild(m);x=document.createElement("img");x.src=l.a.Le(t);x.className=y;x.alt=v;x.tabIndex=-1;m.appendChild(x);return x}}Object(r.a)(n,"ListButton",B.a,[287,3])},1125:function(r,B,a){a.d(B,"a",function(){return d});r=a(0);var c=a(124),b=a(28),e=a(1),f=a(562);class d{constructor(k){this.lyf=k;this.hW=Object.assign({},l);this.avb=[];this.boc=-1;(this.kyf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&
k&&(this.hW.countAboveThresholds={},k.forEach(w=>this.hW.countAboveThresholds[w]=0))}static get XZd(){return b.a.Ya.ze.m}KTa(){this.boc=d.XZd}N3(k,w=null){if(-1!==this.boc||Object(f.b)(w))k?(this.Yob(d.XZd-(w||this.boc)),this.boc=-1):this.hW.failedCount++}xZe(){this.hW.excludingFirstAction=d.wZe(this.avb);this.avb.push(this.hW.firstAction);this.hW.includingFirstAction=d.wZe(this.avb)}Yob(k){this.hW.count?1E3>this.hW.count&&this.avb.push(k):this.hW.firstAction=k;this.kyf&&this.lyf&&this.lyf.forEach(w=>
{k>w&&this.hW.countAboveThresholds[w]++});this.hW.count++}static wZe(k){const w=Object.assign({},h);0<k.length&&(c.i(k),w.median=k[Math.floor(.5*k.length)],w.P75=k[Math.floor(.75*k.length)],w.P95=k[Math.floor(.95*k.length)],w.max=k[k.length-1],w.average=c.g(k,n=>n)/k.length);return w}}Object(r.a)(d,"PerformanceMeasurement",null,[]);const h={average:0,max:0,median:0,P75:0,P95:0},l={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},h),excludingFirstAction:Object.assign({},
h)}},1172:function(r,B,a){function c(aa){var Xa=Object(I.h)(aa),Lb=Object(P.a)(aa);const kc=Xa.Mh;var Nc=Xa.oc.Rmf;Nc=Xa.Ul||Nc&&Lb;Lb=b((Nc?Lb:kc).textBox.domElement);if(Nc)Xa={top:0,left:0,right:innerWidth,bottom:innerHeight};else if(Xa=b(Xa.domElement),{zoom:aa}=Object(D.a)(aa),1!==aa)for(const ad of[Lb,Xa])for(const sd in ad)ad[sd]*=aa;return{target:Lb,bounds:Xa}}function b(aa){const {top:Xa,left:Lb,right:kc,bottom:Nc}=aa.getBoundingClientRect();return{top:Xa,left:Lb,right:kc,bottom:Nc}}function e(aa){var Xa;
if(aa){var Lb=new zc(0===aa.kind);aa=null===(Xa=null===aa||void 0===aa?void 0:aa.rangeInfo)||void 0===Xa?void 0:Xa.positionKindInfo;if(!aa)return Lb;Lb.uF=0===aa.firstRow;Lb.tF=0===aa.firstColumn;Lb.pK=0===aa.secondRow;Lb.oK=0===aa.secondColumn;return Lb}}var f={};a.r(f);a.d(f,"FormulaAssistanceReadoutHandler",function(){return ma});var d=a(9),h=a(0),l=a(714),k=a(50),w=a(38),n=a(15),x=a(18),m=a(391),u=a(73);class t{}t.Icd="!";t.zNf="[";t.yNf="]";t.openParen="(";t.closeParen=")";t.Bqg=" /.(*\\".split("");
t.$9b="...";t.uIb="param_help_link";t.iHd="param_help_udf";t.Cfd="function_list_box";t.POh="function_param_box";t.Efd="function_reader_description";t.xfd="function_description_box";t.$0e="function_param_table";t.$7i="param_row_";t.xsc="param_set";t.jOf="param_row_0";t.kOf="param_row_1";t.QOh="<div id='{0}' class='{1}'></div>";t.OOh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";t.lOf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";
t.MOh="<div id='{0}' class='{1} {2} {3}'></div>";t.IOh="<div id='{0}' class='{1} {2} {3} {4}'></div>";t.Xdh=1;t.Wdh=3;t.boh=500;t.Fxf=50;Object(h.a)(t,"FormulaAssistanceConstants",null,[]);var y=a(14),v=a(292),A=a(8),z=a(5),C=a(96),H=a(11),I=a(21),S=a(362),P=a(121),D=a(35),G=a(54),E=a(153),O=a(1);const N=(aa,Xa,Lb)=>{if(aa){const kc=aa.da.Ba(491);kc?kc.pJ("lm"):n.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");Lb?
W(aa,Xa,Lb):(Lb=new C.a(-859308420,u.a.zb,aa.xc,0,null),aa.Ia.Hb(Lb,{[u.a.Pc]:z.a.mV,[u.a.Sf]:"HelpID="+Xa}))}},J=(aa,Xa,Lb)=>{const kc={};kc[z.a.VJ]=Xa;Xa={};Xa.FunctionName=Lb;kc[z.a.mdd]=Xa;aa.Yc(802602464,0,8,kc)},W=(aa,Xa,Lb)=>{if(Lb){if(Xa&&(!Xa||Xa.startsWith("http://")||Xa.startsWith("https://"))){if(O.EwaSettings.xa(147)){let kc;if(O.EwaSettings.isChangeGateEnabled("OfficeVSO:7574381_RemoveResolveSyncV2"))kc=E.a.gK(G.K);else try{kc=E.a.ZAa(G.K)}catch(Nc){}if(kc&&kc.GCa(Xa))return}H.HelperMethods.nf(Xa,
"_blank",S.a)}}else H.HelperMethods.bW(aa.pG,"XLWAEndUser_"+Xa,aa.wS)},ea=aa=>{let Xa=A.a.E_;const Lb=aa.da.Ba(368);Lb&&!Object(I.h)(aa).Ul&&(Xa=Lb.zoom);return Xa};var R=a(271),Y=a(4),U=a(31),da=a(562);class T{constructor(aa){this.$=aa;this.Cae={};this.Gcb={};this.iee=void 0;this.MTg=y.a.instance.ga(1033);this.vLd=y.a.instance.ga(1034);this.OGe=y.a.instance.ga(1032);this.JOh="InsertFunctionDialog";this.tVf="recentlyUsedFunctions";this.WLi=15;this.Mji=()=>{this.Nfa=this.$.da.Ba(19);this.Nfa.VJa({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.gPe(this.Nji,this.fki,this.wji)};this.fki=()=>{if(this.hmf){this.Edf=this.p_h();this.Gcb=JSON.parse(this.localStorage.vLa(this.tVf));this.Gcb||(this.Gcb={});const Xa=this.Gcb[this.Edf];Xa&&(Array.isArray(Xa)&&Xa.every(this.Kti)?this.zAa=Xa:L("initRecentlyUsedFunctions: Recently used functions are not an array of numbers as expected"))}this.zAa||(this.zAa=this.Nfa.rLa(this.OGe).map(ka))};this.Nji=()=>{this.A1b=this.Nfa.kcc.filter(this.Omf);this.A1b.forEach(Xa=>
{this.Cae[Xa.FunctionIndex]=Xa})};this.wji=()=>{this.categories=this.functionInfoManager.Twb.filter(Xa=>Xa!==this.OGe);this.categories.unshift(this.vLd)};this.$dj=Xa=>{this.zAa?(this.zAa=this.zAa.filter(Lb=>Lb!==Xa).slice(0,this.WLi-1),this.zAa.unshift(Xa),this.hmf&&(this.Gcb[this.Edf]=this.zAa,this.localStorage.xNb(this.tVf,JSON.stringify(this.Gcb)))):L("pushFunctionToRecentlyUsed: Recently used functions array was not initialized.")};this.Omf=Xa=>!this.Nfa.ojc(Xa);this.gPe=(...Xa)=>{if(this.Nfa.wV)Xa.forEach(Lb=>
Lb());else{const Lb=()=>{this.Nfa.cdb(Lb);Xa.forEach(kc=>{kc()})};this.Nfa.QGa(Lb)}};this.p_h=()=>{const Xa=Y.AFrameworkApplication.fa.Wa("LoggableUserId");return Xa?U.a.mu(Xa).toString():"0"};this.Kti=Xa=>"number"===typeof Xa&&Object(da.b)(this.functionInfoManager.jid(Xa));this.localStorage=new R.a;this.hmf=this.localStorage.Me();this.Mji()}static instance(aa){this.Ma||(this.Ma=new T(aa));return this.Ma}get functionInfoManager(){return this.Nfa}get KOh(){return this.Cae}get Twb(){return this.categories}get LLh(){var aa;
return null!==(aa=this.iee)&&void 0!==aa?aa:this.vLd}rLa(aa){this.iee=aa;return aa===this.vLd?this.zAa:this.Nfa.rLa(aa).filter(this.Omf).map(ka)}nKh(aa=""){aa=aa.toLocaleLowerCase();const Xa=this.A1b.filter(({NameUI:Lb})=>Lb.toLocaleLowerCase().startsWith(aa));3<=aa.length&&(Xa.push(...this.A1b.filter(Lb=>Lb.NameUI.toLocaleLowerCase().includes(aa)&&!Xa.includes(Lb))),Xa.push(...this.A1b.filter(Lb=>Lb.Help.toLocaleLowerCase().includes(aa)&&!Xa.includes(Lb))));return Xa.map(ka)}}Object(h.a)(T,"FunctionDialogUtils",
null,[]);const ka=aa=>aa.FunctionIndex,L=aa=>{n.ULS.sendTraceTag(509670041,0,10,`FunctionDialogUtils.${aa}`)};var fa=a(272),wa=a(22),oa;(function(aa){aa.functionInfo="functionInfo";aa.giveFeedbackCallback="giveFeedbackCallback";aa.listSeparator="listSeparator"})(oa||(oa={}));Object(h.b)("SignatureDialogPropKeys",oa);class xa extends v.a{static show(aa,Xa){aa=T.instance(Xa).functionInfoManager.jid(aa);new xa(aa,Xa)}constructor(aa,Xa){super(Xa);this.functionInfo=aa;this.Esg=(Lb,kc)=>{1===Lb?(this.hide(),
Lb=new C.a(1117706454,0,this.$.xc,8,null),this.$.Ia.Hb(Lb,{[Aa.jcc]:kc.selectedFunctionInfo,["argumentsDialogSource"]:2})):2===Lb&&(this.hide(),kc=new C.a(753860909,0,this.$.xc,8,null),this.$.Ia.Hb(kc,{qNf:!0}))};this.tEd=Lb=>{this.hide();J(this.$,"functionSignatureDialog",Lb)};this.ll=y.a.instance.ga(1035);this.fpd()}fpd(){this.initializeAndShow(this.ll,this.Esg,{[xa.pt]:this.pc,[oa.functionInfo]:this.functionInfo,[oa.giveFeedbackCallback]:this.tEd.bind(this),[oa.listSeparator]:this.$.listSeparator})}get pc(){return"FunctionSignatureDialog"}}
Object(h.a)(xa,"FunctionSignatureDialog",v.a,[]);var bb=a(639);class Za{constructor(aa){this.P4=!1;this.uZg=()=>{this.P4?this.HEb("blockGrid: Called blockGrid when grid is already blocked."):(this.vba.addEventListener("mousedown",this.nB,!0),this.vba.addEventListener("touchend",this.Gz,!0),this.vba.addEventListener("contextmenu",this.nB,!0),this.vba.addEventListener("focus",this.P0d),this.P4=!0)};this.P0d=()=>{this.P4&&(this.vba.removeEventListener("mousedown",this.nB,!0),this.vba.removeEventListener("touchend",
this.Gz,!0),this.vba.removeEventListener("contextmenu",this.nB,!0),this.vba.removeEventListener("focus",this.P0d),this.P4=!1)};this.nB=Xa=>{this.IPa(Xa,Xa.button===Sys.UI.MouseButton.leftButton)};this.Gz=Xa=>{this.IPa(Xa,!0)};this.IPa=(Xa,Lb)=>{if(this.rangePickerController.twi&&Lb)return!1;Xa.stopPropagation();Xa.preventDefault();return!0};this.HEb=Xa=>{n.ULS.sendTraceTag(509211348,0,10,`GridInteractionBlocker.${Xa}`)};this.vba=I.h(aa).domElement;this.rangePickerController=bb.a.E5a(aa)}static c_h(aa){this._singleton||
(this._singleton=new Za(aa));return this._singleton}}Object(h.a)(Za,"GridInteractionBlocker",null,[]);var La;(function(aa){aa[aa.FunctionsDialog=0]="FunctionsDialog";aa[aa.RibbonButton=1]="RibbonButton";aa[aa.SignatureDialog=2]="SignatureDialog"})(La||(La={}));Object(h.b)("ArgumentsDialogSource",La);class va extends v.a{static show(aa,Xa,Lb,kc,Nc){new va(aa,Xa,Lb,kc,Nc)}constructor(aa,Xa,Lb,kc,Nc){super(aa);this.functionInfo=Xa;this.formulaAuthoringHelper=Lb;this.Hcg=kc;this.zWg=Nc;this.ksd=O.EwaSettings.isChangeGateEnabled("OfficeVSO:7640464_blockGridDuringArgumentsDialog");
this.FOh=(ad,sd)=>{var ce;this.hide();if(1===ad){ad=this.functionInfo.NameUI;for(sd=null!==(ce=sd.functionArgs)&&void 0!==ce?ce:[];1<sd.length&&wa.a.ah(sd[sd.length-1]);)sd.pop();ce={[u.a.Pc]:ad,["functionArgs"]:sd,["ibdk"]:!0};sd=new C.a(-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(sd,ce)}else if(2===ad)switch(this.zWg){case La.FunctionsDialog:ce=new C.a(753860909,0,this.$.xc,8,null);this.$.Ia.Hb(ce,{qNf:!0});break;case La.SignatureDialog:xa.show(this.functionInfo.FunctionIndex,this.$)}};this.bW=
()=>W(this.$,this.functionInfo.HelpId,!1);this.WZh=()=>this.formulaAuthoringHelper.hasRepeatingParams(this.functionInfo)?ad=>this.formulaAuthoringHelper.getFunctionParamByIndex(this.Hcg,this.functionInfo,ad):void 0;this.feedbackCallback=ad=>J(this.$,"functionArgumentsDialog",ad);this.ll=y.a.instance.ga(1035);this.rangePickerController=Object(I.h)(this.$).Ng.E5a();this.ksd&&(this.Raf=Za.c_h(aa));this.tg()}get pc(){return"FunctionArgumentsDialog"}tg(){this.Rb=1;this.Dq={[fa.a.pt]:this.pc,["functionInfo"]:this.functionInfo,
["initialArgs"]:this.formulaAuthoringHelper.getMinimalParamArray(this.Hcg,this.functionInfo),["generateArgByIndex"]:this.WZh(),["helpCallback"]:this.bW,["giveFeedbackCallback"]:this.feedbackCallback,["isModal"]:!1,["rangePickerController"]:this.rangePickerController};this.ksd&&this.Raf.uZg();this.initializeAndShow(this.ll,this.FOh,this.Dq)}hide(){this.ksd&&this.Raf.P0d();O.EwaSettings.isChangeGateEnabled("OfficeVSO:7428201_supportStopRangePickerWithoutSupplyingTextboxId")&&this.rangePickerController.disposeRangePicker(void 0);
super.hide()}}Object(h.a)(va,"FunctionArgumentsDialog",v.a,[]);var Ba;(function(aa){aa.CategoryList="categoryList";aa.FunctionsMap="functionsMap";aa.FunctionIdsToDisplay="functionIdsToDisplay";aa.RefreshListCallback="refreshListCallback";aa.HelpCallback="helpCallback";aa.feedbackCallback="giveFeedbackCallback";aa.InitialCategory="initialCategory";aa.AllCategoryName="allFunctionsCategoryName"})(Ba||(Ba={}));Object(h.b)("PropsKeys",Ba);class Ea extends v.a{static show(aa){new Ea(aa)}constructor(aa){super(aa);
this.U0e=(Xa,Lb)=>{if(1===Xa){this.hide();Lb=Lb.functionName;Xa=this.functionInfoManager.o5e(Lb);Lb={[Aa.jcc]:Xa,["ibdk"]:!0,["argumentsDialogSource"]:0,[u.a.Pc]:Lb};const kc=new C.a(0<Xa.Params.length?1117706454:-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(kc,Lb);this.utils.$dj(Xa.FunctionIndex)}};this.fpd=()=>{const Xa=this.utils.LLh;this.Dq={[Ea.pt]:this.pc,[Ba.CategoryList]:this.utils.Twb,[Ba.FunctionsMap]:this.utils.KOh,[Ba.FunctionIdsToDisplay]:this.utils.rLa(Xa),[Ba.RefreshListCallback]:this.KZi.bind(this),
[Ba.feedbackCallback]:this.tEd.bind(this),[Ba.HelpCallback]:this.qgi,[Ba.InitialCategory]:Xa,[Ba.AllCategoryName]:this.utils.MTg};this.initializeAndShow(this.ll,this.U0e,this.Dq)};this.qgi=Xa=>{W(this.$,Xa,!1)};this.tEd=Xa=>{this.hide();J(this.$,this.utils.JOh,Xa)};this.ll=y.a.instance.ga(1035);this.utils=T.instance(aa);this.tg()}get pc(){return"FunctionDialog"}get functionInfoManager(){return this.utils.functionInfoManager}tg(){this.Rb=1;this.utils.gPe(this.fpd)}O4j(aa){this.Dq[Ba.FunctionIdsToDisplay]=
aa;this.LUa(this.ll,this.G5a(this.U0e),this.Dq)}KZi(aa,Xa){aa=Xa?this.utils.nKh(Xa):this.utils.rLa(aa);this.O4j(aa)}}Object(h.a)(Ea,"FunctionDialog",v.a,[]);var pa=a(58),$a=a(75),cb=a(33),ib=a(91),ta=a(27),Ya=a(218),Da=a(76),ba=a(114),ya=a(231),V=a(52),Z=a(754),ja=a(12),la=a(77);const ua=Da.a.Ryh,eb=Da.a.$yh,Eb=Da.a.azh,Wb=Da.a.NTe,Ab=Da.a.Tyh,Jb=Da.a.Vyh,Gb=Da.a.HTe,Nb=Da.a.QTe,Ja=Da.a.Uyh,ab=Da.a.KTe;class wb extends Ya.a{constructor(aa,Xa){super(aa,y.a.instance.ga(1035),void 0,void 0,void 0,O.EwaSettings.xa(350));
this.Vwb=this.qtf=this.b1e=this.Z0e=this.Pja=this.Y0e=this.Xwb=this.PKa=this.Qja=this.QKa=null;this.dnd=!1;this.Nzb=this.VFb=this.i4b=null;this.onFunctionInfoLoaded=()=>{if(!this.PKa.count){const Lb=this.functionInfoManager.Twb;for(let kc=0,Nc=Lb.length;kc<Nc;++kc)this.PKa.qY(Lb[kc],Lb[kc],!1).className=Da.a.Syh;this.PKa.selectedIndex=0;ib.a.sc([this.i4b,this.VFb,this.Nzb]);this.i4b=this.Fe.qe(this.QKa);this.VFb=this.Fe.qe(this.Qja);this.Nzb=this.Fe.qe(this.Vwb);this.i4b.la("change",this.HFf);this.VFb.la("change",
this.mXi);this.VFb.la("dblclick",this.nXi);this.Nzb.la("click",this.Zca);this.Nzb.la("keyup",this.qZi);ja.DOMElementExtensions.setVisible(this.Qja,!0);ja.DOMElementExtensions.setVisible(this.Y0e,!1);this.$.R8c&&ja.DOMElementExtensions.setVisible(this.qtf,!0)}this.HFf(null);this.getButton(0).get_element().disabled=!1;this.QKa.disabled=!1;this.GSa();this.dnd=!0};this.Zca=()=>{this.naa&&N(this.$,this.naa.HelpId,this.naa.IsDynamicUdf)};this.qZi=Lb=>{13!==Lb.keyCode&&32!==Lb.keyCode||this.Zca(Lb)};this.HFf=
()=>{const Lb=this.functionInfoManager.rLa(this.PKa.oe.value);this.F4a(Lb);this.Qja.scrollTop=0;this.W6f()};this.mXi=()=>{this.W6f()};this.nXi=Lb=>{this.naa&&(la.g(Lb),this.close(0))};this.Wc=(Lb,kc)=>{ya.b(kc)&&this.lv()};this.functionInfoManager=aa.da.Ba(19);this.formulaAssistanceControl=aa.da.Ba(221);if(this.Mwb=cb.a.vV(this.$))this.formulaAssistanceManager=aa.da.Ba(464);this.kQ=Xa}get pc(){return"FunctionDeprecatedDialog"}get naa(){if(!this.Qja||!this.Qja.firstChild)return null;const aa=Number.parseInvariant(this.Qja.children[this.Qja.selectedIndex].value);
return this.functionInfoManager.jid(aa)}initialize(){this.Pb.classList.add(Da.a.Qyh);if(O.EwaSettings.isChangeGateEnabled("OfficeVSO:7262176_FunctionDeprecatedDialogReduceInnerHtml")){var aa=document.createElement("div");aa.classList.add(Da.a.GTe);var Xa=document.createElement("label");Xa.setAttribute("for",wb.wfd);Xa.innerText=y.a.instance.ga(1038)+" ";aa.appendChild(Xa);Xa=document.createElement("select");Xa.id=wb.wfd;Xa.classList.add(ua);Xa.setAttribute("disabled","true");aa.appendChild(Xa);this.Pb.appendChild(aa);
aa=document.createElement("div");aa.classList.add(ba.a.Sn);aa.innerText=y.a.instance.ga(1039);this.Pb.appendChild(aa);aa=document.createElement("div");aa.classList.add(Da.a.FTe);Xa=document.createElement("select");Xa.id=wb.X0e;Xa.classList.add(eb,ta.a.Cw?Eb:null,x.a.uo,x.a.vo);Xa.size=7;aa.appendChild(Xa);Xa=document.createElement("div");Xa.classList.add(Jb);Xa.innerText=y.a.instance.ga(736);aa.appendChild(Xa);this.Pb.appendChild(aa);aa=document.createElement("div");aa.classList.add(Da.a.ITe);Xa=
document.createElement("div");Xa.classList.add(ab);Xa.style.direction="ltr";var Lb=document.createElement("span");Lb.classList.add(Ja,x.a.uo);const kc=document.createElement("span");kc.classList.add(x.a.kv,Da.a.JTe);const Nc=document.createElement("img");Nc.title=y.a.instance.nb(3);Nc.classList.add(x.a.DWe);Nc.src=V.a.Le(13);kc.appendChild(Nc);Lb.appendChild(kc);Xa.appendChild(Lb);Lb=document.createElement("span");Lb.id=wb.zfd;Lb.classList.add(Nb);Xa.appendChild(Lb);Lb=document.createElement("a");
Lb.tabIndex=0;Lb.title=y.a.instance.ga(1040);Lb.classList.add(Ab);Xa.appendChild(Lb);Lb=document.createElement("span");Lb.id=wb.icc;Xa.appendChild(Lb);aa.appendChild(Xa);Xa=document.createElement("div");Xa.classList.add(Gb);Xa.id=wb.yfd;aa.appendChild(Xa);this.Pb.appendChild(aa)}else this.Pb.innerHTML=wb.dH();this.Mf||(this.Bt(),this.Csa());super.initialize();aa=ja.DOMElementExtensions.hk(this.Pb,ab);this.rtl&&(aa.align="right",this.Vwb.style.marginLeft="5px");this.Mf&&(aa.style.padding="1px");this.functionInfoManager.VJa({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&(this.functionInfoManager.cdb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.pk(this.Wc));ib.a.sc([this.i4b,this.VFb,this.Nzb,this.PKa,this.Xwb]);super.dispose()}Bt(){this.QKa=ja.DOMElementExtensions.hk(this.Pb,ua);this.Qja=ja.DOMElementExtensions.hk(this.Pb,eb);this.QKa.setAttribute(z.a.Jd,z.a.f2b);this.PKa=new Z.a(this.QKa,!0);this.Xwb=new Z.a(this.Qja,!0);this.Y0e=ja.DOMElementExtensions.hk(this.Pb,Jb);this.Vwb=
ja.DOMElementExtensions.hk(this.Pb,Ab);this.b1e=ja.DOMElementExtensions.hk(this.Pb,Nb);this.qtf=ja.DOMElementExtensions.hk(this.Pb,Ja);this.Z0e=$get(wb.icc,this.Pb);this.Pja=ja.DOMElementExtensions.hk(this.Pb,Gb);this.Mf&&(this.Pja.style.paddingLeft="1px");this.functionInfoManager.QGa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Oj(this.Wc)}TQ(aa){this.$.da.hb(40,()=>{this.PKa.TQ(aa)})}fq(){this.Mwb?this.formulaAssistanceManager.b9b():this.formulaAssistanceControl.set_visible(!1);super.fq();
this.dnd||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.QKa.disabled&&this.dnd&&ja.DOMElementExtensions.setFocus(this.QKa)}commit(){return!0}Lsb(){let aa=this.naa.NameDataStrings;const Xa=new C.a(-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(Xa,{[u.a.Pc]:aa,["ibdk"]:!0})}rta(){this.Mwb?this.formulaAssistanceManager.Xda():this.formulaAssistanceControl.wqb()}F4a(aa){this.Xwb.clear();const Xa=wb.icc+" "+wb.yfd;for(let Lb=0,kc=aa.length;Lb<kc;++Lb){const Nc=this.Xwb.qY(aa[Lb].NameUI,aa[Lb].FunctionIndex.toString(),
!1);ta.a.Cw&&Nc.classList.add(Wb);Nc.setAttribute(z.a.dM,wb.zfd);Nc.setAttribute(z.a.WG,Xa)}this.Xwb.selectedIndex=0}W6f(){if(this.naa){this.Vwb.parentNode.className=Da.a.KTe+(this.functionInfoManager.ojc(this.naa)?"-udf":"");var aa=this.naa.NameDataStrings;this.b1e.innerText=aa;this.Vwb.innerText=aa;this.Pja.innerText=this.naa.Help;aa=this.naa.Params.split(t.Icd);this.Z0e.innerText=t.openParen+(1<aa.length?t.$9b:aa[0])+t.closeParen}}static dH(){return String.format("<div class='"+Da.a.GTe+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+
ba.a.Sn+"'>{1}</div>\r\n<div class='"+Da.a.FTe+"'>\r\n\t<select id='{16}' class='{17} "+x.a.uo+" "+x.a.vo+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Da.a.ITe+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+x.a.uo+"'>\r\n\t\t\t<span class='"+x.a.kv+" "+Da.a.JTe+"'>\r\n\t\t\t\t<img title='{3}' class='"+x.a.DWe+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
y.a.instance.ga(1038),y.a.instance.ga(1039),y.a.instance.ga(736),y.a.instance.nb(3),V.a.Le(13),y.a.instance.ga(1040),wb.wfd,wb.icc,7,ua,Ab,Jb,Gb,Nb,Ja,ab,wb.X0e,eb+(ta.a.Cw?" "+Eb:""),wb.yfd,wb.zfd)}}wb.icc="function_dialog_param_string";wb.yfd="function_dialog_function_description";wb.zfd="function_dialog_function_name";wb.X0e="function_list";wb.wfd="function_category";Object(h.a)(wb,"FunctionDeprecatedDialog",Ya.a,[]);var xb=a(7),rb=a(273),za=a(44);class Aa{constructor(aa,Xa,Lb){this.$=aa;this.Xa=
Xa;this.functionInfoManager=Lb;this.LOh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.LOh.includes(this.menuId)&&this.frame.jx(this.menuId)};this.vV=cb.a.vV(this.$);this.kCb=cb.a.Gmf();this.Q7a=O.EwaSettings.isChangeGateEnabled("OfficeVSO:7561900_InsertFunctionPositionBugFix");this.vV&&(this.formulaAssistanceManager=this.$.da.Ba(464));this.BY=
{};this.frame=this.$.frame;this.functionInfoManager.QGa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=aa.da.Ba(491)}Mc(aa,Xa){switch(Xa){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return aa=I.h(this.$).Mh,aa.N6a||!aa.eb||0>=aa.text.length?!1:!0;default:return!1}}executeCommand(aa,Xa,
Lb){var kc,Nc;Xa=Xa.command;aa=I.h(this.$);const ad=aa.Mh;switch(Xa){case 753860909:case -2060563418:this.Q7a&&!Lb.qNf&&this.WAe();null===(kc=this.formulaAssistanceManager)||void 0===kc?void 0:kc.b9b();aa.inRangePicker&&ad.CE(!1);this.kCb?Ea.show(this.$):(new wb(this.$,ad)).fg();this.formulaAssistanceTelemetryManager.y4a.dialogShownCounter++;break;case 1117706454:null===(Nc=this.formulaAssistanceManager)||void 0===Nc?void 0:Nc.b9b();aa.inRangePicker&&ad.CE(!1);void 0===Lb.argumentsDialogSource&&(Lb.argumentsDialogSource=
1,Lb[Aa.jcc]=this.functionInfoManager.o5e(Lb[u.a.Pc]));this.Q7a&&1===Lb.argumentsDialogSource&&this.WAe();const sd=Lb[Aa.jcc];if(sd.Params.includes("!")){xa.show(sd.FunctionIndex,this.$);break}const ce=wa.a.sXf(sd.Params).split(this.$.listSeparator).filter(De=>"..."!==De);w.TaskExtensions.l3(k.GetServiceTaskFactory.Pa(this.$.da,520,521,0),De=>{va.show(this.$,sd,De.result,ce,Lb.argumentsDialogSource)},this.$.ka,3);Lb.ibdk?this.formulaAssistanceTelemetryManager.y4a.argsDialogOpenedByDialogCounter++:
this.formulaAssistanceTelemetryManager.y4a.argsDialogOpenedByRibbonCounter++;break;case -433697611:kc=Lb.functionArgs;Lb.ibdk&&(void 0!==kc?this.formulaAssistanceTelemetryManager.y4a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.y4a.dialogCommitedCounter++);let Ce=Lb[u.a.Pc]+t.openParen;this.kCb&&(void 0!==kc&&(Ce+=kc.join(this.$.listSeparator)),Ce+=t.closeParen);Lb.UILocation&&this.$.Yc(-1075437823,-1,0,null);aa.view.visibleArea.contains(aa.Eg(null))||aa.yv(aa.ha.ra.activeCell,
3,"FormulaAssistanceCommandHandler.ExecuteCommand");const ve=ad.textBox;kc=this.Q7a?ad.textBox.selection:{index:ad.textBox.caretPosition,length:ve.wy?ve.wy.length:0};ad.eb?(Nc=ad.text,Xa=0<kc.index?Nc.substring(0,kc.index):"=",ad.text=Xa+Ce+Nc.substring(kc.index+kc.length,Nc.length),ve.caretPosition=Xa.length+Ce.length):this.kCb?(kc=aa.ha.ra.activeCell,this.Q7a&&(this.Qai(),kc=this.IPb.activeCell),aa.setCell(Object(xb.a)(new rb.a,{Text:`=${Ce}`}),kc,0,127,null)):w.TaskExtensions.za(aa.startEdit(!0,
1),()=>{ad.text="="+Ce;const De=Ce.length+1;ve.seb(De);ve.caretPosition=De},this.$.ka,11,$a.a.current);aa.Ul&&(aa=aa.Xb,aa.text=ve.text,aa.setCaretPosition(ve.caretPosition));this.vV?this.formulaAssistanceManager.Xda():(aa=ad.J2.get(m.a.Wwb),null===aa||void 0===aa?void 0:aa.JY(!1));break;case -1334919469:N(this.$,"154468",!1)}return pa.Task.Ta(!0)}Ac(aa,Xa){switch(Xa.command){case 753860909:case -2060563418:case -433697611:case -1334919469:return!0;case 1117706454:return this.kCb;default:return!1}}IPh(aa,
Xa){Xa=this.Xa.Bq(Xa);const Lb=this.Xa.Jc();var kc=this.functionInfoManager.rLa(aa);if(!kc)return n.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),Xa.AE();const Nc=this.kCb?1117706454:-433697611;for(let ad=0;ad<kc.length;++ad){const sd=kc[ad].NameUI,ce=this.Xa.ZP(280,"Formulas."+aa+"MenuItem_"+kc[ad].FunctionIndex.toString(),Nc,null,1,"None",0,0,sd,!1,0);ce.label=sd;const Ce=kc[ad].Params.split(t.Icd);ce.eS(sd+" "+(t.openParen+(1<Ce.length?
t.$9b:Ce[0])+t.closeParen)+"\n"+kc[ad].Help);Lb.buttons.push(ce)}aa=this.Xa.Jc();kc=this.Xa.ZP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,x.a.UWe,3,"Image16by16",1037,0,"Formulas.MoreFunctionsMenuItem",!1,0);aa.buttons.push(kc);Xa.uc.push(Lb);Xa.uc.push(aa);return Xa.AE()}Rc(aa,Xa,Lb){aa=this.OZh(Xa);if(-1===aa)return!1;this.menuId=Lb.MenuId;if(!this.functionInfoManager.wV)return this.functionInfoManager.VJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;aa=this.functionInfoManager.Twb[aa];
this.BY[aa]=this.BY[aa]||this.IPh(aa,Lb.MenuId);Lb.MenuItems=this.BY[aa];return!0}OZh(aa){switch(aa){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;
default:return-1}}WAe(){const aa=I.h(this.$);this.IPb={activeCell:aa.ha.ra.activeCell.clone(),selectedRanges:za.d(aa.ha.ra.selectedRanges),Mq:aa.ha.ra.Mq,sheetName:this.$.ua.na.sheetName}}Qai(){I.h(this.$).KZ(this.IPb.selectedRanges,this.IPb.Mq,this.IPb.sheetName,null,this.IPb.activeCell,null,null,60,"FormulaAssistanceCommandHandler.ExecuteCommand")}}Aa.jcc="functionInfo";Object(h.a)(Aa,"FormulaAssistanceCommandHandler",null,[222]);class pb extends l.a{constructor(aa){super(aa)}ld(){const aa=k.GetServiceTaskFactory.create(this.$.da,
102,this.ka,this.Na),Xa=k.GetServiceTaskFactory.create(this.$.da,153,this.ka,this.Na);w.TaskExtensions.za(w.TaskExtensions.Md([aa,Xa],this.ka),()=>{this.fd([new Aa(this.$,aa.result,Xa.result)])},this.ka,3)}static la(aa){l.a.Rd(92,new pb(aa))}}Object(h.a)(pb,"FormulaAssistanceCommandHandlerFactory",l.a,[]);var kb=a(228),Cb=a(155),ob=a(472),qa;let ma=qa=class{constructor(aa,Xa){this.RKa=this.sva=this.Jja=null;this.sJf=(Lb,kc)=>{this.Mhj(kc.functionName,kc.Dfd)};this.uJf=(Lb,kc)=>{this.Jhj(kc.Dfd,kc.DRd,
kc.a8i)};this.tJf=(Lb,kc)=>{Lb=[];for(var Nc of kc.DRd)(!this.jxa||void 0!==Nc&&null!==Nc)&&(kc=Nc.trim())&&Lb.push(kc);if(!this.jxa||Lb.length){Nc="";for(kc=0;kc<Lb.length;kc++){const ad=this.B1c(Lb[kc]),sd=qa.oId(kc,Lb.length);Nc+=ad+sd;sd&&(Nc+=this.ariaLiveNotifier.Aya)}this.ariaLiveNotifier.readText(Nc)}};this.vJf=(Lb,kc)=>{this.ariaLiveNotifier.Ohj(kc.aG,kc.description,kc.selectedIndex.toString(),kc.length.toString())};this.oJf=(Lb,kc)=>{this.ariaLiveNotifier.JUf(kc.description,kc.length)};
this.BFf=()=>{this.ariaLiveNotifier.vcb(y.a.instance.ga(884),z.a.uHa)};this.tFf=()=>{this.ariaLiveNotifier.readText(y.a.instance.ga(885))};this.wFf=()=>{this.ariaLiveNotifier.readText(y.a.instance.ga(886))};this.$=Xa;this.ariaLiveNotifier=aa;this.$.da.Ha(219,this);this.jxa=cb.a.O4(Xa)}dispose(){this.a1d();this.RKa=this.sva=this.Jja=null}Z_c(aa){aa&&(this.Jja=aa,this.Jja.Bse(this.sJf),this.Jja.ste(this.uJf),this.jxa&&this.Jja.rte(this.tJf))}$_c(aa){aa&&(this.sva=aa,this.jxa&&(this.sva.zse(this.BFf),
this.sva.xse(this.tFf)),this.sva.yse(this.wFf))}a0c(aa){aa&&(this.RKa=aa,this.RKa.bZc(this.vJf),this.RKa.O0b(this.oJf))}a1d(){var aa,Xa,Lb;this.Jja&&(this.Jja.XYf(this.sJf),this.Jja.vZf(this.uJf),this.jxa&&this.Jja.uZf(this.tJf));this.RKa&&(this.RKa.SNd(this.vJf),this.RKa.Rvc(this.oJf));this.jxa&&(null===(aa=this.sva)||void 0===aa?void 0:aa.WYf(this.BFf),null===(Xa=this.sva)||void 0===Xa?void 0:Xa.UYf(this.tFf));null===(Lb=this.sva)||void 0===Lb?void 0:Lb.VYf(this.wFf)}Mhj(aa,Xa){if(Xa){let Lb="";
this.jxa||(Lb+=y.a.instance.nb(57)+this.ariaLiveNotifier.Aya);for(let kc=0;kc<Xa.length;kc++)Lb+=aa+this.ariaLiveNotifier.Aya+this.B1c(Xa[kc])+qa.oId(kc,Xa.length);this.jxa&&(Lb+=y.a.instance.ga(883)+this.ariaLiveNotifier.Aya);this.ariaLiveNotifier.readText(Lb)}}Jhj(aa,Xa,Lb){if(aa){let Nc="",ad=0;if(Xa){for(let sd=0;sd<Xa.length;sd++){if(Lb>=aa[sd].split(this.$.listSeparator).length){ad++;continue}var kc=Xa[sd].trim();if(!kc)return;kc=this.B1c(kc);const ce=qa.oId(sd-ad,Xa.length-ad);Nc+=kc+ce;ce&&
(Nc+=this.ariaLiveNotifier.Aya)}this.ariaLiveNotifier.readText(Nc)}}}B1c(aa){if(!aa)return"";var Xa=aa.split(this.$.listSeparator);aa="";for(const Lb of Xa){if(qa.Hrd(Lb))aa+=Lb;else{const kc=(Xa=qa.dwi(Lb))?Lb.replace("[","").replace("]",""):Lb;aa+=String.format(Xa?y.a.instance.nb(59):y.a.instance.nb(58),kc)}aa+=this.ariaLiveNotifier.Aya}return aa}static oId(aa,Xa){return aa>=Xa||1===Xa?(n.ULS.shipAssertTag(537161997,0,aa<Xa,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),
""):String.format(y.a.instance.nb(55),aa+1,Xa)+"\r\n"}static Hrd(aa){return wa.a.contains(aa,t.$9b,!0)}static dwi(aa){return aa.trimStart().startsWith(t.zNf)||aa.trimEnd().endsWith(t.yNf)}};ma=qa=Object(Cb.b)([Object(E.d)(G.s),Object(Cb.c)(0,Object(ob.AriaLiveNotifierService)()),Object(Cb.c)(1,Object(G.o)())],ma);Object(h.a)(ma,"FormulaAssistanceReadoutHandler",null,[243,3]);class Ga extends kb.a{constructor(aa){super();this.$=aa;this.Gb()}create(){const aa=this.$.da;w.TaskExtensions.za(k.GetServiceTaskFactory.Pa(aa,
211,212,this.Na),Xa=>{Xa=aa.Ba(219)||new ma(Xa.result,this.$);this.qb(Xa)},this.ka,3)}static la(aa){aa.da.Ha(220,new Ga(aa))}}Object(h.a)(Ga,"FormulaAssistanceReadoutHandlerFactory",kb.a,[]);var vb=a(654),Ka=a(115),Pa=a(1011),fb=a(59),Wa=a(117);class Ma{constructor(){this.JRa={}}Fkd(aa){return this.JRa&&aa in this.JRa?this.JRa[aa]:null}Qeg(aa,Xa){this.JRa||(this.JRa={});this.JRa[aa]=Xa}UZ(){this.JRa=null}}Object(h.a)(Ma,"FormulaAssistanceContextualPreviewCache",null,[]);var lb=a(63);const Na=(aa,
Xa,Lb,kc,Nc,ad,sd=null)=>{sd=aa.Oa(1,sd);sd.getPartialCalcResultsParameters=Xa;return lb.g(aa,"GetPartialCalcResults",sd,Lb,kc,Nc,ad,4)};var X=a(70);class F{constructor(aa){this.KLi=30;this.calcManager=null;this.Ld=!1;this.$Pa=this.JIb=this.rbb=null;this.Ow=()=>{this.Pha.UZ()};this.$=aa;this.Pha=new Ma;this.A0f=-1;this.$.ea.wA(this.Ow)}dispose(){this.Ld||(this.$&&(this.$.ea.wB(this.Ow),this.$=null),this.Pha=this.JIb=null,this.Ld=!0)}Zgd(aa,Xa,Lb,kc){if(Xa&&0>=Xa.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");
if(!aa)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=Object(X.c)({TV:266,new:G.f,registry:this.$.da,Y3:O.EwaSettings.uX});if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");let Nc="="+Xa.substring(Lb.start,Lb.end);O.EwaSettings.xa(512)&&(Nc=this.calcManager.p8h(I.h(this.$).ha.ra.activeCell,aa,Lb));const ad=this.VVh(Nc,Lb);if(O.EwaSettings.xa(512)){if(ad&&!this.calcManager.isFormulaSubExpressionVolatile(aa))return Promise.resolve(ad)}else if(ad)return Promise.resolve(ad);
return this.XVh(Nc,Lb).then(sd=>{if(this.y3c(kc))throw Error.create("OperationCanceledException");if(!sd||sd.Luj||sd.Nna.startsWith("##UNSUPPORTED:"))return this.K3e(Xa,Nc,Lb,kc);this.Pha.Qeg(Nc,sd.Nna);return Promise.resolve(sd)})}VVh(aa,Xa){return(aa=this.Pha.Fkd(aa))?new Pa.a(aa,Xa.start,Xa.end,0):null}XVh(aa,Xa){if(!aa||0>=aa.length||!Xa)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.s3g(I.h(this.$).ha.ra.activeCell,
aa,this.KLi,Xa)}K3e(aa,Xa,Lb,kc){if(!aa||0>=aa.length||!Xa||0>=Xa.length||!Lb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.$Pa)return this.WVh(aa,Xa,Lb,kc);const Nc={};Nc.PartialFormula=Xa;Nc.Formula=aa;Nc.SourceRange=za.v(I.h(this.$).ha.ra.activeCell,this.$);return this.$Pa=new Promise((ad,sd)=>{this.JIb=new vb.a;this.A0f=this.$.ea.se;this.rbb=Na(this.$.pa.va,Nc,ce=>{this.P5i(Xa,Lb,kc,ce,ad,sd)},ce=>{this.rbb=
this.$Pa=null;sd(ce)},null,null,null);this.JIb.token.register(()=>{this.e5g(sd)})})}P5i(aa,Xa,Lb,kc,Nc,ad){this.rbb=this.$Pa=null;if(this.A0f!==this.$.ea.se)ad(Error.create("OperationCanceledException"));else if(kc.Result)if(kc=fb.a.Yh(kc.Result),!kc||Ka.a.isEmpty(kc))Nc(null);else{for(let sd in kc)this.Pha.Qeg(sd,kc[sd]);this.y3c(Lb)?ad(Error.create("OperationCanceledException")):(aa=this.Pha.Fkd(aa))?(""===aa&&(aa=" "),Nc(new Pa.a(aa,Xa.start,Xa.end,0))):ad(Error.create("SubexpressionNotFoundException"))}else Nc(null)}WVh(aa,
Xa,Lb,kc){return new Promise((Nc,ad)=>{this.$Pa.then(()=>{this.o1f(aa,Xa,Lb,kc,Nc,ad)}).catch(()=>{this.o1f(aa,Xa,Lb,kc,Nc,ad)})})}o1f(aa,Xa,Lb,kc,Nc,ad){if(this.y3c(kc))ad(Error.create("OperationCanceledException"));else{const sd=this.Pha.Fkd(Xa);sd?Nc(new Pa.a(sd,Lb.start,Lb.end,0)):this.K3e(aa,Xa,Lb,kc).then(ce=>{Nc(ce)}).catch(ce=>{ad(ce)})}}e5g(aa){this.rbb&&(Wa.a.Wt(this.rbb.Xs)?(this.$Pa=this.rbb=null,aa(Error.create("PendingWebReqeuestCancelled"))):n.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}UZ(){this.f5g();
this.Pha&&this.Pha.UZ()}f5g(){this.JIb&&this.JIb.cancel()}y3c(aa){return this.Ld||aa.qK}}Object(h.a)(F,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var na=a(167),hb=a(219);class Ib{}Ib.Fzh="ewa-facp-text-box";Object(h.a)(Ib,"CssClassNames",null,[]);class vc{constructor(aa){this.ora=this.VTa=this.C3a=this.XP=this.X$=this.gb=null;this.Nmd=!1;this.Uc=aa}dispose(){(this.X$||this.XP)&&this.kef();this.gb=this.ora=null}A4j(aa,Xa,Lb,kc){aa&&Xa&&kc&&Xa.Nna&&!(1>Xa.Nna.length)&&(this.gb=aa,this.YXf(),
this.C3a=Xa,this.VTa=kc,this.pNj(Xa,Lb,kc))}kef(){this.Dgi();this.YXf();this.VTa=this.C3a=null}pNj(aa,Xa,Lb){if(aa.Nna&&!(1>aa.Nna.length)){var kc=Object(X.c)({TV:266,new:G.f,registry:this.Uc.da,Y3:O.EwaSettings.uX});if(kc){var Nc=kc.g1h();Nc&&w.TaskExtensions.za(this.CEb,()=>{if(Xa)if(O.EwaSettings.xa(512)&&this.gb.eb&&0<Lb.length){this.Yzb(aa.NKa,Lb[0].start,null);var ad=this.$9e(Lb[0],Nc),sd=this.gb.text.substring(Lb[0].start,Lb[0].end).trim();sd=this.gb.text.indexOf(sd);sd=this.gb.text.substring(0,
sd).lastIndexOf("\n");this.Yzb(0>sd||1>=Lb.length?Lb[0].start:sd+1,Lb[0].end,ad?String.format(ad,.3):null);for(var ce=1;ce<Lb.length;ce++)ad=this.$9e(Lb[ce],Nc),sd=this.gb.text.substring(Lb[ce].start,Lb[ce].end).trim(),sd=this.gb.text.indexOf(sd),sd=this.gb.text.substring(Lb[ce-1].end,sd).lastIndexOf("\n"),this.Yzb(0>sd?Lb[ce-1].end:sd+1+Lb[ce-1].end,Lb[ce].end,ad?String.format(ad,.3):null);sd=this.gb.text.substring(Lb[Lb.length-1].end,aa.uva).indexOf("\n");this.Yzb(0>sd?Lb[Lb.length-1].end:sd+1+
Lb[Lb.length-1].end,aa.uva,null);n.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.Yzb(aa.NKa,aa.uva,null),n.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.X$||(this.X$=document.createElement(hb.a.div),this.gb.textBox.domElement.appendChild(this.X$));
this.XP||(this.XP=document.createElement(hb.a.div),this.XP.className=Ib.Fzh,this.Uc.domElement.appendChild(this.XP));ad=aa.uva;O.EwaSettings.xa(512)&&this.gb.eb&&Lb&&0<Lb.length&&Lb[0].start<ad&&Lb[0].start!==aa.NKa&&!this.gb.textBox.wy.length&&(ad=Lb[0].start);ce=wa.a.contains(this.gb.textBox.Ge.id,"FormulaBar",!0)&&wa.a.contains(this.gb.text.substring(aa.NKa,aa.uva),"\n",!0);sd=this.gb.eb?this.gb.textBox.caretPosition:0;ad=excelOnline.utils.getBoundingRectForText(this.gb.textBox.Ge,ce?sd:aa.NKa,
ce?sd:ad,O.EwaSettings.xa(512));this.XP.style.left=H.HelperMethods.zc(ad.left);this.XP.style.top=H.HelperMethods.zc(ad.top);this.XP.style.width=H.HelperMethods.zc(ad.width);this.XP.style.height=H.HelperMethods.zc(ad.height);dialogControls.renderToolTip(this.X$,`FormulaAssistancePreviewToolTip_${aa.uva}_${aa.uva}`,aa.Nna,this.XP,0,!1,!1,1)},this.Uc.ka,3)}}}$9e(aa,Xa){const Lb=this.gb.text;var kc=Lb.substring(aa.start,aa.end);kc=kc.trim();aa=Lb.indexOf(kc,aa.start);Xa=Lb.indexOf(Xa,aa);kc=Lb.substring(aa,
Xa);kc=kc.trim();return this.gb.colors.getItem(aa+"-"+(aa+kc.length))}Dgi(){this.gb&&this.X$&&this.XP&&w.TaskExtensions.za(this.CEb,()=>{this.gb.textBox.domElement.contains(this.X$)&&(dialogControls.clearToolTip(this.X$),this.gb.textBox.domElement.removeChild(this.X$),this.X$=null);this.Uc.domElement.contains(this.XP)&&(this.Uc.domElement.removeChild(this.XP),this.XP=null)},this.Uc.ka,3)}Yzb(aa,Xa,Lb){!this.gb||aa>=Xa||(this.gb.textBox.formatText(aa,Xa-aa,{["background"]:Lb||"#E3DDCC"}),this.Nmd=
!0)}YXf(){if(this.gb&&this.C3a&&this.Nmd){var aa=this.C3a.uva;O.EwaSettings.xa(512)&&0<this.VTa.length&&this.VTa[this.VTa.length-1].end>aa&&(aa=this.VTa[this.VTa.length-1].end);this.gb.textBox.formatText(this.C3a.NKa,aa-this.C3a.NKa,{["background"]:!1});this.Nmd=!1}}get CEb(){if(this.ora)return this.ora;const aa=new na.a;this.Uc.jz(Xa=>{w.TaskExtensions.za(Xa.Axd(),()=>{aa.setResult(!0)},this.Uc.ka,3)});return this.ora=aa.task}}Object(h.a)(vc,"FormulaAssistanceContextualPreviewControl",null,[3]);
var nc=a(87),Pb=a(49),oc=a(45);class Ic{constructor(aa){this.T7=0;this.dfd=aa}ibg(aa,Xa,Lb){Lb?this.bgh(aa,Xa,Lb):this.nbf(aa,Xa,Lb,!0)}ltj(){this.T7=0}bgh(aa,Xa,Lb){this.T7++;const kc=this.T7;Pb.a.instance.create(()=>{this.nbf(aa,Xa,Lb,kc===this.T7)},500,oc.a.JNh,!0,!0)}nbf(aa,Xa,Lb,kc){const Nc=this.dfd.Zgd(aa,Xa);Nc&&Nc.then(ad=>{kc&&this.dfd.ssd(Xa)&&this.dfd.z4j(aa,ad,Lb)}).catch(ad=>{ad=Object(nc.a)(Error,ad);"OperationCanceledException"===ad.message?n.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${ad}`):
n.ULS.sendTraceTag(537162058,0,10,`GetContextualFormulaPreviewResults - caught exception: ${ad}`)})}}Object(h.a)(Ic,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var ec=a(184);class mb{constructor(aa){this.Ptb=this.Nha=this.calcManager=this.gb=null;this.gab=()=>{this.q6a(!1,!1)};this.$=aa;this.Lwb=new vc(aa);this.Ybc=new F(aa);this.Zbc=new Ic(this);I.h(aa).Xb.rm(this.gab);this.$.da.Ha(317,this)}dispose(){this.A2c();ib.a.sc([this.Lwb,this.Ybc]);this.Zbc=this.Ybc=this.Lwb=null;this.$&&I.h(this.$).Xb.dm(this.gab);
this.Nha=this.gb=this.$=null}qNj(aa,Xa){Xa&&ec.f(Xa.text)&&!(Xa.uxa||Xa.textBox.wy||this.gb&&this.gb.textBox.wy)&&(this.gb=Xa,this.calcManager=Object(X.c)({TV:266,new:G.f,registry:this.$.da,Y3:O.EwaSettings.uX}))&&(n.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),aa=H.HelperMethods.xxb(aa),aa=this.calcManager.m8h(I.h(this.$).ha.ra.activeCell,this.gb.text,aa.x,aa.y),Xa=this.calcManager.getSubExpressionSpan(aa),
!Xa||Xa.end<=Xa.start||this.ssd(Xa)||(this.Nha=Xa,this.Zbc.ibg(aa,Xa,!0)))}dWd(aa){if(aa&&ec.f(aa.text))if(aa.textBox.wy&&aa.textBox.wy.trim()){if(this.gb=aa,this.calcManager=Object(X.c)({TV:266,new:G.f,registry:this.$.da,Y3:O.EwaSettings.uX})){n.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");aa={};var Xa=this.gb.textBox.wy.trim();aa.start=this.gb.text.indexOf(Xa,this.gb.textBox.caretPosition);
aa.end=aa.start+Xa.length;(Xa=this.calcManager.getFormulaSubExpressionObject(I.h(this.$).ha.ra.activeCell,this.gb.text,this.gb.textBox.wy))&&!this.ssd(aa)&&(this.Nha=aa,this.Zbc.ibg(Xa,aa,!1))}}else this.q6a(!1,!0)}q6a(aa,Xa){!this.gb||Xa&&this.gb.textBox.wy||(this.Nha=null,aa&&(this.A2c(),this.Ybc.UZ(),this.Zbc.ltj()),this.Lwb&&this.Lwb.kef(),this.gb.uxa||(this.gb.uxa=!1,this.gb=null))}Zgd(aa,Xa){if(!this.gb||this.gb.uxa)return null;this.A2c();this.Ptb=new vb.a;return this.Ybc.Zgd(aa,this.gb.text,
Xa,this.Ptb.token)}z4j(aa,Xa,Lb){this.Ptb=null;!aa||!Xa||!Xa.Nna||0>=Xa.Nna.length?this.q6a(!1,!1):(aa=this.calcManager.n8h(I.h(this.$).ha.ra.activeCell,aa,this.gb.text),this.Lwb.A4j(this.gb,Xa,Lb,aa))}ssd(aa){return this.Nha?aa.start===this.Nha.start&&aa.end===this.Nha.end&&aa.pre===this.Nha.pre&&aa.post===this.Nha.post:!1}A2c(){this.Ptb&&this.Ptb.cancel()}}Object(h.a)(mb,"FormulaAssistanceContextualPreviewManager",null,[318,3,319]);var Ob=a(229),Ta=a(13),sb=a(197),zb=a(1121),db=a(65),jb=a(791),
Ub=a(34),xd=a(24),ne=a(71),fe=a(291),Bd=a(256),Ue=a(182);class mc{constructor(aa=!1){this.$S=0;this.yce=!1;this.SWa=this.$de=null;this.BCg=aa;this.textEdit=null}G7f(aa){this.$S=0;this.yce=aa.IsCompatibility;this.set_name(aa.NameDataStrings);this.SWa=aa.Help}tDj(aa){this.$S=1;this.set_name(aa.Name)}WCj(aa){this.$S=2;this.set_name(aa.name);this.SWa=aa.tooltip}CEj(aa){this.$S=3;this.set_name(aa.name);this.SWa=aa.toolTip}UGj(aa){this.$S=4;this.set_name(aa.name)}WGj(aa){this.$S=5;this.set_name(aa.name);
this.SWa=aa.toolTip}VGj(aa){this.$S=7;this.set_name(aa.name)}vFj(){this.$S=6;this.set_name(y.a.instance.nb(192));this.SWa=y.a.instance.nb(193)}get itemType(){return this.$S}get yri(){return this.yce}get name(){return this.label}set_name(aa){return this.$de=aa}get label(){return this.$de}get Pja(){return this.SWa}get UCb(){return this.BCg}static wkh(){return Object(xb.a)(new mc(!0),{})}}Object(h.a)(mc,"AutoCompleteItem",null,[353]);class Fc{constructor(){this.sheetName=this.namedRange=this.tooltip=
this.name=null;this.type=0}}Object(h.a)(Fc,"DefinedNameInfo",null,[]);var bd=a(173);class de{constructor(aa){this.YMe={};this.$=aa}get XMe(){const aa=[];if(!this.$.Bb||!this.$.Bb.items)return aa;let Xa=0;const Lb=O.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&cb.a.vV(this.$);for(const kc of this.$.Bb.items)if(kc&&(3===kc.type&&kc.usedRange||Lb&&2===kc.type)){const Nc=new Fc;Nc.tooltip=kc.sheetName+db.a.exclamation+kc.usedRange.toString();Nc.name=kc.name;
Nc.namedRange=this.ddh(kc.usedRange);Nc.sheetName=kc.sheetName;Nc.type=this.Wch(kc.type);aa.push(Nc);this.YMe[kc.name.toUpperCase()]=Nc;++Xa;if(!O.EwaSettings.isChangeGateEnabled("OfficeVSO:7395300_FixTableAutoCompleteMissingInfo")&&Xa===t.Fxf){n.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${t.Fxf}`);break}}return aa}L0j(aa){var Xa=this.YMe[aa.toUpperCase()];if(!Xa)return{returnValue:!1,sheetName:"",range:null};aa=Xa.sheetName;Xa=this.Och(Xa.namedRange);
return{returnValue:!0,sheetName:aa,range:Xa}}ddh(aa){if(null!=aa&&void 0!=aa)return{top:aa.top,left:aa.left,bottom:aa.bottom,right:aa.right,maxRows:aa.maxRows,maxColumns:aa.maxColumns,sheetName:void 0}}Och(aa){if(null!=aa&&void 0!=aa)return new bd.a(aa.top,aa.left,aa.bottom,aa.right,aa.maxRows,aa.maxColumns)}Wch(aa){switch(aa){case 2:return 0;case 3:return 1;default:return-1}}}Object(h.a)(de,"DefinedNameInfoManager",null,[]);var Md=a(138),se=a(274),tc=a(270),dd=a(242);class Hd extends Sys.EventArgs{constructor(aa,
Xa){super();this.functionName=aa;this.Dfd=Xa}}Object(h.a)(Hd,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class Xc extends Sys.EventArgs{constructor(aa){super();this.DRd=aa}}Object(h.a)(Xc,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class gd extends Sys.EventArgs{constructor(aa,Xa,Lb){super();this.Dfd=aa;this.DRd=Xa;this.a8i=Lb}}Object(h.a)(gd,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var je=a(269);class Ee{constructor(aa,Xa,
Lb,kc,Nc=null){this.jic=this.o2c=!1;this.$=aa;this.formulaAssistanceUIControl=Xa;this.D0e=Lb;this.bzj=kc;this.Hbf=Nc;this.jic=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get If(){return this.o2c}set If(aa){this.o2c!==aa&&(aa?je.a(this.$).fi(this):je.a(this.$).Nz(this),this.o2c=aa)}get ee(){return this.bzj}get mc(){return this.formulaAssistanceUIControl.getRootElement(this.D0e)}eg(aa,Xa){aa=!1;Xa||(I.h(this.$).Mh.textBox.oF=!0,aa=this.formulaAssistanceUIControl.focus(this.D0e));
return aa}Bh(aa){const Xa=this.mc;return!(void 0===Xa||null===Xa)&&ja.DOMElementExtensions.Df(Xa,aa)}Bj(){this.Hbf&&this.Hbf();const aa=I.h(this.$).Mh.textBox;this.selection=aa.selection;aa.removeSelection()}ik(){I.h(this.$).Mh.textBox.selection=this.selection}dispose(){je.a(this.$).Nz(this)}}Object(h.a)(Ee,"FormulaAssistanceFocusManager",null,[63,3]);var ae=a(39),Yb=a(379),Sc=a(198),qd=a(36),Id=a(255),ic=a(290),Gc=a(938);class jd extends ae.a{constructor(aa,Xa){super();this.jAg=[];this.Gfd={};this.Hfd=
{};this.WS=null;this.T8=[];this.SKa={};this.ZFf=(Lb,kc)=>{n.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.JFf(Lb,!!kc&&1!==kc.FilterType,!0)};this.YFf=()=>{n.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.WS=null};this.GFf=Lb=>{n.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.OLd(Lb.Rja,
!0,!1)};this.XFf=Lb=>{n.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.JFf(Lb,!0,!1)};this.xOc=this.AOc=!1;this.mb=aa;this.pluginScheduler=Xa;this.$.da.Ha(19,this)}QGa(aa){this.addHandler("FunctionInfoLoaded",aa)}cdb(aa){this.removeHandler("FunctionInfoLoaded",aa)}XPg(aa){this.addHandler("FunctionInfoReset",aa)}Coj(aa){this.removeHandler("FunctionInfoReset",aa)}get wV(){return this.AOc}get uti(){return this.xOc}get kcc(){var aa=this.WS,Xa=Gc.a(this.$);if(!Xa)return aa;
Xa=Xa.eZh();const Lb=Xa.length;if(0>=Lb)return aa;const kc=[];kc.push(...aa);for(aa=0;aa<Lb;aa++){const Nc=Xa[aa],ad={};ad.FunctionIndex=kc.length;ad.HelpId=ad.GroupUI=null;ad.Help=Nc.description;ad.IsCommonlyUsed=ad.IsCompatibility=!1;ad.NameDataStrings=Nc.name;ad.NameUI=Nc.name;ad.Params=null;ad.ParamsHelp=null;kc.push(ad)}return kc}get Twb(){return this.T8}get $(){return this.mb}dispose(){const aa=this.$.da.Ba(268);aa&&aa.wNd(this.GFf);this.mb=null;super.dispose()}U0f(){this.raiseEvent("FunctionInfoReset")}jPd(){this.U0f();
this.AOc=!1;this.WS=null;this.xOc=!0}VJa(aa,Xa=!1){if(this.wV)this.qTf();else{n.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.ya.UICultureTag}' from the server.`);let kc=null;(kc=this.$.da.Ba(268))||n.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===kc||void 0===kc?0:kc.Rja)&&0<kc.Rja.length)O.EwaSettings.xa(114)?kc.mNh(this.XFf):this.OLd(kc.Rja,!0,!1);else{var Lb=this.$.pa.va.$b();aa&&(this.$.ea.Yb||Xa)&&!this.uti&&
(Xa?Yb.a(this.$.userOperationManager,(Nc,ad,sd)=>lb.o(this.$.pa.va,aa,ic.b(Nc,this.ZFf),ic.a(ad,this.YFf),sd,aa,Lb),Nc=>new Sc.a(130,0,Nc,16),null):lb.o(this.$.pa.va,aa,this.ZFf,this.YFf,null,aa,Lb));!this.wV&&this.$.ea.Yb&&(kc?(n.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.wV}, IsSessionActive=${this.$.ea.Yb}`),kc.Ase(this.GFf)):(n.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
lb.o(this.$.pa.va,{FilterType:0},this.XFf,null,null,null,Lb),this.xOc=!1))}}}jid(aa){return 0>aa||aa>=this.WS.length?null:this.WS[aa]}kid(aa){return qd.a.Ic(this.Gfd,aa.toUpperCase())}o5e(aa){return qd.a.Ic(this.Hfd,aa.toUpperCase())}rLa(aa){return qd.a.Ic(this.SKa,aa)}ojc(aa){return!aa.GroupUI}JFf(aa,Xa,Lb){const kc=Id.a(aa);n.ULS.sendTraceTag(537161955,0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${kc}`);kc?(I.h(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),
this.$.ea.$n(aa.Errors)):(this.OLd(aa.Result,Xa,Lb),cb.a.aR(this.$)&&!cb.a.vV(this.$)&&this.V6j())}OLd(aa,Xa,Lb){n.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${aa.length}, isCategorized = ${Xa}, partialResult = ${Lb} IsFullyLoaded = ${this.wV}`);this.wV||(this.WS=aa,this.e0g(Xa),this.AOc=!Lb,this.qTf())}qTf(){this.raiseEvent("FunctionInfoLoaded")}V6j(){const aa=this.kcc;this.pluginScheduler.notifier().setFunctionsInfo(aa);n.ULS.sendTraceTag(512278604,
0,50,`FuntionInfoManager.updateSchedulerFunctionArgumentAssistanceList update functions info with ${null===aa||void 0===aa?void 0:aa.length} functions}`)}e0g(aa){var Xa=y.a.instance.ga(1032),Lb=[];this.SKa={};this.T8=[];this.SKa[Xa]=Lb;const kc=y.a.instance.ga(1033),Nc=[];this.T8.push(Xa);this.T8.push(kc);for(let sd=0,ce=this.WS.length;sd<ce;sd++){Xa=this.WS[sd];Xa.IsCompatibility||Nc.push(Xa);var ad=Xa.NameUI;const Ce=Xa.NameDataStrings;this.Gfd[Ce.toUpperCase()]||(this.Gfd[Ce.toUpperCase()]=Xa);
this.Hfd[ad.toUpperCase()]||(this.Hfd[ad.toUpperCase()]=Xa);if(!this.ojc(Xa)){if(aa){ad=Xa.GroupUI;let ve=qd.a.Ic(this.SKa,ad);ve||(ve=[],this.SKa[ad]=ve,this.T8.push(ad));ve.push(Xa)}Xa.IsCommonlyUsed&&Lb.push(Xa);Xa.IsCompatibility||this.jAg.push(Ce)}}this.SKa[kc]=Nc;aa&&(jd.mXf(Lb,[2,3,0,5,4,9,1,7,8,6]),Lb=Array(14),Lb[0]=0,Lb[1]=1,Lb[2]=7,Lb[3]=11,Lb[4]=5,Lb[5]=2,Lb[6]=6,Lb[7]=10,Lb[8]=9,Lb[9]=3,Lb[10]=4,Lb[11]=13,Lb[12]=12,Lb[13]=8,jd.mXf(this.T8,Lb),Lb=[],Lb.push(...this.T8),Lb.splice(13,1),
this.T8=Lb);Lb=(sd,ce)=>sd.NameUI.localeCompare(ce.NameUI);this.WS=[...this.WS];this.WS.sort((sd,ce)=>sd.NameDataStrings.localeCompare(ce.NameDataStrings));for(let sd=1,ce=this.T8.length;sd<ce&&aa;sd++)this.SKa[this.T8[sd]].sort(Lb);for(let sd=0,ce=this.WS.length;sd<ce;sd++)this.WS[sd].FunctionIndex=sd}static mXf(aa,Xa){const Lb=[...aa];for(let kc=0;kc<Lb.length&&kc<Xa.length;kc++)aa[kc]=Lb[Xa[kc]]}}Object(h.a)(jd,"FunctionInfoManager",ae.a,[275,276,3]);var ed=a(243),Qd=a(99),te=a(51),xe=a(729);class He extends Qd.a{constructor(aa,
Xa,Lb,kc=null){super(aa,kc);this.C3=null;this.pPb=this.HYd=!1;this.offsetParent=this.J7=this.Y2a=null;this.VMc=!1;this.mEd=Nc=>this.q6(Nc);this.lEd=Nc=>this.p6(Nc);this.wEf=Nc=>{const ad=H.HelperMethods.zo(Nc);ad.button===Sys.UI.MouseButton.leftButton&&2===Nc.wb&&(this.Prd(ad.target)||this.ITa(ad));return!1};this.X9d=Xa;Lb&&(this.HYd=!0,ed.a.instance.ta(Ta.a.pointerDown,this.NPe,this.wEf));this.Dfa=!1}get M9b(){return this.Dfa}get NPe(){return this.X9d}get xfi(){return this.VMc}dispose(){this.HYd&&
(ed.a.instance.Aa(Ta.a.mk,this.NPe,this.wEf),this.HYd=!1);this.pPb&&(this.pPb=!1,ed.a.instance.Aa(Ta.a.Of,this.domElement.ownerDocument.body,this.mEd),ed.a.instance.Aa(Ta.a.mk,this.domElement.ownerDocument.body,this.lEd));this.C3=this.X9d=null;super.dispose()}tqe(aa){this.C3?this.C3.push(aa):this.C3=[aa]}Prd(aa){if(this.C3)for(let Xa=0,Lb=this.C3.length;Xa<Lb;++Xa)if(ja.DOMElementExtensions.Df(this.C3[Xa],aa))return!0;return!1}ITa(aa){this.M9b||(this.Dfa=!0,wa.a.equals(this.domElement.currentStyle.position,
"absolute",!0)||(this.domElement.style.position="absolute"),this.wwh(),ed.a.instance.ta(Ta.a.Of,this.domElement.ownerDocument.body,this.mEd),ed.a.instance.ta(Ta.a.mk,this.domElement.ownerDocument.body,this.lEd),this.pPb=!0,this.drag(!0,aa))}drag(aa,Xa){la.g(Xa);var Lb=new te.a(0,0),kc=new Sys.UI.Point(Xa.clientX,Xa.clientY);Xa=this.domElement.parentNode;kc=xe.a.Qu(Lb,Xa,kc,this.isRtl());aa?(Lb=xe.a.iF(Lb,Xa,this.domElement,this.isRtl()),this.Y2a=xe.a.OD(kc,Lb),this.J7=kc,this.VMc=!1):!this.xfi&&this.tfi(kc,
this.J7)&&(this.VMc=!0);Lb=xe.a.OD(kc,this.Y2a);xe.a.yeb(Xa,this.domElement,Lb,this.isRtl(),aa)}sw(aa){this.pPb&&(this.pPb=!1,ed.a.instance.Aa(Ta.a.Of,this.domElement.ownerDocument.body,this.mEd),ed.a.instance.Aa(Ta.a.mk,this.domElement.ownerDocument.body,this.lEd));la.g(aa);this.Dfa=!1;this.J7=this.Y2a=null}q6(aa){const Xa=H.HelperMethods.zo(aa);Xa.button===Sys.UI.MouseButton.leftButton&&2===aa.wb&&this.sw(Xa);return!1}p6(aa){2===aa.wb&&this.drag(!1,H.HelperMethods.zo(aa));return!1}tfi(aa,Xa){return Xa.x<
aa.x-2||Xa.x>aa.x+2||Xa.y<aa.y-2||Xa.y>aa.y+2}wwh(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;ja.DOMElementExtensions.getLocation(this.offsetParent)}}Object(h.a)(He,"BaseDraggableBehavior",Qd.a,[]);class We extends He{constructor(aa,Xa,Lb=null,kc=!1){super(aa,Xa,!1,Lb);this.PSa(kc);this.fj=wa.a.equals("rtl",aa.dir,!0)}setVisible(aa){ja.DOMElementExtensions.setVisible(this.domElement,aa);aa||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.fj}PSa(aa){const Xa=
this.domElement.style;Xa.cursor="move";Xa.position=aa?"relative":"absolute"}}Object(h.a)(We,"FunctionParamBoxDraggableItem",He,[]);class ye{constructor(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onIsExpandedChange=this.onCardModeChange=null}}Object(h.a)(ye,"FormulaArgumentAssistanceCallbacks",null,[]);class $e{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0;this.showCollapseText=this.isExpanded=!1}}Object(h.a)($e,"FormulaArgumentAssistanceRenderingInfo",
null,[]);var jf=a(90),gf=a(113),rf=a(163);class Mf{constructor(aa){this.qv=aa;this.$A=this.$Sa=this.Mi=!1;this.onKeyDown=Xa=>!this.$A&&Xa.keyCode===jf.a.cfa&&Xa.altKey&&Xa.ctrlKey?(this.v3a(),Xa.stopPropagation(),Xa.preventDefault(),!0):!1;this.Qla=Xa=>{if(!this.$A)return!1;if(Xa.eventName===Ta.a.Vb){const Lb=Xa.Ea.ctrlKey?1:Xa.Ea.shiftKey?50:10;switch(Xa.Ea.keyCode){case jf.a.Gpa:this.FK(0,-Lb);break;case jf.a.h8:this.FK(0,Lb);break;case jf.a.i8:this.FK(-Lb,0);break;case jf.a.XCa:this.FK(Lb,0);break;
case jf.a.sG:case jf.a.Sh:this.$Sa=!0;break;default:return!1}}Xa.eventName===Ta.a.Qd&&this.$Sa&&this.CM(!0);Xa.Ea.preventDefault();return!0};this.Yza=Xa=>{if(!this.$A)return!1;Xa.Ea.preventDefault();this.CM();return!0};this.onBlur=()=>{if(!this.$A)return!1;this.CM();return!0};this.Co=gf.KeyInputManager.instance;this.pointerInputManager=ed.a.instance}la(aa){(this.root=aa)&&!this.Mi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Mi=!0)}detach(){this.root&&this.Mi&&(this.root.addEventListener("keydown",
this.onKeyDown,!0),this.Mi=!1)}v3a(){this.root&&(this.target=this.qv.OHb("move",!0),this.eYd=this.target.getBoundingClientRect(),this.$A=!0,this.$Sa=!1,this.Nt(),this.Zya||this.Ctb(),this.target.appendChild(this.Zya))}CM(aa=!1){this.qv.lqc(aa);this.$A=!1;this.AKb();this.qKb();this.eYd=this.target=void 0}Nt(){this.Co.capture(this.Qla,null);this.pointerInputManager.xs(Ta.a.pointerDown,this.target,this.Yza,!0);this.target.addEventListener("blur",this.onBlur)}qKb(){this.Co.releaseCapture();this.pointerInputManager.Fs(Ta.a.pointerDown,
this.target,this.Yza,!0);this.target.removeEventListener("blur",this.onBlur)}AKb(){var aa;this.target&&(null===(aa=this.Zya)||void 0===aa?void 0:aa.parentNode)===this.target&&this.target.removeChild(this.Zya)}FK(aa,Xa){const Lb=this.target.getBoundingClientRect();this.qv.onMove(aa+Lb.left-this.eYd.left,Xa+Lb.top-this.eYd.top)}Ctb(){this.Zya=rf.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(h.a)(Mf,"FormulaAssistanceMoveAdapter",null,[]);var Qa=a(286);class Zb{constructor(aa){this.qv=
aa;this.Mi=!1}U4(){return this.Mi&&!!this.aD}sza(aa){this.aD.style.cursor="grabbing";this.eTj=aa.clientPoint.x;this.fTj=aa.clientPoint.y;this.qv.OHb("drag");return!0}Xca(aa){this.qv.onMove(aa.clientPoint.x-this.eTj,aa.clientPoint.y-this.fTj);return!0}Wca(){this.sw()}Vca(){this.sw()}la(aa){if(this.aD=aa)this.aD.style.cursor="grab",Qa.a.instance.xW(this.aD,this),this.Mi=!0}detach(){this.Mi&&this.aD&&(this.aD.style.cursor="",Qa.a.instance.$0(this.aD,this),this.Mi=!1)}sw(){this.aD.style.cursor="grab";
this.qv.lqc()}}Object(h.a)(Zb,"FormulaAssistanceDragAdapter",null,[367]);class nb{get MGc(){return this.JKa.getWindowEdgeBuffer()+1}constructor(aa,Xa){this.JKa=aa;this.formulaAssistanceTelemetryManager=Xa;this.Mi=!1;this.sHa=O.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.e1={[Tb.Drag]:0,[Tb.Move]:0};this.IFb=new Mf(this);this.Wub=new Zb(this)}la(aa,Xa,Lb,kc){this.root=aa;this.render=Lb;this.dismiss=kc;this.detach();Xa&&(this.Wub.la(Xa),this.IFb.la(aa.firstChild),
this.Mi=!0)}detach(){this.Mi&&(this.Wub.detach(),this.IFb.detach(),this.Mi=!1);ja.DOMElementExtensions.yf(this.placeholder)}clear(){this.JKa.setOverrideTarget(void 0);this.detach();this.tLb()}OHb(aa,Xa=!1){this.e1[aa]+=1;this.WBc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);aa=this.placeholder.firstChild;aa.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);Xa&&(this.IQa=document.activeElement,aa.tabIndex=0,aa.focus());this.dismiss();
return aa}onMove(aa,Xa){this.placeholder.firstChild.style.transform=`translate(${Math.min(Math.max(aa,this.MGc-this.WBc.left),window.innerWidth-this.WBc.right-this.MGc)}px, ${Math.min(Math.max(Xa,this.MGc-this.WBc.top),window.innerHeight-this.WBc.bottom-this.MGc)}px)`}lqc(aa=!0){const Xa=this.placeholder.firstChild.getBoundingClientRect(),Lb=this.JKa.getDirectionalHint({top:Xa.top,left:Xa.left});this.JKa.setOverrideTarget({top:1===Lb?Xa.bottom:Xa.top,left:Xa.left});this.render();window.requestAnimationFrame(()=>
{ja.DOMElementExtensions.yf(this.placeholder);this.IQa&&(aa&&this.IQa.focus(),this.IQa=void 0)})}tLb(){const aa=this.e1[Tb.Drag],Xa=this.e1[Tb.Move];0<aa&&(this.formulaAssistanceTelemetryManager.pJ("d"),this.sHa||(this.formulaAssistanceTelemetryManager.BP.argumentAssistanceDragTotalCounter+=aa),this.e1[Tb.Drag]=0);0<Xa&&(this.formulaAssistanceTelemetryManager.pJ("m"),this.sHa||(this.formulaAssistanceTelemetryManager.BP.argumentAssistanceMoveTotalCounter+=Xa),this.e1[Tb.Move]=0)}}Object(h.a)(nb,"FormulaAssistanceDragControl",
null,[]);var Tb;(function(aa){aa.Drag="drag";aa.Move="move"})(Tb||(Tb={}));Object(h.b)("FormulaAssistanceDragMode",Tb);class qb extends dd.a{constructor(aa,Xa,Lb,kc,Nc,ad,sd){super(qb.WKa(cb.a.O4(aa),O.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage"),sd));this.$=aa;this.zj=Xa;this.functionInfoManager=Lb;this.formulaAssistanceUIControl=kc;this.formulaAssistanceTelemetryManager=Nc;this.pluginScheduler=ad;this.htmlSanitizationHelper=sd;this.$2a=null;this.j$=0;this.Gq=null;this.B_c=
!1;this.Ula=this.Ko=null;this.tla=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.nmf=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=ce=>{this.u1d(ce);1===ce?this.formulaAssistanceTelemetryManager.pJ("c"):this.formulaAssistanceTelemetryManager.pJ("e")};this.qSa=ce=>{const Ce={};Ce[z.a.VJ]="ArgumentAssistanceCard";const ve={};ve.FunctionName=ce.functionName;Ce[z.a.mdd]=
ve;this.$.Yc(802602464,0,8,Ce)};this.dg=()=>{this.qv.clear()};this.lXi=ce=>{ce.button===Sys.UI.MouseButton.leftButton&&ce.target&&(la.g(ce),this.$2a&&this.$2a.ITa(ce))};this.Ht=()=>{void 0!==this.Ko&&null!==this.Ko&&this.Ko()};this.jl=cb.a.O4(aa);this.lBi=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage");this.jl?(this.jTd(),this.Gq=new Ee(this.$,this.formulaAssistanceUIControl,0,Bd.a.cfd),O.EwaSettings.isChangeGateEnabled("OfficeVSO:7457690_ArgumentAssistanceOnEditEnded")&&
I.h(this.$).oc.rm(this.dg),this.qv=new nb(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)):(this.$2a=new We(this.domElement,this.$.wC,void 0,cb.a.dN()),this.Gc.la("mousedown",this.lXi),aa=$get(t.Cfd,this.zj),this.zj.insertBefore(this.domElement,aa));I.h(this.$).view.Vs(this.Ht)}Bse(aa){this.addHandler("FAFunctionNameUpdated",aa)}XYf(aa){this.removeHandler("FAFunctionNameUpdated",
aa)}ste(aa){this.addHandler("FAParameterSelectionChangedOld",aa)}vZf(aa){this.removeHandler("FAParameterSelectionChangedOld",aa)}rte(aa){this.addHandler("FAParameterSelectionChanged",aa)}uZf(aa){this.removeHandler("FAParameterSelectionChanged",aa)}set_visible(aa){this.jl?aa||this.a9b():Sys.UI.Control.prototype.set_visible.call(this,aa);return aa}a9b(){this.formulaAssistanceUIControl&&(this.Ko=null,this.qv.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Ula=null,this.Gq.If=!1)}show(aa){this.jl||
(this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceRender"]),this.$2a.setVisible(!!aa),this.formulaAssistanceTelemetryManager.rv(["argumentAssistanceRender"]),this.B_c&&(this.B_c=!1,this.formulaAssistanceTelemetryManager.Pua("argumentAssistanceOverall")))}VOd(){this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceComputation"]);const aa=I.h(this.$).Mh,Xa={content:aa.text,caretPosition:aa.textBox.caretPosition};
(this.tla?this.pluginScheduler.getRequester().argumentAssistance(Xa,0):this.pluginScheduler.requester().argumentAssistance(Xa)).then(Lb=>{0===Lb.kind?Lb.payload?(this.formulaAssistanceTelemetryManager.rv(["argumentAssistanceComputation"]),this.UMj(this.Atc(Lb.payload),aa.textBox.domElement)):this.a9b():this.formulaAssistanceTelemetryManager.rv(["argumentAssistanceComputation"],!1);return null})}update(aa,Xa,Lb,kc){if(!this.jl&&aa){this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.B_c=!0;var Nc=this.$.listSeparator;try{var ad=$get(t.Efd,this.zj);const sd=$get(t.xfd,this.zj);ad.innerText="";sd.innerText="";const ce=$get(t.$0e,this.zj),Ce=aa.Params.split(t.Icd);ad=[];for(let ve=0,De=ce.rows.length;ve<De;ve++){const le=ce.rows[ve];ja.DOMElementExtensions.setVisible(le,ve<Ce.length);let qf=Ce[ve];const Nf=t.$7i+ve+"_",Tf=aa.NameDataStrings;$get(Nf+t.uIb,le).innerText=Tf;$get(Nf+t.iHd,le).innerText=Tf;if(qf){const Oa=Ce[ve].split(Nc),Fb=qb.Hrd(Oa[Oa.length-
1]),$b=qb.jwi(aa);Fb&&($b&&(2<Oa.length?(Oa[Oa.length-2]+="1",Oa[Oa.length-3]+="1"):n.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Tf,Oa.length.toString(),Xa)),qb.jVg(Oa,$b,Xa,aa));qf=Oa.join(Nc.toString()+" ");Ce[ve]=qf;Lb<Oa.length?(ad[ve]=Oa[Lb],n.ULS.shipAssertTag(537162072,0,!!Oa[Lb]&&1<=Oa[Lb].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
Lb,Oa.length,Tf,ve),Oa[Lb]=`${"<b>"}${Oa[Lb]}${"</b>"}`,qf=Oa.join(Nc.toString()+" ")):n.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+Lb+"currRowParamsArray.Length = "+Oa.length+", current row = "+ve);kc&&n.ULS.sendTraceTag(558474578,0,50,`formula '${Tf}', ${Oa.length} params, isElipsis = ${Fb}, isPairsParamsFormula = ${$b}, currentParameterIndex = ${Xa}`)}this.lBi?this.htmlSanitizationHelper.jh($get(Nf+t.xsc,le),"("+(qf||
"")+")"):$get(Nf+t.xsc,le).innerHTML="("+(qf||"")+")"}kc?this.raiseEvent("FAFunctionNameUpdated",new Hd(aa.NameDataStrings,Ce)):this.raiseEvent("FAParameterSelectionChangedOld",new gd(Ce,ad,Lb));ce.className=jb.a.kAh+(this.functionInfoManager.ojc(aa)?"-udf":"")}catch(sd){throw n.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",aa.NameDataStrings,Xa,sd),sd;}this.formulaAssistanceTelemetryManager.rv(["argumentAssistanceComputation"])}}dispose(){this.jl||
(this.Gc.KC(),ib.a.Ja(this.Gc),I.h(this.$).view.Xq(this.Ht),ib.a.Ja(this.$2a),this.$2a=null);this.jl&&(ib.a.Ja(this.Gq),O.EwaSettings.isChangeGateEnabled("OfficeVSO:7457690_ArgumentAssistanceOnEditEnded")&&I.h(this.$).oc.dm(this.dg));this.functionInfoManager=this.$=null;super.dispose()}Atc(aa){const Xa=new $e;Xa.functionRenderingInfo=aa;Xa.cardMode=this.j$;this.sMd(Xa);return Xa}sMd(aa){aa.callbacks=new ye;aa.callbacks.onHelpLink=this.Aid(aa.functionRenderingInfo);aa.callbacks.onCardModeChange=this.onCardModeChange;
aa.callbacks.onFeedback=this.qSa}UMj(aa,Xa){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceRender"]);const Lb={};Lb.zoomLevel=ea(this.$);this.formulaAssistanceUIControl.updateContext(Lb);this.Ko=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Xa,aa,()=>{})};this.Ko();this.Dwc();this.Tsc(aa);this.qv.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Ko,
()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.Gq.If=!0;this.formulaAssistanceTelemetryManager.rv(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Pua("argumentAssistanceOverall")}}Aid(aa){return()=>{N(this.$,aa.helpID,aa.isUDF)}}jTd(){const aa=Md.a.get(z.a.kqb);this.j$=aa?parseInt(aa,10):qb.q9c;this.formulaAssistanceTelemetryManager.o6f(this.j$)}Tsc(aa){var Xa=aa.functionRenderingInfo.functionName;this.Ula&&wa.a.equals(this.Ula,Xa,!0)?(Xa=se.a.map(aa.functionRenderingInfo.signatures,
Lb=>{let kc="";0<=Lb.signatureParams.activeParam&&Lb.signatureParams.activeParam<Lb.signatureParams.params.length&&(kc=Lb.signatureParams.params[Lb.signatureParams.activeParam]);return kc}),this.raiseEvent("FAParameterSelectionChanged",new Xc(Xa))):(this.Ula=Xa,aa=se.a.map(aa.functionRenderingInfo.signatures,Lb=>Lb.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Hd(Xa,aa)))}u1d(aa){this.j$=aa;try{Md.a.Bs(z.a.kqb,aa.toString(),tc.AFrame.PO)}catch(Xa){n.ULS.sendTraceTag(537162070,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Xa.message}`)}}Dwc(){const aa=this.formulaAssistanceUIControl.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.pJ(aa)}static Hrd(aa){return wa.a.contains(aa,t.$9b,!0)}static jwi(aa){return!!aa&&wa.a.n3a(aa.NameDataStrings,"IFS")}static jVg(aa,Xa,Lb,kc){try{if(!aa||2>aa.length)n.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${kc.NameDataStrings}', ${aa?aa.length.toString():
"currRowParamsArray == null"} params, isPairsParamsFormula = ${Xa}, currentParameterIndex = ${Lb}.`);else{var Nc=aa.pop().toString();for(let ad=aa.length-1;ad<Lb;ad++){const sd=aa[ad].trim();if(Xa){const ce=aa[ad-1].trim();aa.push(qb.zQh(ce,sd))}else{const ce=qb.hgf(sd);aa.push(qb.C1e(ce))}}aa.push(Nc)}}catch(ad){throw n.ULS.shipAssertTag(537162068,0,!1,`AppendNewOptionalParameters Exception. formula '${kc.NameDataStrings}', ${aa?aa.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${Xa}, currentParameterIndex = ${Lb}.
Exception: ${ad}`),ad;}}static zQh(aa,Xa){aa=qb.hgf(aa);const Lb=qb.M7e(aa);Xa=qb.M7e(Xa);return qb.C1e(aa,!0,!!Lb&&!!Xa&&Lb!==Xa)}static hgf(aa){var Xa=aa.match(qb.eDd);aa=wa.a.trimEnd(wa.a.trimStart(aa,t.zNf),t.yNf);if(Xa&&Xa.length){Xa=Xa[Xa.length-1];const Lb=Number.parseLocale(Xa)+1;aa=aa.replace(Xa,Lb.toString())}else aa=`${aa}${1}`;return aa}static C1e(aa,Xa=!1,Lb=!1){let kc="[{0}]";Xa&&(kc=Lb?"[{0}":"{0}]");return String.format(kc,aa)}static M7e(aa){return(aa=aa.match(qb.eDd))&&aa.length?
aa[0]:null}static WKa(aa,Xa,Lb){if(aa)return document.createElement("div");aa=String.format(t.lOf,t.jOf,t.iHd,jb.a.eUe,t.uIb,jb.a.dUe,t.xsc);var kc=String.format(t.lOf,t.kOf,t.iHd,jb.a.eUe,t.uIb,jb.a.dUe,t.xsc);aa=String.format(t.OOh,t.POh,jb.a.ZUe,jb.a.zxh,x.a.uo,t.$0e,aa,kc);kc=document.createElement("div");Xa?Lb.jh(kc,aa):kc.innerHTML=aa;return kc.firstChild}}qb.eDd=RegExp("\\d+");qb.q9c=0;Object(h.a)(qb,"FormulaArgumentAssistanceControlDeprecated",dd.a,[352]);class Kb{constructor(){this.fia=this.Eta=
this.Fta=!1;this.mNf=40;this.rFe=41;this.l1a=this.NGd=this.OGd=this.vIb=0;this.WDf=!0;this.pFd=!1;this.i_e=this.pRd=-1}}Object(h.a)(Kb,"ParseContext",null,[]);var jc=a(424),Ac=a(937),Jc=a(331),hd=a(862),Cd=a(973);class ac extends Ac.a{constructor(aa,Xa,Lb,kc){super(aa,Xa);this.formulaAssistanceControl=Lb;this.formulaAssistanceTelemetryManager=kc;this.VMf=!1;this.eTa=null;this.Pod=0;this.kJa=this.vJc=null;this.gQ=0;this.Iqb=Xa.textBox;this.jl=cb.a.O4(aa);this.Omj=O.EwaSettings.vb()}get wBb(){return Object(jc.a)(wb,
this.$.pb.kh)}get rK(){return this.formulaAssistanceControl.ye}set rK(aa){this.formulaAssistanceControl.ye=aa}get N6a(){return this.gb.N6a}get Nii(){var aa=this.Iqb.text;let Xa=!1;if(0>=aa.length)return Xa;const Lb=this.$.Mb.Kc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),kc=I.h(this.$).ha.ra.activeCell.clone();var Nc=aa.charCodeAt(0);this.kJa="";this.gQ=this.w5g(aa,this.Iqb.caretPosition);if(61===Nc&&-1!==this.gQ){Nc=0;for(var ad=this.gQ-1;1<=ad&&!(this.gQ-ad>ac.fMi);ad--)if(ac.q_g.includes(aa.charAt(ad))){Nc=
ad;break}Nc=aa.substring(Nc+1,this.gQ);aa=""!==Nc?this.$.Bb.getItemByName(Nc):null;ad=this.gQ;for(let sd=this.gQ+1;sd<=this.gb.textBox.caretPosition;sd++)if("["===this.gb.text.charAt(sd))ad=sd;else break;this.gQ=ad;aa&&2===aa.type?(Xa=!0,this.kJa=Nc):I.h(this.$).tb.uh(kc)&&(Xa=!0,this.kJa="")}Lb.stop();this.Pod=Lb.Fc;n.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.Pod} milliseconds`);
return Xa}get key(){return m.a.Wwb}get calcManager(){this.vJc||(this.vJc=Object(X.c)({TV:266,new:G.f,registry:this.$.da,Y3:O.EwaSettings.uX}));return this.vJc}get FVd(){if(null!=this.eTa)return this.eTa;if(!O.EwaSettings.xa(128))return this.eTa=!1;const aa=I.h(this.$).ha.ra.activeCell.clone();if(1!==aa.fxf||!aa.left||I.h(this.$).ha.ra.hCb())return!1;let Xa=this.formulaAssistanceControl.tableManager.Qp(aa);if(Xa)return this.eTa=!1;--aa.left;--aa.right;if(!aa.wz)return!1;Xa=this.formulaAssistanceControl.tableManager.Qp(aa);
return this.eTa=!!Xa&&aa.top===Xa.top&&this.formulaAssistanceControl.tableManager.Udh(Xa,I.h(this.$))}Wh(aa,Xa){this.formulaAssistanceControl.gb=this.gb;-1470715894!==Xa&&-1231471547!==Xa||!this.ZNe()||(this.rK=!1);return super.Wh(aa,Xa)}CDd(){var aa=this.N6a;if(aa||this.FVd)if(this.formulaAssistanceControl.gb=this.gb,this.formulaAssistanceTelemetryManager.Oqb.formulaAssistanceRequestAttemptedCounter++,this.ZNe())if(!aa&&this.FVd)this.formulaAssistanceControl.yxe();else if(this.Nii){if(aa=this.$.Mb.Kc("LoadingUIShown",
"FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.Axe(),aa.stop(),this.Iqb.text.endsWith("[")&&"["!==this.Iqb.text.charAt(this.Iqb.text.length-2)){const Xa=""===this.kJa?this.formulaAssistanceControl.tableManager.Xi:Object(nc.a)(Jc.a,this.$.Bb.getItemByName(this.kJa));n.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${Xa.ej} in ${aa.Fc} ms with cell edit regression time of ${this.Pod} ms and popup visibility - ${this.rK}`)}}else this.formulaAssistanceControl.wqb(),
this.VMf&&(this.VMf=this.rK=!1);else this.formulaAssistanceTelemetryManager.Oqb.formulaAssistanceRequestOptimizedCounter++;else this.rK=!1}Di(){this.Omj||(this.eTa=null,this.FVd&&this.formulaAssistanceControl.AZ())}dg(){this.rK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Nwc();this.jl&&this.$Gi()}ZJd(aa,Xa){return this.formulaAssistanceControl.Wh(aa,Xa)}$Gi(){O.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.uaa&&
!this.formulaAssistanceControl.Nia&&!this.formulaAssistanceControl.Moa&&(this.formulaAssistanceTelemetryManager.wJ.dismissSmartSuggestionImplicitlyCounter++,this.formulaAssistanceControl.uaa=!1);this.formulaAssistanceControl.HI&&(this.formulaAssistanceTelemetryManager.UC.smartSuggestionShownCounter++,this.formulaAssistanceControl.HI=!1,Object(hd.a)(Cd.a));this.formulaAssistanceControl.Moa&&(this.formulaAssistanceTelemetryManager.UC.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.Moa=
!1,Object(hd.a)(Cd.c));this.formulaAssistanceControl.DTa&&(this.formulaAssistanceTelemetryManager.UC.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.DTa=!1);this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.UC.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1);this.formulaAssistanceControl.UMa&&(this.formulaAssistanceTelemetryManager.UC.isCellContentFormulaCounter++,this.formulaAssistanceControl.UMa=
!1)}w5g(aa,Xa){let Lb=0,kc;for(;-1!==Lb;)if(Lb=aa.indexOf("[",Lb+1),-1!==Lb&&Lb<Xa&&(kc=aa.indexOf("]",Lb+1),-1===kc||kc>=Xa))return Lb;return-1}ZNe(){const aa=this.gb.text,Xa=this.gb.textBox.caretPosition,Lb=this.formulaAssistanceControl.nca,kc=this.formulaAssistanceControl.Vla;if(this.rK&&wa.a.equals(aa,Lb,!0)&&Xa===kc)return!1;this.formulaAssistanceControl.nca=aa;this.formulaAssistanceControl.Vla=Xa;return!0}}ac.q_g=" !%&'()*+,-/:;<=>@[]^{|}~".split("");ac.fMi=255;Object(h.a)(ac,"FormulaAutoCompleteListAutoCompleteBehavior",
Ac.a,[]);var Lc;(function(aa){aa[aa.function=0]="function";aa[aa.field=1]="field";aa[aa.definedName=2]="definedName";aa[aa.letVariable=3]="letVariable";aa[aa.tableColHeaderName=4]="tableColHeaderName";aa[aa.tableSpecialStructRef=5]="tableSpecialStructRef";aa[aa.pendingData=6]="pendingData";aa[aa.tableNamedObject=7]="tableNamedObject"})(Lc||(Lc={}));Object(h.b)("ItemType",Lc);var rd=a(1123),Yd=a(1122);class ie{constructor(aa){this.index=aa}execute(aa){aa.push(this.index)}}Object(h.a)(ie,"AppendIndexOperation",
null,[366]);class Je{execute(){}}Object(h.a)(Je,"NopIndexOperation",null,[366]);class ff{constructor(aa,Xa){this.jcj=aa;this.Gzf=Xa}execute(aa){for(let Xa=0;Xa<aa.length;Xa++)aa[Xa]===this.jcj&&(aa[Xa]=this.Gzf)}}Object(h.a)(ff,"ReplaceIndexOperation",null,[366]);var Ae=a(83);class pf{constructor(aa,Xa){this.$=aa;this.items=Xa;this.lNa=cb.a.lNa(this.$)}pKe(aa,Xa){const Lb=new ie(Xa);if(!this.lNa)return Lb;aa=this.qBi(aa,Xa);return null!=aa?this.items[aa].UCb?new ff(aa,Xa):new Je:Lb}qBi(aa,Xa){const Lb=
this.items[Xa];n.ULS.shipAssertTag(537162075,0,!!Lb,"Internal error: invalid item index");aa=Ae.where(Ae.asEnumerable(aa),kc=>this.items[kc].name===Lb.name);return Ae.Ct(aa)?Ae.first(aa):null}}Object(h.a)(pf,"FilterItemOperationFactory",null,[]);var he=a(120),Va=a(861);class bc{constructor(){this.evaluation=this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(h.a)(bc,"CompletionItem",null,[]);const yc=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${x.a.uo}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${x.a.uo}'>{5}</td>\r\n</tr>`,
Hc=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${x.a.uo}'></td>\r\n\t<td id='${"item_type_cell"}' class='${x.a.uo}'>{2}</td>\r\n</tr>`,Zc=`<td>\r\n\t<div class='${x.a.kv}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,Sd=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${x.a.uo}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${x.a.uo}'>{2}</td>\r\n</tr>`;
class ue extends rd.a{constructor(aa,Xa,Lb,kc,Nc,ad){super(aa,Xa);this.htmlSanitizationHelper=Nc;this.Zra=null;this.Bfb=this.qyc=0;this.Rsb=null;this.a1e=Lb;this.Uwb=kc;this.formulaAssistanceControl=ad;this.ap=[];this.oW=[];this.jl=cb.a.O4(aa);this.lui=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")}bZc(aa){this.addHandler("FLBSelectedRowChanged",aa)}SNd(aa){this.removeHandler("FLBSelectedRowChanged",aa)}O0b(aa){this.addHandler("ACLBUpdated",aa)}Rvc(aa){this.removeHandler("ACLBUpdated",
aa)}get Zkc(){return 0<this.Bfb&&this.Bfb===this.ap.length}get Oyi(){return 0<this.Bfb}get ye(){return super.ye}set ye(aa){super.ye=aa;aa||(this.qyc=0,this.oe=null);0===this.qyc?ja.DOMElementExtensions.setVisible(this.Uwb,aa&&!this.jl):ja.DOMElementExtensions.setVisible(this.Uwb,!1)}get Jj(){return this.Zra}set Jj(aa){this.sCa(this.Jj);if(aa){this.a1e.innerText="";this.Zra=aa;var Xa=this.sCa(this.Jj);const Lb=aa.rowIndex+1,kc=$get("description_cell"+Lb,aa);this.Uwb.innerText=kc.innerText;const Nc=
$get("item_type_cell",aa);this.oe=Xa=Xa.innerText;this.qyc="field"===Nc.innerText?1:"definedName"===Nc.innerText?2:"letVariable"===Nc.innerText?3:"tableColHeaderName"===Nc.innerText?4:"tableSpecialStructRef"===Nc.innerText?5:"pendingData"===Nc.innerText?6:"tableNamedObject"===Nc.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Yd.a(this.ap.length,Lb,Xa,kc.innerText));this.cyc(aa)}}get uUa(){return this.Uwb}get zHa(){return this.formulaAssistanceControl}get x0(){return this.qyc}dispose(){super.dispose();
this.Zra=this.a1e=this.Uwb=null}HCc(aa,Xa,Lb,kc=0){this.jl||this.N7(!1);let Nc="";Lb&&(Nc+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${jb.a.h$g}'>${Lb}</td></tr></table>`);Nc+=`<table class='${this.N5}' aria-live='off'><tbody>`;const ad=new sb.a;for(let ce=0,Ce=this.oW.length;ce<Ce;ce++)Nc+=this.j$e(aa[this.oW[ce]],ce+1,Xa,kc),this.jl&&ad.add(this.E3e(aa[this.oW[ce]]));let sd=this.oW.length;for(let ce=0,Ce=this.ap.length;ce<Ce;ce++)this.oW.includes(this.ap[ce])||(sd++,Nc+=
this.j$e(aa[this.ap[ce]],sd,Xa,kc),this.jl&&ad.add(this.E3e(aa[this.ap[ce]])));Nc+="</tbody></table>";this.lui?this.htmlSanitizationHelper.jh(this.Nf,Nc):this.Nf.innerHTML=Nc;this.An=ja.DOMElementExtensions.hk(this.domElement,this.N5);this.jl&&(this.Rsb=ad.toArray());this.jl?(this.ye=!0,this.zHa.set_visible(!0)):(this.N7(!0),this.$Sg(!!Lb))}xKa(aa,Xa,Lb,kc="",Nc=0,ad=!1){if(aa){var sd=[],ce=[];this.Bfb=0;var Ce=new pf(this.$,aa);if(Xa){var ve=!!Xa&&0<Nc,De=ve&&91===Xa.charCodeAt(Nc+1)?Nc+2:Nc+1;ad=
ve?Xa.length===De:!1;ve&&Xa.length===Nc&&O.EwaSettings.xa(128)&&(ad=!0);var le=null;!ad&&ve&&Xa.length>Nc+1&&(le=Xa.substring(De,Xa.length));if(Xa)for(let qf=0,Nf=aa.length;qf<Nf;qf++)if(ve=aa[qf].name,!aa[qf].yri){De=Ce.pKe(sd,qf);aa[qf].UCb&&this.Bfb++;if(!le&&!ad||0===aa[qf].itemType)({mgf:sd,uQf:ce}=this.pZe(Xa,ve,Lb,De,sd,ce));le&&1===aa[qf].itemType&&({mgf:sd,uQf:ce}=this.pZe(le,ve,!0,De,sd,ce));ad&&1===aa[qf].itemType&&De.execute(sd)}}else for(Lb=0;Lb<aa.length;++Lb)if(aa[Lb].UCb||ad)le=Ce.pKe(sd,
Lb),le.execute(sd),le.execute(ce),aa[Lb].UCb&&this.Bfb++;this.oW=ce;this.ap=sd;this.HCc(aa,Xa,kc,Nc)}}V5j(aa){if(aa&&!(1<aa.length)){var Xa=[],Lb=[];Xa.push(0);Lb.push(0);this.oW=Xa;this.ap=Lb;this.HCc(aa,"","",0)}}Xya(){this.Jj&&super.Xya()}Kfj(aa,Xa){this.raiseEvent("ACLBUpdated",new Yd.a(aa,void 0,void 0,Xa))}mng(aa){const Xa=this.An.rows[aa];return(!this.Jj||this.Jj!==Xa)&&aa<this.An.rows.length?(this.Jj=Xa,!0):!1}static F3e(aa){switch(aa){case 0:return 3;case 2:return 100;case 1:case 6:return 103;
case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}}onItemClick(aa){la.g(aa.Ea);0===this.x0||2===this.x0||3===this.x0||4===this.x0||5===this.x0||7===this.x0?(this.raiseEvent(Va.a.S5a),this.Xya()):1===this.x0?this.zHa.Ty(!1):(this.zHa.Ty(!1),aa=I.h(this.$),aa.No(!1),aa.focus());return!0}$Sg(aa){this.Msa();if(aa){var Xa=this.An.offsetWidth+(this.ap.length>this.bI?he.a.Ku:0);aa=$get("list_column_header");aa.offsetWidth>Xa&&ja.DOMElementExtensions.Sv(this.Nf,aa.offsetWidth);
Xa=this.Nf.getElementsByClassName(this.LV);for(let Lb=0;Lb<Xa.length;Lb++)Xa[Lb].style.width=H.HelperMethods.zc(aa.offsetWidth)}}j$e(aa,Xa,Lb,kc){if(1===aa.itemType){const Nc=U.a.Og(aa.name),ad=U.a.Og(kc?Lb.substring(kc+1,Lb.length):Lb);let sd=0;Nc.substring(0,ad.length).toLowerCase()!==ad.toLowerCase()&&(sd=ue.MSj(Nc,t.Bqg,ad));Lb="";Lb=0<=sd?Lb+(Nc.substring(0,sd)+"<b>"+Nc.substring(sd,sd+ad.length)+"</b>"+Nc.substring(sd+ad.length,Nc.length)):Lb+Nc;kc=kc?String.format(Zc,x.a.zVe,U.a.OQ(V.a.Le(0)),
y.a.instance.ga(712)):"";return String.format(Hc,kc,Xa,Lc[aa.itemType],this.LV,Lb)}if(5===aa.itemType)return String.format(Sd,"",Xa,Lc[aa.itemType],this.LV,U.a.Og(aa.name),U.a.Og(aa.Pja));if(4===aa.itemType)return String.format(Sd,"(...)",Xa,Lc[aa.itemType],this.LV,U.a.Og(aa.name));if(6===aa.itemType)return kc=kc?String.format(Zc,x.a.zVe,U.a.OQ(V.a.Le(0)),y.a.instance.ga(712)):"",String.format(yc,kc,this.LV,U.a.Og(aa.name),U.a.Og(aa.Pja),Xa,Lc[aa.itemType]);kc=String.format(Zc,2===aa.itemType||3===
aa.itemType?x.a.tDh:x.a.rDh,U.a.OQ(V.a.Le(0)),y.a.instance.ga(709));return String.format(yc,kc,this.LV,U.a.Og(aa.name),U.a.Og(aa.Pja),Xa,Lc[aa.itemType])}E3e(aa){const Xa=new bc;Xa.label=aa.label;Xa.textEdit=aa.textEdit;Xa.kind=ue.F3e(aa.itemType);Xa.type=aa.UCb?1:0;if(O.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===Xa.kind){const Lb=this.formulaAssistanceControl.PZh(aa.label);Xa.detail=Lb?Lb:aa.Pja}else Xa.detail=aa.Pja;return Xa}pZe(aa,Xa,Lb,kc,Nc,ad){wa.a.equals(Xa,
"Pretend this is the line.",!1)&&0<Nc.length||wa.a.fG(Xa,aa)?(kc.execute(Nc),kc.execute(ad)):Lb&&aa.length>=t.Xdh&&ue.Foh(Xa,t.Bqg,aa)?kc.execute(Nc):!Lb&&aa.length>=t.Wdh&&wa.a.contains(Xa,aa,!0)&&kc.execute(Nc);return{mgf:Nc,uQf:ad}}static Foh(aa,Xa,Lb){for(const kc of Xa)if(Xa=aa.split(kc),!(2>Xa.length))for(const Nc of Xa)if(wa.a.fG(Nc,Lb))return!0;return!1}static MSj(aa,Xa,Lb){for(const kc of Xa)if(Xa=aa.toLowerCase().indexOf((kc+Lb).toLowerCase()),0<Xa)return Xa+1;return-1}}Object(h.a)(ue,"FormulaAutoCompleteListBox",
rd.a,[351]);class Fe{constructor(){this.y9=this._name=null}get name(){return this._name}get toolTip(){return this.y9}}Object(h.a)(Fe,"LETVariableInfo",null,[]);class Be{constructor(){this._name=null}get name(){return this._name}}Object(h.a)(Be,"TableColHeaderNameInfo",null,[]);class Ua{constructor(){this._name=null}get name(){return this._name}}Object(h.a)(Ua,"TableNamedObjectInfo",null,[]);class Rb{constructor(){this.y9=this._name=null}get name(){return this._name}get toolTip(){return this.y9}}Object(h.a)(Rb,
"TableSpecialStructRefInfo",null,[]);var sc=a(168),Mc=a(29),id=a(104),Ed=a(934),ee=a(260),oe=a(53),Xe=a(150);class mf{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(h.a)(mf,"FormulaAutoCompleteCallbacks",null,[]);class wf{constructor(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}}Object(h.a)(wf,"FormulaAutoCompleteRenderingInfo",null,[]);class Kf{}Object(h.a)(Kf,"RunExperimentRequest",null,
[]);class af extends zb.a{constructor(aa,Xa,Lb,kc,Nc,ad,sd,ce,Ce,ve){super(aa);this.functionInfoManager=Xa;this.calcManager=kc;this.instantaneousSupportInformationManager=Nc;this.formulaAssistanceUIControl=sd;this.formulaAssistanceTelemetryManager=ce;this.pluginScheduler=Ce;this.egc=!1;this.y5=this.Hvd=this.GV=this.Xi=this.AHa=this.Gq=null;this.I7b=this.NCc=this.Uub=this.uPe=this.B3=this.lcc=this.z4a=0;this.yAc=!1;this.Esc=this.pja=null;this.columnName="";this.jCe=this.z9c=!1;this.KKa=[];this.fQ=
null;this.VOb=[];this.ofa=this.Ffd=this.Ko=null;this.Nia=this.uaa=this.UMa=this.isCellContentOnlyEqualDuringEdit=this.DTa=this.Moa=this.HI=this.Ufa=!1;this.nca=null;this.Vla=0;this.y6d=null;this.Bqd=!1;this.onRestoreFocus=()=>{};this.Khb=void 0;this.tla=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.nmf=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.Pld=()=>{this.jl&&this.raiseEvent(af.Ied,
null)};this.kZe=()=>{this.pja=!1;this.GV=this.gb.text;this.$g.xKa(this.mr,this.GV,!0,this.columnName,void 0,!1);1===this.$g.ap.length&&1===this.$g.oW.length?(this.set_visible(!1),this.jCe||this.Jod()):this.show()};this.KEd=De=>{if(Id.a(De))-315732528!==De.Errors[0].MessageId&&n.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${Mc.a.qc(De.Errors)}`);else if((De=De.Result)&&De.length){this.Xi.zO||(this.Xi.zO={},this.Xi.zO.HeadersList=
[]);this.Xi.zO.IsFullTableHeaders=!0;for(let le=0;le<De.length;++le)this.Xi.zO.HeadersList[le]={},this.Xi.zO.HeadersList[le].Index=le,this.Xi.zO.HeadersList[le].Name=De[le];this.SPf(!0);this.GV=this.h$e();this.$g.xKa(this.mr,this.GV,!0,void 0,void 0,!0);this.show()}else n.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.JEd=De=>{De=Wa.a.Ue(De.data);n.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${Mc.a.qc(De)}`)};
this.DBf=(De,le)=>{this.gridView.eb||this.gridView.ei||this.mGb(null===le||void 0===le?void 0:le.cell)};this.n6=(De,le)=>{this.AQd(le.newValue)};this.Zc=()=>{this.set_visible(!1)};this.IFf=()=>{this.ofa=this.AHa=null};this.rj=()=>{this.jl&&this.O2a()};this.onFunctionInfoLoaded=()=>{this.wqb()};this.tza=()=>{this.Tka?(this.AHa=this.ofa=null,this.wqb()):this.Xg.Tk&&this.yxe()};this.Zca=()=>{this.fQ&&N(this.$,this.fQ.HelpId,this.fQ.IsDynamicUdf);return!0};this.bda=(De,le)=>{0==le.Uq&&(170==le.Gf.operation.operationName&&
this.formulaAssistanceTelemetryManager.eEb++,this.$.userOperationManager.ao(this.bda))};this.LPa=(De,le)=>{0==le.Uq&&(12==le.Gf.operation.operationName&&this.$.userOperationManager.jr(this.bda),this.$.userOperationManager.ao(this.LPa))};this.O2a=()=>{this.jl&&this.Txd();O.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.HI&&(this.uaa=!0);this.vF&&this.gb.eb&&this.Bna();this.Ko=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.D2b),
this.Gq.If=!1);this.Bqd=!1};this.EKf=()=>{this.vF&&this.Bna();this.fcg();1===this.Z4f.type&&O.EwaSettings.vb()&&!this.gb.text.includes("\n")&&this.YId(this.Z4f)};this.onDismiss=()=>{this.ye=!1;this.gridView.Mh.textBox.focus()};this.qSa=()=>{const De={};De[z.a.VJ]=this.$g.Zkc?"SmartSuggestionsCard":this.$g.Oyi?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Yc(802602464,0,8,De)};this.cEd=(De,le)=>{this.$g.mng(le);this.jl&&(this.BJa=!0)};this.bEd=De=>{this.jl&&(this.yJa=!0);this.vF?
(this.FGe(),this.E3f(),this.gridView.Iaa.e6f(),this.gridView.Mh.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):De.textEdit?this.Msb(De.textEdit):this.Ty(!0)};this.gridView=I.h(aa);this.domElement.className=jb.a.YSe;this.Xg=ad.$6c(aa,Lb);this.v8b=new de(aa);this.aIg=Lb;af.Kgc||(af.Kgc=af.WKa());O.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")?ve.jh(this.domElement,af.Kgc):this.domElement.innerHTML=af.Kgc;this.eDd=RegExp("\\d+");ee.d(this.style,this.$.isChromeRtl);
this.Ija=new qb(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler,ve);Xa=$get(t.Cfd,this.domElement);Lb=$get(t.xfd,this.domElement);kc=$get(t.Efd,this.domElement);this.eAg=new ue(this.$,Xa,kc,Lb,ve,this);this.Xg.H0b(this.tza);this.functionInfoManager.QGa(this.onFunctionInfoLoaded);this.functionInfoManager.XPg(this.IFf);this.D2b=this.domElement;this.jl&&(this.$.ua.Yf(this.rj),this.$g.bZc(this.EKf),O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",
!1)&&(this.D2b=document.createElement("div")));this.TTa(!0);this.tfg(!0);this.$.domElement.appendChild(this.D2b);this.cUc=0;(ve=P.a(aa))&&this.KKa.push(new ac(aa,ve,this,this.formulaAssistanceTelemetryManager));this.KKa.push(new ac(aa,this.gridView.Xb,this,this.formulaAssistanceTelemetryManager));this.Nwb=this.KKa[0];this.Urb=this.KKa[this.KKa.length-1];aa.da.Ha(221,this);this.instantaneousSupportInformationManager||this.$.da.hb(268,De=>{this.instantaneousSupportInformationManager=De});this.FYe=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1);this.CTa=cb.a.lNa(this.$);this.uag=cb.a.Hqb(this.$);this.FCd=O.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.U0c=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");cb.a.aR(this.$)&&this.Apd();cb.a.dN()&&Xa.classList.add("ewa-fb-refactor");this.jl?this.gridView.ha.jC(this.Zc):this.gridView.ha.HT(this.Zc);this.Gq=new Ee(this.$,this.formulaAssistanceUIControl,1,Bd.a.efd,this.Pld)}zse(aa){this.addHandler(af.kfd,aa)}WYf(aa){this.removeHandler(af.kfd,
aa)}xse(aa){this.addHandler(af.Ied,aa)}UYf(aa){this.removeHandler(af.Ied,aa)}yse(aa){this.addHandler("FormulaAutoCompleteShown",aa)}VYf(aa){this.removeHandler("FormulaAutoCompleteShown",aa)}get ku(){return this.$g}get mr(){return this.ofa}get JMb(){return this.$g.oe}get W0e(){return this.$g}get C0e(){return this.Ija}get $g(){return this.eAg}get f2a(){return this.CTa?this.gb?this.gb.text:null:this.GV}get Nmf(){var aa;return 0===(null===(aa=this.h_e)||void 0===aa?void 0:aa.type)}get Yyi(){var aa;return 1===
(null===(aa=this.h_e)||void 0===aa?void 0:aa.type)}get_visible(){return void 0!==this.Khb?this.Khb:this.Khb=super.get_visible()}set_visible(aa){if(this.Khb===aa)return this.jl&&!aa&&this.O2a(),aa;this.Ija.set_visible(aa);this.jl&&!aa&&this.O2a();Sys.UI.Control.prototype.set_visible.call(this,aa);return this.Khb=aa}get ye(){return this.ku.ye}set ye(aa){this.jl&&!aa&&this.O2a();this.ku.ye=aa}get tableManager(){return this.aIg}get Tka(){return 0<this.gZ}get vF(){return this.Ufa}get tb(){return this.gridView.tb}F4g(aa,
Xa){this.ye&&(aa+=t.openParen,Xa++,this.mHd(aa,Xa));var Lb=Xa===aa.length||aa.charAt(Xa)===t.closeParen;if(!(0<Xa&&aa.charAt(Xa-1)===t.openParen&&Lb))return n.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${Xa} is invalid. Is cell empty: ${!aa.length}. Function exists in cell: ${!!this.fQ}`),!1;Lb=aa.substring(0,Xa).lastIndexOf(this.$.listSeparator);const kc=aa.substring(0,Xa-1).lastIndexOf(t.openParen);aa=aa.substring(-1===Lb&&-1===kc?1:Math.max(Lb,
kc)+1,Xa-1).trim();return this.functionInfoManager.kid(aa)?!0:(n.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.fQ}`),!1)}oni(aa,Xa){var Lb=this.F4g(aa,Xa);if(!Lb||!this.fQ)return n.ULS.shipAssertTag(537162051,0,!Lb||Lb&&!!this.fQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Czf:0,j_e:0};Lb=this.fQ.Params;Lb=Lb.replace(RegExp("[\\[\\]]",
"g"),"");const kc=aa.charAt(Xa-1)===t.openParen,Nc=kc?"":"(",ad=Xa===aa.length?")":"";var sd=this.$.listSeparator;sd=Lb.includes(sd)?Lb.indexOf(sd):Lb.length;return{returnValue:aa.substring(0,Xa)+Nc+Lb+ad+aa.substring(Xa,aa.length),Czf:kc?Xa:Xa+1,j_e:sd}}Ht(aa,Xa){this.jl&&void 0!==this.Ko&&null!==this.Ko&&this.Ko();this.jl||super.Ht(aa,Xa)}get p2b(){return this.y6d}get gZ(){return this.uPe}set gZ(aa){this.uPe=aa;aa||(this.B3=0)}get bLj(){if(null==this.Esc){const aa=this.$.ic;this.Esc=!!aa&&!aa.inEmbedView}return this.Esc}get Z4f(){return this.$g.Rsb[this.$g.Jj.rowIndex]}get h_e(){var aa,
Xa;return null===(Xa=null===(aa=this.$g)||void 0===aa?void 0:aa.Rsb)||void 0===Xa?void 0:Xa[0]}get d1e(){!this.Ffd&&this.pluginScheduler&&(this.Ffd=this.pluginScheduler.getFunctionsShortDescriptions());return this.Ffd}dispose(){if(this.$){this.TTa(!1);const aa=this.gridView;this.$.userOperationManager.ao(this.bda);this.$.userOperationManager.ao(this.LPa);aa&&(aa.ha&&(this.jl?aa.ha.xB(this.Zc):aa.ha.PR(this.Zc),cb.a.aR(this.$)&&aa.ha.Cna(this.DBf)),aa.view.Xq(this.yqc));this.jl&&this.$.ua&&this.$.ua.yg(this.rj)}this.functionInfoManager&&
(this.functionInfoManager.cdb(this.onFunctionInfoLoaded),this.functionInfoManager.Coj(this.IFf));this.Xg&&this.Xg.Lvc(this.tza);this.jl&&this.$g&&this.$g.SNd(this.EKf);cb.a.kic&&this.gb&&this.gb.MKb(this.n6);this.tfg(!1);ib.a.Ja(this.$g);ib.a.Ja(this.p2b);ib.a.Ja(this.Ija);ib.a.Ja(this.Gq);this.gb=this.functionInfoManager=this.Xg=null;ib.a.sc(this.KKa);this.Xi=this.ofa=this.Ija=this.KKa=null;super.dispose()}Fxa(){return!this.mr}Oui(){return!this.AHa}C3j(aa){this.Yyi&&1872288872===aa&&(this.formulaAssistanceTelemetryManager.rv(["autoCompleteSmartSuggestionActiveDismissing"]),
this.Nia=!0)}Wh(aa,Xa){if(!this.Fxa()){O.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.C3j(Xa);if(this.jl&&this.vF){if(125627505===Xa||267796030===Xa)return this.jl&&this.PEc(Xa),this.FGe(),this.E3f(),!1;if(1872288872===Xa)return this.Bna(),this.ye=!1,!0;if(this.$g.Zkc&&(-798660877===Xa||137938150===Xa))return!1}if(1!==this.$g.x0||125627505!==Xa&&267796030!==Xa)if(6===this.$g.x0){var Lb=aa.keyCode;13!==Lb&&9!==Lb||this.Ty(!1)}else{if(4===this.$g.x0||5===
this.$g.x0)return super.Wh(aa,Xa,!0);1===this.$g.oW.length&&(Lb=aa.keyCode,this.jCe=8===Lb||127===Lb||46===Lb?!0:!1)}else{if(this.Ty(!1)&&!this.Tka)return this.gridView.ha.Wh(aa,Xa);if(125627505===Xa&&this.Tka)return!0}}return super.Wh(aa,Xa)}Nwc(){this.Xg.Bdb();this.ofa=null;null==this.pja||this.pja||this.Wmc("NoFieldChosen",1,2,1);this.pja=null;this.gZ=0;this.y5=this.Hvd=this.Esc=null}wqb(){this.nmf&&this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceOverall"]);const aa=!!this.gb&&!ne.f(this.$.na);
let Xa=null;aa&&(Xa=this.gb.text,Xa.startsWith("=")&&(this.UMa=!0,1===Xa.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if(this.uag&&aa){const Lb={content:Xa,caretPosition:null};(this.tla?this.pluginScheduler.getRequester().functionSuggestion(Lb,0):this.pluginScheduler.requester().functionSuggestion(Lb)).then(kc=>{if(0===kc.kind){n.ULS.shipAssertTag(537162050,0,!!kc&&!!kc.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const Nc=Ae.toArray(Ae.select(Ae.asEnumerable(kc.payload.items),
ad=>af.Lch(ad)));this.gridView.Iaa.oTd(kc.payload,Xa);this.CTa&&(this.VOb=Nc,Y.AFrameworkApplication.ug||(this.U0c&&this.tb.n5(this.gridView.ha.ra.activeCell)?this.formulaAssistanceTelemetryManager.UC.smartSuggestionWouldSuggestInsidePivotCounter++:this.zxe(aa,!0)))}return null})}this.CTa&&aa&&this.uag||this.zxe(aa,!1)}h$e(){const aa=this.gridView.Ul?this.Nwb.gQ:this.Urb.gQ;this.NCc="@"===this.gb.text.charAt(aa+1)&&this.gb.textBox.caretPosition>aa+1?aa+2:aa+1;return this.gb.text.substring(this.NCc,
this.gb.textBox.caretPosition)}Axe(){this.scg()&&(this.Mkh(),this.mr&&(this.pja=!1,this.GV=this.h$e(),this.$g.xKa(this.mr,this.GV,!0,void 0,void 0,!0),this.show(),O.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Ija.a9b()))}yxe(){this.scg()&&(this.p2b&&this.p2b.cancel(),this.Xg.I7a?(this.Fxa()&&this.aJe(!0),this.get_visible()?this.kZe():this.y6d=sc.AsyncMethodContext.Cq(this.kZe,t.boh,oc.a.KNh,this.p2b)):this.AZ())}scg(){return this.gb?0<this.$.pb.DR||
!this.gb.text||!this.gb.eb?(this.set_visible(!1),!1):ne.f(this.$.na)?!1:!0:!1}Msb(aa){this.gb&&this.ye&&(this.Ppd(this.gb.text,aa),this.gb.textBox.caretPosition=aa.range.start.character+aa.newText.length,this.set_visible(!1))}Ty(){var aa;if(!this.gb||!this.ye)return!1;const Xa=this.$g.x0;this.formulaAssistanceTelemetryManager.z_f(ue.F3e(Xa));let Lb="";var kc=0;const Nc=this.gridView,ad=this.gb.text;var sd=0,ce=this.$g.oe,Ce=!1;if(0===Xa||2===Xa||3===Xa||7===Xa)Lb+=ad.substr(0,this.z4a)+this.$g.oe,
0!==Xa||this.$g.oe.endsWith(")")||(Lb+="("),kc=Lb.toString().length,Lb+=ad.substr(this.lcc),2===Xa&&(sd=4,ce="DefinedName",Ce=!0,this.set_visible(!1));else if(1===Xa)if(this.pja=!0,this.Tka){Lb+=ad.substr(0,this.gZ+2);!Lb.toString().endsWith(db.a.AU)&&O.EwaSettings.xa(128)&&(Lb+=db.a.AU);sd=this.$g.oe;sd=sd.replace("'","''");sd=sd.replace("[","'[");sd=sd.replace("]","']");if(this.z9c||this.qJh(sd))sd=db.a.RDi+sd+db.a.Ivj,Ce=!0;Lb+=sd;kc=Lb.length;sd=3;Xe.a("PulloutFieldAccepted")}else return this.gb.text=
this.$g.oe,this.set_visible(!1),Nc.No(!1),Nc.focus(),this.Wmc("FieldName",1,1,1),Xe.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===Xa)n.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),Lb+=ad.substr(0,this.NCc),wa.a.equals(this.$g.oe,"@ - "+this.instantaneousSupportInformationManager.Re.ThisRowStructRefString,!1)?Lb+="@":(Lb+=this.$g.oe,Ce=!0,this.set_visible(!1)),kc=Lb.length;else if(4===Xa){n.ULS.sendTraceTag(575776009,
0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");Lb+=ad.substr(0,this.NCc);Ce="";kc=!1;const ve=[39,91,93,64,35];for(let De=0;De<this.$g.oe.length;De++){const le=this.$g.oe.charCodeAt(De);ve.includes(le)&&(Ce+="'");Ce+=this.$g.oe.charAt(De).toString();kc||wa.a.isNumeral(le)||wa.a.Zlf(le)||(kc=!0)}Lb+="@"===ad.charAt((this.gridView.Ul?this.Nwb.gQ:this.Urb.gQ)+1)&&kc?"["+Ce+"]":Ce;Ce=!0;this.set_visible(!1);kc=Lb.toString().length}else if(6===Xa)Lb+=ad.substr(0,
this.Uub);else return n.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.gb.text=Lb;this.gb.textBox.caretPosition=kc;this.gb.Vxa()&&(null===(aa=Nc.Xr)||void 0===aa?0:aa.tva)&&Nc.Xr.QMb(this.gb.text,this.gb.textBox.caretPosition,this.gb.textBox.caretPosition,this.gb.textBox.wy.length);Nc.Ul&&(aa=Nc.Xb,aa.text=this.gb.text,aa.setCaretPosition(this.gb.textBox.caretPosition));ce=(null==this.pja?0:this.pja)?"FieldName":ce;this.$g.Jj.sectionRowIndex>=
this.$g.oW.length?this.Wmc(ce,4,sd,0):this.Wmc(ce,1,sd,0);Ce||(5===Xa||4===Xa?this.Axe():O.EwaSettings.isChangeGateEnabled("OfficeVSO:7386867_dontShowAutocompleteAfterCommitingTableName")&&7===Xa?this.set_visible(!1):this.wqb());return!0}AZ(aa=null,Xa=null){aa?(this.Xg.Bdb(),this.Xg.AZ(aa,!1,!1,Xa)):(aa=this.gridView,aa.ha.ra.eh&&(aa=za.v(aa.ha.ra.xd,this.$),this.Xg.AZ(aa,!0,!0,Xa)))}Bna(){this.Ufa=!1;this.gb.zOe()}PZh(aa){aa=this.calcManager.getWorksheetFuncId(aa);return this.d1e?this.d1e.descriptionsMap.get(aa):
null}aJe(aa){if(this.Oui()){if(this.Xg.I7a&&this.Xg.Tk&&(!this.Xg.Tk.length||!this.Xg.Tk[0].FieldInfoDataList))return;this.P3j(aa)}aa=Ae.asEnumerable(this.AHa);aa=Ae.concat(aa,this.Z0h(this.gb.text));this.jl&&(aa=Ae.concat(aa,this.g2h()));Ae.OBc(aa,Xa=>Xa.name,new Ed.a);this.CTa&&(aa=Ae.concat(Ae.asEnumerable(this.VOb),aa),O.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?0<this.VOb.length?(this.HI||this.formulaAssistanceTelemetryManager.ND(["autoCompleteSmartSuggestionActiveDismissing",
"autoCompleteSmartSuggestionAccepted"]),this.HI=!0):this.HI&&this.Nmf&&(this.uaa=!0):0<this.VOb.length&&(this.HI=!0),this.VOb=[]);this.ofa=Ae.toArray(aa)}Mkh(){const aa=this.gridView.Ul?this.Nwb.kJa:this.Urb.kJa;let Xa=!0;""!==aa&&(this.Xi=Object(nc.a)(Jc.a,this.$.Bb.getItemByName(aa)));this.Xi||(this.Xi=this.tableManager.Xi,Xa=!1);this.Xi?this.Xi.zO&&this.Xi.zO.IsFullTableHeaders?this.SPf(Xa):Ue.d(this.Xi)?(n.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),
fe.q(this.$.pa.va,this.Xi.ej,this.KEd,this.JEd,null,null)):n.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off."):n.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d")}qJh(aa){if(!aa)return!1;let Xa=aa.charCodeAt(0);if(46===Xa||48<=Xa&&57>=Xa||63===Xa)return!0;
for(let Lb=0;Lb<aa.length;Lb++,Xa=aa.charCodeAt(Lb))if(!(wa.a.isLetter(Xa)||92===Xa||95===Xa||63===Xa||48<=Xa&&57>=Xa))return!0;return!1}mHd(aa,Xa){let Lb=!1,kc=!1;var Nc=!1,ad=0;let sd=0;this.z4a=0;this.lcc=Xa;this.I7b=1;for(let ce=Xa-1;0<=ce;--ce)switch(aa.charCodeAt(ce)){case 39:kc=!kc;break;case 34:Lb=!Lb;break;case 91:++ad;Nc=ad>sd;break;case 93:++sd}Nc=Object(xb.a)(new Kb,{Eta:!Lb,Fta:!kc,fia:!Nc,vIb:1});ad=this.v8i(aa,Xa,Nc);Xa=this.w8i(aa,Xa,Nc.Eta,Nc.Fta,Nc.fia);this.I7b=ad+Xa;if(this.cUc=
ad-1)this.yAc=!1;this.fKh(aa,Lb,kc,Nc.NGd,Nc.OGd)}Apd(){this.gridView.ha.hha(this.DBf);const aa=cb.a.ZAb()?this.gridView.Jb(null):void 0;this.mGb(aa);cb.a.kic&&this.gridView.Mh.KZa(this.n6);af.CQd(this.pluginScheduler);this.CTa&&this.b7g()}IIh(){return this.CTa||this.FYe}x8i(){var aa=this.y5;if(!this.bLj||!aa)return this.gZ=0,this.AHa=this.ofa=null,!1;aa=aa.endsWith(db.a.AU);let Xa;if(O.EwaSettings.xa(128)&&({sheetRange:Xa}=this.b1j(this.y5.substring(0,this.B3))).returnValue){const Lb=this.y5.substring(0,
this.gZ);if(aa&&Lb!==this.Hvd)return this.Hvd=Lb,this.gZ=this.y5.length-(aa?1:0),this.AZ(Xa,this.y5),this.pja=!1,n.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}Z0h(aa){const Xa=new sb.a;this.calcManager&&O.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&n.ULS.shipAssertTag(537162014,0,!!this.calcManager.Tta(xd.Range.Hc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.FYe&&
(aa=this.calcManager.extractLetVariables(aa,this.gb.textBox.caretPosition)))for(const Lb of aa){aa=new Fe;aa._name=Lb;aa.y9=y.a.instance.ga(2219);const kc=new mc;kc.CEj(aa);Xa.add(kc)}return Xa}g2h(){const aa=new sb.a,Xa=this.$.Bb.items;for(let kc=0,Nc=Xa.length;kc<Nc;kc++){var Lb=Xa[kc];if(!ne.n(Lb))continue;const ad=new Ua;ad._name=Lb.name;Lb=new mc;Lb.VGj(ad);aa.add(Lb)}return aa}Ntb(aa){const Xa=new mc,Lb=new Rb;Lb._name=aa;Xa.WGj(Lb);return Xa}SPf(aa){const Xa=new sb.a,Lb=this.gb.textBox.caretPosition-
1;if(91===this.gb.text.charCodeAt(Lb)){var kc=this.Ntb("@ - "+this.instantaneousSupportInformationManager.Re.ThisRowStructRefString);Xa.add(kc)}for(var Nc of this.Xi.zO.HeadersList){kc=new mc;const ad=new Be;ad._name=Nc.Name;kc.UGj(ad);Xa.add(kc)}Nc=this.gridView.Ul?this.Nwb.gQ:this.Urb.gQ;kc=this.gb.text.charCodeAt(Nc+1);!aa||Lb!==Nc&&35!==kc||(aa=this.Ntb("#"+this.instantaneousSupportInformationManager.Re.AllStructRefString),Xa.add(aa),aa=this.Ntb("#"+this.instantaneousSupportInformationManager.Re.DataStructRefString),
Xa.add(aa),aa=this.Ntb("#"+this.instantaneousSupportInformationManager.Re.HeadersStructRefString),Xa.add(aa),aa=this.Ntb("#"+this.instantaneousSupportInformationManager.Re.TotalsStructRefString),Xa.add(aa));Xa&&(this.ofa=Xa.toArray())}P3j(aa){let Xa=Ae.empty();!aa&&this.functionInfoManager.wV&&(Xa=Ae.concat(Xa,Ae.select(Ae.asEnumerable(this.functionInfoManager.kcc),Lb=>{const kc=new mc;kc.G7f(Lb);return kc})),aa=this.v8b.XMe,0<aa.length&&(Xa=Ae.OBc(Ae.concat(Xa,Ae.select(Ae.asEnumerable(aa),Lb=>{const kc=
new mc;kc.WCj(Lb);return kc})),Lb=>Lb.name,new Ed.a)));if(this.Xg.I7a&&this.Xg.Tk){if(!this.Xg.Tk.length||!this.Xg.Tk[0].FieldInfoDataList)return;Xa=Ae.OBc(Ae.concat(Xa,Ae.select(Ae.asEnumerable(this.Xg.Tk[0].FieldInfoDataList),Lb=>{const kc=new mc;kc.tDj(Lb);return kc})),Lb=>Lb.name,new Ed.a);this.columnName=this.Xg.Tk[0].ColumnName}this.AHa=Ae.toArray(Xa)}mGb(aa){var Xa;const Lb=this.gridView.ha.ra.activeCell;if(Lb){var kc=this.calcManager.Tta(Lb,!1);if(kc){var Nc=this.$.ua,ad=kc.sheet.index;0>=
Nc.count||0>ad||ad>=Nc.count?n.ULS.sendTraceTag(512278611,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Nc.count}, currentSheetIndex = ${ad}.`):(ad=Nc=null,this.FCd&&void 0!==this.calcManager&&null!==this.calcManager&&(aa=null!==(Xa=null===aa||void 0===aa?void 0:aa.cell)&&void 0!==Xa?Xa:this.gridView.Ca.ds(Lb))&&(Xa=this.calcManager.njd(aa.Ci),void 0!==Xa&&null!==Xa&&(Nc=Xa.FormatString,ad=Xa.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:kc.range.col,
rowIndex:kc.range.row,sheetIndex:this.$.ua.getItem(kc.sheet.index).sheetId,docName:kc.sheet.document.name,docPath:kc.sheet.document.path,formatString:Nc,builtIn:ad}),n.ULS.sendTraceTag(512278610,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged sent notification to the scheduler. col: ${kc.range.col}, row: ${kc.range.row}`))}else n.ULS.sendTraceTag(512278612,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null")}else n.ULS.sendTraceTag(512278613,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged activeCell range is null")}E3f(){this.formulaAssistanceTelemetryManager.zF=
{Sk:this.gridView.ha.ra.activeCell,q4b:this.gridView.Xb.text,E1a:!0};this.formulaAssistanceTelemetryManager.cEb=this.$.ea.se;this.formulaAssistanceTelemetryManager.smc=this.$.ua.na.sheetId;this.$.userOperationManager.jr(this.LPa)}b7g(){this.gridView.Ul?this.Nwb.JY(!1):this.Urb.JY(!1)}Mpf(aa){let Xa=wa.a.isLetter(aa);return 48<=aa&&57>=aa||46===aa||95===aa||Xa}show(){if(this.mr){var aa=this.$g.mng(0);this.jl?0<this.$g.ap.length?(this.formulaAssistanceTelemetryManager.A_f(this.$g.Rsb),aa||this.fcg()):
this.O2a():((aa=0<this.$g.ap.length)&&this.formulaAssistanceTelemetryManager.ND(["autoCompleteRender"]),!this.ye&&this.columnName&&aa&&this.$g.Kfj(this.$g.ap.length,this.columnName),this.ye=aa,this.Ija.show(this.fQ),this.LCa(!0),this.$g.Xya(),aa&&this.formulaAssistanceTelemetryManager.rv(["autoCompleteRender"]))}}w8i(aa,Xa,Lb,kc,Nc){for(Lb=Object(xb.a)(new Kb,{mNf:41,rFe:40,Eta:Lb,Fta:kc,fia:Nc});Xa<aa.length&&!this.pOf(aa,Xa,Lb);++Xa);return Lb.vIb}v8i(aa,Xa,Lb){for(--Xa;0<=Xa&&!this.pOf(aa,Xa,Lb);--Xa);
return Lb.vIb}pOf(aa,Xa,Lb){const kc=aa.charCodeAt(Xa);0>=this.B3&&(this.B3=aa.substring(0,Xa).lastIndexOf(db.a.AU));46===kc&&(Xa<this.B3?this.B3=Xa:Xa>this.Uub&&(this.gZ=this.Uub=Xa));if(!this.Mpf(kc)&&!af.NAi(kc)&&(!this.Tka||Xa<=this.B3||!af.nii(kc,Lb))){Lb.WDf&&(Lb.WDf=!1,this.z4a=Xa+1);if(Lb.pFd){Lb.OGd=Xa+1;if(this.functionInfoManager.kid(aa.substring(Lb.OGd,Lb.NGd)))return!0;Lb.pFd=!1}switch(kc){case 39:Lb.Fta=!Lb.Fta;break;case 34:Lb.Eta=!Lb.Eta;break;case 91:Lb.fia=!1;break;case 93:Lb.fia=
!0}kc===this.$.listSeparator.toString().charCodeAt(0)&&Lb.Fta&&Lb.Eta&&!Lb.l1a&&(!this.Tka||Lb.fia)&&(Xa<Lb.pRd||-1===Lb.pRd)&&(Lb.vIb+=1,this.I7b++);kc===Lb.rFe&&Lb.Eta&&Lb.Fta&&(!this.Tka||Lb.fia)?Lb.l1a+=1:kc===Lb.mNf&&Lb.Eta&&Lb.Fta&&(!this.Tka||Lb.fia)?0<Lb.l1a?--Lb.l1a:(Lb.pRd=Lb.i_e,Lb.i_e=Xa,0<Xa&&this.Mpf(aa.charCodeAt(Xa-1))&&(Lb.pFd=!0,Lb.NGd=Xa)):this.Tka&&46===kc&&Xa>this.B3&&(Xa<this.B3?this.B3=Xa:Xa>this.Uub&&(this.gZ=this.Uub=Xa))}return!1}fKh(aa,Xa,Lb,kc,Nc){this.lcc>this.z4a&&0<=
this.z4a?Xa||Lb||(this.GV=aa.substring(this.z4a,this.lcc)):this.GV=null;kc!==Nc?(aa=aa.substring(Nc,kc),this.fQ&&wa.a.equals(this.fQ.NameDataStrings,aa,!0)||(this.yAc=!0),this.fQ=this.functionInfoManager.kid(aa)):(this.yAc=!1,this.fQ=null)}tfg(aa){const Xa=$get(t.jOf+"_"+t.uIb,this.domElement),Lb=$get(t.kOf+"_"+t.uIb,this.domElement);aa&&!this.egc?(Xa&&Ob.a.instance.ta(Ta.a.click,Xa,this.Zca),Lb&&Ob.a.instance.ta(Ta.a.click,Lb,this.Zca),this.egc=!0):this.egc&&(Xa&&Ob.a.instance.Aa(Ta.a.click,Xa,this.Zca),
Lb&&Ob.a.instance.Aa(Ta.a.click,Lb,this.Zca),this.egc=!1)}b1j(aa){let Xa;Xa=null;var Lb;if(({sheetName:kc,range:Lb}=za.ab(aa,this.$.ea.ua)).returnValue&&Lb){if(!kc){var kc=Object(nc.a)(id.a,this.$.na);if(!kc)return{returnValue:!1,sheetRange:Xa};kc=kc.name}Xa=za.v(Lb,this.$);Xa.SheetName=kc;this.z9c=!1;return{returnValue:!0,sheetRange:Xa}}return({sheetName:kc,range:Lb}=this.v8b.L0j(aa)).returnValue?(Xa=za.v(Lb,this.$),Xa.SheetName=kc,this.z9c=!0,{returnValue:!0,sheetRange:Xa}):{returnValue:!1,sheetRange:Xa}}AQd(aa){aa=
{content:aa,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.tla?this.pluginScheduler.getRequester().runAuthoringExperiment(aa,0):this.pluginScheduler.requester().runAuthoringExperiment(aa)}Jod(){if(1===this.$g.oW.length&&this.mr.length){var aa=this.mr[this.$g.oW[0]];if(1===aa.itemType){var Xa=aa.name;aa=this.gb.text;Xa=Xa.substring(aa.length,Xa.length);Xa.length&&(this.gb.text=aa+Xa,this.gb.textBox.selectRange(aa.length,this.gb.text.length))}}else n.ULS.shipAssertTag(537162007,
0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.$g.oW.length})`)}Wmc(aa,Xa,Lb,kc){const Nc={};Nc.a=aa;Nc.b=Xa;Nc.c=Lb;Nc.d=kc;oe.b().Ze(38,Nc,!0)}zxe(aa,Xa){if(!this.functionInfoManager.wV){if(aa)if(this.mHd(this.gb.text,this.gb.textBox.caretPosition),this.CTa||this.GV){const Lb={};Lb.Filter=this.GV?this.GV.charAt(0).toString():"";Lb.FilterType=1;Lb.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.VJa(Lb)}else this.get_visible()&&this.set_visible(!1);
if(!Xa)return}0<this.$.pb.DR||this.gb&&!this.gb.eb?this.set_visible(!1):aa&&(this.mHd(this.gb.text,this.gb.textBox.caretPosition),this.Ija.update(this.fQ,this.I7b,this.cUc,this.yAc),this.y5=this.gb.text.substring(1,this.gb.textBox.caretPosition),this.B3=this.y5.indexOf(db.a.AU),this.gZ=this.y5.lastIndexOf(db.a.AU),this.x8i()?(aa=new mc,aa.vFj(),this.AHa=this.ofa=aa=[aa],this.$g.V5j(aa),this.show()):((this.IIh()||this.Fxa())&&this.aJe(!1),0<this.gZ?this.$g.xKa(this.mr,this.y5,!1,void 0,this.y5.lastIndexOf(db.a.AU),
!1):this.$g.xKa(this.mr,this.GV,!1,void 0,this.gZ,!1),this.show(),this.jl&&(this.$g.ap.length||this.gridView.Mh.UK?this.Ija.a9b():(this.Ija.VOd(),this.jl&&this.O2a()))))}fcg(){if(0<this.$g.ap.length){this.formulaAssistanceTelemetryManager.ND(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const aa={};aa.zoomLevel=ea(this.$);this.formulaAssistanceUIControl.updateContext(aa);this.Ko=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.D2b,this.gridView.Mh.textBox.domElement,
this.zdc(),()=>{})};this.Ko();this.jl&&this.$g.Zkc&&this.raiseEvent(af.kfd,null);this.Bqd||this.$g.Zkc||this.raiseEvent("FormulaAutoCompleteShown");this.Bqd=this.Gq.If=!0}this.formulaAssistanceTelemetryManager.rv(["autoCompleteRender"]);O.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.HI&&this.Nmf&&(this.uaa=!0)}}Txd(){this.AJa&&(this.formulaAssistanceTelemetryManager.wJ.selectByArrowKeyCounter++,this.AJa=!1);this.BJa&&(this.formulaAssistanceTelemetryManager.wJ.selectByMouseHoverCounter++,
this.BJa=!1);this.zJa&&(this.formulaAssistanceTelemetryManager.wJ.commitByTabKeyCounter++,this.zJa=!1);this.xJa&&(this.formulaAssistanceTelemetryManager.wJ.commitByEnterKeyCounter++,this.xJa=!1);this.yJa&&(this.formulaAssistanceTelemetryManager.wJ.commitByMouseClickCounter++,this.yJa=!1);O.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.Nia&&(this.formulaAssistanceTelemetryManager.wJ.dismissSmartSuggestionExplicitlyCounter++,this.Nia=!1)}zdc(){const aa=new wf;
aa.completionItems=this.$g.Rsb;aa.activeItemIndex=this.$g.Jj?this.$g.Jj.rowIndex:-1;this.oMd(aa);return aa}oMd(aa){aa.callbacks=new mf;aa.callbacks.onCompletionItemSelected=this.cEd;aa.callbacks.onCompletionItemCommitted=this.bEd;aa.callbacks.onFeedback=this.qSa;aa.callbacks.onDismiss=this.onDismiss;aa.callbacks.onRestoreFocus=this.onRestoreFocus}YId(aa){this.Ufa=!0;const Xa=aa.textEdit.newText;this.gb.Foa(Xa.substring(this.gb.text.length-aa.textEdit.range.start.character,Xa.length))}FGe(){O.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.formulaAssistanceTelemetryManager.rv(["autoCompleteSmartSuggestionAccepted"]);this.Ty(!0);this.Ufa=this.ye=!1;this.DTa=this.Moa=!0}Ppd(aa,Xa){this.gb.text=aa.substring(0,Xa.range.start.character)+Xa.newText+aa.substring(Xa.range.end.character,aa.length);this.gridView.Ul&&(this.gridView.Xb.text=this.gb.text)}static CQd(aa){O.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?aa.getRequester().runExperiment(new Kf,0):aa.requester().runExperiment(new Kf)}static Lch(aa){const Xa=
mc.wkh(),Lb={IsCompatibility:!1};Lb.NameDataStrings=aa.label;Lb.Help=aa.detail;Xa.G7f(Lb);Xa.textEdit=aa.textEdit;return Xa}static WKa(){const aa=String.format(t.QOh,t.Efd,Ub.a.hUe),Xa=String.format(t.MOh,t.Cfd,jb.a.P$b,x.a.vo,x.a.uo),Lb=String.format(t.IOh,t.xfd,jb.a.P$b,x.a.vo,jb.a.ZUe,x.a.uo);return`${aa}
${Xa}
${Lb}`}static NAi(aa){return 36===aa||58===aa||33===aa||39===aa||32===aa}static nii(aa,Xa){return 32===aa||91===aa||!Xa.fia}}af.kfd="FACardOpened";af.Ied="FAFocusOnSmartSuggestionsCard";af.Kgc=null;Object(h.a)(af,"FormulaAssistanceControl",zb.a,[315,278,3,316,317]);class Wf{constructor(aa){this.qv=aa;this.$A=this.$Sa=this.Mi=!1;this.onKeyDown=Xa=>this.$A||"Space"!==Xa.code&&" "!==Xa.key||!Xa.altKey||!Xa.ctrlKey?!1:(this.v3a(),Xa.stopPropagation(),Xa.preventDefault(),!0);this.Qla=Xa=>{if(!this.$A)return!1;
if(Xa.eventName===Ta.a.Vb){const Lb=Xa.Ea.ctrlKey?1:Xa.Ea.shiftKey?50:10;switch(Xa.Ea.keyCode){case jf.a.Gpa:this.FK(0,-Lb);break;case jf.a.h8:this.FK(0,Lb);break;case jf.a.i8:this.FK(-Lb,0);break;case jf.a.XCa:this.FK(Lb,0);break;case jf.a.sG:case jf.a.Sh:this.$Sa=!0;break;default:return!1}}Xa.eventName===Ta.a.Qd&&this.$Sa&&this.CM(!0);Xa.Ea.preventDefault();return!0};this.Yza=Xa=>{if(!this.$A)return!1;Xa.Ea.preventDefault();this.CM();return!0};this.onBlur=()=>{if(!this.$A)return!1;this.CM();return!0};
this.Co=gf.KeyInputManager.instance;this.pointerInputManager=ed.a.instance}la(aa){(this.root=aa)&&!this.Mi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Mi=!0)}detach(){this.root&&this.Mi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Mi=!1)}v3a(){this.root&&(this.qv.OHb("move",!0),this.root.focus(),this.$A=!0,this.$Sa=!1,this.Nt(),this.Zya||this.Ctb(),this.root.appendChild(this.Zya))}CM(aa=!1){this.$A&&(this.$A=!1,this.qv.lqc(aa),this.AKb(),this.qKb())}Nt(){this.Co.capture(this.Qla,
null);this.pointerInputManager.xs(Ta.a.pointerDown,this.root,this.Yza,!0);this.root.addEventListener("blur",this.onBlur)}qKb(){this.Co.releaseCapture();this.pointerInputManager.Fs(Ta.a.pointerDown,this.root,this.Yza,!0);this.root.removeEventListener("blur",this.onBlur)}AKb(){var aa;null===(aa=this.Zya)||void 0===aa?void 0:aa.remove()}FK(aa,Xa){const Lb=this.qv.getPosition();Lb.x+=aa;Lb.y+=Xa;this.qv.setPosition(Lb)}Ctb(){this.Zya=rf.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",
!0,"")}}Object(h.a)(Wf,"FormulaAssistanceMoveAdapter",null,[]);class Gf{constructor(aa){this.qv=aa;this.startOffset={x:0,y:0};this.Ydg=!0;this.Mi=!1;this.A_c=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeArgumentAssistanceDragCursorToMove",!1)}U4(){return this.Mi&&!!this.aD}sza(aa){this.A_c||(this.aD.style.cursor="grabbing");const Xa=this.qv.getPosition();this.Ydg=Xa.renderDown;this.startOffset.x=Xa.x-aa.clientPoint.x;this.startOffset.y=Xa.y-aa.clientPoint.y;this.qv.OHb("drag");
return!0}Xca(aa){this.qv.setPosition({x:aa.clientPoint.x+this.startOffset.x,y:aa.clientPoint.y+this.startOffset.y,renderDown:this.Ydg});return!0}Wca(){this.sw()}Vca(){this.sw()}la(aa,Xa){this.aD=Xa;this.root=aa;this.aD&&(this.aD.style.cursor=this.A_c?"move":"grab",Qa.a.instance.xW(this.aD,this,!1),this.Mi=!0)}detach(){this.Mi&&this.aD&&(this.aD.style.cursor="",Qa.a.instance.$0(this.aD,this),this.Mi=!1)}sw(){this.A_c||(this.aD.style.cursor="grab")}}Object(h.a)(Gf,"FormulaAssistanceDragAdapter",null,
[367]);class cg{get getPosition(){return this.xAg}get setPosition(){return this.ole}constructor(aa){this.formulaAssistanceTelemetryManager=aa;this.Mi=!1;this.sHa=O.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.e1={[Ha.Drag]:0,[Ha.Move]:0};this.IFb=new Wf(this);this.Wub=new Gf(this)}la(aa,Xa,Lb,kc){this.xAg=Lb;this.ole=kc;this.IFb.la(aa);this.Wub.la(aa,Xa);this.Mi=!0}detach(){this.Mi&&(this.Wub.detach(),this.IFb.detach(),this.Mi=!1)}clear(){var aa;
null===(aa=this.ole)||void 0===aa?void 0:aa.call(this,null);this.detach();this.tLb()}OHb(aa,Xa=!1){this.e1[aa]++;Xa&&(this.IQa=document.activeElement)}lqc(aa=!0){this.IQa&&(aa&&this.IQa.focus(),this.IQa=null)}tLb(){const aa=this.formulaAssistanceTelemetryManager.BP,Xa=this.e1[Ha.Drag],Lb=this.e1[Ha.Move];0<Xa&&(this.formulaAssistanceTelemetryManager.pJ("d"),this.sHa||(aa.argumentAssistanceDragTotalCounter+=Xa),this.e1[Ha.Drag]=0);0<Lb&&(this.formulaAssistanceTelemetryManager.pJ("m"),this.sHa||(aa.argumentAssistanceMoveTotalCounter+=
Lb),this.e1[Ha.Move]=0)}}Object(h.a)(cg,"FormulaAssistanceDragControl",null,[]);var Ha;(function(aa){aa.Drag="drag";aa.Move="move"})(Ha||(Ha={}));Object(h.b)("FormulaAssistanceDragMode",Ha);class yb extends dd.a{constructor(aa,Xa,Lb){super(yb.WKa());this.$=aa;this.formulaAssistanceUIControl=Xa;this.formulaAssistanceTelemetryManager=Lb;this.showCollapseText=this.isExpanded=!0;this.j$=0;this.Ula=this.Ko=this.Gq=null;this.av=!1;this.setPosition=kc=>{this.formulaAssistanceUIControl.setFixedPosition(kc);
this.formulaAssistanceUIControl.updatePosition(0)};this.getPosition=()=>this.formulaAssistanceUIControl.getPosition();this.Zc=()=>{this.visible=!1};this.onCardModeChange=kc=>{this.u1d(kc);this.showCollapseText=!1;1===kc?this.formulaAssistanceTelemetryManager.pJ("c"):this.formulaAssistanceTelemetryManager.pJ("e")};this.onIsExpandedChange=kc=>{this.J5j(kc);this.showCollapseText=!1;kc?this.formulaAssistanceTelemetryManager.pJ("e"):this.formulaAssistanceTelemetryManager.pJ("c")};this.qSa=kc=>{J(this.$,
"ArgumentAssistanceCard",kc.functionName);this.formulaAssistanceTelemetryManager.pJ("gf")};this.Ht=()=>{this.Y4?this.formulaAssistanceUIControl.updatePosition(0):void 0!==this.Ko&&null!==this.Ko&&this.Ko()};this.dg=()=>{this.Y4?this.qv.clear():this.C$c.clear()};this.Y4=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.jTd();this.Gq=new Ee(this.$,this.formulaAssistanceUIControl,0,Bd.a.cfd);this.grid=Object(I.h)(aa);this.grid.view.Vs(this.Ht);this.grid.ha.jC(this.Zc);
this.Y4?this.qv=new cg(this.formulaAssistanceTelemetryManager):this.C$c=new nb(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.grid.oc.rm(this.dg);O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}Bse(aa){this.addHandler("FAFunctionNameUpdated",aa)}XYf(aa){this.removeHandler("FAFunctionNameUpdated",aa)}ste(aa){this.addHandler("FAParameterSelectionChangedOld",aa)}vZf(aa){this.removeHandler("FAParameterSelectionChangedOld",
aa)}rte(aa){this.addHandler("FAParameterSelectionChanged",aa)}uZf(aa){this.removeHandler("FAParameterSelectionChanged",aa)}get visible(){return this.av}set visible(aa){aa||this.dismiss();this.av=aa}dismiss(){this.av=!1;this.formulaAssistanceUIControl&&(this.Ko=null,this.Y4?this.qv.detach():this.C$c.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Ula=null,this.Gq.If=!1)}OPj(aa,Xa){this.av=!0;const Lb=this.Atc(aa);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceRender"]);
aa={};aa.zoomLevel=ea(this.$);this.formulaAssistanceUIControl.updateContext(aa);const kc=()=>{};O.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Ko=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Xa,Lb,kc)},this.Ko()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Xa,Lb,kc);this.Dwc();this.Tsc(Lb);this.C$c.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Ko,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.Gq.If=!0;this.formulaAssistanceTelemetryManager.rv(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Pua("argumentAssistanceOverall")}}show(aa,Xa){this.Y4?this.PPj(aa):this.OPj(aa,Xa)}PPj(aa){this.av=!0;const Xa=this.Atc(aa);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceRender"]);const Lb=()=>c(this.$);this.Ko=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
void 0,Xa,Lb)};this.Ko();this.Dwc();this.Tsc(Xa);this.qv.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.getPosition,this.setPosition);this.Gq.If=!0;this.formulaAssistanceTelemetryManager.rv(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Pua("argumentAssistanceOverall")}}dispose(){this.$&&this.grid&&(this.grid.ha&&this.grid.ha.xB(this.Zc),this.grid.view.Xq(this.Ht),this.grid.oc.dm(this.dg));ib.a.Ja(this.Gq);
this.$=null}Atc(aa){const Xa=new $e;Xa.functionRenderingInfo=aa;Xa.showCollapseText=this.showCollapseText;this.Y4?Xa.isExpanded=this.isExpanded:Xa.cardMode=this.j$;this.sMd(Xa);return Xa}sMd(aa){aa.callbacks=new ye;aa.callbacks.onHelpLink=this.Aid(aa.functionRenderingInfo);this.Y4?aa.callbacks.onIsExpandedChange=this.onIsExpandedChange:aa.callbacks.onCardModeChange=this.onCardModeChange;aa.callbacks.onFeedback=this.qSa}Aid(aa){return()=>{N(this.$,aa.helpID,aa.isUDF)}}jTd(){const aa=Md.a.get(z.a.kqb);
this.Y4?(aa?(this.isExpanded="false"!==aa,this.showCollapseText=!1):(this.isExpanded=yb.vnh,this.formulaAssistanceTelemetryManager.n6f()),this.formulaAssistanceTelemetryManager.UBj(this.isExpanded)):(aa?(this.j$=parseInt(aa,10),this.showCollapseText=!1):(this.j$=yb.q9c,this.formulaAssistanceTelemetryManager.n6f()),this.formulaAssistanceTelemetryManager.o6f(this.j$))}Tsc(aa){var Xa=aa.functionRenderingInfo.functionName;this.Ula&&wa.a.equals(this.Ula,Xa,!0)?(Xa=se.a.map(aa.functionRenderingInfo.signatures,
Lb=>{let kc="";0<=Lb.signatureParams.activeParam&&Lb.signatureParams.activeParam<Lb.signatureParams.params.length&&(kc=Lb.signatureParams.params[Lb.signatureParams.activeParam]);return kc}),this.raiseEvent("FAParameterSelectionChanged",new Xc(Xa))):(this.Ula=Xa,aa=se.a.map(aa.functionRenderingInfo.signatures,Lb=>Lb.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Hd(Xa,aa)))}u1d(aa){this.j$=aa;try{Md.a.Bs(z.a.kqb,aa.toString(),tc.AFrame.PO)}catch(Xa){n.ULS.sendTraceTag(537162074,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Xa.message}`)}}J5j(aa){this.isExpanded=aa;try{Md.a.Bs(z.a.kqb,aa.toString(),tc.AFrame.PO)}catch(Xa){n.ULS.sendTraceTag(512267714,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Xa.message}`)}}static WKa(){return document.createElement("div")}Dwc(){const aa=this.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.pJ(aa)}}yb.q9c=0;yb.vnh=!0;Object(h.a)(yb,
"FormulaArgumentAssistanceControl",dd.a,[357]);var Xb;(function(aa){aa[aa.Dismissed=0]="Dismissed";aa[aa.Smart=1]="Smart";aa[aa.Simple=2]="Simple";aa[aa.Mixed=3]="Mixed"})(Xb||(Xb={}));Object(h.b)("UIState",Xb);class wc extends dd.a{constructor(aa,Xa,Lb){super(wc.WKa());this.$=aa;this.formulaAssistanceUIControl=Xa;this.formulaAssistanceTelemetryManager=Lb;this.Gq=this.clearContentNotifier=this.gb=this.gridView=null;this.uaa=this.Nia=this.yJa=this.xJa=this.zJa=this.BJa=this.AJa=!1;this.mr=null;this.OW=
0;this.Ko=null;this.DTa=this.Moa=this.HI=this.Ufa=this.av=!1;this.IQb=Xb.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.av=!1;this.X7a&&this.HI&&this.kNa&&(this.uaa=!0);this.Txd();this.vF&&this.gb.eb&&this.Bna();this.Ko=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.Gq.If=!1,this.IQb=Xb.Dismissed)};this.Pld=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.UDd=()=>{var kc;const Nc=this.gridView.ha.ra.selectedRanges,
ad=null===(kc=this.formulaAssistanceTelemetryManager.zF)||void 0===kc?void 0:kc.Sk;Nc.some(sd=>sd.contains(ad))&&this.formulaAssistanceTelemetryManager.Owd++};this.bda=(kc,Nc)=>{0==Nc.Uq&&(170==Nc.Gf.operation.operationName&&this.formulaAssistanceTelemetryManager.eEb++,this.$.userOperationManager.ao(this.bda),this.xkc&&this.clearContentNotifier&&this.clearContentNotifier.nNd(this.UDd))};this.LPa=(kc,Nc)=>{0==Nc.Uq&&(12==Nc.Gf.operation.operationName&&this.$.userOperationManager.jr(this.bda),this.$.userOperationManager.ao(this.LPa))};
this.JVi=()=>{this.dismiss();this.gridView.Mh.textBox.focus()};this.qSa=()=>{const kc={};kc[z.a.VJ]=this.WMf?"SmartSuggestionsCard":this.tXd?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Yc(802602464,0,8,kc)};this.dg=()=>{O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartSuggestionSurvey",!1)&&1===this.formulaAssistanceTelemetryManager.UC.smartSuggestionShownCounter&&this.HI&&this.$.Yc(1073817162,-1,0,null);this.kNa&&this.ATg()};this.cEd=(kc,Nc)=>{this.qhb(Nc);this.BJa=
!0};this.Zc=()=>{this.visible=!1};this.bEd=kc=>{this.yJa=!0;this.Msb(kc)};this.rj=()=>{this.dismiss()};this.Ht=()=>{this.Y4?this.formulaAssistanceUIControl.updatePosition(1):void 0!==this.Ko&&null!==this.Ko&&this.Ko()};this.gridView=I.h(this.$);this.Gq=new Ee(this.$,this.formulaAssistanceUIControl,1,Bd.a.efd,this.Pld);this.gridView.view.Vs(this.Ht);this.gridView.ha.jC(this.Zc);this.$.ua.Yf(this.rj);this.kNa=O.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");
this.Y4=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceRedesign",!1)&&O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.X7a=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");(this.xkc=O.EwaSettings.isChangeGateEnabled("OfficeVSO:7629619_RefiningKeptTelemetry"))&&this.$.da.hb(313,kc=>{this.clearContentNotifier=kc});this.kNa&&this.gridView.oc.rm(this.dg);O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",
!1)&&this.$.domElement.appendChild(this.domElement)}zse(aa){this.addHandler("FACardOpened",aa)}WYf(aa){this.removeHandler("FACardOpened",aa)}xse(aa){this.addHandler("FAFocusOnSmartSuggestionsCard",aa)}UYf(aa){this.removeHandler("FAFocusOnSmartSuggestionsCard",aa)}yse(aa){this.addHandler("FormulaAutoCompleteShown",aa)}VYf(aa){this.removeHandler("FormulaAutoCompleteShown",aa)}bZc(aa){this.addHandler("SelectedRowChanged",aa)}SNd(aa){this.removeHandler("SelectedRowChanged",aa)}O0b(aa){this.addHandler("ListBoxUpdated",
aa)}Rvc(aa){this.removeHandler("ListBoxUpdated",aa)}dispose(){this.$&&(this.$.userOperationManager.ao(this.bda),this.$.userOperationManager.ao(this.LPa),this.gridView&&(this.gridView.ha&&this.gridView.ha.xB(this.Zc),this.gridView.oc&&this.kNa&&this.gridView.oc.dm(this.dg),this.gridView.view.Xq(this.Ht)),this.$.ua&&this.$.ua.yg(this.rj));this.xkc&&this.clearContentNotifier&&this.clearContentNotifier.nNd(this.UDd);ib.a.Ja(this.Gq);this.$=null}oPg(aa){this.addHandler("CVIC",aa)}Znj(aa){this.removeHandler("CVIC",
aa)}get visible(){return this.av}set visible(aa){aa||this.dismiss();this.av=aa}get vF(){return this.Ufa}get tXd(){var aa,Xa;return 1===(null===(Xa=null===(aa=this.mr)||void 0===aa?void 0:aa.items[0])||void 0===Xa?void 0:Xa.type)}get WMf(){return 1===this.mr.items.length&&this.tXd}Wh(aa,Xa){if(!this.visible)return!1;this.PEc(Xa);let Lb;return(Lb=this.Cdi(Xa)).Jfc?Lb.result:this.CKj(Xa)}czb(aa){if(!this.visible)return!1;let Xa=!1;switch(aa){case 1872288872:this.vF&&this.Bna();this.X7a&&this.tXd&&(this.formulaAssistanceTelemetryManager.rv(["autoCompleteSmartSuggestionActiveDismissing"]),
this.Nia=!0);this.visible=!1;Xa=!0;break;case -798660877:this.qhb(this.Myb(this.OW+1));Xa=!0;break;case 137938150:this.qhb(this.Myb(this.OW-1));Xa=!0;break;case 2091832999:this.qhb(this.Myb(this.OW+8));Xa=!0;break;case 742457698:this.qhb(this.Myb(this.OW-8));Xa=!0;break;case 125627505:case 267796030:this.Msb(this.mr.items[this.OW]),Xa=!0}return Xa}show(aa){this.gb=this.gridView.Mh;this.av=!0;this.OW=0;this.mr=aa;0<this.mr.items.length&&(this.render(),this.qhb(this.Myb(this.OW)),this.X7a?this.kNa&&
(1===this.mr.items[0].type?(this.HI||this.formulaAssistanceTelemetryManager.ND(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.HI=!0):this.HI&&(this.uaa=!0)):1===this.mr.items[0].type&&this.kNa&&(this.HI=!0));this.formulaAssistanceTelemetryManager.A_f(aa.items)}Bna(){this.Ufa=!1;this.gb.zOe()}CKj(aa){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(aa)}Cdi(aa){return this.vF?125627505===aa||267796030===aa?(this.Msb(this.mr.items[this.OW]),
{Jfc:!0,result:!1}):!this.WMf||-798660877!==aa&&137938150!==aa?{Jfc:!1}:{Jfc:!0,result:!1}:{Jfc:!1}}render(){this.formulaAssistanceTelemetryManager.ND(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){if(this.Y4){const aa=()=>c(this.$);this.Ko=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,void 0,this.zdc(),aa)}}else{const aa={};aa.zoomLevel=ea(this.$);this.formulaAssistanceUIControl.updateContext(aa);this.Ko=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,
this.gb.textBox.domElement,this.zdc(),()=>{})}}this.Ko();this.zfj();this.Gq.If=!0;this.Avh()}}Avh(){this.formulaAssistanceTelemetryManager.rv(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.Pua("autoCompleteOverall");const aa=this.mr.items.some(Lb=>1===Lb.type),Xa=this.mr.items.some(Lb=>0===Lb.type);aa&&Xa?this.formulaAssistanceTelemetryManager.Pua("autoCompleteOverallSimpleAndSmart"):aa?this.formulaAssistanceTelemetryManager.Pua("autoCompleteOverallSmartOnly"):Xa&&this.formulaAssistanceTelemetryManager.Pua("autoCompleteOverallSimpleOnly")}zfj(){const aa=
this.IQb;this.IQb=this.Q9h(this.mr.items);aa!==Xb.Dismissed&&aa!==Xb.Smart||this.IQb!==Xb.Simple&&this.IQb!==Xb.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}hgj(){var aa;if(0!==this.mr.items.length){var Xa=0<=this.OW?this.OW:0,Lb=this.mr.items[Xa];Lb={aG:Lb.label,description:null!==(aa=Lb.detail)&&void 0!==aa?aa:"",selectedIndex:Xa+1,length:this.mr.items.length};this.raiseEvent("SelectedRowChanged",Lb)}}Msb(aa){if(this.gb&&this.visible){var Xa=aa.textEdit;this.Ppd(this.gb.text,Xa);this.gb.textBox.caretPosition=
Xa.range.start.character+Xa.newText.length;this.vF&&(this.Ufa=!1,this.kNa&&(this.X7a&&this.formulaAssistanceTelemetryManager.rv(["autoCompleteSmartSuggestionAccepted"]),this.DTa=this.Moa=!0),this.IEj(),this.gridView.Iaa.e6f(),this.gb.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:aa.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.z_f(aa.kind)}}IEj(){this.formulaAssistanceTelemetryManager.zF=
{Sk:this.gridView.ha.ra.activeCell,q4b:this.gridView.Xb.text,E1a:!0};this.formulaAssistanceTelemetryManager.smc=this.$.ua.na.sheetId;this.formulaAssistanceTelemetryManager.cEb=this.$.ea.se;this.$.userOperationManager.jr(this.LPa);this.xkc&&this.clearContentNotifier&&this.clearContentNotifier.$re(this.UDd)}ATg(){this.X7a&&this.uaa&&!this.Nia&&!this.Moa&&(this.formulaAssistanceTelemetryManager.wJ.dismissSmartSuggestionImplicitlyCounter++,this.uaa=!1);this.HI&&(this.formulaAssistanceTelemetryManager.UC.smartSuggestionShownCounter++,
this.HI=!1,Object(hd.a)(Cd.a));this.Moa&&(this.formulaAssistanceTelemetryManager.UC.smartSuggestionSelectedCounter++,this.Moa=!1,Object(hd.a)(Cd.c));this.DTa&&(this.formulaAssistanceTelemetryManager.UC.smartSuggestionCommittedCounter++,this.DTa=!1)}zdc(){const aa=new wf;aa.completionItems=this.mr.items;aa.activeItemIndex=this.OW;this.oMd(aa);return aa}oMd(aa){aa.callbacks=new mf;aa.callbacks.onCompletionItemSelected=this.cEd;aa.callbacks.onCompletionItemCommitted=this.bEd;aa.callbacks.onFeedback=
this.qSa;aa.callbacks.onDismiss=this.JVi;aa.callbacks.onRestoreFocus=this.onRestoreFocus}YId(aa){this.Ufa=!0;const Xa=aa.textEdit.newText;this.gb.Foa(Xa.substring(this.gb.text.length-aa.textEdit.range.start.character,Xa.length))}qhb(aa){const Xa=this.OW;this.OW=aa;const Lb=this.mr.items[aa];this.vF&&this.Bna();Xa!==aa&&this.render();1===Lb.type&&O.EwaSettings.vb()&&!this.gridView.Mh.text.includes("\n")&&this.YId(Lb);this.hgj()}Myb(aa){return 0>aa?0:Math.min(aa,this.mr.items.length-1)}Ppd(aa,Xa){this.gb.text=
aa.substring(0,Xa.range.start.character)+Xa.newText+aa.substring(Xa.range.end.character,aa.length);this.gridView.Ul&&(this.gridView.Xb.text=this.gb.text)}Txd(){this.AJa&&(this.formulaAssistanceTelemetryManager.wJ.selectByArrowKeyCounter++,this.AJa=!1);this.BJa&&(this.formulaAssistanceTelemetryManager.wJ.selectByMouseHoverCounter++,this.BJa=!1);this.zJa&&(this.formulaAssistanceTelemetryManager.wJ.commitByTabKeyCounter++,this.zJa=!1);this.xJa&&(this.formulaAssistanceTelemetryManager.wJ.commitByEnterKeyCounter++,
this.xJa=!1);this.yJa&&(this.formulaAssistanceTelemetryManager.wJ.commitByMouseClickCounter++,this.yJa=!1);this.X7a&&this.Nia&&(this.formulaAssistanceTelemetryManager.wJ.dismissSmartSuggestionExplicitlyCounter++,this.Nia=!1)}PEc(aa){switch(aa){case -798660877:case 137938150:case 2091832999:case 742457698:this.AJa=!0;break;case 125627505:this.zJa=!0;break;case 267796030:this.xJa=!0}}static WKa(){return document.createElement("div")}Q9h(aa){return aa.reduce((Xa,Lb)=>Xa|=0===Lb.type?Xb.Simple:Xb.Smart,
Xb.Dismissed)}}Object(h.a)(wc,"FormulaAutoCompleteControl",dd.a,[355,3,316]);class Vc{constructor(aa,Xa){var Lb,kc;this.Xg=aa;this.$=Xa;this.MCc=new Map;this.Xfb=null;this.tza=()=>{this.Vac.resolve(this.Xg.Tk);this.tkg()};this.RFf=()=>{this.Vac.reject(null);this.tkg()};this.dg=()=>{this.Xg.Bdb();this.lwd=null;this.MCc.clear();this.Loe()};this.KEd=(Nc,ad)=>{if(ad!==this.Srf)n.ULS.sendTraceTag(509678923,0,15,"onGetTableColHeadersSuccess called with a tableName different than the one saved for last request"),
this.eCa.reject();else if(Object(Id.a)(Nc))this.eCa.reject();else{var sd=Nc.Result;Object(da.b)(sd)&&0!==sd.length?(this.MCc.set(ad,sd),void this.eCa.resolve(Nc.Result)):this.eCa.reject()}};this.JEd=()=>{this.eCa.reject()};null===(kc=null===(Lb=I.h(this.$))||void 0===Lb?void 0:Lb.oc)||void 0===kc?void 0:kc.rm(this.dg);this.iQj=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(aa,Xa,Lb,kc){const Nc={D$:aa,vPe:Xa};var ad;if(ad=
Object(da.b)(this.lwd))ad=this.lwd,ad=!(Nc.D$.FirstRow===ad.D$.FirstRow&&Nc.D$.FirstColumn===ad.D$.FirstColumn&&Nc.D$.LastRow===ad.D$.LastRow&&Nc.D$.LastColumn===ad.D$.LastColumn&&Nc.D$.SheetName===ad.D$.SheetName&&Nc.vPe===ad.vPe);ad&&this.Xg.Bdb();this.lwd=Nc;this.iQj&&this.Xg.I7a||this.Xg.AZ(aa,Lb,kc,Xa);this.Vac=new da.a;this.Xg.I7a?this.Vac.resolve(this.Xg.Tk):this.jkj();return this.Vac.promise}getTableColHeaders(aa){if(this.Xfb&&3>=this.Xfb.status&&aa===this.Srf)return this.eCa.promise;this.eCa=
new da.a;if(this.MCc.has(aa))this.eCa.resolve(this.MCc.get(aa));else{this.Loe();this.Srf=aa;const Xa=this.$.Bb.getItemByName(aa).ej;this.Xfb=Object(fe.q)(this.$.pa.va,Xa,Lb=>this.KEd(Lb,aa),this.JEd,null,null)}return this.eCa.promise}dispose(){var aa,Xa;null===(Xa=null===(aa=I.h(this.$))||void 0===aa?void 0:aa.oc)||void 0===Xa?void 0:Xa.dm(this.dg)}jkj(){this.Xg.H0b(this.tza);this.Xg.ZPg(this.RFf)}tkg(){this.Xg.Lvc(this.tza);this.Xg.Eoj(this.RFf)}Loe(){Object(da.b)(this.Xfb)&&(Y.AFrameworkApplication.Hd.Wt(this.Xfb.Xs),
this.Xfb=null)}}Object(h.a)(Vc,"ServerDataProvider",null,[356]);var yd=a(328),Od=a(585),be=a(350),Qb=a(899);class zc{constructor(aa){this.oK=this.pK=this.tF=this.uF=!1;this.d_=aa}}Object(h.a)(zc,"MarqueeRangeData",null,[]);class Yc{constructor(aa,Xa,Lb,kc=!1){this.RZd=aa;this.VPb=Xa;this.o8a=kc;Lb?(this.d_=Lb.d_,this.uF=Lb.uF,this.tF=Lb.tF,this.pK=Lb.pK,this.oK=Lb.oK):n.ULS.shipAssertTag(510255180,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(h.a)(Yc,"MarqueeMetadata",null,[]);const zd=
"rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");class ke{constructor(aa,Xa,Lb){this.$=aa;this.pluginScheduler=Xa;this.formulaAssistanceTelemetryManager=Lb;this.nK=this.Wfb=!1;this.l0=null;this.INa=O.EwaSettings.INa();this.mza=()=>{this.nK=!1;this.l0=null};this.gridView=I.h(aa);this.gridView.Xb.rm(this.mza);this.U8a=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",
!1)}get coloredReferencesManager(){this.bWa||(this.bWa=this.$.da.Ba(281));return this.bWa}y1j(aa,Xa,Lb){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.Rgb(aa,Xa,Lb)}Rgb(aa,Xa,Lb){var kc;aa.textBox.addEventLogRecord("FormulaHighlightsControl.TryUpdateFormulaHighlights");if(this.Wfb||aa.vF)return!1;const Nc=isNullOrUndefined(Xa)?aa.text:Xa;if(1>=Nc.length)return this.$mg(aa,Nc,Object(da.b)(Xa));Lb=this.a$h(aa,Xa,Lb);Lb=null===(kc=this.l5a(Nc,Lb))||void 0===
kc?void 0:kc.formulaHighlights;if(!Lb)return n.ULS.sendTraceTag(512349465,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),this.$mg(aa,Nc,Object(da.b)(Xa));const {HWj:ad,Ogj:sd,Mgj:ce,hLi:Ce}=this.E_h(Lb,Nc);this.Jzc(aa,ad,!!Xa);Xa=aa.textBox.text;if(!wa.a.equals(Xa,Nc,!1))return n.ULS.shipAssertTag(38114182,0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Xa.length}], updatedTextLength [${Nc.length}]`),
Xa=aa.textBox.caretPosition,aa.textBox.text=Nc,aa.textBox.caretPosition=Xa,!0;this.mz(sd,ce,Ce);return this.nK=!0}KFb(aa,Xa,Lb){if(!aa||!Xa||!Lb)return n.ULS.shipAssertTag(512349463,0,!!aa,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),n.ULS.shipAssertTag(512349462,0,!!Xa,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),n.ULS.shipAssertTag(512349461,0,!!Lb,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const kc=Object(nc.a)(Yc,Xa.metadata);
if(!kc)return n.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),!1;var Nc=kc.RZd,ad=kc.VPb,sd=this.gridView.tb.Erd(Lb)?Lb.Kxb(kc.tF,kc.uF):Lb.ALa(kc.tF,kc.uF,kc.oK,kc.pK);if(!sd)return n.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),!1;const ce=ad.indexOf("!");-1!==ce&&(sd=ad.substring(0,ce+1)+sd);if(!aa.textBox.changeTextInExistingTextPart(Nc,ad,sd))return n.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),
!1;kc.VPb=sd;Nc=!0;for(ad=1;4>=ad;ad++)(sd=I.h(this.$).Eb.WC(3,ad,Xa.dU))?(sd.range=Lb,sd.metadata=kc):(n.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),Nc=!1);this.gridView.Eb.update(!1,!1);this.gridView.Ul&&(this.gridView.oc.textBox.text=aa.text);this.gridView.oc.OQa(new yd.a({zBb:!0}));return Nc}jvi(aa){if(3!==aa.Kq)return n.ULS.shipAssertTag(512349457,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),
!1;aa=Object(nc.a)(Yc,aa.metadata);return aa?aa.d_&&!aa.o8a:(n.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}bCa(aa,Xa){n.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+(Xa?"suspending":"resuming")+" colored references");Xa&&this.nK&&(this.nK=!1,this.mz(null,null),aa.textBox.wEe());this.Wfb=Xa}dispose(){this.gridView&&this.gridView.Xb&&this.gridView.Xb.dm(this.mza)}Zzb(aa){this.formulaAssistanceTelemetryManager.ND(["highlightPreviewRanges"]);
var Xa=this.l5a(aa,Qb.a);if(isNullOrUndefined(Xa))this.jic&&this.mz(null,null);else{var Lb=this.pka(),kc=[],Nc=new qd.a(!1),ad=[];Xa=Xa.formulaHighlights;for(const sd of Xa)if(Xa=sd.kind,0===Xa||2===Xa||1===Xa)Xa=za.C(sd.rangeInfo.sharedRange),Object(da.b)(Xa)&&(kc.push(new be.a(Xa,Lb)),this.zZ(Xa,Nc,1),ad.push(new Yc(sd.span.start,aa.substring(sd.span.start,sd.span.end),e(sd),!0)));this.mz(kc,Nc,ad);this.formulaAssistanceTelemetryManager.rv(["highlightPreviewRanges"],!0)}}D5j(aa,Xa){aa&&this.formulaAssistanceTelemetryManager.bcc.formulaHighlightsCounter++;
Xa&&this.formulaAssistanceTelemetryManager.bcc.parenthesesCouplingCounter++}$mg(aa,Xa,Lb){this.mz(null,null);if(this.nK){this.nK=!1;if(!this.INa){const kc=aa.textBox.caretPosition;aa.textBox.setPlainText(Xa);aa.textBox.caretPosition=Math.min(kc,Xa.length)}if(Lb)return!0}return!1}a$h(aa,Xa,Lb){let kc=Lb;Object(da.b)(Xa)?Object(da.b)(Lb)||(kc={index:Xa.length,length:0}):kc=aa.textBox.selection;return kc}l5a(aa,Xa){if(this.U8a&&this.yxi({content:aa,selection:Xa}))return this.l0.result;this.formulaAssistanceTelemetryManager.ND(["formulaHighlightsRequest"]);
const Lb=this.pluginScheduler.syncRequester().formulaHighlighting({content:aa,caretPosition:Xa.index,selectionLength:Xa.length});this.U8a&&(this.l0={content:aa,selection:Xa,result:Lb});this.formulaAssistanceTelemetryManager.rv(["formulaHighlightsRequest"]);return Lb}zZ(aa,Xa,Lb){let kc=Xa.getItem(aa.toString());kc||(kc=zd[Xa.count%zd.length],Xa.add(aa.toString(),kc));return String.format(kc,Lb)}sE(aa,Xa,Lb,kc,Nc=null,ad=null){n.ULS.shipAssertTag(512349453,0,Lb<=kc,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");
Lb<kc&&(Xa=Xa.substring(Lb,kc),aa.push(Object(xb.a)(new Od.a,{text:Xa,color:Nc,backgroundColor:ad})))}mz(aa,Xa,Lb=null){aa&&aa.length?(n.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+aa.length),aa.reverse(),Lb.reverse(),this.gridView.Eb.CB(aa,[3],!0,(kc,Nc)=>{if(kc&&kc.range&&Nc){n.ULS.shipAssertTag(512349448,0,Xa.kb(kc.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${kc.range.toString()}' doesn't exist in the range to color dictionary`);
var ad=this.zZ(kc.range,Xa,.1),sd=this.zZ(kc.range,Xa,1);this.$.frame&&this.$.frame.cD&&this.$.frame.cD.cN||(Nc.style.background=ad);Nc.style.borderColor=sd;Lb&&(Nc.setAttribute(z.a.P6a,kc.dU.toString()),kc.metadata=Lb[kc.dU])}else n.ULS.shipAssertTag(512349451,0,!!kc,"FormulaHighlightsControl.HighlightRanges: state is null"),n.ULS.shipAssertTag(512349450,0,!!kc.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),n.ULS.shipAssertTag(512349449,0,!!Nc,"FormulaHighlightsControl.HighlightRanges: div is null")})):
(aa=this.$.Mb.Kc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.Eb.Tj([3]),this.gridView.Eb.JSa(new be.a(null,this.pka()),[3]),aa.stop())}Jzc(aa,Xa,Lb){const kc=aa.textBox;kc.oF=!0;var Nc=kc.selection;const ad=Nc.index;Nc=ad+Nc.length;kc.setTextFromTextParts(Xa);Xa=kc.text.length;kc.selectRange(Math.min(ad,Xa),Math.min(Nc,Xa));Lb&&aa.OQa(new yd.a);kc.oF=!1}gec(){return this.gridView.Vq&&this.gridView.Vq.NF?this.gridView.Vq.NF:this.$.na}pka(){return this.gec().sheetId}E_h(aa,Xa){const Lb=
[],kc=new qd.a(!1),Nc=[],ad=[],sd=[];let ce=!1;var Ce=!1;let ve=0;const De=this.pka();for(const le of aa){this.sE(Nc,Xa,ve,le.span.start,null);switch(le.kind){case 0:case 1:case 2:aa=za.C(le.rangeInfo.sharedRange);if(isNullOrUndefined(aa)){n.ULS.sendTraceTag(512349464,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${le.kind.toString()}`);this.sE(Nc,Xa,le.span.start,le.span.end,null);break}Ce=this.zZ(aa,kc,1);this.sE(Nc,Xa,
le.span.start,le.span.end,Ce);Lb.push(new be.a(aa,De));ad.push({Start:le.span.start,End:le.span.end});Ce=Nc.length-1;sd.push(new Yc(Ce,Nc[Ce].text,e(le)));Ce=!0;break;case 3:this.sE(Nc,Xa,le.span.start,le.span.end,null,"rgba(229, 229, 229, 1)"),ce=!0}ve=le.span.end}this.sE(Nc,Xa,ve,Xa.length);this.D5j(Ce,ce);return{HWj:Nc,Ogj:Lb,Mgj:kc,hLi:sd}}yxi(aa){return Object(da.b)(this.l0)&&this.l0.content===aa.content&&this.l0.selection.index===aa.selection.index&&this.l0.selection.length===aa.selection.length}}
Object(h.a)(ke,"FormulaHighlightsControl",null,[354,3]);class Td{constructor(aa,Xa,Lb,kc,Nc,ad,sd){this.$=aa;this.functionInfoManager=Xa;this.calcManager=Lb;this.pluginScheduler=kc;this.formulaAssistanceUIControl=Nc;this.formulaAssistanceTelemetryManager=ad;this.Xg=sd;this.UMa=this.isCellContentOnlyEqualDuringEdit=!1;this.nca=null;this.Vla=-1;this.oda=0;this.tla=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.ned=O.EwaSettings.getBooleanFeatureGate("OfficeVSO:7135425_fixSetFunctionsInfoNotification",
!1);this.c2d=O.EwaSettings.isChangeGateEnabled("OfficeVSO:7262196_updateRequestCacheOnAutoCompleteCommit");this.sof=O.EwaSettings.isChangeGateEnabled("OfficeVSO:7395449_isSendingSchedulerWorkbookClosingNotificationEnabled");this.Uyi=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SkipNoFormulaBatchRequest",!1);this.yc=(ce,Ce)=>{Ce.Ef||Ce.Crd||this.pluginScheduler.notifier().notifyWorkbookClosing()};this.Gg=(ce,Ce)=>{this.gridView.eb||this.gridView.ei||this.mGb(null===Ce||void 0===Ce?void 0:
Ce.cell)};this.onFunctionInfoLoaded=()=>{this.ned||this.functionInfoManager.cdb(this.onFunctionInfoLoaded);this.jng();this.Xda()};this.lCf=(ce,Ce)=>{var ve=this.gb;ce=ve.text;ve=ve.textBox.caretPosition;0<this.oda&&this.formulaAssistanceTelemetryManager.wJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.ND(["argumentAssistanceComputation","argumentAssistanceOverall"]);Ce.shouldRequestAutocompleteOnCommit?this.n5f(ce,ve):this.VOd(ce,ve)};this.dg=()=>{this.isCellContentOnlyEqualDuringEdit&&
(this.formulaAssistanceTelemetryManager.UC.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=!1);this.UMa&&(this.formulaAssistanceTelemetryManager.UC.isCellContentFormulaCounter++,this.UMa=!1);O.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.b9b()};this.n6=(ce,Ce)=>{this.AQd(Ce.newValue)};this.Ej=()=>{this.dmg()};this.dmg=()=>{const ce=this.v8b.XMe;this.pluginScheduler.notifier().setDefinedNamesInfo(ce);n.ULS.sendTraceTag(512278605,
0,50,`FormulaAssistanceManager.updateDefinedNamesList updated defined names info with ${null===ce||void 0===ce?void 0:ce.length} names}`)};this.l5a=(ce,Ce)=>{ce=this.pluginScheduler.syncRequester().formulaHighlighting({content:ce,caretPosition:null===Ce||void 0===Ce?void 0:Ce.index,selectionLength:null===Ce||void 0===Ce?void 0:Ce.length});if(isNullOrUndefined(ce)||isNullOrUndefined(ce.formulaHighlights))n.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(ce)}`);
else return ce};this.functionInfoManager=Xa;this.formulaAssistanceUIControl=Nc;this.pluginScheduler=kc;this.gridView=I.h(this.$);this.Emf=O.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.FCd=O.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.U0c=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.Emf&&(this.v8b=new de(aa),this.gridView.Ca.dw(this.Ej),this.dmg());this.QWa=
new yb(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.S8=new wc(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.Dti=cb.a.LH(aa);this.aRj=cb.a.Hqb(aa);this.fqi=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AuthoringPerCharExp",!1);this.Zyi=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled",!1);this.Dti&&(this.Tqa=new ke(this.$,this.pluginScheduler,this.formulaAssistanceTelemetryManager));
aa.da.Ha(464,this);this.calcManager=Lb;cb.a.aR(this.$)&&this.Apd();this.gridView.oc.rm(this.dg);this.ned&&(this.functionInfoManager.QGa(this.onFunctionInfoLoaded),this.functionInfoManager.wV?this.jng():this.functionInfoManager.VJa({}))}get Kja(){return this.S8}get B0e(){return this.QWa}get SA(){return this.Tqa}get SIb(){return this.gb.Qwi?1:0}get gb(){return this.gridView.Mh}get tb(){return this.gridView.tb}dispose(){if(this.$){const aa=this.gridView;aa&&(aa.ha&&cb.a.aR(this.$)&&aa.ha.Cna(this.Gg),
this.Emf&&aa.Ca&&aa.Ca.Xw(this.Ej));this.sof&&this.$.$k(this.yc)}this.gridView.oc.dm(this.dg);this.S8.Znj(this.lCf);this.functionInfoManager&&this.functionInfoManager.cdb(this.onFunctionInfoLoaded);cb.a.kic&&this.gb&&this.gb.MKb(this.n6);ib.a.Ja(this.QWa);ib.a.Ja(this.S8);this.S8=this.QWa=this.functionInfoManager=this.$=null}Ysj(){this.Vla=-1;this.nca=null}b9b(){this.S8.visible=!1;this.QWa.visible=!1}Wh(){this.Xda();return!1}Xda(){if(!this.gb.UK)if(this.formulaAssistanceTelemetryManager.Oqb.formulaAssistanceRequestAttemptedCounter++,
this.sLj()){this.ned||this.functionInfoManager.wV||(this.functionInfoManager.QGa(this.onFunctionInfoLoaded),this.functionInfoManager.VJa({}));var aa=this.gb,Xa=aa.text;aa=aa.textBox.caretPosition;Xa.startsWith("=")&&(this.UMa=!0,1===Xa.length&&(this.isCellContentOnlyEqualDuringEdit=!0));this.formulaAssistanceTelemetryManager.ND("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" "));
this.n5f(Xa,aa);this.fqi&&this.Jsj(Xa,aa)}else this.formulaAssistanceTelemetryManager.Oqb.formulaAssistanceRequestOptimizedCounter++}n5f(aa,Xa){let Lb;Lb=this.Uyi&&!ec.f(aa)?Promise.resolve({kind:0,payload:{argumentAssistance:null,functionSuggestion:null,inCellSuggestion:null}}):this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:aa,caretPosition:Xa},argumentAssistance:{content:aa,caretPosition:Xa},inCellSuggestion:{content:aa,caretPosition:Xa}});
this.oda+=1;this.c2d&&(this.nca=aa,this.Vla=Xa);Lb.then(kc=>{--this.oda;0===kc.kind&&(this.ebf(kc.payload.argumentAssistance),this.Cci(kc.payload.functionSuggestion,aa));return null})}Jsj(aa,Xa){Xa={content:aa,caretPosition:Xa,enableAutocompleteWrapperPlugin:this.Zyi&&!this.aRj};this.tla&&(Xa=this.pluginScheduler.getRequester().runPerCharacterExperiment(Xa,this.SIb),this.oda+=1,Xa.then(Lb=>{--this.oda;if(0===Lb.kind)for(const kc of Lb.payload.results)0===kc.kind&&this.gridView.Iaa.oTd(kc.value,aa);
return null}))}VOd(aa,Xa){const Lb={content:aa,caretPosition:Xa};this.c2d&&(this.nca=aa,this.Vla=Xa);aa=this.tla?this.pluginScheduler.getRequester().argumentAssistance(Lb,this.SIb):this.pluginScheduler.requester().argumentAssistance(Lb);this.oda+=1;aa.then(kc=>{--this.oda;0===kc.kind&&this.ebf(kc.payload)})}sLj(){var aa=this.gb;const Xa=aa.text;aa=aa.textBox.caretPosition;if(this.S8.visible&&wa.a.equals(Xa,this.nca,!0)&&!ec.e(Xa)&&aa===this.Vla)return!1;this.c2d||(this.nca=Xa,this.Vla=aa);return!0}CQd(){this.tla?
this.pluginScheduler.getRequester().runExperiment(new Kf,this.SIb):this.pluginScheduler.requester().runExperiment(new Kf)}ebf(aa){aa&&this.gb.eb?(this.formulaAssistanceTelemetryManager.rv(["argumentAssistanceComputation"]),this.QWa.show(aa,this.gb.textBox.domElement)):this.QWa.dismiss()}Cci(aa,Xa){aa&&0<aa.items.length&&this.gb.eb&&this.gb.text===this.nca?this.U0c&&this.tb.n5(this.gridView.ha.ra.activeCell)?(this.formulaAssistanceTelemetryManager.UC.smartSuggestionWouldSuggestInsidePivotCounter++,
this.S8.dismiss()):(this.formulaAssistanceTelemetryManager.rv(["autoCompleteComputation"]),this.S8.show(aa)):this.S8.dismiss();this.gridView.Iaa.oTd(aa,Xa)}AQd(aa){aa={content:aa,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.tla?this.pluginScheduler.getRequester().runAuthoringExperiment(aa,this.SIb):this.pluginScheduler.requester().runAuthoringExperiment(aa)}mGb(aa){var Xa;const Lb=this.gridView.ha.ra.activeCell;if(Lb){var kc=this.calcManager.Tta(Lb,!1);if(kc){var Nc=
this.$.ua,ad=kc.sheet.index;0>=Nc.count||0>ad||ad>=Nc.count?n.ULS.sendTraceTag(512278608,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Nc.count}, currentSheetIndex = ${ad}.`):(ad=Nc=null,this.FCd&&void 0!==this.calcManager&&null!==this.calcManager&&(aa=null!==(Xa=null===aa||void 0===aa?void 0:aa.cell)&&void 0!==Xa?Xa:this.gridView.Ca.ds(Lb))&&(Xa=this.calcManager.njd(aa.Ci),void 0!==Xa&&null!==Xa&&(Nc=Xa.FormatString,ad=Xa.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:kc.range.col,
rowIndex:kc.range.row,sheetIndex:this.$.ua.getItem(kc.sheet.index).sheetId,docName:kc.sheet.document.name,docPath:kc.sheet.document.path,formatString:Nc,builtIn:ad}),n.ULS.sendTraceTag(512278607,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged sent notification to the scheduler. col: ${kc.range.col}, row: ${kc.range.row}`))}else n.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}else n.ULS.sendTraceTag(512278609,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged activeCell range is null")}jng(){const aa=
this.functionInfoManager.kcc;this.pluginScheduler.notifier().setFunctionsInfo(aa);n.ULS.sendTraceTag(512278606,0,50,`FormulaAssistanceManager.updateSchedulerFunctionList update functions info with ${null===aa||void 0===aa?void 0:aa.length} functions}`)}Apd(){this.gridView.ha.hha(this.Gg);const aa=cb.a.ZAb()?this.gridView.Jb(null):void 0;this.mGb(aa);cb.a.kic&&this.gb.KZa(this.n6);this.CQd();this.S8.oPg(this.lCf);this.pluginScheduler.setServerDataProvider(new Vc(this.Xg,this.$));this.Xda();this.sof&&
this.$.ij(this.yc)}Rgb(aa,Xa,Lb){Lb=Object(da.b)(Xa)?this.l5a(Xa,Object(da.b)(Lb)?Lb:Qb.a):this.l5a(aa.text,aa.textBox.selection);return this.Tqa.y1j(aa,Xa,Lb)}}Object(h.a)(Td,"FormulaAssistanceManager",null,[314,3]);var Ge=a(108);class bf extends kb.a{constructor(aa){super();this.$=aa;this.Gb()}create(){const aa=cb.a.aR(this.$),Xa=O.EwaSettings.xa(329),Lb=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),kc=cb.a.vV(this.$),Nc=this.$.da,ad=k.GetServiceTaskFactory.create(Nc,
134,this.ka,this.Na),sd=Object(X.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(Ge.c)(E.a.resolve(G.L,{Wb:this.Na})):k.GetServiceTaskFactory.Pa(this.$.da,12,477,this.Na);let ce;ce=cb.a.O4(this.$)?k.GetServiceTaskFactory.create(this.$.da,449,this.$.ka,1):pa.Task.Ta(null);let Ce;Ce=cb.a.aR(this.$)?k.GetServiceTaskFactory.create(this.$.da,414,this.$.ka,1):pa.Task.Ta(null);let ve;ve=O.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&!kc?O.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?
Object(Ge.c)(E.a.resolve(G.w,{Wb:this.Na})):k.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na):pa.Task.Ta(null);if(Lb||aa){let De;De=O.EwaSettings.OH()?Object(Ge.c)(E.a.resolve(G.f,{Wb:this.Na})):k.GetServiceTaskFactory.Pa(Nc,266,265,this.Na);const le=Object(X.b)("OfficeVSO:7624477_migratingFormulaAssistanceReadoutHandlerService")?Object(Ge.c)(E.a.resolve(G.s,{Wb:this.Na})):k.GetServiceTaskFactory.Pa(Nc,219,220,this.Na),qf=k.GetServiceTaskFactory.Pa(Nc,491,492,this.Na);w.TaskExtensions.za(w.TaskExtensions.Md([De,
Ce,ce,le,qf,ve,ad,sd],this.ka),()=>{const Nf=Nc.Ba(19)||new jd(this.$,Ce.result),Tf=le.result;if(kc){var Oa=Nc.Ba(464);Oa||(Oa=new Td(this.$,Nf,De.result,Ce.result,ce.result,qf.result,sd.result.$6c(this.$,ad.result)),Tf.Z_c(Oa.B0e),Tf.$_c(Oa.Kja),Tf.a0c(Oa.Kja))}else Oa=Nc.Ba(221),Oa||(Oa=new af(this.$,Nf,ad.result,De.result,null,sd.result,ce.result,qf.result,Ce.result,ve.result),Tf.Z_c(Oa.C0e),Tf.a0c(Oa.W0e),Tf.$_c(Oa)),Xa&&(Nc.Ba(317)||new mb(this.$));this.qb(Nf)},this.ka,3)}else{const De=Object(X.b)("OfficeVSO:7624477_migratingFormulaAssistanceReadoutHandlerService")?
Object(Ge.c)(E.a.resolve(G.s,{Wb:this.Na})):k.GetServiceTaskFactory.Pa(Nc,219,220,this.Na),le=k.GetServiceTaskFactory.Pa(Nc,491,492,this.Na);w.TaskExtensions.za(w.TaskExtensions.Md([De,ce,Ce,ve,ad,sd,le],this.ka),()=>{const qf=Nc.Ba(19)||new jd(this.$,Ce.result),Nf=De.result;let Tf=Nc.Ba(221);Tf||(Tf=new af(this.$,qf,ad.result,null,null,sd.result,ce.result,le.result,Ce.result,ve.result),Nf.Z_c(Tf.C0e),Nf.a0c(Tf.W0e),Nf.$_c(Tf));Xa&&(Nc.Ba(317)||new mb(this.$));this.qb(qf)},this.ka,3)}}static la(aa){aa.da.Ha(153,
new bf(aa))}}Object(h.a)(bf,"FunctionInfoManagerFactory",kb.a,[]);a.d(B,"a",function(){return Fa});const Fa=()=>{d.a.Fa(aa=>{pb.la(aa);Object(X.b)("OfficeVSO:7624477_migratingFormulaAssistanceReadoutHandlerService")||Ga.la(aa);bf.la(aa)})};String(f);window.___1678693016458_closurehack=f},1173:function(r,B,a){var c={};a.r(c);a.d(c,"ReactContextMenuController",function(){return Fe});var b=a(0),e=a(714),f=a(160),d=a(7),h=a(15),l=a(86),k=a(4),w=a(167),n=a(1105),x=a(1103),m=a(739),u=a(5),t=a(465),y=a(568),
v=a(73),A=a(59),z=a(933),C=a(132),H=a(44),I=a(198),S=a(63),P=a(50),D=a(767),G=a(151),E=a(38),O=a(117),N=a(215),J=a(96),W=a(77),ea=a(36),R=a(29),Y=a(255),U=a(1),da=a(196),T=a(14),ka=a(66),L=a(290),fa=a(21),wa=a(133),oa=a(787),xa=a(788),bb=a(134),Za=a(118),La=a(35),va=a(430);class Ba{constructor(){this.Sections=this.Id=null}}Object(b.a)(Ba,"AutoFilterMenu",null,[]);class Ea{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=
!1;this.TooltipText=this.Id=this.IconName=null}}Object(b.a)(Ea,"MenuItem",null,[]);class pa{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(b.a)(pa,"MenuSection",null,[]);var $a;(function(Ha){Ha[Ha.filterOnValue=0]="filterOnValue";Ha[Ha.filterOnCellColor=1]="filterOnCellColor";Ha[Ha.filterOnFontColor=2]="filterOnFontColor";Ha[Ha.filterOnIcon=3]="filterOnIcon"})($a||($a={}));Object(b.b)("FilterConditionType",$a);class cb{constructor(){this.isSuccess=!1}}Object(b.a)(cb,
"ApplyFilterByValueResponse",null,[]);class ib{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(b.a)(ib,"FilterByValueItem",null,[]);class ta{constructor(){this.selectedFilterIcon=this.selectedFilterFontColor=this.selectedFilterCellColor=this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(b.a)(ta,"GetColorsAndIconsResponse",
null,[]);class Ya{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(b.a)(Ya,"GetFilterByValueItemsResponse",null,[]);class Da{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(b.a)(Da,"ShowSortFilterMenuParams",null,[]);class ba{constructor(){this.focusShiftOnMenuDismiss=this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applyFilterByColorOrIconRequest=this.applySortByColorOrIconRequest=
null}}Object(b.a)(ba,"SortFilterControllerFactoryParams",null,[]);class ya{constructor(){this.top=this.left=0}}Object(b.a)(ya,"TargetPoint",null,[]);var V=a(58),Z=a(108),ja=a(33),la=a(157),ua=a(232),eb=a(8),Eb=a(153),Wb=a(54),Ab=a(70);const Jb=u.a.kch;class Gb extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateAutoFilterContextMenu",1675506831,1651433993,Jb,!0,!1,"AutoFilterContextMenuRoot",yb,Xb,!1,wc);this.V1b=this.uCa=this.sheetName=this.Ttb=null;this.a4a=this.ltf=!1;this.j8c=this.mbb=this.HLe=
this.rQa=this.fec=this.dva=this.Ffb=this.AQa=null;this.VV=()=>{this.BBc();this.$.ea.Zm(this.VV)};this.SFf=Vc=>{this.a4a||wa.b(this.$).qd(C.a.TFf,this.El(),void 0,!0);var yd={};this.$.Sj(yd);var Od=this.$.ea.isNamedObjectViewMode;const be=A.a.Yh(this.V1b);be.SheetName=Od?yd.NamedObjectName:yd.SheetName;be.NamedObjectView=Od;yd=!!Vc.searchText;Od=586;this.a4a&&(yd&&(be.ItemListOptions=this.afh(Vc.searchText),Od=597),wa.b(this.$).qd(C.a.TFf,{["UserOperation"]:Od.toString()},void 0,!0));const Qb=this.DEd(yd),
zc=this.WXi(),Yc=this.$.pa.va.$b();this.HLe=Yc.RequestId;this.a4a&&this.fec&&!this.fec.dequeueUtcTime&&(this.$.userOperationManager.rua(this.fec),this.$4g());Vc=new I.a(Od,0,(zd,ke,Td)=>this.j8c=S.n(this.$.pa.va,be,L.b(zd,Qb),this.a4a?L.a(ke,zc):ke,Td,null,Yc),80);this.fec=this.$.userOperationManager.Oc(Vc,null);this.mbb=this.j8c;this.rQa=this.HLe};this.onMenuItemClick=(Vc,yd,Od)=>{wa.b(this.$).qd(C.a.L1i,this.El(),void 0,!0);yd={["CommandValueId"]:yd,["MenuItemId"]:yd,["InputMethod"]:Od,["TopCellAddress"]:this.uCa};
const be=new J.a(Vc,Od,this.$.isEditMode?2:1,19,null);this.$.Ia.Hb(be,yd);h.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${Vc}, ${Od}`)};this.focusShiftOnMenuDismiss=()=>{fa.h(this.$).focus()};this.bCf=Vc=>{if(Vc.checkedItems&&Vc.checkedItems.length){wa.b(this.$).qd(C.a.cCf,this.El(),void 0,!0);var yd=A.a.Yh(this.V1b),Od={};this.$.Sj(Od);Od.FirstRow=0;Od.FirstColumn=yd.Column;var be=this.$.ea.isNamedObjectViewMode;yd.NamedObjectView=be;yd.SheetName=be?Od.NamedObjectName:
Od.SheetName;var Qb=zd=>{if(oa.a.hOb(zd)){const ke=oa.a.jxb(zd);this.Nxa?oa.a.QAa(xa.a.applyItemFilter,ke.MessageIdName,Za.a.fta,!0,oa.a.isSessionEndingError(ke.MessageId)):h.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${ke.MessageIdName}`)}Y.a(zd)||(h.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),wa.b(this.$).qd(C.a.LFf,this.El(),void 0,!0),zd=Object(d.a)(new cb,{isSuccess:!0}),
this.Ffb.onApplyFilterByValueFinish(zd),this.OO(this.uCa))},zc=this.L6b(yd,Od),Yc=new I.a(208,0,(zd,ke,Td)=>S.a(this.$.pa.va,zc,Vc.checkedItems,L.b(zd,Qb),ke,Td,null,null),6,()=>new z.a(Vc.checkedItems,zc));this.Obg(()=>{this.$.userOperationManager.Oc(Yc,null)})}else h.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.Lwe=Vc=>{const yd=H.o(this.uCa,this.$),Od=H.v(this.uCa,this.$);var be=Object(d.a)(new n.a,{SortConditionType:Vc.type,
RowColOffset:yd.FirstColumn-Od.FirstColumn,SortColor:Vc.color,SortIconSet:Vc.icon.IconSet,SortIcon:Vc.icon.Icon,IsAscending:!0});be=Object(d.a)(new x.a,{OperationType:1,ActiveCell:yd,SelectedRange:Od,SortConditions:[be],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const Qb={};Qb.SortOptions=be;Qb.SelectedRange=Od;Qb.OriginalActiveCell=yd;Qb.ShouldRestoreSelection=!1;Qb.ShouldPromptNamedSheetViewTeachingDialog=!0;h.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${Vc.type}`);
this.$.Yc(-1089513346,v.a.zb,19,{["CustomSortCommandData"]:Qb})};this.Bwe=Vc=>{if(Vc.color||Vc.icon){wa.b(this.$).qd(C.a.ESi,this.El(),void 0,!0);var yd=A.a.Yh(this.V1b),Od={};this.$.Sj(Od);Od.FirstRow=0;Od.FirstColumn=yd.Column;var be=this.$.ea.isNamedObjectViewMode;yd.NamedObjectView=be;yd.SheetName=be?Od.NamedObjectName:Od.SheetName;yd.ColorOrIconOptions=this.$eh(Vc);var Qb=zd=>{if(oa.a.hOb(zd)){const ke=oa.a.jxb(zd);this.Nxa?oa.a.QAa(xa.a.filterByColorOrIcon,ke.MessageIdName,Za.a.fta,!0,oa.a.isSessionEndingError(ke.MessageId)):
h.ULS.sendTraceTag(512258702,0,10,"AutoFilterContextMenu::OnApplyFilterByColorOrIcon failed with AutoFilterException -{0}",ke.MessageIdName)}Y.a(zd)||(h.ULS.sendTraceTag(512258701,0,50,"AutoFilterContextMenu::OnApplyFilterByColorOrIcon service call succeeded"),wa.b(this.$).qd(C.a.uXi,this.El(),void 0,!0),this.OO(this.uCa))},zc=this.L6b(yd,Od),Yc=new I.a(266,0,(zd,ke,Td)=>{var Ge=this.$.pa.va;zd=L.b(zd,Qb);const bf=Ge.Oa(41,null);bf.parameters=zc;bf.autoFilterOptions=yd;return S.g(Ge,"ApplyColorOrIconFilter",
bf,zd,ke,Td,null,64)},6);this.Obg(()=>{this.$.userOperationManager.Oc(Yc,null)})}else h.ULS.sendTraceTag(512258703,0,15,"AutoFilterContextMenu::applyFilterByColorOrIcon Received Zero params to apply filter on")};this.Nxa=oa.a.Cqd();this.aB=U.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get Sw(){return"PopulateAutoFilterContextMenu"}get vB(){return u.a.iUf}executeCommand(Ha,yb,Xb){Ha=yb.command;switch(Ha){case 1701016594:return m.a.zHh(Xb),V.Task.Ta(!0);case 966232027:const wc=
new w.a;E.TaskExtensions.za(P.GetServiceTaskFactory.Pa(this.$.da,8,9,0),Vc=>{this.tei(Xb,Vc.result);wc.setResult(!0)},this.ka,3).continueWith(()=>{wc.setResult(!1)},5,this.ka,ua.a.instance);return wc.task;default:return da.a(Ha)}}tei(Ha,yb){const Xb=Ha.domEvent;if(W.e(Xb.rawEvent)&&(W.g(Xb),Xb.target)){var wc=new G.a(this.$.ua);if(wc.Td(4096)||wc.Td(2048)){var Vc=A.a.Yh(Ha[v.a.Sf]);this.jag(Vc)&&(this.ltf?this.lwc(Xb.target,Vc,yb):(this.AQa=()=>{this.jag(Vc)&&(this.zmi(),this.lwc(Xb.target,Vc,yb),
this.a4a=U.EwaSettings.isChangeGateEnabled("OfficeVSO:7213347_AFMenu_FilterByValueSearch"),this.ltf=!0)},this.BBc()))}}}Ac(Ha,yb,Xb){switch(yb.command){case 1701016594:case 966232027:return!!Xb;default:return!1}}fId(Ha){Ha.MenuSectionList.push(...this.Ttb)}zmi(){va.a(()=>{U.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?this.Ffb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(d.a)(new ba,{getFilterByValueItemsRequest:this.SFf,
applyFilterByValueRequest:this.bCf,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:Gb.o0c,applySortByColorOrIconRequest:this.Lwe,applyFilterByColorOrIconRequest:this.Bwe})):this.Ffb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(d.a)(new ba,{getFilterByValueItemsRequest:this.SFf,applyFilterByValueRequest:this.bCf,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:Gb.o0c,applySortByColorOrIconRequest:this.Lwe,
applyFilterByColorOrIconRequest:this.Bwe}))});this.dva=l.a.instance.og("Common.IExternalUICommandDefinitionMapping")||new y.a(this.$.Cb,this.$)}lwc(Ha,yb,Xb){wa.b(this.$).qd(C.a.lwc,this.El(),void 0,!0);if(yb){Xb=this.$Sh(yb,Xb);var wc=Sys.UI.DomElement.getBounds(Ha);Ha=wc.x+wc.width;wc=wc.y;if(fa.h(this.$).fD){yb.Cell||h.ULS.sendTraceTag(509220166,0,10,"AutoFilterContextMenu.renderReactAutoFilterMenu:\u00a0autoFilterData.Cell is undefined.");Ha=-1===yb.Cell.FirstRow;yb=m.a.Igd(this.$,yb.Cell,Ha);
if(!m.a.erd(yb,Ha))return;yb=m.a.Xgd(this.$,yb,!0,Ha);if(!yb){h.ULS.sendTraceTag(509220165,0,10,`AutoFilterContextMenu.renderReactAutoFilterMenu:\u00a0failed to get the context menu coordinates. isHeaderCommandData=${Ha}`);return}Ha=yb.x;wc=yb.y}else if(this.aB&&!yb.IsHeaderSnapped){if(!m.a.frd(this.$,yb.Cell))return;yb=m.a.Ygd(this.$,yb.Cell,!0);Ha=yb.x;wc=yb.y}yb=fa.h(this.$).rtl?new Sys.UI.Point(Ha-La.a(this.$).eHa(Gb.o0c),wc):new Sys.UI.Point(Ha,wc);yb=La.a(this.$).ska(yb);Xb=Object(d.a)(new Da,
{targetPoint:Object(d.a)(new ya,{left:yb.x,top:yb.y}),autoFilterMenu:Xb});this.Ffb.showSortFilterMenu(Xb);this.$.Yc(-544117314,-1,0,null)}else h.ULS.shipAssertTag(537167135,0,!!yb,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}jag(Ha){return(null===Ha||void 0===Ha?0:Ha.Cell.SheetName)?fa.h(this.$).j5?Ha.Cell.SheetName===this.$.na.name:Ha.Cell.SheetName===this.$.na.sheetName:!0}$Sh(Ha,yb){return(Ha=this.aTh(Ha,yb))?this.PRf(Ha):null}PRf(Ha){const yb=[];for(const Xb of Ha.Sections){if(Object(la.g)(this.$)&&
U.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&Xb.Title===T.a.instance.ga(1951))continue;const wc=this.Tcj(Xb);yb.push(wc)}return Object(d.a)(new Ba,{Id:Ha.Id,Sections:yb})}Tcj(Ha){const yb=[];for(const Xb of Ha.MenuItems)if(2===Xb.Identifier)this.V1b=Xb.CommandData;else switch(Xb.Type){case 3:case 2:yb.push(this.Rcj(Xb,2===Xb.Type));break;case 1:yb.push(this.Scj(Xb))}return Object(d.a)(new pa,{MenuItems:yb,DisplayType:Ha.DisplayType,Id:this.mQh(Ha)})}Scj(Ha){let yb;({label:yd,
sMa:yb}=this.F1e(Ha));const Xb=this.PRf(Ha.SubMenu),wc=this.w1e(Ha);let Vc="MissingIcon_20";null!==yb&&(Vc=this.dva.udc(yb));var yd=yd||Ha.Label;return Object(d.a)(new Ea,{Disabled:Ha.Disabled,Type:Ha.Type,Identifier:Ha.Identifier,Id:wc,CommandData:Ha.CommandData,Label:yd,SubMenu:Xb,IsChecked:Ha.IsChecked,IconName:"MissingIcon_20"===Vc?null:Vc})}Rcj(Ha,yb){let Xb,wc;({label:yb,sMa:Xb,Er:wc}=this.rcc(Ha,yb&&Ha.IsChecked));const Vc=this.Qfd(Ha,yb);let yd="MissingIcon_20";null!==Xb&&(yd=this.dva.udc(Xb));
return Object(d.a)(new Ea,{Disabled:Ha.Disabled,Type:Ha.Type,Identifier:Ha.Identifier,Id:Vc,RibbonCommand:wc,CommandData:Ha.CommandData,Label:yb||Ha.Label,SubMenu:null,IsChecked:Ha.IsChecked,IconName:"MissingIcon_20"===yd?null:yd})}aTh(Ha,yb){var Xb;this.uCa=Xb=H.D(Ha.Cell);this.sheetName=this.$.na.sheetName;yb=yb||t.a(this.$);const wc=fa.h(this.$).fD,Vc=-1===Ha.Cell.FirstRow;if(!wc&&Ha.IsHeaderSnapped||wc&&Vc)Xb=yb.ebc.y_h(Xb);else{yb=fa.h(this.$).Ca.awa(Xb);if(!yb)return this.Nxa?oa.a.QAa(xa.a.kUf,
bb.a.lbi,Za.a.Nqb,!0,!1):(Ha=fa.h(this.$).view.visibleArea,h.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${Xb}, visible range: ${Ha}`)),null;Xb=yb.autoFilterMenu}if(!Xb)return this.Nxa?oa.a.QAa(xa.a.kUf,bb.a.zMi,Za.a.Nqb,!0,!1):h.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;
this.Lub=Ha.Cell.FirstRow+"_"+Ha.Cell.FirstColumn;return Xb}BBc(){let Ha=()=>P.GetServiceTaskFactory.Pa(this.$.da,283,284,1);U.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")&&(Ha=()=>Z.c(Eb.a.resolve(Wb.m,{Wb:1})));if(this.$.ea.Kf){const yb=Ha();E.TaskExtensions.za(yb,()=>{this.Nxa?yb.result.Ll.loadScript("sortFilter").then(()=>{this.AQa()},Xb=>{ka.a.Kj(Xb,"AutoFilterContextMenu.SortFilterScriptLoad");oa.a.QAa(xa.a.BBc,bb.a.pRj,Za.a.Nqb,!1,!1)}):E.TaskExtensions.za(Z.c(yb.result.Ll.loadScript("sortFilter")),
()=>{this.AQa()},this.$.ka,3)},this.$.ka,3)}else this.$.ea.Zj(this.VV)}afh(Ha){const yb={};yb.SearchText=Ha;yb.Page=1;yb.DateNodeType=-1;return yb}$eh(Ha){const yb={};yb.FilterType=Enum.toString($a,Ha.type);yb.FilterColor=Ha.color;yb.FilterIcon=Ha.icon.Icon;yb.FilterIconSet=Ha.icon.IconSet;return yb}$4g(){this.rQa&&(h.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.rQa}`),S.h(this.$.pa.va,
this.rQa,null,null,null),this.rQa=null);this.mbb&&(k.AFrameworkApplication.Hd.Wt(this.mbb.Xs),this.mbb=null)}DEd(Ha){return yb=>{this.mbb=this.rQa=null;if(oa.a.hOb(yb)){var Xb=oa.a.jxb(yb);this.Nxa?oa.a.QAa(Ha?xa.a.searchAutoFilterItemList:xa.a.getAutoFilterItemList,Xb.MessageIdName,Za.a.Nqb,!0,!0):h.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${Xb.MessageIdName}`)}if(!Y.a(yb)){h.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");
Xb=yb.Result;yb=new ea.a(!0);var wc=Xb.AutoFilterDateNodes?!0:!1;Xb.AutoFilterItems&&yb.add("AutoFilterItemsCount",Xb.AutoFilterItems.length);wc&&yb.add("AutoFilterDateItemsCount",Xb.AutoFilterDateNodes.length);yb.add("Location","contextMenu");wc=this.a4a?Object(d.a)(new Ya,{filterByValueItems:this.bIe(Xb),hasMoreRecords:Xb.ItemListMaxExceeded,searchText:Xb.SearchText}):Object(d.a)(new Ya,{filterByValueItems:this.bIe(Xb),hasMoreRecords:Xb.ItemListMaxExceeded});this.Ffb.onGetFilterByValueItemsFinish(wc);
Ha||(h.ULS.shipAssertTag(529063959,0,null!==Xb.FontColors&&null!==Xb.CellColors&&null!==Xb.Icons&&null!==Xb.SelectedSortFontColors&&null!==Xb.SelectedSortCellColors&&null!==Xb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),wc=Object(d.a)(new ta,{fontColors:Xb.FontColors,cellColors:Xb.CellColors,icons:Xb.Icons,getColorName:this.getColorName,selectedSortFontColor:0<Xb.SelectedSortFontColors.length?Xb.SelectedSortFontColors[0]:
null,selectedSortCellColor:0<Xb.SelectedSortCellColors.length?Xb.SelectedSortCellColors[0]:null,selectedSortIcon:0<Xb.SelectedSortIcons.length?Xb.SelectedSortIcons[0]:null,selectedFilterCellColor:-1!==Xb.SelectedFilterCellColor?Xb.SelectedFilterCellColor:null,selectedFilterFontColor:-1!==Xb.SelectedFilterFontColor?Xb.SelectedFilterFontColor:null,selectedFilterIcon:null!==Xb.SelectedFilterIcon?Xb.SelectedFilterIcon:null}),U.EwaSettings.isChangeGateEnabled("OfficeVSO:7573807_IsColorOrIconPresent")&&
(Xb=1<Xb.FontColors.length||1<Xb.CellColors.length||1<Xb.Icons.length)&&yb.add("AutoFilterColorOrIconPresent",Xb),wa.b(this.$).qd(C.a.DEd,yb.Du,void 0,!0),this.Ffb.onGetColorsAndIconsFinish(wc))}}}WXi(){return Ha=>{this.mbb=this.rQa=null;Ha=O.a.Ue(Ha.data);Ha=R.a.qc(Ha);h.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${Ha}].`)}}bIe(Ha){const yb=this.Kch(Ha),Xb=this.Rch(Ha.AutoFilterItems),wc=[],Vc=[];let yd=0,Od=0;Ha.HasBlanks&&(Ha=Gb.a7c(T.a.instance.ga(782),
Ha.IsBlanksSelected?1:0,u.a.oye),wc[yd++]=Ha);for(const be of yb)wc[yd++]=be;if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const be of Xb)-1!==Array.indexOf(eb.a.jbd,be.displayText)?Vc[Od++]=be:wc[yd++]=be;else for(const be of Xb)wc[yd++]=be;return Array.prototype.concat(Vc,wc)}Kch(Ha){const yb=[];if(!Ha.AutoFilterDateNodes||!Ha.AutoFilterDateNodes.length)return yb;const Xb=[this.p5a(Ha.YearKeys,Ha.YearValues),this.p5a(Ha.MonthKeys,Ha.MonthValues),this.p5a(Ha.DayKeys,
Ha.DayValues),this.p5a(Ha.HourKeys,Ha.HourValues),this.p5a(Ha.MinuteKeys,Ha.MinuteValues),this.p5a(Ha.SecondKeys,Ha.SecondValues)];let wc=!1,Vc=!1,yd=0;var Od=null;const be=Array(6);var Qb=null;for(const zc of Ha.AutoFilterDateNodes){be[0]&&(Qb.Year!==zc.Year?(wc=!0,yd=0,Od=null):Qb.Month!==zc.Month?(Vc=!0,yd=1,Od=be[0]):Qb.Day!==zc.Day?(yd=2,Od=be[1]):Ha.ShowTime&&(Qb.Hour!==zc.Hour?(yd=3,Od=be[2]):Qb.Minute!==zc.Minute?(yd=4,Od=be[3]):(yd=5,Od=be[4])));for(;6>yd;){let Yc;switch(yd){case 0:Yc=zc.Year;
Qb=Xb[0].getItem(Yc.toString());break;case 1:Yc=zc.Month;Qb=Xb[1].getItem(Yc.toString());break;case 2:Yc=zc.Day;Qb=Xb[2].getItem(Yc.toString());break;case 3:Yc=zc.Hour;Qb=Xb[3].getItem(Yc.toString());break;case 4:Yc=zc.Minute;Qb=Xb[4].getItem(Yc.toString());break;case 5:Yc=zc.Second;Qb=Xb[5].getItem(Yc.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Qb=Gb.a7c(Qb,-1!==zc.NodeType&&yd>=zc.NodeType?1:0,Od?Od.key+";"+Yc:u.a.p0c+Yc,!1,[]);Od=Od?Od.children:yb;
Od=Od[Od.length]=Qb;be[yd]=Qb;switch(yd){case 5:yd=6;break;case 2:yd=Ha.ShowTime?yd+1:6;break;default:yd++}}Qb=zc}wc||(be[0].expanded=!0,Vc||(be[1].expanded=!0));return yb}Rch(Ha){const yb=[];if(!Ha)return yb;let Xb=0;for(const wc of Ha)yb[Xb++]=Gb.a7c(wc.DisplayString,wc.Selected?1:0,u.a.q0c+wc.DisplayString);return yb}p5a(Ha,yb){const Xb=new ea.a(!0);if(!Ha||!yb)return Xb;const wc=Ha.length<yb.length?Ha.length:yb.length;for(let Vc=0;Vc<wc;Vc++)Xb.add(Ha[Vc].toString(),yb[Vc]);return Xb}L6b(Ha,yb){const Xb=
{};Xb.Location=yb;Xb.FieldId=Ha.Id.toString();Xb.DataSourceIndex=-1;Xb.FilterType=Ha.AutoFilterType;Xb.AnchorType=0;Xb.ChartId=null;Xb.AnchorValue1=-1;Xb.AnchorValue2=-1;Xb.Property=Ha.RichProperty;return Xb}OO(Ha){ja.a.Ela(this.$)&&E.TaskExtensions.za(P.GetServiceTaskFactory.Pa(this.$.da,430,431,1),yb=>{yb.result.Qea(Ha);h.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.ka,3)}El(){return{["Location"]:"contextMenu"}}getColorName(Ha){return D.a.xLa(N.a.qH(Ha))}Obg(Ha){const yb=
Object(Ab.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Z.c(Eb.a.resolve(Wb.z,{Wb:3})):P.GetServiceTaskFactory.Pa(this.$.da,309,310,3);E.TaskExtensions.za(yb,Xb=>{Xb.result.lTa().continueWith(wc=>{wc.result&&Ha()})},this.$.ka,3)}static a7c(Ha=null,yb=0,Xb=null,wc=!1,Vc=null){return Object(d.a)(new ib,{displayText:Ha?m.a.qf(Ha):Ha,state:yb,key:Xb,parent:null,children:Vc,indentationLevel:0,expanded:wc})}}Gb.o0c=268;Object(b.a)(Gb,"AutoFilterContextMenu",m.a,[]);var Nb=a(744),Ja=a(87),ab=a(197),
wb=a(65),xb=a(18);class rb{}rb.lZe=26;rb.Gdd=[228,229,0,98,0,94,93];Object(b.a)(rb,"Constants",null,[]);class za{constructor(Ha,yb,Xb,wc){this.IDg=Ha;this.kyg=yb;this.oyg=Xb;this.SHg=wc}get ovi(){return 3===this.q7b}get qzi(){return 4===this.q7b&&!!this.subMenu}get subMenu(){return this.SHg}get Sxf(){return this.IDg}get q7b(){return this.kyg}get z8c(){return this.oyg}}Object(b.a)(za,"FiltersMenuData",null,[]);class Aa extends za{constructor(Ha,yb){super(Ha,2,0,null);this.pye=yb}}Object(b.a)(Aa,"AutoFilterFiltersMenuData",
za,[]);class pb{}pb.zWj=[new za(99,2,0,null),new za(100,2,1,null),new za(0,3,0,null),new za(170,2,2,null),new za(172,2,4,null),new za(0,3,0,null),new za(174,2,6,null),new za(175,2,7,null),new za(0,3,0,null),new za(107,0,0,null)];pb.$Qi=[new za(99,2,0,null),new za(100,2,1,null),new za(0,3,0,null),new za(101,2,8,null),new za(102,2,10,null),new za(103,2,12,null),new za(0,3,0,null),new za(104,1,0,null),new Aa(105,1),new Aa(106,2),new za(0,3,0,null),new za(107,0,0,null)];pb.Jmh=[new za(99,2,0,null),new za(0,
3,0,null),new za(111,2,10,null),new za(112,2,8,null),new za(103,2,12,null),new za(0,3,0,null),new Aa(109,8),new Aa(108,9),new Aa(110,10),new za(0,3,0,null),new Aa(114,11),new Aa(113,12),new Aa(115,13),new za(0,3,0,null),new Aa(116,14),new Aa(117,15),new Aa(118,16),new za(0,3,0,null),new Aa(119,17),new Aa(120,18),new Aa(121,19),new za(0,3,0,null),new Aa(122,20),new Aa(123,21),new Aa(124,22),new za(0,3,0,null),new Aa(125,23),new za(126,2,12,[new Aa(127,24),new Aa(128,25),new Aa(129,26),new Aa(130,27),
new za(0,3,0,null),new Aa(131,28),new Aa(132,29),new Aa(133,30),new Aa(134,31),new Aa(135,32),new Aa(136,33),new Aa(137,34),new Aa(138,35),new Aa(139,36),new Aa(140,37),new Aa(141,38),new Aa(142,39)]),new za(0,3,0,null),new za(107,0,0,null)];Object(b.a)(pb,"Constants",null,[]);var kb=a(934),Cb=a(83);class ob extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,ob.mJh,!0,!1,ob.ZLb,yb,Xb,!1,wc);this.vm=null}get Sw(){return"PopulateAutoFilterFieldListContextMenu"}get vB(){return u.a.jUf}executeCommand(Ha,
yb,Xb){Ha=yb.command;switch(Ha){case -699941697:this.applyAutoFilterFieldList(yb,Xb);break;case 216058793:break;case -1494291901:break;default:return da.a(Ha)}return V.Task.Ta(!0)}Ogd(Ha,yb){return!Ha||Ha.length<=yb?(h.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(Ha[yb],10)}IJd(Ha,yb,Xb,wc,Vc,yd){const Od=this.Ogd(Vc,yd);0>Od&&h.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");
switch(rb.Gdd[Od]){case 98:Ha=new J.a(-2058042992,yb.method,yb.mode,yb.Ve,yb.tabName);this.vm.YG.Tvb(this.$,wc,0,Ha);break;case 228:Ha=new J.a(504133448,yb.method,yb.mode,yb.Ve,yb.tabName);this.vm.YG.Tvb(this.$,wc,0,Ha);break;case 229:Ha=new J.a(-798968736,yb.method,yb.mode,yb.Ve,yb.tabName);this.vm.YG.Tvb(this.$,wc,0,Ha);break;case 233:Ha=new J.a(-1677817820,yb.method,yb.mode,yb.Ve,yb.tabName);this.vm.YG.Tvb(this.$,wc,0,Ha);break;case 94:this.hSf(Ha,yb,wc,Xb,Vc,yd+1);break;case 93:this.vm.YG.mDi(this.$,
wc)}}hSf(Ha,yb,Xb,wc,Vc,yd){const Od=this.Ogd(Vc,yd);0>Od&&h.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!wc||Od>=wc.length)h.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(wc=wc[Od],wc.q7b){case 1:this.vm.YG.FDi(this.$,Xb);break;case 2:(Vc=Object(Ja.a)(Aa,wc))?(Ha=new J.a(-2058042992,yb.method,yb.mode,yb.Ve,yb.tabName),this.vm.YG.Tvb(this.$,Xb,Vc.pye,Ha)):this.vm.YG.Yrf(this.$,
Ha,Xb,wc.z8c);break;case 0:this.vm.YG.Yrf(this.$,Ha,Xb,wc.z8c);break;case 4:this.hSf(Ha,yb,Xb,wc.subMenu,Vc,yd+1)}}applyAutoFilterFieldList(Ha,yb){var Xb=yb[Nb.a.dG];if(Xb)if(Xb=Xb.split(wb.a.AU),3>Xb.length)h.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var wc=this.Ogd(Xb,1),Vc=this.jLa(wc),yd=this.Nxf(wc).returnValue;yd?this.IJd(yb,Ha,yd,Vc,Xb,2):h.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
wc.toString()+wb.a.AU)}else h.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}Ac(Ha,yb){if(Ha=this.$.isEditMode)switch(yb.command){case 216058793:break;case -699941697:break;case -1494291901:Ha=!0;break;default:Ha=!1}return Ha}J0(Ha,yb,Xb){this.$.isEditMode&&((this.vm=Object(Ja.a)(324,Xb))||h.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.TY(),super.J0(Ha,
yb,null,null,!0))}T6c(){if(!this.vm||!this.vm.Tk||1!==this.vm.Tk.length)return h.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const Ha=this.vm.Tk[0];let yb=new ab.a;yb.add(T.a.instance.ga(249));yb=Cb.OBc(Cb.concat(yb,Cb.select(Cb.asEnumerable(Ha.FieldInfoDataList),Xb=>Xb.Name)),Xb=>Xb,new kb.a);return Cb.toArray(yb)}fieldIndex(Ha){if(!this.vm||!this.vm.Tk||1!==this.vm.Tk.length||!this.vm.Tk[0].FieldInfoDataList)return-1;
for(let yb=0;yb<this.vm.Tk[0].FieldInfoDataList.length;++yb)if(this.vm.Tk[0].FieldInfoDataList[yb].Name===Ha)return yb;return-1}jLa(Ha){return 0>Ha||!this.vm||!this.vm.Tk||1!==this.vm.Tk.length||!this.vm.Tk[0].FieldInfoDataList||this.vm.Tk[0].FieldInfoDataList.length<Ha?null:this.vm.Tk[0].FieldInfoDataList[Ha].Name}TY(){var Ha=this.T6c();if(!Ha||!Ha.length)return null;const yb=this.Xa,Xb=yb.Jc();for(let Od=0;Od<Ha.length;++Od){const be=Ha[Od],Qb=0<Od?this.fieldIndex(be):-1,zc=ob.rdg+Qb.toString()+
wb.a.AU;let Yc=null;const zd=this.vm.YG.mfi(0<Od?be:null),ke=this.e7c(yb,zd,ob.rdg+Qb.toString(),be);for(let Td=0;Td<rb.Gdd.length;++Td){var wc=rb.Gdd[Td],Vc=zc+Td.toString();Yc||(Yc=yb.Jc());switch(wc){case 228:Yc.buttons.push(yb.Qc(223,Vc,-699941697,this.vm.YG.azi(0<Od?be:null)?xb.a.dac:xb.a.dKa,8,228,!1,null));break;case 229:Yc.buttons.push(yb.Qc(224,Vc,-699941697,this.vm.YG.bzi(0<Od?be:null)?xb.a.eac:xb.a.eKa,8,229,!1,null));break;case 233:Yc.buttons.push(yb.Qc(225,Vc,-699941697,xb.a.aac,1,233,
!1,null));break;case 98:wc=this.t1g(be);Vc=yb.QIa(Vc+(zd?".enabled":".disabled"),wc,-699941697,null,"None",null,!zd,void 0,!0);Vc.gS("Image16by16",8,xb.a.N3a);Yc.buttons.push(Vc);break;case 94:var yd=void 0;const Ge=({vZe:yd,isChecked:wc}=this.Nxf(Qb)).returnValue;if(!Ge)return null;yd=this.e7c(yb,wc&&zd,Vc,yd);Vc=this.K1e(yd.menu,yb,Vc+wb.a.AU,Ge,wc&&zd);yd.menu.uc.push(Vc);Yc.buttons.push(yd);break;case 0:Yc&&(ke.menu.uc.push(Yc),Yc=null);break;default:Vc=yb.QIa(Vc,T.a.instance.ga(wc),-699941697,
null,"None",null,!1,void 0,!0),this.I6f(Vc,zd&&93===wc&&this.vm.YG.filter(),T.a.instance.ga(wc)),Yc.buttons.push(Vc)}}ke.menu.uc.push(Yc);Xb.buttons.push(ke)}Ha=yb.Bq(this.menuId);Ha.uc.push(Xb);return Ha}K1e(Ha,yb,Xb,wc,Vc){let yd=null;for(let Yc=0;Yc<wc.length;++Yc){var Od=wc[Yc],be=Xb+Yc.toString(),Qb=!1;switch(Od.q7b){case 1:Qb=Vc&&this.vm.YG.Ag.IsTop10;break;case 2:Qb=Object(Ja.a)(Aa,Od);Qb=Vc&&this.vm.YG.Lri(Qb?Qb.pye:0,Od.z8c);break;case 0:Qb=Vc&&this.vm.YG.Ag.IsCustomSupportedAndNotPresent}yd||
(yd=yb.Jc());if(Od.ovi)yd&&(Ha.uc.push(yd),yd=null);else if(Od.qzi){var zc=T.a.instance.ga(Od.Sxf);zc=this.e7c(yb,Qb,be,zc);zc.menu.uc.push(this.K1e(zc.menu,yb,be+wb.a.AU,Od.subMenu,Qb));yd.buttons.push(zc)}else Od=T.a.instance.ga(Od.Sxf),be=yb.QIa(be,Od,-699941697,null,"None",null,!1,void 0,!0),this.I6f(be,Qb,Od),yd.buttons.push(be)}return yd}I6f(Ha,yb,Xb){yb?Ha.gS("Image16by16",8,xb.a.Zua):Ha.gS("None",0,null);Ha.eS(Xb);Ha.label=Xb}e7c(Ha,yb,Xb,wc){return yb?Ha.U6c(Xb,this.menuId,wc,798637440,8,
xb.a.Zua):Ha.mw(Xb,this.menuId,wc,798637440)}ah(Ha){return!Ha||!Ha.length}Nxf(Ha){var yb=0>Ha?0:this.vm.Tk[0].FieldInfoDataList[Ha].MajorityDataTypeForField;var Xb=null;Ha=this.vm.YG.lfi(yb);switch(yb){case 0:Xb=95;yb=pb.zWj;break;case 1:Xb=94;yb=pb.$Qi;break;case 2:Xb=96;yb=pb.Jmh;break;default:return h.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,vZe:Xb,isChecked:Ha}}Xb=T.a.instance.ga(Xb);return{returnValue:yb,vZe:Xb,
isChecked:Ha}}t1g(Ha){!Ha||this.ah(Ha.trim())?Ha=T.a.instance.ga(97):Ha.length>rb.lZe?(Ha=Ha.substring(0,rb.lZe),Ha=String.format(T.a.instance.nb(155),Ha)):Ha=String.format(T.a.instance.nb(156),Ha);return Ha}}ob.mJh=u.a.jch;ob.ZLb="AutoFilterFieldListContextMenuRoot";ob.rdg="ApplyAutoFilterFieldList.";Object(b.a)(ob,"AutoFilterFieldListContextMenu",m.a,[]);var qa=a(554),ma=a(860),Ga=a(11),vb=a(119),Ka=a(380),Pa=a(789);class fb extends m.a{constructor(Ha,yb,Xb,wc,Vc="PopulateFloatingObjectContextMenu",
yd=-2017893763,Od=1350204367,be=u.a.qch,Qb=!0,zc=!1){super(Ha,Vc,yd,Od,be,Qb,zc,be,yb,Xb,!0,wc);this.floatingObject=null;this.wb=0;this.doc=!0}get Sw(){return"PopulateFloatingObjectContextMenu"}get vB(){return u.a.rUf}executeCommand(Ha,yb,Xb){Ha=Object(Ja.a)(qa.a,Xb.eventArgs);switch(yb.command){case -1372040782:Xb=fa.h(this.$).ha.Sa.jc;h.ULS.shipAssertTag(537167048,0,!!Xb);Xb&&(this.floatingObject=Xb.floatingObject,this.wb=yb.method,yb=this.ddc(Ha),this.eo(yb,!0,Ha.wb));break;case 848910589:Ha&&
(yb=[ma.a.R9f],Ha=new Sys.UI.Point(Ha.Ea.clientX,Ha.Ea.clientY),this.showFloatie(yb,new Sys.UI.Bounds(Ha.x,Ha.y,0,0),2))}return V.Task.Ta(!0)}Ac(Ha,yb,Xb){switch(yb.command){case -1372040782:return!!Xb&&this.Vof(Ha);case 848910589:return Ha=fa.h(this.$).ha.Sa.jc,!!Xb&&!!Ha&&Ha.eb;default:return!1}}Vof(Ha){switch(Ha){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}KXc(Ha,yb,Xb){Ka.a(this.$)?fa.h(this.$).jb.oj||(La.a(this.$).HVd()?Xb.buttons.push(Ha.ob(265)):Xb.buttons.push(Ha.ob(264))):
(this.$.isEditMode&&3===this.wb&&!this.Gbc()&&Xb.buttons.push(Ha.ob(101)),5!==this.floatingObject.type||vb.a.IH(this.floatingObject.Ab)||this.floatingObject.Ab.IsGroup||(this.iud()?Xb.buttons.push(Ha.ob(186)):Xb.buttons.push(Ha.ob(147))),this.Gbc()||this.iud()||Xb.buttons.push(Ha.ob(146)),this.mPh(Xb),this.QQh(Xb),U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&Xb.buttons.push(Ha.ob(287)),U.EwaSettings.xa(155)&&0===this.floatingObject.type&&
Xb.buttons.push(Ha.ob(249)),5===this.floatingObject.type&&fa.h(this.$).ha.Sa.jc.q5()&&this.$.Bla&&this.$.AP&&Xb.buttons.push(Ha.ob(273)))}mLa(Ha){const yb=[];if(Ka.a(this.$))return yb;3===Ha?(Ha=!!this.$.ke.get(5)&&this.floatingObject.QYd(),this.Gbc()||(this.$.isEditMode?(Ha&&yb.push(ma.a.pMh),5===fa.h(this.$).ha.Sa.IA.floatingObject.type&&yb.push(ma.a.vIj)):Ha&&yb.push(ma.a.copy)),yb.push(ma.a.qMh)):2===Ha&&(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?
fa.h(this.$).ha.Sa.jc&&this.O6e(fa.h(this.$).ha.Sa.jc,yb):this.O6e(fa.h(this.$).ha.Sa.IA,yb));return yb}TY(){const Ha=this.Xa,yb=Ha.Bq(this.menuId);var Xb=Ka.a(this.$);if(this.$.isEditMode){var wc=Ha.Jc();this.KXc(Ha,yb,wc);yb.uc.push(wc)}this.$.ke.get(5)&&this.floatingObject.QYd()&&!this.Gbc()&&!Xb&&(wc=Ha.Jc(),this.OLg(Ha,wc),yb.uc.push(wc));U.EwaSettings.isChangeGateEnabled("OfficeVSO:7636499_AsyncCollab_Remove_ChartShare")||(wc=this.$.ua.na)&&wc.ie&&(wc=wc.ie.uz||wc.ie.tK,!U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||0!==this.floatingObject.type||!Pa.g(this.$)||this.$.ea.isNamedObjectViewMode||Xb||this.$.isMobileMode||wc||(Xb=Ha.Jc(),this.INg(Ha,Xb),yb.uc.push(Xb)));return yb}ddc(Ha){var yb=fa.h(this.$).ha.Sa.jc;Ha=Ha&&1!==Ha.wb&&Ha.clientPoint?Ha.clientPoint:Sys.UI.DomElement.getLocation(yb.domElement);const Xb=this.$.domElement,wc=fa.h(this.$).rtl;(yb=Ga.HelperMethods.XC(yb.Bg.domElement,Xb,wc))?(Ha.y=Math.max(Ha.y,yb.y),Ha.x=Math.max(Ha.x,yb.x)):h.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${k.AFrameworkApplication.ug}`);
return Ha}iud(){const Ha=fa.h(this.$).ha.Sa.jc;return!!Ha&&Ha.eb}OLg(Ha,yb){if(this.$.isEditMode){yb.buttons.push(Ha.ob(42));yb.buttons.push(Ha.ob(43));const Xb=this.$.da.Ba(254,!0);(Xb&&2===Xb.TDb()||this.iud())&&yb.buttons.push(Ha.ob(44))}else yb.buttons.push(Ha.ob(43))}INg(Ha,yb){yb.buttons.push(Ha.ob(274))}Gbc(){return U.EwaSettings.xa(407)&&!!fa.h(this.$).ha.Sa.fo}O6e(Ha,yb){5===Ha.floatingObject.type?Ha.eb?yb.push(ma.a.R9f):yb.push(ma.a.rIj):yb.push(m.a.B_e)}mPh(Ha){const yb=this.Xa.Jc();yb.buttons.push(this.Xa.ob(282));
yb.buttons.push(this.Xa.ob(281));const Xb=this.Xa.mw("BringToFront","BringToFrontMenuId",T.a.instance.ga(822),-1777747317);Xb.menu.uc.push(yb);Ha.buttons.push(Xb)}QQh(Ha){const yb=this.Xa.Jc();yb.buttons.push(this.Xa.ob(284));yb.buttons.push(this.Xa.ob(283));const Xb=this.Xa.mw("SendToBack","SendToBackMenuId",T.a.instance.ga(823),-1777747317);Xb.menu.uc.push(yb);Ha.buttons.push(Xb)}}Object(b.a)(fb,"FloatingObjectContextMenu",m.a,[]);var Wa=a(806),Ma=a(106),lb=a(564),Na=a(522);const X=u.a.mch;class F extends fb{constructor(Ha,
yb,Xb,wc){super(Ha,yb,Xb,wc,"PopulateChartContextMenu",-498523270,1640762262,X);this.isPivotChart=this.refresh=this.pZ=this.Nwa=this.NBa=!1}get Sw(){return"PopulateChartContextMenu"}get vB(){return u.a.lUf}executeCommand(Ha,yb,Xb){const wc=this.$;this.wb=yb.method;yb=Xb[F.m3c];if(!(Ha&68)){if(!yb){if(8===Ha)yb=Na.a(wc).ed;else{var Vc=fa.h(wc).ha.Sa.jc;if(null===Vc||void 0===Vc?0:Vc.floatingObject)yb=Vc.floatingObject.ed}if(!yb)return V.Task.Ta(!0)}this.isPivotChart=!!(yb.Attributes&4)}if(this.isPivotChart||
wc.isEditMode)if(this.refresh=this.pZ=this.Nwa=this.NBa=!1,Vc=fa.h(this.$).ha.Sa.jc,h.ULS.shipAssertTag(537167107,0,!!Vc),Vc){this.floatingObject=Vc.floatingObject;Vc=lb.a(wc);if(null===Vc||void 0===Vc?0:Vc.gVd)this.NBa=Vc=Ma.f(wc.gg),this.Nwa=!Vc;Vc=wc.ic;this.pZ=!!Wa.a(wc)&&!!yb&&!!(yb.Attributes&512)&&!(Ha&8)&&Vc.G2(32768);Vc.allowManualDataRefresh&&Vc.allowInteractivity&&(this.refresh=!0);Ha=this.ddc(Object(Ja.a)(qa.a,Xb.eventArgs));this.eo(Ha,!0)}return V.Task.Ta(!0)}Ac(Ha,yb,Xb){return-149612405===
yb.command&&!!Xb&&this.Vof(Ha)}KXc(Ha,yb,Xb){this.isPivotChart&&(this.refresh&&Xb.buttons.push(Ha.ob(100)),this.pZ&&Xb.buttons.push(Ha.ob(99)),this.NBa?Xb.buttons.push(Ha.ob(59)):this.Nwa&&Xb.buttons.push(Ha.ob(58)));super.KXc(Ha,yb,Xb)}static get m3c(){return"chartMetaData"}}Object(b.a)(F,"ChartContextMenu",fb,[]);var na=a(12);const hb=u.a.och;class Ib extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateFieldListContextMenu",-1045020714,-170383950,hb,!0,!1,hb,yb,Xb,!1,wc);this.wL=this.xo=null;
this.SYd=this.isOlap=this.zV=this.XZ=!1}get Sw(){return"PopulateFieldListContextMenu"}get vB(){return u.a.UKd}executeCommand(Ha,yb,Xb){Ha=yb.command;switch(Ha){case 330754562:yb=Xb.domElement;this.isOlap=Xb.isOlap;this.wL=Xb.versionkey;this.xo=Xb.fieldItem;this.XZ=Xb.isChart;this.zV=Xb.isPpm;this.SYd="supportsImplicitMeasures"in Xb?Xb.supportsImplicitMeasures:!1;fa.h(this.$).No(!0);yb=na.DOMElementExtensions.getBounds(yb);yb=new Sys.UI.Point(yb.x+yb.width,yb.y+yb.height/2);"isKeyboardInput"in Xb&&
Xb.isKeyboardInput?this.eo(yb,!1,1):this.eo(yb,!1);break;case 926905850:this.SYd&&this.xo&&5===this.xo.TypeTag&&!this.xo.IsCollapsible&&h.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");lb.a(this.$).QJ(this.xo,8,-1,this.wL,yb);break;case -67292059:lb.a(this.$).QJ(this.xo,1,-1,this.wL,yb);break;case 745182485:lb.a(this.$).QJ(this.xo,2,-1,this.wL,yb);break;case 359279088:lb.a(this.$).QJ(this.xo,4,-1,this.wL,yb);break;case 547535945:lb.a(this.$).bhj(this.xo);break;default:return da.a(Ha)}return V.Task.Ta(!0)}Ac(Ha,
yb,Xb){Ha=!1;switch(yb.command){case 330754562:Ha=!!Xb;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:Ha=!0}return Ha}TY(){const Ha=this.Xa.Bq(this.menuId);this.paj(Ha);this.XZ||this.isOlap||this.oaj(Ha);return Ha}paj(Ha){const yb=this.Xa,Xb=yb.Jc();let wc=!1;U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(wc=this.isOlap&&!this.zV&&this.SYd&&5===this.xo.TypeTag&&!this.xo.IsCollapsible);3!==this.xo.TypeTag&&37!==this.xo.TypeTag||
this.xo.IsSet?17===this.xo.TypeTag||this.zV?(Xb.buttons.push(yb.ob(79)),Xb.buttons.push(yb.ob(this.XZ?91:80)),Xb.buttons.push(yb.ob(this.XZ?92:81)),Xb.buttons.push(yb.ob(82))):13===this.xo.TypeTag||this.xo.IsSet?(Xb.buttons.push(yb.ob(83)),Xb.buttons.push(yb.ob(this.XZ?91:80)),Xb.buttons.push(yb.ob(this.XZ?92:81)),Xb.buttons.push(yb.ob(86))):(Xb.buttons.push(yb.ob(79)),Xb.buttons.push(yb.ob(this.XZ?91:80)),Xb.buttons.push(yb.ob(this.XZ?92:81)),Xb.buttons.push(yb.ob(wc?82:86))):(Xb.buttons.push(yb.ob(83)),
Xb.buttons.push(yb.ob(this.XZ?93:84)),Xb.buttons.push(yb.ob(this.XZ?94:85)),Xb.buttons.push(yb.ob(82)));Ha.uc.push(Xb)}oaj(Ha){const yb=this.Xa.Jc();yb.buttons.push(this.Xa.ob(78));Ha.uc.push(yb)}}Object(b.a)(Ib,"FieldListContextMenu",m.a,[]);var vc=a(424),nc=a(71);class Pb{constructor(Ha){this.$=Ha;this.sN={}}get(Ha,yb,Xb){const wc=this.Bjg(Ha,"PivotFilterContextMenuCache.Get");return wc&&this.sN[wc]?this.sN[wc][Pb.bjd(yb,this.$,Ha,Xb)]:null}set(Ha,yb,Xb,wc){const Vc=this.Bjg(Ha,"PivotFilterContextMenuCache.Set");
Vc&&(this.sN[Vc]||(this.sN[Vc]={}),this.sN[Vc][Pb.bjd(yb,this.$,Ha,wc)]=Xb)}P9b(Ha){Ha in this.sN&&this.sN[Ha]&&(this.sN[Ha]=null)}Bjg(Ha,yb){return nc.f(this.$.na)?this.$.activeItemName:(Ha=this.y0j(Ha,yb))?Ha.gd:null}y0j(Ha,yb){Ha=H.D(Ha);Ha=fa.h(this.$).Ca.Wva(Ha,this.$.activeItemName);h.ULS.shipAssertTag(537167008,0,!!Ha,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${yb}`);return Ha}static bjd(Ha,
yb,Xb,wc){return U.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===wc?yb.na.index+"_"+Ha.id+"_"+Xb.FirstRow.toString()+"_"+Xb.FirstColumn.toString():yb.na.index+"_"+Ha.id}}Object(b.a)(Pb,"PivotFilterContextMenuCache",null,[]);class oc{constructor(){this.cell=null;this.dataSourceIndex=0;this.Jo=this.pivotName=null}}Object(b.a)(oc,"ShowPivotFilterData",null,[]);var Ic=a(462),ec=a(1326),mb=a(52);const Ob=u.a.PHe;class Ta extends m.a{constructor(Ha,yb,Xb,wc,Vc,yd,Od,be=Ob){super(Ha,
yb,Xb,wc,be,!0,!1,"PivotFilterMenuRootName",Vc,yd,!1,Od);this.upc=this.fDd=this.pivotData=this.oob=this.crf=this.A7b=null;this.uY=this.A4b=this.xGb=0;this.Ttb=null;this.qYi=(Qb,zc)=>{if(zc)if(Y.a(Qb))this.cAd(zc,!1);else if(Qb=Qb.Result){this.Lub=Pb.bjd(zc,this.$,this.pivotData.cell,this.uY);var Yc=this.Oxf(Qb.MenuModel.Sections);this.Ttb=Yc;Ta.sN.set(this.pivotData.cell,zc,Yc,this.uY);ec.a(this.$).QTj(Qb);this.cAd(zc,!0)}};this.pYi=(Qb,zc)=>{this.cAd(zc,!1)};this.rf=(Qb,zc)=>{Ta.sN.P9b(zc.dd.hash)};
this.Ym=(Qb,zc)=>{Ta.sN.P9b(zc.dd.hash)};this.xAa=null;this.rDe=this.A4b=this.gDd=this.xGb=-1;this.Wue=this.uY=0;this.aB=U.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Ta.sN||(Ta.sN=new Pb(this.$),fa.h(this.$).Ca.Us(this.rf),fa.h(this.$).Ca.TG(this.Ym),fa.h(this.$).Ca.N9(this.rf))}Lcd(Ha,yb){const Xb=Ha.rawEvent,wc=Ha.cell,Vc=Ha.requiresConfirmation;Ic.a(this.$).Lx(Vc,yd=>{if(yd){yd=Xb?new Sys.UI.DomEvent(Xb):null;this.pivotData=new oc;this.pivotData.pivotName=Ha.pivotName;this.pivotData.dataSourceIndex=
Ha.dataSourceIndex;this.pivotData.cell=wc;this.pivotData.Jo=Ha.optionalPivotMenuAnchorParameter;if(this.pivotData.Jo&&0<this.pivotData.Jo.AnchorType){this.upc=Ha.objectId;this.xGb=Ha.objectVersion;const Od=this.pivotData.Jo.AnchorType;if(4===Od||5===Od||6===Od||11===Od||9===Od||10===Od||8===Od)this.oob=Ha.location}else this.fDd=this.upc=null,this.gDd=this.xGb=-1;fa.h(this.$).No(!0);this.$.Sj(wc);this.J0(yd,yd?yd.target:Ha.domElement,this.pivotData,yb,this.lla())}});return!0}J0(Ha,yb,Xb,wc){if(Object(vc.a)(oc,
Xb)){this.pivotData=Xb;this.A7b=yb;this.crf=Ha;this.A4b=this.pivotData.Jo?this.pivotData.Jo.AnchorValue1:-1;this.uY=this.pivotData.Jo?this.pivotData.Jo.AnchorType:0;var Vc=!1,yd=null;yd=Ta.sN.get(this.pivotData.cell,yb,this.uY);Vc=!!yd;var Od=!0;switch(this.uY){case 4:case 5:case 6:this.xAa=new Sys.UI.Point(this.oob.x,this.oob.y);Od=!1;break;case 7:var be=Sys.UI.DomElement.getBounds(yb);Od=be.x+(0<=be.x?0:be.width);be=be.y+(0<=be.y?0:be.height);this.xAa=new Sys.UI.Point(0<=Od?Od:0,0<=be?be:0);Od=
!1;break;case 8:case 10:case 9:case 11:this.xAa=new Sys.UI.Point(this.oob.x,this.oob.y);break;default:this.xAa=null}Vc&&this.upc===this.fDd&&this.xGb===this.gDd&&this.A4b===this.rDe&&this.uY===this.Wue?(h.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Ttb=yd,this.xAa?this.eo(this.xAa,this.lla()):this.aB?U.EwaSettings.ENa()?(Ha=m.a.Igd(this.$,this.pivotData.cell),m.a.erd(Ha)&&this.eo(m.a.Xgd(this.$,Ha,!1),this.lla())):
m.a.frd(this.$,this.pivotData.cell)&&this.eo(m.a.Ygd(this.$,this.pivotData.cell,!1),this.lla()):super.J0(Ha,yb,Xb,wc,this.lla())):1!==Ta.DYh(yb)&&(Od&&(yb.parentNode.menuFetchStates=1,this.JCj(yb),this.q6f(!0)),this.$.userOperationManager.Oc(new I.a(126,0,(Qb,zc,Yc)=>{const zd=this.$;return S.p(zd.pa.va,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,zd.domElement.id,zd.isChromeRtl,zd.workbookContext.NovMode,L.b(Qb,this.qYi),L.a(zc,this.pYi),Yc,yb,this.pivotData.Jo)},16),
wc))}}fId(Ha){Ha.MenuSectionList.push(...this.Ttb)}cAd(Ha,yb){Ha.parentNode.menuFetchStates=2;this.q6f(!1);if(yb){if(this.A7b!==Ha||this.AMi())this.eo(this.xAa,this.lla());else if(this.aB&&!this.xAa)if(U.EwaSettings.ENa()){Ha=m.a.Igd(this.$,this.pivotData.cell);if(!m.a.erd(Ha))return;this.eo(m.a.Xgd(this.$,Ha,!1),this.lla())}else{if(!m.a.frd(this.$,this.pivotData.cell))return;this.eo(m.a.Ygd(this.$,this.pivotData.cell,!1),this.lla())}else super.J0(this.crf,Ha,null,null,this.lla());this.fDd=this.upc;
this.gDd=this.xGb;this.Wue=this.uY;this.rDe=this.A4b}}lla(){return 8!==this.uY&&9!==this.uY&&10!==this.uY&&11!==this.uY}AMi(){switch(this.pivotData.Jo?this.pivotData.Jo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}q6f(Ha){const yb=this.A7b;if(yb){if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var Xb=na.DOMElementExtensions.xZ(yb,"ewaprevsrc","");Xb=!!Xb&&"null"!==Xb}else Xb=!!na.DOMElementExtensions.xZ(yb,"ewaprevsrc",
"");Ha&&Xb||!Ha&&!Xb||(Ha?(yb.setAttribute("ewaprevsrc",yb.src),yb.src=mb.a.current.Un(99)):(Ha=na.DOMElementExtensions.xZ(yb,"ewaprevsrc",""),yb.src=Ha,yb.setAttribute("ewaprevsrc",null)))}}JCj(Ha){this.A7b=Ha}static DYh(Ha){const yb=Ha.parentNode.menuFetchStates;void 0===yb&&(Ha.parentNode.menuFetchStates=0);return yb}}Ta.sN=null;Object(b.a)(Ta,"PivotFilterContextMenuBase",m.a,[]);const sb="FieldList"+u.a.PHe;class zb extends Ta{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateFieldListPivotMenu",-1793121409,
1378457149,yb,Xb,wc,sb)}get Sw(){return"PopulateFieldListPivotMenu"}get vB(){return u.a.pUf}executeCommand(Ha,yb,Xb){return this.Lcd(Xb,yb)?V.Task.Ta(!0):da.a(yb.command)}Ac(Ha,yb,Xb){return-1065117584===yb.command&&!!Xb}}Object(b.a)(zb,"FieldListPivotContextMenu",Ta,[]);var db=a(274),jb=a(31),Ub=a(91),xd=a(769);class ne{}Object(b.a)(ne,"PivotValueFieldSettingsApplyData",null,[]);class fe{}fe.dpg="valueFieldSettingTabs";fe.omh="dataFieldCustomLabel";fe.XLe="dataFieldSourceLabel";fe.OWd="showValueAsSelect";
fe.MWd="showValueAsBaseFieldSelect";fe.NWd="showValueAsBaseItemSelect";fe.f3d="valueFieldsSettingsFieldName";Object(b.a)(fe,"CssElementIds",null,[]);var Bd=a(114);class Ue{constructor(Ha,yb,Xb){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=Ha;this.baseFieldIndex=yb;this.baseItemIndex=Xb}}Object(b.a)(Ue,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class mc{constructor(Ha,yb,Xb,wc,Vc){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=
0;this.showAsValueParameters=null;this.externalSourceIndex=Ha;this.activeCell=yb;this.pivotFieldTitle=Xb;this.summarizeBy=wc;this.showAsValueParameters=Vc}getActiveCell(){return this.activeCell}}Object(b.a)(mc,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[123]);var Fc=a(242);class bd{}Object(b.a)(bd,"PivotValueFieldShowValueAsApplyData",null,[]);var de=a(754),Md=a(46);const se=`<div id='showValueAsControlBody'><label for='${fe.OWd}' class='${Bd.a.Sn} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${fe.OWd}' class='${Bd.a.RC}'></select></div><div class='showValueAsControlSelectRegion'><label for='${fe.MWd}'>{1}</label><div><select size=6 id='${fe.MWd}' class='${Bd.a.RC}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${fe.NWd}'>{2}</label><div><select size=6 id='${fe.NWd}' class='${Bd.a.RC}'></select></div></div></div>`;
class tc extends Fc.a{constructor(Ha,yb,Xb,wc,Vc,yd,Od,be,Qb){super(Ha);this.htmlSanitizationHelper=this.b9d=this.L6d=this.K6d=this.M2b=this.c8b=this.iD=null;this.ZDf=()=>{var zc=parseInt(this.raa.oe.value,10);this.O4g(zc)?(this.GP.Yq.disabled=!0,this.HP.Yq.disabled=!0,this.HP.clear(),tc.Uif(zc)?(this.GP.Yq.disabled=!1,this.QQb(!1)):tc.Vif(zc)?(this.GP.Yq.disabled=!1,this.HP.Yq.disabled=!1,this.QQb(!0),this.Psf()):this.QQb(!1)):(zc=R.a.hd(1,0,0,1131,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),
Md.a(this.$).St([zc]),this.raa.Fuj())};this.USi=()=>{0>this.GP.selectedIndex||this.HP.Yq.disabled||(this.QQb(!0),this.Psf())};this.fZi=zc=>{this.iD.PTa();this.HP.Yq.style.overflowY="scroll";if(zc&&!Y.a(zc)){zc=zc.Result;this.HP.clear();for(const Yc of zc.BaseItems)this.HP.qY(Yc.DisplayString,Yc.Id.toString(),Yc.Id===zc.SelectedBaseItem);this.QQb(!1)}};this.get_visible=this.Aka;this.set_visible=this.poa;this.$=yb;this.cell=Xb;this.Jo=wc;this.externalSourceIndex=Vc;this.Ud=yd;this.Pta=Od;this.Lvi=be;
this.htmlSanitizationHelper=Qb;this.h6j=U.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.Vka()}Aka(){return this.isVisible}poa(Ha){return this.isVisible=Ha}get title(){return T.a.instance.ga(1119)}get wyb(){const Ha=this.raa.oe?parseInt(this.raa.oe.value,10):-1,yb=this.GP.oe?parseInt(this.GP.oe.value,10):-1,Xb=this.HP.oe?parseInt(this.HP.oe.value,10):-1;return Object(d.a)(new bd,{SelectedDataFormat:0<=Ha?Ha:-1,SelectedBaseField:yb,SelectedBaseItem:Xb})}get GP(){return this.K6d}get HP(){return this.L6d}get raa(){return this.b9d}setFocus(){na.DOMElementExtensions.setFocus(this.raa.Yq)}render(Ha){Ha.appendChild(this.domElement)}dispose(){Ub.a.sc([this.raa,
this.GP,this.HP,this.c8b,this.M2b]);super.dispose()}AFj(Ha){Ub.a.sc([this.c8b,this.M2b]);this.raa.clear();for(const yb of Ha.DataFormatTypes)this.raa.qY(tc.NWh(yb),yb.toString(),yb===Ha.SelectedDataFormat);this.c8b=this.Fe.qe(this.raa.domElement);this.c8b.la("change",this.ZDf);this.GP.clear();for(const yb of Ha.BaseFieldList)this.GP.qY(yb.DisplayString,yb.Id.toString(),yb.Id===Ha.SelectedBaseField);this.M2b=this.Fe.qe(this.GP.domElement);this.M2b.la("change",this.USi);this.iD=this.Pta.Mtb(this.HP.Yq.parentNode,
1E3,null,"",736);this.iD.PTa();this.ZDf(null)}TQ(Ha){this.raa.TQ(Ha);this.GP.TQ(Ha);this.HP.TQ(Ha)}Vka(){this.htmlSanitizationHelper.jh(this.domElement,String.format(se,T.a.instance.ga(1120),T.a.instance.ga(1121),T.a.instance.ga(1122)));this.b9d=new de.a(na.DOMElementExtensions.getElementById(this.domElement,fe.OWd),!1);this.K6d=new de.a(na.DOMElementExtensions.getElementById(this.domElement,fe.MWd),!1);this.L6d=new de.a(na.DOMElementExtensions.getElementById(this.domElement,fe.NWd),!1)}O4g(Ha){return this.Lvi||
!tc.Uif(Ha)&&!tc.Vif(Ha)?!0:!!this.GP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Oc(new I.a(108,0,(Ha,yb,Xb)=>{var wc=this.$.pa.va,Vc=parseInt(this.GP.oe.value,10);Ha=L.b.call(null,Ha,this.fZi);const yd=S.L(wc,this.cell,this.externalSourceIndex,this.Jo);yd.selectedBaseField=Vc;return S.g(wc,"GetPivotValueFieldSettingsShowValueAsBaseItems",yd,Ha,yb,Xb,null,4)},16),this.Ud)}Psf(){this.HP.clear();this.GP.oe&&(this.iD.JTa(),this.HP.Yq.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}QQb(Ha){const yb=
document.getElementById("WACDialogActionButton");this.h6j&&yb&&(yb.disabled=Ha)}static NWh(Ha){switch(Ha){case 0:return T.a.instance.ga(1123);case 1:return T.a.instance.ga(1124);case 2:return T.a.instance.ga(1125);case 3:return T.a.instance.ga(1126);case 4:return T.a.instance.ga(1127);case 5:return T.a.instance.ga(1128);case 6:return T.a.instance.ga(1129);case 7:return T.a.instance.ga(1130);case 8:return T.a.instance.ga(1132);case 9:return T.a.instance.ga(1133);case 10:return T.a.instance.ga(1134);
case 11:return T.a.instance.ga(1135);case 12:return T.a.instance.ga(1136);case 13:return T.a.instance.ga(1137);case 14:return T.a.instance.ga(1138);default:return""}}static Uif(Ha){return 11===Ha||12===Ha||14===Ha||13===Ha||4===Ha}static Vif(Ha){return 1===Ha||3===Ha||2===Ha}}Object(b.a)(tc,"ShowValueAsControl",Fc.a,[296,3]);class dd{}Object(b.a)(dd,"PivotValueFieldSummarizeValueByApplyData",null,[]);const Hd="<div id='summarizeValuesByControlBody'>"+`<label class='${Bd.a.Sn} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+
`<div id='${"pivotDataFieldSelectDescription"}' class='${Bd.a.Sn} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${Bd.a.RC}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${u.a.WG}='${"pivotDataFieldSelectDescription"}'></select></div>`+"</div>";class Xc extends Fc.a{constructor(Ha,yb){super(Ha);this.htmlSanitizationHelper=this.xie=null;this.get_visible=this.Aka;this.set_visible=this.poa;this.htmlSanitizationHelper=yb;this.Vka()}get wyb(){const Ha=this.ul.oe?parseInt(this.ul.oe.value,
10):-1;return Object(d.a)(new dd,{Aggregation:0<=Ha?Ha:-1})}Aka(){return this.isVisible}poa(Ha){return this.isVisible=Ha}get title(){return T.a.instance.ga(1118)}get enabled(){return!this.ul.Yq.disabled}set enabled(Ha){this.ul.Yq.disabled=!Ha}get ul(){return this.xie}setFocus(){na.DOMElementExtensions.setFocus(this.ul.Yq)}render(Ha){Ha.appendChild(this.domElement)}dispose(){Ub.a.Ja(this.ul);super.dispose()}focus(){na.DOMElementExtensions.setFocus(this.ul.Yq)}zFj(Ha){this.ul.MXd();for(const yb of Ha.AggregationTypes){const Xb=
yb===Ha.SelectedAggregation;this.ul.IXc(Xc.jSh(yb),yb.toString(),Xb,"")}this.ul.xad();this.ul.Yq.disabled=Ha.AggregationsDisabled}Auj(){this.ul.Buj()}Vka(){this.htmlSanitizationHelper.jh(this.domElement,String.format(Hd,T.a.instance.ga(1103),T.a.instance.ga(1104)));this.xie=new de.a(na.DOMElementExtensions.getElementById(this.domElement,Xc.jPf),!1)}static jSh(Ha){switch(Ha){case 0:return T.a.instance.ga(1106);case 1:return T.a.instance.ga(1107);case 2:return T.a.instance.ga(1108);case 3:return T.a.instance.ga(1109);
case 4:return T.a.instance.ga(1110);case 5:return T.a.instance.ga(1111);case 6:return T.a.instance.ga(1112);case 7:return T.a.instance.ga(1113);case 8:return T.a.instance.ga(1114);case 9:return T.a.instance.ga(1115);case 10:return T.a.instance.ga(1116);case 11:return T.a.instance.ga(1117);default:return""}}}Xc.jPf="pivotDataFieldSelect";Object(b.a)(Xc,"SummarizeValuesByControl",Fc.a,[296,3]);var gd=a(218),je=a(470),Ee=a(1272);class ae extends xd.a{constructor(Ha,yb,Xb,wc,Vc,yd,Od,be,Qb,zc){super(Vc,
T.a.instance.nb(61),!0,2,!0);this.Sag=!0;this.htmlSanitizationHelper=this.kVc=this.O8c=this.gub=this.ega=this.sTa=this.eoe=null;this.ISi=Yc=>{db.a.any(Yc.Errors,zd=>-103190598===zd.MessageId)&&this.XTa.Auj()};this.eZi=Yc=>{Yc&&!Y.a(Yc)&&(Yc=Yc.Result,this.htmlSanitizationHelper.l7f(this.O8c,T.a.instance.ga(1101)+jb.a.Og(Yc.ValueFieldSourceName)),this.isOlap&&!this.zV?(this.XTa.enabled=!1,this.ega.activeTab=this.ega.LCc-1):(this.XTa.enabled=!0,this.ega.activeTab=0),this.XTa.zFj(Yc.PivotValueFieldSettingsSummarizeValueByInfo),
this.sTa.AFj(Yc.PivotValueFieldShowValueAsInitialInfo),this.fg())};this.cell=Ha;this.Jo=yb;this.externalSourceIndex=Xb;this.cpg=wc;this.Ud=yd;this.Pta=Od;this.isOlap=be;this.zV=Qb;this.htmlSanitizationHelper=zc}get pc(){return"ValueFieldSettingsDialog"}get ZCa(){return this.eoe}get UFb(){return this.ega}get XTa(){return this.kVc}get MB(){return 560}dispose(){this.O8c=this.gub=this.sTa=this.kVc=null;Ub.a.Ja(this.ega);this.ega=null;super.dispose()}initialize(){let Ha="<div id='"+fe.XLe+"' class='"+
Bd.a.Sn+"'></div><div id='"+fe.omh+"' class='"+Bd.a.Sn+"'><label for='"+fe.f3d+"'>{0}</label><input type='text' id='"+fe.f3d+"' value='{1}' class='"+Bd.a.RC+" UIFont' /></div><div id='"+fe.dpg+"'></div>";Ha=String.format(Ha,T.a.instance.ga(1102),jb.a.Og(this.cpg));this.htmlSanitizationHelper.jh(this.Pb,Ha);this.Mf||(this.Csa(),this.Bt());this.eoe=[-103190598];this.z$h();super.initialize()}close(Ha){1===Ha&&(this.Sag=!1);super.close(Ha)}hOe(Ha){this.isDisabled=Ha;this.domElement.disabled=Ha;const yb=
["input","option","select"];for(let Xb=0,wc=yb.length;Xb<wc;++Xb){const Vc=this.domElement.getElementsByTagName(yb[Xb]);for(let yd=0;yd<Vc.length;++yd)Vc[yd].disabled=Ha}}Bt(){this.gub=document.getElementById(fe.f3d);this.O8c=na.DOMElementExtensions.getElementById(this.Pb,fe.XLe);const Ha=na.DOMElementExtensions.getElementById(this.Pb,fe.dpg);this.kVc=new Xc(document.createElement("div"),this.htmlSanitizationHelper);this.sTa=new tc(document.createElement("div"),this.$,this.cell,this.Jo,this.externalSourceIndex,
this.Ud,this.Pta,!this.isOlap,this.htmlSanitizationHelper);let yb;this.ega=new Ee.a(Ha,(yb=new ab.a,yb.add(this.XTa),yb.add(this.sTa),yb));this.ega.PZf()}qId(){const Ha=new ae(this.cell,this.Jo,this.externalSourceIndex,this.cpg,this.$,this.Ud,this.Pta,this.isOlap,this.zV,this.htmlSanitizationHelper);Ha.initialize();Ha.fg()}ERb(){const Ha=new je.a;if(!this.Sag)return Ha.isValid=!0,Ha;this.gub.value.length?Ha.isValid=!0:(this.hOe(!0),Ha.error=R.a.hd(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),
this.isDisabled=!0,this.Mf||(this.Yy.disabled=!0),Ha.isValid=!1);return Ha}wbf(){this.isDisabled=!1;this.Mf||(this.Yy.disabled=!1);this.hOe(!1)}rza(Ha){const yb=new J.a(2105621672,0,this.$.xc,30,null);this.$.Ia.Hb(yb);this.Qz(5,Ha.wb,"Number Format");return!0}fq(){this.fpa=String.format(T.a.instance.nb(61),null);super.fq()}setFocus(){if(this.Mf){const Ha=na.DOMElementExtensions.getElementById(this.Pb,Xc.jPf);gd.a.K0d(Ha)}else this.ega.setFocus()}ak(){const Ha=this.sTa.wyb,yb=new Ue(Ha.SelectedDataFormat,
Ha.SelectedBaseField,Ha.SelectedBaseItem);return()=>new mc(this.externalSourceIndex,this.cell,this.gub.value,this.XTa.wyb.Aggregation,yb)}ZG(){const Ha=Object(d.a)(new ne,{PivotValueFieldSummarizeValueByApplyData:this.XTa.wyb,PivotValueFieldShowValueAsApplyData:this.sTa.wyb,PivotValueFieldTitle:this.gub.value});return(yb,Xb,wc)=>{var Vc=this.$.pa.va;yb=L.b(yb,this.ISi);const yd=S.L(Vc,this.cell,this.externalSourceIndex,this.Jo);yd.pivotValueFieldSettingsApplyData=Ha;return S.g(Vc,"ApplyPivotValueFieldSettings",
yd,yb,Xb,wc,null,0)}}TQ(Ha){this.$.da.hb(40,()=>{this.sTa.TQ(Ha)})}z$h(){this.$.userOperationManager.Oc(new I.a(123,0,(Ha,yb,Xb)=>{var wc=this.$.pa.va;Ha=L.b.call(null,Ha,this.eZi);const Vc=S.L(wc,this.cell,this.externalSourceIndex,this.Jo);return S.g(wc,"GetPivotValueFieldSettingsInitial",Vc,Ha,yb,Xb,null,4)},16),this.Ud)}}Object(b.a)(ae,"ValueFieldSettingsDialog",xd.a,[]);const Yb=u.a.pch;class Sc extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateFieldWellContextMenu",1374696078,495005930,
Yb,!0,!1,Yb,yb,Xb,!1,wc);this.Jo=this.xo=this.cell=null;this.q4d=this.externalSourceIndex=-1;this.FTa=0;this.DBc=-1;this.wL=null;this.$3a=this.zV=this.isOlap=!1}get Sw(){return"PopulateFieldWellContextMenu"}get vB(){return u.a.VKd}executeCommand(Ha,yb,Xb,wc){Ha=yb.command;switch(Ha){case -1453503574:wc=Xb.domElement;this.xo=Xb.fieldItem;this.q4d=Xb.zoneCount;this.FTa=Xb.sourceAxis;this.DBc=Xb.sourceAxisPos;this.Jo=Xb.optionalPivotMenuAnchorParameter;this.wL=Xb.versionkey;this.isOlap=Xb.isOlap;this.zV=
Xb.isPpm;this.$3a="fieldItemsupportsImplicitMeasures"in Xb?Xb.fieldItemsupportsImplicitMeasures:!1;this.cell=Xb.cell;this.externalSourceIndex=Xb.externalSourceIndex;fa.h(this.$).No(!0);wc=na.DOMElementExtensions.getBounds(wc);Ha=new Sys.UI.Point(wc.x,wc.y+wc.height);this.$.isChromeRtl&&(Ha.x+=wc.width);"isKeyboardInput"in Xb&&Xb.isKeyboardInput?this.eo(Ha,!1,1):this.eo(Ha,!1);break;case 495005930:break;case -1170196828:lb.a(this.$).QJ(this.xo,this.FTa,this.DBc-1,this.wL,yb);break;case -889576107:lb.a(this.$).QJ(this.xo,
this.FTa,this.DBc+2,this.wL,yb);break;case 2033235475:lb.a(this.$).QJ(this.xo,this.FTa,this.q4d,this.wL,yb);break;case 389774337:lb.a(this.$).QJ(this.xo,this.FTa,0,this.wL,yb);break;case -96230454:lb.a(this.$).QJ(this.xo,4,-1,this.wL,yb);break;case 74086617:lb.a(this.$).QJ(this.xo,1,-1,this.wL,yb);break;case 1529312473:lb.a(this.$).QJ(this.xo,2,-1,this.wL,yb);break;case 563292088:this.$3a&&h.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");lb.a(this.$).QJ(this.xo,
8,-1,this.wL,yb);break;case -1092351914:lb.a(this.$).QJ(this.xo,0,-1,this.wL,yb);break;case -2141589616:const Vc=Object(Ab.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(Z.c)(Eb.a.resolve(Wb.L,{Wb:wc.QM()})):P.GetServiceTaskFactory.Pa(this.$.da,12,477,wc.QM()),yd=U.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(Z.c)(Eb.a.resolve(Wb.w,{Wb:wc.QM()})):P.GetServiceTaskFactory.Pa(this.$.da,498,499,wc.QM());return E.TaskExtensions.za(E.TaskExtensions.Md([Vc,
yd],this.$.ka),()=>{(new ae(this.cell,this.Jo,this.externalSourceIndex,this.xo.Name,this.$,yb,Vc.result,this.isOlap,this.zV,yd.result)).initialize()},this.ka);default:return da.a(Ha)}return V.Task.Ta(!0)}Ac(Ha,yb,Xb){Ha=!1;switch(yb.command){case -1453503574:Ha=!!Xb;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:Ha=!0}return Ha}TY(){const Ha=this.Xa.Bq(this.menuId);this.waj(Ha,
this.DBc,this.q4d);this.xaj(Ha,this.FTa);this.yaj(Ha);8===this.FTa&&this.uaj(Ha);return Ha}waj(Ha,yb,Xb){const wc=this.Xa,Vc=wc.Jc();yb||yb!==Xb-1?!yb&&yb<Xb-1?(Vc.buttons.push(wc.ob(64)),Vc.buttons.push(wc.ob(61)),Vc.buttons.push(wc.ob(66)),Vc.buttons.push(wc.ob(63))):0<yb&&yb<Xb-1?(Vc.buttons.push(wc.ob(60)),Vc.buttons.push(wc.ob(61)),Vc.buttons.push(wc.ob(62)),Vc.buttons.push(wc.ob(63))):0<yb&&yb===Xb-1&&(Vc.buttons.push(wc.ob(60)),Vc.buttons.push(wc.ob(65)),Vc.buttons.push(wc.ob(62)),Vc.buttons.push(wc.ob(67))):
(Vc.buttons.push(wc.ob(64)),Vc.buttons.push(wc.ob(65)),Vc.buttons.push(wc.ob(66)),Vc.buttons.push(wc.ob(67)));Ha.uc.push(Vc)}xaj(Ha,yb){const Xb=this.Xa,wc=Xb.Jc(),Vc=1!==yb&&(!this.isOlap||this.zV||8!==yb||this.$3a),yd=2!==yb&&(!this.isOlap||this.zV||8!==yb||this.$3a),Od=8!==yb&&-2!==this.xo.PivotTableIndex&&(!this.isOlap||this.zV||this.$3a);wc.buttons.push(Xb.ob(4===yb||this.xo.IsSet||-2===this.xo.PivotTableIndex||this.isOlap&&!this.zV&&8===yb&&!this.$3a?72:68));8===this.Jo.AnchorType||10===this.Jo.AnchorType?
(wc.buttons.push(Xb.ob(Vc?95:97)),wc.buttons.push(Xb.ob(yd?96:98))):(wc.buttons.push(Xb.ob(Vc?69:73)),wc.buttons.push(Xb.ob(yd?70:74)));wc.buttons.push(Xb.ob(Od?71:75));Ha.uc.push(wc)}yaj(Ha){const yb=this.Xa.Jc();yb.buttons.push(this.Xa.ob(76));Ha.uc.push(yb)}uaj(Ha){const yb=this.Xa.Jc();yb.buttons.push(this.Xa.ob(77));Ha.uc.push(yb)}}Object(b.a)(Sc,"FieldWellContextMenu",m.a,[]);var qd=a(1255);class Id extends Ta{constructor(Ha,yb,Xb,wc){super(Ha,"PopulatePivotContextMenu",2123758504,912277356,
yb,Xb,wc)}get Sw(){return"PopulatePivotContextMenu"}get vB(){return u.a.vUf}executeCommand(Ha,yb,Xb){let wc=!1;const Vc=yb.command;switch(Vc){case 37023044:wc=this.Lcd(Xb,yb);break;case 541421805:case -569786022:wc=this.tmd(Ha,yb)}return wc?V.Task.Ta(!0):da.a(Vc)}Ac(Ha,yb,Xb){Ha=!1;switch(yb.command){case 37023044:Ha=!!Xb;break;case 541421805:case -569786022:Ha=!0}return Ha}tmd(Ha,yb){var Xb=8===Ha,wc=this.$,Vc=Na.a(wc),yd=fa.h(wc).ha.Sa.jc;let Od=Ha=null;Xb&&Vc?(Ha=Vc.chartId,Od=Vc.ed):!Xb&&yd&&
(Ha=yd.floatingObject.id,Od=yd.floatingObject.ed);return Id.Uwe(Od,260)?(Xb={},wc.Sj(Xb),Xb.FirstColumn=Xb.FirstRow=-1,wc={["rawEvent"]:null,["pivotName"]:null,["cell"]:Xb,["requiresConfirmation"]:Id.Uwe(Od,64),["dataSourceIndex"]:Od.ExternalSourceIndex},yd?(Vc=yd.floatingObject,wc.domElement=yd.domElement,wc.objectId=Vc.id,wc.objectVersion=Vc.version):Vc&&(wc.domElement=Vc.Gl,wc.objectId=Vc.chartId,wc.objectVersion=Vc.uDe),yd={AnchorType:7},yd.ChartId=Ha,yd.AnchorValue1=-1,yd.AnchorValue2=-1,wc.optionalPivotMenuAnchorParameter=
yd,this.Lcd(wc,yb)):!1}static Uwe(Ha,yb){return(Ha.Attributes&yb)===yb}}Object(b.a)(Id,"PivotFilterContextMenu",Ta,[]);var ic=a(1325);const Gc=(Ha,yb,Xb,wc,Vc,yd,Od,be,Qb,zc=null)=>{zc=Ha.Oa(41,zc);zc.activeCell=yb;zc.operationType=Xb;zc.fieldCaption=wc;zc.prevFieldCaption=Vc;return S.g(Ha,"ExecutePivotTableOperation",zc,yd,Od,be,Qb,0)},jd=(Ha,yb,Xb,wc,Vc,yd,Od,be=null)=>{be=Ha.Oa(41,be);be.activeCell=yb;be.pivotValueFieldSettingsApplyData=Xb;return S.g(Ha,"ApplyValueFieldSettingsToPivotTable",be,
wc,Vc,yd,Od,0)};var ed=a(159),Qd=a(379),te=a(291),xe=a(28),He=a(22);const We=u.a.tch,ye=We+".RemoveField",$e=We+".Subtotal",jf=We+".ClearFilter",gf=We+".LayoutSameColumn",rf=We+".LayoutNextColumn";class Mf extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulatePivotTableContextMenu",-1475408662,1114549926,We,!0,!1,"PivotTableContextMenuRootName",yb,Xb,!0,wc);this.U3d=this.activeCell=this.hc=null;this.pZ=this.refresh=this.expandCollapse=this.Urd=this.jlc=!1;this.Kbb=this.ub=this.N1a=this.bA=this.Ee=
null;this.Vba=!1;this.CYi=Vc=>{Vc&&!R.a.Zf(Vc.Errors)&&this.hc&&(this.hc.Wo=Vc.Result,this.hNb());this.showPivotTableContextMenu()};this.BYi=()=>{};this.g1i=()=>{this.Adb()};this.f1i=()=>{this.Adb()};this.NSi=()=>{this.Adb()};this.MSi=()=>{this.Adb()};this.my=()=>{this.i1d();this.Vba=!1};this.Sq=()=>{if(this.Vba){h.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");const Vc=this.hc;this.grid.tb.fp(this.grid.ha.ra.activeCell)!==
Vc&&(this.Adb(),this.Ogi())}};this.Gsh=new DOMParser;this.RJj=!0;this.grid=fa.h(Ha);this.doc=!0}get Sw(){return"PopulatePivotTableContextMenu"}get vB(){return u.a.wUf}executeCommand(Ha,yb,Xb){yb=yb.command;Ha=null;this.grid=fa.h(this.$);this.activeCell=H.o(this.grid.ha.ra.activeCell,this.$);if(this.$.isEditMode&&(this.hc=this.grid.tb.fp(this.grid.ha.ra.activeCell),!this.hc))return h.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),E.TaskExtensions.sba();this.U3d=this.$.pa.va;this.N1a=
Object(Ja.a)(qa.a,Xb.eventArgs);switch(yb){case 671488277:this.QLj()?this.M3h():(this.Adb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,
3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.RSa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.RSa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.RSa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.RSa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.RSa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.RSa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:Xb=Number.parseInvariant(Xb.MenuItemId.split(".")[2]);this.RSa(11,Xb);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Yc(-1556797033,v.a.zb,8,null);break;case 1514686611:this.tDi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:Xb=Number.parseInvariant(Xb.MenuItemId);this.B8g(Xb);break;case 1778578888:Xb=Number.parseInvariant(Xb.MenuItemId);this.CVg(Xb);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,
12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:Ha=da.a(yb)}return Ha||E.TaskExtensions.sba()}Ac(Ha,yb){Ha=!1;switch(yb.command){case 671488277:Ha=
Pa.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:Ha=!0;break;case 1600778266:Ha=!0;break;case -556893687:Ha=!0;break;case -1966978671:Ha=!0;break;case -1951357930:Ha=!0;break;case -1390365353:case -1457478532:Ha=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:Ha=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:Ha=
!0;break;case -1007663920:case 234234584:case 1194992911:Ha=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:Ha=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:Ha=U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return Ha}QLj(){if(!this.$.isEditMode||this.hc.Uic)return!1;let Ha=this.I$f(!1);return U.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.hc.isOlap||Ha:!this.hc.Zjc()||Ha}Mc(Ha,yb){let Xb=!1;switch(yb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:Xb=this.kL();break;case -1007663920:case 234234584:Xb=this.jKj()||this.kL();break;case 1194992911:Xb=this.kKj()||this.kL();break;
case 1217404289:Xb=!ic.j(this.ub.LabelOrDateFilterType)||this.kL();break;case -743135194:Xb=!ic.m(this.ub.ValueFilterType)&&!ic.l(this.ub.ValueFilterType)||this.kL();break;case 771421327:Xb=0===this.ub.LabelOrDateFilterType&&0===this.ub.ValueFilterType&&!this.ub.HasManualFilter||this.kL();break;case 1015867427:Xb=!ic.i(this.ub.LabelOrDateFilterType)||this.kL();break;case 1105960559:Xb=!ic.k(this.ub.LabelOrDateFilterType)||this.kL()}return Xb||super.Mc(Ha,yb)}Adb(){this.Kbb=this.ub=this.Ee=null}CYd(){this.grid.BT(this.Sq);
this.$.Ia.OZa(this.my)}i1d(){this.grid.YN(this.Sq);this.$.Ia.TKb(this.my)}hNb(){if(this.hc&&this.hc.Wo){this.Ee=this.hc.Wo;this.ub=this.hc.hdc();if(this.Bag()){const Ha=this.hc.cL[4===this.Ee.CellType?this.hc.Q8c-1:this.Ee.CurrentFieldIndex-1];Ha&&(this.Kbb=-2===Ha.Index?this.hc.bMe:Ha.Caption)}this.Cki();this.ub&&8===this.Ee.CellArea&&(this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.ub.DataFieldAggregationType,this.bA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.ub.DataFieldFormatType,
this.bA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.ub.BaseFieldIndex,this.bA.PivotValueFieldTitle=this.ub.Caption)}}I$f(Ha){return this.hc?this.hc.isOlap&&!this.hc.YNa(!Ha):!1}sKj(){const Ha=U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.ub.MeasureType&&(!this.hc.Lnf||Ha&&2===this.ub.MeasureType)}TY(){const Ha=this.Xa.Bq(this.menuId),yb=this.Xa.Jc(),Xb=fa.h(this.$).Jb(null);if(this.hc)this.Ee&&this.hc.Wo&&this.Ee!==this.hc.Wo&&
h.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.ub&&this.ub!==this.hc.hdc()&&h.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return Ha;this.qPh(Ha);if(this.$.isEditMode){this.refresh&&this.IQh(Ha);if(this.Ee&&this.ub){var wc=this.Xa.Jc();this.$Qh(wc);this.FPh(wc);Ha.uc.push(wc)}this.pZ&&yb.buttons.push(this.Xa.ob(99));this.Ee&&this.ub&&this.eQh(Ha);if(this.expandCollapse){wc=this.Xa.mw("ContextMenu.PivotExpandCollapse",
null,T.a.instance.ga(1167),589118293);const Vc=this.Xa.Jc();Vc.buttons.push(this.Xa.ob(243));Vc.buttons.push(this.Xa.ob(244));Vc.buttons.push(this.Xa.ob(245));Vc.buttons.push(this.Xa.ob(246));wc.menu.uc.push(Vc);wc&&0<Vc.buttons.length&&yb.buttons.push(wc)}this.Ee&&(wc=this.Xa.Jc(),U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.pQh(wc),this.JQh(wc),0<wc.buttons.length&&Ha.uc.push(wc));this.Ee&&this.ub&&8===this.Ee.CellArea&&8!==this.Ee.CellType&&
(wc=this.Xa.Jc(),this.sKj()&&this.bRh(wc),3!==this.Ee.CellType&&this.VQh(wc),Ha.uc.push(wc));!this.hc.Zjc()&&""!==(null===Xb||void 0===Xb?void 0:Xb.text)&&this.Ee&&0===this.Ee.CellType&&U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.UQh(Ha);this.ywi()?yb.buttons.push(this.Xa.ob(257)):yb.buttons.push(this.Xa.ob(258));this.Urd?yb.buttons.push(this.Xa.ob(59)):yb.buttons.push(this.Xa.ob(58))}Ha.uc.push(yb);return Ha}gTa(){return this.ub&&this.ub.Caption?20<
this.ub.Caption.length:!1}kLa(Ha){return this.ub&&this.ub.Caption?Ha?this.ub.Caption.substring(0,20)+"...":this.ub.Caption:""}Xva(Ha){return U.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?He.a.hashCode(Ha).toString():Ha}$Qh(Ha){if(this.Ee&&this.ub&&4!==this.Ee.CellArea){var yb=this.Sja(this.tH("PivotTableContextMenu.Sort",this.Xva(this.ub.Caption)),-1777747317,0,0!==this.ub.SortInfo,T.a.instance.ga(227)),Xb=this.Xa.Jc();Xb.buttons.push(this.Wd("PivotTableContextMenu.SortAscending",
-1007663920,0,1===this.ub.SortInfo,T.a.instance.ga(228)));Xb.buttons.push(this.Wd("PivotTableContextMenu.SortDescending",234234584,0,2===this.ub.SortInfo,T.a.instance.ga(229)));1!==this.Ee.CellArea&&2!==this.Ee.CellArea||Xb.buttons.push(this.Wd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.ub.SortInfo||4===this.ub.SortInfo,T.a.instance.ga(153)));yb.menu.uc.push(Xb);yb&&0<Xb.buttons.length&&Ha.buttons.push(yb)}}FPh(Ha){if(this.Ee&&this.ub&&(1===this.Ee.CellArea||2===this.Ee.CellArea)){var yb=
this.PLj();const yd=this.Sja(this.tH("PivotTableContextMenu.Filter",this.Xva(this.ub.Caption)),-1777747317,0,yb,T.a.instance.ga(651)),Od=this.Xa.Jc();var Xb="",wc=this.gTa(),Vc=String.format(T.a.instance.nb(156),this.kLa(wc));wc&&(Xb=String.format(T.a.instance.nb(156),this.ub.Caption));yb=this.Xva(this.ub.Caption)+"."+(yb?"enabled":"disabled");Xb=this.Wd(this.tH(jf,yb),771421327,0,!1,Vc,"0",Xb,8,xb.a.N3a);yb=this.Xva(this.ub.Caption)+"."+this.ub.LabelOrDateFilterType.toString();this.ub.IsDateField?
(Vc=this.Sja(this.tH("PivotTableContextMenu.DateFilter",yb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,T.a.instance.ga(96)),this.tPh(Vc.menu)):(Vc=this.Sja(this.tH("PivotTableContextMenu.LabelFilter",yb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,T.a.instance.ga(649)),this.dQh(Vc.menu));yb=this.Xva(this.ub.Caption)+"."+this.ub.ValueFilterType.toString();yb=this.Sja(this.tH("PivotTableContextMenu.ValueFilter",yb),-1777747317,0,0!==this.ub.ValueFilterType,T.a.instance.ga(650));this.nRh(yb.menu);
wc=this.Xa.Jc();wc.buttons.push(this.Wd("PivotTableContextMenu.ManualFilter",1514686611,0,this.ub.HasManualFilter,T.a.instance.ga(93)));Od.buttons.push(Xb);Od.buttons.push(Vc);Od.buttons.push(yb);yd.menu.uc.push(Od);yd.menu.uc.push(wc);yd&&0<Od.buttons.length&&Ha.buttons.push(yd)}}tPh(Ha){Ha.uc.push(this.Bdc(!0,!1));Ha.uc.push(this.RWh());Ha.uc.push(this.QWh());Ha.uc.push(this.JYh());Ha.uc.push(this.MYh());Ha.uc.push(this.KYh());Ha.uc.push(this.LYh());Ha.uc.push(this.NYh());Ha.uc.push(this.OYh());
Ha.uc.push(this.EWh())}iPh(Ha){Ha.uc.push(this.Bdc(!0,!0));Ha.uc.push(this.M4h());Ha.uc.push(this.R1h())}dQh(Ha){Ha.uc.push(this.Bdc(!0,!1));Ha.uc.push(this.E4e(!0));Ha.uc.push(this.fTh());Ha.uc.push(this.PVh());Ha.uc.push(this.D3e(!0));Ha.uc.push(this.D2e(!0))}nRh(Ha){Ha.uc.push(this.Bdc(!1,!1));Ha.uc.push(this.E4e(!1));Ha.uc.push(this.D3e(!1));Ha.uc.push(this.D2e(!1));Ha.uc.push(this.u9h())}u9h(){const Ha=this.Xa.Jc();Ha.buttons.push(this.Wd("PivotTableContextMenu.Top10",-1611233597,0,ic.l(this.ub.ValueFilterType),
T.a.instance.ga(104)));return Ha}PVh(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.Contains",786260386,0,10===this.ub.LabelOrDateFilterType,T.a.instance.ga(652),"10")),Ha.buttons.push(this.Wd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.ub.LabelOrDateFilterType,T.a.instance.ga(653),"11")));return Ha}fTh(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.ub.LabelOrDateFilterType,T.a.instance.ga(654),
"6")),Ha.buttons.push(this.Wd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.ub.LabelOrDateFilterType,T.a.instance.ga(655),"7")),Ha.buttons.push(this.Wd("PivotTableContextMenu.EndsWith",786260386,0,8===this.ub.LabelOrDateFilterType,T.a.instance.ga(656),"8")),Ha.buttons.push(this.Wd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.ub.LabelOrDateFilterType,T.a.instance.ga(657),"9")));return Ha}E4e(Ha){const yb=this.Xa.Jc();if(this.ub){const Xb=Ha?ic.c:ic.f;yb.buttons.push(this.Wd(this.tH("PivotTableContextMenu.Equals",
Xb),786260386,0,Ha?4===this.ub.LabelOrDateFilterType:18===this.ub.ValueFilterType,T.a.instance.ga(99),Ha?"4":"18"));yb.buttons.push(this.Wd(this.tH("PivotTableContextMenu.DoesNotEqual",Xb),786260386,0,Ha?5===this.ub.LabelOrDateFilterType:19===this.ub.ValueFilterType,T.a.instance.ga(100),Ha?"5":"19"))}return yb}D3e(Ha){const yb=this.Xa.Jc();if(this.ub){const Xb=Ha?ic.c:ic.f;yb.buttons.push(this.Wd(this.tH("PivotTableContextMenu.GreaterThan",Xb),786260386,0,Ha?12===this.ub.LabelOrDateFilterType:20===
this.ub.ValueFilterType,T.a.instance.ga(101),Ha?"12":"20"));yb.buttons.push(this.Wd(this.tH("PivotTableContextMenu.GreaterThanOrEqualTo",Xb),786260386,0,Ha?13===this.ub.LabelOrDateFilterType:21===this.ub.ValueFilterType,T.a.instance.ga(658),Ha?"13":"21"));yb.buttons.push(this.Wd(this.tH("PivotTableContextMenu.LessThan",Xb),786260386,0,Ha?14===this.ub.LabelOrDateFilterType:22===this.ub.ValueFilterType,T.a.instance.ga(102),Ha?"14":"22"));yb.buttons.push(this.Wd(this.tH("PivotTableContextMenu.LessThanOrEqualTo",
Xb),786260386,0,Ha?15===this.ub.LabelOrDateFilterType:23===this.ub.ValueFilterType,T.a.instance.ga(659),Ha?"15":"23"))}return yb}D2e(Ha){const yb=this.Xa.Jc();if(this.ub){const Xb=Ha?ic.c:ic.f;yb.buttons.push(this.Wd(this.tH("PivotTableContextMenu.Between",Xb),786260386,0,Ha?16===this.ub.LabelOrDateFilterType:24===this.ub.ValueFilterType,T.a.instance.ga(103),Ha?"16":"24"));yb.buttons.push(this.Wd(this.tH("PivotTableContextMenu.NotBetween",Xb),786260386,0,Ha?17===this.ub.LabelOrDateFilterType:25===
this.ub.ValueFilterType,T.a.instance.ga(660),Ha?"17":"25"))}return yb}Bdc(Ha,yb){const Xb=this.Xa.Jc();if(this.ub){var wc=T.a.instance.ga(97);const yd=Ha?this.ub.LabelOrDateFilterType.toString():this.ub.ValueFilterType.toString();var Vc=["PivotTableContextMenu.ClearFilter",this.Xva(this.ub.Caption),yd];Ha=Ha?this.ub.IsDateField?yb?1015867427:1105960559:1217404289:-743135194;Vc.push(Ha.toString());Vc=Vc.join(".");wc=this.Wd(Vc,Ha,0,!1,wc,yd,wc,8,xb.a.N3a);Xb.buttons.push(wc)}return Xb}RWh(){const Ha=
this.Xa.Jc();this.ub&&Ha.buttons.push(this.Wd(this.tH("PivotTableContextMenu.Equals",ic.d),786260386,0,26===this.ub.LabelOrDateFilterType,T.a.instance.ga(99),"26"));return Ha}QWh(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.Before",786260386,0,27===this.ub.LabelOrDateFilterType,T.a.instance.ga(111),"27")),Ha.buttons.push(this.Wd("PivotTableContextMenu.After",786260386,0,28===this.ub.LabelOrDateFilterType,T.a.instance.ga(112),"28")),Ha.buttons.push(this.Wd("PivotTableContextMenu.Between",
786260386,0,29===this.ub.LabelOrDateFilterType,T.a.instance.ga(103),"29")));return Ha}JYh(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.ub.LabelOrDateFilterType,T.a.instance.ga(109),"30")),Ha.buttons.push(this.Wd("PivotTableContextMenu.Today",1778578888,0,31===this.ub.LabelOrDateFilterType,T.a.instance.ga(108),"31")),Ha.buttons.push(this.Wd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.ub.LabelOrDateFilterType,T.a.instance.ga(110),
"32")));return Ha}MYh(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.ub.LabelOrDateFilterType,T.a.instance.ga(114),"33")),Ha.buttons.push(this.Wd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.ub.LabelOrDateFilterType,T.a.instance.ga(113),"34")),Ha.buttons.push(this.Wd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.ub.LabelOrDateFilterType,T.a.instance.ga(115),"35")));return Ha}KYh(){const Ha=this.Xa.Jc();this.ub&&
(Ha.buttons.push(this.Wd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.ub.LabelOrDateFilterType,T.a.instance.ga(116),"36")),Ha.buttons.push(this.Wd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.ub.LabelOrDateFilterType,T.a.instance.ga(117),"37")),Ha.buttons.push(this.Wd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.ub.LabelOrDateFilterType,T.a.instance.ga(118),"38")));return Ha}LYh(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.ub.LabelOrDateFilterType,T.a.instance.ga(119),"39")),Ha.buttons.push(this.Wd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.ub.LabelOrDateFilterType,T.a.instance.ga(120),"40")),Ha.buttons.push(this.Wd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.ub.LabelOrDateFilterType,T.a.instance.ga(121),"41")));return Ha}NYh(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.NextYear",1778578888,0,42===this.ub.LabelOrDateFilterType,
T.a.instance.ga(122),"42")),Ha.buttons.push(this.Wd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.ub.LabelOrDateFilterType,T.a.instance.ga(123),"43")),Ha.buttons.push(this.Wd("PivotTableContextMenu.LastYear",1778578888,0,44===this.ub.LabelOrDateFilterType,T.a.instance.ga(124),"44")));return Ha}OYh(){const Ha=this.Xa.Jc();if(this.ub){Ha.buttons.push(this.Wd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.ub.LabelOrDateFilterType,T.a.instance.ga(125),"45"));const yb=this.Sja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,ic.i(this.ub.LabelOrDateFilterType),T.a.instance.ga(126));this.iPh(yb.menu);Ha.buttons.push(yb)}return Ha}EWh(){const Ha=this.Xa.Jc();this.ub&&Ha.buttons.push(this.Wd("PivotTableContextMenu.CustomFilter",786260386,0,this.LLj(this.ub.LabelOrDateFilterType),T.a.instance.ga(107),"26"));return Ha}M4h(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.ub.LabelOrDateFilterType,T.a.instance.ga(127),"46")),Ha.buttons.push(this.Wd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.ub.LabelOrDateFilterType,T.a.instance.ga(128),"47")),Ha.buttons.push(this.Wd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.ub.LabelOrDateFilterType,T.a.instance.ga(129),"48")),Ha.buttons.push(this.Wd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.ub.LabelOrDateFilterType,T.a.instance.ga(130),"49")));return Ha}R1h(){const Ha=this.Xa.Jc();this.ub&&(Ha.buttons.push(this.Wd("PivotTableContextMenu.January",1778578888,0,50===this.ub.LabelOrDateFilterType,T.a.instance.ga(131),
"50")),Ha.buttons.push(this.Wd("PivotTableContextMenu.February",1778578888,0,51===this.ub.LabelOrDateFilterType,T.a.instance.ga(132),"51")),Ha.buttons.push(this.Wd("PivotTableContextMenu.March",1778578888,0,52===this.ub.LabelOrDateFilterType,T.a.instance.ga(133),"52")),Ha.buttons.push(this.Wd("PivotTableContextMenu.April",1778578888,0,53===this.ub.LabelOrDateFilterType,T.a.instance.ga(134),"53")),Ha.buttons.push(this.Wd("PivotTableContextMenu.May",1778578888,0,54===this.ub.LabelOrDateFilterType,T.a.instance.ga(135),
"54")),Ha.buttons.push(this.Wd("PivotTableContextMenu.June",1778578888,0,55===this.ub.LabelOrDateFilterType,T.a.instance.ga(136),"55")),Ha.buttons.push(this.Wd("PivotTableContextMenu.July",1778578888,0,56===this.ub.LabelOrDateFilterType,T.a.instance.ga(137),"56")),Ha.buttons.push(this.Wd("PivotTableContextMenu.August",1778578888,0,57===this.ub.LabelOrDateFilterType,T.a.instance.ga(138),"57")),Ha.buttons.push(this.Wd("PivotTableContextMenu.September",1778578888,0,58===this.ub.LabelOrDateFilterType,
T.a.instance.ga(139),"58")),Ha.buttons.push(this.Wd("PivotTableContextMenu.October",1778578888,0,59===this.ub.LabelOrDateFilterType,T.a.instance.ga(140),"59")),Ha.buttons.push(this.Wd("PivotTableContextMenu.November",1778578888,0,60===this.ub.LabelOrDateFilterType,T.a.instance.ga(141),"60")),Ha.buttons.push(this.Wd("PivotTableContextMenu.December",1778578888,0,61===this.ub.LabelOrDateFilterType,T.a.instance.ga(142),"61")));return Ha}eQh(Ha){const yb=this.Xa.Jc();if(this.Bag()){var Xb=this.hc.cL[4===
this.Ee.CellType?this.hc.Q8c-1:this.Ee.CurrentFieldIndex-1];if(Xb&&this.Kbb){var wc=this.Xa.mw("ContextMenu.PivotTableLayout",null,T.a.instance.ga(647),-1777747317);var Vc=this.Xa.Jc();const yd=String.format(T.a.instance.nb(169),this.Kbb),Od=String.format(T.a.instance.nb(170),this.Kbb);Vc.buttons.push(this.Wd(rf,-1457478532,0,!Xb.IsCompactLayout,yd));Vc.buttons.push(this.Wd(gf,-1390365353,0,Xb.IsCompactLayout,Od));wc.menu.uc.push(Vc);wc&&yb.buttons.push(wc)}}if(1===this.Ee.CellArea||2===this.Ee.CellArea)this.ub.Caption&&
(Xb="",Vc=this.gTa(),wc=String.format(T.a.instance.nb(159),this.kLa(Vc)),Vc&&(Xb=String.format(T.a.instance.nb(159),this.ub.Caption)),1===this.Ee.CellArea?(Xb=this.Sja("ContextMenu.PivotTableSubtotal",1801458190,0,this.ub.ShowSubtotal,wc),wc=this.Xa.Jc(),wc.buttons.push(this.Xa.ob(259)),wc.buttons.push(this.Wd("ContextMenu.PivotTableSubtotalOnTop",671485366,639,this.ub.ShowSubtotal&&this.ub.ShowSubtotalAtTop)),wc.buttons.push(this.Wd("ContextMenu.PivotTableSubtotalOnBottom",772221736,640,this.ub.ShowSubtotal&&
!this.ub.ShowSubtotalAtTop)),Xb.menu.uc.push(wc),Xb&&0<wc.buttons.length&&yb.buttons.push(Xb)):(Vc=Vc?this.tH($e,this.Xva(wc)):$e,yb.buttons.push(this.Wd(Vc,1801458190,0,this.ub.ShowSubtotal,wc,null,Xb)))),yb.buttons.push(this.Wd("ContextMenu.RepeatItemLabels",-556893687,642,this.ub.RepeatItemLabels));1===this.Ee.CellArea&&yb.buttons.push(this.Wd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,641,this.ub.ShowBlankLineAfterEachItem));Ha.uc.push(yb)}UQh(Ha){const yb=this.Xa.Jc();yb.buttons.push(this.Xa.ob(247));
Ha.uc.push(yb)}pQh(Ha){if(this.$.isEditMode&&this.grid){var yb=this.grid.ha.ra.activeRange;if(yb.top===yb.bottom&&yb.left===yb.right&&0!==this.Ee.MoveItemsMenuState){yb=this.Sja("PivotTableContextMenu.Move",-1777747317,0,!1,T.a.instance.ga(73));var Xb=this.Xa.Jc();this.zva(Xb,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(T.a.instance.nb(162),this.Ee.MoveItemName),0===(this.Ee.MoveItemsMenuState&1));this.zva(Xb,"PivotTableContextMenu.MoveUp",713270357,String.format(T.a.instance.nb(163),
this.Ee.MoveItemName),0===(this.Ee.MoveItemsMenuState&2));this.zva(Xb,"PivotTableContextMenu.MoveDown",-1842411134,String.format(T.a.instance.nb(160),this.Ee.MoveItemName),0===(this.Ee.MoveItemsMenuState&4));this.zva(Xb,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(T.a.instance.nb(161),this.Ee.MoveItemName),0===(this.Ee.MoveItemsMenuState&8));yb.menu.uc.push(Xb);Xb=this.Xa.Jc();this.zva(Xb,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(T.a.instance.nb(167),this.kLa(this.gTa())),
0===(this.Ee.MoveItemsMenuState&16));this.zva(Xb,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(T.a.instance.nb(164),this.kLa(this.gTa())),0===(this.Ee.MoveItemsMenuState&32));this.zva(Xb,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(T.a.instance.nb(165),this.kLa(this.gTa())),0===(this.Ee.MoveItemsMenuState&64));this.zva(Xb,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(T.a.instance.nb(166),this.kLa(this.gTa())),0===(this.Ee.MoveItemsMenuState&
128));yb.menu.uc.push(Xb);Ha.buttons.push(yb)}}}JQh(Ha){var yb="";let Xb="";var wc=!1;3===this.Ee.CellType?yb=T.a.instance.ga(644):8===this.Ee.CellType?this.hc&&(yb=String.format(T.a.instance.nb(168),this.hc.bMe)):this.ub&&((wc=this.gTa())&&(Xb=String.format(T.a.instance.nb(168),this.ub.Caption)),yb=String.format(T.a.instance.nb(168),this.kLa(wc)));yb&&(wc=wc?this.tH(ye,this.Xva(yb)):ye,yb=this.Wd(wc,-1951357930,0,!1,yb,null,Xb,8,xb.a.hcd),Ha.buttons.push(yb))}qPh(Ha){const yb=this.Xa.Jc();yb.buttons.push(this.Xa.ob(43));
this.ub&&this.Ee&&this.$.isEditMode&&(0===this.Ee.CellType||4===this.Ee.CellType)&&yb.buttons.push(this.Xa.ob(136));if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&U.EwaSettings.xa(102)&&this.grid&&this.grid.ha){const Xb=this.grid.ha.ra.selectedRanges;Xb&&1===Xb.length&&(Xb[0].isSingle||this.grid.tb.Uxa(Xb[0]))&&this.grid.tb.Sxa(Xb[0])&&!this.grid.tb.aBb(Xb[0])&&yb.buttons.push(this.Xa.ob(this.grid.tb.ijf(Xb[0])?217:216))}Ha.uc.push(yb)}IQh(Ha){const yb=
this.Xa.Jc();yb.buttons.push(this.Xa.ob(100));Ha.uc.push(yb)}bRh(Ha){const yb=2===this.ub.MeasureType&&!this.ub.IsNumeric,Xb=this.Xa.mw("ContextMenu.SummarizeValuesBy",null,T.a.instance.ga(645),-249874296),wc=this.Xa.Jc();wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesBySum",-1255320719,1106,0===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,yb));wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByCount",1746132849,1107,1===this.ub.DataFieldAggregationType));wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByAverage",
-771066011,1108,2===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,yb));wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByMax",835007294,1109,3===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,yb));wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByMin",929115636,1110,4===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,yb));wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByProduct",1935475057,1111,5===this.ub.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.I$f(!0)||yb));2!==this.ub.MeasureType&&(wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1112,6===this.ub.DataFieldAggregationType)),wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1113,7===this.ub.DataFieldAggregationType)),wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1114,8===this.ub.DataFieldAggregationType)),wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByVariant",
1668427539,1115,9===this.ub.DataFieldAggregationType)),wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1116,10===this.ub.DataFieldAggregationType)));this.hc&&this.hc.Zjc()&&wc.buttons.push(this.Wd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1117,11===this.ub.DataFieldAggregationType));Xb.menu.uc.push(wc);Ha.buttons.push(Xb)}VQh(Ha){const yb=this.Xa.mw("ContextMenu.ShowValuesAs",null,T.a.instance.ga(646),-1128612833),Xb=this.Xa.Jc();Xb.buttons.push(this.Wd("ContextMenu.ShowValuesAsNoCalculation",
-841863025,1123,0===this.ub.DataFieldFormatType));Xb.buttons.push(this.Wd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1130,7===this.ub.DataFieldFormatType));Xb.buttons.push(this.Wd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1129,6===this.ub.DataFieldFormatType));Xb.buttons.push(this.Wd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1128,5===this.ub.DataFieldFormatType));Xb.buttons.push(this.Wd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1133,9===this.ub.DataFieldFormatType));
Xb.buttons.push(this.Wd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1134,10===this.ub.DataFieldFormatType));if(this.hc&&this.hc.cL&&0<this.hc.cL.length||this.hc.Q$&&0<this.hc.Q$.length){const wc=this.Sja("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1135,11===this.ub.DataFieldFormatType),Vc=this.Xa.Jc(),yd=this.aRh();for(let Od=0;Od<yd.length;Od++){const be=yd[Od];Vc.buttons.push(this.Wd("ContextMenu.ShowValuesAsPercentOfParentTotal."+be.Caption,-2031744961,1135,11===this.ub.DataFieldFormatType&&
this.ub.BaseFieldIndex===be.Index,be.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+be.Index))}wc.menu.uc.push(Vc);Xb.buttons.push(wc)}yb.menu.uc.push(Xb);Ha.buttons.push(yb)}showPivotTableContextMenu(){this.Urd=!0;this.expandCollapse=this.pZ=this.refresh=!1;var Ha=this.$,yb=fa.h(Ha),Xb=Ic.a(Ha).BLa();if(Xb){var wc=lb.a(Ha);if(null===wc||void 0===wc?0:wc.gVd)this.Urd=Ma.f(Ha.gg);wc=Ha.ic;this.pZ=Xb.supportsBIExplore&&!!Wa.a(Ha)&&wc.G2(32768);wc.allowInteractivity&&(Ha=yb.Jb(null),(null===
Ha||void 0===Ha?0:Ha.cell)&&(Ha.cell.l2c||Ha.cell.yag)&&(this.expandCollapse=!0),wc.allowManualDataRefresh&&(this.refresh=!0))}Ha=null;Xb=1;this.N1a&&1!==this.N1a.wb?(Ha=new Sys.UI.Point(this.N1a.clientPoint.x,this.N1a.clientPoint.y),Xb=this.N1a.wb):(yb=Pa.e(yb,this.$))&&(Ha=new Sys.UI.Point(yb.x+(this.$.isChromeRtl?0:yb.width),yb.y+yb.height));v.a.zb=Xb;this.jlc=3===Xb;this.eo(Ha,!0,Xb);this.Vba=!0;this.CYd()}Ogi(){const Ha=new J.a(1114549926,0,this.$.xc,19,null);this.$.Ia.Hb(Ha)}M3h(){if(this.hc&&
this.hc.Wo){var Ha=this.hc.Wo.CurrentCol;if(this.hc.Wo.CurrentRow===this.activeCell.FirstRow&&Ha===this.activeCell.FirstColumn){this.hNb();this.showPivotTableContextMenu();return}}Ha=new I.a(228,0,(yb,Xb,wc)=>te.l(this.$.pa.va,this.activeCell,L.b(yb,this.CYi),L.a(Xb,this.BYi),wc,null),16);this.$.userOperationManager.Oc(Ha,null)}ywi(){if(ja.a.Gd(this.$)){var Ha=this.$.da.Ba(441);if(Ha)return Ha.Zr}else if(Ha=this.$.da.Ba(346))return Ha.Zr;return!1}tH(Ha,yb){return Ha+"."+yb}performPivotTableOperation(Ha,
yb){const Xb=xe.a.Ya.Zb;if(!this.hc||!this.ub&&this.Ee&&3!==this.Ee.CellType)this.vj();else{var wc=this.hc.isOlap;Ic.a(this.$).Lx(wc,Vc=>{Vc&&this.$.Oc(Ha,(yd,Od,be)=>Gc(this.U3d,this.activeCell,yb,this.ub?this.ub.Caption:null,this.Kbb,L.b(yd,this.g1i),L.a(Od,this.f1i),be,null,this.$.pa.va.$b()),Xb,0,4,229)})}}applyValueFieldSettingsToPivotTable(Ha,yb=!1){const Xb=xe.a.Ya.Zb;this.hc&&this.ub?(yb&&2===this.ub.MeasureType&&h.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),
yb=this.hc.isOlap,Ic.a(this.$).Lx(yb,wc=>{wc&&this.$.Oc(Ha,(Vc,yd,Od)=>jd(this.U3d,this.activeCell,this.bA,L.b(Vc,this.NSi),L.a(yd,this.MSi),Od,null,this.$.pa.va.$b()),Xb,0,4,231)})):this.vj()}Wd(Ha,yb,Xb,wc,Vc=null,yd=null,Od=null,be=8,Qb=null,zc=!1){wc&&(Ha+=".Checked");zc&&(Ha+=".Disabled");this.Xa.Lqd(Ha)&&this.Xa.IMd(Ha);Xb=Vc||T.a.instance.ga(Xb);Ha=this.Xa.QIa(Ha,Xb,yb,null,"None",yd,zc,null);Ha.gzc(null);Od&&Ha.eS(Od);wc?Ha.gS("Image16by16",3,xb.a.Oaa):Qb?Ha.gS("Image16by16",be,Qb):Ha.W4b();
return Ha}Sja(Ha,yb,Xb,wc,Vc=null){Xb=Vc||T.a.instance.ga(Xb);this.Xa.Lqd(Ha)?this.Xa.IMd(Ha):this.Xa.IMd(Ha+".Checked");wc&&(Ha+=".Checked");this.RJj&&(Xb=this.Gsh.parseFromString(Xb,"text/html").body.innerText);Ha=this.Xa.U6c(Ha,null,Xb,yb,3,xb.a.Oaa);Ha.Tff=wc;!wc&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&Ha.W4b();return Ha}Cki(){this.bA=Object(d.a)(new ne,{PivotValueFieldSummarizeValueByApplyData:Object(d.a)(new dd,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(d.a)(new bd,
{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}RSa(Ha,yb){this.bA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=Ha;this.bA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=yb;this.bA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}aRh(){const Ha=[];if(this.hc&&this.hc.Q$&&0<this.hc.Q$.length)for(const yb of this.hc.Q$)yb&&Ha.push(yb);if(this.hc&&this.hc.cL&&0<this.hc.cL.length)for(const yb of this.hc.cL)yb&&Ha.push(yb);Ha.sort((yb,
Xb)=>yb.Index-Xb.Index);return Ha}Bag(){if(!this.Ee||!this.hc||!this.hc.cL)return!1;const Ha=1===this.Ee.CellArea||4===this.Ee.CellType&&this.Ee.IsRowAxis,yb=4===this.Ee.CellType?0<this.hc.Q8c:0<this.Ee.CurrentFieldIndex;return 1<this.hc.cL.length&&Ha&&yb}mLa(Ha){const yb=[];3===Ha?this.$.isEditMode?yb.push(...[ma.a.lPf,ma.a.nPf,ma.a.a$i]):yb.push(...[ma.a.copy]):2===Ha&&yb.push(ma.a.TCe);return yb}vj(){const Ha=R.a.hd(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");Md.a(this.$).vj(Ha)}PLj(){return this.ub?
0!==this.ub.LabelOrDateFilterType||0!==this.ub.ValueFilterType||this.ub.HasManualFilter:!1}LLj(Ha){return 62<=Ha&&65>=Ha}tDi(){if(this.activeCell&&this.ub&&this.hc){var Ha={};Ha.cell=this.activeCell;Ha.dataSourceIndex=this.hc.externalSourceIndex;Ha.fieldId=this.ub.Index.toString();Ha.isOlap=this.hc.isOlap;Ha.confirmationRequired=this.hc.confirmationRequiredForDataOps;var yb={};yb.showPivotFilterDialogCommandData=Ha;this.$.Yc(492140419,v.a.zb,19,yb)}}B8g(Ha){this.activeCell&&this.ub&&this.hc&&this.$.userOperationManager.Oc(new I.a(153,
0,(yb,Xb,wc)=>S.A(this.$.pa.va,this.activeCell,this.hc.externalSourceIndex,this.ub.Index.toString(),Ha,yb,Xb,wc,null,null)),null)}CVg(Ha){!(30>Ha||61<Ha)&&this.activeCell&&this.ub&&this.hc&&this.$.userOperationManager.Oc(new I.a(152,0,(yb,Xb,wc)=>S.e(this.$.pa.va,this.activeCell,this.hc.externalSourceIndex,this.ub.Index.toString(),Ha,yb,Xb,wc,null,null)),null)}applyPivotSort(Ha){if(this.hc&&this.ub&&this.activeCell&&this.Ee){var yb=1===this.Ee.CellArea||2===this.Ee.CellArea;8===this.Ee.CellArea?Qd.a(this.$.userOperationManager,
(Xb,wc,Vc)=>te.b(this.$.pa.va,this.activeCell,Ha,this.ub.Caption,Xb,wc,Vc,null),Xb=>new I.a(1015,0,Xb,void 0,null),null):yb&&(yb=1===this.Ee.CellArea?1:2,U.EwaSettings.xa(600)?ed.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.hc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.hc.isOlap?"":this.ub.Caption,yb,1===Ha):ed.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.hc.externalSourceIndex,this.ub.Index.toString(),
1===Ha))}}kL(){return!this.hc||!this.hc.isActionable}jKj(){return(this.Ee||this.hc)&&4!==this.Ee.CellType&&(0!==this.Ee.CellType||8!==this.Ee.CellArea||this.hc.Q$&&this.hc.Q$.length||this.hc.cL&&this.hc.cL.length)?!1:!0}kKj(){return this.Ee&&this.hc&&(1===this.Ee.CellArea||2===this.Ee.CellArea)&&this.hc.IRb&&this.hc.IRb.length?!1:!0}zva(Ha,yb,Xb,wc,Vc){Ha.buttons.push(this.Wd(yb,Xb,0,!1,wc,null,null,8,null,Vc))}}Object(b.a)(Mf,"PivotTableContextMenu",m.a,[]);class Qa{compare(Ha,yb){return(Ha||"").localeCompare(yb||
"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(b.a)(Qa,"DigitsAsNumberComparer",null,[333]);var Zb=a(1112),nb=a(164),Tb=a(352),qb=a(273),Kb=a(24),jc=a(150);const Ac=u.a.vch;class Jc extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateTableFieldListContextMenu",-751848458,-1085236154,Ac,!0,!1,"TableFieldListContextMenuRoot",yb,Xb,!1,wc);this.F7b=null;this.VCd=0;this.IFa=null;this.grid=fa.h(Ha)}get Sw(){return"PopulateTableFieldListContextMenu"}get vB(){return u.a.yUf}get TK(){this.IFa||(this.IFa=
this.$.da.Ba(261));return this.IFa}executeCommand(Ha,yb,Xb){Ha=yb.command;switch(Ha){case 639960842:this.applyTableFieldList(Xb);this.TK.Zda();break;case -1085236154:h.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.VCd}`);this.TK.Zda();break;case 1833782813:this.TK.showCallout();break;default:return da.a(Ha)}return V.Task.Ta(!0)}applyTableFieldList(Ha){var yb=Ha.MenuItemId.toString();U.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(yb=yb.replace("'","''"),yb=yb.replace("[","'["),yb=yb.replace("]","']"));var Xb=Object(Ja.a)(String,Ha.SourceControlId);const wc={};wc.PulloutField=yb;wc.PulloutCardPath=Ha.SourceCardKeyPath;wc.PulloutCardSourceRow=Ha.SourceCardRow;wc.PulloutCardSourceColumn=Ha.SourceCardColumn;if(this.TK.lN){h.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");wc.ParameterType=2;Ha=Ha.ColumnIndex;if(void 0===Ha||null===Ha){if(void 0===Xb||null===Xb){h.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}Ha=0<=this.TK.zSf?this.TK.zSf:parseInt(Xb.substring(20+yb.length+1,Xb.length),10);if(isNaN(Ha)){h.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${Xb}`);return}}wc.PulloutRichColumnSourceIndex=Ha;if(this.IFa.USg){this.JTg(yb,wc);return}}else h.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),wc.ParameterType=4,Xb=this.TK.selectedRange.right,ja.a.uBb()&&this.IFa.qxa&&(wc.ParameterType=8,Ha=this.TK.wma.top,Ha=
Kb.Range.sM(Xb)+Ha,yb==Zb.d?(yb="=DAYS("+Ha+", TODAY())",jc.a("DateFormulaPulledOut_DaysFromToday")):yb==Zb.g?(yb="=IF(TODAY() < "+Ha+", DATEDIF(TODAY(), "+Ha+', "Y"), DATEDIF('+Ha+', TODAY(), "Y"))',jc.a("DateFormulaPulledOut_YearsFromToday")):yb==Zb.c?(yb="=TEXT("+Ha+', "dddd")',jc.a("DateFormulaPulledOut_DayOfWeek")):yb==Zb.f?(yb="=TEXT("+Ha+', "mmmm")',jc.a("DateFormulaPulledOut_MonthOfYear")):yb==Zb.e?(yb="EOMONTH("+Ha+", 0)",yb="=DATE(YEAR("+yb+"), MONTH("+yb+"), DAY("+yb+"))",jc.a("DateFormulaPulledOut_EndOfMonth")):
yb==Zb.b&&(yb="="+Ha+" + 1",jc.a("DateFormulaPulledOut_AddOneDay"))),void 0!==wc.PulloutCardSourceColumn&&null!==wc.PulloutCardSourceColumn&&(Xb=wc.PulloutCardSourceColumn+1),wc.PulloutRichColumnSourceIndex=Xb;this.VSd(yb,wc)}VSd(Ha,yb,Xb=0){h.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.VCd}, SelectedColumnIndex, ${yb.PulloutRichColumnSourceIndex}`);Ha=Object(d.a)(new qb.a,{Text:Ha});this.grid.setCell(Ha,this.TK.wma,0,127,yb,Xb);this.grid.focus();
this.F7b=null;this.TK.Zda();this.TK.xtj()}Ac(Ha,yb,Xb){if(Ha=this.$.isEditMode&&U.EwaSettings.xa(128)&&!!this.TK)switch(yb.command){case -1085236154:break;case 639960842:Ha=!!Xb;break;case 1833782813:Ha=this.TK.ixa&&this.TK.jEb;break;default:Ha=!1}return Ha}J0(Ha,yb,Xb){this.$.isEditMode&&(this.F7b=this.kQh(Object(Ja.a)(323,Xb)),super.J0(Ha,yb,null,null,!1))}TY(){return this.F7b}T6c(Ha){if(!this.TK||!Ha||!Ha.Tk)return h.ULS.shipAssertTag(537166994,0,!!this.TK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
h.ULS.shipAssertTag(537166993,0,!!Ha,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),Ha&&h.ULS.shipAssertTag(537166992,0,!!Ha.Tk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let yb=new ab.a;for(const wc of Ha.Tk){Ha=new ab.a;Ha.add(wc.ColumnName);Ha.add(wc.ColumnIndex.toString());let Vc=new ab.a;var Xb=null;ja.a.uBb()&&this.IFa.qxa?Vc=Cb.toList(Cb.select(Cb.asEnumerable(wc.FieldInfoDataList),yd=>yd.Name)):(Xb=
U.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Qa:new kb.a,Vc=Cb.OBc(Cb.concat(Vc,Cb.select(Cb.asEnumerable(wc.FieldInfoDataList),yd=>yd.Name)),yd=>yd,Xb));Xb=new ab.a;Xb.add(Cb.toArray(Cb.concat(Ha,Vc)));yb=Cb.toList(Cb.concat(yb,Xb))}return Cb.toArray(yb)}kQh(Ha){var yb=this.T6c(Ha);if(!yb||!yb.length)return this.F7b=null;Ha=this.Xa;const Xb=Ha.Bq(this.menuId);let wc=Ha.Jc();const Vc=1<yb.length,yd=ja.a.uBb()&&this.IFa.qxa;this.VCd=yb.length;for(const Od of yb){yd?
wc.title="Calculate Date Information":Vc||(wc.title=Od[0]);yb=Ha.Jc();for(let be=2,Qb=Od.length;be<Qb;++be)!yd||Od[be]!=Zb.d&&Od[be]!=Zb.e||(Xb.uc.push(wc),wc=Ha.Jc()),(Vc?yb.buttons:wc.buttons).push(Ha.QIa("ApplyTableFieldList."+Od[be]+"."+Od[1],Od[be],639960842,null,"None",Od[be],!1,void 0,!0));if(Vc){const be=Ha.mw("ApplyTableFieldList."+Od[0],this.menuId,Od[0],798637440);be.menu.uc.push(yb);wc.buttons.push(be)}}Xb.uc.push(wc);return Xb}JTg(Ha,yb){const Xb=R.a.hd(12,1,0,900,0,2007340793,"RichValuePulloutIntoNonEmptyRange");
if(U.EwaSettings.jy()){const wc=new Tb.a(this.$,Xb);wc.YL(()=>{2===wc.returnValue&&this.VSd(Ha,yb,8)})}else{const wc=new nb.ErrorDialog(this.$,Xb);wc.YL(()=>{2===wc.returnValue&&this.VSd(Ha,yb,8)});wc.fg()}}}Object(b.a)(Jc,"PulloutFieldListContextMenu",m.a,[]);const hd=u.a.AUf;class Cd extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateRichTextContextMenu",679816325,1151222423,hd,!0,!1,hd,yb,Xb,!0,wc);this.grid=fa.h(Ha)}get Sw(){return"PopulateRichTextContextMenu"}get vB(){return u.a.AUf}Ac(Ha,
yb,Xb){return-1687037502===yb.command&&!!Xb&&this.grid.eb}executeCommand(Ha,yb,Xb){this.showRichTextFloatie(Xb);return V.Task.Ta(!0)}mLa(){return[ma.a.b6g]}showRichTextFloatie(Ha){var yb=Object(Ja.a)(qa.a,Ha.eventArgs);yb&&(Ha=this.mLa(yb.wb),yb=new Sys.UI.Point(yb.Ea.clientX,yb.Ea.clientY),this.showFloatie(Ha,new Sys.UI.Bounds(yb.x,yb.y,0,0),2))}}Object(b.a)(Cd,"RichTextContextMenu",m.a,[]);var ac=a(104),Lc=a(431);const rd=u.a.uch;class Yd extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateSheetOpsContextMenu",
274207288,-1497523576,rd,!0,!1,"SheetTabContextMenuRootName",yb,Xb,!1,wc);this.blc=this.xjc=!1}get Sw(){return"PopulateSheetOpsContextMenu"}get vB(){return u.a.BUf}executeCommand(Ha,yb,Xb){if(Ka.a(this.$))return V.Task.Ta(!0);this.$.isEditMode&&(Ha=Xb[u.a.j$f],Ha=Ha.x&&Ha.y?new Sys.UI.Point(Ha.x+(this.$.isChromeRtl?10:-10),Ha.y):na.DOMElementExtensions.getLocation(Xb[u.a.k$f]),this.eo(Ha,!1));return V.Task.Ta(!0)}Ac(Ha,yb,Xb){return-1075099431===yb.command&&!!Xb}TY(){const Ha=this.Xa.Bq(this.menuId),
yb=this.$.isEditMode;this.f7j();this.ZPh(Ha,yb);this.OPh(Ha);this.TQh(Ha);return Ha}p0b(Ha,yb,Xb,wc){Ha.push(this.Xa.ob(yb?Xb:wc))}ZPh(Ha,yb){var Xb=this.Xa;const wc=Xb.Jc();wc.buttons.push(Xb.ob(54));this.p0b(wc.buttons,this.blc,127,56);wc.buttons.push(Xb.ob(55));yb&&this.p0b(wc.buttons,this.blc,126,125);wc.buttons.push(Xb.ob(158));yb=this.$.ua.na;U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.wF&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
yb&&yb.ie&&(yb.ie.uz||yb.ie.tK||wc.buttons.push(Xb.ob(299)));this.$.ea.TNb&&k.AFrameworkApplication.OCb(Lc.b)&&(yb=Object(Ja.a)(ac.a,this.$.na))&&nc.p(yb)&&this.$.isEditMode&&(wc.buttons.push(Xb.ob(277)),yb.isLockPausedInSession?wc.buttons.push(Xb.ob(279)):yb.Xh&&wc.buttons.push(Xb.ob(278)));yb=Xb.mw("ContextMenu.TabColor",null,T.a.instance.ga(518),1841703919);Xb=Xb.R6c(467002767,1549407384,541,-221093529,this.vB);yb.menu.uc.push(Xb);wc.buttons.push(yb);Ha.uc.push(wc)}OPh(Ha){const yb=this.Xa.Jc();
this.p0b(yb.buttons,this.blc,114,112);this.p0b(yb.buttons,!this.xjc,115,113);Ha.uc.push(yb)}TQh(Ha){if(U.EwaSettings.xa(418)&&!nc.e(this.$.ua.na)){var yb=this.Xa,Xb=yb.Jc();Xb.buttons.push(yb.ob(263));Ha.uc.push(Xb)}}f7j(){let Ha,yb;({B6c:Ha,GIe:yb}=this.$.A6c());this.blc=1===Ha;this.xjc=0<yb}}Object(b.a)(Yd,"SheetOpsContextMenu",m.a,[]);var ie=a(523);class Je extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",
yb,Xb,!0,wc)}get Sw(){return"PopulateSlicerContextMenu"}get vB(){return u.a.CUf}Mc(Ha,yb){var Xb=!0;switch(yb){case -231711729:Xb=!1;break;case -1909381757:Xb=this.yec();Xb=!!Xb&&Xb.dti;break;case 1312363469:Xb=!0}return!Xb||super.Mc(Ha,yb)}executeCommand(Ha,yb,Xb){if(!this.$.isEditMode)return E.TaskExtensions.sba();Ha=yb.command;yb=this.yec();let wc=null;switch(Ha){case 2108047455:yb&&yb.UEe();break;case -231711729:h.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;
case -1909381757:yb&&yb.d5b();break;case 1312363469:this.showSlicerContextMenu(Xb);break;default:wc=da.a(Ha)}return wc||E.TaskExtensions.sba()}Ac(Ha,yb,Xb){Ha=!1;switch(yb.command){case -231711729:case 2108047455:case -1909381757:Ha=!0;break;case 1312363469:Ha=!!Xb}return Ha}TY(){const Ha=this.Xa.Bq(this.menuId);var yb=this.Xa.Jc();yb.buttons.push(this.Xa.ob(252));yb.buttons.push(this.Xa.ob(253));yb.buttons.push(this.Xa.ob(254));Ha.uc.push(yb);yb=this.Xa.Jc();this.Vyi()?yb.buttons.push(this.Xa.ob(266)):
yb.buttons.push(this.Xa.ob(267));Ha.uc.push(yb);return Ha}Vyi(){if(ja.a.Gd(this.$)){var Ha=this.$.da.Ba(439);if(Ha)return Ha.Zr}else if(Ha=this.$.da.Ba(371))return Ha.Zr;return!1}showSlicerContextMenu(Ha){var yb=Object(Ja.a)(qa.a,Ha.eventArgs);Ha=this.ddc(Object(Ja.a)(qa.a,Ha.eventArgs));yb=yb.wb;v.a.zb=yb;this.eo(Ha,!1,yb)}J1e(Ha){const yb=this.Xa.Jc(),Xb=this.Xa.Jc();Xb.buttons.push(this.Xa.ob(255));Xb.buttons.push(this.Xa.ob(256));const wc=this.Xa.U6c("ContextMenu.SlicerSort",null,T.a.instance.ga(2179),
-814639094,0,xb.a.CVe);wc.menu.uc.push(Xb);yb.buttons.push(wc);Ha.uc.push(yb)}fMj(Ha){return U.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&Ha.Ob.className===xb.a.Tbd||U.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===Ha.wb}ddc(Ha){var yb=fa.h(this.$).ha.Sa.jc;let Xb=Ha&&1!==Ha.wb&&Ha.clientPoint?Ha.clientPoint:Sys.UI.DomElement.getLocation(yb.domElement);if(this.fMj(Ha)){var wc=this.yec();
wc&&(Ha.Ob.className===xb.a.Tbd&&(Xb=Ga.HelperMethods.xxb(Ha.Ea)),1===Ha.wb&&(Xb=La.a(this.$).ska(na.DOMElementExtensions.getLocation(wc.frame))))}else if(Ha=this.yec())Ha=this.IZh(Ha.frame),(wc=Ga.HelperMethods.XC(this.$.Bf,this.$.domElement,fa.h(this.$).rtl,!1))?(Ha.x=La.a(this.$).Jh(Ha.x-wc.x)+wc.x,Ha.y=La.a(this.$).Jh(Ha.y-wc.y)+wc.y):h.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),Xb.y+=Ha.y,Xb.x+=Ha.x;Ha=this.$.domElement;wc=fa.h(this.$).rtl;yb=Ga.HelperMethods.XC(yb.Bg.domElement,
Ha,wc);Xb.y=Math.max(Xb.y,yb.y);Xb.x=Math.max(Xb.x,yb.x);return Xb}yec(){const Ha=fa.h(this.$).ha.Sa.jc;h.ULS.shipAssertTag(537166988,0,!!Ha);return ie.a(this.$).zH(Ha.floatingObject.id)}IZh(Ha){let yb=new Sys.UI.Point(Ha.offsetParent.offsetLeft,Ha.offsetParent.offsetTop);var Xb=fa.h(this.$);if(!Xb)return yb;const wc=fa.h(this.$).rtl;yb=Ga.HelperMethods.XC(Ha,this.$.Hp.ownerDocument.body,wc);Xb.yIe(yb);yb.x=wc?this.$.Hp.clientWidth-yb.x-Ha.clientWidth:yb.x;Ha=Xb.view.frb;Xb=wc?-Xb.aS.Kca(Ha.x):Ha.x;
yb.x-=Xb;yb.y-=Ha.y;return yb}}Object(b.a)(Je,"SlicerContextMenu",m.a,[]);class ff{constructor(Ha,yb,Xb){this.type=Ha;this.sch=yb;this.Er=Xb}}Object(b.a)(ff,"TimeSlicerRibbonButtonParameter",null,[]);class Ae extends m.a{constructor(Ha,yb,Xb,wc){super(Ha,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Ae.zXj,!0,!1,Ae.ZLb,yb,Xb,!1,wc);this.i2a=0;this.zQe=this.wLa=this.wta=null}get Sw(){return"PopulateTimeSlicerLevelMenu"}get vB(){return u.a.FUf}executeCommand(Ha,yb,Xb){Ha=yb.command;switch(Ha){case 2000085697:Ha=
Xb.DOMElement;this.wta=Xb.ChangeLevelCallback;this.wLa=Xb.GetLevelLabelCallback;this.i2a=Xb.CurrentLevel;const wc=Xb.DomEvent;W.g(wc);const Vc=Xb.location;Xb=Xb.levelLabelText;this.zQe=na.DOMElementExtensions.qz(document.activeElement,"iframe")&&Xb?Xb.parentNode:null;Xb=Sys.UI.DomElement.getBounds(Xb);Xb.x=Vc.x;Xb.y=Vc.y;this.J0(wc,Ha,Xb,yb,!0);break;case -649826274:this.wta(0);break;case 149600865:this.wta(1);break;case -2012435159:this.wta(2);break;case -1979934975:this.wta(3);break;case 1634477200:na.DOMElementExtensions.setFocus(this.zQe);
break;default:return da.a(Ha)}return V.Task.Ta(!0)}Ac(Ha,yb,Xb){Ha=!1;switch(yb.command){case 2000085697:Ha=!!Xb;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:Ha=!0}return Ha}J0(Ha,yb,Xb){Ha=Sys.UI.DomElement.getBounds(yb);Xb.x=La.a(this.$).Jh(Xb.x);Xb.y=La.a(this.$).Jh(Xb.y);Ha.x=La.a(this.$).Jh(Ha.x);Ha.y=La.a(this.$).Jh(Ha.y);Ha=new Sys.UI.Point(Ha.x+Xb.x,Ha.y+Xb.y);this.showContextMenu(new Sys.UI.Bounds(Ha.x,Ha.y-Xb.height,Xb.width,Xb.height))}TY(){const Ha=
this.Xa,yb=Ha.Bq(this.menuId),Xb=Ha.Jc();for(let Vc=0;3>=Vc;Vc++){const yd=this.wLa(Vc);var wc=Ae.WTh(Vc);wc=Ha.weh(wc.sch,wc.Er,this.i2a===Vc,Ae.TDe);wc.label=yd;wc.eS(yd);this.i2a===Vc?wc.gS("Image16by16",8,Ae.TDe):wc.W4b();Xb.buttons.push(wc)}yb.uc.push(Xb);return yb}static WTh(Ha){let yb=null;switch(Ha){case 0:yb=new ff(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:yb=new ff(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:yb=new ff(89,"ContextMenu.TimeSlicerLevelMonth",
-2012435159);break;case 3:yb=new ff(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return yb}}Ae.zXj=u.a.wch;Ae.ZLb="TimeSlicerLevelMenuRootName";Ae.TDe=xb.a.Zua;Object(b.a)(Ae,"TimeSlicerLevelMenu",m.a,[]);var pf=a(324),he=a(3),Va=a(53);class bc extends e.a{constructor(Ha){super(Ha)}ld(){const Ha=this.$,yb=ua.a.b2a(Va.b(),this.ka,"Task","IRootUser"),Xb=f.a(Ha);let wc=null;wc=(Od,be)=>{Xb.pZf(wc);yb.setResult(be.o6b)};Xb.Zse(wc);Xb.B7e();const Vc=P.GetServiceTaskFactory.create(Ha.da,102,Ha.ka,this.Na),
yd=Object(Ab.b)("OfficeVSO:7624897_MigrateContextMenuController")?Object(Z.c)(Eb.a.resolve(Wb.i,{Wb:this.Na})):P.GetServiceTaskFactory.Pa(Ha.da,342,338,this.Na);E.TaskExtensions.za(E.TaskExtensions.Md([yb.task,Vc,yd],this.ka),()=>{const Od=Vc.result,be=yb.task.result,Qb=yd.result;this.fd([new Gb(Ha,be,Od,Qb),new F(Ha,be,Od,Qb),new Ib(Ha,be,Od,Qb),new zb(Ha,be,Od,Qb),new Sc(Ha,be,Od,Qb),new fb(Ha,be,Od,Qb),new qd.GridContextMenu(Ha,be,Od,Qb),new Id(Ha,be,Od,Qb),new Yd(Ha,be,Od,Qb),new Ae(Ha,be,Od,
Qb),new Jc(Ha,be,Od,Qb),new ob(Ha,be,Od,Qb),new Mf(Ha,be,Od,Qb),new Je(Ha,be,Od,Qb),new Cd(Ha,be,Od,Qb)])},Ha.ka,3)}static initData(){const Ha=pf.a.I9;Ha(2000085697,20479,0,0);Ha(-227942804,he.a.rc|24576,0,0);Ha(1634477200,he.a.rc|131072,0,0);Ha(-649826274,4095,0,0);Ha(149600865,4095,0,0);Ha(-2012435159,4095,0,0);Ha(-1979934975,4095,0,0);Ha(1247109494,he.a.rc|24576,0,0);Ha(-2064931494,he.a.rc|131072,0,0);Ha(-1396319072,he.a.Ga,128,0);Ha(-425234874,he.a.Ga,128,0);Ha(-1253126584,he.a.Ga,0,0);Ha(274207288,
he.a.rc|24576,0,0);Ha(-1497523576,he.a.rc|131072,0,0);Ha(-498523270,he.a.rc|24576,64,0);Ha(1640762262,he.a.rc|131072,64,0);Ha(-2017893763,he.a.rc|24576,0,0);Ha(1350204367,he.a.rc|131072,0,0);Ha(-889576107,he.a.iw,128,0);Ha(-1170196828,he.a.iw,128,0);Ha(389774337,he.a.iw,128,0);Ha(1529312473,he.a.iw,128,0);Ha(2033235475,he.a.iw,128,0);Ha(-96230454,he.a.iw,128,0);Ha(74086617,he.a.iw,128,0);Ha(563292088,he.a.iw,128,0);Ha(-1092351914,he.a.iw,128,0);Ha(-2141589616,he.a.iw|16384,128,0);Ha(745182485,he.a.iw,
0,0);Ha(359279088,he.a.iw,128,0);Ha(-67292059,he.a.iw,128,0);Ha(926905850,he.a.iw,128,0);Ha(547535945,he.a.iw,128,0);Ha(1374696078,he.a.rc|24576,0,0);Ha(495005930,he.a.rc|212992,0,0);Ha(-1045020714,he.a.rc|24576,0,0);Ha(-170383950,he.a.rc|212992,0,0);Ha(324156914,he.a.Ga,0,0);Ha(-1085236154,he.a.hv,0,0);Ha(-751848458,he.a.il|16384,0,0);Ha(216058793,he.a.hv,0,0);Ha(474690375,he.a.il|16384,0,0);Ha(-1920954846,he.a.rc|24576,0,0);Ha(723126814,he.a.rc|131072,0,0);Ha(2108047455,128,128,0);Ha(-231711729,
128,128,0);Ha(-1909381757,128,128,0);Ha(-814639094,128,128,0);Ha(1701016594,he.a.rc|3072,128,0);Ha(-1475408662,he.a.rc|24576,0,0);Ha(1114549926,he.a.rc|131072,32,0)}static la(Ha){e.a.Rd(10,new bc(Ha))}}Object(b.a)(bc,"ContextMenuCommandHandlerFactory",e.a,[]);var yc=a(228),Hc=a(155),Zc=a(1434),Sd=a(98),ue=a(180);let Fe=class{constructor(Ha,yb){this.gtb=yb;this.$=Ha}dispose(){}xaa(){this.gtb.x3()}MC(){this.gtb.MC()}bWd(Ha,yb,Xb){Pa.i(this.$,Pa.b);this.gtb.showContextMenu(Object(d.a)(new Zc.a,{x:yb.x,
y:yb.y}),Xb,Ha);Sd.EventHandlerManager.instance.Ved()}SAc(Ha,yb,Xb){Pa.i(this.$,Pa.b);this.gtb.showFloatie(Object(d.a)(new Zc.a,{x:yb.x,y:yb.y}),Ha,Xb);ue.a(()=>{Sd.EventHandlerManager.instance.Ved()},this.$.ka)}aWd(Ha,yb,Xb,wc){Pa.i(this.$,Pa.b);this.gtb.aWd(Object(d.a)(new Zc.a,{x:yb.x,y:yb.y}),Ha,Xb,wc)}};Fe=Object(Hc.b)([Object(Eb.d)(Wb.i),Object(Hc.c)(0,Object(Wb.o)()),Object(Hc.c)(1,Object(Wb.G)())],Fe);Object(b.a)(Fe,"ReactContextMenuController",null,[235,3]);class Be extends yc.a{constructor(Ha){super();
this.Cgf=!1;this.epd=()=>{let yb;(yb=this.$.da.Ba(342))?this.qb(yb):this.$.jz(Xb=>{Xb.ghc().then(wc=>{(yb=this.$.da.Ba(342))?this.qb(yb):(yb=new Fe(this.$,wc),this.qb(this.$.da.Ha(342,yb)))})})};this.$=Ha;this.Gb()}dispose(){this.Cgf&&this.$&&this.$.ea.Zm(this.epd);super.dispose()}create(){this.$.ea.Kf?(h.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.Kf}`),this.epd(null,null)):(this.Cgf=!0,this.$.ea.Zj(this.epd))}static la(Ha){Object(Ab.b)("OfficeVSO:7624897_MigrateContextMenuController")||
Ha.da.Ha(338,new Be(Ha))}}Object(b.a)(Be,"ContextMenuControllerFactory",yc.a,[]);var Ua=a(166);class Rb{constructor(){this.dictionary=this.Ud=null}}Object(b.a)(Rb,"RibbonCommandParams",null,[]);class sc{constructor(){this.menuModel=null;this.rLe=0}}Object(b.a)(sc,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class Mc{constructor(){this.cgc={}}iUh(Ha){return(Ha=this.cgc[Ha.toString()])?Ha.menuModel:null}f3g(Ha,yb){this.cgc[yb.toString()]=Object(d.a)(new sc,{menuModel:Ha,rLe:Ga.HelperMethods.Lb()})}P9b(Ha){this.cgc[Ha.toString()]=
null}l9h(Ha){return(Ha=this.cgc[Ha.toString()])?Ha.rLe:-1}}Object(b.a)(Mc,"FilterMenuCache",null,[]);var id=a(13),Ed=a(188),ee=a(229);class oe{constructor(){this.gd=this.rye=this.cell=null}}Object(b.a)(oe,"AutoFilterEventRegistrationArgs",null,[]);class Xe{constructor(Ha){this.T_a=null;this.xVd=!1;this.lEb=0;this.wbd=1;this.RSe=0;this.hHb=yb=>{this.XSf(yb.domElement,yb.hashCode)};this.TWf=yb=>{let Xb=0;for(;window.performance.now()-yb<this.uxh&&0<this.T_a.length;)this.cre(this.T_a.shift()),Xb++;h.ULS.sendTraceTag(537167052,
1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.wbd}, Events Registered in this frame: ${Xb}, Events in queue: ${this.T_a.length}`);0<this.T_a.length?this.lEb=window.requestAnimationFrame(this.TWf):(yb=window.performance.now()-this.RSe,h.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.wbd}, Total time in MS: ${yb}`),this.wbd++,this.lEb=0)};this.onPointerDown=yb=>{ed.a.slim(yb.Ea.rawEvent);return!1};
this.$=Ha;this.gridView=fa.h(this.$);this.Eji();this.uxh=10}dispose(){window.cancelAnimationFrame(this.lEb);this.gridView&&this.gridView.yNd(this.hHb);this.gridView=null}Eji(){if(this.xVd=Ga.HelperMethods.l8a)this.T_a=[];this.gNg();this.gridView.HYc(this.hHb)}gNg(){for(const Ha of this.gridView.Cn){const yb=Ha.aDa;for(let Xb in yb){const wc=yb[Xb];this.XSf(wc.domElement,wc.hashCode)}}}XSf(Ha,yb){if(fa.h(this.$).Ca.fm.S2a(yb))if(Ha){Ha=Ha.querySelectorAll('[id^="'+u.a.oZe+'"]');for(let Vc=0;Vc<Ha.length;Vc++){var Xb=
Ha[Vc],wc=Xb.getAttribute(u.a.qKh);const yd=Xb.getAttribute(u.a.iKh);h.ULS.shipAssertTag(537167053,0,!!wc&&!!yd,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${Xb.id}, BlockHash: ${yb}`);wc=Kb.Range.Hc(parseInt(wc,10),parseInt(yd,10));Xb=Object(d.a)(new oe,{cell:wc,rye:Xb,gd:yb});this.xVd?(this.T_a.push(Xb),this.lEb||(this.RSe=window.performance.now(),this.lEb=window.requestAnimationFrame(this.TWf))):
this.cre(Xb)}}else h.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${yb}`);else h.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${yb}`)}cre(Ha){const yb=this.gridView.Ca.awa(Ha.cell,Ha.gd);yb?this.fNg(Ha.rye,yb):h.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${Ha.gd}, AutoFilter Cell: ${Ha.cell}`)}fNg(Ha,
yb){yb.hasAutoFilter?this.iLg(Ha,yb.bwb):yb.x4?this.dNg(Ha,yb.bwb,yb.rtd):h.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Ua.a.instance.ta(id.a.uf,Ha,this.onPointerDown);Ed.a.instance.ta(id.a.aza,Ha,this.onPointerDown)}iLg(Ha,yb){ee.a.instance.ta(id.a.click,Ha,Xb=>{yb&&ed.a.hrc(Xb.Ea.rawEvent,966232027,yb,null);return!0})}dNg(Ha,yb,Xb){const wc=A.a.Yh(yb);ee.a.instance.ta(id.a.click,Ha,Vc=>
{Xb?ed.a.spf(document.getElementById(wc.EwaElementId),wc.Cell,wc.DataSourceIndex,wc.FieldId,wc.IsOlap,wc.RequiresConfirmation,Vc.Ea.rawEvent,wc.OptionalPivotMenuAnchor):ed.a.spfm(Vc.Ea.rawEvent,wc.RequiresConfirmation,wc.Cell,wc.DataSourceIndex,wc.PivotName,wc.OptionalPivotMenuAnchor);return!1})}}Object(b.a)(Xe,"FilterMenuPointerEventsManager",null,[3]);class mf{constructor(Ha){this.qZe=null;this.$=Ha;this.k$a=new Mc;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
(this.qZe=new Xe(this.$))}dispose(){U.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.qZe.dispose();this.$=null}y_h(Ha){if(!fa.h(this.$).fD){const yb=fa.h(this.$).Ca.Bha(Ha,this.$.activeItemName);if(yb&&yb.blockPresentInViewportTimeStamp>this.k$a.l9h(Ha.left))return yb.es(Ha).autoFilterMenu}return this.k$a.iUh(Ha.left)}oZi(Ha,yb,Xb){this.k$a&&(Ha=fa.h(this.$).fD?Ha.qye[yb].Menu:Ha.menuModel[yb],this.k$a.f3g(Ha,
Xb))}pZi(Ha){this.k$a&&this.k$a.P9b(Ha)}}Object(b.a)(mf,"FilterMenuManager",null,[257,3]);var wf=a(210),Kf=a(175);class af{constructor(Ha,yb,Xb){this.sBc={};this.Ld=!1;this.$l=(wc,Vc=null)=>{this.showContextMenu(Vc)};this.RDf=(wc,Vc)=>{Vc.DMi===af.dbi&&fa.h(this.$).focus()};this.qD=(wc,Vc)=>{wc=this.$.Ia.j4(Vc.Ud.command);(null===wc||void 0===wc?0:wc.dismissesContextualUI)&&this.x3()};this.l6=()=>{Object(Ab.b)("OfficeVSO:7624897_MigrateContextMenuController")?Eb.a.remove(Wb.i):this.$.da.vU(342);E.TaskExtensions.za(Object(Ab.b)("OfficeVSO:7624897_MigrateContextMenuController")?
Object(Z.c)(Eb.a.resolve(Wb.i,{Wb:3})):P.GetServiceTaskFactory.create(this.$.da,338,this.$.ka,3),wc=>{wc=wc.result;for(let Vc of this.sBc)Vc.BWf(wc)},this.$.ka)};this.$=Ha;this.contextMenuController=Xb;this.W$d=new mf(this.$);Ha.da.Ha(8,this);for(Xb=0;Xb<yb.length;Xb++)this.sBc[af.xch[Xb]]=yb[Xb];this.ha=fa.h(Ha).ha;this.ha.D0b(this.$l);this.$.Ia.OZa(this.RDf);Ua.a.instance.FGj();U.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ia.Gsa(this.qD);
U.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.x2(this.l6)}get ebc(){return this.W$d}Wgd(Ha){return ea.a.Ic(this.sBc,Ha)}dispose(){this.Ld?h.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ld=!0,this.$&&(this.$.em(af.od),this.$.da.vU(8),this.ha&&this.ha.Hvc(this.$l),this.$.Ia.TKb(this.RDf),U.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&
this.$.Ia&&this.$.Ia.Ena(this.qD),U.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.Z6(this.l6)),this.$=this.ha=null,this.ebc.dispose(),this.sBc=this.W$d=null)}showContextMenu(Ha,yb=null,Xb=null){this.KLj(Ha)&&(Pa.i(this.$,Pa.j),Ha=this.Nfh(Ha,yb,Xb),this.$.Ia.Hb(Ha.Ud,Ha.dictionary))}x3(){this.contextMenuController?this.contextMenuController.xaa():h.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}KLj(Ha){return Md.a(this.$).Tp()?
(h.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Md.a(this.$).rW(Kf.a.grid,wf.a.showContextMenu),!1):!this.$.Ia.THh&&(!Ha||Ha.Ob!==fa.h(this.$).domElement&&!He.a.equals(Ha.Ob.tagName,"INPUT",!0))}Nfh(Ha,yb=null,Xb=null){Xb={["eventArgs"]:Ha,["creationParams"]:Xb};Ha=Ha?Ha.wb:-1;const wc=this.ha.Sa.jc;let Vc=1441131127;wc?(yb=wc.floatingObject,h.ULS.shipAssertTag(537167059,0,!!yb,"floatingObj shouldn't be null."),
af.Bud(yb)?Vc=1312363469:af.isPivotChart(yb)?(Xb[F.m3c]=yb?yb.ed:null,Vc=-149612405):Vc=-1372040782):af.lnf(yb)?(Xb[F.m3c]=yb,Vc=-149612405):!Pa.h(this.$)&&Pa.f(fa.h(this.$))&&(Vc=671488277);yb=new J.a(Vc,Ha,this.$.xc,30,null);return Object(d.a)(new Rb,{Ud:yb,dictionary:Xb})}static la(Ha){Ha.hl(af.od)}static isPivotChart(Ha){return!!Ha&&0===Ha.type&&af.lnf(Ha.ed)}static Bud(Ha){return!!Ha&&2===Ha.type}static lnf(Ha){return!!Ha&&!!(Ha.Attributes&4)}}af.xch="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
af.dbi="GridContextMenu";af.od=Ha=>{(Ha=Object(Ja.a)(9,Ha))&&P.GetServiceTaskFactory.create(Ha.da,9,Ha.ka,0)};Object(b.a)(af,"ContextMenuManager",null,[236,3]);class Wf extends yc.a{constructor(Ha){super();this.$=Ha;this.Gb()}create(){const Ha=this.$,yb=Ha.ic;if(yb.allowSelection||yb.allowEdits||yb.allowFiltering||yb.allowSorting||yb.allowPivotSpecificOperations){const Xb=P.GetServiceTaskFactory.create(Ha.da,10,Ha.ka,this.Na),wc=Object(Ab.b)("OfficeVSO:7624897_MigrateContextMenuController")?Object(Z.c)(Eb.a.resolve(Wb.i,
{Wb:this.Na})):P.GetServiceTaskFactory.Pa(Ha.da,342,338,this.Na);E.TaskExtensions.za(E.TaskExtensions.Md([Xb,wc],this.ka),()=>{this.qb(t.a(Ha)||new af(Ha,Xb.result,wc.result))},this.$.ka,3)}else h.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),Ha.da.vU(8),this.qb(null)}static la(Ha){Ha.da.Ha(9,new Wf(Ha))}}Object(b.a)(Wf,"ContextMenuManagerFactory",yc.a,[]);var Gf=a(9);a.d(B,"a",function(){return cg});
const cg=()=>{bc.initData();Gf.a.Fa(Ha=>{Be.la(Ha);Wf.la(Ha);bc.la(Ha);af.la(Ha)})};String(c);window.___1678693007844_closurehack=c},1186:function(r,B,a){var c=a(9);r=a(0);var b=a(714),e=a(15);const f=ja=>{switch(ja){case 0:ja="Between";break;case 1:ja="NotBetween";break;case 2:ja="Equal";break;case 3:ja="NotEqual";break;case 4:ja="GreaterThan";break;case 5:ja="LessThan";break;case 6:ja="GreaterThanOrEqual";break;case 7:ja="LessThanOrEqual";break;default:ja="Unknown"}return ja},d=ja=>{switch(ja){case 0:ja=
"AnyValue";break;case 1:ja="WholeNumber";break;case 2:ja="Decimal";break;case 3:ja="List";break;case 4:ja="Date";break;case 5:ja="Time";break;case 6:ja="TextLength";break;case 7:ja="Custom";break;default:ja="Unknown"}return ja};var h=a(132),l=a(44),k=a(379),w=a(198),n=a(291);class x{constructor(ja=null,la=!1){this.d5=ja?ja.IsIgnoreBlank:!0;this.e5=ja?ja.IsInCellDropDown:!0;this.JN=!ja||la&&3!==ja.RuleType?"":ja.LowerBoundary;this.KN=!ja||la&&3!==ja.RuleType?"":ja.UpperBoundary;this.Sz=ja?ja.ConditionType:
0;this.ruleType=la?3:ja?ja.RuleType:0;this.WZ=ja?ja.IsAlertBlocking:!0;this.MT=ja?ja.AlertTitle:"";this.KT=ja?ja.AlertMessage:"";this.qV=ja?ja.InputMessage:"";this.qF=ja?ja.InputTitle:"";this.s5=ja?ja.IsShowErrorAlert:!0;this.t5=ja?ja.IsShowInputMessage:!0;this.Jlf=la}isEqual(ja){return ja?this.d5===ja.d5&&this.e5===ja.e5&&this.JN===ja.JN&&this.KN===ja.KN&&this.Sz===ja.Sz&&this.ruleType===ja.ruleType&&this.WZ===ja.WZ&&this.MT===ja.MT&&this.KT===ja.KT&&this.qV===ja.qV&&this.qF===ja.qF&&this.s5===ja.s5&&
this.t5===ja.t5:(e.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(r.a)(x,"DataValidationEditDialogState",null,[]);var m=a(255),u=a(196),t=a(290),y=a(21),v=a(133),A=a(53),z=a(58);class C{constructor(ja,la){this.Ey=this.Jia=this.selectedRanges=null;this.eQe=!1;this.ai=null;this.GXi=ua=>{this.OFf(ua);this.DQf(!0)};this.HXi=ua=>{this.OFf(ua);this.DQf(!1)};this.ZHh=ua=>{this.Qz("DataValidationEdit.ExpandExistingDialog",ua);this.Ey.c=C.aZ(ua);
1===ua?this.caa(new x(this.Jia)):2===ua?this.caa(new x):this.jnc()};this.$Hh=ua=>{this.Qz("DataValidationEdit.ExpandExistingListDialog",ua);this.Ey.c=C.aZ(ua);1===ua?this.caa(new x(this.Jia,!0)):2===ua?this.caa(new x(null,!0)):this.jnc()};this.D7i=ua=>{this.Qz("DataValidationEdit.OverrideExistingDialog",ua);this.Ey.c=C.aZ(ua);1===ua?this.caa(new x):this.jnc()};this.KNf=ua=>{this.Qz("DataValidationEdit.OverrideExistingListDialog",ua);this.Ey.c=C.aZ(ua);1===ua?this.caa(new x(null,!0)):this.jnc()};this.$=
ja;this.u2a=la}Mc(){return!1}executeCommand(ja,la){-1728432249!==la.command&&739109630!==la.command&&u.a(la.command);this.selectedRanges=l.r(y.h(this.$).ha.ra.selectedRanges,this.$);y.h(this.$).oTa(!0);this.getDataValidationInitialState(la.command);this.ai=this.$.Mb.Kc("UserAction","DataValidationEditTimeToDialogOpen");this.eQe?e.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(e.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),
this.eQe=!0);return z.Task.Ta(!0)}Ac(ja,la){return-1728432249===la.command||739109630===la.command}Rc(){return!1}getDataValidationInitialState(ja=null){const la=this.$.pa.va.$b(),ua=739109630===ja;k.a(this.$.userOperationManager,(eb,Eb,Wb)=>n.g(this.$.pa.va,this.selectedRanges,t.b(eb,ua?this.GXi:this.HXi),t.a(Eb),Wb,la),eb=>new w.a(120,0,eb,16),null)}OFf(ja){e.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ja||m.a(ja)?e.ULS.sendTraceTag(537163283,
0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):this.Jia=ja.Result}DQf(ja=!1){var la=this.Ey={};let ua;switch(this.Jia.Command){case 0:ua="CreateNew";break;case 1:ua="CreateNewFromRule";break;case 2:ua="ExpandExisting";break;case 3:ua="OverrideExisting";break;default:ua="Unknown"}la.a=ua;this.ai&&(this.ai.stop(),this.Ey.r=this.ai.id);switch(this.Jia.Command){case 0:this.Ey.b=!1;this.Ey.c="None";this.caa(new x(null,ja));break;
case 1:this.Ey.b=!1;this.Ey.c="None";ja&&this.Jia&&3!==this.Jia.RuleType?this.u2a.VIe(this.$,this.KNf):this.caa(new x(this.Jia,!1));break;case 2:this.Ey.b=!0;ja?this.u2a.Feh(this.$,this.$Hh):this.u2a.Geh(this.$,this.ZHh);break;case 3:this.Ey.b=!0;ja?this.u2a.VIe(this.$,this.KNf):this.u2a.Ieh(this.$,this.D7i);break;default:e.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}caa(ja){this.u2a.caa(this.$,this.selectedRanges,ja,this.Jia.Command);
this.cJi(ja)}cJi(ja){C.Cub(ja,this.Ey);this.Ey.d=!0;A.b().Ze(48,this.Ey,!0)}jnc(){this.Ey.d=!1;A.b().Ze(48,this.Ey,!0)}Qz(ja,la){ja={["ButtonType"]:C.aZ(la),["DialogName"]:ja,["Location"]:"dialog",["NumberOfSelectedRanges"]:y.h(this.$).ha.ra.nD};v.b(this.$).qd(h.a.Aub,ja)}static Cub(ja,la){la.e=d(ja.ruleType);la.f=f(ja.Sz);la.g=!!ja.JN;la.h=!!ja.KN;la.i=ja.d5;la.j=ja.e5;la.k=ja.t5;la.l=!!ja.qF;la.m=!!ja.qV;la.n=ja.s5;la.o=ja.WZ;la.p=!!ja.MT;la.q=!!ja.KT}static aZ(ja){switch(ja){case 1:return"Yes";
case 2:return"No";case 0:return"Cancel";default:return e.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(r.a)(C,"DataValidationEditCommandHandler",null,[222]);var H=a(141),I=a(819),S;(function(ja){ja[ja.between=0]="between";ja[ja.notBetween=1]="notBetween";ja[ja.equal=2]="equal";ja[ja.notEqual=3]="notEqual";ja[ja.greaterThan=4]="greaterThan";ja[ja.lessThan=5]="lessThan";ja[ja.greaterThanOrEqual=6]="greaterThanOrEqual";
ja[ja.lessThanOrEqual=7]="lessThanOrEqual"})(S||(S={}));Object(r.b)("DataValidationRuleConditionType",S);var P=a(1115),D=a(156),G=a(185);class E{static get qg(){return D.a.Iq(E.Ql,"")}static get NNe(){return D.a.Iq(E.Uph,G.a.ga(1670),G.a.ga(1685),G.a.ga(1686),G.a.ga(1687),G.a.ga(1688),G.a.ga(1689),G.a.ga(1690),G.a.ga(1691),G.a.ga(1692),G.a.ga(1671),G.a.ga(1695),G.a.ga(1696),G.a.ga(1697),G.a.ga(1698),G.a.ga(1699),G.a.ga(1700),G.a.ga(1701),G.a.ga(1702),G.a.ga(1672),G.a.ga(1673),G.a.ga(1693),G.a.ga(1694),
G.a.ga(1684),"255")}static get RNe(){return D.a.Iq(E.Vph,G.a.ga(1707),G.a.ga(1711),G.a.ga(1712),"255","32")}static get UNe(){return D.a.Iq(E.Wph,G.a.ga(1706),G.a.ga(1709),G.a.ga(1708),G.a.ga(1710),G.a.ga(1711),G.a.ga(1712),"255","32")}}E.Ygg=255;E.Ql="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";E.Uph="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
E.Vph="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
E.Wph="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(r.a)(E,"DataValidationEditDialogHtml",null,[]);var O=a(90),N=a(560),J=a(13),W=a(197),ea=a(242),R=a(12),Y=a(14),U=a(1);class da extends ea.a{constructor(ja,la,ua,eb){super(la);this.GGd=this.dsc=this.gQa=this.Rab=this.xOa=this.M6a=this.Pza=this.Oza=this.PK=this.NT=this.Ygc=this.Vwa=null;this.SLh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.Ryj=[[12,12],[1,1],[1,1],[12,12],[6,
6],[9,9],[1,1],[12,12]];this.Dqc=Eb=>{let Wb=!1;(null===Eb||void 0===Eb?0:Eb.Ea)&&(Eb.Ea.keyCode===O.a.cfa||Eb.Ea.keyCode===O.a.Sh)&&(Wb=this.$ca(Eb),this.NT.blur(),this.PK.blur());return Wb};this.$ca=()=>{const Eb=this.NT.selectedIndex,Wb=this.PK.selectedIndex;this.dsc.innerText=this.Rxb(Eb,Wb);this.GGd.innerText=this.ikd(Eb,Wb);switch(Eb){case 0:return this.PK.disabled=!0,R.DOMElementExtensions.setVisible(this.Rab,!1),R.DOMElementExtensions.setVisible(this.gQa,!1),R.DOMElementExtensions.setVisible(this.M6a,
!1),R.DOMElementExtensions.setVisible(this.xOa,!1),this.Vwa.disabled=!0,!1;case 3:return this.PK.disabled=!0,R.DOMElementExtensions.setVisible(this.Rab,!0),R.DOMElementExtensions.setVisible(this.gQa,!1),R.DOMElementExtensions.setVisible(this.M6a,!0),R.DOMElementExtensions.setVisible(this.xOa,!0),this.Vwa.disabled=!1;case 7:return this.PK.disabled=!0,R.DOMElementExtensions.setVisible(this.Rab,!0),R.DOMElementExtensions.setVisible(this.gQa,!1),R.DOMElementExtensions.setVisible(this.M6a,!1),R.DOMElementExtensions.setVisible(this.xOa,
!1),this.Vwa.disabled=!1;default:this.Vwa.disabled=!1,R.DOMElementExtensions.setVisible(this.Rab,!0),R.DOMElementExtensions.setVisible(this.xOa,!1)}switch(Wb){case 0:case 1:R.DOMElementExtensions.setVisible(this.gQa,!0);break;default:R.DOMElementExtensions.setVisible(this.gQa,!1)}this.PK.disabled=!1;this.dsc.disabled=!1;R.DOMElementExtensions.setVisible(this.M6a,!1);R.DOMElementExtensions.setVisible(this.xOa,!1);return!1};this.get_visible=this.Aka;this.set_visible=this.poa;this.lR=new W.a;this.lR.add(Y.a.instance.ga(1672));
this.lR.add(Y.a.instance.ga(1673));this.lR.add(Y.a.instance.ga(1676));this.lR.add(Y.a.instance.ga(1674));this.lR.add(Y.a.instance.ga(1675));this.lR.add(Y.a.instance.ga(1677));this.lR.add(Y.a.instance.ga(1678));this.lR.add(Y.a.instance.ga(1679));this.lR.add(Y.a.instance.ga(1680));this.lR.add(Y.a.instance.ga(1681));this.lR.add(Y.a.instance.ga(1682));this.lR.add(Y.a.instance.ga(1683));this.lR.add("");this.$=ja;this.Mk=ua;this.Vka(eb)}get title(){return Y.a.instance.ga(1703)}get Uah(){return this.NT.selectedIndex}vBa(ja){this.NT.selectedIndex=
ja.ruleType;this.PK.selectedIndex=ja.Sz;this.Ygc.checked=ja.e5;this.Vwa.checked=ja.d5;this.Oza.value=ja.JN;this.Pza.value=ja.KN;this.$ca(null)}xrb(ja){ja.d5=this.Vwa.checked;ja.e5=this.Ygc.checked;ja.Sz=this.PK.selectedIndex;ja.ruleType=this.NT.selectedIndex;ja.JN=this.Oza.value;ja.KN=this.Pza.value}dispose(){this.Xj();this.Mk=this.GGd=this.dsc=this.gQa=this.Rab=this.xOa=this.M6a=this.Ygc=this.Pza=this.Oza=this.PK=this.NT=this.Vwa=null;super.dispose()}render(ja){ja.appendChild(this.domElement)}Aka(){return this.isVisible}poa(ja){return this.isVisible=
ja}setFocus(){}Rxb(ja,la){return this.w7e(ja,la,this.SLh)}ikd(ja,la){return 0!==la&&1!==la?"":this.w7e(ja,la,this.Ryj)}Vka(ja){U.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:7126092_ReduceInnerHTMLUsageForDataValidationEditConditionsControl")?ja.jh(this.domElement,E.NNe):this.domElement.innerHTML=E.NNe;this.Vwa=R.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.NT=R.DOMElementExtensions.getElementById(this.domElement,
"allowConditionSelectionId");this.PK=R.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Oza=R.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Pza=R.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.dsc=R.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.GGd=R.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.M6a=R.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownDivId");this.xOa=R.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.Rab=R.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.gQa=R.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Ygc=R.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Gj()}w7e(ja,la,ua){return ua.length<ja||ua[ja].length<la?(e.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${ja} operatorOption=${la}, cannot get label.`),
""):this.lR.ma(ua[ja][la])}Gj(){N.a.instance.ta(J.a.Vb,this.NT,this.Dqc);N.a.instance.ta(J.a.Vb,this.PK,this.Dqc);N.a.instance.ta(J.a.change,this.NT,this.$ca);N.a.instance.ta(J.a.change,this.PK,this.$ca);N.a.instance.ta(J.a.change,this.PK,this.Mk);N.a.instance.ta(J.a.change,this.NT,this.Mk);N.a.instance.ta(J.a.change,this.Oza,this.Mk);N.a.instance.ta(J.a.Vb,this.Oza,this.Mk);N.a.instance.ta(J.a.change,this.Pza,this.Mk);N.a.instance.ta(J.a.Vb,this.Pza,this.Mk)}Xj(){N.a.instance.Aa(J.a.Vb,this.NT,this.Dqc);
N.a.instance.Aa(J.a.Vb,this.PK,this.Dqc);N.a.instance.Aa(J.a.change,this.NT,this.$ca);N.a.instance.Aa(J.a.change,this.PK,this.$ca);N.a.instance.Aa(J.a.change,this.PK,this.Mk);N.a.instance.Aa(J.a.change,this.NT,this.Mk);N.a.instance.Aa(J.a.change,this.Oza,this.Mk);N.a.instance.Aa(J.a.Vb,this.Oza,this.Mk);N.a.instance.Aa(J.a.change,this.Pza,this.Mk);N.a.instance.Aa(J.a.Vb,this.Pza,this.Mk)}static Vja(){let ja;return ja=new W.a,ja.add("operatorInputId1"),ja.add("operatorInputId2"),ja}}Object(r.a)(da,
"DataValidationEditConditionsControl",ea.a,[296,3,297]);var T=a(63);const ka=(ja,la,ua,eb,Eb,Wb,Ab,Jb=null)=>{Jb=ja.Oa(9,Jb);Jb.selectedRanges=la;Jb.ruleOptions=ua;return T.g(ja,"CreateOrEditDataValidation",Jb,eb,Eb,Wb,Ab,0)};var L=a(29),fa=a(22),wa=a(184),oa=a(33),xa=a(150),bb=a(127);class Za extends I.a{constructor(ja,la,ua,eb){super(ja);this.qRd=this.nwb=null;this.bOa=this.disposed=this.ila=!1;this.ai=null;this.T9j=(Eb,Wb)=>{let Ab;this.ldc(Eb);if(({errorString:Eb,Fq:Ab}=this.Y2d()).returnValue)return this.GMa(121,
this.OWh(this.$,Wb),0,this.i5,!1),"";this.wca("OkInvalidByClient",Ab);return Eb};this.S8c=Eb=>{this.Qz(Eb,Za.aZ(Eb));this.ai=this.$.Mb.Kc("UserAction","DataValidationEditTimeToDialogTryClose");0===Eb&&this.Gma()};this.selectedRanges=la;this.kUb=ua;this.command=eb;3===eb&&(this.ila=!0);this.Rb=2;this.nx=!1}get nd(){return this.kUb}get pc(){return"DataValidationEditDialog"}LWd(){var ja={["RuleType"]:this.nd.ruleType,["RuleOperatorType"]:this.nd.Sz,["OperatorInput1"]:this.nd.JN,["OperatorInput2"]:this.nd.KN,
["IsIgnoreBlank"]:this.nd.d5,["IsInCellDropDown"]:this.nd.e5,["IsAlertBlocking"]:this.nd.WZ,["AlertTitle"]:this.nd.MT,["AlertMessage"]:this.nd.KT,["InputTitle"]:this.nd.qF,["InputMessage"]:this.nd.qV,["IsShowErrorAlert"]:this.nd.s5,["IsShowInputMessage"]:this.nd.t5};this.wc(2,Y.a.instance.ga(1669));ja={[Za.pt]:this.pc,["validateDialogValues"]:this.T9j,["RangePickerController"]:y.h(this.$).Ng.E5a(),["isModal"]:!1,["bodyProps"]:ja};this.initializeAndShow(Y.a.instance.ga(1668),this.S8c,ja);e.ULS.sendTraceTag(537163278,
0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||(super.dispose(),this.disposed=!0)}get n4b(){return 3===this.nd.ruleType}Vja(){return da.Vja()}OWh(ja,la){return(ua,eb,Eb)=>{const Wb=ja.pa.va.$b();return ka(this.$.pa.va,this.selectedRanges,this.j1g(),this.W0a(ua,this.fEd(la)),t.a(eb),Eb,Wb)}}fEd(ja){return la=>{e.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let ua;if(m.a(la))e.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${la?
L.a.qc(la.Errors):null}.`),la.Errors&&1===la.Errors.length&&((ua=this.jhd(la.Errors[0].MessageId))?this.wca("OkInvalidByServer",la.Errors[0].MessageIdName):(this.wca("OkValid","None"),this.hide()),ja(ua)),e.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${L.a.qc(la.Errors)}`);else{if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:7539608_DataValidationListCommitTelemetry")){if("list"===this.nd.ruleType||3===this.nd.ruleType)la=
[],la.push(bb.a.mh("IsInsertDropdownButton",this.nd.Jlf.toString(),1)),xa.b("InsertDropdownCommitted",void 0,void 0,void 0,void 0,la);this.wca("NoError","None")}this.hide()}}}j1g(){const ja={};ja.Command=this.command;ja.RuleType=this.nd.ruleType;ja.ConditionType=this.nd.Sz;ja.IsIgnoreBlank=this.nd.d5;ja.IsInCellDropDown=this.nd.e5;ja.LowerBoundary=this.nd.JN;ja.UpperBoundary=this.nd.KN;ja.IsAlertBlocking=this.nd.WZ;ja.IsShowErrorAlert=this.nd.s5;ja.IsShowInputMessage=this.nd.t5;ja.AlertTitle=this.nd.MT;
ja.AlertMessage=this.nd.KT;ja.InputTitle=this.nd.qF;ja.InputMessage=this.nd.qV;ja.ShouldIgnoreFormulaError=this.bOa;return ja}jhd(ja){switch(ja){case 1173235830:return Y.a.instance.ga(1721);case 43935303:return Y.a.instance.ga(1722);case -1323438439:return Y.a.instance.ga(1724);case 2112020473:return Y.a.instance.ga(1718);case -219503282:return Y.a.instance.ga(1719);case 1689335445:return Y.a.instance.ga(1720);case 2146493810:return Y.a.instance.ga(1723);case -2104909922:return String.format(Y.a.instance.nb(105),
this.nwb,this.qRd);case -869372599:return String.format(Y.a.instance.nb(104),this.nwb);case -885132625:return Y.a.instance.ga(1716);case -1181828368:return Y.a.instance.ga(1726);case -758480861:return Y.a.instance.ga(1727);case -13729088:return Y.a.instance.ga(1728);case -846654055:return Y.a.instance.ga(1729);case 751854001:return Y.a.instance.ga(1730);case -453846397:return Y.a.instance.ga(1731);case 1102013489:return Y.a.instance.ga(1732);case 835813260:return oa.a.zsd()?Y.a.instance.ga(1734):
Y.a.instance.ga(1733);case 1577787509:return Y.a.instance.ga(1735);case 2083564019:return Y.a.instance.ga(1725);default:e.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${ja.toString()}.`)}return null}Gma(){this.wca("Cancel","None")}Qz(ja,la){e.ULS.sendTraceTag(537163273,0,50,`DataValidationEditDialog ${1===ja?"Ok":"Cancel"} was clicked.`);ja={["ButtonType"]:la,["DialogName"]:this.pc,["Location"]:"dialog",["NumberOfSelectedRanges"]:y.h(this.$).ha.ra.nD};
v.b(this.$).qd(h.a.Aub,ja)}wca(ja,la){const ua={};Za.Cub(this.nd,ua);ua.n=this.ila;ua.o=ja;ua.p=la;this.ai&&(this.ai.stop(),ua.q=this.ai.id);ua.r=this.nd.Jlf;A.b().Ze(49,ua,!0)}ldc(ja){this.nd.ruleType=ja.RuleType;this.nd.Sz=ja.RuleOperatorType;this.nd.JN=ja.OperatorInput1;this.nd.KN=ja.OperatorInput2;this.nd.WZ=ja.IsAlertBlocking;this.nd.s5=ja.IsShowErrorAlert;this.nd.MT=ja.AlertTitle;this.nd.KT=ja.AlertMessage;this.nd.t5=ja.IsShowInputMessage;this.nd.qF=ja.InputTitle;this.nd.qV=ja.InputMessage;
this.nd.d5=ja.IsIgnoreBlank;this.nd.e5=ja.IsInCellDropDown;this.nwb=ja.firstOperatorLabel;this.qRd=ja.secondOperatorLabel}DRb(ja,la,ua){let eb,Eb;Eb=eb=null;if(!ja)return ua?(eb=String.format(Y.a.instance.nb(105),this.nwb,this.qRd),Eb="DataValidationEditNoMinMaxError"):oa.a.zsd()&&3===la?(eb=Y.a.instance.ga(1716),Eb="DataValidationEditNoValueListError"):(eb=String.format(Y.a.instance.nb(104),this.nwb),Eb="DataValidationEditNoValueError"),{returnValue:!1,errorString:eb,Fq:Eb};if(ja.length>E.Ygg)return eb=
Y.a.instance.ga(1725),{returnValue:!1,errorString:eb,Fq:Eb};if(wa.d(ja))return{returnValue:!0,errorString:eb,Fq:Eb};if(1===la||2===la||6===la){if(!fa.a.k5(ja))return eb=Y.a.instance.ga(1718),{returnValue:!1,errorString:eb,Fq:Eb};if(1===la&&!fa.a.isInteger(ja))return eb=Y.a.instance.ga(1719),{returnValue:!1,errorString:eb,Fq:Eb};if(6===la){if(!fa.a.isInteger(ja))return eb=Y.a.instance.ga(1719),{returnValue:!1,errorString:eb,Fq:Eb};if(0>parseInt(ja,10))return eb=Y.a.instance.ga(1720),{returnValue:!1,
errorString:eb,Fq:Eb}}}return{returnValue:!0,errorString:eb,Fq:Eb}}Y2d(){let ja,la;la=ja=null;const ua=this.nd.JN,eb=this.nd.KN,Eb=P.a[this.nd.ruleType];var Wb=S[this.nd.Sz];if(0===Eb)return{returnValue:!0,errorString:ja,Fq:la};Wb=(0===Wb||1===Wb)&&3!==Eb&&7!==Eb;return!({errorString:ja,Fq:la}=this.DRb(ua,Eb,Wb)).returnValue||Wb&&!({errorString:ja,Fq:la}=this.DRb(eb,Eb,Wb)).returnValue?{returnValue:!1,errorString:ja,Fq:la}:Wb&&(1===Eb||2===Eb||6===Eb)&&!wa.d(ua)&&!wa.d(eb)&&parseFloat(ua)>parseFloat(eb)?
(ja=Y.a.instance.ga(1723),{returnValue:!1,errorString:ja,Fq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:ja,Fq:la}}static aZ(ja){switch(ja){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Cub(ja,la){U.EwaSettings.isChangeGateEnabled("OfficeVSO:7539608_DataValidationListCommitTelemetry")?(la.a=ja.ruleType,la.b=ja.Sz):
(la.a=d(ja.ruleType),la.b=f(ja.Sz));la.c=!!ja.JN;la.d=!!ja.KN;la.e=ja.d5;la.f=ja.e5;la.g=ja.t5;la.h=!!ja.qF;la.i=!!ja.qV;la.j=ja.s5;la.k=ja.WZ;la.l=!!ja.MT;la.m=!!ja.KT}}Object(r.a)(Za,"DataValidationEditDialog",I.a,[]);var La=a(91);I=a(272);class va{}va.Dmh="DataValidationDialogPanel";va.Cmh="DataValidationButtonPanel";va.Bmh="DataValidationButtonClearAll";Object(r.a)(va,"CssClassNames",null,[]);class Ba extends ea.a{constructor(ja,la,ua){super(ja);this.Jba=this.Kba=this.Iba=null;this.Fqc=()=>{this.Iba.checked?
(this.Kba.disabled=!1,this.Jba.disabled=!1):(this.Kba.disabled=!0,this.Jba.disabled=!0);return!1};this.get_visible=this.Aka;this.set_visible=this.poa;this.Mk=la;this.Vka(ua)}get title(){return Y.a.instance.ga(1705)}render(ja){ja.appendChild(this.domElement)}Aka(){return this.isVisible}poa(ja){return this.isVisible=ja}setFocus(){}dispose(){this.Xj();this.Mk=this.Kba=this.Jba=this.Iba=null;super.dispose()}Vka(ja){U.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:7126093_ReduceInnerHTMLUsageForDataValidationEditInputControl")?
ja.jh(this.domElement,E.RNe):this.domElement.innerHTML=E.RNe;this.Iba=R.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");R.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.Kba=R.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.Jba=R.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.Iba.checked=!0;this.Gj();this.Fqc(null)}vBa(ja){this.Kba.value=void 0===ja.qF||null===ja.qF?"":ja.qF;
this.Jba.value=void 0===ja.qV||null===ja.qV?"":ja.qV;this.Iba.checked=ja.t5;this.Fqc(null)}xrb(ja){ja.qF=this.Kba.value;ja.qV=this.Jba.value;ja.t5=this.Iba.checked}Gj(){N.a.instance.ta(J.a.change,this.Iba,this.Fqc);N.a.instance.ta(J.a.change,this.Iba,this.Mk);N.a.instance.ta(J.a.change,this.Kba,this.Mk);N.a.instance.ta(J.a.Vb,this.Kba,this.Mk);N.a.instance.ta(J.a.change,this.Jba,this.Mk);N.a.instance.ta(J.a.Vb,this.Jba,this.Mk)}Xj(){N.a.instance.Aa(J.a.change,this.Iba,this.Fqc);N.a.instance.Aa(J.a.change,
this.Iba,this.Mk);N.a.instance.Aa(J.a.change,this.Kba,this.Mk);N.a.instance.Aa(J.a.Vb,this.Kba,this.Mk);N.a.instance.Aa(J.a.change,this.Jba,this.Mk);N.a.instance.Aa(J.a.Vb,this.Jba,this.Mk)}}Object(r.a)(Ba,"DataValidationEditInputControl",ea.a,[296,3,304]);class Ea extends ea.a{constructor(ja,la,ua){super(ja);this.a$=this.b$=this.mVa=this.Cha=this.Z9=null;this.Eqc=()=>{this.Z9.checked?(this.Cha.disabled=!1,this.mVa.disabled=!1,this.b$.disabled=!1,this.a$.disabled=!1):(this.Cha.disabled=!0,this.mVa.disabled=
!0,this.b$.disabled=!0,this.a$.disabled=!0);return!1};this.get_visible=this.Aka;this.set_visible=this.poa;this.Mk=la;this.Vka(ua)}get title(){return Y.a.instance.ga(1704)}render(ja){ja.appendChild(this.domElement)}Aka(){return this.isVisible}poa(ja){return this.isVisible=ja}setFocus(){}dispose(){this.Xj();this.Mk=this.b$=this.a$=this.mVa=this.Cha=this.Z9=null;super.dispose()}Vka(ja){U.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:7126094_ReduceInnerHTMLUsageForDataValidationEditMessagesControl")?
ja.jh(this.domElement,E.UNe):this.domElement.innerHTML=E.UNe;this.Z9=R.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.Cha=R.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.mVa=R.DOMElementExtensions.getElementById(this.domElement,"warningId");this.b$=R.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.a$=R.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.Z9.checked=!0;this.Cha.checked=
!0;this.Gj();this.Eqc(null)}vBa(ja){this.Cha.checked=ja.WZ;this.mVa.checked=!ja.WZ;this.b$.value=void 0===ja.MT||null===ja.MT?"":ja.MT;this.a$.value=void 0===ja.KT||null===ja.KT?"":ja.KT;this.Z9.checked=ja.s5;this.Eqc(null)}xrb(ja){ja.MT=this.b$.value;ja.KT=this.a$.value;ja.WZ=this.Cha.checked;ja.s5=this.Z9.checked}Gj(){N.a.instance.ta(J.a.change,this.Z9,this.Eqc);N.a.instance.ta(J.a.change,this.Z9,this.Mk);N.a.instance.ta(J.a.change,this.Cha,this.Mk);N.a.instance.ta(J.a.change,this.mVa,this.Mk);
N.a.instance.ta(J.a.change,this.b$,this.Mk);N.a.instance.ta(J.a.Vb,this.b$,this.Mk);N.a.instance.ta(J.a.change,this.a$,this.Mk);N.a.instance.ta(J.a.Vb,this.a$,this.Mk)}Xj(){N.a.instance.Aa(J.a.change,this.Z9,this.Eqc);N.a.instance.Aa(J.a.change,this.Z9,this.Mk);N.a.instance.ta(J.a.change,this.Cha,this.Mk);N.a.instance.ta(J.a.change,this.mVa,this.Mk);N.a.instance.Aa(J.a.change,this.b$,this.Mk);N.a.instance.Aa(J.a.Vb,this.b$,this.Mk);N.a.instance.Aa(J.a.change,this.a$,this.Mk);N.a.instance.Aa(J.a.Vb,
this.a$,this.Mk)}}Object(r.a)(Ea,"DataValidationEditMessagesControl",ea.a,[296,3,303]);class pa{constructor(ja,la){this.options=this.cellRange=null;this.cellRange=ja;this.options=la}}Object(r.a)(pa,"MacroRecorderRangeDataValidationChangedPayload",null,[123]);var $a=a(1272);class cb extends I.a{constructor(ja,la,ua,eb,Eb){super(ja);this.i3=this.Ahc=this.ooc=this.UFb=null;this.bOa=this.disposed=this.ila=!1;this.htmlSanitizationHelper=this.ai=null;this.fEd=Wb=>{e.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(this.disposed)e.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(m.a(Wb)){e.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${Wb?L.a.qc(Wb.Errors):null}.`);if(Wb.Errors&&1===Wb.Errors.length){const Ab=Wb.Errors[0].MessageId,Jb=this.jhd(Ab);if(Jb){this.vMj(Ab)?this.rHj(Jb):this.St(Jb);this.wca("OkInvalidByServer",
Wb.Errors[0].MessageIdName);return}}e.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${L.a.qc(Wb.Errors)}`)}this.wca("OkValid","None");this.hide()}};this.S8c=Wb=>{this.Qz(Wb,cb.aZ(Wb));2!==Wb&&(this.ai=this.$.Mb.Kc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Wb?this.zab():2===Wb?this.rza():this.Gma()};this.$ca=()=>{this.o4j();this.bOa?this.OEe():this.uEe();return this.ila=!1};this.selectedRanges=
la;this.kUb=ua;this.command=eb;this.htmlSanitizationHelper=Eb;3===eb&&(this.ila=!0);this.Rb=2;this.nx=!1;this.qg=E.qg}get nd(){return this.kUb}get pc(){return"DataValidationEditDialog"}LWd(){const ja={["key"]:this.nd};this.initializeAndShow(Y.a.instance.ga(1668),this.S8c,ja);e.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.Ahc=this.ooc=this.i3=null,La.a.Ja(this.UFb),this.UFb=null,v.b(this.$)&&v.b(this.$).eCc("DataValidationDialogCorellation"),
super.dispose(),this.disposed=!0)}get rD(){return()=>{this.Qz(1,cb.aZ(1));this.zab()}}xy(ja){super.xy(ja);this.wc(2,Y.a.instance.ga(1669));ja=this.ZJ(2);var la=this.ZJ(1),ua=this.ZJ(0),eb=la.parentNode;eb.appendChild(ja);eb.appendChild(la);eb.appendChild(ua);ja.parentNode.classList.add(va.Cmh);ja.classList.add(va.Bmh);ja=document.getElementById("dataValidationTabsId");la=new da(this.$,document.createElement("div"),this.$ca,this.htmlSanitizationHelper);ua=new Ba(document.createElement("div"),this.$ca,
this.htmlSanitizationHelper);eb=new Ea(document.createElement("div"),this.$ca,this.htmlSanitizationHelper);this.Hmi(la,ua,eb);let Eb;this.UFb=new $a.a(ja,(Eb=new W.a,Eb.add(la),Eb.add(ua),Eb.add(eb),Eb));this.UFb.PZf();this.mQ=document.getElementById("validationErrorMessageId");this.vBa();v.b(this.$)&&v.b(this.$).RBc("DataValidationDialogCorellation")}LD(){super.LD();document.getElementById(this.Oh("WACDialogPanel")).classList.add(va.Dmh)}get DY(){return!1}get n4b(){return 3===this.i3.Uah}Vja(){return da.Vja()}Chd(){return"validationErrorMessageId"}Hmi(ja,
la,ua){this.i3=ja;this.Ahc=la;this.ooc=ua}Rzj(){const ja={};ja.IsClearAll=this.ila;ja.Command=this.command;ja.RuleType=this.nd.ruleType;ja.ConditionType=this.nd.Sz;ja.IsIgnoreBlank=this.nd.d5;ja.IsInCellDropDown=this.nd.e5;ja.LowerBoundary=this.nd.JN;ja.UpperBoundary=this.nd.KN;ja.IsAlertBlocking=this.nd.WZ;ja.IsShowErrorAlert=this.nd.s5;ja.IsShowInputMessage=this.nd.t5;ja.AlertTitle=this.nd.MT;ja.AlertMessage=this.nd.KT;ja.InputTitle=this.nd.qF;ja.InputMessage=this.nd.qV;ja.ShouldIgnoreFormulaError=
this.bOa;const la=this.$.pa.va.$b(),ua=()=>new pa(this.selectedRanges,ja);k.a(this.$.userOperationManager,(eb,Eb,Wb)=>ka(this.$.pa.va,this.selectedRanges,ja,t.b(eb,this.fEd),t.a(Eb),Wb,la),eb=>new w.a(121,0,eb,void 0,ua),null)}vMj(ja){return 1577787509===ja}rHj(ja){this.mQ.innerText=ja;this.DI(this.ZJ(0));this.bOa=!0}OEe(){this.bOa=!1;this.mQ.innerText=""}jhd(ja){switch(ja){case 1173235830:return Y.a.instance.ga(1721);case 43935303:return Y.a.instance.ga(1722);case -1323438439:return Y.a.instance.ga(1724);
case 2112020473:return Y.a.instance.ga(1718);case -219503282:return Y.a.instance.ga(1719);case 1689335445:return Y.a.instance.ga(1720);case 2146493810:return Y.a.instance.ga(1723);case -2104909922:return String.format(Y.a.instance.nb(105),this.i3.Rxb(this.nd.ruleType,this.nd.Sz),this.i3.ikd(this.nd.ruleType,this.nd.Sz));case -869372599:return String.format(Y.a.instance.nb(104),this.i3.Rxb(this.nd.ruleType,this.nd.Sz));case -1181828368:return Y.a.instance.ga(1726);case -758480861:return Y.a.instance.ga(1727);
case -13729088:return Y.a.instance.ga(1728);case -846654055:return Y.a.instance.ga(1729);case 751854001:return Y.a.instance.ga(1730);case -453846397:return Y.a.instance.ga(1731);case 1102013489:return Y.a.instance.ga(1732);case 835813260:return Y.a.instance.ga(1733);case 1577787509:return Y.a.instance.ga(1735);case 2083564019:return Y.a.instance.ga(1725);default:e.ULS.sendTraceTag(537163265,0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${ja.toString()}.`)}return null}zab(){e.ULS.sendTraceTag(537163264,
0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.ldc();let ja,la;if(!({errorString:ja,Fq:la}=this.Y2d()).returnValue)return this.St(ja),this.wca("OkInvalidByClient",la),!1;this.Rzj();return!0}Gma(){this.ldc();this.wca("Cancel","None");this.hide()}rza(){e.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.bOa?this.OEe():this.uEe();this.ftj();this.ila=!0}Qz(ja,la){ja={["ButtonType"]:la,["DialogName"]:this.pc,["Location"]:"dialog",["NumberOfSelectedRanges"]:y.h(this.$).ha.ra.nD};
v.b(this.$).qd(h.a.Aub,ja)}ftj(){this.kUb=new x;this.vBa()}vBa(){this.ooc.vBa(this.nd);this.Ahc.vBa(this.nd);this.i3.vBa(this.nd)}ldc(){this.i3.xrb(this.nd);this.ooc.xrb(this.nd);this.Ahc.xrb(this.nd)}wca(ja,la){const ua={};cb.Cub(this.nd,ua);ua.o=ja;ua.p=la;ua.n=this.ila;this.ai&&(this.ai.stop(),ua.q=this.ai.id);A.b().Ze(49,ua,!0)}DRb(ja,la){let ua,eb;eb=ua=null;if(!ja)return la?(ua=String.format(Y.a.instance.nb(105),this.i3.Rxb(this.nd.ruleType,this.nd.Sz),this.i3.ikd(this.nd.ruleType,this.nd.Sz)),
eb="DataValidationEditNoMinMaxError"):(ua=String.format(Y.a.instance.nb(104),this.i3.Rxb(this.nd.ruleType,this.nd.Sz)),eb="DataValidationEditNoValueError"),{returnValue:!1,errorString:ua,Fq:eb};if(ja.length>E.Ygg)return ua=Y.a.instance.ga(1725),{returnValue:!1,errorString:ua,Fq:eb};if(wa.d(ja))return{returnValue:!0,errorString:ua,Fq:eb};if(1===this.nd.ruleType||2===this.nd.ruleType||6===this.nd.ruleType){if(!fa.a.k5(ja))return ua=Y.a.instance.ga(1718),{returnValue:!1,errorString:ua,Fq:eb};if(1===
this.nd.ruleType&&!fa.a.isInteger(ja))return ua=Y.a.instance.ga(1719),{returnValue:!1,errorString:ua,Fq:eb};if(6===this.nd.ruleType){if(!fa.a.isInteger(ja))return ua=Y.a.instance.ga(1719),{returnValue:!1,errorString:ua,Fq:eb};if(0>parseInt(ja,10))return ua=Y.a.instance.ga(1720),{returnValue:!1,errorString:ua,Fq:eb}}}return{returnValue:!0,errorString:ua,Fq:eb}}Y2d(){let ja,la;la=ja=null;if(this.ila||0===this.nd.ruleType)return{returnValue:!0,errorString:ja,Fq:la};const ua=(0===this.nd.Sz||1===this.nd.Sz)&&
3!==this.nd.ruleType&&7!==this.nd.ruleType;return!({errorString:ja,Fq:la}=this.DRb(this.nd.JN,ua)).returnValue||ua&&!({errorString:ja,Fq:la}=this.DRb(this.nd.KN,ua)).returnValue?{returnValue:!1,errorString:ja,Fq:la}:ua&&(1===this.nd.ruleType||2===this.nd.ruleType||6===this.nd.ruleType)&&!wa.d(this.nd.JN)&&!wa.d(this.nd.KN)&&parseFloat(this.nd.JN)>parseFloat(this.nd.KN)?(ja=Y.a.instance.ga(1723),{returnValue:!1,errorString:ja,Fq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:ja,
Fq:la}}set rD(ja){super.rD=ja}static aZ(ja){switch(ja){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Cub(ja,la){la.a=d(ja.ruleType);la.b=f(ja.Sz);la.c=!!ja.JN;la.d=!!ja.KN;la.e=ja.d5;la.f=ja.e5;la.g=ja.t5;la.h=!!ja.qF;la.i=!!ja.qV;la.j=ja.s5;la.k=ja.WZ;la.l=!!ja.MT;la.m=!!ja.KT}}Object(r.a)(cb,"DataValidationEditDialogDeprecated",I.a,
[]);class ib{constructor(ja){this.htmlSanitizationHelper=null;this.htmlSanitizationHelper=ja}caa(ja,la,ua,eb){U.EwaSettings.isChangeGateEnabled("OfficeVSO:7521608_DataValidationReactDialog")?(new Za(ja,la,ua,eb)).LWd():(new cb(ja,la,ua,eb,this.htmlSanitizationHelper)).LWd()}Geh(ja,la){const ua=new H.StandardDialog;ua.Rb=3;ua.Eoa(ja.pb.dba,Y.a.instance.ga(1713),la)}Ieh(ja,la){const ua=new H.StandardDialog;ua.Rb=1;ua.jS(ja.pb.dba,Y.a.instance.ga(1714),la)}Feh(ja,la){const ua=new H.StandardDialog;ua.Rb=
3;ua.Eoa(ja.pb.dba,Y.a.instance.ga(1715),la)}VIe(ja,la){const ua=new H.StandardDialog;ua.Rb=1;ua.jS(ja.pb.dba,Y.a.instance.ga(1717),la)}}Object(r.a)(ib,"DataValidationEditDialogFactory",null,[256]);var ta=a(50),Ya=a(38),Da=a(108),ba=a(153),ya=a(54);class V extends b.a{constructor(ja){super(ja)}ld(){let ja=z.Task.Ta(null);U.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:7126077_ReduceInnerHTMLUsageForDataValidationEditConditionsControl")&&
!U.EwaSettings.isChangeGateEnabled("OfficeVSO:7521608_DataValidationReactDialog")&&(ja=U.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(Da.c)(ba.a.resolve(ya.w,{Wb:this.Na})):ta.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na));Ya.TaskExtensions.za(ja,()=>{this.fd([new C(this.$,new ib(ja.result))])},this.$.ka,3)}static la(ja){b.a.Rd(245,new V(ja))}}Object(r.a)(V,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(B,"a",function(){return Z});
const Z=()=>{c.a.Fa(V.la)}},1189:function(r,B,a){function c(ma,Ga,vb,Ka,Pa,fb){if(0===Ka)return Object(Ea.a)(za.UnsupportedZeroResize);if(0>Ka||0===vb.length)return Object(Ea.a)(za.InvalidInput);if(ma.Mfi())return Object(Ea.a)(za.UnsupportedSkeletonInView);const Wa=ma.gk("ResizeCSE");if(!Object(rb.c)(Wa))return Object(Ea.a)(za.NullSPD);var Ma=Wa.value.J5e(vb);if(Ma&&0<Ma.length)return Object(Ea.a)(Ma.length.toString()+" "+za.UnsupportedHiddenInRange);a:{for(const Na of vb)Pa?Na.right=L.a.wg:Na.bottom=
L.a.xg;Ma=ma.iaa("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",vb);try{for(Ma.$$rst();Ma.$$mn();)if(Ma.Qm.ERj){var lb=!0;break a}}finally{Ma&&Ma.dispose()}lb=!1}if(lb)return Object(Ea.a)(za.UnsupportedMergeCell);if(e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Pa&&"undefined"!==typeof gridRenderer)for(const Na of vb)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Na.left);ma=ma.Ca;lb=xb.a.create().toString();Wa.value.e2d(vb,Ka,Pa);fb=ma.X3j(Pa,
fb);Ga.jjj(vb,Pa);ma.eTf(fb,lb,Pa?"row":"column");return Object(Ea.d)(Ka)}r={};a.r(r);a.d(r,"FormatCellsAction",function(){return Cb});var b=a(9),e=a(1),f=a(0),d=a(228),h=a(155),l=a(7),k=a(15),w=a(91);a(274);var n=a(197),x=a(424),m=a(87),u=a(790),t=a(173),y=a(247),v=a(24),A=a(898),z=a(44);class C{}C.XOh="GalleryGeneral";C.ZOh="GalleryNumber";C.VOh="GalleryCurrency";C.TOh="GalleryAccounting";C.bPh="GalleryShortDate";C.YOh="GalleryLongDate";C.dPh="GalleryTime";C.$Oh="GalleryPercentage";C.WOh="GalleryFraction";
C.aPh="GalleryScientific";C.cPh="GalleryText";C.w2g="ButtonComma";C.buttonPercentage="ButtonPercentage";C.keyboardNumber="KeyboardNumber";C.keyboardCurrency="KeyboardCurrency";C.keyboardDate="KeyboardDate";C.keyboardTime="KeyboardTime";C.keyboardPercentage="KeyboardPercentage";Object(f.a)(C,"RibbonFormatKind",null,[]);var H=a(63),I=a(303),S=a(628),P=a(627),D=a(626);class G extends I.a{constructor(ma,Ga,vb,Ka,Pa,fb,Wa,Ma,lb,Na,X,F,na=null,hb=null){super(11,0,lb,F);this.sNh=ma;this.$ed=Ga;this.format=
Ka;this.activeCell=vb;this.Cwe=Pa;this.rPf=fb;this.mPf=Wa;this.Jkg=Ma;this.qGa=Na;this.clientCorrelationId=X;this.Knb=na;this.Xjb=hb}get Tt(){return this.Knb}get Taa(){return this.Xjb}get VFc(){return this.qGa}R2(ma){return super.R2(ma)||this.sNh.R2(this.$ed,this.activeCell,this.format,this.Cwe,this.rPf,this.mPf,this.Jkg,this.x1b,this.qGa,this.clientCorrelationId,this.Knb,this.Xjb)}ak(){const ma=[];if(this.kfc)for(const Ga of this.kfc)ma.push(D.a(Ga));else ma.push(new P.a(this.format,this.$ed,this.activeCell));
return()=>new S.a(ma)}rgb(){const ma={OperationType:0};ma.FormatCellsMultiRange=this.$ed;ma.ActiveCell=this.activeCell;ma.Format=this.format;ma.ApplyFormatOnPivotTableValueField=this.Cwe;ma.PivotTableXluid=this.rPf;ma.PivotTableFieldCaption=this.mPf;ma.UnmergeCellsFirst=this.Jkg;return ma}}Object(f.a)(G,"FormatCellsBatchOperation",I.a,[]);var E=a(33),O=a(214);class N{}N.editCell="Edited";N.dependentCell="Dependents";Object(f.a)(N,"RecalcPriorityGroupType",null,[]);var J=a(206);const W=ma=>{switch(ma.alignment){case "Center":return 2;
case "Left":return 1;case "Right":return 3;default:return k.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},ea=ma=>{if(ma=ma.color){if("String"===Object.getType(ma).getName())return J.a.cp(ma);if("Number"===Object.getType(ma).getName())return null}else return null;k.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},R=(ma,Ga)=>{ma=excelOnlineCalc.calc.getCellValueKind(ma.rangeDelta.data.value);
switch(ma){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:7317053_CalcErrorValueTypeSupported"))return!0;Ga.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return Ga.numberOfUnsupportedRichCellTypes++,!1;default:return k.ULS.shipAssertTag(537162192,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${ma}`),!1}},Y=ma=>{ma=excelOnlineCalc.calc.getCellValueKind(ma.rangeDelta.data.value);
let Ga=0;switch(ma){case "number":Ga=1;break;case "string":Ga=2;break;case "boolean":Ga=3;break;case "Error":Ga=4;break;case "Blank":Ga=0;break;default:k.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${ma}`)}return Ga},U=ma=>{const Ga=ma.value;switch(ma.type){case 2:return void 0===Ga||null===Ga?"":Ga;case 1:return ma=parseFloat(Ga),isNaN(ma)?null:ma;case 3:return ma=parseFloat(Ga),isNaN(ma)?null:1===ma;case 4:return ma=parseFloat(Ga),isNaN(ma)?
null:excelOnlineCalc.calc.errorValue(ma);default:return excelOnlineCalc.calc.blankValue}},da=ma=>{k.ULS.shipAssertTag(537162190,0,ma.kind!==A.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");ma=excelOnlineCalc.numfmt.getValueEditOperKind(ma);let Ga=0;switch(ma){case 0:case 128:Ga=0;break;case 1:Ga=1;break;case 2:Ga=2;break;case 4:Ga=3;break;case 8:Ga=4;break;case 16:case 32:case 64:case 256:k.ULS.sendTraceTag(537162189,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${ma} to a CellValueType`);
break;default:k.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${ma}`)}return Ga},T=(ma,Ga)=>{const vb=ka(Ga);var Ka=!(void 0===Ga.rangeDelta.data.format||null===Ga.rangeDelta.data.format);k.ULS.shipAssertTag(537162187,0,0===vb||!Ka,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${Ga.priorityGroup}`);ma=Math.max(ma.cell.Ci,0);Ka&&(Ka=excelOnlineCalc.calc.getCellFormatKind(Ga.rangeDelta.data.format.format),
"number"===Ka?ma=Ga.rangeDelta.data.format.format:"string"===Ka?k.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===Ka?k.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):k.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return ma},ka=ma=>{if(ma.priorityGroup===N.editCell)return 0;if(ma.priorityGroup===N.dependentCell)return 1;
k.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2};var L=a(8);class fa{constructor(ma=0,Ga="",vb=0,Ka="",Pa=""){this.sC=ma;this.cellValue=Ga;this.ifmt=vb;this.priorityGroup=Ka;this.RA=Pa}}Object(f.a)(fa,"RecalcAccuracyObject",null,[]);class wa{}wa.string="String";wa.blank="Blank";wa.general="General";wa.hMh="Flexible";Object(f.a)(wa,"FormattedUnitKind",null,[]);class oa{constructor(ma=0,Ga=0,vb=0,Ka=0,Pa=0,fb=0,Wa=0,Ma=0,lb=0,Na=0,X=
0,F=0,na=0,hb=0,Ib=0,vc=!1,nc="",Pb=0,oc=null,Ic=null,ec=null,mb=null,Ob=null,Ta=null,sb=null){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=
this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=ma;
this.numberOfNonUpdatedCells=Ga;this.numberOfUpdatedCells=vb;this.numberOfCellsUpdatedAlreadyByServer=Ka;this.numberOfCellsSkippedDueToTimeout=Pa;this.numberOfCellsWithNoFormattedCell=fb;this.numberOfUnsupportedErrorCellTypes=Wa;this.numberOfUnsupportedBlankCellTypes=Ma;this.numberOfUnsupportedRichCellTypes=lb;this.numberOfSkippedCellsDueToMissingLocaleInfo=Na;this.totalExecutionTime=X;this.originalProcessingTimeLimit=F;this.newProcessingTimeLimit=na;this.numberOfEditedRecalcedCellsInBatch=hb;this.numberOfDependentRecalcedCellsInBatch=
Ib;this.isNewTask=vc;this.lastSetCellInstantaneousOperation=nc;this.taskId=Pb;this.isNewNumberFormatter=oc;this.numberOfRecalcedCellsWithFormattedValue=Ic;this.numberOfRecalcedCellsWithoutFormattedValue=ec;this.totalNumberFormatterTime=mb;this.newNumberFormatterFinalizeFailures=Ob;this.numberOfMeasureTextWidthCalls=Ta;this.numberOfHashFormattedValues=sb}}Object(f.a)(oa,"RecalcResultProcessingStatistics",null,[]);class xa{constructor(ma,Ga,vb,Ka){this.rangeDelta=ma;this.stateId=Ga;this.isFinished=
vb;this.priorityGroup=Ka}}Object(f.a)(xa,"RecalcedCellInfo",null,[]);var bb=a(124),Za=a(11),La=a(22),va=a(58),Ba=a(75),Ea=a(294),pa=a(153),$a=a(54);class cb{constructor(ma,Ga,vb){this.Eda=[];this.calcManager=this.yCc=this.lastSetCellInstantaneousOperation=null;this.eSf=Ka=>{var Pa;if(Ka&&Ka.rangeDeltas){var fb=this.Eda.length;for(let Wa=0;Wa<Ka.rangeDeltas.length;Wa++)(null===(Pa=Ka.rangeDeltas[Wa])||void 0===Pa?0:Pa.data)&&void 0!==Ka.rangeDeltas[Wa].data.value&&null!==Ka.rangeDeltas[Wa].data.value&&
void 0!==Ka.rangeDeltas[Wa].range&&null!==Ka.rangeDeltas[Wa].range&&this.Eda.push(new xa(Ka.rangeDeltas[Wa],Ka.stateId,Ka.isFinished,Ka.priorityGroup));k.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${Ka.stateId}, priorityGroup=${Ka.priorityGroup}, recalcFinished=${Ka.isFinished}, cellsFromCalc=${Ka.rangeDeltas.length}, initialCellsToRender=${fb}, recalcedCells=${this.Eda.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);!fb&&this.Eda.length&&
this.xJf(!1,0)}};this.$=ma;this.grid=Ga;this.Zg=vb;this.Ada=cb.JMe;this.$.da.hb(268,Ka=>{this.yCc=Ka});e.EwaSettings.OH()?void pa.a.resolve($a.f).then(Ka=>{this.calcManager=Ka}):this.$.da.hb(266,Ka=>{this.calcManager=Ka})}dispose(){this.calcManager=this.yCc=this.Zg=this.grid=this.$=null}nbc(ma,Ga,vb,Ka,Pa,fb,Wa){if(!Ga)return Object(Ea.a)("Null");var Ma=excelOnlineCalc.numfmt.renderCallback(Ka,Na=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Na,Pa,!0,e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",
!1)),Wa);let lb=ma.renderValue(Ga,Ma);if(!excelOnlineCalc.util.isSuccess(lb))return Object(Ea.a)("Finalize");Ka=null;if(Wa=excelOnlineCalc.numfmt.isHashesValue(lb.value)){if(lb=ma.renderHashesValue(lb.value,Ma),!excelOnlineCalc.util.isSuccess(lb))return Object(Ea.a)("Hashes")}else Ka=cb.ENh(Ga,lb.value);Ma=lb.value;ma=excelOnlineCalc.numfmt.renderedValueToString(Ma);Ga=W(Ma);Ma=ea(Ma);return Object(Ea.d)({text:ma,valueType:vb,fontColor:Ma,Ci:fb,kPa:Ka,horizontalAlignment:Ga,isHashesValue:Wa})}xJf(ma,
Ga){this.$&&this.grid&&this.calcManager&&this.yCc&&this.calcManager.HF?(ma&&(this.Ada=this.yCc.Fhf),this.rdj(this.grid,this.calcManager.HF,ma,Ga),!this.Ada&&this.Eda.length?va.Task.delay(0).Yo(vb=>{this.xJf(!0,vb.id);return!0},0,null,Ba.a.current):va.Task.Ta(!0)):(k.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),va.Task.Ta(!1))}rdj(ma,Ga,vb,Ka){const Pa=Za.HelperMethods.Lb();for(vb=new oa(this.Eda.length,
void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.Ada,void 0,void 0,void 0,vb,void 0,Ka,!0,0,0,0,0,0,0);0<this.Eda.length;){Ka=Za.HelperMethods.Lb()-Pa;if(!this.Ada||Ka>this.Ada){vb.numberOfCellsSkippedDueToTimeout=this.Eda.length;break}Ka=Array.dequeue(this.Eda);if(R(Ka,vb)){var fb=v.Range.Hc(Ka.rangeDelta.range.row+1,Ka.rangeDelta.range.column+1);(fb=ma.Jb(fb))?cb.u4g(Ka.stateId,fb.cell)?(cb.hpc(ma,fb,Ka,vb),this.PVg(Ga,fb,Ka,vb)):vb.numberOfCellsUpdatedAlreadyByServer++:
vb.numberOfCellsWithNoFormattedCell++}}Ka=Math.round(Za.HelperMethods.Lb()-Pa);this.C7j(Ka);this.HUj(vb,Ka);this.msj(vb)}PVg(ma,Ga,vb,Ka){var Pa,fb,Wa,Ma;const lb=T(Ga,vb),Na=vb.rangeDelta.data.formatted,X=Y(vb),F=ka(vb);ma=this.nbc(ma,Na,X,Ga.cell.hCa,Ga.cell.Bia,lb,!1);if(Object(Ea.c)(ma))Ga.text!==ma.value.text&&(this.Zg.cqb(Ga,ma.value),vb=ka(vb),0===vb?vb=1:1===vb?vb=2:(k.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!"),vb=0),
this.Zg.wRe(Ga,this.lastSetCellInstantaneousOperation,1,vb,!0,!0),0===F&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.lAf(Ga.range):k.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),Ka.numberOfUpdatedCells++);else switch(ma.reason){case "Null":Ka.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Pa=Ka.numberOfRecalcedCellsWithoutFormattedValue)&&
void 0!==Pa?Pa:0)+1;break;case "Hashes":Ka.numberOfHashFormattedValues=(null!==(fb=Ka.numberOfHashFormattedValues)&&void 0!==fb?fb:0)+1;break;case "Finalize":Ka.newNumberFormatterFinalizeFailures=(null!==(Wa=Ka.newNumberFormatterFinalizeFailures)&&void 0!==Wa?Wa:0)+1}Object(Ea.b)(ma)&&"Null"!==ma.reason&&(Ka.numberOfRecalcedCellsWithFormattedValue=(null!==(Ma=Ka.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Ma?Ma:0)+1);Ka=0===F?Ga.cell.userInput:Ga.formulaBarText;Ma=Object(Ea.c)(ma)?ma.value.text:
"";vb=Object(Ea.b)(ma)?ma.reason:"";k.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${Ga.range.top}, ${Ga.range.left}) 2nd pass formatting, success: ${Object(Ea.c)(ma)}, reason: ${vb}, priority: ${F}, ifmt: ${Ga.cell.Ci}, input: '${Ka?La.a.bM(Ka):"null"}', prediction: '${Ma?La.a.bM(Ma):"null"}',`)}C7j(ma){this.Ada=Math.max(this.Ada-Math.max(ma,1),0)}HUj(ma,Ga){ma.numberOfNonUpdatedCells=this.Eda.length;ma.totalExecutionTime=Ga;ma.newProcessingTimeLimit=this.Ada;ma.lastSetCellInstantaneousOperation=
this.lastSetCellInstantaneousOperation}msj(ma){ma=Sys.Serialization.JavaScriptSerializer.serialize(ma);k.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${ma}`)}static ENh(ma,Ga){ma=ma.units;var vb=Ga.units;if(ma.length!==vb.length)return k.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;Ga=[];let Ka=-1;for(let Pa=
0;Pa<ma.length;Pa++)switch(ma[Pa].kind){case wa.blank:Ga.push(...bb.h(" ",vb[Pa].str.length));break;case wa.string:Ga.push(ma[Pa].str);break;case wa.hMh:Ga.push("");Ka=Pa;break;case wa.general:Ga.push(vb[Pa].str);break;default:k.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=Ka||""===vb[Ka].str)return null;vb={};vb.Start=Ga.slice(0,Ka).join("");vb.Separator=ma[Ka].str;vb.End=Ga.slice(Ka+1,Ga.length).join("");return vb}static AUh(ma){return ma&&
ma&&ma.zv?ma.zv.zE:L.a.re}static u4g(ma,Ga){if(!Ga)return!1;Ga=cb.AUh(Ga);return Ga===L.a.re||Ga===ma}static hpc(ma,Ga,vb,Ka){var Pa=vb.rangeDelta.data.value.toString();const fb=Y(vb),Wa=T(Ga,vb);Pa=new fa(fb,Pa,Wa,vb.priorityGroup);Ga.cell.hpc(Pa,ma.Ca.oya);1===ka(vb)?Ka.numberOfDependentRecalcedCellsInBatch++:Ka.numberOfEditedRecalcedCellsInBatch++}}cb.JMe=20;Object(f.a)(cb,"CalcResultProcessor",null,[482,3]);class ib{constructor(ma,Ga=null,vb=""){this.success=ma;this.mpc=Ga;this.reason=vb}}Object(f.a)(ib,
"GetRibbonNumberFormatResult",null,[]);var ta=a(935);class Ya{constructor(ma){this.Dx=null;this.Ca=ma}teb(ma,Ga,vb,Ka,Pa=!1,fb=!1){ma&&(ma.E0(Ga,vb,Pa,fb),ma.verticalAlignment=Ka)}eNb(ma,Ga,vb){this.Dx||(this.Dx=new ta.a(this.Ca));this.Dx.eNb(ma,Ga,vb)}}Object(f.a)(Ya,"FormatCellsActionModelAccessor",null,[414]);var Da=a(215),ba=a(28),ya=a(29),V=a(255),Z=a(260),ja=a(290),la=a(68);class ua{constructor(){this.gpg=this.zak=!1;this.source=0;this.cxa=this.tkc=!1}}Object(f.a)(ua,"FormatCellInstantaneousResult",
null,[]);class eb{constructor(ma,Ga){this.success=ma;this.RA=Ga}}Object(f.a)(eb,"FormatStringResult",null,[]);var Eb=a(21),Wb=a(184),Ab=a(1116),Jb=a(46),Gb=a(525),Nb=a(53),Ja=a(179),ab=a(273),wb=a(83),xb=a(178),rb=a(62),za;(function(ma){ma.InvalidInput="invalid input";ma.UnsupportedZeroResize="resizing to 0 - ignore";ma.UnsupportedSkeletonInView="skeleton in view - ignore";ma.NullSPD="ActiveSheetProcessedData is null";ma.UnsupportedHiddenInRange="hiddens in resizeRanges";ma.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(za||
(za={}));Object(f.b)("InstantaneousRowColumnResizeFailureReason",za);var Aa=a(384),pb=a(70),kb;let Cb=kb=class{constructor(ma){this.Dx=this.calcManager=this.gy=this.xTa=null;this.Vkf=Ga=>{if(Ga){const vb=Za.HelperMethods.xO.hasOwnProperty(Ga);Ga=Eb.h(this.$).isFontSupported(Ga);return!vb&&Ga}k.ULS.sendTraceTag(512340115,0,15,"FormatCellsAction.isFontFromFontService: fontName cannot be null");return!1};this.fXi=(Ga,vb)=>{if(Ga&&!V.a(Ga)&&vb){const Ka=!!Ga&&!!Ga.RequestTelemetryData;Eb.h(this.$).Dh.kma(vb.toString(),
Ga.StateId,Ka?Ga.RequestTelemetryData.EcsOperationDuration:0,Ka?Ga.RequestTelemetryData.EcsRequestDuration:0,Ka?Ga.RequestTelemetryData.WfeRequestDuration:0)}};this.$=ma;this.$.da.hb(268,Ga=>{this.gy=Ga});this.tNh=new Ya(Eb.h(this.$).Ca);this.C$=new cb(this.$,Eb.h(this.$),this);e.EwaSettings.OH()?(this.calcManager=pa.a.gK($a.f))||void pa.a.resolve($a.f,{Wb:0}).then(Ga=>{this.calcManager=Ga}):this.$.da.hb(266,Ga=>{this.calcManager=Ga});this.vb=e.EwaSettings.vb();this.Vl=e.EwaSettings.Vl();this.TNa=
e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);this.rl=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1);this.r5=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1)}get rva(){return this.tNh}get HF(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.HF}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){w.a.sc([this.xTa,
this.C$]);this.$=this.C$=this.xTa=null}jTa(ma,Ga,vb,Ka=!1,Pa="",fb=0,Wa=null){return this.nOj(ma,Ga,vb,Ka,fb,Pa,Wa)}wRe(ma,Ga,vb,Ka,Pa,fb){ma.cell.zv.JJ|=Ka;kb.Hah(Eb.h(this.$),ma,vb,Pa);this.C$.lastSetCellInstantaneousOperation=Ga;fb&&(Eb.h(this.$).Dh.lS(Ga,la.BasicTelemetryCalculator.WQ),e.EwaSettings.isChangeGateEnabled("OfficeVSO:7198762_AddTelemetryforCalculateDurationBetweenPhases")&&(1===vb&&1===Ka?Eb.h(this.$).Dh.lS(Ga,la.BasicTelemetryCalculator.Ghf):1!==vb&&Eb.h(this.$).Dh.lS(Ga,la.BasicTelemetryCalculator.Upd)))}vea(ma,
Ga,vb,Ka=!1,Pa=null,fb=null){fb=fb||ma.ha.ra.selectedRanges;if(!(-1690267012===Ga&&1<fb.length)){-1690267012===Ga&&k.ULS.shipAssertTag(537162176,0,1===fb.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${fb.length}`);fb=ma.iaa("FormatCellsAction.ShowInstantaneousFormatting",fb);try{fb.$$rst();let Wa=!1;for(;fb.$$mn();){let Ma;const lb=fb.$$cu().NH?ma.GMb(fb.$$cu().range):(Ma=new n.a,Ma.add(fb.$$cu()),Ma);for(let Na of lb)if(Eb.h(this.$),!Na||fb.Ib.contains(Na.range))if(this.Gbg(Ga,
Na,vb,Ka,Pa,fb.$$cu().NH),Wa||(ma.Ca.tV(),Wa=!0),Pa)break}}finally{fb&&fb.dispose()}}}cqb(ma,Ga,vb=null){vb&&(vb.cxa=!0);vb=!Ga.text;const Ka=La.a.Umf(Ga.text);let Pa;const fb=ma.NH?Eb.h(this.$).GMb(ma.range):(Pa=new n.a,Pa.add(ma),Pa);for(let Wa of fb)this.MVg(this.$,Wa,Ga.text,Ga.horizontalAlignment,Ga.fontColor,Ga.Ci,ma.cell.Ci,vb,Ka,Ga.valueType,Ga.kPa);ma.cell.JFc()}e9i(ma,Ga,vb,Ka,Pa=null){try{const fb=z.E(Ga);let Wa=z.E(vb);if(!Aa.a.eze){if(ma.tb.$7a(fb)||ma.tb.$7a(Wa))return 8;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste")&&
-185374993!==Ka&&(ma.tb.Vpf(fb)||ma.tb.Vpf(Wa)))return 18;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:7327017_BlockCondFormattingForPaste")&&-185374993!==Ka&&(ma.tb.Bjf(fb)||ma.tb.Bjf(Wa)))return 19}if(-185374993!==Ka&&this.czi(ma,fb,Wa))return 9;if(-185374993!==Ka&&(ma.tb.o5(Wa)||ma.tb.zCb(fb)))return 10;if(1804571062!==Ka&&ma.tb.n5(Wa))return 11;if(this.Bsh(Wa))return 12;if(this.$zi(fb,Wa))return 13;const Ma=this.$.Mb.Kc("UserAction","PasteInstantaneous");Ma.start();Gb.a(Ma);Pa&&Nb.b().hC(Ma.id,
Pa.id,"actions","actions");!fb.isSingle&&Wa.isSingle&&(Wa=kb.expandRange(fb,Wa),ma.ha.updateSelection(Wa,Wa,0));switch(Ka){case 237279923:case 808159687:if(!this.w9i(fb,Wa))return 14;this.m6c(ma,fb,Wa,!0,!1);break;case 1804571062:this.m6c(ma,fb,Wa,!0,!1);break;case -185374993:this.m6c(ma,fb,Wa,!1,!0);break;default:return 2}k.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(fb){return k.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(fb)}`),
15}}E8g(ma,Ga){for(const vb of ma)this.U3c(vb,!0,Ga)}U3c(ma,Ga,vb=""){if(ma){var Ka=Eb.h(this.$);if(Ga){if(Ga=Ka.Qj("FormatCellsAction.ClearRangeInstantaneous",ma),Ka=ma.isSingle?null:ma,Ga.$$mn()&&void 0!==Ga.$$cu()&&null!==Ga.$$cu())for(ma=Object(l.a)(new ab.a,{Text:""}),this.jTa(Ga.$$cu(),ma,!1,E.a.Dsd(this.$),vb,void 0,Ka);Ga.$$mn();)void 0!==Ga.$$cu()&&null!==Ga.$$cu()&&this.jTa(Ga.$$cu(),ma,!1,!1,vb)}else this.vea(Ka,-1228228458,{},void 0,void 0,[ma])}else k.ULS.shipAssertTag(537162144,0,!1,
"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}jjj(ma,Ga){if(!Ga){Ga=Za.HelperMethods.Lb();var vb=Eb.h(this.$),Ka=vb.iaa("FormatCellsAction.ReformatCells",ma);try{Ka.$$rst();let Pa=!1;for(;Ka.$$mn();){const fb=Ka.$$cu().cell;if(0===fb.sC||2===fb.sC)this.updateSpillInformation(fb,ma),Pa||(vb.Ca.tV(),Pa=!0)}}finally{Ka&&Ka.dispose()}k.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${Za.HelperMethods.Lb()-
Ga}.`)}}Fmd(ma,Ga){if(this.vb){if(ma.formulaBarText)return!La.a.equals(Ga.Text,ma.formulaBarText,!1);let vb=ma.cell.formattedText;vb=Z.a(vb,ma.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(vb,Ga).isEqual}return!La.a.equals(Ga.Text,ma.text,!1)}zNh(ma,Ga,vb,Ka){if(void 0===Ga||null===Ga)return new eb(!1,ma);const Pa={};Pa.value=ma;Pa.type=1;Ga=this.q4a(Pa,Ga,vb,Ka);return Object(Ea.b)(Ga)?new eb(!1,ma):new eb(!0,Ga.value.text)}lWd(ma,Ga,vb,Ka){return c(ma,this,
Ga,vb,Ka,!0)}lOj(ma,Ga,vb){if(!this.Fmd(Ga,vb))return Object(Ea.d)("Skip unchanged cell content");var Ka=Ga.cell;let Pa;this.r5&&(Pa=this.EKe(vb.Text,Ga));Ga=this.z0e(vb.Text,Ka.Ci,Ka.hCa,Ka.Bia,!0,Pa);Object(Ea.b)(Ga)?ma=Ga:(Ga=Ga.value,vb=Ka.hasRichValueIcon?"Unsupported rich value icon":Ka.BS?"Unsupported wrapped text":Ka.Ppf||null!=Ka.rL&&0!==Ka.rL?"Unsupported rotated text":!0,!0!==vb?ma=Object(Ea.a)(vb):(Ka.isCellWidthFixed?vb="Skip fixed width cell":(vb=Ga.valueType,vb=0===vb?"Skip empty cell value":
2===vb?"Skip string cell value":Ka.sz&&!Ka.Syi?"Skip merged cell":Ka.iBc?"Skip shrunk to fit":Ga.isHashesValue?"Skip hashes cell value":!0),!0!==vb?ma=Object(Ea.d)(vb):(Ga=Ka.GHe(Ga.text),Ga>Ka.offsetWidth?(Ka=[Ka.getRange().clone()],ma=c(ma,this,Ka,Ga,!1,!1),ma=Object(Ea.b)(ma)?ma:Object(Ea.d)(Ga)):ma=Object(Ea.d)("Column is wide enough"))));return ma}x0e(ma,Ga,vb,Ka,Pa){const fb={};fb.value=ma;fb.type=vb;Ga=this.q4a(fb,Ga,Ka,Pa);return Object(Ea.b)(Ga)?new eb(!1,ma):new eb(!0,Ga.value.text)}updateSpillInformation(ma,
Ga){const vb=ma.getRange();let Ka=!1;for(const Pa of Ga)if(vb.left===Pa.left){Ka=!0;break}ma.n4j(Ka)}nOj(ma,Ga,vb,Ka,Pa,fb="",Wa=null){const Ma=new ua;Ma.source=0;Ma.cxa=!1;ma.cell.iIb=ma.cell.Ci;let lb=Ga.Text;const Na=!lb,X=La.a.Umf(lb);La.a.Pq(lb)&&(k.ULS.shipAssertTag(537162142,0,!((void 0===lb||null===lb)&&void 0!==Ga.TextRuns&&null!==Ga.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),Ga=Object(l.a)(new ab.a,{Text:""}),lb="");ma.cell.userInput=
lb;if(!this.Fmd(ma,Ga))return this.c6g(ma,Pa,Na,X,Ma);vb?this.X5g(ma,lb,this.$.workbookContext.DefaultHyperlinkStyle,Ma):this.R5g(ma,Ga,lb,Na,X,Ka,Ma,Wa);this.wRe(ma,fb,Pa,1,Ma.tkc,Ma.cxa);return Ma}c6g(ma,Ga,vb,Ka,Pa){Pa.gpg=!0;Pa.tkc=!0;Pa.cxa=!1;0===Ga&&Eb.h(this.$).Ca.tV();0===ma.cell.pB&&(vb?ma.cell.E0(0,!1):Ka&&ma.cell.E0(1,!1));this.F0d(ma.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return Pa}X5g(ma,Ga,vb,Ka){Ka.cxa=!0;ma.insertHyperlink(Ga,O.a.ped(Ga),vb);this.F0d(ma.range,"FormatCellsAction.cellDataEntryCSE")}R5g(ma,
Ga,vb,Ka,Pa,fb,Wa,Ma=null){var lb,Na,X,F;Wa.cxa=!1;const na=ma.cell;this.gy||(this.gy=this.$.da.Ba(268));this.M_j(this.gy,na.Ci);e.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")&&fb&&this.Sig(this.gy,ma,vb,Ma);if(Ka||Pa)this.T5g(ma,Ka,Pa,Wa);else{Pa=void 0;this.r5&&(Pa=this.EKe(vb,ma));Ka=this.z0e(vb,na.Ci,na.hCa,na.Bia,!1,Pa);Object(Ea.c)(Ka)?(this.dLj(Ga.TextRuns,Ga.Fonts)&&this.V5g(ma,Ga,Ka.value),this.cqb(ma,Ka.value,Wa),this.F0d(ma.range,"FormatCellsAction.cellDataEntryCSE")):
this.a6g(ma,Ga.Text,Wa);Ga=Object(Ea.c)(Ka)?Ka.value.text:"";const hb=Object(Ea.b)(Ka)?Ka.reason:"";if(this.r5){const Ib=null===(Na=null===(lb=this.calcManager)||void 0===lb?void 0:lb.$yc)||void 0===Na?void 0:Na.Y2e(Pa);lb=null==Ib?"prefetchedFormattedResult object is null":Object(Ea.b)(Ib)?Ib.reason:"PreFetchResultSucceeded";k.ULS.sendTraceTag(0,0,50,`FormatCellsAction.CellDataEntryCSE: (${ma.range.top}, ${ma.range.left}) 1st pass formatting, success: ${Object(Ea.c)(Ka)}, reason: ${hb}, ifmt: ${na.Ci}, input: '${La.a.Usa(na.userInput)}', prediction: '${La.a.Usa(Ga)}', preFetchFormattedResult: ${lb}`)}else k.ULS.sendTraceTag(559724065,
0,50,`FormatCellsAction.CellDataEntryCSE: (${ma.range.top}, ${ma.range.left}) 1st pass formatting, success: ${Object(Ea.c)(Ka)}, reason: ${hb}, ifmt: ${na.Ci}, input: '${La.a.Usa(na.userInput)}', prediction: '${La.a.Usa(Ga)}',`)}na.formulaBarText=vb;e.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")||fb&&this.Sig(this.gy,ma,vb,Ma);this.r5&&(null===(F=null===(X=this.calcManager)||void 0===X?void 0:X.$yc)||void 0===F?void 0:F.CEe());Wa.tkc=!0}T5g(ma,Ga,vb,Ka){Ka.cxa=!0;ma.text=
"";ma.formulaBarText="";ma.cell.userInput="";this.W2c(ma,null,null,Ga,vb)}V5g(ma,Ga,vb){Ga.Text===vb.text&&2===vb.valueType&&(ma.cell.formattedText=Ga)}a6g(ma,Ga,vb){vb&&(vb.cxa=!0);ma.text=Ga;ma.formulaBarText=Ga;this.W2c(ma,1)}W2c(ma,Ga,vb=null,Ka=!1,Pa=!1,fb=!1){let Wa=ma.pB;vb=null!=vb?vb:ma.verticalAlignment;0===ma.cell.pB&&(null!=Ga||Ka||Pa||fb)&&(Ka?Wa=0:Pa||fb?Wa=1:null!=Ga&&(Wa=Ga),this.rva.teb(ma,Wa,!1,vb,!0))}F0d(ma,Ga){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const vb=
Eb.h(this.$),Ka=()=>{this.calcManager?this.calcManager.lAf(ma):k.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${Ga}, cell ${ma}`);vb.Xb.dm(Ka)};vb.Xb.rm(Ka)}}M_j(ma,Ga){(null===ma||void 0===ma?0:ma.hza)&&Ga>=kb.PLh&&Ga>ma.hza.length-1&&(k.ULS.sendTraceTag(537162141,0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${Ga}. Triggering refresh...`),
ma.q0e())}Sig(ma,Ga,vb,Ka=null){if(void 0!==ma&&null!==ma)if(this.gy.Tpd)k.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{try{var Pa=Object(pb.c)({TV:266,new:$a.f,registry:this.$.da,Y3:e.EwaSettings.uX})}catch(fb){}Pa&&(this.C$.Ada=cb.JMe,ma&&(this.C$.Ada=ma.Fhf),Pa.F3g(Ga,vb,this.C$.eSf,Ka))}}q4a(ma,Ga,vb,Ka){var Pa=Object(pb.c)({TV:266,new:$a.f,registry:this.$.da,Y3:e.EwaSettings.uX});if(!Pa)return Object(Ea.a)("calcManager is null");if(!Pa.HF)return Object(Ea.a)("calcManager.NumberFormatter is null");
if(!this.gy)return Object(Ea.a)("instantaneousManager is null");let fb;if("number"===typeof Ga||"string"===typeof Ga){var Wa=Pa.t5a(Ga);if(!Object(Ea.c)(Wa))return Wa;fb=Wa.value}else fb=Ga;Wa=Pa.HF;const Ma=U(ma);if(void 0===Ma||null===Ma)return Object(Ea.a)("cellValue is null");Pa=excelOnlineCalc.calc.cellValueToReadOper(Pa.config.mathpack,Ma);if(void 0===Pa||null===Pa)return Object(Ea.a)("readOper is null");Pa=Wa.applyFormat(fb,Pa,e.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));
return excelOnlineCalc.util.isSuccess(Pa)?this.C$.nbc(Wa,Pa.value,ma.type,vb,Ka,"number"===typeof Ga?Ga:-1,!1):Object(Ea.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Pa.reason.kind))}z0e(ma,Ga,vb,Ka,Pa,fb){const Wa=Object(pb.c)({TV:266,new:$a.f,registry:this.$.da,Y3:e.EwaSettings.uX});if(void 0===Wa||null===Wa)return Object(Ea.a)("calcManager is null");if(void 0===Wa.HF||null===Wa.HF)return Object(Ea.a)("calcManager.NumberFormatter is null");if(void 0===this.gy||null===this.gy)return Object(Ea.a)("instantaneousManager is null");
const Ma=Wa.HF;if(this.r5&&fb){const lb=Wa.$yc.Y2e(fb);if(Object(Ea.c)(lb))return ma=da(lb.value),this.C$.nbc(Ma,lb.value.formatted,ma,vb,Ka,fb.ifmt,Pa)}return this.xVg(Wa,Ma,Ga,ma,vb,Ka,Pa,fb)}xVg(ma,Ga,vb,Ka,Pa,fb,Wa,Ma){var lb=ma.t5a(vb);if(!Object(Ea.c)(lb))return lb;lb=lb.value;Ka=Ga.parseEdit(Ka,lb);if(!excelOnlineCalc.util.isSuccess(Ka))return Object(Ea.a)(`ParseEdit failure: reason=${Ka.reason.kind}, features=${Ka.reason.features}`);if(Ka.value.kind===A.a.formula)return Object(Ea.a)("Main thread - skipping formula edit");
ma=excelOnlineCalc.numfmt.applyValueEdit(Ga,ma.localeInfo,lb,Ka.value);if(!excelOnlineCalc.util.isSuccess(ma))return Object(Ea.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(ma.reason.kind));Ka=da(Ka.value);return this.C$.nbc(Ga,ma.value,Ka,Pa,fb,this.r5&&Ma?Ma.ifmt:"number"===typeof vb?vb:-1,Wa)}czi(ma,Ga,vb){if(Ga.width<vb.width){const Ka=ma.Qj("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new v.Range(Ga.top,Ga.left,Ga.bottom,Ga.left,!0,!0));for(;Ka.$$mn();){let Pa=Ka.$$cu();if(Pa&&
Pa.aMa())return k.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(Ga.height<vb.height)for(ma=ma.Qj("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new v.Range(Ga.top,Ga.left,Ga.top,Ga.right,!0,!0));ma.$$mn();)if((Ga=ma.$$cu())&&Ga.cMa())return k.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}m6c(ma,Ga,vb,Ka,Pa){const fb=Ga.qS().FirstRow,Wa=Ga.qS().LastRow;
var Ma=vb.qS().FirstRow;const lb=vb.qS().LastRow;let Na=fb;for(;Ma<=lb;Ma++,Na++){Na>Wa&&(Na=fb);const X=Ga.qS();X.FirstRow=X.LastRow=Na;const F=vb.qS();F.FirstRow=F.LastRow=Ma;this.Fdh(ma,t.a.wQ(X),t.a.wQ(F),Ka,Pa)}}w9i(ma,Ga){const vb=Object(pb.c)({TV:266,new:$a.f,registry:this.$.da,Y3:e.EwaSettings.uX});return void 0!==vb&&null!==vb?(vb.z3g(ma,Ga.topLeft,this.C$.eSf),!0):!1}$zi(ma,Ga){const vb=ma.right-ma.left+1;ma=ma.bottom-ma.top+1;const Ka=Ga.right-Ga.left+1;Ga=Ga.bottom-Ga.top+1;if(Ka>vb&&
Ga>ma){if(!(Ka%vb&&Ga%ma))return!0}else if(Ka===vb&&Ga>ma){if(!(Ga%ma))return!0}else if(Ka>vb&&Ga===ma&&!(Ka%vb))return!0;return!1}Bsh(ma){if(e.EwaSettings.xa(101)){ma=Eb.h(this.$).pX(ma).gridView.getRangeInformation(ma);for(const Ga of ma)if(Object(x.a)(y.DynamicArrayRange,Ga)&&!Object(m.a)(y.DynamicArrayRange,Ga).H$a)return!0}return!1}wIe(ma,Ga,vb,Ka,Pa,fb){for(let Wa of Ga)vb&&(this.Jdh(Wa,Pa),Wa.setCell(!0)),Ka&&(fb=this.vdi(Pa,Wa)),fb||(ma.Ca.tV(),fb=!0);return fb}EZh(ma,Ga,vb){Ga=new v.Range(Ga,
vb,Ga,vb,!0,!0);return ma.Jb(Ga)}Fdh(ma,Ga,vb,Ka,Pa){if(vb){this.xTa&&vb.equals(this.xTa.range)||(w.a.Ja(this.xTa),this.xTa=ma.Qj("FormatCellsAction.CopyBetweenRows",vb));vb=this.xTa;vb.$$rst();var fb=!1;if(e.EwaSettings.getBooleanFeatureGate(Aa.a.uLe,!1)){var Wa=Ga.qS().FirstColumn+1,Ma=Ga.qS().LastColumn+1;Ga=Ga.qS().FirstRow+1;let Na=Wa;for(;vb.$$mn();){Na>Ma&&(Na=Wa);const X=this.EZh(ma,Ga,Na);Na+=1;var lb=void 0;const F=vb.$$cu().NH?ma.GMb(vb.$$cu().range):(lb=new n.a,lb.add(vb.$$cu()),lb);X&&
(fb=this.wIe(ma,F,Ka,Pa,X,fb));wb.lastOrDefault(F)}}else for(lb=ma.Qj("FormatCellsAction.CopyBetweenRows2",Ga);vb.$$mn();)lb.$$mn()||(lb.$$rst(),lb.$$mn()),Ma=lb.$$cu(),Ga=vb.$$cu().NH?ma.GMb(vb.$$cu().range):(Wa=new n.a,Wa.add(vb.$$cu()),Wa),Ma&&(fb=this.wIe(ma,Ga,Ka,Pa,Ma,fb)),wb.lastOrDefault(Ga)}else k.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}bcg(){const ma=ya.a.hd(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");Jb.a(this.$).vj(ma)}RKi(ma,
Ga){const vb={ValidMembers:32},Ka=Ga.NumberFormat;switch(ma){case 1890566896:if(1001===Ka||1002===Ka||1003===Ka){vb.NumberFormat=14;vb.NumberFormatOptions={};switch(Ka){case 1001:vb.NumberFormatOptions.TimeType=2;break;case 1002:vb.NumberFormatOptions.DateType=7;break;case 1003:vb.NumberFormatOptions.DecimalPlaces=0}vb.NumberFormatOptions.NumberFormatCategory=this.AVg(Ka)}else vb.NumberFormat=Ka;break;case 1886928607:vb.NumberFormat=13;break;case -992833457:vb.NumberFormat=11;break;case 218524921:vb.NumberFormat=
12;break;case 996232352:vb.NumberFormat=14;vb.NumberFormatOptions=Object(l.a)(new u.a,{DecimalPlaces:0});vb.NumberFormatOptions.NumberFormatCategory=6;break;default:return Ga}return vb}formatCells(ma,Ga,vb,Ka=null,Pa=null,fb=null,Wa=null){var Ma;const lb=this.$.Mb.Kc("UserAction","FormatCellsInstantaneous, command = "+Nb.b().Ij(ma)),Na=this.$.Mb.vg("UserAction","FormatCellsInstantaneousFrame");Na.start();Gb.a(Na);var X=Nb.b().Ij(ma);const F=this.$,na=Eb.h(F);var hb=na.ha.ra,Ib=Pa||hb.selectedRanges,
vc=bb.g(Ib,mb=>mb.hw);X=`${X}, cellCount=${vc}`;Eb.h(this.$).Dh.M0(1,lb.id,X);Ib=z.r(Ib,this.$);hb=hb.activeCell;X=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CenterAcrossSelectionInRibbonEnabled",!1)&&2007171328===vb.command;vc=-168056295===vb.command;let nc=null;var Pb=null;if(vc){Pb=na.tb.fp(hb);if(!Pb){this.bcg();return}nc=Pb.qda.substring(1,Pb.qda.length-1);Pb=Pb.hdc();if(!Pb){this.bcg();return}Pb=Pb.Caption}na.Ng.mM(!1,!0);const oc=z.o(hb,F),Ic=F.pa.va.$b({ima:!0,$ka:1}),ec=
this.RKi(vb.command,Ga);vc||this.vea(na,ma,Ga,!1,Ka,Pa);lb.stop();Eb.h(this.$).Dh.lS(lb.id,la.BasicTelemetryCalculator.WQ);vb.Eni=ba.a.Ya.Zb;Ka=this.$.Mb.Kc("UserAction","FormatCellsUserAction");Pa=this.rl&&this.Vkf(null===(Ma=null===Ga||void 0===Ga?void 0:Ga.Font)||void 0===Ma?void 0:Ma.FontName);this.YGi(ma,vb.taskId,Ga,Ib,hb,Ka.id,Pa);Nb.b().hC(lb.id,Ka.id,"actions","actions");Nb.b().hC(Na.id,Ka.id,"actions","actions");F.userOperationManager.Oc(new G(this,Ib,oc,ec,vc,nc,Pb,X,Ic,Ka,lb.id,64,fb,
Wa),vb)}R2(ma,Ga,vb,Ka,Pa,fb,Wa,Ma,lb,Na,X,F){const na=this.$;return(hb,Ib,vc)=>{na.vy();hb=[hb,this.fXi];Ib=[Ib];X&&hb.push(X);F&&Ib.push(F);return H.l(na.pa.va,ma,Ga,vb,Ka,Pa,fb,!1,Wa,ja.b(...hb),ja.a(...Ib),vc,Na,Ma,lb)}}Gbg(ma,Ga,vb,Ka,Pa,fb,Wa=null){if(Ga&&vb){var Ma=vb.Font,lb=vb.HorizontalAlignment,Na=vb.VerticalAlignment;vb.ValidMembers&2||(lb=Ga.pB);vb.ValidMembers&1||(Na=Ga.verticalAlignment);var X=0!==lb;kb.Qpi(ma)&&0===lb&&(lb=this.N5e(Ga));var F=!1;switch(ma){case -394785302:this.rva.teb(Ga,
lb,X,0);break;case 1041132226:this.rva.teb(Ga,lb,X,1);break;case -571165336:this.rva.teb(Ga,lb,X,2);break;case -1150205178:case -1142465846:case -286432209:this.rva.teb(Ga,lb,X,Na,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.yJj(this.TNa,Ga)&&this.nCj(Ga,vb,X);break;case 1650812936:this.setFillColor(Ga,vb,fb);break;case -287251124:Ga.bold=Ma.Bold;break;case -1690267012:Eb.h(this.$).ha.ra.eh&&(Ma=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1)?Wa?Wa:Eb.h(this.$).ha.ra.xd:Eb.h(this.$).ha.ra.xd,this.rva.eNb(Ga,vb,Ma));break;case 1970784898:vb=J.a.cp(Ga.color,Ga.backgroundColor);if(Da.a.compare(vb,Da.a.red)&&(La.a.k5(Ga.text)||La.a.Scf(Ga.text)))break;vb=Da.a.qH(Ma.FontColor);Ga.color=Ja.e(J.a.kG(vb));break;case -1925065947:Ga.italic=Ma.Italic;break;case -1293291468:Ga.fontName=Ma.FontName;this.Vl&&Ga.D7f(Ma.FontScheme);break;case 862890474:case 963349338:Ga.fontSize=Ma.FontSize;this.$.tf();break;case -1077965542:Ga.fontSize=Ma.FontSize;
break;case 1764140053:Ga.underline=Ma.Underline;break;case -1685033574:Ga.doubleUnderline=Ma.DoubleUnderline;break;case -1590502662:Ga.fontStrikethrough=Ma.Strikethrough;break;case -848953656:case 2045211913:F=Ga.ksb();break;case 2105621672:vb=Object(m.a)(Ab.a,Pa);if(!vb)break;Ma=Da.a.xOh(vb.color);Ga.color=Ja.e(J.a.kG(Ma));this.Iwe(Ga,vb.qpc);break;case -1409276245:this.Iwe(Ga,vb.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.LVg(Ga,vb);break;case -1228228458:Ga.ksb();Ga.clearFormat();
this.o_c(Ga,0);F=!0;break;case -730106152:Ga.clearFormat();this.o_c(Ga,0);break;case 932244020:this.mCj(Ga,vb,fb);break;case -1942512156:case -1920201820:this.qEj(Ga,vb)}Ka||(F?Ga.vKb(!0):Ga.setCell(!0))}else k.ULS.shipAssertTag(537162135,0,!Ga,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),k.ULS.shipAssertTag(537162134,0,!vb,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}Jdh(ma,Ga){ma&&Ga?(ma.usb(Ga),ma.n4c(Ga),this.o_c(ma,Ga.cell.Ci)):k.ULS.sendTraceTag(537162133,
0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}o_c(ma,Ga){if(0>Ga)this.vca({caller:"ApplyNumberFormatIndexOnCell",cell:ma,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{var vb=this.q4a(ma.Nr,Ga,ma.cell.hCa,ma.cell.Bia);Object(Ea.b)(vb)?this.vca({caller:"ApplyNumberFormatIndexOnCell",cell:ma,kind:"failure",reason:vb.reason}):(this.cqb(ma,vb.value),this.vca({caller:"ApplyNumberFormatIndexOnCell",cell:ma,
kind:"success",RA:vb.value,format:Ga}))}}Iwe(ma,Ga){if(void 0===Ga||null===Ga)this.vca({caller:"ApplyNumberFormatStringOnCell",cell:ma,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var vb=this.q4a(ma.Nr,Ga,ma.cell.hCa,ma.cell.Bia);Object(Ea.b)(vb)?this.vca({caller:"ApplyNumberFormatStringOnCell",cell:ma,kind:"failure",reason:vb.reason}):(this.cqb(ma,vb.value),this.vca({caller:"ApplyNumberFormatStringOnCell",cell:ma,kind:"success",RA:vb.value,format:Ga}))}}LVg(ma,
Ga=null){if(Ga)if(Ga=this.e6h(ma,Ga),Ga.success){var vb=this.q4a(ma.Nr,Ga.mpc,ma.cell.hCa,ma.cell.Bia);Object(Ea.b)(vb)?this.vca({caller:"ApplyNumberFormatCategoryOnCell",cell:ma,kind:"failure",reason:vb.reason,format:Ga.mpc}):(this.cqb(ma,vb.value),this.vca({caller:"ApplyNumberFormatCategoryOnCell",cell:ma,kind:"success",RA:vb.value,format:Ga.mpc}))}else this.vca({caller:"ApplyNumberFormatCategoryOnCell",cell:ma,kind:"failure",reason:Ga.reason,format:Ga.mpc});else this.vca({caller:"ApplyNumberFormatCategoryOnCell",
cell:ma,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}AVg(ma){switch(ma){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<ma?-1:ma}e6h(ma,Ga){if(!this.gy||!this.localeInfo||!Ga)return ma=this.gy?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new ib(!1,void 0,"GetRibbonNumberFormat: "+ma);Ga=Ga.NumberFormat;
switch(Ga){case 0:ma=C.XOh;break;case 1:ma=C.ZOh;break;case 2:ma=C.VOh;break;case 3:ma=C.TOh;break;case 4:ma=C.bPh;break;case 5:ma=C.YOh;break;case 6:ma=C.dPh;break;case 7:ma=C.$Oh;break;case 8:ma=C.WOh;break;case 9:ma=C.aPh;break;case 10:ma=C.cPh;break;case 11:case 12:return this.gy.q0e(),this.UWh(ma,Ga);case 13:ma=C.w2g;break;case 1006:ma=C.buttonPercentage;break;case 1004:ma=C.keyboardNumber;break;case 1005:ma=C.keyboardCurrency;break;case 1002:ma=C.keyboardDate;break;case 1001:ma=C.keyboardTime;
break;case 1003:ma=C.keyboardPercentage;break;case 14:return ma="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",k.ULS.shipAssertTag(537162132,0,!1,ma),new ib(!1,void 0,ma);default:return ma="GetRibbonNumberFormat: unknown NumberFormatType!",k.ULS.shipAssertTag(537162131,0,!1,ma),new ib(!1,void 0,ma)}return ma?(ma=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,ma))?new ib(!0,ma):new ib(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):
new ib(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}UWh(ma,Ga){if(!this.calcManager||!this.HF)return Ga=this.calcManager?"numberFormatter is null":"calcManager is null",new ib(!1,void 0,"GetDecimalChangeNumberFormat: "+Ga);ma=this.calcManager.t5a(ma.cell.Ci);if(!Object(Ea.c)(ma))return new ib(!1,void 0,`getDecimalChangeNumberFormat: ${ma.reason}`);Ga=this.HF.changeFormatDecimals(ma.value,11===Ga?1:-1);return excelOnlineCalc.util.isSuccess(Ga)?void 0===Ga.value||null===Ga.value?
new ib(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new ib(!0,Ga.value):new ib(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}vca(ma){const Ga=ma.caller,vb=ma.cell;var Ka=ma.format;Ka=null==Ka?"null":"number"===typeof Ka?Ka:"string"===typeof Ka?La.a.Usa(Ka):La.a.Usa(Ka.formatString);const Pa=La.a.Usa(vb.Nr.value)||"null",fb="success"===ma.kind?La.a.Usa(ma.RA.text):"null";ma=JSON.stringify({caller:Ga,"range.top":vb.range.top,"range.left":vb.range.left,
result:ma.kind,reason:"success"===ma.kind?"":ma.reason,value:Pa,valueType:vb.Nr.type,ifmt:Ka,prediction:fb});k.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${ma}`)}MVg(ma,Ga,vb,Ka,Pa,fb,Wa,Ma=!1,lb=!1,Na=0,X=null){const F=Ga.cell;F.sC=Na;Na=Ga.text;Na!==vb&&(F.text=vb);F.kPa=X;Wb.f(Na)?Ga.formulaBarText=Na:Ga.formulaBarText="";ma=Eb.h(ma).tb.$wi(Ga.range);this.W2c(Ga,Ka,null,Ma,lb,ma);Pa&&(Ga.color=Ja.e(J.a.kG(Pa)));Ga.cell.Ci=fb;Ga.cell.iIb=Wa;Ga.cell.MBc=fb}YGi(ma,Ga,
vb,Ka,Pa,fb,Wa){const Ma={};Ma.a=this.$.ya.UserSessionId;Ma.b=Ga;Ma.c=Ka.Ranges.length;Ma.d=this.Mhh(Ka.Ranges);Ma.e=Pa.toString();Ma.f=ma;Ma.h=fb;1890566896===ma?Ma.g=vb.NumberFormat.toString():2105621672===ma?Ma.g=vb.NumberFormatOptions.NumberFormatCategory.toString():this.rl&&-1293291468===ma&&(Ma.g=`{ "isNewFont": ${Wa} }`);Nb.b().Ze(3,Ma,!0)}Mhh(ma){let Ga=0,vb=0,Ka=0;for(let Pa=0;Pa<ma.length;Pa++){const fb=z.C(ma[Pa]).hw;Ga+=fb;fb>Ka&&(Ka=fb,vb=Pa)}ma=z.C(ma[vb]).toString();return"TotalCellCount:"+
Ga+"; Max range:"+ma+"; MaxRangeSize:"+Ka+";"}mCj(ma,Ga,vb){64===(Ga.ValidMembers&64)&&this.setFillColor(ma,Ga,vb);16===(Ga.ValidMembers&16)&&kb.QDj(ma,Ga);128===(Ga.ValidMembers&128)&&this.rva.eNb(ma,Ga,ma.range);if(2===(Ga.ValidMembers&2)||1===(Ga.ValidMembers&1)){vb=Ga.VerticalAlignment;Ga=Ga.HorizontalAlignment;const Ka=0!==Ga;e.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!Ka&&this.N5e(ma);this.rva.teb(ma,Ga,Ka,vb)}}setFillColor(ma,Ga,vb){(e.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
ma.TM:ma.TM&&ma.mzb&&!ma.pzb&&!ma.szb)||(Ga=-1===Ga.FillColor?vb?J.a.kG(Da.a.white):null:J.a.kG(Da.a.qH(Ga.FillColor)),ma.backgroundColor=Ga?Ja.e(Ga):null)}qEj(ma,Ga){0!==ma.pB&&2!==ma.pB||ma.E0(1,!1);0<=ma.indentation+Ga.IndentationIncrease&&(ma.indentation+=Ga.IndentationIncrease)}yJj(ma,Ga){return ma&&!(0<Ga.indentation)}nCj(ma,Ga,vb){const Ka=Ga.TextOrientation;Ka!==L.a.verticalText&&(0>Ka||180<Ka)&&k.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${Ka}`);
ma.rL=Ga.TextOrientation;vb||ma.E0(0<=ma.rL?1:3,!1)}N5e(ma){ma=this.q4a(ma.Nr,ma.cell.Ci,ma.cell.hCa,ma.cell.Bia);return Object(Ea.b)(ma)?0:null!=ma.value.horizontalAlignment?ma.value.horizontalAlignment:0}IFj(ma,Ga,vb){this.Dx||(this.Dx=new ta.a(Eb.h(this.$).Ca));this.Dx.eNb(ma,Ga,vb)}vdi(ma,Ga){const vb=new ab.a;if(ma.cell.formulaBarText&&ma.cell.formulaBarText.startsWith("'"))vb.Text=ma.cell.formulaBarText;else{let Ka=ma.cellValue;Ka&&4!==ma.cell.sC||(Ka=ma.text);vb.Text=Ka}this.jTa(Ga,vb,!1,E.a.Dsd(this.$));
return!0}dLj(ma,Ga){return this.vb&&!!ma&&!!Ga}EKe(ma,Ga){return{text:ma,range:Ga.cell.getRange(),ifmt:Ga.cell.Ci,stateId:Ga.cell.zv.Y2b,sheetName:this.$.activeItemName}}static Hah(ma,Ga,vb,Ka){Ka&&Ga.setCell(!0);0===vb&&ma.Ca.tV()}static expandRange(ma,Ga){Ga=Ga.clone();Ga.height<ma.height&&(Ga.bottom=Ga.top+ma.height-1);Ga.width<ma.width&&(Ga.right=Ga.left+ma.width-1);return Ga}static Qpi(ma){switch(ma){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;
default:return!1}}static QDj(ma,Ga){Ga=Ga.Font;var vb=0!==(Ga.ValidMembers&16);const Ka=0!==(Ga.ValidMembers&16),Pa=0!==(Ga.ValidMembers&16);ma.bold=0!==(Ga.ValidMembers&4);ma.italic=0!==(Ga.ValidMembers&8);vb&&(ma.underline=vb);Ka&&(ma.doubleUnderline=Ka);Pa&&(ma.fontStrikethrough=Pa);ma.fontName=Ga.FontName;ma.fontSize=Ga.FontSize;vb=J.a.cp(ma.color,ma.backgroundColor);Da.a.compare(vb,Da.a.red)&&(La.a.k5(ma.text)||La.a.Scf(ma.text))||(Ga=Da.a.qH(Ga.FontColor),ma.color=Ja.e(J.a.kG(Ga)))}};Cb.Ndk=
10;Cb.PLh=36;Object(h.b)([Object($a.f)()],Cb.prototype,"calcManager",void 0);Cb=kb=Object(h.b)([Object(pa.d)($a.r,{nR:"transient"}),Object(h.c)(0,Object($a.o)())],Cb);Object(f.a)(Cb,"FormatCellsAction",null,[373,3]);class ob extends d.a{constructor(ma){super();this.$=ma;this.Gb()}create(){this.qb(new Cb(this.$))}static la(ma){ma.da.Ha(18,new ob(ma))}}Object(f.a)(ob,"FormatCellsActionFactory",d.a,[]);a.d(B,"a",function(){return qa});const qa=()=>{b.a.Fa(ma=>{e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",
!1)||ob.la(ma)})};String(r);window.___1678693015618_closurehack=r},1197:function(r,B,a){function c(qa){return Object(l.a)(this,void 0,void 0,function*(){if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service"))return rb.a.resolve(za.w,{Wb:qa});const ma=yield rb.a.resolve(za.o);return Object(Aa.d)(pb.GetServiceTaskFactory.Pa(ma.da,498,499,qa))})}r={};a.r(r);a.d(r,"SharedUIControlsFactory",function(){return kb});var b=a(9),e=a(70),f=a(0),d=a(228),h=a(1),
l=a(155),k=a(15),w=a(204),n=a(84),x=a(38),m=a(49),u=a(45),t=a(654),y=a(28),v=a(125);class A{constructor(){this.startTime=y.a.Ya.Zb;this.Gx=new t.a}z4e(){return v.a(y.a.Ya,this.startTime)}}Object(f.a)(A,"OngoingAction",null,[]);class z extends n.a{constructor(qa,ma,Ga,vb,Ka=null){super();this.ZPa=this.Mpb=null;this.K1c=0;this.$rc=null;this.B2i=()=>{const Pa=this.ZPa.z4e();k.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.fma}>.OnRunningLong: Operation running for more than ${Pa}ms`);this.$rc=
m.a.instance.create(this.z6,Math.max(this.MAe-Pa,0),u.a.Toe)};this.z6=()=>{k.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.fma}>.OnTimeout: Operation running for more than ${this.ZPa.z4e()}ms, timing out. Has pending actions: ${this.f7a}`);this.K1c++;this.K1c>this.LAe&&k.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.fma}>.OnTimeout: passed the allowed bypassed count`);this.ZPa.Gx.cancel();this.YZe()};this.jI=()=>{this.f7a&&k.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.fma}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.JMa}, AggregatedActionParams not null: ${this.f7a}`);
this.aqd()};this.nKg=qa;this.oKg=ma;this.documentVisibilityObserver=Ga;this.fma=vb;this.pL=Ka;Ga&&this.documentVisibilityObserver.Hsa(this.jI);this.J1c=!!Ga&&h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.LAe=h.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);ma=h.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.MAe=qa.cgd(ma);qa=
h.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.I2g=Math.max(this.MAe-ma,0)+qa}get JMa(){return!!this.ZPa}get f7a(){return!!this.Mpb}XOf(qa){k.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.fma}>.PerformThrottledAction: Start. IsActionOngoing: ${this.JMa}, AggregatedActionParams not null: ${this.f7a}`);this.Mpb=this.oKg.KZc(qa,this.Mpb);this.aqd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.MAa(this.jI);
this.wCe();super.dispose()}p8f(qa){this.J1c?(this.ZPa=qa?new A:null,qa?this.startTimer():this.wCe()):this.ZPa=qa?{}:null}YZe(qa=null){this.J1c&&qa&&qa.qK?k.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.fma}>.FinishedCallback: timedout, skipping`):(k.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.fma}>.FinishedCallback: Start. IsActionOngoing: ${this.JMa}, AggregatedActionParams not null: ${this.f7a}`),this.p8f(!1),this.aqd())}aqd(){if(!this.oOb()){var qa=this.Mpb;this.Mpb=null;
this.p8f(!0);k.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.fma}>.InternalPerformAction: Calling PerformAction.`);var ma=this.J1c?this.ZPa.Gx.token:w.a.none;x.TaskExtensions.za(this.nKg.IHd(qa),()=>{this.YZe(ma)},ma,0,this.pL)}}oOb(){return!this.f7a||this.JMa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.oi?(k.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.fma}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}wCe(){this.$rc&&this.$rc.cancel()}startTimer(){this.K1c<=
this.LAe&&(this.$rc=m.a.instance.create(this.B2i,this.I2g,u.a.Toe))}}Object(f.a)(z,"ActionAggregator",n.a,[690,3]);var C=a(27),H=a(90),I=a(113),S=a(13),P=a(47),D=a(39),G=a(18),E=a(5),O=a(136),N=a(14),J=a(21),W=a(58);class ea extends D.a{constructor(qa){super();this.Hw=this.firstElement=null;this.iNa=!1;this.Js=null;this.xJj=C.a.Ff;this.mHf=ma=>{const Ga=ma.Ea.keyCode;return Ga===H.a.Sh?this.jWi():Ga===H.a.Fy&&ma.Ea.shiftKey?this.WHh(this.firstElement):!1};this.JMf=ma=>{if(!this.iNa||ma.Ea.keyCode!==
H.a.sG)return!1;ea.Cef();W.Task.delay(1).Yo(()=>{this.Hw.focus();return!0},0,this.ka);return!0};this.W5i=()=>{document.activeElement&&document.activeElement.id===this.Hw.id||(ea.Cef(),W.Task.delay(1).Yo(()=>{this.Hw.focus();return!0},0,this.ka))};this.kFf=()=>{this.Mig(this.Hw)};this.lHf=ma=>{ma.stopPropagation();ma.preventDefault();this.iNa&&(this.iNa=!1)};this.$=qa;(qa=this.$.ea.ic)&&k.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${qa.Kta}; InWebPart = '${qa.inWebPart?
"Classic":"Non Classic"}', InEmbedView = '${qa.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);qa&&(qa.inWebPart||qa.inEmbedView)?k.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${qa.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${qa.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.Fgh(),this.Chh(),I.KeyInputManager.instance.ta(S.a.Vb,this.$.domElement,
this.JMf));this.$.da.Ha(238,this)}zQg(qa){this.addHandler("KBIS",qa)}Xoj(qa){this.removeHandler("KBIS",qa)}dispose(){this.firstElement&&P.a.removeHandler(this.firstElement,S.a.focus,this.kFf);this.Js&&this.Js.detach("focus");this.Hw&&(P.a.removeHandler(this.Hw,S.a.focus,this.lHf),P.a.removeHandler(this.Hw,S.a.blur,ea.onBlur),I.KeyInputManager.instance.Aa(S.a.Vb,this.Hw,this.mHf));I.KeyInputManager.instance.Aa(S.a.Vb,this.$.domElement,this.JMf);this.Js=this.Hw=this.firstElement=this.$=null;super.dispose()}Fgh(){this.xJj?
(this.firstElement=document.documentElement,this.Js=O.a.instance.eH(document.parentWindow),this.Js.la("focus",this.W5i)):(this.firstElement=ea.FJe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),P.a.addHandler(this.firstElement,S.a.focus,this.kFf))}Chh(){this.Hw=ea.FJe();this.Hw.id=E.a.cRe;this.Hw.setAttribute(E.a.fv,N.a.instance.ga(863));document.body.appendChild(this.Hw);P.a.addHandler(this.Hw,S.a.focus,this.lHf);P.a.addHandler(this.Hw,S.a.blur,ea.onBlur);I.KeyInputManager.instance.ta(S.a.Vb,
this.Hw,this.mHf)}WHh(qa){this.Mig(qa);return!1}jWi(){this.iNa=!0;J.h(this.$).focus();J.h(this.$).ha.Gbf();this.raiseEvent("KBIS");return!0}Mig(qa){this.iNa?this.iNa=!1:(this.iNa=!0,qa&&qa.focus())}static FJe(){const qa=document.createElement("div");qa.tabIndex=0;return qa}static Cef(){document.body.classList.add(G.a.STe)}static onBlur(){document.body.classList.remove(G.a.STe)}}Object(f.a)(ea,"EmbedViewFocusControl",D.a,[689,3]);var R=a(4),Y=a(1112),U=a(64),da=a(527),T=a(24),ka=a(44),L=a(379),fa=
a(198),wa=a(291),oa=a(117),xa=a(29),bb=a(255),Za=a(290),La=a(63);const va=(qa,ma,Ga,vb,Ka,Pa,fb,Wa,Ma,lb,Na=null)=>{Na=qa.Oa(1,Na);Na.selectedRange=ma;Na.richValueKeyPath=Ga;Na.singleColumn=vb;Na.searchForRange=Ka;Na.calculateMajorityDataType=Pa;return La.g(qa,"GetRichValueFieldListContextList",Na,fb,Wa,Ma,lb,4)};var Ba=a(33);class Ea extends D.a{constructor(qa,ma){super();this.MLb=this.Mhd=this.Qxb=this.lP=null;this.sWb=!1;this.R8d=null;this.sKd=!1;this.PXi=(Ga,vb,Ka)=>{k.ULS.sendTraceTag(25264350,
0,10,"Call to GetRichValueFieldListContextList failed in: "+Ka);this.MLb&&this.MLb.stop();this.lP=null;this.raiseEvent(Y.h)};this.QXi=Ga=>{bb.a(Ga)||(this.MLb&&this.MLb.stop(),this.sWb=!1,(this.lP=Ga.Result)&&0<this.lP.length&&k.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.lP.length} rich value field list context for autocomplete`),this.iXa=!0,this.iuc())};this.iXa=!1;this.mb=qa;this.$Ub=-1;this.tableManager=ma;this.sKd=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&
Ba.a.vV(qa)}H0b(qa){this.addHandler(Y.a,qa)}Lvc(qa){this.removeHandler(Y.a,qa)}ZPg(qa){this.addHandler(Y.h,qa)}Eoj(qa){this.removeHandler(Y.h,qa)}get I7a(){return this.iXa}get vFi(){return this.sWb}get T0e(){return this.$Ub}get t8c(){return this.R8d}get $(){return this.mb}get Tk(){return this.lP}get EYh(){return!!this.Qxb}dispose(){this.mb=null;this.Bdb();super.dispose()}T$i(){var qa=Array(6);var ma={};ma.Name=Y.f;qa[0]=ma;ma={};ma.Name=Y.c;qa[1]=ma;ma={};ma.Name=Y.d;qa[2]=ma;ma={};ma.Name=Y.g;qa[3]=
ma;ma={};ma.Name=Y.e;qa[4]=ma;ma={};ma.Name=Y.b;qa[5]=ma;ma={ColumnName:"",ColumnIndex:-1};ma.FieldInfoDataList=qa;qa=[];qa[0]=ma;this.TSd(qa)}AZ(qa,ma,Ga,vb=null){if(qa){this.x2c();this.Y3b();var Ka=null,Pa=!1;if(!vb&&({hbb:Pa,Tk:Ka}=this.C0j(qa,ma,Ga)).returnValue)if(this.sKd||this.TSd(Ka),this.sWb=!0,this.lP=Ka,this.sKd){if(!Pa){this.iXa=!0;this.iuc();return}}else if(this.lP&&0<this.lP.length&&(this.iXa=!0,this.iuc()),!Pa)return;this.Fmg(qa,vb,ma,Ga,!1)}}Fmg(qa,ma,Ga,vb,Ka){if(this.$.ea.Yb){this.$.Mb&&
(this.MLb=this.$.Mb.Kc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Qxb=null;var Pa=this.$.pa.va.$b();this.Qxb=va(this.$.pa.va,qa,ma,Ga,vb,Ka,this.QXi,this.PXi,null,Pa)}else this.lP=null}Bdb(){this.lP=null;this.iXa=!1;this.x2c();this.Y3b();this.Qxb=null;this.$Ub=-1}x2c(){Ea.Rrb(this.Qxb)}Y3b(){Ea.Rrb(this.Mhd)}iuc(){this.raiseEvent(Y.a)}Qp(qa){qa=ka.E(qa);--qa.left;--qa.right;return this.tableManager.Qp(qa)}iLa(qa){qa.FirstColumn=qa.FirstColumn;qa.LastColumn=qa.LastColumn;qa.FirstRow=
qa.FirstRow;qa.LastRow=qa.LastRow;this.Y3b();this.Mhd=null;return L.a(this.$.userOperationManager,(ma,Ga,vb)=>wa.i(this.$.pa.va,qa,Za.b(ma,Ka=>{this.ZXi(Ka)}),Za.a(Ga,Ga,Ka=>{this.YXi(Ka)}),vb,null),ma=>new fa.a(264,0,ma,80),null)}YXi(qa){qa=oa.a.Ue(qa.data);k.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${xa.a.qc(qa)}`)}ZXi(qa){if(bb.a(qa))-315732528!==qa.Errors[0].MessageId&&k.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${xa.a.qc(qa.Errors)}`);
else if(qa&&qa.Result){qa=qa.Result;var ma=qa.HasHeaderRow;ma=new da.AutofilterRange(qa.TableRange.FirstRow+(ma?1:0)+1,qa.TableRange.FirstColumn+1,qa.TableRange.LastRow+1,qa.TableRange.LastColumn+1,null,null,null,0,ma);this.$Ub=qa.TableRange.FirstColumn;(qa=this.gSf(!1,!0,ma))||k.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.TSd(qa)}else k.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}C0j(qa,
ma,Ga){let vb,Ka;Ka=null;vb=!1;if(qa.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,hbb:vb,iLa:!1,Tk:Ka};let Pa;this.$Ub=-1;if(Ga){Pa=this.Qp(qa);if(!Pa||!Pa.Kka)return{returnValue:!1,hbb:vb,iLa:!1,Tk:Ka};var fb=J.h(this.$).tb.O8e(Pa);this.R8d=Pa;if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&fb&&0<fb.count)return--qa.FirstColumn,--qa.LastColumn,this.Mhd=this.iLa(qa),{returnValue:!0,hbb:vb,iLa:!0,Tk:Ka};Pa.top+=1;
Pa.right=ka.E(qa).right-1}else Pa=new da.AutofilterRange(qa.FirstRow+1,qa.FirstColumn+1,qa.LastRow+1,qa.LastColumn+1,null,null,null,0,!1);if(Pa.top>Pa.bottom||Pa.left>Pa.right)return{returnValue:!0,hbb:vb,iLa:!1,Tk:Ka};qa=J.h(this.$);var Wa=qa.jb.width,Ma=qa.jb.height;fb=qa.view.visibleArea;Wa=new U.a(fb.x-Wa,fb.y-Ma,fb.width+Wa,fb.height+Ma);Ma=qa.Eg(Pa);if(!fb||!Ma||!qa.wkc(Pa))return{returnValue:!1,hbb:vb,iLa:!1,Tk:Ka};Wa.contains(Ma)||(vb=!0);Ka=this.gSf(ma,Ga,Pa);return{returnValue:!0,hbb:vb,
iLa:!1,Tk:Ka}}TSd(qa){qa&&k.ULS.sendTraceTag(25264348,0,50,`Retrieved ${qa.length} rich value field contexts from block cache`);this.sWb=!0;(this.lP=qa)&&0<this.lP.length&&(this.iXa=!0,this.iuc())}gSf(qa,ma,Ga){let vb;vb=null;const Ka=Ga.clone();if(ma)for(let Pa=Ga.right,fb=0;Pa>=Ga.left;--Pa){if(Ka.left=Pa,Ka.right=Pa,ma=this.O4e(Ka,!0,Ga.left)){vb||(vb=[]);vb[fb]=ma;if(qa)break;++fb}}else if(qa=this.O4e(Ka,!1))vb=[],vb[0]=qa;return vb}O4e(qa,ma,Ga=0){var vb=null;if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Ka=
J.h(this.$).tb.h6h(qa);if(Ka&&0<Ka.count){var Pa=Array(Ka.count);vb=0;for(var fb of Ka.values)Ka={},Ka.Name=fb,Pa[vb]=Ka,++vb;fb="";Ka=-1;0<qa.top&&ma&&(qa=new T.Range(qa.top-1,qa.left,qa.top-1,qa.left,!1,!1),null!=J.h(this.$).Jb(qa)&&null!=J.h(this.$).Jb(qa).originalText&&(fb=J.h(this.$).Jb(qa).originalText),Ka=qa.left-Ga);vb={};vb.ColumnName=fb;vb.ColumnIndex=Ka;vb.FieldInfoDataList=Pa}}else if((fb=J.h(this.$).tb.O8e(qa))&&0<fb.count){Pa=Array(fb.count);vb=0;for(Ka of fb)fb={},fb.Name=Ka,Pa[vb]=
fb,++vb;fb="";Ka=-1;0<qa.top&&ma&&(qa=new T.Range(qa.top-1,qa.left,qa.top-1,qa.left,!1,!1),fb=J.h(this.$).Jb(qa).originalText,Ka=qa.left-Ga);vb={};vb.ColumnName=fb;vb.ColumnIndex=Ka;vb.FieldInfoDataList=Pa}return vb}static Rrb(qa){qa&&R.AFrameworkApplication.Hd.Wt(qa.Xs)}}Object(f.a)(Ea,"FieldInfoManager",D.a,[323,3]);class pa extends Ea{constructor(qa,ma,Ga,vb){super(qa,ma);this.g3a=null;this.eFf=()=>{this.Lvc(this.eFf);if(this.Tk&&this.Tk.length&&this.contextMenuManager){var Ka=this.contextMenuManager.Wgd("autoFilterRichFieldList"),
Pa=window.document.getElementById(this.g3a);Ka.J0(null,Pa,this,null,!0)}};this.uwg=Ga;this.contextMenuManager=vb}get YG(){return this.uwg}PYh(qa,ma){this.g3a=ma;k.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${qa.FirstRow}, ${qa.FirstColumn}, ${qa.LastRow}, ${qa.LastColumn})`);this.Fmg(qa,null,!0,!1,!0)}}Object(f.a)(pa,"FilterInfoManager",Ea,[324,323,3]);var $a=a(861),cb=a(1124),ib=a(31),
ta=a(91),Ya=a(8);class Da{}Da.VBh="ewa-sharedUi-launchButton";Da.YBh="ewa-sharedUi-launchButtonWithText";Da.WBh="ewa-sharedUi-launchButtonClick";Da.ZBh="ewa-sharedUi-launchButtonWithTextClick";Da.XBh="ewa-sharedUi-launchButtonText";Object(f.a)(Da,"CssClassNames",null,[]);var ba=a(71);a(522);var ya=a(243),V=a(229);D=a(242);var Z=a(295),ja=a(77),la=a(11),ua=a(260),eb=a(35);class Eb extends D.a{constructor(qa,ma,Ga,vb,Ka,Pa,fb,Wa,Ma){super(document.createElement("div"));this.xrf=null;this.QWd=!1;this.htmlSanitizationHelper=
this.TPb=this.tTa=null;this.DN=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.CN=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.RPj=()=>{this.dpe()};this.jd=lb=>{this.raiseEvent(this.UIb,lb);this.TIb();return!0};this.QVi=lb=>{100<v.a(y.a.Ya,this.xrf)&&this.hmd(new Sys.UI.Point(Math.round(lb.clientX),Math.round(lb.clientY)))};this.zN=lb=>{ja.g(lb.Ea,!1);return!1};this.eZ=this.Fe.SIa();this.set_visible(!1);this.alc=Ka;this.UIb=Pa;this.bpc=qa;this.c5b=ma;this.htmlSanitizationHelper=Ma;this.alc&&
(this.tTa=m.a.instance.create(this.RPj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));qa&&this.domElement.classList.add(qa);this.OHa=document.createElement("div");this.domElement.appendChild(this.OHa);Ga&&this.OHa.classList.add(Ga);this.t1d(vb);fb&&(this.TPb=document.createElement("div"),this.domElement.appendChild(this.TPb),this.TPb.classList.add(Wa),this.TPb.innerText=fb,this.domElement.style.padding="3px",ya.a.instance.ta(S.a.pointerDown,this.domElement,this.zN));this.m0a=new Z.a(this.domElement,7);
V.a.instance.ta(S.a.click,this.domElement,this.jd);h.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&ya.a.instance.ta(S.a.pointerDown,this.domElement,this.zN);qa=lb=>{ja.g(lb)};this.Gc.la("mouseup",qa);this.Gc.la("click",qa);this.Gc.la("dblclick",qa)}y2(qa){this.addHandler(this.UIb,qa)}Pda(qa){this.get_events().removeHandler(this.UIb,qa)}SQg(qa){this.addHandler("OnObjectButtonMouseOver",qa)}npj(qa){this.get_events().removeHandler("OnObjectButtonMouseOver",
qa)}RQg(qa){this.addHandler("OnObjectButtonMouseOut",qa)}mpj(qa){this.get_events().removeHandler("OnObjectButtonMouseOut",qa)}t1d(qa){qa&&(h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.jh(this.OHa,qa):this.OHa.innerHTML=qa)}c4j(qa,ma,Ga){h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?
this.htmlSanitizationHelper.JE(this.OHa):this.OHa.innerHTML="";qa?qa.Lba(ma,16,16,this.OHa,16,16,void 0,Ga):k.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}d4j(qa,ma){qa&&(this.TPb.innerText=qa);this.domElement.title=ma}dispose(){this.get_isInitialized()&&(this.hide(),this.Gc.KC(),ta.a.sc([this.eZ,this.m0a]),V.a.instance.Aa(S.a.click,this.domElement,this.jd),ya.a.instance.Aa(S.a.pointerDown,this.domElement,this.zN),this.tTa&&this.tTa.dispose(),
super.dispose())}zdb(){this.c5b&&this.domElement.classList.remove(this.c5b);this.bpc&&this.domElement.classList.add(this.bpc)}TIb(){this.bpc&&this.domElement.classList.remove(this.bpc);this.c5b&&this.domElement.classList.add(this.c5b);this.u3a()}u3a(){this.alc&&(this.tTa.cancel(),this.Geg(),this.setOpacity(1));this.set_visible(!0)}eo(qa,ma,Ga,vb,Ka=!1){qa=eb.a(vb).Jh(qa);ma=eb.a(vb).Jh(ma);eb.a(vb).yzc(this.domElement);this.domElement.style.top=la.HelperMethods.zc(ma);this.domElement.style.left=this.domElement.style.right=
"";ma=qa;Ka&&(ma=qa-this.domElement.offsetWidth);ua.c(this.domElement.style,Ga,la.HelperMethods.zc(ma));this.set_visible(!0);this.setOpacity(1);this.alc&&(this.QWd=!1,this.KSj(),this.tTa.$p())}hide(){this.zdb();this.set_visible(!1);this.alc&&(this.Geg(),this.tTa.cancel())}e$b(){this.Gc.la("mouseover",this.DN,!0);this.Gc.la("mouseout",this.CN,!0)}KSj(){this.eZ.Mi("mousemove")||this.eZ.la("mousemove",this.QVi)}Geg(){this.eZ.Mi("mousemove")&&this.eZ.detach("mousemove")}hmd(qa){if(this.domElement.parentNode){var ma=
Sys.UI.DomElement.getBounds(this.domElement);const Ga=new Sys.UI.Point(Math.round(ma.x+ma.width),Math.round(ma.y+ma.height));ma=Math.abs(Ga.x-qa.x);qa=Math.abs(Ga.y-qa.y);qa=ma>qa?ma:qa;this.QWd?this.setOpacity(Eb.M3g(qa)):100>=qa&&this.dpe()}}dpe(){this.QWd=!0;this.tTa.cancel()}setOpacity(qa){C.a.setOpacity(this.domElement,qa);this.xrf=y.a.Ya.Zb}static M3g(qa){return 100>=qa?1:250<=qa?0:.01*(100-(qa-100)/150*100)}}Object(f.a)(Eb,"OnObjectButton",D.a,[699,144,3]);var Wb=a(809);const Ab=Da.XBh;class Jb extends n.a{constructor(qa,
ma,Ga,vb,Ka,Pa,fb,Wa,Ma=""){super();this.Zwa=null;this.fff=!1;this.htmlSanitizationHelper=this.Aoc=this.Boc=null;this.buttons={};this.MSe={};this.$=qa;this.svgIconProvider=ma;this.iUi=Ga;this.Sgc=vb;this.Rgc=Ka;this.altText=Pa;this.UIb=fb;this.htmlSanitizationHelper=Wa;this.buttonText=Ma}get kz(){return eb.a(this.$).eHa(Ya.a.N0i)}get z4b(){return Ya.a.M0i}get buttonWidth(){return eb.a(this.$).eHa(Ya.a.O0i)}dispose(){this.urh();this.$=null;super.dispose()}getButton(qa,ma=!0){return this.Hva(qa,ma)}Hva(qa,
ma=!0){const Ga=qa.toString();Ga in this.buttons||this.Ehh(qa,ma);return this.buttons[Ga]}eo(qa,ma,Ga,vb,Ka=!0,Pa=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&ba.i(this.$.na)){var fb=J.h(this.$).aS.domElement;const Wa=qa+this.buttonWidth-fb.scrollWidth;fb=ma+this.buttonWidth-fb.scrollHeight;qa=0<Wa?qa-Wa:qa;ma=0<fb?ma-fb:ma}this.Hva(vb,Ka).eo(qa,ma,Ga,this.$,Pa)}hide(){const qa=this.buttons;for(let ma in qa)qa[ma].hide()}e$b(qa,ma){!this.fff&&(ma=this.buttons[ma.toString()])&&(this.Boc=(Ga,
vb)=>{qa(vb,!0)},ma.SQg(this.Boc),this.Aoc=(Ga,vb)=>{qa(vb,!1)},ma.RQg(this.Aoc),this.fff=!0,ma.e$b())}Ehh(qa,ma){this.Zwa=String.format(this.Sgc===G.a.W$b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',ib.a.Og(this.Sgc),ib.a.Og(this.Rgc),"{0}");var Ga=String.format(this.Zwa,ib.a.Og(this.altText));ma=new Eb(""===this.buttonText?Da.VBh:Da.YBh,""===this.buttonText?Da.WBh:Da.ZBh,G.a.kv,
Ga,ma,this.UIb,this.buttonText,Ab,this.htmlSanitizationHelper);Ga=(vb,Ka)=>{this.iUi(Ka,qa)};ma.y2(Ga);this.buttons[qa.toString()]=ma;this.MSe[qa.toString()]=Ga;Ga=J.h(this.$).Vf(qa);Ga.domElement.insertBefore(ma.domElement,Ga.domElement.firstChild)}urh(){for(const qa of Wb.a(this.buttons)){const ma=this.buttons[qa];ma.Pda(this.MSe[qa]);ta.a.Ja(ma);delete this.buttons[qa];this.Boc&&ma.npj(this.Boc);this.Aoc&&ma.mpj(this.Aoc)}}domElement(qa){return this.Hva(qa).domElement}u3a(qa){this.Hva(qa).u3a()}Cmg(qa,
ma){this.Sgc=qa;this.Rgc=ma}mRb(qa,ma,Ga=!0){this.Zwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',ib.a.Og(this.Sgc),ib.a.Og(this.Rgc),"{0}");qa=String.format(this.Zwa,ib.a.Og(qa));this.Hva(ma,Ga).t1d(qa)}SUa(qa,ma,Ga){this.Hva(Ga,!1).d4j(qa,ma)}Amg(){this.Zwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",ib.a.Og(this.Rgc),"{1}");const qa=String.format(this.Zwa,void 0,
ib.a.Og(void 0));this.Hva(void 0,!1).t1d(qa)}Bmg(qa,ma,Ga){this.Hva(Ga,!1).c4j(this.svgIconProvider,qa,ma)}}Object(f.a)(Jb,"OnObjectLaunchButton",n.a,[687,3]);n=a(99);class Gb extends n.a{constructor(qa,ma){super(qa);this.EEb=null;this.erh=()=>{this.display()};this.jji=Math.max(1,ma)}dispose(){ta.a.Ja(this.EEb);this.EEb=null;super.dispose()}JTa(){ta.a.Ja(this.EEb);this.EEb=m.a.instance.create(this.erh,this.jji,u.a.zFi)}PTa(){ta.a.Ja(this.EEb);this.hide()}}Object(f.a)(Gb,"LoadingIndicatorBehavior",
n.a,[698,3]);class Nb extends Gb{constructor(qa,ma,Ga,vb){super(qa,ma);this.DEb=null;this.Oyg=Ga;this.xgi=vb;this.CMg()}dispose(){this.DEb=null;super.dispose()}display(){this.Oyg(this.DEb)}hide(){this.xgi(this.DEb)}CMg(){this.DEb=document.createElement("div");this.domElement.appendChild(this.DEb)}}Object(f.a)(Nb,"ShimmerLoadingIndicatorBehavior",Gb,[]);var Ja=a(76),ab=a(52),wb=a(12);class xb extends Gb{constructor(qa,ma,Ga,vb=null,Ka=null,Pa=0){super(qa,ma);this.Twa=this.BOa=null;this.Twa=Ga;this.Xgc=
vb||ab.a.current.Un(104);this.ntf=Pa;this.y8c=Ka;this.BMg()}dispose(){this.BOa=null;super.dispose()}display(){wb.DOMElementExtensions.setVisible(this.BOa,!0)}hide(){wb.DOMElementExtensions.setVisible(this.BOa,!1)}BMg(){this.BOa=document.createElement("div");this.BOa.classList.add(Ja.a.EAh);const qa=document.createElement("div");qa.classList.add(Ja.a.FAh);this.y8c&&""!=this.y8c&&qa.classList.add(this.y8c);var ma=0===this.ntf?"":N.a.instance.ga(this.ntf);const Ga=String.format('<div class="'+Ja.a.GAh+
'">{0}</div>',ma);this.Xgc?(ma=`<img src="${this.Xgc}" alt="${ma}" title="${ma}"/>`,this.Twa?this.Twa.jh(qa,ma+Ga):qa.innerHTML=ma+Ga):this.Twa?this.Twa.jh(qa,Ga):qa.innerHTML=Ga;this.BOa.appendChild(qa);this.domElement.appendChild(this.BOa)}}Object(f.a)(xb,"SpinnerLoadingIndicatorBehavior",Gb,[]);var rb=a(153),za=a(54),Aa=a(108),pb=a(50);Object(rb.b)(za.L)(qa=>Object(l.a)(void 0,void 0,void 0,function*(){const ma=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7134912_ReduceInnerHTMLUsageSpinnerLoading")?
yield c(qa.Wb):null;return new kb(ma)}));class kb{constructor(qa){this.Twa=qa}x7c(qa,ma,Ga){return new $a.a(qa,ma,Ga)}b7b(qa,ma,Ga,vb,Ka,Pa,fb,Wa,Ma,lb){return new cb.a(qa,ma,Ga,vb,Ka,Pa,fb,Wa,Ma,lb)}Mtb(qa,ma,Ga,vb,Ka=0){return new xb(qa,ma,this.Twa,Ga,vb,Ka)}wjd(qa){return qa.da.Ba(238)||new ea(qa)}e7b(qa,ma,Ga,vb,Ka,Pa,fb,Wa=""){return new Jb(qa,ma,Ga,vb,Ka,Pa,fb,this.Twa,Wa)}$6c(qa,ma){return new Ea(qa,ma)}Agh(qa,ma,Ga,vb){return new pa(qa,ma,Ga,vb)}F6c(qa,ma,Ga,vb){return new z(qa,ma,Ga,vb)}}
Object(f.a)(kb,"SharedUIControlsFactory",null,[663]);class Cb extends d.a{constructor(qa){super();this.$=qa;this.Gb()}create(){if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7134912_ReduceInnerHTMLUsageSpinnerLoading")){const qa=h.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(Aa.c)(rb.a.resolve(za.w,{Wb:this.Na})):pb.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na);
x.TaskExtensions.za(qa,()=>{this.qb(this.$.da.Ba(12)||new kb(qa.result))},this.ka,3)}else this.qb(this.$.da.Ba(12)||new kb(null))}static la(qa){qa.da.Ha(477,new Cb(qa))}}Object(f.a)(Cb,"SharedUIControlsFactoryServiceFactory",d.a,[]);a.d(B,"a",function(){return ob});const ob=()=>{b.a.Fa(qa=>{Object(e.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")||Cb.la(qa)})};String(r);window.___1678693024811_closurehack=r},1202:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(50),f=a(38),d=a(1),
h=a(831),l=a(108),k=a(153),w=a(54);class n extends b.a{constructor(Ma){super();this.$=Ma;this.Gb()}create(){let Ma;Ma=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(l.c)(k.a.resolve(w.r,{Wb:this.Na})):e.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Na);const lb=e.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Na);f.TaskExtensions.za(f.TaskExtensions.Md([Ma,lb],this.ka),()=>{this.qb(this.$.da.Ba(296)||this.$.da.Ha(296,new h.BorderFormatManager(this.$,
Ma.result,lb.result)))},this.ka,3)}static la(Ma){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&Ma.da.Ha(468,new n(Ma))}}Object(r.a)(n,"BorderFormatManagerFactory",b.a,[]);var x=a(714),m=a(15),u=a(274),t=a(178),y=a(845),v=a(27),A=a(41),z=a(31),C=a(100),H=a(270),I=a(361),S=a(358),P=a(102),D=a(197),G=a(8),E;(function(Ma){Ma[Ma.insert=1]="insert";Ma[Ma.delete=2]="delete";Ma[Ma.rows=4]="rows";Ma[Ma.columns=8]="columns";Ma[Ma.cellsShiftHorizontal=16]="cellsShiftHorizontal";
Ma[Ma.cellsShiftVertical=32]="cellsShiftVertical";Ma[Ma.insertRows=5]="insertRows";Ma[Ma.insertColumns=9]="insertColumns";Ma[Ma.insertCellsShiftRight=17]="insertCellsShiftRight";Ma[Ma.insertCellsShiftDown=33]="insertCellsShiftDown";Ma[Ma.deleteRows=6]="deleteRows";Ma[Ma.deleteColumns=10]="deleteColumns";Ma[Ma.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";Ma[Ma.deleteCellsShiftUp=34]="deleteCellsShiftUp";Ma[Ma.insertRowsBelow=37]="insertRowsBelow"})(E||(E={}));Object(r.b)("InsertDeleteCellFlags",
E);var O=a(5),N=a(429),J=a(71),W=a(73);class ea{constructor(Ma){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=Ma}}Object(r.a)(ea,"MacroRecorderRangeInsertedOrDeletedPayload",null,[123]);var R=a(1110),Y=a(44),U=a(379),da=a(198),T=a(63),ka=a(291),L=a(151),fa=a(462),wa=a(121),oa=a(52),xa=a(206),bb=a(96),Za=a(36),La=a(29),va=a(255),Ba=a(266),Ea=a(11),pa=a(196),$a=a(22),cb=a(290);class ib{constructor(Ma,lb,Na,X,F=0){this.cAg=Ma;this.dAg=lb;this.OHg=Na;this.gZb=X;this.hNh=
F}get IKa(){return this.cAg}get formattedText(){return this.dAg}get style(){return this.OHg}get size(){return this.gZb}get wZ(){return this.hNh}static q1g(Ma,lb){return new ib(Ma,lb,null,null,null)}static C1c(Ma,lb){return new ib(Ma,null,lb,null,null)}static r1g(Ma,lb){return new ib(Ma,null,null,lb,null)}static p1g(Ma,lb,Na){return new ib(Ma,null,lb,null,Na)}}Object(r.a)(ib,"CachedPreviewCellGroup",null,[]);var ta=a(87);b=a(292);var Ya=a(104),Da=a(14);class ba extends b.a{constructor(Ma,lb,Na){super(Ma);
this.ll=null;this.R9c=0;this.mni=(X,F)=>{if(0===X)m.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{X={};var na="",hb=1035996630;switch(F.selectedKey){case 0:na=1896159024===this.Er?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:na=1896159024===this.Er?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.Er?(na="InsertRows",hb=-1113896058):(na="DeleteRows",hb=1554436520);break;case 3:1896159024===
this.Er?(na="InsertColumns",hb=1415868706):(na="DeleteColumns",hb=674605324)}m.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${na}`);F=new bb.a(hb,1,2,8,null);X[W.a.Pc]=na;this.$.Ia.Hb(F,X)}};this.Er=lb;this.selectedRanges=Na;this.isRtl=Object(ta.a)(Ya.a,this.$.ua.na).displayRtl}get pc(){return"InsertDeleteCellsDialog"}tg(){1896159024===this.Er?(this.ll=Da.a.instance.ga(23),this.R9c=0):(this.ll=Da.a.instance.ga(22),
this.R9c=1);const Ma=this.selectedRanges[0].g_&&!this.selectedRanges[0].v5?0:1;this.Rb=1;this.initializeAndShow(this.ll,this.mni,{[ba.pt]:this.pc,["dialogToDisplay"]:this.R9c,["defaultSelectedKey"]:Ma,["isRtl"]:this.isRtl})}}Object(r.a)(ba,"InsertDeleteCellsDialog",b.a,[]);const ya=(Ma,lb,Na,X,F,na,hb=null)=>{hb=Ma.Oa(41,hb);hb.insertDeleteMultiRangeParameters=lb;return T.g(Ma,"InsertDeleteCells",hb,Na,X,F,na,0)};class V{constructor(Ma,lb,Na,X){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=
this.fillRangeType=0;this.sourceSheetRange=Ma;this.targetSheetRange=lb;this.fillRangeType=Na;this.fillRangeDirection=X}}Object(r.a)(V,"MacroRecorderRangeFilledPayload",null,[123]);var Z=a(7),ja=a(24);class la{constructor(){this.PRa=this.IHa=this.sOa=this.wUa=0}}Object(r.a)(la,"RangeBorders",null,[]);class ua{constructor(){this.scenario=0;this.tQ=null}}Object(r.a)(ua,"ScenarioInfo",null,[]);var eb=a(935),Eb=a(21),Wb=a(273),Ab=a(215),Jb=a(83),Gb=a(62);class Nb{constructor(Ma,lb){this.$=Ma;this.Zg=lb;
this.Dx=new eb.a(Eb.h(this.$).Ca);this.pBb=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Qsd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.Ojc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.rlf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.Ori=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");
this.Bpf=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.vkc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");this.gCb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Pjc=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.pvi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");
this.Xri=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.hjf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");this.olf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.Hvi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.hBi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=
null}Wri(Ma,lb){return!(void 0===lb||null===lb)&&!!(lb.scenario&16384)&&!this.Yri(Ma,lb)&&this.ajf(lb,Ma)}H6e(){var Ma=A.a.Yd(),lb=Eb.h(this.$),Na=lb.ha.ra.selectedRanges;let X=0;var F=0,na=Na.length;const hb=new ua;if(1<na)return hb.scenario=4,hb;if(this.olf&&(na=lb.gk("MergeCell"),Object(Gb.a)(na),na.value.rCb(Na[0])))return hb.scenario=262144,hb;this.Qsd&&Eb.h(this.$).rtl&&(X|=65536);if(!lb.gN(Na[0]))if(this.pBb)X|=32;else return hb.scenario=32,hb;if(lb=lb.Ca.gka(Na[0],this.$.activeItemName)){hb.Y0c=
lb;for(var Ib of lb)if(F+=1,1<F){this.pBb?(X|=256,hb.scenario=X):hb.scenario=256;if(!this.gCb)return hb;break}}F=Eb.h(this.$).Ca.Tja(Na[0]);if(!F)return hb.scenario=32768,hb;Ib=F.length;Na=Na[0];lb=Na.bottom-Na.top+1;na=Na.right-Na.left+1;const vc=new la;for(let nc=0;nc<Ib;nc++)if(this.U4h(F[nc],Na,vc),X=X|(void 0!==F[nc].text&&null!==F[nc].text&&""!==F[nc].text?1:0)|(F[nc].sz?2:0)|(F[nc].Ika?8:0)|(F[nc].nzb?16:0)|(F[nc].WA?64:0)|(F[nc].TM?128:0),void 0!==F[nc].text&&null!==F[nc].text&&""!==F[nc].text||
F[nc].Ika)if(void 0===hb.tQ||null===hb.tQ)hb.tQ=Eb.h(this.$).Jb(F[nc].getRange());else{if(F[nc].getRange().top<hb.tQ.range.top||F[nc].getRange().top==hb.tQ.range.top&&F[nc].getRange().left<hb.tQ.range.left)hb.tQ=Eb.h(this.$).Jb(F[nc].getRange());X|=16384}vc.wUa===na&&(X|=512);vc.IHa===na&&(X|=2048);vc.sOa===lb&&(X|=4096);vc.PRa===lb&&(X|=1024);if(0<vc.wUa&&vc.wUa<na||0<vc.IHa&&vc.IHa<na||0<vc.sOa&&vc.sOa<lb||0<vc.PRa&&vc.PRa<lb)X|=8192;!d.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||
Na.right!==Na.maxColumns&&Na.bottom!==Na.maxRows||(X|=131072);Ma=A.a.Yd()-Ma;m.ULS.sendTraceTag(537159424,0,50,`Execution time of GetMergeCellScenario is : ${Ma}`);hb.scenario=X;return hb}Vxf(Ma,lb){const Na=Ma.command;if(void 0===lb||null===lb)lb=this.H6e();if(!this.ajf(lb,Na))return!1;Ma=Eb.h(this.$).ha.ra.selectedRanges;var X=Eb.h(this.$).Ca.Tja(Ma[0]);if(!X)return!1;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===X.length&&!X[0].sz)return-167499203===
Na?(X[0].E0(2,!0),!0):!1;X=Eb.h(this.$).ha.ra.Mq;const F=this.$.na.sheetName;let na=!0;switch(Na){case -167499203:2===(lb.scenario&2)&&this.Ojc?this.Ikg(lb.scenario,Ma,Na):na=this.FMi(lb,Ma);break;case 1097660126:(lb=this.Wxf(lb,Ma))&&0!=lb.length||(na=!1);break;case 155820588:this.Ikg(lb.scenario,Ma,Na);break;default:return!1}Eb.h(this.$).KZ(Ma,X,F,null,Ma[0],null,null,0,"MergeCellCommandAction");return this.gCb?na:!0}ajf(Ma,lb){const Na=this.Gqi(Ma,lb);if(!this.rlf)return Na;const X=Eb.h(this.$).ha.ra.selectedRanges[0].ZC(!1);
m.ULS.sendTraceTag(526149324,0,50,`Merge Cell Command: ${lb.toString()}; Scenario Number: ${Ma.scenario}; IsCSEPossible result: ${Na}; Range: ${X}`);return Na}Gqi(Ma,lb){if(-255094134===lb)return!1;var Na=Ma.scenario;if(this.olf&&262144===Na||this.Qsd&&65536===(Na&65536))return!1;if(this.Apf(lb,Ma))return Na=Eb.h(this.$).ha.ra.selectedRanges,0===Na.length?!1:this.nAi(lb,Ma,Na[0]);this.pBb&&32===(Na&32)&&(Na&=-33);if(256==(Na&256))if(this.Gvi(Ma))Na&=-257;else return!1;return 32768===Na||4===Na||128===
(Na&128)||!this.pBb&&32===Na?!1:-167499203!=lb&&1097660126!==lb||!this.Jqd(Ma)?void 0!==Ma.tQ&&null!==Ma.tQ&&Ma.tQ.BS?!1:0===Na?!0:16384===(Na&16384)?d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Na&1)&&8!==(Na&8)||!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.Pjc}Lsi(Ma){return 131072===(Ma.scenario&131072)?!0:!1}Gvi(Ma){if(!this.gCb)return!1;let lb="Multi block",Na=!0;this.Jqd(Ma)&&(lb+=
" with border",Na=!1);this.Lsi(Ma)&&(Na=!1,lb+=" with entire row or column selected",16384===(Ma.scenario&16384)&&(lb+=" and a data loss scenario"));Na||m.ULS.sendTraceTag(523511383,0,50,`CSE for ${lb}, is not enabled`);return Na}Jqd(Ma){return 16===(Ma.scenario&16)||this.Emd(Ma.scenario)||this.Ymd(Ma.scenario)||this.Pmd(Ma.scenario)||this.$md(Ma.scenario)||8192===(Ma.scenario&8192)?!0:!1}Yri(Ma,lb){return this.Xri?this.Apf(Ma,lb):155820588===Ma}Apf(Ma,lb){return 155820588===Ma||(-167499203===Ma||
1097660126===Ma)&&2===(lb.scenario&2)&&this.Ojc?!0:!1}mAi(Ma){return this.$md(Ma.scenario)||this.Pmd(Ma.scenario)||this.Emd(Ma.scenario)||this.Ymd(Ma.scenario)?!0:!1}wfi(Ma){Ma=Eb.h(this.$).Ca.Tja(Ma);if(!Ma||0===Ma.length)return!1;for(let lb=0;lb<Ma.length;lb++)if(Ma[lb].sz&&Ma[lb].BS)return!0;return!1}nAi(Ma,lb,Na){if(1097660126===Ma&&2===(lb.scenario&2))return!1;if(this.hBi){if(this.wfi(Na))return!1}else if(this.Ori&&void 0!==lb.tQ&&null!==lb.tQ&&lb.tQ.BS)return!1;this.pBb&&32===(lb.scenario&32)&&
(lb.scenario&=-33);return 32768===lb.scenario||4===lb.scenario||256===(lb.scenario&256)&&this.pvi||128===(lb.scenario&128)?!1:2===(lb.scenario&2)?this.mAi(lb)?d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1}U4h(Ma,lb,Na){const X=Ma.getRange();if(X.top===lb.top)if(Ma.cMa)Na.wUa+=X.right-X.left+1;else{var F=this.Dx.zQ(X,0);if(F)for(const hb of F)hb.Cwa&&
(Na.wUa+=hb.getRange().right-hb.getRange().left+1)}if(X.left===lb.left)if(Ma.aMa)Na.sOa+=X.bottom-X.top+1;else if(F=this.Dx.zQ(X,2))for(var na of F)na.Hwa&&(Na.sOa+=na.getRange().bottom-na.getRange().top+1);if(X.bottom===lb.bottom)if(Ma.Cwa)Na.IHa+=X.right-X.left+1;else if(na=this.Dx.zQ(X,1))for(const hb of na)hb.cMa&&(Na.IHa+=hb.getRange().right-hb.getRange().left+1);if(X.right===lb.right)if(Ma.Hwa)Na.PRa+=X.bottom-X.top+1;else if(Ma=this.Dx.zQ(X,3))for(const hb of Ma)hb.aMa&&(Na.PRa+=hb.getRange().bottom-
hb.getRange().top+1)}rmj(Ma,lb){for(let Na of lb.Y0c){lb=Ma.xe(Na.Be);lb=Eb.h(this.$).Ca.Tja(lb);const X=lb.length;for(let F=1;F<X;F++){const na=Eb.h(this.$).Jb(lb[F].getRange());this.Pjc?na.cell.deleteCellFromModel():(na.ksb(),na.clearFormat(),na.cell.smj());na.vKb(!0)}}}A7j(Ma,lb){Ma.backgroundColor=lb.backgroundColor;Ma.color=lb.color}asg(Ma,lb){return{SpansBlocks:!0,OriginRow:Ma,OriginColumn:lb,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}nLg(Ma,lb,Na,X,F){Na=Ma.xe(Na.Be);
if(!Na)return m.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var na=new ja.Range(Ma.top,Ma.left,Na.top,Na.left,!1,!1);let hb;Na.top==Ma.top?hb=0:(na.bottom=Na.top-1,hb=lb.Rjd(na));Na.left==Ma.left?na=0:(na.right=Na.left-1,na=lb.Sjd(na));lb=this.asg(Ma.top-1,Ma.left-1);lb.OriginDeltaY=hb;lb.OriginDeltaX=na;lb.Rows=Na.bottom-Na.top;lb.Columns=Na.right-Na.left;
lb.Height=F;lb.Width=X;Na.top==Ma.top&&Na.left==Ma.left&&(lb.IsOrigin=!0);Ma=Eb.h(this.$).Jb(Na.topLeft);Ma.cell.d8f(lb);return Ma}uTd(Ma,lb){let Na=[];const X=Eb.h(this.$).gk("MergeCell");if(!Object(Gb.c)(X))return Na;const F=X.value.Rjd(Ma),na=X.value.Sjd(Ma);if(lb.Y0c)for(const hb of lb.Y0c)if(lb=this.nLg(Ma,X.value,hb,na,F))Na.push(lb);else{Na=[];break}return Na}Y5h(Ma,lb,Na,X){var F=Na.bottom-Na.top,na=Na.right-Na.left;let hb=[];const Ib=X.scenario;if(256===(Ib&256)){if(hb=this.uTd(Na,X),!hb||
0==hb.length)return hb}else lb.cell.uTd(F,na),hb.push(lb);F=this.Y2(this.S4(lb),!0,0,Ib,"merge");if(void 0!==Ma&&null!==Ma)for(const vc of hb){na=Ma.cell.formattedText;const nc=Object(Z.a)(new Wb.a,{TextRuns:na.TextRuns,Fonts:na.Fonts});nc.Text=void 0!==Ma.cell.originalText&&null!==Ma.cell.originalText?Ma.cell.originalText:void 0!==Ma.cell.userInput&&null!==Ma.cell.userInput?Ma.cell.userInput:na.Text;F=this.Y2(this.S4(vc),F,1,Ib,"merge");this.Zg.jTa(vc,nc,!1,!0,"MergeCells",1);F=this.Y2(this.S4(vc),
F,2,Ib,"merge");this.Qsd?vc.usb(Ma):this.A7j(vc,Ma);F=this.Y2(this.S4(vc),F,3,Ib,"merge");vc.cell.Hdh(Ma.cell);F=this.Y2(this.S4(vc),F,4,Ib,"merge");vc.cell.JFc(!1);F=this.Y2(this.S4(vc),F,6,Ib,"merge")}this.rmj(Na,X);this.Y2(this.S4(lb),F,5,Ib,"merge");return hb}Pmd(Ma){return 4096===(Ma&4096)}$md(Ma){return 512===(Ma&512)}Emd(Ma){return 2048===(Ma&2048)}Ymd(Ma){return 1024===(Ma&1024)}Mcc(Ma,lb){let Na=null;for(let X=0;X<Ma.length;X++)if(Ma[X].BorderPosition===lb){Na=Ma[X];break}return Na}U0h(Ma,
lb){this.vkc?(lb=this.Mcc(lb.cell.JM().Borders,2))&&Ma.push(lb):(lb=lb.cell.JM().Borders,1<lb.length&&(lb=[lb[1]]),Ma=[...lb,...Ma]);return Ma}v9h(Ma,lb){this.vkc?(lb=this.Mcc(lb.cell.JM().Borders,0))&&Ma.push(lb):(lb=lb.cell.JM().Borders,1<lb.length&&(lb=[lb[0]]),Ma=[...lb,...Ma]);return Ma}FTh(Ma,lb){lb=this.Dx.zQ(lb.cell.getRange(),1);if(!lb||0===lb.length)return Ma;if(this.vkc){if(lb=lb[0].JM().Borders,lb=this.Mcc(lb,0))lb.BorderPosition=1,Ma.push(lb)}else{let Na=[];0<lb.length&&(Na=lb[0].JM().Borders);
Na[0].BorderPosition=1;Ma=[...Na,...Ma]}return Ma}i6h(Ma,lb){lb=this.Dx.zQ(lb.cell.getRange(),3);if(!lb||0===lb.length)return Ma;if(this.vkc){if(lb=lb[0].JM().Borders,lb=this.Mcc(lb,2))lb.BorderPosition=3,Ma.push(lb)}else{let Na=[];0<lb.length&&(Na=lb[0].JM().Borders);Na[0].BorderPosition=3;Ma=[...Na,...Ma]}return Ma}V4h(Ma,lb,Na){this.Pmd(Ma.scenario)&&(lb=this.U0h(lb,Na));this.$md(Ma.scenario)&&(lb=this.v9h(lb,Na));this.Emd(Ma.scenario)&&(lb=this.FTh(lb,Na));this.Ymd(Ma.scenario)&&(lb=this.i6h(lb,
Na));return lb}yZ(Ma){if(0===Ma.length)return null;let lb=[0,0,0,0],Na=[1,1,1,1],X=0;Ma.forEach(function(na){let hb=na.BorderPosition;Na[hb]=na.BorderLineStyle;let Ib=new Ab.a(na.Color.Red,na.Color.Green,na.Color.Blue);lb[hb]=Ib.pS();X|=Ea.HelperMethods.T4a(na.BorderPosition)});Ma={};Ma.LineStyle=Na;Ma.Color=lb;let F={};F.BorderFormat=Ma;F.Border=X;return F}m5d(Ma,lb,Na=null){let X=[];X=null!==Na?[...Na]:this.V4h(lb,X,Ma);if(lb=this.yZ(X))Ma.cell.Tcb(Ma.cell.getRange()),this.Dx.uKb(Ma.cell.getRange()),
this.Zg.vea(Eb.h(this.$),-1690267012,lb,!1,null,[Ma.cell.getRange()])}Uwi(Ma){return 512===(Ma.scenario&512)||4096===(Ma.scenario&4096)||1024===(Ma.scenario&1024)||2048===(Ma.scenario&2048)?!0:!1}w9h(Ma){Ma=this.Dx.zQ(Ma.cell.getRange(),1);return Ma&&0!==Ma.length?Ma[0].cMa?(Ma=Ma[0].JM().Borders[0],Ma.BorderPosition=1,Ma):null:null}x9h(Ma){Ma=this.Dx.zQ(Ma.cell.getRange(),3);return Ma&&0!==Ma.length?Ma[0].aMa?(Ma=Ma[0].JM().Borders[0],Ma.BorderPosition=3,Ma):null:null}fdi(Ma,lb,Na,X,F){lb.cell.Omg();
if(this.Uwi(Ma))this.m5d(lb,Ma);else{const na=8192===(Ma.scenario&8192),hb=lb.cell.getRange();na&&this.hjf?(lb.cell.Tcb(),this.Dx.uKb(hb)):F?(F=[],null!==Na&&F.push(Na),null!==X&&F.push(X),0<F.length?this.m5d(lb,Ma,F):(lb.cell.Tcb(),this.Dx.uKb(hb))):na&&!this.hjf&&(lb.cell.Tcb(),this.Dx.uKb(hb))}}o0h(Ma,lb){return null===Ma||void 0===Ma?!0:Ma.cell.getRange().top===lb.topLeft.top&&Ma.cell.getRange().left===lb.topLeft.left&&Ma.cell.getRange().bottom===lb.topLeft.bottom&&Ma.cell.getRange().right===
lb.topLeft.right?!0:!1}FMi(Ma,lb){lb=this.Wxf(Ma,lb);if(this.gCb&&(!lb||0==lb.length))return!1;for(let Na=0;Na<lb.length;Na++)lb[Na].E0(2,!0),this.Y2(this.S4(lb[Na]),!0,8,Ma.scenario,"merge");return!0}Z5j(Ma){const lb=Eb.h(this.$).Ca.gka(Ma,this.$.activeItemName);if(lb&&Jb.Ct(lb))for(let Na of lb)Na.S1d(Ma,!0)}Wxf(Ma,lb){const Na=Ma.tQ,X=Eb.h(this.$).Jb(lb[0]);let F=null,na=null;this.Pjc&&(F=this.w9h(X),na=this.x9h(X));const hb=this.Y5h(Na,X,lb[0],Ma);if(this.gCb&&(!hb||0==hb.length))return hb;this.Hvi?
this.Z5j(lb[0]):Eb.h(this.$).Ca.Bha(lb[0],this.$.activeItemName).S1d(lb[0],!0);this.Y2(this.S4(X),!0,9,Ma.scenario,"merge");if(this.Pjc&&this.Jqd(Ma)){lb=this.o0h(Na,lb[0]);for(const Ib of hb)this.fdi(Ma,Ib,F,na,lb)}return hb}yVg(Ma,lb,Na){if(!(1>Ma.Borders.length)){var X=this.yZ(Ma.Borders);Na.forEach(F=>{F=Eb.h(this.$).Jb(F.getRange());this.Zg.Gbg(-1690267012,F,X,!1,null,!1,lb)})}}t2j(Ma,lb,Na){const X=Ma.length;for(let na=0;na<X;na++){Ma[na].cell.JFc();const hb=Ma[na].cell.getRange(),Ib=Eb.h(this.$).Ca.Tja(hb),
vc=Ib.length;if(-167499203===lb&&this.Ojc){var F=0;2===Ma[na].cell.mLd||1===Ma[na].cell.sC?F=3:2===Ma[na].cell.sC&&(F=1);Ma[na].E0(F,!1)}for(F=1;F<vc;F++)Ib[F].attachCellToModel(),Ib[F].usb(Ma[na]),-167499203===lb&&this.Ojc&&Ib[F].E0(null,!1);this.Bpf&&Na&&this.yVg(Na[na],hb,Ib)}}Z1e(Ma,lb){let Na=null;for(let X=0;X<Ma.length;X++)if(Ma[X].BorderPosition===lb){Na=Ma[X];break}return Na}ETh(Ma,lb){let Na=Ma.cell.JM();Ma.Cwa()&&Ma.cell.jRa(1);Ma.Hwa()&&Ma.cell.jRa(3);if((Ma=this.Dx.zQ(lb,0))&&Ma[0].Cwa){var X=
Ma[0].JM().Borders;X=this.Z1e(X,1);X.BorderPosition=0;Na.Borders.push(X);Ma.forEach(F=>{F.jRa(1)})}(lb=this.Dx.zQ(lb,2))&&lb[0].Hwa&&(Ma=lb[0].JM().Borders,Ma=this.Z1e(Ma,3),Ma.BorderPosition=2,Na.Borders.push(Ma),lb.forEach(F=>{F.jRa(3)}));return Na}Ikg(Ma,lb,Na){var X=Eb.h(this.$).Ca.Wva(lb[0],this.$.activeItemName);const F=Eb.h(this.$).Ca.Bha(lb[0],this.$.activeItemName),na=[];if(void 0!==X&&null!==X&&(lb=Eb.h(this.$).fka(lb[0],X),void 0!==lb&&null!==lb)){lb=lb.$$ge();for(X=[];lb.$$mn();){var hb=
lb.$$cu();if(hb.NH){na.push(hb);this.Y2(this.S4(hb),!0,10,Ma,"unmerge");hb.cell.u8g();const Ib=hb.cell.getRange();this.Y2(this.S4(hb),!1,11,Ma,"unmerge");F.S1d(Ib,!1);this.Bpf&&(hb=this.ETh(hb,Ib),X.push(hb))}}0<na.length&&(F.wf.resetCellLookup(),this.t2j(na,Na,X))}}Y2(Ma,lb,Na,X,F){if(!this.rlf)return!1;Ma!==lb&&m.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${Na}; Scenario: ${X}; Command: ${F}; Expected: ${lb?"populated":"empty"}; Actual: ${Ma?
"populated":"empty"}`);return Ma}S4(Ma){return!!Ma.cell.cell.Merge}}Object(r.a)(Nb,"MergeCellCommandAction",null,[]);var Ja=a(68),ab=a(184),wb=a(46),xb=a(386),rb=a(298),za=a(53),Aa=a(74),pb=a(58),kb=a(1118),Cb=a(33),ob=a(350),qa=a(150),ma=a(217),Ga=a(4),vb=a(384),Ka=a(70);class Pa{constructor(Ma,lb,Na,X,F,na,hb){this.$=Ma;this.gridView=lb;this.Zg=Na;this.tB=X;this.borderFormatManager=F;this.moreColorsHelper=na;this.fontDropdownHelper=hb;this.pC=null;this.D0a=1461300262;this.u6b=this.fr=this.A0a=this.n$a=
this.Xbc=null;this.SZi=(Ib,vc,nc)=>{const Pb=!!Ib&&!!Ib.RequestTelemetryData;!va.a(Ib)&&vc&&Eb.h(this.$).Dh.kma(vc,Ib.StateId,Pb?Ib.RequestTelemetryData.EcsOperationDuration:0,Pb?Ib.RequestTelemetryData.EcsRequestDuration:0,Pb?Ib.RequestTelemetryData.WfeRequestDuration:0);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){vc=1;if(33===nc||17===nc||9===nc||5===nc||37===nc)vc=0;this.X0(vc,Ib)}};this.FWi=Ib=>{d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!1)&&this.X0(3,Ib)};this.osb=()=>{this.gridView.K7a&&(this.copyPasteInfrastructure&&this.copyPasteInfrastructure.ypj(this.osb),this.gridView.K7a=!1,this.gridView.Ng.Ap(O.a.gV),this.gridView.ha.j0(this.bfd),Eb.h(this.$).$.tf())};this.bfd=()=>{var Ib=this.Xbc;this.Xbc=J.d(this.$.ua.na);Ib===this.Xbc&&(this.gridView.ha.j0(this.bfd),this.copyPasteInfrastructure&&this.copyPasteInfrastructure.n2c(36,Eb.h(this.$).ha.ra.selectedRanges)?(Ib=new bb.a(1804571062,2,2,0,null),this.$.Ia.Hb(Ib,{[O.a.skipClipboardAccess]:!0,
[O.a.K3c]:!0,[O.a.isFormatPainter]:!0}).continueWith(()=>{this.osb()})):this.gridView.Ng.mM(!1))};this.yc=()=>{this.pH&&0!==this.pH.joc&&m.ULS.sendTraceTag(509690145,0,20,`GridCommandHandler::onWorkbookClosing: Font Usage Telemetry - {"newFontCount":${this.pH.ZBd},"oldFontCount":${this.pH.qDd},"setFontCount":${this.pH.cTd},"hoverFontCount":${this.pH.eod},"menuOpenCount":${this.pH.joc}}`)};this.vb=d.EwaSettings.vb();this.mergeCellCommandAction=new Nb(this.$,Na);this.gD=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);this.Vl=d.EwaSettings.Vl();this.rl=Cb.a.rl();this.bB=Cb.a.bB();if(this.gjc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:7376562_TelemetryForFontUsage"))this.pH={ZBd:0,qDd:0,cTd:0,eod:0,joc:0},this.$.ij(this.yc)}get rof(){return u.a.all(this.gridView.ha.ra.selectedRanges,Ma=>Ma.isRow)}get oof(){return u.a.all(this.gridView.ha.ra.selectedRanges,Ma=>Ma.Fg)}get themesManager(){this.fr||(Object(Ka.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")?this.fr=k.a.gK(w.R):this.fr=this.$.da.Ba(422));
return this.fr}X0(Ma,lb){const Na=this.$.da.Ba(465);Na&&Na.X0(Ma,lb)}Gui(Ma){return 1896159024===Ma||-1554384558===Ma||-1113896058===Ma||1554436520===Ma||1415868706===Ma||674605324===Ma||1035996630===Ma}Uzi(Ma){return 524773427===Ma||-1649235364===Ma||1886217042===Ma||928057943===Ma}Mc(Ma,lb){const Na=Eb.h(this.$);return 2054778433===lb&&Ma&1&&!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIQueryTablesRefreshSelectedEnabled",!1)?!fa.a(this.$).Knf:600686207===lb?!1:this.Gui(lb)&&
u.a.any(this.gridView.ha.ra.selectedRanges,X=>X.Fg||X.isRow)&&!this.rof&&!this.oof?!0:d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1)&&this.Uzi(lb)?Na.tb.Flf(Na.ha.ra.activeCell):this.Ykc(Ma,lb)}executeCommand(Ma,lb,Na){return this.Hb(lb,Na)}Ac(Ma,lb,Na){if(Ma=1===Ma)switch(lb.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 2007171328:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Ma=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:Ma=
!!Na;break;case 862825906:case 1532790410:case 46555851:case -1522760979:Ma=!0;break;default:Ma=!1}return Ma}Rc(Ma,lb,Na){switch(lb){case "PopulateFontColor":Na.MenuItems=this.tB.Xcc(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Na.MenuId);break;case "PopulateFillColor":Na.MenuItems=this.tB.Xcc(1650812936,null,87208751,454361567,673562736,1457172838,-446735083,1532790410,Na.MenuId);break;case "PopulateBorderColor":Na.MenuItems=this.tB.Xcc(-236759591,-1803452024,void 0,
void 0,void 0,void 0,void 0,46555851,Na.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.zdi(Na);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.rl&&(this.fontDropdownHelper.VEj(Na.MenuId),!this.fontDropdownHelper.oti()))return!1;Na.MenuItems=this.fontDropdownHelper.x1e(-1293291468,324978188,-1428968098,Na.MenuId);this.gjc&&(this.pH.joc+=1);break;default:return!1}return!0}Ykc(Ma,lb){const Na=Eb.h(this.$).ha.ra.selectedRanges;return!(new L.a(this.$.ua)).xm(Ma,
lb,Na,this.gridView)}Hb(Ma,lb){var Na=this.gridView;const X=Ma.command;var F=f.TaskExtensions.Yj();let na=!0;switch(X){case -1077965542:na=this.Kbf(lb,Ma,!1);break;case 909774670:this.yrb(X);na=this.Kbf(lb,Ma,!0);break;case -1293291468:na=this.Ibf(lb,Ma,!1);break;case 324978188:this.yrb(X);na=this.Ibf(lb,Ma,!0);break;case 862890474:case 963349338:na=this.Rci(Ma);break;case -1832800737:na=this.wfc(X,lb,!1,Ma);break;case 1970784898:na=this.wfc(X,lb,!1,Ma);break;case -803000997:na=this.wfc(X,lb,!1,Ma);
break;case -128950598:case 1688184685:this.yrb(X);na=this.wfc(X,lb,!0,Ma);break;case 1597684571:na=this.bzb(X,lb,!1,Ma);break;case 87208751:lb.Color="-1";lb.IntColor=!0;na=this.bzb(X,lb,!1,Ma);break;case -446735083:this.yrb(X);lb.Color="-1";lb.IntColor=!0;na=this.bzb(X,lb,!0,Ma);break;case 1650812936:na=this.bzb(X,lb,!1,Ma);break;case 673562736:this.yrb(X);na=this.bzb(X,lb,!0,Ma);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.B1f(X);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:na=
this.zci(X,Ma);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 2007171328:na=this.Cbi(X,Ma);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:na=this.udi(X,Ma);break;case -1803452024:case -236759591:na=this.Rld(X,lb,Ma);break;case -2118943501:na=this.borderFormatManager.Qbi(lb,Ma);break;case 1012765228:na=this.borderFormatManager.Qdi(lb,Ma);break;case 1256700402:na=this.borderFormatManager.Wld(Ma);
break;case -1756763834:na=this.borderFormatManager.Xld(Ma);break;case -1418159950:na=this.borderFormatManager.vbf(Ma);break;case -1920201820:case -1942512156:na=this.Sci(X,Ma);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:na=this.borderFormatManager.fbf(lb,Ma);this.gKh(lb);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:na=this.qdi(X,lb,Ma);break;case -693675336:case 322710748:break;case 1696566924:na=this.Aci(Ma);break;case -167499203:case -255094134:case 1097660126:case 155820588:F=
this.handleMergeCellsCommand(this.gridView,Ma);break;case 1896159024:case -1554384558:lb=this.gridView.ha.ra.selectedRanges;if(this.vKj(Ma.command))m.ULS.sendTraceTag(509694159,0,50,"Insert Copied Cells Keyboard Shortcut"),this.copyPasteInfrastructure.mhf(null,Ma),F=pb.Task.Ta(!0);else if(this.SLj(Ma,lb))m.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new ba(this.$,X,lb)).tg(),na=!0;else if(u.a.any(lb,hb=>this.gridView.tb.AV(hb))){Na="";
F=1461300262;const hb=-1554384558===X&&this.gridView.tb.Vwi(lb[0]);lb=lb[0].height>lb[0].width&&!hb;switch(X){case 1896159024:Na=lb?"InsertColumnsTable":"InsertRowsTable";F=lb?622604322:942362098;break;case -1554384558:Na=lb?"DeleteColumnsTable":"DeleteRowsTable",F=lb?284490184:1405456548}lb=Za.a.hq(Pa.Mpd,Na,1);new bb.a(F,1,2,6,null);F=this.insertOrDeleteCells(lb,Ma,!0)}else F=this.insertOrDeleteCells(1896159024===X?1:2,Ma,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:F=
this.insertOrDeleteCells(Za.a.hq(Pa.Mpd,lb[W.a.Pc],1),Ma,!0);this.bB&&(Ma=Eb.h(this.$),ma.d(this.$,Ma.ha.ra.activeCell,X,null));break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:F=this.insertOrDeleteCells(Za.a.hq(Pa.Mpd,lb[W.a.Pc],1),Ma,!1);break;case 504848446:F=Na.startEdit(!1,1,lb[O.a.event],void 0,void 0,!0);break;case 1504715724:if(Eb.h(this.$).pz&&this.borderFormatManager.BU.dB)break;F=Na.startEdit(!0,0,lb[O.a.event],void 0,void 0,!0);break;case 1872288872:this.osb();
break;case 41465729:F=this.fill(Na.ha.ra.xd,null,0,1,Ma);break;case -1451655532:case 1972143101:F=this.fillDownAbsoluteValueAndStartEdit(Na,lb[O.a.event],-1451655532===X);break;case -475861485:F=this.fill(Na.ha.ra.xd,null,Na.rtl?1:2,1,Ma);break;case -978843926:F=this.fill(Na.ha.ra.xd,null,3,1,Ma);break;case 2098035706:F=this.fill(Na.ha.ra.xd,null,Na.rtl?2:1,1,Ma);break;case -2142700828:F=this.fill(Na.ha.sourceRange,Na.ha.ra.xd,Pa.Q4e(Na.ha.ra.xd,Na.ha.sourceRange),2,Ma);break;case 1405660955:F=this.fill(Na.ha.sourceRange,
Na.ha.ra.xd,Pa.Q4e(Na.ha.ra.xd,Na.ha.sourceRange),4,Ma);break;case 1983983164:F=this.fill(Na.ha.ra.xd,null,0,0,Ma);break;case 478842689:(Ma=this.$.da.Ba(376))?(Ma.wfj(),na=!0):m.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:na=Na.ha.Hb(null,X);break;case -208772570:this.ldi();na=!0;break;case -987339782:this.Ybi();na=!0;break;case -1770246794:Na.ha.Zbi();
na=!0;break;case 748067091:case -381232414:this.bci(X);na=!0;break;case -1522760979:this.gridView.toggleFormulaView();na=!0;break;case 886009118:F=this.Pci();break;case 894341014:this.Uci();na=!0;break;case 862825906:F=this.Zbf(1970784898,Ma);break;case 1532790410:F=this.Zbf(1650812936,Ma);break;case 46555851:F=this.hdi(Ma);break;default:na=!1}na||(F=pa.a(X));return F}gKh(Ma){d.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")?["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(null===
Ma||void 0===Ma?void 0:Ma.MenuItemId)&&(Ga.AFrameworkApplication.Qq("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.Aze(new ob.a(this.gridView.ha.ra.activeRange,J.d(this.$.ua.na)))):Ma&&Ma.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(Ma.MenuItemId)&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)&&this.Aze(new ob.a(this.gridView.ha.ra.activeRange,J.d(this.$.ua.na)))}Aze(Ma){f.TaskExtensions.za(e.GetServiceTaskFactory.Pa(this.$.da,426,427,1),lb=>{void lb.result.$Dc(Ma,"BorderActions")},this.$.ka,3)}get copyPasteInfrastructure(){var Ma;null!==(Ma=this.u6b)&&void 0!==Ma?Ma:this.u6b=this.$.da.Ba(254,!0);this.u6b||m.ULS.sendTraceTag(509682657,0,50,"CopyPasteInfrastructure is null");return this.u6b}vKj(Ma){var lb,Na;return vb.a.pCi&&1896159024===Ma&&(null===(lb=this.copyPasteInfrastructure)||
void 0===lb?void 0:lb.kPe())&&(null===(Na=this.copyPasteInfrastructure)||void 0===Na?void 0:Na.Bjc())}SLj(Ma,lb){const Na=u.a.all(lb,na=>!this.gridView.tb.AV(na)),X=1<lb.length&&!!this.gridView.tb.Jkd(lb),F=u.a.all(lb,na=>!this.gridView.tb.n5(na));lb=!u.a.any(lb,na=>na.isRow||na.Fg);return 1===Ma.method&&6===Ma.Ve&&(Na||X)&&F&&lb}fillDownAbsoluteValueAndStartEdit(Ma,lb,Na){const X=Ma.ha.ra.activeCell,F=Y.F(X,this.gridView.Ep);return Ma.startEdit(!0,0,lb).Yo(()=>{const na=Ma.Jb(F),hb=Ma.Jb(X);if(!na||
!hb)return m.ULS.shipAssertTag(537159507,0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${X.toString()} and above cell: ${F.toString()}`),pb.Task.Ta(!1);this.gridView.Xb.text=Na?na.QO:na.text;this.gridView.Xb.textBox.setCaretPositionToEnd();return pb.Task.Ta(!0)})}insertOrDeleteCells(Ma,lb,Na){const X=t.a.create().toString();var F=Enum.toString(E,Ma);this.gridView.Dh.M0(17,X,F);F=this.gridView.ha.ra.selectedRanges;var na=this.rof,hb=this.oof;if(!this.$.$s(null,
!1,void 0,lb.Ve)&&!hb&&!na&&5!==Ma&&9!==Ma)return pb.Task.Ta(!0);2===Ma?Ma=hb?10:na?6:F[0].height>F[0].width?18:34:1===Ma?Ma=hb?9:na?5:F[0].height>F[0].width?17:33:18===Ma&&na?Ma=34:34===Ma&&hb&&(Ma=18);F=this.jTg(F,Ma);if((10===Ma||6===Ma)&&!this.$.$s(F,!0,1,lb.Ve))return pb.Task.Ta(!0);const Ib={};Ib.InsertDeleteRangeItems=Array(F.length);Ib.SheetName=this.$.na.sheetName;Ib.IsTableCommand=Na;for(Na=0;Na<F.length;Na++){na=F[Na];hb={};let oc,Ic;Ma&4?(hb.FirstRow=na.top-1,hb.LastRow=G.a.iB,hb.FirstColumn=
0,hb.LastColumn=G.a.ky,oc=na.bottom-na.top+1,Ic=0,6===Ma?(na.Fg||(hb.FirstRow=na.bottom),oc=-oc):qa.b("InsertRowsAbove"),37===Ma&&(hb.FirstRow=na.bottom,qa.b("InsertRowsBelow"))):Ma&8?(hb.FirstRow=0,hb.LastRow=G.a.iB,hb.FirstColumn=na.left-1,hb.LastColumn=G.a.ky,oc=0,Ic=na.right-na.left+1,10===Ma&&(na.isRow||(hb.FirstColumn=na.right),Ic=-Ic)):Ma&16?(hb.FirstRow=na.top-1,hb.LastRow=na.bottom-1,hb.FirstColumn=na.left-1,hb.LastColumn=G.a.ky,oc=0,Ic=na.right-na.left+1,18===Ma&&(hb.FirstColumn=na.right,
Ic=-Ic)):(hb.FirstRow=na.top-1,hb.LastRow=G.a.iB,hb.FirstColumn=na.left-1,hb.LastColumn=na.right-1,oc=na.bottom-na.top+1,Ic=0,34===Ma&&(hb.FirstRow=na.bottom,oc=-oc));const ec={};ec.InsertDeleteRange=hb;ec.DeltaRow=oc;ec.DeltaColumn=Ic;ec.AdjustedSelectedRange=Y.j(na);Ib.InsertDeleteRangeItems[Na]=ec}this.gridView.Ng.mM(!1);const vc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");Ib.IsDecoupleRecalc=vc;const nc=this.$.pa.va.$b(),Pb=()=>new ea(Ib);return U.a(this.$.userOperationManager,
(oc,Ic,ec)=>{vc&&!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.vy();return ya(this.$.pa.va,Ib,cb.b(oc,(mb,Ob)=>{this.SZi(mb,Ob,Ma)},()=>{this.P_j(Ma,Ib)}),Ic,ec,X,nc)},oc=>new da.a(237,0,oc,void 0,Pb),lb,d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}P_j(Ma,lb){const Na=this.P8h(Ma);if(Na&&1===lb.InsertDeleteRangeItems.length){var X=lb.InsertDeleteRangeItems[0];1<X.DeltaColumn||1<X.DeltaRow||this.Ezi(Na)&&
f.TaskExtensions.za(e.GetServiceTaskFactory.Pa(this.$.da,426,427,1),F=>{const na=new ob.a(Y.C(X.AdjustedSelectedRange),J.d(this.$.ua.na));void F.result.$Dc(na,Na)},this.$.ka,3)}}Ezi(Ma){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)?"DeleteColumn"===Ma||"DeleteRow"===Ma?(Ga.AFrameworkApplication.Qq("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteRowColProactiveSuggestions",
!1)):"InsertColumn"===Ma||"InsertRow"===Ma?(Ga.AFrameworkApplication.Qq("XLS-SmartView-InsertRowColProactiveSuggestions-Treatment;XLS-SmartView-InsertRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertRowColProactiveSuggestions",!1)):"InsertCellShiftDown"===Ma||"InsertCellShiftRight"===Ma?(Ga.AFrameworkApplication.Qq("XLS-SmartView-InsertCellTableProactiveSuggestions-Treatment;XLS-SmartView-InsertCellTableProactiveSuggestions-Control"),
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertCellTableProactiveSuggestions",!1)):"DeleteCellShiftUp"===Ma||"DeleteCellShiftLeft"===Ma?(Ga.AFrameworkApplication.Qq("XLS-SmartView-DeleteCellTableProactiveSuggestions-Treatment;XLS-SmartView-DeleteCellTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteCellTableProactiveSuggestions",!1)):!1:(d.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")||
Ga.AFrameworkApplication.Qq("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),!1)}P8h(Ma){let lb;switch(Ma){case 5:case 37:lb="InsertRow";break;case 33:lb="InsertCellShiftDown";break;case 9:lb="InsertColumn";break;case 17:lb="InsertCellShiftRight";break;case 6:lb="DeleteRow";break;case 34:lb="DeleteCellShiftUp";break;case 10:lb="DeleteColumn";break;case 18:lb="DeleteCellShiftLeft"}return lb}jTg(Ma,lb){return lb&32?this.d_a(Ma,Na=>
Na.bottom,Na=>Na.top,(Na,X)=>{Na.bottom=X},!1,!0):lb&16?this.gridView.rtl?this.d_a(Ma,Na=>Na.left,Na=>Na.right,(Na,X)=>{Na.left=X},!1,!1):this.d_a(Ma,Na=>Na.right,Na=>Na.left,(Na,X)=>{Na.right=X},!1,!1):lb&4?this.d_a(Ma,Na=>Na.bottom,Na=>Na.top,(Na,X)=>{Na.bottom=X},!0,!0):lb&8?this.gridView.rtl?this.d_a(Ma,Na=>Na.left,Na=>Na.right,(Na,X)=>{Na.left=X},!0,!1):this.d_a(Ma,Na=>Na.right,Na=>Na.left,(Na,X)=>{Na.right=X},!0,!1):Ma}d_a(Ma,lb,Na,X,F,na){Ma=Y.d(Ma);Ma.sort((hb,Ib)=>lb(Ib)-lb(hb));if(F){F=
[];na=na?G.a.xg+1:G.a.wg+1;for(let hb=0;hb<Ma.length;hb++){const Ib=Ma[hb];Na(Ib)<na&&(X(Ib,Math.min(lb(Ib),na-1)),F.push(Ib),na=Na(Ib))}Ma=F}return Ma}fill(Ma,lb,Na,X,F){const na=this.$;if(!na.$s([lb],!0))return pb.Task.Ta(!0);const hb=Y.v(Ma,na),Ib=lb?Y.v(lb,na):hb,vc=this.$.pa.va.$b(),nc=()=>new V(hb,Ib,X,Na);return U.a(this.$.userOperationManager,(Pb,oc,Ic)=>{this.$.vy();var ec=this.$.pa.va;Pb=cb.b(Pb,this.FWi);const mb=ec.Oa(9,vc);mb.sourceRange=hb;mb.targetRange=Ib;mb.fillDirection=Na;mb.fillType=
X;return T.g(ec,"FillRange",mb,Pb,oc,Ic,null,0)},Pb=>new da.a(155,0,Pb,void 0,nc),F)}qdi(Ma,lb,Na){const X={ValidMembers:32};switch(Ma){case 1890566896:Ma=parseInt(lb[W.a.Pc].toString(),10);if(14===Ma)return Na=new bb.a(2105621672,Na.method,Na.mode,Na.Ve,Na.tabName),lb[W.a.Pc]=null,this.$.Ia.Hb(Na,lb),m.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;X.NumberFormat=Ma;break;case 1886928607:X.NumberFormat=
13;break;case -992833457:X.NumberFormat=11;break;case 218524921:X.NumberFormat=12;break;case 996232352:X.NumberFormat=1006;break;default:return m.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+za.b().Ij(Na.command)),!1}m.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${za.b().Ij(Na.command)} command, with menu item ${lb[W.a.Pc]}.`);this.Zg.formatCells(1890566896,X,Na);this.$.tf();return!0}Rci(Ma){var lb=this.gridView.Jb(this.gridView.ha.ra.activeCell);
if(this.vb&&this.gridView.eb){lb=this.gridView.Mh.Uva(lb?ab.a(lb).Font:null);if(!lb)return m.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.ra.activeCell.toString()} is null while editing`),!1;var Na=lb.FontSize}else if(lb)Na=lb.fontSize;else return!1;lb=Ma.command;let X=0;if(862890474===lb)for(;X<Pa.GKa.length-1&&Pa.GKa[X]<=Na;)X++;else if(963349338===lb)for(X=Pa.GKa.length-1;0<X&&Pa.GKa[X]>=Na;)X--;m.ULS.sendTraceTag(537159501,
0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${Na} to size ${Pa.GKa[X]}`);if(Na===Pa.GKa[X])return!0;Na=Pa.azc(2);Na.Font.FontSize=Pa.GKa[X];this.vb&&this.gridView.eb?(this.aqb(Ma,!1,Na),this.$.tf()):this.Zg.formatCells(lb,Na,Ma);return!0}Kbf(Ma,lb,Na){Ma=Ma[Ma[y.a.IsFreeForm]?y.a.Value:W.a.Sf].toString();if(!Pa.Laj.test(Ma))return m.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),!0;Ma=parseFloat(Ma);
if(8>Ma||72<Ma)return m.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),!0;const X=Math.round(2*Ma)/2,F=Pa.azc(2);F.Font.FontSize=X;this.vb&&this.gridView.eb?(this.aqb(lb,Na,F,!0),X===Ma||Na||this.$.tf()):Na?this.Zg.vea(this.gridView,-1077965542,F,Na):(this.Zg.formatCells(-1077965542,F,lb),this.f1a());return!0}Ibf(Ma,lb,Na){var X=Ma[W.a.Sf];let F;this.rl?this.fontDropdownHelper.ACc&&this.fontDropdownHelper.ACc[X]?
F=X:(m.ULS.sendTraceTag(523903201,1,15,`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${X}`),F=Ea.HelperMethods.xO[X]):F=Ea.HelperMethods.xO[X];let na=0;this.Vl&&(Ma=Ma.MenuItemId,Ma===kb.b?(X==this.themesManager.iG.ZAd&&(F=X),na=2):Ma===kb.a&&(X==this.themesManager.iG.Ozd&&(F=X),na=1),m.ULS.sendTraceTag(510247702,1,50,`GridCommandHandler.handleFontFamilyCommand: Font used is theme font: ${0!==na}`));if(!F)return!0;X=Pa.azc(1);X.Font.FontName=F;this.Vl&&
(X.Font.FontScheme=na);this.vb&&this.gridView.eb?(this.aqb(lb,Na,X),this.$.tf()):Na?(this.Zg.vea(this.gridView,-1293291468,X,Na),this.gjc&&(this.pH.eod+=1)):(this.Zg.formatCells(-1293291468,X,lb),this.gjc&&this.Xii(X.Font.FontName),this.f1a());return!0}Xii(Ma){this.pH.cTd+=1;this.rl&&this.Zg.Vkf(Ma)?this.pH.ZBd+=1:this.pH.qDd+=1}wfc(Ma,lb,Na,X){let F=-803000997===Ma||1688184685===Ma?"black":lb.Color;this.moreColorsHelper&&(-1832800737===Ma?F=$a.a.compare(F,"WindowText",!0)?this.moreColorsHelper.Ecb:
"black":Na||(this.moreColorsHelper.Ecb=F,this.moreColorsHelper.Fda(lb,F,X)));Ma=Pa.azc(32);Ma.Font.FontColor=xa.a.rH(F,Za.a.ng(lb,"IntColor"));this.vb&&this.gridView.eb?this.aqb(X,Na,Ma,17===X.Ve):Na?this.Zg.vea(this.gridView,1970784898,Ma,Na):(this.gD&&({themeColor:lb}=this.getThemeColor(lb)).returnValue&&(Ma.Font.ThemeFontColor=lb,Ma.Font.ColorTypeOption=1),this.Zg.formatCells(1970784898,Ma,X),this.f1a());return!0}bci(Ma){var lb=(new Date).format(748067091===Ma?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat);
const Na=this.gridView.Ul?wa.a(this.gridView.$):this.gridView.Xb;Ma=Na.textBox;this.gridView.eb?Na.insertText(lb):(this.gridView.startEdit(!0,0),Na.text=lb,lb=lb.length,Ma.seb(lb),Ma.caretPosition=lb)}ldi(){this.gridView.gN(this.gridView.ha.ra.activeCell)||this.gridView.uyc||this.gridView.yNa()||this.gridView.yv(this.gridView.ha.ra.activeCell,3,"GridCommandHandler.HandleMoveViewportToActiveCell")}Ybi(){if(!(this.gridView.uyc||this.gridView.yNa()||this.gridView.eb&&v.a.isMac)){const Ma=this.gridView.ha.ra.f4;
this.gridView.sg(Y.v(Ma,this.$),Ma,null,null,60,"GridCommandHandler.HandleMoveViewportToActiveCell")}}Aci(Ma){this.Xbc=J.d(this.$.ua.na);if(this.gridView.K7a)return this.gridView.Ng.mM(!1),!!this.copyPasteInfrastructure;if(!this.copyPasteInfrastructure)return m.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.C2(this.bfd);const lb=String.format(O.a.iua,oa.a.current.Un(108));this.gridView.Ng.Ap(lb);Ma=new bb.a(-911352779,
Ma.method,Ma.mode,Ma.Ve,Ma.tabName);this.$.Ia.Hb(Ma,{[O.a.silentClipboardAccessFailures]:!0,[O.a.isFormatPainter]:!0}).continueWith(Na=>{(6>Na.status||6===Na.status&&!Na.result)&&this.osb()});this.gridView.K7a=!0;this.copyPasteInfrastructure.lRg(this.osb);return!0}bzb(Ma,lb,Na,X){let F=87208751===Ma?"-1":lb.Color;this.moreColorsHelper&&(1597684571===Ma?F=this.moreColorsHelper.WQa:Na||(this.moreColorsHelper.WQa=F===Pa.notSet?Pa.b0d:F,this.moreColorsHelper.Fda(lb,F,X)));Ma={ValidMembers:64};Ma.FillColor=
xa.a.rH(F,Za.a.ng(lb,"IntColor"));Na?this.Zg.vea(this.gridView,1650812936,Ma,!0):(this.gD&&({themeColor:lb}=this.getThemeColor(lb)).returnValue&&(Ma.ThemeFillColor=lb,Ma.ColorTypeOption=1),this.Zg.formatCells(1650812936,Ma,X),this.f1a());return!0}Uci(){m.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const Ma=this.$.da.Ba(221);if(Ma){var lb=this.gridView.Mh;if(lb){var Na,X,F=({Czf:Na,j_e:X}=Ma.oni(lb.text,lb.textBox.caretPosition)).returnValue;
F?(Ma.ye=!1,lb.text=F,lb.textBox.selectRange(Na,Na+X),m.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):m.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else m.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else m.ULS.sendTraceTag(537159492,0,
50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}zci(Ma,lb){let Na=0;var X=this.gridView;const F=ab.a(X.Jb(null));this.vb&&X.eb&&(F.Font=X.Mh.Uva(F.Font));(X=F.Font)||(X={ValidMembers:0});switch(Ma){case -287251124:Na|=4;Ba.e(X,4)?X.Bold=!X.Bold:X.Bold=!0;break;case -1925065947:Na|=8;Ba.e(X,8)?X.Italic=!X.Italic:X.Italic=!0;break;case 1764140053:Na|=16;Ba.e(X,16)?X.Underline=!X.Underline:X.Underline=!0;break;case -1685033574:Na|=64;Ba.e(X,64)?X.DoubleUnderline=
!X.DoubleUnderline:X.DoubleUnderline=!0;break;case -1590502662:Na|=128,Ba.e(X,128)?X.Strikethrough=!X.Strikethrough:X.Strikethrough=!0}if(!Na)return!1;X.ValidMembers=Na;F.Font=X;F.ValidMembers=16;this.vb&&this.gridView.eb?this.aqb(lb,!1,F):this.Zg.formatCells(Ma,F,lb);this.$.tf();return!0}Cbi(Ma,lb){let Na=0;const X=ab.a(this.gridView.Jb(null));-571165336===Ma||1041132226===Ma||-394785302===Ma?(Na|=1,X.VerticalAlignment=Za.a.hq(Pa.m_a,Ma.toString(),2)):Pa.hui(Ma)?(Na|=2,this.Mci(X,Ma)):-1116189897===
Ma&&(Na|=8,X.Wrap=X.ValidMembers&8?!X.Wrap:!0);if(!Na)return!1;X.ValidMembers=Na;this.Zg.formatCells(Ma,X,lb);this.$.tf();return!0}Mci(Ma,lb){!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==lb&&(lb=-1150205178===lb?-286432209:-1150205178);lb=Za.a.hq(Pa.m_a,lb.toString(),0);Ma.HorizontalAlignment=lb===Ma.HorizontalAlignment?0:lb}aSf(Ma,lb,Na,X){let F=!1;d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",
!1)&&(F=this.mergeCellCommandAction.Vxf(lb,Na))&&Eb.h(this.$).Dh.lS(this.n$a,Ja.BasicTelemetryCalculator.WQ);return this.pvb(Ma,lb,!1,F,na=>{this.b0i(na,Na,lb,F,X)})}handleMergeCellsCommand(Ma,lb){this.n$a=t.a.create().toString();let Na=null;Na=this.mergeCellCommandAction.H6e();var X=N.a(lb.command);const F=this.mergeCellCommandAction.Wri(lb.command,Na);let na=0;F?na=A.a.Yd():Eb.h(this.$).Dh.M0(4,this.n$a,X+", Scenario = "+Na.scenario.toString());X=Ma.ha.ra.selectedRanges;m.ULS.sendTraceTag(537159459,
0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${za.b().Ij(lb.command)}, Number of ranges: ${X.length}, Ranges: ${Y.i(X,",",this.$,!1)}`);X=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);Ma.Ng.mM(!1,X);if(10===Za.a.hq(Pa.Xxf,lb.command.toString(),10))return pb.Task.Ta(!1);const hb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(X&&hb)return F?(this.lbg(Na,lb,!0,!0,na),pb.Task.Ta(!0)):this.aSf(Ma,
lb,Na,!1);let Ib=!1;X&&(Ib=this.mergeCellCommandAction.Vxf(lb,Na))&&Eb.h(this.$).Dh.lS(this.n$a,Ja.BasicTelemetryCalculator.WQ);return this.pvb(Ma,lb,!1,Ib,vc=>{this.c0i(vc,lb,Ib)})}pvb(Ma,lb,Na,X,F=null){const na=this.$.pa.va.$b(),hb=Za.a.hq(Pa.Xxf,lb.command.toString(),10),Ib=Y.r(Ma.ha.ra.selectedRanges,Ma.$),vc=()=>new R.a(hb,Ib),nc=Pb=>{const oc=!!Pb&&!!Pb.RequestTelemetryData;Eb.h(this.$).Dh.kma(this.n$a,Pb.StateId,oc?Pb.RequestTelemetryData.EcsOperationDuration:0,oc?Pb.RequestTelemetryData.EcsRequestDuration:
0,oc?Pb.RequestTelemetryData.WfeRequestDuration:0)};Ma=(Pb,oc,Ic)=>{this.$.vy();Pb=F?cb.b(Pb,F):Pb;Pb=cb.b(Pb,nc);return T.d(this.$.pa.va,hb,Ib,Na,Pb,oc,Ic,null,na)};return X?U.a(this.$.userOperationManager,Ma,Pb=>new da.a(156,0,Pb,64,vc),lb):U.a(this.$.userOperationManager,Ma,Pb=>new da.a(156,0,Pb,void 0,vc),lb)}lbg(Ma,lb,Na,X=!1,F=0){m.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${Na}`);var na=Eb.h(this.$).rtl;na=La.a.hd(3,2,0,na?635:634,0,514846606,"MergeCellsLoseData");
f.TaskExtensions.za(wb.a(this.$).vj(na),hb=>{hb=hb.result;if(X){const Ib=A.a.Yd()-F;m.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${Ib}, and the user action is : ${hb}`)}0===hb?(m.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Na?(X&&(hb=N.a(lb.command),Eb.h(this.$).Dh.M0(4,this.n$a,hb+", Scenario = "+Ma.scenario.toString())),this.aSf(Eb.h(this.$),lb,Ma,!0)):this.pvb(this.gridView,lb,!0,!1)):1===hb&&m.ULS.sendTraceTag(537159455,0,
50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.ka,11)}yGi(Ma,lb,Na,X){lb!==Ma&&m.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${lb} and as per server is ${Ma}. The scenario is:- ${Na}, The CSE is done:- ${X}`)}c0i(Ma,lb,Na){va.b(Ma,514846606)&&(m.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Aa.a(this.$).kd.WL(514846606),Ma=Eb.h(this.$).rtl,Ma=La.a.hd(3,2,0,Ma?635:634,0,
514846606,"MergeCellsLoseData"),f.TaskExtensions.za(wb.a(this.$).vj(Ma),X=>{X=X.result;0===X?(m.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.pvb(this.gridView,lb,!0,Na)):1===X&&m.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.ka,11))}b0i(Ma,lb,Na,X,F){let na=!1;va.b(Ma,514846606)&&(na=!0,Aa.a(this.$).kd.WL(514846606),X&&F?window.setTimeout(()=>{this.pvb(this.gridView,Na,!0,!0)},0):this.lbg(lb,Na,!1));this.yGi(na,F,lb.scenario,
X)}yrb(Ma){if(this.D0a!==Ma&&1461300262!==this.D0a){this.B1f(this.D0a);var lb=za.b().Ij(Ma);const Na=za.b().Ij(this.D0a);m.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${Na} was restored before caching the style for ${lb} command.`)}this.D0a=Ma;if(this.vb&&this.gridView.eb)this.A0a||(this.A0a=this.gridView.Mh.formattedText);else if(!this.pC){this.pC=[];lb=this.gridView.iaa("GridCommandHandler.CacheFontStyles",this.gridView.ha.ra.selectedRanges);try{for(lb.$$rst();lb.$$mn();){const Na=
lb.$$cu();if(Na.cell.hasRichText)this.pC.push(ib.q1g(Na,Na.cell.formattedText));else switch(Ma){case 673562736:case -446735083:this.pC.push(ib.C1c(Na,Na.backgroundColor));break;case -128950598:case 1688184685:this.pC.push(ib.C1c(Na,Na.color));break;case 909774670:this.pC.push(ib.r1g(Na,Na.fontSize));break;case 324978188:this.Vl?this.pC.push(ib.p1g(Na,Na.fontName,Na.wZ)):this.pC.push(ib.C1c(Na,Na.fontName))}}}finally{lb&&lb.dispose()}}}pQj(){return this.vb&&this.gridView.eb?!this.A0a:!this.pC}Mqi(Ma){return!!this.pC&&
this.pC.length>Ma&&!!this.pC[Ma].formattedText}Bgd(Ma){return this.pC[Ma].style}kUh(Ma){return this.pC[Ma].size}jUh(Ma){return this.pC[Ma].wZ}B1f(Ma){if(!this.pQj()){if(this.vb&&this.gridView.eb)this.A0a&&(this.gridView.Xb.formattedText=this.A0a);else{const Na=this.pC.length;for(let X=0;X<Na;X++){let F;var lb=this.pC[X].IKa.cell.getRange();F=this.gridView.Jb(lb);if(!F){m.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${lb.ZC(!1)}`);
continue}let na;lb=F.NH?this.gridView.GMb(F.range):(na=new D.a,na.add(F),na);for(let hb of lb)if(hb.cell.hasRichText&&1457172838!==Ma)this.Mqi(X)&&(hb.cell.formattedText=this.pC[X].formattedText);else switch(Ma){case 1457172838:hb.backgroundColor=this.Bgd(X);break;case 2036397036:hb.color=this.Bgd(X);break;case -1904244080:hb.fontSize=this.kUh(X);break;case -1428968098:hb.fontName=this.Bgd(X),this.Vl&&hb.D7f(this.jUh(X))}}}this.D0a=1461300262;this.f1a()}}f1a(){this.vb&&this.gridView.eb?this.A0a=null:
this.pC=null}Sci(Ma,lb){const Na={IndentationIncrease:0};if(-1942512156===Ma)Na.IndentationIncrease=1;else if(-1920201820===Ma)Na.IndentationIncrease=-1;else return!0;Na.ValidMembers=256;this.Zg.formatCells(Ma,Na,lb);return!0}udi(Ma,lb){var Na=this.gridView.Jb(null);const X=ab.a(Na);if(0<Na.indentation&&-1526602249!==Ma)return!1;Na=Ma;!Eb.h(this.$).rtl||-1649235364!==Ma&&524773427!==Ma||(Na=-1649235364===Ma?524773427:-1649235364);switch(Na){case -1649235364:Na=G.a.rotateTextUp45;break;case 524773427:Na=
G.a.txc;break;case 1886217042:Na=G.a.rotateTextUp90;break;case 928057943:Na=G.a.vxc;break;case -1526602249:Na=G.a.verticalText;break;default:return!1}X.ValidMembers=512;const F=X.TextOrientation;X.TextOrientation=Na===F||F===G.a.sxc&&Na===G.a.txc||F===G.a.uxc&&Na===G.a.vxc?0:Na;this.Zg.formatCells(Ma,X,lb);return!0}Pci(){const Ma=Eb.h(this.$),lb=Y.r(Ma.ha.ra.selectedRanges,this.$),Na=Y.o(Ma.ha.ra.activeCell,this.$);m.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");
return U.a(this.$.userOperationManager,(X,F,na)=>ka.r(this.$.pa.va,Na,lb,X,F,na,null),X=>new da.a(201,0,X),null)}Zbf(Ma,lb){let Na=null;var X=Eb.h(this.$).ha.ra.selectedRanges;X=this.gridView.iaa("MoreColors",X,1,!0);try{for(X.$$rst();X.$$mn();){const F=X.$$cu().cell;if(!F)continue;let na=Pa.black;if(1970784898===Ma)na=F.color;else if(1650812936===Ma){const hb=F.backgroundColor;na=$a.a.compare(hb,Pa.b0d,!0)&&$a.a.compare(hb,Pa.empty,!0)?F.backgroundColor:Pa.white}if(!Na)Na=na;else if(Na!==na){Na=
Pa.black;break}}}finally{X&&X.dispose()}this.vb&&this.gridView.eb&&1970784898===Ma&&this.gridView.Mh.textBox.b3b();return this.moreColorsHelper.kEb(Ma,lb,Na)}hdi(Ma){const lb=z.a.B5a(this.borderFormatManager.p3);return this.moreColorsHelper.kEb(-236759591,Ma,lb)}aqb(Ma,lb,Na,X=!1){lb?this.gridView.Mh.cRf(Na.Font):(this.RIi(Ma),X?window.requestAnimationFrame(()=>{C.FocusManager.instance().rk(H.AFrame.Aaa);this.gridView.Mh.y0e(Na.Font)}):(C.FocusManager.instance().rk(H.AFrame.Aaa),this.gridView.Mh.y0e(Na.Font)),
this.f1a())}RIi(Ma){const lb=N.a(Ma.command);Ma=I.a[Ma.Ve]+"_"+S.a[Ma.method];const Na=this.gridView.oc.YCe.toString(),X=new Map;X.set("Command",lb);X.set("Source",Ma);X.set("Ribbon","React");X.set("CellTextRuns",Na);P.Health.instance.recordKpiUsage(rb.a.wNh,0,xb.a.i2f,X)}Rld(Ma,lb,Na){Ma=this.borderFormatManager.Rld(Ma,lb,Na);this.moreColorsHelper&&this.moreColorsHelper.Fda(lb,this.borderFormatManager.p3,Na);return Ma}getThemeColor(Ma){let lb;lb={};let Na=!1;if((Ma.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return m.ULS.sendTraceTag(537159433,
0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:lb};let X;({themeIndex:Ma,nCa:X,returnValue:Na}=this.themesManager.getThemeColor(Ma.Color));Na&&(lb.ThemeColorIndex=Ma,lb.ThemeColorRow=X)}return{returnValue:Na,themeColor:lb}}static get Laj(){return Pa.Iie||(Pa.Iie=RegExp("^[0-9]+[.]?[0-9]*$"))}static get Mpd(){return Pa.Zbe||(Pa.Zbe={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,
["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get m_a(){return Pa.fib||(Pa.fib={["-394785302"]:0,["-571165336"]:2,["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3,["2007171328"]:6})}static get Xxf(){return Pa.Wfe||(Pa.Wfe={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static hui(Ma){return-1150205178===Ma||-1142465846===
Ma||-286432209===Ma||2007171328===Ma}static azc(Ma){const lb={},Na={};lb.ValidMembers=16;lb.Font=Na;Na.ValidMembers=Ma;return lb}static Q4e(Ma,lb){let Na;Na=Ma.top<lb.top?3:Ma.bottom>lb.bottom?0:-1;return Na=Ma.left<lb.left?1:Ma.right>lb.right?2:Na}}Pa.b0d="transparent";Pa.notSet="-1";Pa.black="#000000";Pa.empty="";Pa.white="#FFFFFF";Pa.Zbe=null;Pa.fib=null;Pa.Wfe=null;Pa.Iie=null;Pa.GKa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(r.a)(Pa,"GridCommandHandler",null,[222]);class fb extends x.a{constructor(Ma){super(Ma)}ld(){const Ma=
e.GetServiceTaskFactory.create(this.$.da,111,this.ka,this.Na);let lb;lb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(l.c)(k.a.resolve(w.r,{Wb:this.Na})):e.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Na);const Na=e.GetServiceTaskFactory.create(this.$.da,397,this.ka,this.Na),X=e.GetServiceTaskFactory.Pa(this.$.da,502,503,this.Na);if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const F=e.GetServiceTaskFactory.Pa(this.$.da,
296,468,this.Na);f.TaskExtensions.za(f.TaskExtensions.Md([Ma,lb,Na,F,X],this.ka),()=>{this.fd([new Pa(this.$,Eb.h(this.$),lb.result,Ma.result,F.result,Na.result,X.result)])},this.ka,3)}else{const F=e.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Na);f.TaskExtensions.za(f.TaskExtensions.Md([Ma,lb,F,Na,X],this.ka),()=>{this.fd([new Pa(this.$,Eb.h(this.$),lb.result,Ma.result,new h.BorderFormatManager(this.$,lb.result,F.result),Na.result,X.result)])},this.ka,3)}}static la(Ma){x.a.Rd(80,new fb(Ma))}}
Object(r.a)(fb,"GridCommandHandlerFactory",x.a,[]);a.d(B,"a",function(){return Wa});const Wa=()=>{c.a.Fa(fb.la);c.a.Fa(n.la)}},1208:function(r,B,a){function c({x:xa,y:bb},Za,La=document){let va=-1,Ba=null;void 0!==La.caretPositionFromPoint?(xa=La.caretPositionFromPoint(xa,bb),null!==xa&&(va=xa.offset,Ba=xa.offsetNode)):void 0!==La.caretRangeFromPoint&&(xa=La.caretRangeFromPoint(xa,bb),null!==xa&&(va=xa.startOffset,Ba=xa.startContainer));return null===Ba||-1===va?(z.ULS.sendTraceTag(521446491,0,15,
"getEditorCaretPositionFromPoint - failed to get relevant range"),-1):Za.contains(Ba)?b(Za,Ba,va):(z.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),-1)}function b(xa,bb,Za){if(xa===bb)return Za;if(bb.textContent!==bb.parentElement.textContent)for(;null!==bb.previousSibling;)bb=bb.previousSibling,Za+=bb.textContent.length,"div"===bb.nodeName.toLowerCase()&&(Za+=1);return b(xa,bb.parentElement,Za)}function e(xa,bb){return xa.text===bb.text&&xa.start===
bb.start&&xa.length===bb.length}function f(xa,bb,Za){if(xa.has(bb))return xa.get(bb);Za=Za();xa.set(bb,Za);return Za}function d(xa){return JSON.stringify({text:xa.text,start:xa.start,length:xa.length})}function h(xa){return Object(n.c)(xa)?"Undefined text":""===xa?"Empty text":null}var l=a(9);r=a(0);var k=a(228),w=a(155),n=a(562),x=a(21),m=a(11),u=a(22),t=a(14),y=a(221),v=a(35),A=a(33),z=a(15),C=a(1125);class H{constructor(xa){this.$=xa;this.Fia=this.o2a=null;this.usage={};this.axc={};this.performance=
{};this.KIb=-1;this.yc=(bb,Za)=>{Za.Ef||Za.Crd||this.$.sendBeaconTraceTag(388818255,50,!1,this.m_d())};this.editBox=Object(x.h)(this.$).Xb;xa.ij(this.yc)}static getInstance(xa){return H.instance||(H.instance=new H(xa))}set trigger(xa){this.o2a=xa;this.KIb=C.a.XZd}set H1f(xa){this.Fia=xa}setResult(xa,bb){if(Object(n.c)(this.o2a))z.ULS.sendTraceTag(512258439,0,15,"ValuePreviewTelemetry.setResult - currentTrigger undefined");else if("Failure"!==xa.kind||xa.timeout){var Za=bb===this.editBox?"cellEditor":
"formulaBar",La=this.o2a;bb=this.Fia;var va=this.KIb;Object(n.c)(this.usage[Za])&&(this.usage[Za]={});Object(n.c)(this.usage[Za][La])&&(this.usage[Za][La]={success:0,error:0,loading:0,timeout:0});Za=this.usage[Za][La];switch(xa.kind){case "Success":this.Zij(xa.text);Za.success++;this.o2a=this.Fia=null;this.KIb=-1;this.rv(bb,va);break;case "Error":Za.error++;this.o2a=this.Fia=null;this.KIb=-1;this.rv(bb,va);break;case "Loading":Za.loading++;break;case "Failure":this.o2a=this.Fia=null,this.KIb=-1,xa.timeout&&
Za.timeout++}}}Zij(xa){if(!Object(n.c)(this.Fia)){Object(n.c)(this.axc[this.Fia])&&(this.axc[this.Fia]=[]);var bb=this.axc[this.Fia];1E3>bb.length&&bb.push(xa.length)}}rv(xa,bb){if(-1!==bb){xa=null!==xa&&void 0!==xa?xa:"cache";this.D7e(`${xa}_request`).N3(!0,bb);var Za=this.D7e(`${xa}_overall`);window.requestAnimationFrame(()=>{Za.N3(!0,bb)})}}D7e(xa){return this.performance[xa]=this.performance[xa]||new C.a(I)}m_d(){const xa={};Object.keys(this.performance).forEach(bb=>{this.performance[bb].xZe();
var Za=this.performance[bb];xa[bb]={metrics:Za.hW,durations:Za.avb}});return`{"usage":${JSON.stringify(this.usage)},"resultLengths":${JSON.stringify(this.axc)},"performance":${JSON.stringify(xa)}}`}}Object(r.a)(H,"ValuePreviewTelemetry",null,[]);const I=[50,80,100,130,150,170,200];class S{constructor(xa,bb,Za){this.$=xa;this.JKa=bb;this.ariaLiveNotifier=Za;this.zki();this.editBox=Object(x.h)(this.$).Xb;this.tLj=A.a.LH(this.$)}get telemetry(){return H.getInstance(this.$)}get zoomManager(){this.Goe||
(this.Goe=Object(v.a)(this.$));return this.Goe}dispose(){this.hide()}show(xa,bb,Za,La){La=Object.assign(Object.assign({},bb),{kQ:xa,Z3d:Za,source:La});this.dfb(La)&&(this.zoa(La)&&this.hide(),this.RE=La,this.telemetry.setResult(bb,xa),this.FI(),Za&&this.nhi())}hide(){if(this.RE){var xa=this.RE.Z3d;this.Tqh();xa&&this.Rmj();this.RE=void 0}}dfb(xa){var bb;(bb=!this.RE)||(bb=this.RE,bb=!(bb.kQ===xa.kQ&&bb.kind===xa.kind&&bb.text===xa.text&&bb.start===xa.start&&bb.length===xa.length&&bb.Z3d===xa.Z3d));
return bb}zoa(xa){var bb;if(bb=this.RE)bb=this.RE,bb=!(bb.kQ===xa.kQ&&bb.start===xa.start&&bb.length===xa.length);return bb}nhi(){const xa=this.RE.length;0!==xa&&this.RE.kQ.textBox.formatText(this.RE.start,xa,{background:"rgba(202,234,216,0.6)"})}Rmj(){const xa=this.RE.kQ;xa.textBox.formatText(0,xa.text.length,{background:!1});this.tLj&&xa.VD(null)}FI(){var xa=this.RE.text;switch(this.RE.kind){case "Success":case "Error":xa={isLoaded:!0,value:xa};break;case "Loading":xa={isLoaded:!1,value:null};break;
default:return}this.H7j();this.JKa.renderValuePreview(this.Es,this.qQb,xa);this.x9i(xa)}Tqh(){this.JKa.dismiss(this.Es)}zki(){this.Es=document.createElement("div");this.qQb=document.createElement("div");this.qQb.style.position="absolute";this.qQb.style.visibility="hidden";this.$.domElement.appendChild(this.qQb)}H7j(){const xa=this.RE.kQ,bb=this.RE.start,Za=this.RE.length;var La=this.RE.source;let va;switch(La.trigger){case "hover":va=excelOnline.utils.getBoundingRectForText(xa.textBox.Ge,La.index,
La.index+1,!1);break;case "shortcut":va=excelOnline.utils.getBoundingRectForText(xa.textBox.Ge,La.index,La.index,!1);break;case "selection":La=u.a.contains(xa.text.substring(bb,bb+Za),"\n",!0),va=excelOnline.utils.getBoundingRectForText(xa.textBox.Ge,bb,La?bb:bb+Za,!1)}this.G7j(va)}G7j(xa){const bb=new y.a(this.qQb.style);bb.HB.left=this.oBc(xa.left);bb.HB.top=this.oBc(xa.top);bb.HB.width=this.oBc(xa.width);bb.HB.height=this.oBc(xa.height);bb.E2()}oBc(xa){var bb=this.RE.kQ;bb=Object(n.b)(this.zoomManager)&&
bb===this.editBox;return m.HelperMethods.zc(bb?this.zoomManager.Jh(xa):xa)}x9i({isLoaded:xa,value:bb}){xa?this.ariaLiveNotifier.readText(String.format(t.a.instance.nb(179),bb)):this.ariaLiveNotifier.readText(t.a.instance.ga(866))}}Object(r.a)(S,"FormulaAssistanceValuePreviewControl",null,[3]);var P=a(121);class D{constructor(xa){this.cache=xa}clearCache(){this.cache=void 0}}Object(r.a)(D,"Cacheable",null,[]);class G extends D{constructor(xa,bb){super();this.$=xa;this.callbacks=bb;this.OEf=(Za,La)=>
{const va=this.gridView.Mh;if(!(0<(va.eb?va.textBox.selection:{index:0,length:0}).length))switch(La.state){case 0:this.onHoverEnter(Za,La.event);break;case 1:this.onHoverLeave(Za);break;default:return z.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),La}};this.MEf=(Za,La)=>{const va=La.selection;La={source:"selection",text:La.text,start:va.index,length:va.length};if(0<va.length)this.onSelectionChange(Za,La);else this.FKf(Za,La)};this.gridView=
Object(x.h)(this.$);this.editBox=this.gridView.oc;this.Gj(this.editBox);this.formulaBar=Object(P.a)(this.$);Object(n.b)(this.formulaBar)?this.Gj(this.formulaBar):Object(P.b)(this.$,Za=>{this.formulaBar=Za;this.Gj(this.formulaBar);z.ULS.sendTraceTag(509870663,1,50,"FormulaAssistanceValuePreviewHandler: formulaBar async")})}get telemetry(){return H.getInstance(this.$)}dispose(){this.Xj(this.editBox);this.Xj(this.formulaBar)}trigger(){const xa=this.gridView.Mh,bb=xa.textBox.selection;this.onSelectionChange(xa,
{source:"shortcut",text:xa.text,start:bb.index,length:bb.length})}Gj(xa){xa.Fse(this.OEf);xa.sse(this.MEf)}Xj(xa){null===xa||void 0===xa?void 0:xa.aZf(this.OEf);null===xa||void 0===xa?void 0:xa.RYf(this.MEf)}onHoverEnter(xa,bb){bb=new Sys.UI.Point(bb.clientX,bb.clientY);bb=c(bb,xa.textBox.Ge);if(-1!==bb)this.onSelectionChange(xa,{source:"hover",text:xa.text,start:bb,length:0})}onHoverLeave(xa){this.FKf(xa)}onSelectionChange(xa,bb){this.EKj(bb)&&(this.cache=bb,this.callbacks.SFd(xa,{index:bb.start,
length:bb.length,trigger:bb.source}),this.telemetry.trigger=bb.source)}FKf(xa,bb){this.AKj(bb)&&(this.clearCache(),this.callbacks.Pca(xa))}EKj(xa){return!this.cache||!e(this.cache,xa)}AKj(xa){return this.cache&&xa?"shortcut"!==this.cache.source||!e(this.cache,xa):!0}}Object(r.a)(G,"FormulaAssistanceValuePreviewHandler",D,[3]);var E;(function(xa){xa[xa.Failure=0]="Failure";xa[xa.Success=1]="Success";xa[xa.Error=2]="Error";xa[xa.Unavailable=3]="Unavailable"})(E||(E={}));Object(r.b)("ValuePreviewResultKind",
E);var O=a(44),N=a(63);class J{constructor(xa,bb){this.$=xa;this.pluginScheduler=bb;this.l0=new ea(d);this.V5f=new ea(d);this.l3i=(Za,La)=>va=>{if(Object(n.c)(va.Result))La("No result");else if(va=JSON.parse(va.Result),Object(n.c)(va))La("Failed to deserialize");else if(1!==Object.keys(va).length)La("Invalid response");else{for(var Ba in va)var Ea=va[Ba];Ba=h(Ea);Object(n.b)(Ba)?La(Ba):Za(Ea)}};this.k3i=Za=>()=>{Za("Request failed")};this.gridView=Object(x.h)(this.$);if(this.Mwb=A.a.vV(this.$))this.formulaAssistanceManager=
xa.da.Ba(464)}get telemetry(){return H.getInstance(this.$)}clearCache(){this.l0.clear();this.V5f.clear()}Rsj(xa,bb){return Object(w.a)(this,void 0,void 0,function*(){const Za=this.request(xa);let La;const va=new Promise(Ba=>{La=window.setTimeout(()=>{Ba({kind:"Failure",timeout:!0})},bb)});return Promise.race([Za,va]).finally(()=>{window.clearTimeout(La)})})}request(xa){return Object(w.a)(this,void 0,void 0,function*(){return f(this.l0,xa,()=>Object(w.a)(this,void 0,void 0,function*(){const {kind:bb,
payload:Za}=yield this.pluginScheduler.getRequester().valuePreview(xa,this.formulaAssistanceManager?this.formulaAssistanceManager.SIb:0);if(0!==bb)return null;if(Object(n.c)(Za))return{kind:"Failure"};this.telemetry.H1f="client";switch(Za.kind){case 0:return{kind:"Failure"};case 1:case 2:var La=this.S9j;a:{switch(Za.kind){case 1:var va=Object.assign(Object.assign({},Za),{kind:"Success"});break a;case 2:va=Object.assign(Object.assign({},Za),{kind:"Error"});break a}va=void 0}return La.call(this,va);
case 3:return this.Esj({text:xa.text,start:Za.start,length:Za.length},xa,Za.text)}}))})}S9j(xa){const bb=h(xa.text);return Object(n.b)(bb)?(z.ULS.sendTraceTag(509871621,1,15,`FormulaAssistanceValuePreviewRequester.validateClientSuccessResult: formula failure:${bb}, kind:${E[xa.kind]}`),{kind:"Failure"}):xa}Esj(xa,bb,Za){return Object(w.a)(this,void 0,void 0,function*(){return f(this.V5f,xa,()=>{const La=new Promise(va=>Object(w.a)(this,void 0,void 0,function*(){try{const Ba=yield this.B3h(Za);this.telemetry.H1f=
"server";va({kind:"Success",text:Ba,start:xa.start,length:xa.length})}catch(Ba){z.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${Ba}`),va({kind:"Failure"})}}));La.then(()=>{this.l0.set(xa,La);this.l0.set(bb,La)}).catch(va=>{z.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${va}`)});return La})})}B3h(xa){return Object(w.a)(this,void 0,void 0,function*(){return new Promise((bb,
Za)=>{const La={Formula:xa,PartialFormula:xa,SourceRange:Object(O.v)(this.gridView.ha.ra.activeCell,this.$)};W(this.$.pa.va,La,this.l3i(bb,Za),this.k3i(Za),null,null)})})}}Object(r.a)(J,"FormulaAssistanceValuePreviewRequester",null,[]);const W=(xa,bb,Za,La,va,Ba,Ea=null)=>{Ea=xa.Oa(1,Ea);Ea.getPartialCalcResultsParameters=bb;return Object(N.g)(xa,"GetPartialCalcResults",Ea,Za,La,va,Ba,4)};class ea{constructor(xa){this.n_d=xa;this.map=new Map}has(xa){xa=this.n_d(xa);return this.map.has(xa)}get(xa){xa=
this.n_d(xa);return this.map.get(xa)}set(xa,bb){xa=this.n_d(xa);this.map.set(xa,bb);return this}clear(){this.map.clear()}}Object(r.a)(ea,"RequestMap",null,[]);class R{constructor(xa,bb,Za,La){this.$=xa;this.sOj=200;this.C0f=3E3;this.SFd=(va,Ba)=>Object(w.a)(this,void 0,void 0,function*(){const Ea={text:va.text,start:Ba.index,length:Ba.length};void this.dSf(Ea,this.Qsj(Ea),va,0===Ea.length,Ba.trigger)});this.Pca=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();
this.hide()};this.Ow=()=>{this.handler.clearCache();this.requester.clearCache()};this.gridView=Object(x.h)(this.$);this.control=new S(this.$,Za,La);this.requester=new J(this.$,bb);this.handler=new G(this.$,{SFd:this.SFd,Pca:this.Pca});this.Gj()}get telemetry(){return H.getInstance(this.$)}trigger(){this.handler.trigger()}dispose(){this.Xj();this.handler.dispose();this.control.dispose()}Gj(){this.gridView.Xb.rm(this.reset);this.gridView.ha.hha(this.reset);this.$.ea.wA(this.Ow)}Xj(){this.gridView.Xb.dm(this.reset);
this.gridView.ha.Cna(this.reset);this.$.ea.wB(this.Ow)}dSf(xa,bb,Za,La,va){return Object(w.a)(this,void 0,void 0,function*(){const Ba=Object.assign(Object.assign({},xa),{kQ:Za,rAc:La,trigger:va});this.WY=Ba;const Ea=yield bb;Object(n.c)(Ea)||this.Cxi(Ba)&&void this.aei(Ea)})}aei(xa){return Object(w.a)(this,void 0,void 0,function*(){const bb=this.WY.text,Za=this.WY.kQ,La=this.WY.rAc,va=this.WY.trigger;switch(xa.kind){case "Failure":this.telemetry.setResult(xa,Za);this.hide();break;case "Success":case "Error":this.show(xa);
break;case "Loading":this.show(xa);void this.dSf({text:bb,start:xa.start,length:xa.length},xa.promise,Za,La,va);break;default:return xa}})}Qsj(xa){const bb=this.requester.Rsj(xa,this.C0f);let Za;const La=new Promise(va=>{Za=window.setTimeout(()=>{va(Object.assign(Object.assign({},xa),{kind:"Loading",promise:bb}))},this.sOj)});return Promise.race([bb,La]).finally(()=>{window.clearTimeout(Za)})}show(xa){const bb=this.WY.start,Za=this.WY.kQ,La=this.WY.rAc,va=this.WY.trigger;this.WY=void 0;this.Kxi(xa)&&
this.control.show(Za,xa,La,{trigger:va,index:bb})}hide(){this.control.hide();this.WY=void 0}Cxi(xa){var bb;if(bb=this.WY)bb=this.WY,bb=bb.text===xa.text&&bb.start===xa.start&&bb.length===xa.length&&bb.kQ===xa.kQ&&bb.rAc===xa.rAc;return bb}Kxi(xa){return Object(n.b)(xa.text)&&""!==xa.text}}Object(r.a)(R,"FormulaAssistanceValuePreview",null,[274,3]);var Y=a(50),U=a(38);class da extends k.a{constructor(xa){super();this.$=xa;this.Gb()}static la(xa){xa.da.Ha(497,new da(xa))}create(){let xa=this.$.da.Ba(496);
xa&&this.qb(xa);const bb=Y.GetServiceTaskFactory.Pa(this.$.da,413,414,this.Na),Za=Y.GetServiceTaskFactory.Pa(this.$.da,448,449,this.Na),La=Y.GetServiceTaskFactory.Pa(this.$.da,19,153,this.Na),va=Y.GetServiceTaskFactory.Pa(this.$.da,211,212,this.Na);U.TaskExtensions.za(U.TaskExtensions.Md([bb,Za,La,va],this.ka),()=>{xa=this.$.da.Ba(496);xa||(xa=new R(this.$,bb.result,Za.result,va.result),this.$.da.Ha(496,xa));this.qb(xa)},this.ka,3)}}Object(r.a)(da,"FormulaAssistanceValuePreviewFactory",k.a,[]);var T=
a(714),ka=a(196),L=a(58);class fa{constructor(xa,bb){this.formulaAssistanceValuePreview=bb;this.gridView=Object(x.h)(xa)}Mc(){return!1}executeCommand(xa,bb){xa=!1;bb=bb.command;switch(bb){case -46938080:this.formulaAssistanceValuePreview.trigger(),xa=!0}return xa?L.Task.Ta(!0):ka.a(bb)}Ac(xa,bb){return-46938080===bb.command}Rc(){return!1}}Object(r.a)(fa,"FormulaAssistanceValuePreviewCommandHandler",null,[222]);class wa extends T.a{constructor(xa){super(xa)}ld(){const xa=Y.GetServiceTaskFactory.Pa(this.$.da,
496,497,this.Na);U.TaskExtensions.za(xa,()=>{this.fd([new fa(this.$,xa.result)])},this.ka)}static la(xa){T.a.Rd(515,new wa(xa))}}Object(r.a)(wa,"FormulaAssistanceValuePreviewCommandHandlerFactory",T.a,[]);a.d(B,"a",function(){return oa});const oa=()=>{l.a.Fa(xa=>{da.la(xa);wa.la(xa)})}},1214:function(r,B,a){r=a(0);var c=a(15),b=a(197),e=a(88),f=a(87),d=a(393),h=a(103),l=a(47);class k{constructor(){this.Gda=this.R1e=null}}Object(r.a)(k,"GestureAdapterInfo",null,[]);var w=a(4),n=a(383),x=a(233);class m{constructor(){this.WKc=
null}QEi(){if(!this.WKc){var J="hammer.min.js";w.AFrameworkApplication.fa.Jp("IsServerFlavorDebug")&&(J=w.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");J=w.AFrameworkApplication.jO(String.format("{0}",J),5);J=x.a.create(J,null,null);n.a.Zia(J);this.WKc=J.K9a}return this.WKc}static get instance(){m.Ma||(m.Ma=new m);return m.Ma}}m.Ma=null;Object(r.a)(m,"HammerJsDependencyLoader",null,[422]);var u=a(13);const t=(J,W,ea=null)=>{if(void 0===W||null===W)throw c.ULS.sendTraceTag(42256258,
310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let R=null;switch(J){case u.a.pinch:R=new Hammer.Pinch(ea);break;case u.a.pan:R=new Hammer.Pan(ea)}R&&(R.manager=W);return R};var y;(function(J){J[J.none=-1]="none";J[J.pinch=0]="pinch";J[J.pan=1]="pan";J[J.swipe=2]="swipe"})(y||(y={}));Object(r.b)("GestureEvent",y);var v=a(80);class A extends v.a{constructor(J,W,ea,R,Y,U,da,T){super(J,ea,R,U);this.Oib=W;this.Cga=da;this.EX=T;this.nAg=Y}get shiftKey(){return this.Cga}get ctrlKey(){return this.EX}get clientPoint(){return this.Oib}get Bva(){return this.nAg}static create(J,
W,ea,R,Y,U){if(ea.rawEvent)if(U){var da=ea.rawEvent;da=new Sys.UI.Point(da.clientX,da.clientY)}else da=v.a.yxb(ea);else da=new Sys.UI.Point(ea.clientX,ea.clientY);return new A(J,da,W,ea,R,Y,ea.shiftKey,ea.ctrlKey,U)}}Object(r.a)(A,"GestureEventArgs",v.a,[]);class z{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(r.a)(z,"GestureManagerData",null,[]);class C{}C.Ntg=2;C.Otg=4;C.Ptg=8;C.Qtg=8;Object(r.a)(C,"HammerConstants",null,[]);var H=a(98),I=a(211),S=a(31),P=a(83);class D extends l.a{constructor(J,W){super();this.Zqa=d.a.rRh;this.vSc=!!window.PointerEvent;this.rne=window.hasOwnProperty("ontouchstart");this.UWa=this.imb=null;this.U8=!1;this.cT=
new h.a;this.Dmb=new h.a;this.oAg=new b.a;this.xqa=null;this.WVa=this.LMc=this.I7d=this.GJc=this.nQc=this.Mje=this.O7d=this.gob=!1;this.Mlb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.cVc=null;this.Sd=H.EventHandlerManager.instance;this.vSc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.imb=Object(e.a)(this,this.IPa,"onPointerEvent"),this.UWa=u.a.tRh):this.rne?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.imb=Object(e.a)(this,this.Jza,"onTouchEvent"),
this.UWa=u.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.imb=Object(e.a)(this,this.Yqc,"onMouseEvent"),this.UWa=u.a.sRh);this.Ah=W;this.Cfa=J;w.AFrameworkApplication.fa&&(this.gob=w.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),this.O7d=w.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.Mje=w.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.nQc=w.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),
this.GJc=w.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.I7d=w.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),this.LMc=w.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.WVa=this.gob&&w.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&w.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}XZh(){return this.vSc?0:this.rne?1:2}un(J){super.un(J);this.Sd.Wka(this.UWa,J,0,
this.imb)}tm(J){super.tm(J);this.Sd.rJa(J,this.UWa)}qkj(J,W,ea=null){w.AFrameworkApplication.Sjc()?m.instance.QEi().continueWith(R=>{this.USj();if(R.Lf||R.vh)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",R.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",R.status);if(this.I7d){R=window.Hammer;if("undefined"===typeof R){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.hCc();return}if("undefined"===typeof R.inputHandler){c.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.hCc();return}}if(!J)throw this.hCc(),Error.argumentNull("source element can not be null");R=I.a.dwa(J,this.Zqa);if(void 0===R||null===R)R=new h.a,I.a.Ceb(J,this.Zqa,R),this.rkj(J);var Y=null;R.kb(y[0])||(Y=Object.assign(new k,{Gda:t(y[0],this,null),R1e:W}),R.add(y[0],Y));if(void 0!==ea&&null!==ea)for(let U=0;U<ea.length;U++)if(R.kb(y[ea[U]])){const da=R.ma(y[ea[U]]);Y.Gda.recognizeWith(da.Gda)}}this.hCc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}USj(){this.LMc&&
(this.Ah?this.cVc=this.Ah.Kc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}hCc(){this.LMc&&(this.cVc?this.cVc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}rkj(J){this.oAg.add(J);this.Sd.Wka(this.UWa,J,0,this.imb)}recognize(J){var W=Array(J.pointers.length);for(var ea=0;ea<J.pointers.length;ea++)W[ea]=J.pointers[ea].target;ea=null;for(this.xqa=this.u1h(W);void 0!==this.xqa&&null!==this.xqa&&
(ea=I.a.dwa(this.xqa,this.Zqa),void 0===ea||null===ea);this.xqa=this.xqa.parentNode);if(void 0!==ea&&null!==ea){this.curRecognizer&&this.curRecognizer.state===C.Qtg&&(this.curRecognizer=null);W=ea.keys;for(let R of W){W=ea.ma(R);void 0!==W&&null!==W&&void 0!==W.Gda&&null!==W.Gda&&(void 0===this.curRecognizer||null===this.curRecognizer||W.Gda===this.curRecognizer||W.Gda.canRecognizeWith(this.curRecognizer))&&W.Gda.recognize(J);const Y=W.Gda.state;this.curRecognizer||C.Ntg!==Y&&C.Otg!==Y&&C.Ptg!==Y||
(this.curRecognizer=W.Gda)}}}emit(J,W){if("hammer.input"!==J){this.U8=!1;W=A.create(J,this.xqa,W.srcEvent,W,3,this.vSc);var ea=I.a.dwa(this.xqa,this.Zqa);if(this.vwi(J))var R=0;else if(this.lwi(J))R=1;else if(this.zzi(J))R=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:ea}=ea.Ic(y[R]));void 0!==ea&&null!==ea&&((ea=ea.R1e,ea.Oti())?J.endsWith("start")?this.U8=ea.sXi(W):J.endsWith("end")?(ea.qXi(W),this.U8=!0):J.endsWith("cancel")?(ea.pXi(W),
this.U8=!0):J.endsWith("move")&&(this.U8=ea.rXi(W)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",J))}}get(J){return Object(f.a)(Hammer.Recognizer,J)}u1h(J){if(1>J.length)return null;if(1===J.length)return J[0];var W=J[0],ea=!0;for(let R=1;R<J.length;R++){if(!J[R])return null;if(W!==J[R]){ea=!1;break}}if(ea)return W;W=this.g2e(J[0]);ea=0;for(const R of J){J=this.g2e(R);if(W.ma(W.count-1)!==J.ma(J.count-1))return null;for(let Y=W.count-2,U=J.count-2;Y>=ea&&0<=U;Y--,
U--)if(W.ma(Y)!==J.ma(U)){ea=Y+1;break}}return W.ma(ea)}g2e(J){const W=new b.a;for(;void 0!==J&&null!==J;J=J.parentNode)W.add(J);return W}$5e(J){switch(J){case u.a.uf:case u.a.u$:return 1;case u.a.mg:case u.a.Gha:return 2;case u.a.Ae:case u.a.KHa:return 4;case u.a.RDc:case u.a.l1c:return 8}return 0}Jza(J,W,ea){J=this.$5e(J);W=this.Z_h(ea);Hammer.inputHandler(this,J,W);this.U8&&ea.preventDefault();return this.U8}Ecf(){return 1<this.cT.count}$3b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");
if(this.gob)for(let J of this.cT)this.aYf(J.key);else this.cT=new h.a;this.session=null}TMg(J,W,ea){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",J);if(!this.Dmb.kb(J)){try{W.setPointerCapture(J)}catch(R){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",R)}this.Dmb.add(J,W)}this.cT.ia(J,ea);this.WVa&&1<this.cT.count&&this.Cfa&&!this.Cfa.Orb&&(this.Cfa.Orb=!0)}aYf(J){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",J);if(this.Dmb.kb(J)){try{this.Dmb.ma(J).releasePointerCapture(J)}catch(W){c.ULS.sendTraceTag(594055956,
310,10,"Exception: {0}",W)}this.Dmb.remove(J)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",J);this.cT.remove(J);this.WVa&&1>=this.cT.count&&this.Cfa&&this.Cfa.Orb&&(this.Cfa.Orb=!1)}IPa(J,W,ea){var R=ea.rawEvent.pointerType.toString();const Y=ea.rawEvent.pointerId.toString();if("touch"!==R)return!1;J=this.$5e(J);if(1!==J&&!this.cT.kb(Y))return!1;this.O7d&&1===J&&ea.rawEvent.isPrimary&&this.cT.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),
this.$3b());this.gob?this.TMg(Y,W,ea):this.cT.ia(Y,ea);this.nQc&&2===J&&(!this.GJc||this.GJc&&"function"===typeof ea.rawEvent.getCoalescedEvents)&&(W=ea.rawEvent.getCoalescedEvents())&&this.Ecf()&&(this.Mlb=Math.max(this.Mlb,W.length));this.Mje&&(this.U8=!1);R=this.Y_h(this.cT,ea,R);Hammer.inputHandler(this,J,R);if(4===J||8===J)this.gob?this.aYf(Y):this.cT.remove(Y),this.cT.count||(this.session=null,this.nQc&&-1!==this.Mlb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",
this.Mlb),this.Mlb=-1));this.U8&&ea.preventDefault();return this.U8}Yqc(){return!1}Z_h(J){const W=new z;var ea=J.rawEvent;const R=ea.touches;ea=ea.changedTouches;W.pointers=Array.clone(R);W.pointers=Array.clone(0<R.length?R:ea);W.changedPointers=Array.clone(ea);W.srcEvent=J;W.pointerType="touch";return W}Y_h(J,W,ea){const R=new z;R.pointers=P.toArray(J.values);R.changedPointers=[W];R.pointerType=ea;R.srcEvent=W;return R}vwi(J){return S.a.startsWith(J,u.a.pinch)}lwi(J){return S.a.startsWith(J,u.a.pan)}zzi(J){return S.a.startsWith(J,
u.a.swipe)}}Object(r.a)(D,"GestureInputManager",l.a,[387,388]);var G=a(286),E=a(257);class O{constructor(){this.$a=null;this.px=!1}get name(){return"Common.App.GestureInputManager"}Kh(J){J.register(D,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").tc().Bc(()=>new D(G.a.instance,w.AFrameworkApplication.sa.SD));this.$a=J}init(){this.px||(this.$a.resolve("Common.App.GestureManager.GestureInputManager"),this.px=!0)}dispose(){}static main(){E.a.instance.si(new O)}}Object(r.a)(O,
"GestureInputManagerPackage",null,[4,5]);a.d(B,"a",function(){return N});const N=()=>{Type.registerNamespace("Common.App.GestureManager");O.main()}},1221:function(r,B,a){function c(ta,Ya){var Da;return Object(h.a)(this,void 0,void 0,function*(){return H.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?ka.a.resolve(L.w,ta):Object(xa.d)(oa.GetServiceTaskFactory.Pa(Ya.da,498,499,null!==(Da=null===ta||void 0===ta?void 0:ta.Wb)&&void 0!==Da?Da:0))})}r=
{};a.r(r);a.d(r,"CellAutoCompleteControl",function(){return Za});var b={};a.r(b);a.d(b,"CellAutoCompleteReadoutHandler",function(){return pa});var e=a(0),f=a(58),d=a(228),h=a(155),l=a(15),k=a(91),w=a(1121),n=a(8),x=a(791);class m{}m.NYd="suggested_cells_list_box";Object(e.a)(m,"CssElementIds",null,[]);var u=a(5),t=a(1122);class y{constructor(ta,Ya){this.twg=ta;this.swg=Ya}get p$(){return this.twg}get j0c(){return this.swg}}Object(e.a)(y,"CellAutoCompleteItem",null,[289]);var v=a(4),A=a(937),z=a(391),
C=a(44),H=a(1),I=a(22),S=a(21);class P extends A.a{constructor(ta,Ya,Da){super(ta,Ya);this.cellAutoCompleteControl=null;this.amc=0;this.S0=this.A9a=null;this.n6=(ba,ya)=>{if(ba=this.cellAutoCompleteControl.items)if(1===ba.length&&this.cellAutoCompleteControl.f2a.length<ba[0].p$.length&&this.cellAutoCompleteControl.Rwa&&I.a.fG(ba[0].p$,this.cellAutoCompleteControl.f2a)&&(ya.newValue=ba[0].p$),this.gb&&H.EwaSettings.xa(128)){let V=-1;1<ba.length?V=this.cellAutoCompleteControl.Cec(this.gb.text,!0):1===
ba.length&&(this.cellAutoCompleteControl.Rwa||this.cellAutoCompleteControl.ygc)&&(V=0);if(0<=V&&ba.length>V&&ba[V].j0c){const Z=C.D(ba[V].j0c);Z&&S.h(this.$).tb.Sxa(Z)&&(ya.gjf=!0,ya.OCe=ba[V].j0c)}}};this.RHb=()=>{this.cellAutoCompleteControl.Rwa=!1};this.gb.KZa(this.n6);this.cellAutoCompleteControl=Da;this.S0=this.Fe.qe(this.gb.textBox.domElement);this.S0.la("mousedown",this.RHb)}get wBb(){return!1}get rK(){return this.cellAutoCompleteControl.ye}set rK(ta){this.cellAutoCompleteControl.ye=ta}get N6a(){return!1}get key(){return z.a.Y2c}dispose(){this.gb.MKb(this.n6);
super.dispose()}JY(ta){ta&&!this.cellAutoCompleteControl.ye||super.JY(ta)}Wh(ta,Ya){this.cellAutoCompleteControl.gb=this.gb;this.amc=ta.keyCode;if(this.gb.eb){const Da=this.gb.text;I.a.equals(this.A9a,Da,!1)||(this.A9a=Da)}else this.A9a=null;if(237279923===Ya)return this.cellAutoCompleteControl.ye=!1;H.EwaSettings.xa(128)&&17===this.amc&&this.cellAutoCompleteControl.Rwa&&(this.cellAutoCompleteControl.ygc=!0);return super.Wh(ta,Ya)}CDd(){var ta;if(!H.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||
!v.AFrameworkApplication.ug)if(this.cellAutoCompleteControl.gb=this.gb,this.cellAutoCompleteControl.Rwa=!1,this.gb.eb){const Ya=!I.a.equals(this.A9a,this.gb.text,!0),Da=this.gb.Brd;Da||!Ya&&229!==this.amc?Da&&(this.cellAutoCompleteControl.ye&&(this.cellAutoCompleteControl.ye=!1),null===(ta=this.cellAutoCompleteControl.wOa)||void 0===ta?void 0:ta.cancel()):this.cellAutoCompleteControl.UWg(this.amc)}else this.A9a=null}Di(){}dg(){this.rK=!1;this.cellAutoCompleteControl.set_visible(!1);this.A9a=null;
this.cellAutoCompleteControl.Rwa=!1;this.cellAutoCompleteControl.ygc=!1;this.cellAutoCompleteControl.wOa&&this.cellAutoCompleteControl.wOa.cancel()}ZJd(ta,Ya){return this.cellAutoCompleteControl.Wh(ta,Ya)}}Object(e.a)(P,"CellAutoCompleteListAutoCompleteBehavior",A.a,[]);var D=a(31);A=a(1123);var G=a(12),E=a(11),O=a(120);class N extends A.a{constructor(ta,Ya,Da,ba){super(ta,Ya);this.htmlSanitizationHelper=this.Zra=this.cellAutoCompleteControl=null;this.htmlSanitizationHelper=Da;this.cellAutoCompleteControl=
ba;this.ap=[]}get Jj(){return this.Zra}set Jj(ta){this.sCa(this.Jj);this.Zra=ta;const Ya=this.sCa(this.Jj);this.oe=ta?Ya.innerText:null;this.cyc(ta)}get ye(){return super.ye}set ye(ta){super.ye=ta;ta||(this.Jj=null)}get uUa(){return null}get zHa(){return this.cellAutoCompleteControl}dispose(){super.dispose();this.Zra=null}HCc(ta){this.N7(!1);if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&H.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")){var Ya=
document.createElement("table");Ya.classList.add(this.N5);Ya.FWg=u.a.uHa;var Da=document.createElement("tbody");for(let ba=0,ya=this.ap.length;ba<ya;ba++){const V=document.createElement("tr"),Z=document.createElement("td");Z.classList.add(this.LV);const ja=document.createElement("span");ja.classList.add(N.j4b);ja.setAttribute(u.a.UZc,ta[this.ap[ba]].p$);ja.innerText=ta[this.ap[ba]].p$;Z.appendChild(ja);V.appendChild(Z);Da.appendChild(V)}Ya.appendChild(Da);this.htmlSanitizationHelper.JE(this.Nf);this.Nf.appendChild(Ya)}else{Ya=
`<table class='${this.N5}' aria-live='polite'><tbody>`;for(let ba=0,ya=this.ap.length;ba<ya;ba++)Da=D.a.Og(ta[this.ap[ba]].p$),Da=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.LV,N.j4b,u.a.UZc,Da,D.a.vad(Da)),Ya+=Da;Ya+="</tbody></table>";this.Nf.innerHTML=Ya}this.An=G.DOMElementExtensions.hk(this.domElement,this.N5);this.N7(!0);this.Msa()}xKa(ta,Ya){if(ta&&ta.length){var Da=[];if(Ya)for(let ba=0,ya=ta.length;ba<ya;ba++)I.a.fG(ta[ba].p$,Ya)&&Da.push(ba);
this.ap=Da;this.HCc(ta)}else this.ye=!1,this.Zra=null}Xya(){}t3g(ta,Ya,Da){let ba=Math.min(ta,Math.max(200,Da));Ya&&ta<Da&&(ba+=O.a.Ku);G.DOMElementExtensions.Sv(this.Nf,ba);Ya&&(ba-=O.a.Ku);return ba}Msa(){super.Msa();var ta=G.DOMElementExtensions.hk(this.get_element(),this.N5),Ya=this.ap.length>this.bI,Da=S.h(this.$);if(Da=Da.Jb(Da.ha.ra.activeCell))for(ta=this.t3g(ta.offsetWidth,Ya,Da.width),Ya=this.Nf.getElementsByClassName(N.j4b),Da=0;Da<Ya.length;Da++)Ya[Da].style.maxWidth=E.HelperMethods.zc(ta);
else l.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(ta){if(ta=super.onItemClick(ta)){const Ya=S.h(this.$);Ya.No(!1);Ya.focus()}return ta}}N.j4b=x.a.OCh;Object(e.a)(N,"CellAutoCompleteListBox",A.a,[]);var J=a(24),W=a(71),ea=a(121),R=a(168),Y=a(45),U=a(36),da=a(260),T=a(18),ka=a(153),L=a(54),fa=a(472),wa=a(70),oa=a(50),xa=a(108);const bb=`<div id='${m.NYd}' class='${x.a.P$b} ${T.a.vo}' ></div>`;Object(ka.b)(L.g)(ta=>
Object(h.a)(void 0,void 0,void 0,function*(){const Ya=yield ka.a.resolve(fa.TableManagerService,ta),Da=yield ka.a.resolve(L.h,ta);var ba=H.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&H.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp");const ya=yield ka.a.resolve(L.o,ta);ba=ba?yield c(ta,ya):void 0;return new Za(ya,Ya,ba,Da)}));class Za extends w.a{constructor(ta,Ya,Da,ba){super(ta);this.bEa=null;this.X2c=[];this.e9d=null;
this.ygc=this.Rwa=!1;this.cfe=this.mq=null;this.VPe=()=>{this.FY.xKa(this.items,this.bEa);this.raiseEvent("ACLBUpdated",new t.a(this.items.length));this.show()};this.tableManager=Ya;this.domElement.className=x.a.YSe;H.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&H.EwaSettings.isChangeGateEnabled("OfficeVSO:7141407_FilterDialog_InnerHtml_CleanUp")?(Ya=document.createElement("div"),Ya.classList.add(x.a.P$b),Ya.classList.add(T.a.vo),Ya.id=m.NYd,this.domElement.appendChild(Ya)):
this.domElement.innerHTML=bb;G.DOMElementExtensions.setVisible(this.domElement,!1);da.d(this.style,this.$.isChromeRtl);this.NCe=$get(m.NYd,this.domElement);this.FY=new N(this.$,this.NCe,Da,this);this.TTa(!0);this.$.domElement.appendChild(this.domElement);H.EwaSettings.isChangeGateEnabled("OfficeVSO:7616781_GetFormulaBarControlAsync")?ea.b(this.$,ya=>{this.K_a(ta,ya)}):this.K_a(ta,ea.a(ta));this.K_a(ta,S.h(ta).Xb);this.Yqi=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",
!1);Object(wa.b)("OfficeVSO:7617240_migrate-CellAutoCompleteControl-new-service")&&ba.la(this)}O0b(ta){this.addHandler("ACLBUpdated",ta)}Rvc(ta){this.removeHandler("ACLBUpdated",ta)}B2(ta){this.addHandler("ACLBSelectionChanged",ta)}Sda(ta){this.removeHandler("ACLBSelectionChanged",ta)}uQg(ta){this.addHandler("ACLBMatchedItem",ta)}Soj(ta){this.removeHandler("ACLBMatchedItem",ta)}get ku(){return this.FY}get f2a(){return this.bEa}get oe(){return this.FY.oe}get items(){return this.mq}get wOa(){return this.cfe}get activeCell(){return S.h(this.$).ha.ra.activeCell}get dataValidationControl(){return this.e9d||
(this.e9d=this.$.da.Ba(14))}Seg(ta){for(let Ya=0;Ya<ta.length;Ya++)if(I.a.isLetter(ta.charCodeAt(Ya)))return!0;return!1}Fxa(){return!this.items}dispose(){if(this.$){this.TTa(!1);const ta=S.h(this.$);ta&&ta.view.Xq(this.yqc)}k.a.sc([this.FY,this.wOa]);k.a.sc(this.X2c);this.X2c=this.NCe=this.FY=this.gb=null;super.dispose()}Wh(ta,Ya){let Da=!1;if(this.BKj())switch(Ya){case -798660877:if(1===this.items.length&&this.oe)break;this.ku.jB(1);this.raiseEvent("ACLBSelectionChanged",new t.a(this.items.length,
this.Cec(this.oe),this.oe));Da=this.Ty(!1);break;case 137938150:if(1===this.items.length&&this.oe)break;this.ku.jB(-1);this.raiseEvent("ACLBSelectionChanged",new t.a(this.items.length,this.Cec(this.oe),this.oe));Da=this.Ty(!1);break;case 2091832999:this.ku.jB(this.bI-1);Da=this.Ty(!1);break;case 742457698:this.ku.jB(-(this.bI-1));Da=this.Ty(!1);break;case 125627505:this.gb.textBox.caretPosition=this.gb.text.length;this.ye=!1;Da=!0;break;case 267796030:this.Ty(!0);break;default:Da=super.Wh(ta,Ya)}return Da}show(){this.items&&
this.items.length&&(this.FY.Jj=this.oe?this.ku.An.rows[this.Cec(this.oe)]:null,this.ye=0<this.FY.ap.length,this.LCa(!0),this.FY.Xya())}UWg(ta){const Ya=!!this.gb&&!W.f(this.$.na);this.ygc=this.Rwa=!1;this.gb&&!this.gb.eb?this.set_visible(!1):Ya&&!this.Emh(this.activeCell)&&this.pOj(ta)}Emh(ta){return!!this.dataValidationControl&&this.dataValidationControl.w$c(ta)}Ty(ta){if(!this.gb||!this.ye)return!1;const Ya=this.bEa;if(this.oe){var Da=G.DOMElementExtensions.xZ(G.DOMElementExtensions.hk(this.FY.Jj,
N.j4b),u.a.UZc,"");const ba=Da.substring(Ya.length,Da.length);ta?this.gb.text=Da:this.gb.insertTextAt(ba,Ya.length,this.gb.text.length)}Da=S.h(this.$);Da.Ul&&(Da=Da.Xb,Da.text=this.gb.text,Da.setCaretPosition(this.gb.textBox.caretPosition));ta?this.ye=!1:this.gb.textBox.selectRange(Ya.length,this.gb.text.length);return!0}Cec(ta,Ya=!1){if(!this.FY.An)return-1;const Da=this.FY.An.children[0],ba=Da.children.length;let ya;for(let V=0;V<ba;++V)if(ya=Da.children[V],I.a.equals(ya.innerText.trim(),ta,Ya))return V;
return-1}zLg(ta,Ya,Da,ba,ya,V,Z){const ja=Da.originalText.replace(Za.$zf,String.fromCharCode(32)),la=new J.Range(ta.top-1,ta.left,ta.bottom-1,ta.right,!1,!1),ua=Z?Z.Qp(Da.range):null;(!Da.NH||Da.range.left===ta.left)&&1<ja.length&&!ba.kb(ja.toUpperCase())&&I.a.fG(ja,Ya)&&!I.a.equals(ja,Ya,!0)&&!Za.g_e(Ya)&&this.Seg(ja)&&(!ya&&!ua||!ya&&ua.equals(Z.Qp(la))||ya&&Da.range.vd(V)&&Da.range.top!==V.top)&&(ta=Da.formulaBarText,I.a.equals(ta,Da.text,!1)||!ta)&&(ta={},ta.FirstRow=Da.range.top-1,ta.FirstColumn=
Da.range.left-1,Da=new y(ja,ta),ba.add(ja.toUpperCase(),Da))}pOj(ta){this.mq=this.t8h();this.wOa&&this.wOa.cancel();0<this.gb.text.length&&0!==ta?this.items&&((1<this.items.length||this.ye)&&this.gth(),8!==ta&&127!==ta&&46!==ta&&(1===this.items.length?this.Jod(!1):this.FY.Jj&&this.Ty(!1))):this.ye=!1}gth(){this.ye?this.VPe():this.cfe=R.AsyncMethodContext.Cq(this.VPe,500,Y.a.M5g,this.wOa)}Jod(ta){l.ULS.shipAssertTag(537167966,0,!this.Fxa()&&1===this.items.length,"Invalid Items");let Ya=this.items[0].p$,
Da=this.gb.text,ba=Ya.substring(Da.length,Ya.length);if(ta&&!ba.length)this.gb.text=Ya;else if(!ta&&0<ba.length)this.gb.appendText(ba),this.gb.textBox.selectRange(Da.length,this.gb.text.length);else return;this.raiseEvent("ACLBMatchedItem",new t.a(this.items.length,0,Ya));this.Rwa=!0}t8h(){this.mq=null;const ta=new U.a(!1);var Ya=this.activeCell;this.bEa=this.gb.text.replace(Za.$zf,String.fromCharCode(32));const Da=this.tableManager.Qp(Ya),ba=Ya.vd(Da);if(Za.g_e(this.bEa)||!this.Seg(this.bEa))return this.items;
const ya=new J.Range(1,Ya.left,Ya.top-1,Ya.left,!1,!1);var V=new J.Range(Ya.top+1,Ya.left,n.a.xg,Ya.left,!1,!1);let Z;const ja=S.h(this.$);V=ja.Qj("CellAutoCompleteControl.GetSuggestedCells",V);try{const la=ja.Qj("CellAutoCompleteControl.GetSuggestedCells2",ya);try{for(const ua of[la,V])for(;ua.$$mn();)Z=ua.$$cu(),this.zLg(Ya,this.bEa,Z,ta,ba,Da,this.tableManager)}finally{la&&la.dispose()}}finally{V&&V.dispose()}this.mq=Array(ta.values.length);for(Ya=0;Ya<this.items.length;Ya++)this.items[Ya]=ta.values[Ya];
this.items.sort((la,ua)=>la.p$.localeCompare(ua.p$));return this.items}K_a(ta,Ya){ta&&Ya&&this.X2c.push(new P(ta,Ya,this))}BKj(){return this.Yqi?this.f2a&&!this.Fxa()&&this.ye?this.get_visible():!1:this.f2a&&!this.Fxa()&&this.get_visible()&&this.ye}static get $zf(){return Za.Nge||(Za.Nge=new RegExp(String.fromCharCode(160),"g"))}static g_e(ta){ta=0<ta.length?ta.charCodeAt(0):-1;return 35===ta||61===ta||43===ta||45===ta||64===ta}}Za.Nge=null;Object(e.a)(Za,"CellAutoCompleteControl",w.a,[277,278,279,
3]);var La=a(38),va=a(717);class Ba extends d.a{constructor(ta){super();this.$=ta;this.Gb()}create(){const ta=this.$.da,Ya=oa.GetServiceTaskFactory.create(ta,134,this.ka,this.Na),Da=oa.GetServiceTaskFactory.Pa(ta,213,214,this.Na);let ba=f.Task.Ta(null);H.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&H.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")&&(ba=H.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?
Object(xa.c)(ka.a.resolve(L.w,{Wb:this.Na})):oa.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na));La.TaskExtensions.za(La.TaskExtensions.Md([Ya,Da,ba],this.ka),()=>{this.qb(Object(va.a)(this.$.da,1,()=>{const ya=new Za(this.$,Ya.result,ba.result,void 0);Da.result.la(ya);return ya}))},this.ka,3)}static la(ta){ta.da.Ha(151,new Ba(ta))}}Object(e.a)(Ba,"CellAutoCompleteControlFactory",d.a,[]);var Ea=a(14);let pa=class{constructor(ta){this.S_a=null;this.pJf=(Ya,Da)=>{1<Da.length&&(Ya=Ea.a.instance.ga(858),
this.ariaLiveNotifier.JUf(Ya,Da.length))};this.qJf=(Ya,Da)=>{l.ULS.shipAssertTag(537167961,0,0<=Da.selectedIndex&&0<=Da.length&&Da.selectedIndex<Da.length,"Invalid ListEventArgs: SelectedIndex/Length");l.ULS.shipAssertTag(537167960,0,!!Da.aG,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.Nhj(Da.aG,Da.selectedIndex+1,Da.length)};this.rJf=(Ya,Da)=>{this.ariaLiveNotifier.wAa(Da.aG)};this.ariaLiveNotifier=ta}dispose(){this.a1d();this.S_a=null}la(ta){ta&&(this.S_a=ta,ta.O0b(this.pJf),
ta.B2(this.qJf),ta.uQg(this.rJf))}a1d(){this.S_a&&(this.S_a.Rvc(this.pJf),this.S_a.Sda(this.qJf),this.S_a.Soj(this.rJf))}};pa=Object(h.b)([Object(ka.d)(L.h),Object(h.c)(0,Object(fa.AriaLiveNotifierService)())],pa);Object(e.a)(pa,"CellAutoCompleteReadoutHandler",null,[359,3]);class $a extends d.a{constructor(ta){super();this.$=ta;this.Gb()}create(){const ta=this.$.da;La.TaskExtensions.za(oa.GetServiceTaskFactory.Pa(ta,211,212,this.Na),Ya=>{this.qb(Object(va.a)(ta,213,()=>new pa(Ya.result)))},this.ka,
3)}static la(ta){ta.da.Ha(214,new $a(ta))}}Object(e.a)($a,"CellAutoCompleteReadoutHandlerFactory",d.a,[]);var cb=a(9);a.d(B,"a",function(){return ib});const ib=()=>{Object(wa.b)("OfficeVSO:7617240_migrate-CellAutoCompleteControl-new-service")||(cb.a.Fa(Ba.la),cb.a.Fa($a.la))};String(r);String(b);window.___1678693004342_closurehack=r;window.___1678693004342_closurehack=b},1225:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(27),f=a(91),d=a(31),h=a(424),l=a(242);class k{}k.fzh="ewa-dv";k.gzh="ewa-dv-buttonarea";
k.myh="ewa-dlb";k.xEb="list-table";k.listItem="list-item";k.uEb="list-item-selected";k.yEb="list-table-touch";k.ezh="ewa-dpb";k.vth="dv-prompt-title";k.uth="dv-prompt-message";Object(r.a)(k,"CssClassNames",null,[]);var w=a(34),n=a(751),x=a(18),m=a(51),u=a(434),t=a(73),y=a(7),v=a(15),A=a(164),z=a(841),C=a(38),H=a(14),I=a(21),S=a(273),P=a(75);class D extends A.ErrorDialog{constructor(eb,Eb,Wb){super(eb,D.DQ(Eb,eb,Wb));this.Zc=()=>{this.setFocus()};I.h(this.$).ha.jC(this.Zc);(eb=eb.da.Ba(14).a5a(Wb))&&
eb.options&1&&v.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){I.h(this.$).ha.xB(this.Zc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var eb=4;break;case 1:eb=3;break;case 2:eb=0;break;default:eb=this.oM}(eb=this.getButton(eb))?eb.get_element().focus():super.setFocus()}Lsb(){const eb=I.h(this.$);eb.eb&&eb.Xb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",
0);4===this.returnValue&&this.RXd(1);if(2===this.returnValue||0===this.returnValue){const Eb=eb.Jb(null);if(Eb){eb.Ca.tV();const Wb=Object(y.a)(new S.a,{Text:Eb.originalText});eb.setCell(Wb,Eb.range,0,63,null)}this.$.Yc(-798660877,t.a.zb,8,null)}super.Lsb()}rta(){const eb=I.h(this.$);eb.eb&&eb.Xb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.RXd(0);super.rta()}RXd(eb){const Eb=I.h(this.$);C.TaskExtensions.za(Eb.startEdit(!1,eb),()=>{const Wb=Eb.Xb.textBox;
Wb.text&&Wb.selectRange(0,Wb.text.length)},this.ka,11,P.a.current)}static DQ(eb,Eb,Wb){Wb=Eb.da.Ba(14).a5a(Wb);eb.MessageId=-1083021405;eb.MessageIdName="DataValidationError";eb.MessageIdHash=d.a.mu(eb.MessageIdName);eb.Severity=Wb?Wb.kbd:1;Eb=(null===Wb||void 0===Wb?0:Wb.$Ja)?d.a.Og(Wb.$Ja):null;Wb=(null===Wb||void 0===Wb?0:Wb.error)?d.a.Og(Wb.error):String.format("<p>{0}</p><p>{1}</p>",H.a.instance.ga(896),H.a.instance.ga(897));switch(eb.Severity){case 0:eb.Appearance=18;break;case 1:eb.Appearance=
12;Wb+=String.format("<p>{0}</p>",H.a.instance.ga(898));break;default:eb.Appearance=3}eb.Caption=Eb;eb.Description=Wb;eb.HelpDescription=H.a.instance.ga(1319);eb.HelpTopicId=z.a.eMe;return eb}}Object(r.a)(D,"DataValidationErrorDeprecatedDialog",A.ErrorDialog,[]);A=a(292);var G=a(1115),E=a(5),O=a(44),N=a(291),J=a(200),W=a(52),ea=a(29),R=a(255),Y=a(1),U=a(11),da=a(290),T=a(170);class ka extends A.a{constructor(eb,Eb,Wb){super(eb);this.JU=this.Dq=null;this.Wnf=!1;this.nS=this.Om=this.Wdf=this.errorMessage=
null;this.fMe=Ab=>{const Jb=this.$;var Gb=this.Wnf;this.hide();const Nb=I.h(Jb);Nb.eb&&Nb.Xb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Ab&&Gb&&C.TaskExtensions.za(Nb.startEdit(!1,1),()=>{const Ja=Nb.Xb.textBox;Ja.text&&Ja.selectRange(0,Ja.text.length)},this.ka,11,P.a.current);if(1===Ab&&!Gb){if(Gb=Nb.Jb(null)){Nb.Ca.tV();const Ja=Object(y.a)(new S.a,{Text:Gb.cell.userInput});Nb.setCell(Ja,Gb.range,0,63,null)}Jb.Yc(-798660877,t.a.zb,8,null)}2===Ab&&C.TaskExtensions.za(Nb.startEdit(!1,
0),()=>{const Ja=Nb.Xb.textBox;Ja.text&&Ja.selectRange(0,Ja.text.length)},this.ka,11,P.a.current)};this.NEd=()=>{U.HelperMethods.bW(this.$.pG,this.error.HelpTopicId,this.$.wS)};this.gZi=()=>{this.Wzb();this.$.Yc(802602464,2,8,this.JU)};this.IXi=()=>{v.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.JXi=Ab=>{!Ab||R.a(Ab)?v.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(Ab=this.q6h(Ab.Result),this.Dq.errorInformation=Ab,this.LUa(this.$Ja,this.G5a(this.fMe),this.Dq))};this.uEd=()=>{this.show(this.lUb)};this.BSe=Wb;this.sqmManager=T.a(this.$);this.error=ka.DQ(Eb,eb,Wb);this.pb.Zo=this;this.$Ja=(this.ow=eb.da.Ba(14).a5a(this.BSe))&&this.ow.$Ja?this.ow.$Ja:H.a.instance.ga(1736);this.ZCj();this.initializeAndShow(this.$Ja,this.fMe,this.Dq)}get pc(){return"DataValidationErrorDialog"}dispose(){this===this.pb.Zo&&(this.pb.Zo=null);f.a.Ja(this.Om);this.Om=null;super.dispose()}ZCj(){var eb,
Eb,Wb;this.ow&&this.ow.options&1?(v.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=null!==(eb=this.ow.error)&&void 0!==eb?eb:H.a.instance.ga(1738),this.Wdf=W.a.current.Un(120)):(this.errorMessage=null!==(Wb=null===(Eb=this.ow)||void 0===Eb?void 0:Eb.error)&&void 0!==Wb?Wb:H.a.instance.ga(1737),this.PWh(this.BSe));eb=this.ow?this.ow.kbd:1;this.Dq={[ka.pt]:this.pc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.Wdf};
switch(eb){case 0:this.Rb=1;this.wc(1,"Retry");this.Dq.dialogIcon=2;this.Wnf=!0;break;case 1:this.Rb=4;this.Dq.dialogIcon=1;this.Dq.additionalInformation=H.a.instance.ga(898);break;default:this.Rb=1,this.Dq.dialogIcon=3}this.Dq.helpLink={["type"]:"AppLinkProps",[ka.pt]:this.error.HelpTopicId,["text"]:H.a.instance.ga(1319),["handler"]:this.NEd};eb=ea.a.v_c([this.error]);this.JU={[E.a.Qac]:!0,[E.a.rdd]:eb,[E.a.sdd]:T.a(this.$).wvb(this.error.MessageIdHash),[E.a.VJ]:this.pc,["DismissHandler"]:this.uEd};
this.Dq.giveFeedbackLink={["type"]:"AppLinkProps",[ka.pt]:E.a.zld,["text"]:H.a.instance.ga(1775),["handler"]:this.gZi}}PWh(eb){const Eb=this.$.pa.va.$b();N.g(this.$.pa.va,O.q(eb,this.$),da.b(this.JXi),da.a(this.IXi),null,Eb)}q6h(eb){let Eb;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7253041_adddatavalidationerrortypetelemetry");v.ULS.sendTraceTag(509732815,0,50,`DataValidationErrorDialog.getRuleDescriptionString: The data validation error is because of ${G.a[eb.RuleType].toString()}`);switch(eb.RuleType){case 1:switch(eb.ConditionType){case 0:return Eb=
H.a.instance.nb(108),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 1:return Eb=H.a.instance.nb(109),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 2:return Eb=H.a.instance.nb(110),String.format(Eb,eb.LowerBoundary);case 3:return Eb=H.a.instance.nb(111),String.format(Eb,eb.LowerBoundary);case 4:return Eb=H.a.instance.nb(112),String.format(Eb,eb.LowerBoundary);case 5:return Eb=H.a.instance.nb(113),String.format(Eb,eb.UpperBoundary);case 6:return Eb=H.a.instance.nb(114),String.format(Eb,
eb.LowerBoundary);case 7:return Eb=H.a.instance.nb(115),String.format(Eb,eb.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(eb.ConditionType){case 0:return Eb=H.a.instance.nb(116),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 1:return Eb=H.a.instance.nb(117),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 2:return Eb=H.a.instance.nb(118),String.format(Eb,eb.LowerBoundary);case 3:return Eb=H.a.instance.nb(119),String.format(Eb,eb.LowerBoundary);case 4:return Eb=
H.a.instance.nb(120),String.format(Eb,eb.LowerBoundary);case 5:return Eb=H.a.instance.nb(121),String.format(Eb,eb.UpperBoundary);case 6:return Eb=H.a.instance.nb(122),String.format(Eb,eb.LowerBoundary);case 7:return Eb=H.a.instance.nb(123),String.format(Eb,eb.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(eb.ConditionType){case 0:return Eb=H.a.instance.nb(124),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 1:return Eb=H.a.instance.nb(125),String.format(Eb,eb.LowerBoundary,
eb.UpperBoundary);case 2:return Eb=H.a.instance.nb(126),String.format(Eb,eb.LowerBoundary);case 3:return Eb=H.a.instance.nb(127),String.format(Eb,eb.LowerBoundary);case 4:return Eb=H.a.instance.nb(128),String.format(Eb,eb.LowerBoundary);case 5:return Eb=H.a.instance.nb(129),String.format(Eb,eb.UpperBoundary);case 6:return Eb=H.a.instance.nb(130),String.format(Eb,eb.LowerBoundary);case 7:return Eb=H.a.instance.nb(131),String.format(Eb,eb.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(eb.ConditionType){case 0:return Eb=
H.a.instance.nb(132),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 1:return Eb=H.a.instance.nb(133),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 2:return Eb=H.a.instance.nb(134),String.format(Eb,eb.LowerBoundary);case 3:return Eb=H.a.instance.nb(135),String.format(Eb,eb.LowerBoundary);case 4:return Eb=H.a.instance.nb(136),String.format(Eb,eb.LowerBoundary);case 5:return Eb=H.a.instance.nb(137),String.format(Eb,eb.UpperBoundary);case 6:return Eb=H.a.instance.nb(138),String.format(Eb,
eb.LowerBoundary);case 7:return Eb=H.a.instance.nb(139),String.format(Eb,eb.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(eb.ConditionType){case 0:return Eb=H.a.instance.nb(140),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 1:return Eb=H.a.instance.nb(141),String.format(Eb,eb.LowerBoundary,eb.UpperBoundary);case 2:return Eb=H.a.instance.nb(142),String.format(Eb,eb.LowerBoundary);case 3:return Eb=H.a.instance.nb(143),String.format(Eb,eb.LowerBoundary);case 4:return Eb=
H.a.instance.nb(144),String.format(Eb,eb.LowerBoundary);case 5:return Eb=H.a.instance.nb(145),String.format(Eb,eb.UpperBoundary);case 6:return Eb=H.a.instance.nb(146),String.format(Eb,eb.LowerBoundary);case 7:return Eb=H.a.instance.nb(147),String.format(Eb,eb.UpperBoundary);default:return"we couldn't get the details"}case 3:return Eb=H.a.instance.nb(106),String.format(Eb,eb.LowerBoundary);case 7:return Eb=H.a.instance.nb(107),String.format(Eb,eb.LowerBoundary);default:return"we couldn't get the details"}}RXd(eb){const Eb=
I.h(this.$);C.TaskExtensions.za(Eb.startEdit(!1,eb),()=>{const Wb=Eb.Xb.textBox;Wb.text&&Wb.selectRange(0,Wb.text.length)},this.ka,11,P.a.current)}get ka(){this.Om=this.Om||new J.a;return this.Om.token}static DQ(eb,Eb,Wb){Eb=Eb.da.Ba(14).a5a(Wb);eb.MessageId=-1083021405;eb.MessageIdName="DataValidationError";eb.MessageIdHash=d.a.mu(eb.MessageIdName);eb.Severity=Eb?Eb.kbd:1;eb.HelpDescription=H.a.instance.ga(1319);eb.HelpTopicId=z.a.eMe;return eb}}Object(r.a)(ka,"DataValidationErrorDialog",A.a,[88,
89,3,90]);A=a(937);var L=a(391);class fa extends A.a{constructor(eb,Eb,Wb){super(eb,Eb);this.dataValidationControl=Wb}get wBb(){return Object(h.a)(ka,this.$.pb.kh)}get rK(){return this.dataValidationControl.ye}set rK(eb){this.dataValidationControl.ye=eb}get N6a(){return!1}get key(){return L.a.T8c}dispose(){this.dataValidationControl=null;super.dispose()}Wh(eb,Eb){this.dataValidationControl.gb=this.gb;const Wb=eb.keyCode;return 1461300262!==Eb||16!==Wb&&17!==Wb&&18!==Wb?super.Wh(eb,Eb):!1}CDd(){this.rK&&
(this.dataValidationControl.gb=this.gb,this.dataValidationControl.show(this.dataValidationControl.fN,!0,!0,e.a.lp||3===t.a.zb))}dg(){}Di(){this.dataValidationControl.show(this.dataValidationControl.fN,!0,!0,e.a.lp||3===t.a.zb)}ZJd(eb,Eb){return this.dataValidationControl.Wh(Eb)}}Object(r.a)(fa,"DataValidationListAutoCompleteBehavior",A.a,[]);var wa=a(274);A=a(861);var oa=a(12),xa=a(120),bb=a(22),Za=a(936);class La extends A.a{constructor(eb,Eb,Wb,Ab){super(eb,Eb,new Za.a(k.listItem,k.uEb,k.xEb,k.yEb));
this.nJa=this.MV=this.hea=this.oe=this.pnb=null;this.yOa=0;this.jIb=[];this.S4j=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.htmlSanitizationHelper=null;this.wEb=Wb;this.htmlSanitizationHelper=Ab}get Jj(){return this.pnb}set Jj(eb){this.sCa(this.pnb);if(eb){this.pnb=eb;this.wEb.innerText="";this.sCa(this.pnb);const Eb=this.jIb[eb.rowIndex];this.oe=this.MV[Eb];this.nJa&&(this.hea=this.nJa[Eb],v.ULS.shipAssertTag(537163286,0,!this.jIb.length||!!this.hea,
"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.wEb.innerText=this.oe;this.cyc(eb)}else this.hea=this.oe=null}get eb(){return I.h(this.$).eb}get editText(){return I.h(this.$).Xb.text}dispose(){super.dispose();this.wEb=this.pnb=null}Tea(eb,Eb,Wb,Ab){if(eb&&(!eb.length&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7590001_DataValidationEmptyListBugFix")&&v.ULS.sendTraceTag(509366878,0,50,"Empty data validation list is updated correctly with CG OfficeVSO:7590001_DataValidationEmptyListBugFix."),
!eb||eb.length||Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7590001_DataValidationEmptyListBugFix"))){this.N7(!1);this.nJa=eb;this.MV=[];for(var Jb=0;Jb<eb.length;Jb++)this.MV[Jb]=eb[Jb]?eb[Jb].Name:null;Jb=`<table class='${this.N5}' aria-live='polite'><tbody>`;var Gb="",Nb="";eb=0;var Ja=I.h(this.$).Jb(null);Ab=this.eb?Ab?Ab.text:this.editText:Ja?Ja.originalText:null;Ja=!Ab;var ab=0;this.jIb.length=0;var wb=[],xb=[],rb=[],za=Ab?Ab.split(" "):[""];Ab=Ab.trim();for(let pb=0;pb<this.MV.length;pb++){const kb=
this.MV[pb];var Aa=void 0;const Cb=kb.split(" ");Aa=wa.a.all(za,ma=>wa.a.any(Cb,Ga=>bb.a.fG(Ga,ma)));const ob=!kb,qa=rb.includes(kb);ob||qa||this.eb&&!Aa||(Aa=kb?d.a.Og(d.a.vad(kb)):"",Aa=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.LV,Aa),rb.push(kb),this.eb&&bb.a.fG(kb,Ab)?(Gb+=Aa,wb.push(pb)):(Nb+=Aa,xb.push(pb)),!Ja&&bb.a.equals(Ab,kb,!0)&&(eb=this.eb?wb.length-1:ab,Ja=!0),ab++)}this.yOa=ab;this.jIb.push(...wb);this.jIb.push(...xb);this.htmlSanitizationHelper.jh(this.Nf,Jb+
(Gb+Nb+"</tbody></table>"));Jb=this.An=oa.DOMElementExtensions.hk(this.domElement,this.N5);this.apb(Jb,Eb);this.N7(!0);this.Msa(Eb,Wb);this.Jj=0<this.yOa?Jb.rows[eb]:null}}ySa(eb){var Eb=!1;this.eb&&eb&&(Eb=!this.yOa,eb.endEdit(Eb,"DataValidationListBox.SetCellContent",0));if(!Eb&&(eb=I.h(this.$),Eb=eb.Jb(null))){let Ab=null;if(this.hea&&-1!==this.hea.SheetId&&-1!==this.hea.Row&&-1!==this.hea.Column){var Wb={};Wb.SheetName=this.hea.SheetId.toString();Wb.FirstRow=this.hea.Row;Wb.FirstColumn=this.hea.Column;
Ab={ParameterType:6};Ab.SourceRange=Wb}Wb=Object(y.a)(new S.a,{Text:this.oe});eb.setCell(Wb,Eb.range,0,63,Ab)}return!0}Msa(eb,Eb){const Wb=eb?this.qFb:this.bI;eb=eb?this.Kmc:this.Lmc;0>=this.yOa?this.Nf.style.height=U.HelperMethods.zc(eb):(this.Nf.style.height="auto",this.yOa>Wb?(oa.DOMElementExtensions.SI(this.Nf,this.S4j?Math.floor(eb*Wb):Math.floor(this.Nf.offsetHeight*Wb/this.yOa)),this.Nf.style.overflowY="auto"):(this.Nf.style.height="auto",this.Nf.style.overflowY="hidden"));oa.DOMElementExtensions.Sv(this.Nf,
Eb);oa.DOMElementExtensions.Sv(this.An,Eb-(this.yOa>Wb?xa.a.Ku:0))}}Object(r.a)(La,"DataValidationListBox",A.a,[]);var va=a(121),Ba=a(260),Ea=a(263),pa=a(1124);const $a=`<p class='${k.vth}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,cb=`<p class='${k.uth}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var ib=x.a.RTe,ta=x.a.RTe,Ya=x.a.d9g;class Da extends l.a{constructor(eb,Eb){super(document.createElement("div"));this.z3b=this.LQ=this.oR=!1;this.Zh=this.Nh=null;this.asi=
Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");this.bsi=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.Mqd=this.Dtd=this.Ksd=!1;this.e8b=[];this.htmlSanitizationHelper=null;this.Gg=()=>{this.mbg(!1)};this.FPa=(Wb,Ab)=>{this.show(this.fN,!this.ye,!0,e.a.lp||3===Ab.wb||3===t.a.zb);this.gEd(null,null)};this.gEd=()=>{this.gridView.setFocus()};this.wMa=()=>{this.gb.textBox.oF=!0};this.Ht=()=>{this.Tmg()};this.onContentReady=
()=>{this.mbg(this.ye)};this.yc=()=>{this.ey()};this.Fza=()=>{this.ySa()};this.EEf=()=>{this.Tmg()};this.$=eb;this.gridView=I.h(this.$);this.XI=this.gridView.Xb;this.htmlSanitizationHelper=Eb;Eb="<div id='dv_reader_description' class='"+w.a.hUe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+k.gzh+" "+x.a.uo+"'></div>\r\n<div id='dv_list_box' class='"+k.myh+" "+x.a.vo+" "+x.a.uo+"'></div>\r\n<div id='dv_prompt_box' class='"+k.ezh+" "+x.a.uo+"'></div>";this.domElement.className=
k.fzh;this.htmlSanitizationHelper.jh(this.domElement,Eb);Ba.d(this.style,this.isGridRtl);this.Nf=$get("dv_list_box",this.domElement);this.X_=$get("dv_prompt_box",this.domElement);this.nta=$get("dv_list_button",this.domElement);this.wEb=$get("dv_reader_description",this.domElement);(Eb=va.a(eb))&&this.e8b.push(new fa(eb,Eb,this));this.e8b.push(new fa(eb,this.gridView.Xb,this));this.gridView.ha.vA(this.Gg);this.gridView.ev(this.onContentReady);this.gridView.oc.DPg(this.EEf);this.$.ij(this.yc);Eb=this.gridView.zj;
Eb.insertBefore(this.domElement,Eb.firstChild);this.onContentReady(null,null);eb.da.Ha(14,this)}get fDb(){return!!(this.$.Bd&16)}get jAi(){return this.ye||this.fN||this.lxa}get ye(){return oa.DOMElementExtensions.isVisible(this.Nf)}set ye(eb){oa.DOMElementExtensions.setVisible(this.Nf,eb)}get fN(){return oa.DOMElementExtensions.isVisible(this.X_)}set fN(eb){oa.DOMElementExtensions.setVisible(this.X_,eb)}get lxa(){return oa.DOMElementExtensions.isVisible(this.nta)&&!!this.Nh&&oa.DOMElementExtensions.isVisible(this.Nh.domElement)}set lxa(eb){oa.DOMElementExtensions.setVisible(this.nta,
eb);this.Nh&&oa.DOMElementExtensions.setVisible(this.Nh.domElement,eb)}get gb(){return this.XI}set gb(eb){this.XI=eb}get f6a(){return!!this.activeCell&&this.w$c(this.activeCell.range)}get activeCell(){return this.gridView.Jb(null)}get odf(){return this.f6a&&!!this.ow&&!!(this.ow.options&2)&&!!this.ow.prompt}get tzb(){return this.f6a&&!!this.ow&&!!(this.ow.options&1)}get isGridRtl(){return this.gridView.rtl}get ow(){return this.a5a(this.activeCell.range)}get pPa(){const eb=this.activeCell;return eb?
this.ewa(this.gridView,eb):null}dispose(){this.$&&(this.nPb(!1),this.gridView.ha.TF(this.Gg),this.gridView.ty(this.onContentReady),this.gridView.oc.noj(this.EEf),this.$.$k(this.yc));this.rKe(!1);this.sKe(!1);f.a.sc(this.e8b);this.e8b=this.nta=this.Nf=this.X_=this.XI=this.gridView=this.$=null;super.dispose()}w$c(eb){return!!this.a5a(eb)}W1a(eb,Eb){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new ka(this.$,eb,Eb):new D(this.$,eb,Eb)}a5a(eb){eb=this.gridView.getRangeInformation(eb);
for(let Eb=0;Eb<eb.length;Eb++){const Wb=eb[Eb];if(Object(h.a)(u.DataValidationRange,Wb))return Wb}return null}LSh(){if(!this.f6a)return"";const eb=this.odf?`${this.ow.sSf} ${this.ow.prompt}`:"",Eb=this.tzb?H.a.instance.ga(843):"";return String.format(H.a.instance.nb(17),eb,Eb)}Wh(eb){let Eb=!1;if(this.ye||(-569786022===eb||541421805===eb)&&this.tzb||1872288872===eb&&this.fN)switch(eb){case -569786022:case 541421805:this.show(this.fN,!this.ye,!0,e.a.lp||3===t.a.zb);Eb=!0;break;case 1872288872:this.ye?
(this.show(this.fN,!1,!0,!1),Eb=!0):this.fN?(this.show(!1,!1,!0,!1),Eb=!0):this.gb&&(this.gb.endEdit(!1,"DataValidationControl.HandleKeyDown",0),Eb=!0);break;case -798660877:this.Zh.jB(1);Eb=!0;break;case 137938150:this.Zh.jB(-1);Eb=!0;break;case 2091832999:this.Zh.jB(this.Zh.bI-1);Eb=!0;break;case 742457698:this.Zh.jB(-(this.Zh.bI-1));Eb=!0;break;case 125627505:case 267796030:Eb=this.ySa()}return Eb}show(eb,Eb,Wb,Ab){this.ey();if(this.fDb&&this.f6a){var Jb=this.pPa;if(Jb){if(eb||Eb||Wb)this.isVisible=
!0;Ba.d(this.style,this.isGridRtl);Wb&&this.tzb&&(this.sKe(!0),this.Kmg(Jb,!1));Eb&&this.tzb&&this.kTa(Ab,Jb);eb&&this.odf&&this.bPj(Jb);this.jAi||(this.isVisible=!1)}}}ewa(eb,Eb){if(!Eb||!Eb.cell.ek)return null;var Wb=this.gridView.oc.textBox.domElement;var Ab=0<oa.DOMElementExtensions.getHeight(Wb)&&0<oa.DOMElementExtensions.getWidth(Wb)&&0<=Wb.offsetTop&&0<=Wb.offsetLeft;if(Ab)Wb=oa.DOMElementExtensions.ewa(Wb,eb.zj);else{Wb=eb.getCellBounds(Eb.cell);var Jb=oa.DOMElementExtensions.getBoundingClientRect(eb.zj);
Wb=new Sys.UI.Bounds(Wb.x-Jb.x,Wb.y-Jb.y,Wb.width,Wb.height)}if(Wb)if(Ab)2<Wb.height&&2<Wb.height&&(Wb.x+=1,Wb.y+=1,Wb.height-=2,Wb.width-=2);else if(Ab=I.h(this.$).$J(Eb.cell))Ab=Ab.width+1,Jb=bb.a.equals(Ea.a.Dxb(Eb.cell,eb.rtl),"right",!0),eb.rtl&&Jb&&(Wb.x=Wb.x+Wb.width-Ab),Eb.bca&&eb.rtl===Jb&&(Wb.width=Ab);else return null;return Wb}mbg(eb){const Eb=this.f6a;this.nPb(Eb);Eb?this.show(!0,eb,!0,!1):this.ey()}ySa(){let eb=!1;this.ye&&(eb=this.Zh.ySa(this.gb),this.show(this.fN,!1,!0,!1));return eb}ey(){this.asi?
(this.ye&&(this.ye=!1),this.lxa&&(this.lxa=!1),this.fN&&(this.fN=!1),this.isVisible&&(this.isVisible=!1)):this.ye=this.lxa=this.fN=this.isVisible=!1;this.Ksd=this.Mqd=this.Dtd=!1}kTa(eb,Eb){this.tzb&&!this.ow.nJa?this.lxa&&this.Nh.disable():(this.rKe(!0),this.Zh.Tea(this.ow.nJa,eb,this.f1h(Eb),this.gb),this.LCa(Eb,!1))}bPj(eb){this.ow.prompt&&(this.fN=!0,this.M6j(this.ow.sSf,this.ow.prompt),this.dng(eb,!1))}Kmg(eb,Eb){const Wb=eb.y;this.nta.style.top=U.HelperMethods.zc(Wb);eb=this.isGridRtl?eb.x-
this.nta.offsetWidth+1:eb.x+eb.width+1;this.nta.style.left=U.HelperMethods.zc(eb);Eb?this.lxa=this.gridView.xlc(new m.a(eb,Wb))&&this.Mqd:this.Mqd=!0}LCa(eb,Eb){const Wb=eb.y+eb.height;eb=this.isGridRtl?eb.x+eb.width-this.Nf.offsetWidth:eb.x;this.Nf.style.top=U.HelperMethods.zc(Wb);this.Nf.style.left=U.HelperMethods.zc(eb);Eb?this.ye=this.gridView.xlc(new m.a(eb,Wb))&&this.Ksd:this.Ksd=!0}dng(eb,Eb){const Wb=eb.y+eb.height+5;var Ab=this.activeCell;Ab=Ab?Ab.width/2:32;eb=this.isGridRtl?eb.x-this.X_.offsetWidth+
Ab:eb.x+eb.width-Ab;this.X_.style.top=U.HelperMethods.zc(Wb);this.X_.style.left=U.HelperMethods.zc(eb);Eb?this.fN=this.gridView.xlc(new m.a(eb,Wb))&&this.Dtd:this.Dtd=!0}M6j(eb,Eb){if(Eb){var Wb="";eb&&(Wb+=String.format($a,d.a.Og(eb)));Wb+=String.format(cb,d.a.Og(Eb));this.htmlSanitizationHelper.jh(this.X_,Wb);eb=oa.DOMElementExtensions.hk(this.X_,"dv-prompt-titletext");if(Eb=oa.DOMElementExtensions.hk(this.X_,"dv-prompt-messagetext")){eb=eb?parseInt(String(Math.max(eb.offsetWidth,Eb.offsetWidth)),
10):Eb.offsetWidth;eb+=6;oa.DOMElementExtensions.Sv(this.X_,eb);for(let Ab=0,Jb=this.X_.children.length;Ab<Jb;Ab++)oa.DOMElementExtensions.Sv(this.X_.children[Ab],eb)}}}f1h(eb){return this.bsi?eb.width+17-2+1:eb.width+this.nta.clientWidth-2+1}sKe(eb){this.$&&!this.fDb||!eb?(this.sfg(!1),f.a.Ja(this.Nh),this.Nh=null):(this.Nh||(this.Nh=new pa.a(this.nta,ib,n.a.Cia,1,ta,H.a.instance.ga(895),Ya,H.a.instance.ga(894),"",-1),this.sfg(!0)),this.lxa=!0,this.ow.nJa?this.Nh.isEnabled||this.Nh.enable():this.Nh.disable())}rKe(eb){this.$&&
!this.fDb||!eb?(this.TTa(!1),f.a.Ja(this.Zh),this.Zh=null):(this.Zh||(this.Zh=new La(this.$,this.Nf,this.wEb,this.htmlSanitizationHelper),this.TTa(!0)),this.ye=!0)}TTa(eb){this.Zh&&(eb&&!this.oR?(this.Zh.O9(this.gEd),this.Zh.J0b(this.wMa),this.Zh.xpb(this.Fza),this.oR=!0):!eb&&this.oR&&(this.Zh.Qda(this.gEd),this.Zh.Ovc(this.wMa),this.Zh.aLb(this.Fza),this.oR=!1))}nPb(eb){eb&&!this.LQ?(this.gridView.view.Vs(this.Ht),this.LQ=!0):!eb&&this.LQ&&(this.gridView.view.Xq(this.Ht),this.LQ=!1)}sfg(eb){this.Nh&&
(eb&&!this.z3b?(this.Nh.AYc(this.FPa),this.Nh.MYc(this.FPa),this.Nh.gpb(this.wMa),this.z3b=!0):!eb&&this.z3b&&(this.Nh.qNd(this.FPa),this.Nh.DNd(this.FPa),this.Nh.LKb(this.wMa),this.z3b=!1))}Tmg(){if(this.f6a){var eb=this.pPa;eb&&(this.Kmg(eb,!0),this.LCa(eb,!0),this.dng(eb,!0))}}}Object(r.a)(Da,"DataValidationControl",l.a,[269,3]);var ba=a(50),ya=a(58),V=a(108),Z=a(153),ja=a(54);class la extends b.a{constructor(eb){super();this.$=eb;this.Gb()}create(){let eb=ya.Task.Ta(null);eb=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?
Object(V.c)(Z.a.resolve(ja.w,{Wb:this.Na})):ba.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na);C.TaskExtensions.za(eb,()=>{this.qb(this.$.da.Ba(14)||new Da(this.$,eb.result))},this.ka,3)}}Object(r.a)(la,"DataValidationControlFactory",b.a,[]);a.d(B,"a",function(){return ua});const ua=()=>{c.a.Fa(eb=>{eb.da.Ha(150,new la(eb))})}},1251:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(15),f=a(197);const d={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,
commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,dismissSmartSuggestionImplicitlyCounter:0},h={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},l={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0,
argumentAssistanceCardIsInitialModeDefault:!1},k={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,smartSuggestionChangedCounter:0,smartSuggestionDeletedCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},w={parenthesesCouplingCounter:0,formulaHighlightsCounter:0},n={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,
argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},x={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,smartFormulaSuggestionsFeatureEnabled:void 0,parenthesesCouplingFlight:void 0,coloredReferencesFlight:void 0,uILocale:void 0,dataLocale:void 0,country:void 0};var m;(function(N){N.RenderDown=
"rd";N.RenderUp="ru";N.Expand="e";N.Collapse="c";N.Drag="d";N.Move="m";N.GiveFeedback="gf";N.InitialModeExpanded="ie";N.InitialModeCollapsed="ic";N.LearnMore="lm"})(m||(m={}));Object(r.b)("argumentAssistanceUsageActions",m);var u=a(59),t=a(1125),y=a(1),v=a(22),A=a(40),z=a(21),C=a(103),H;(function(N){N[N.function=3]="function";N[N.namedRange=100]="namedRange";N[N.tableHeader=101]="tableHeader";N[N.letVariable=102]="letVariable";N[N.richEntity=103]="richEntity";N[N.lambda=104]="lambda";N[N.customFunction=
105]="customFunction";N[N.table=106]="table";N[N.tableSpecialStructRef=107]="tableSpecialStructRef";N[N.richEntityEmptyCellRef=108]="richEntityEmptyCellRef";N[N.rangeRef=109]="rangeRef"})(H||(H={}));Object(r.b)("CompletionItemKind",H);var I=a(33),S=a(862),P=a(973);const D={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,80,100,130,150,
170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,170,200],["tryUpdateHighlightsFromCellContentEditor"]:[50,80,100,130,150,170,200]};class G{constructor(N){this.$=N;this.zF=null;this.cEb=-1;this.smc=null;this.Owd=this.eEb=0;this.BP=Object.assign({},l);this.UC=Object.assign({},k);this.wJ=Object.assign({},d);this.Oqb=Object.assign({},h);this.bcc=Object.assign({},w);this.dS=Object.assign({},x);this.Pqb={};this.y4a=Object.assign(Object.assign({},n),{isReactDialog:I.a.Gmf()});this.lqb=[];this.sHa=
y.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.$Ia={};this.dg=(J,W)=>{null!=this.zF&&(1==Math.abs(this.cEb-this.$.ea.se)&&(J=this.$.ua.na.sheetId,W.E1a&&W.Sk.equals(this.zF.Sk)&&this.smc===J&&this.zF.q4b!==W.q4b&&this.eEb++),1<=Math.abs(this.cEb-this.$.ea.se)&&(this.zF=null,this.cEb=-1,this.smc=null));y.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&0<Object.keys(this.$Ia).length&&(e.ULS.sendTraceTag(509658956,
0,50,`FormulaAssistanceTelemetryManager.onEditEnded: current edit's completion items data: ${JSON.stringify(this.$Ia)}`),this.$Ia={})};this.yc=(J,W)=>{W.Ef||W.Crd||(this.BGj(),this.KGj(),this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging()))};this.tbb=new C.a;N.ij(this.yc);z.h(this.$).Mh.rm(this.dg)}dispose(){this.$&&z.h(this.$).Mh.dm(this.dg)}ND(N){N.forEach(J=>{this.tbb.kb(J)||this.tbb.ia(J,new t.a(D[J]));this.tbb.ma(J).KTa()})}rv(N,J=!0){N.forEach(W=>{this.tbb.kb(W)&&this.tbb.ma(W).N3(J)})}o6f(N){this.pJ(0===
N?"ie":"ic")}UBj(N){this.pJ(N?"ie":"ic")}n6f(){this.BP.argumentAssistanceCardIsInitialModeDefault=!0}Pua(N){window.requestAnimationFrame(()=>{this.rv([N])})}A_f(N){N.forEach(J=>{J=H[J.kind];this.mpg(J);this.Pqb[J].shownCounter++;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&this.$Ia[J].shownCounter++})}z_f(N){N=H[N];this.mpg(N);this.Pqb[N].committedCounter++;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&this.$Ia[N].committedCounter++}pJ(N){if(this.sHa){const J=
this.lqb.length;0===J||this.lqb[J-1][0]!==N?this.lqb.push([N,1]):this.lqb[J-1][1]++}else switch(N){case "e":this.BP.argumentAssistanceExpandCounter++;break;case "c":this.BP.argumentAssistanceCollapseCounter++;break;case "d":this.BP.argumentAssistanceDragCounter++;break;case "m":this.BP.argumentAssistanceMoveCounter++;break;case "lm":this.BP.argumentAssistanceLearnMoreCounter++;break;case "ie":this.BP.argumentAssistanceCardInitialMode="Expanded";break;case "ic":this.BP.argumentAssistanceCardInitialMode=
"Collapsed"}}getJsonForLogging(){return"{"+this.tM("SessionDetails",this.dS)+","+this.tM("ArgumentAssistanceUsage",this.BP)+","+this.tM("argumentAssistanceOrderedActions",this.lqb)+","+this.tM("FormulaSuggestionsUsage",this.UC)+","+this.tM("FunctionDialogUsage",this.y4a)+","+this.tM("AutocompleteCardInteraction",this.wJ)+","+this.tM("AutocompleteRenderOptimization",this.Oqb)+","+this.tM("AutocompleteUsageByKind",this.Pqb)+","+this.tM("FormulaHighlightsUsage",this.bcc)+","+this.X6h()+"}"}KGj(){this.UC.smartSuggestionChangedCounter=
this.eEb;this.UC.smartSuggestionDeletedCounter=this.Owd;this.UC.smartSuggestionKeptCounter=this.UC.smartSuggestionCommittedCounter-this.eEb-this.Owd;for(let N=0;N<this.UC.smartSuggestionKeptCounter;N++)Object(S.a)(P.b)}BGj(){this.dS.argumentAssistanceFlight=this.Sva("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.dS.autoCompleteUIFlight=this.Sva("Microsoft.Office.Excel.","AutoCompleteNewUI");this.dS.smartFormulaBarAutoCompleteFlight=this.Sva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");
this.dS.smartFormulaBarAutoCompletePluginFlight=this.Sva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.dS.formulaAssistanceRedesignFlight=this.Sva("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.dS.NewInsertFunctionDialogFlight=this.Sva("Microsoft.Office.Excel.","NewInsertFunctionDialog");this.dS.coloredReferencesFlight=this.Sva("Microsoft.Office.Excel.","ColoredReferences");this.dS.parenthesesCouplingFlight=this.Sva("Microsoft.Office.Excel.","ParenthesesCoupling");
this.dS.smartFormulaSuggestionsFeatureEnabled=I.a.lNa(this.$);this.dS.uILocale=this.$.EUa;this.dS.dataLocale=this.$.dataCultureTag;this.dS.country=JSON.parse(this.$.ya.SessionStartInfoJson).LocationCountry}X6h(){const N=new f.a;for(let J of this.tbb)J.value.xZe(),N.add(`"${J.key}":${u.a.Ec(J.value.hW)}`);return`"PerfMeasurements": {${N.toArray().join(",")}}`}Sva(N,J){return v.a.contains(this.$.ya.FlightHolder.FlightId,J,!0)?y.EwaSettings.getBooleanFeatureGate(N+J,!1)?"T":"C":"None"}tM(N,J){return`"${N.toString()}":${A.c(J)}`}mpg(N){this.Pqb[N]||
(this.Pqb[N]={shownCounter:0,committedCounter:0});y.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&!this.$Ia[N]&&(this.$Ia[N]={shownCounter:0,committedCounter:0})}}Object(r.a)(G,"FormulaAssistanceTelemetryManager",null,[272]);class E extends b.a{constructor(N){super();this.$=N;this.Gb()}static la(N){N.da.Ha(492,new E(N))}create(){var N;this.qb(null!==(N=this.$.da.Ba(491))&&void 0!==N?N:this.$.da.Ha(491,new G(this.$)))}}Object(r.a)(E,"FormulaAssistanceTelemetryManagerFactory",
b.a,[]);a.d(B,"a",function(){return O});const O=()=>{c.a.Fa(N=>{E.la(N)})}},1255:function(r,B,a){a.r(B);r=a(0);var c=a(15),b=a(286),e=a(98),f=a(41),d=a(274),h=a(554),l=a(4),k=a(87),w=a(424),n=a(739),x=a(8),m=a(34),u=a(18),t=a(64),y=a(5),v=a(806),A=a(1079),z=a(860),C=a(14),H=a(33);class I{constructor(ab,wb,xb,rb,za,Aa,pb,kb){this.$=wb;this.Xa=xb;this.vl=rb;this.selectedRanges=za;this.grid=Aa;this.zy=kb;this.L4=pb;this.oha=d.a.all(za,Cb=>Cb.isRow);this.Psa=d.a.all(za,Cb=>Cb.Fg);this.jGb=d.a.all(za,
Cb=>!Cb.isRow&&!Cb.Fg);wb=Aa.tb.Jkd(za);this.Btb=!!wb;this.u_f=!!wb&&wb.hasActiveFilter;this.menuSection=xb.Jc();ab.uc.push(this.menuSection);this.Mba=this.oha||this.Psa?this.menuSection:xb.Jc();this.qua=this.oha||this.Psa?this.menuSection:xb.Jc()}Kfd(){this.VPh();this.xPh();const ab=this.zy.Wkc(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Xa.ob(ab?149:148))}aQh(){let ab=0;this.Btb?this.L4.xm(942362098)?ab=this.zy.xm(this.vl,942362098,this.selectedRanges,this.grid)?161:169:this.u_f&&
(ab=this.zy.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?177:181):this.L4.xm(-1113896058)&&(ab=this.oha?this.zy.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?49:116:this.zy.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==ab&&this.Mba.buttons.push(this.Xa.ob(ab))}$Ph(){let ab;!this.Btb&&this.L4.xm(-1113896058)&&(ab=this.oha?this.zy.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?295:296:this.zy.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?297:298,
this.Mba.buttons.push(this.Xa.ob(ab)))}WPh(){let ab=0;this.Btb?this.L4.xm(622604322)&&(ab=this.grid.rtl?this.zy.xm(this.vl,622604322,this.selectedRanges,this.grid)?191:192:this.zy.xm(this.vl,622604322,this.selectedRanges,this.grid)?162:170):this.L4.xm(1415868706)&&(ab=this.Psa?this.zy.xm(this.vl,1415868706,this.selectedRanges,this.grid)?50:117:this.zy.xm(this.vl,1415868706,this.selectedRanges,this.grid)?178:182);0!==ab&&this.Mba.buttons.push(this.Xa.ob(ab))}UPh(){this.L4.xm(1035996630)&&(this.zy.xm(this.vl,
1035996630,this.selectedRanges,this.grid)?(this.Mba.buttons.push(this.Xa.ob(this.grid.rtl?187:165)),this.Mba.buttons.push(this.Xa.ob(166))):(this.Mba.buttons.push(this.Xa.ob(this.grid.rtl?188:173)),this.Mba.buttons.push(this.Xa.ob(174))))}VPh(){const {GridContextMenu:ab}=a(1255);let wb=null;this.jGb&&(wb=this.Xa.mw("ContextMenu.InsertCells",null,C.a.instance.ga(345),1896159024),wb.menu.uc.push(this.Mba));ab.XPh(this.Mba,this.Xa,this.$);this.aQh();l.AFrameworkApplication.Qq("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");
H.a.Asd()&&this.$Ph();this.WPh();this.UPh();wb&&0<this.Mba.buttons.length&&this.menuSection.buttons.push(wb)}zPh(){let ab=0;this.Btb?this.L4.xm(1405456548)?ab=this.zy.xm(this.vl,1405456548,this.selectedRanges,this.grid)?163:171:this.u_f&&(ab=this.zy.xm(this.vl,1554436520,this.selectedRanges,this.grid)?179:183):this.L4.xm(1554436520)&&(ab=this.oha?this.zy.xm(this.vl,1554436520,this.selectedRanges,this.grid)?51:118:this.zy.xm(this.vl,1554436520,this.selectedRanges,this.grid)?179:183);0!==ab&&this.qua.buttons.push(this.Xa.ob(ab))}yPh(){let ab=
0;this.Btb?this.L4.xm(284490184)&&(ab=this.zy.xm(this.vl,284490184,this.selectedRanges,this.grid)?164:172):this.L4.xm(674605324)&&(ab=this.Psa?this.zy.xm(this.vl,674605324,this.selectedRanges,this.grid)?52:119:this.zy.xm(this.vl,674605324,this.selectedRanges,this.grid)?180:184);0!==ab&&this.qua.buttons.push(this.Xa.ob(ab))}wPh(){this.L4.xm(1035996630)&&(this.zy.xm(this.vl,1035996630,this.selectedRanges,this.grid)?(this.qua.buttons.push(this.Xa.ob(this.grid.rtl?189:167)),this.qua.buttons.push(this.Xa.ob(168))):
(this.qua.buttons.push(this.Xa.ob(this.grid.rtl?190:175)),this.qua.buttons.push(this.Xa.ob(176))))}xPh(){let ab=null;this.jGb&&(ab=this.Xa.mw("ContextMenu.DeleteCells",null,C.a.instance.ga(409),-1554384558),ab.menu.uc.push(this.qua));this.zPh();this.yPh();this.wPh();ab&&0<this.qua.buttons.length&&this.menuSection.buttons.push(ab)}}Object(r.a)(I,"CellsContextMenuGenerator",null,[]);var S=a(789);class P{constructor(ab){this.ranges=null;this.ranges=ab}}Object(r.a)(P,"MacroRecorderRangeHyperlinkRemovedPayload",
null,[123]);var D=a(532),G=a(24),E=a(106),O=a(73),N=a(81),J=a(44),W=a(198),ea=a(63),R=a(614),Y=a(151),U=a(38),da=a(462),T=a(564),ka=a(1),L=a(196),fa=a(21),wa=a(380),oa=a(35),xa=a(50),bb=a(217),Za=a(22),La=a(31),va=a(1104),Ba=a(933),Ea=a(132),pa=a(379),$a=a(291),cb=a(182),ib=a(164),ta=a(352),Ya=a(96),Da=a(29),ba=a(255),ya=a(290),V=a(133),Z=a(787),ja=a(788),la=a(118),ua=a(40),eb=a(58),Eb;(function(ab){ab[ab.none=0]="none";ab[ab.once=1]="once";ab[ab.twice=2]="twice"})(Eb||(Eb={}));Object(r.b)("ToggleState",
Eb);class Wb{constructor(ab,wb,xb,rb){this.m_c=this.sgb=this.ugb=0;this.$=ab;this.gridView=fa.h(this.$);this.namedSheetViewPublic=wb;this.Zg=xb;this.instantaneousSupportInformationManager=rb;this.Nxa=Z.a.Cqd()}Trh(){var ab=this.YU();ab={["CommandValueId"]:ua.c(ab)};const wb=new Ya.a(-2058042992,2,this.$.xc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ia.Hb(wb,ab)}jsh(){const ab=new Ya.a(644342024,2,this.$.xc,
19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ia.Hb(ab)}Yrh(){const ab=this.gridView.ha.ra.activeCell,wb=this.$.da.Ba(66).Xi,xb=this.$.da.Ba(66).kxb(ab);return wb||xb?this.$rh(wb,xb,ab):this.Zrh(ab)}$rh(ab,wb,xb){if(this.N6g(ab,wb,xb))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),eb.Task.Ta(!1);if(null!=
ab&&ab.hasAutoFilter||null!=wb&&wb.PHa.every(rb=>0!=rb.length))return this.ugb=Eb.none,this.l_c();this.ugb=Eb.once;return this.w9b(Eb.once)}Zrh(ab){var wb=J.v(this.gridView.ha.ra.xd,this.$);wb=this.gridView.$.ua.getItemByName(wb.SheetName);const xb=J.E(wb.ZW);if(this.M6g(xb,ab))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),eb.Task.Ta(!1);if(wb.hasAutoFilter){if(xb&&xb.contains(this.gridView.ha.ra.activeCell))return this.ugb=
Eb.none,this.l_c();this.ugb=Eb.twice;return this.w9b(Eb.twice)}this.ugb=Eb.once;return this.w9b(Eb.once)}w9b(ab){const wb=J.v(this.gridView.ha.ra.xd,this.$);if(!wb)return eb.Task.Ta(!1);this.sgb||(this.sgb=Date.now());const xb=new Ya.a(368460465,2,this.$.xc,19,null),rb=this.$.pa.va.$b(),za=()=>new va.a(wb),Aa=pb=>{ba.a(pb)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),
ab===Eb.twice?this.w9b(Eb.once):this.l_c())};return pa.a(this.$.userOperationManager,(pb,kb,Cb)=>$a.B(this.$.pa.va,wb,ya.b(pb,Aa),kb,Cb,null,rb),pb=>new W.a(516,0,pb,64,za),xb)}N6g(ab,wb,xb){return null!=ab&&cb.d(ab)&&xb.top===ab.usedRange.top||null!=wb&&wb.Kka&&xb.top===wb.top?(this.juc(this.$,223),!0):null!=ab&&cb.g(ab)&&xb.top===ab.usedRange.bottom?(this.juc(this.$,224),!0):!1}M6g(ab,wb){if(ab&&ab.contains(wb)&&wb.top===ab.top||!ab&&this.O5g(wb.top,wb.left))return this.juc(this.$,225),!0;if(ab&&
ab.contains(wb))return!1;ab=new G.Range(1<wb.top?wb.top-1:wb.top,1<wb.left?wb.left-1:wb.left,wb.top<x.a.xg?wb.top+1:wb.top,wb.left<x.a.wg?wb.left+1:wb.left,!1,!1);return this.gridView.tb.Fla(ab)?(this.juc(this.$,226),!0):!1}juc(ab,wb){wb=Da.a.hd(1,1,751,wb,0,147079615,"ContextMenuFilterByCellValueError");ka.EwaSettings.jy()?new ta.a(ab,wb):(ab=new ib.ErrorDialog(ab,wb),ab.initialize(),ab.fg())}l_c(){this.m_c=Date.now();const ab=this.A$h();if(!ab)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),
eb.Task.Ta(!1);const wb=this.YU(),xb={FirstRow:0};xb.FirstColumn=wb.Column;xb.SheetName=wb.SheetName;V.b(this.$).qd(Ea.a.cCf,this.El(),void 0,!0);const rb=this.L6b(wb,xb),za=pb=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.ugb,["ApplyFilterTime"]:this.m_c?Date.now()-this.m_c:-1,["ToggleAndApplyFilterTime"]:this.sgb?Date.now()-this.sgb:-1,["FilterByValueType"]:wb.AutoFilterType})}`);this.sgb&&(this.sgb=
0);if(Z.a.hOb(pb)){const kb=Z.a.jxb(pb);this.Nxa?Z.a.QAa(ja.a.filterByCellValue,kb.MessageIdName,la.a.fta,!0,Z.a.isSessionEndingError(kb.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${kb.MessageIdName}`)}ba.a(pb)?(pb=Da.a.qc(pb.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${pb}`)):(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),
V.b(this.$).qd(Ea.a.LFf,this.El(),void 0,!0),pb={},pb.FirstRow=this.RYh(),pb.FirstColumn=wb.Column,-1!==pb.FirstRow&&(pb=J.D(pb),this.OO(pb)))},Aa=new W.a(208,0,(pb,kb,Cb)=>ea.a(this.$.pa.va,rb,ab,ya.b(pb,za),kb,Cb,null,null),6,()=>new Ba.a(ab,rb));this.namedSheetViewPublic?this.namedSheetViewPublic.lTa().continueWith(pb=>{pb.result&&this.$.userOperationManager.Oc(Aa,null)}):this.$.userOperationManager.Oc(Aa,null);return eb.Task.Ta(!0)}OO(ab){H.a.Ela(this.$)&&U.TaskExtensions.za(xa.GetServiceTaskFactory.Pa(this.$.da,
430,431,1),wb=>{wb.result.Qea(ab);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.ka,3)}El(){return{["Location"]:"contextMenu"}}YU(){var ab=0,wb=this.gridView.ha.ra.activeCell;var xb=this.$.da.Ba(66).Xi;const rb=this.$.da.Ba(66).kxb(wb);if(xb){var za="Table";ab=xb.objectId}else rb?(za="Table",ab=rb.id):za="Sheet";xb=wb.left;wb={};wb.AutoFilterType=za;wb.Column=xb;wb.Id=ab;za={};this.$.Sj(za);za.FirstRow=
0;za.FirstColumn=wb.Column;ab=this.$.ea.isNamedObjectViewMode;wb.NamedObjectView=ab;wb.SheetName=ab?za.NamedObjectName:za.SheetName;wb.ItemListOptions=null;return wb}O5g(ab,wb){ab=G.Range.Hc(ab,wb);return this.gridView.Ca.Bha(ab,this.$.na.name)&&(ab=this.gridView.Ca.awa(ab))&&ab.autoFilterMenu?!0:!1}A$h(){var ab=null;const wb=this.gridView.Jb(this.gridView.ha.ra.activeCell);if(!wb)return null;const xb=wb.cell.MBc;let rb;({category:rb}=this.instantaneousSupportInformationManager.FCa(xb,!1));if(1===
wb.Nr.type)if(3===rb){if(!wb.cell.kPa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${rb}. NumFmt is null. `),null;ab=(wb.cell.kPa.Start+wb.cell.kPa.End).trim()}else if(!rb&&(Za.a.L1a(wb.Nr.value,"E")||Za.a.L1a(wb.originalText,"E"))){ab=this.Zg.x0e(wb.Nr.value,xb,1,Number.POSITIVE_INFINITY,wb.cell.Bia);if(!ab.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${rb}. Failed to acquire formatted value`),
null;ab=ab.RA}ab||(ab=wb.originalText);return La.a.PDe(ab)?["[Blanks]"]:["i"+ab.trim()]}RYh(){const ab=this.gridView.ha.ra.activeCell;var wb=this.$.da.Ba(66).Xi;const xb=this.$.da.Ba(66).kxb(ab);if(wb)return wb.usedRange.top;if(null!=xb)return xb.top;wb=this.$.ua.getItemByName(this.$.na.sheetName);return(wb=J.E(wb.ZW))&&wb.contains(ab)?wb.top:-1}L6b(ab,wb){const xb={};xb.Location=wb;xb.FieldId=ab.Id.toString();xb.DataSourceIndex=-1;xb.FilterType=ab.AutoFilterType;xb.AnchorType=0;xb.ChartId=null;xb.AnchorValue1=
-1;xb.AnchorValue2=-1;xb.Property=ab.RichProperty;return xb}}Object(r.a)(Wb,"GridContextMenuFilter",null,[]);var Ab=a(108),Jb=a(153),Gb=a(54),Nb=a(70);a.d(B,"GridContextMenu",function(){return Ja});class Ja extends n.a{constructor(ab,wb,xb,rb){super(ab,"PopulateGridContextMenu",1247109494,-2064931494,Ja.kbi,!0,!1,Ja.ZLb,wb,xb,!0,rb);this.jlc=this.expandCollapse=this.refresh=this.pZ=this.Nwa=this.NBa=!1;this.fKe=!0;this.grid=fa.h(ab);this.doc=!0;if(this.Eic=ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",
!1)){const za=Object(Nb.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Object(Ab.c)(Jb.a.resolve(Gb.z,{Wb:3})):xa.GetServiceTaskFactory.Pa(this.$.da,309,310,3);let Aa;Aa=ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(Ab.c)(Jb.a.resolve(Gb.r,{Wb:3})):xa.GetServiceTaskFactory.create(this.$.da,18,this.ka,3);U.TaskExtensions.za(U.TaskExtensions.Md([za,Aa],this.ka),()=>{this.$.da.hb(268,pb=>{this.V5a=new Wb(ab,za.result,Aa.result,pb)})},this.ka,
3)}}get Sw(){return"PopulateGridContextMenu"}get vB(){return y.a.tUf}dispose(){super.dispose();this.grid=null}Mc(ab,wb){ab=!this.Wtd(ab,wb);if(!ab)switch(wb){case -1977666927:ab=this.YJj();break;case 1549396389:ab=!this.Sqi();break;case -425234874:ab=this.bKj()}return ab}Wtd(ab,wb){const xb=this.grid.ha.ra.selectedRanges;return(new Y.a(this.$.ua)).xm(ab,wb,xb,this.grid)}executeCommand(ab,wb,xb){const rb=wb.command;ab=null;switch(rb){case -1396319072:if(wb=this.grid.Jb(null))b.a.instance.w2c(!0),e.EventHandlerManager.instance.Ved(),
Ja.q6i(wb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.ra.selectedRanges,wb);break;case 324156914:ab=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(xb);break;case -1977666927:null!=this.V5a?ab=this.V5a.Trh():this.gyd();break;case 1549396389:null!=this.V5a?ab=this.V5a.jsh():this.gyd();break;case 1803952894:null!=this.V5a?ab=this.V5a.Yrh():this.gyd();break;default:ab=L.a(rb)}return ab||U.TaskExtensions.sba()}Ac(ab,wb,xb){ab=!1;switch(wb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:ab=
!0;break;case 1441131127:ab=!!xb}return ab}gyd(){c.ULS.sendTraceTag(509645913,0,10,"GridContextMenu:ExecuteCommand() - GridContextMenuFilter is null")}TY(ab=!1){let wb=!1,xb=!1,rb=0;ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(rb=f.a.Yd());const za=this.Xa.Bq(this.menuId);var Aa=this.grid.ha.ra;const pb=Aa.eh,kb=pb&&Aa.xd.Fg,Cb=pb&&Aa.xd.isRow;Aa=Aa.selectedRanges;const ob=d.a.all(Aa,vb=>vb.Fg),qa=d.a.all(Aa,vb=>vb.isRow),ma=J.P(Aa),Ga=J.Q(Aa);this.mnf(kb,
Cb)?(wb=!0,this.DQh(za)):this.$.isEditMode?wa.a(this.$)?this.FQh(za,kb,Cb):(this.APh(za,!(Cb||kb||!this.jlc)),this.YPh(za,Aa,ab),this.NPh(za,ob,qa,ma,Ga),this.J1e(za,pb,kb,Cb),this.ZQh(za),this.o1e(za,kb,Cb),this.tQh(za,pb,kb,Cb,Aa),this.DPh(za),this.BPh(za,Aa),this.fQh(za),this.SQh(za,pb),ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.SPh(za)):(xb=!0,wa.a(this.$)?this.E1e(za):this.oRh(za,pb,kb,Cb,Aa));ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&
(ab=f.a.Yd()-rb,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${ab}, isPivotMenu: ${wb}, isViewMenu: ${xb}, firstTimeEntry: ${this.fKe}`));this.fKe=!1;return za}mLa(ab){const wb=[];if(wa.a(this.$))return wb;if(3===ab){ab=this.grid.ha.ra;const rb=ab.eh,za=rb&&ab.xd.Fg,Aa=rb&&ab.xd.isRow;let pb=!1;var xb=!1;let kb=!1;this.$.isMobileMode&&(xb=ab.selectedRanges,pb=J.P(xb),xb=J.Q(xb));if(rb){const Cb=fa.f(this.grid);Cb&&Cb.range.contains(ab.xd)&&this.xV(Cb)&&
(kb=!0)}this.$.isEditMode?this.mnf(za,Aa)?wb.push(...[z.a.lPf,z.a.nPf]):za||Aa?(wb.push(z.a.clipboard),Aa?wb.push(z.a.Xvj):za&&wb.push(z.a.i$g)):(wb.push(...[z.a.edit,z.a.clipboard]),kb?wb.push(z.a.hyperlink):wb.push(z.a.color),rb&&wb.push(z.a.fYg)):(wb.push(z.a.copy),kb&&wb.push(z.a.openHyperlink),!Aa||this.$.isMobileMode&&xb?!za||this.$.isMobileMode&&pb||wb.push(z.a.P$j):wb.push(z.a.Q$j));wb.push(z.a.cbi)}else 2===ab&&wb.push(z.a.TCe);return wb}mnf(ab,wb){return(this.NBa||this.Nwa||this.pZ||this.refresh||
this.expandCollapse)&&!(ab||wb)}showGridContextMenu(ab){this.expandCollapse=this.refresh=this.pZ=this.Nwa=this.NBa=!1;var wb=this.$,xb=da.a(wb).BLa(),rb=this.grid.ha.ra;const za=rb.eh;var Aa=za&&rb.xd.Fg;rb=za&&rb.xd.isRow;if(xb&&!Aa&&!rb){Aa=T.a(wb);if(null===Aa||void 0===Aa?0:Aa.gVd)this.NBa=Aa=E.f(wb.gg),this.Nwa=!Aa;Aa=wb.ic;this.pZ=xb.supportsBIExplore&&!!v.a(wb)&&Aa.G2(32768);Aa.allowInteractivity&&(wb=this.grid.Jb(null),(null===wb||void 0===wb?0:wb.cell)&&(wb.cell.l2c||wb.cell.yag)&&(this.expandCollapse=
!0),Aa.allowManualDataRefresh&&(this.refresh=!0))}wb=null;xb=1;Aa=Object(k.a)(h.a,ab.eventArgs);ab=Object(k.a)(A.a,ab.creationParams);rb=this.TVh();ab?(wb=ab.clientPoint,xb=ab.inputMethod):Aa&&1!==Aa.wb?(wb=new Sys.UI.Point(Aa.clientPoint.x,Aa.clientPoint.y),xb=Aa.wb):rb&&(wb=new Sys.UI.Point(rb.x+(this.$.isChromeRtl?0:rb.width),rb.y+rb.height));O.a.zb=xb;this.jlc=3===xb;ab=m.a.Pvb;this.eo(wb,!Aa||Aa.Ea.target.className!==ab,xb)}removeHyperlinksFromRange(ab,wb){if(!ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.$s(ab,!0)){var xb=J.r(ab,this.$),rb=this.$.pa.va.$b();this.$.userOperationManager.Oc(new W.a(125,0,(za,Aa,pb)=>{this.$.vy();return ea.b(this.$.pa.va,xb,"","",!0,!1,127,za,Aa,pb,null,rb)},void 0,()=>new P(xb)),wb);this.grid.Ng.mM(!1)}}TVh(){var ab=this.grid.Jb(null);if((null===ab||void 0===ab?0:ab.cell.ek)&&this.pmf(ab))return this.grid.getCellBounds(ab.cell);ab=this.grid.ha.ra.activeCell;return(ab=this.qbc(new G.Range(ab.top,ab.left,x.a.xg,ab.left,!1,!1),2,!0)||this.qbc(new G.Range(1,ab.left,
ab.top,ab.left,!1,!1),2,!1)||this.qbc(new G.Range(ab.top,ab.right,ab.top,x.a.wg,!1,!1),1,!0)||this.qbc(new G.Range(ab.top,1,ab.top,ab.right,!1,!1),1,!1)||null)&&ab.ek?this.grid.getCellBounds(ab):Sys.UI.DomElement.getBounds(this.grid.Iwa.mc)}pmf(ab){var wb=this.grid.rtl,xb=this.$.isChromeRtl;ab=ab.cell;var rb=fa.h(this.$).$J(ab);return rb?(rb=rb.topLeft,wb=rb.x+=wb===xb?ab.offsetWidth:0,xb=rb.y+=ab.offsetHeight,this.grid.view.visibleArea.contains(new t.a(wb,xb,0,0))):!1}qbc(ab,wb,xb){ab=this.grid.Qj("GridContextMenu.FindFirstCellInViewportArea",
ab,wb,xb);try{for(ab.$$rst();ab.$$mn();){const rb=ab.$$cu();if(rb&&this.pmf(rb))return rb.cell}}finally{ab&&ab.dispose()}return null}DQh(ab){const wb=this.Xa,xb=wb.Jc();this.refresh&&xb.buttons.push(wb.ob(100));this.pZ&&xb.buttons.push(wb.ob(99));this.NBa?xb.buttons.push(wb.ob(59)):this.Nwa&&xb.buttons.push(wb.ob(58));if(this.expandCollapse){let rb;rb=wb.mw("ContextMenu.PivotExpandCollapse",null,C.a.instance.ga(1167),589118293);const za=wb.Jc();za.buttons.push(wb.ob(243));za.buttons.push(wb.ob(244));
za.buttons.push(wb.ob(245));za.buttons.push(wb.ob(246));rb.menu.uc.push(za);rb&&0<za.buttons.length&&xb.buttons.push(rb)}ab.uc.push(xb)}J1e(ab,wb,xb,rb){if(wb&&!xb&&!rb){wb=this.Xa.Jc();this.Eic&&!this.$.wF&&this.Ofd(wb);this.Wfd(wb);this.cRh(wb);if(ka.EwaSettings.xa(417)&&fa.h(this.$).ha.ra.YM()&&fa.h(this.$).ha.ra.u5)switch(ka.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:wb.buttons.push(this.Xa.ob(237));break;case 2:wb.buttons.push(this.Xa.ob(238));
break;default:wb.buttons.push(this.Xa.ob(236))}ab.uc.push(wb)}}Wfd(ab){if(this.$.ic.allowSorting&&(!this.$.isMobileMode||(new Y.a(this.$.ua)).Td(2048))){var wb=this.Xa.Jc();wb.buttons.push(this.Xa.ob(223));wb.buttons.push(this.Xa.ob(224));wb.buttons.push(this.Xa.ob(292));wb.buttons.push(this.Xa.ob(293));wb.buttons.push(this.Xa.ob(294));this.$.isMobileMode||wb.buttons.push(this.Xa.ob(225));var xb=this.Xa.mw("ContextMenu.sort",null,C.a.instance.ga(227),-864298118);xb.menu.uc.push(wb);ab.buttons.push(xb)}}Ofd(ab){const wb=
this.Xa.mw("ContextMenu.filter",null,C.a.instance.ga(1970),2045563128),xb=this.Xa.Jc();var rb=this.v_h();const za=this.Xa.ob(234);za.label=rb;xb.buttons.push(za);xb.buttons.push(this.Xa.ob(235));rb=this.Xa.Jc();rb.buttons.push(this.Xa.ob(233));wb.menu.uc.push(xb);wb.menu.uc.push(rb);ab.buttons.push(wb)}cRh(ab){if(fa.h(this.$).ha.ra.YM()){const wb=this.Xa.Jc();wb.buttons.push(this.Xa.ob(232));wb.buttons.push(this.Xa.ob(285));wb.buttons.push(this.Xa.ob(286));this.SBe()&&ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableTableShareFromTableMenu",
!1)&&wb.buttons.push(this.Xa.ob(276));const xb=this.Xa.mw("ContextMenu.table",null,C.a.instance.ga(1969),-697806646);xb.menu.uc.push(wb);ab.buttons.push(xb)}}z1e(ab,wb,xb,rb,za){if(wb){const pb=J.L(za);var Aa=fa.f(this.grid);if(Aa&&!xb&&!rb){xb=new Y.a(this.$.ua);if(Aa.range.contains(pb)&&this.xV(Aa)){(wb=!Aa.ula&&!xb.Xh)&&this.$.isEditMode&&ab.buttons.push(this.Xa.ob(45));Aa.xba&&ab.buttons.push(this.Xa.ob(53));wb&&this.$.isEditMode&&ab.buttons.push(this.Xa.ob(47));return}!Aa.ula&&this.$.isEditMode&&
(Aa=xb.Td(128),ab.buttons.push(this.Xa.ob(Aa?46:121)))}}this.Ggj(za)&&ab.buttons.push(this.Xa.ob(48));wb&&this.SBe()&&(wb=J.L(za),this.Fgj(wb)?ab.buttons.push(this.Xa.ob(276)):wb.Fg||wb.isRow||ab.buttons.push(this.Xa.ob(275)))}Ggj(ab){for(const wb of ab){ab=this.grid.getRangeInformation(wb);for(let xb=0;xb<ab.length;xb++)if(Object(w.a)(D.HyperlinkRange,ab[xb])){const rb=this.grid.Jb(ab[xb]);if(rb&&this.xV(rb)&&!rb.ula)return!0}}return!1}Fgj(ab){if(fa.h(this.$).ha.ra.YM()){const wb=fa.h(this.$).tb.uh(ab);
if(wb&&wb.usedRange.equals(ab))return!0}return!1}SBe(){var ab=this.$.ua.na;return ab&&ab.ie&&(ab=ab.ie.uz||ab.ie.tK,!this.$.wF&&ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&S.g(this.$)&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&!ab)?!0:!1}o1e(ab,wb,xb){var rb,za;if(1===fa.h(this.$).ha.Oe&&!wb&&!xb){wb=wa.a(this.$);xb=this.Xa;var Aa=xb.Jc(),pb=this.$.da.Ba(65);(null===(rb=null===pb||void 0===pb?void 0:pb.Wm)||void 0===rb?0:rb.lF)&&!wb&&Aa.buttons.push(xb.ob(227));
pb&&pb.isCommentOperationEnabled(3)&&Aa.buttons.push(xb.ob(221));(null===(za=null===pb||void 0===pb?void 0:pb.Wm)||void 0===za?0:za.Tmd)&&!wb&&Aa.buttons.push(xb.ob(228));(null===pb||void 0===pb?0:pb.hasCommentAtActiveCell)?pb.yC.isResolved||Aa.buttons.push(xb.ob(159)):pb&&pb.hasCommentAtActiveCell||(pb&&pb.Wm&&pb.Wm.lF?wb||(Aa.buttons.push(xb.ob(229)),Aa.buttons.push(xb.ob(230))):(Aa.buttons.push(xb.ob(160)),wb||Aa.buttons.push(xb.ob(226))));ab.uc.push(Aa)}}ZQh(ab){if(ka.EwaSettings.xa(127)){const wb=
this.Xa,xb=wb.Jc();xb.buttons.push(wb.ob(250));ab.uc.push(xb)}}YPh(ab,wb,xb){if(!xb){xb=this.$.Ia.uH();var rb=new Y.a(this.$.ua),za=new R.a(xb,wb,this.grid);(new I(ab,this.$,this.Xa,xb,wb,this.grid,za,rb)).Kfd()}}NPh(ab,wb,xb,rb,za){const Aa=(new Y.a(this.$.ua)).Td(8),pb=this.Xa,kb=pb.Jc();wb&&kb.buttons.push(pb.ob(Aa?152:153));xb&&kb.buttons.push(pb.ob(Aa?150:151));wb&&(rb||kb.buttons.push(pb.ob(Aa?109:155)),kb.buttons.push(pb.ob(Aa?111:157)));xb&&(za||kb.buttons.push(pb.ob(Aa?108:154)),kb.buttons.push(pb.ob(Aa?
110:156)));ab.uc.push(kb)}APh(ab,wb){const xb=this.Xa,rb=xb.Jc();ab.uc.push(rb);wb&&rb.buttons.push(xb.ob(102));rb.buttons.push(xb.ob(42));rb.buttons.push(xb.ob(43));wb=this.AQh(xb);ab.uc.push(wb)}AQh(ab){const wb=ab.Jc();wb.title=C.a.instance.ga(1147);wb.zcg=!1;wb.ycg=!1;wb.Khg=!1;let xb=5;const rb=H.a.zvd(this.$);rb&&(xb=6);ab=ab.HC("PasteOptionsGallery",xb,"Size24by24",wb.title);wb.buttons.push(ab);ab.hu("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"Paste_24",
1,u.a.uDh);ab.hu("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1149,void 0,"PasteValues_24",1,u.a.zDh);ab.hu("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1150,void 0,"PasteFormulas_24",1,u.a.wDh);ab.hu("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1151,void 0,"PasteTranspose_24",1,u.a.yDh);ab.hu("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1152,void 0,
"PasteFormatting_24",1,u.a.vDh);rb&&ab.hu("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1153,void 0,"PasteLink_24",1,u.a.xDh);return wb}oRh(ab,wb,xb,rb,za){var Aa;const pb=this.Xa;var kb=pb.Jc();kb.buttons.push(pb.ob(43));ab.uc.push(kb);this.Eic&&!this.$.wF&&(kb=this.Xa.Jc(),this.Ofd(kb),ab.uc.push(kb));ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.ic.isMobileMode&&this.$.ea.ic.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||
(kb=this.Xa.Jc(),this.Wfd(kb),ab.uc.push(kb),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));kb=this.$.da.Ba(65);if(null===(Aa=null===kb||void 0===kb?void 0:kb.Wm)||void 0===Aa?0:Aa.lF)Aa=this.Xa.Jc(),Aa.buttons.push(pb.ob(229)),ab.uc.push(Aa);Aa=this.Xa.Jc();this.z1e(Aa,wb,xb,rb,za);ab.uc.push(Aa);l.AFrameworkApplication.isMobileMode&&!N.a(this.$.ya,29)&&(wb=pb.Jc(),
wb.buttons.push(pb.ob(272)),ab.uc.push(wb))}tQh(ab,wb,xb,rb,za){const Aa=this.Xa.Jc();H.a.csd(this.$)?this.HPh(Aa):this.uQh(Aa);this.z1e(Aa,wb,xb,rb,za);0<Aa.buttons.length&&ab.uc.push(Aa)}uQh(ab){ab.buttons.push(this.Xa.ob(135))}HPh(ab){ab.buttons.push(this.Xa.ob(300))}SPh(ab){const wb=this.Xa.Jc();wb.buttons.push(this.Xa.ob(185));ab.uc.push(wb)}SQh(ab,wb){ka.EwaSettings.xa(418)&&wb&&(wb=this.Xa.Jc(),wb.buttons.push(this.Xa.ob(262)),ab.uc.push(wb))}fQh(ab){var wb=this.grid.ha.ra.selectedRanges;if(wb&&
wb.length){var xb=!1;for(var rb=0;rb<wb.length;rb++)if(this.grid.tb.Sxa(wb[rb])){xb=!0;break}if(xb){xb=!1;for(rb=0;rb<wb.length;rb++){var za=this.grid.tb.P3h(wb[rb]);if(null!=za&&null!=za[0]){for(var Aa=0;Aa<za.length;Aa++)if(this.grid.tb.Sxa(za[Aa])){xb=!0;break}if(xb)break}}Aa=this.Xa;rb=Aa.Jc();za=Aa.Jc();var pb=1===wb.length&&(wb[0].isSingle||this.grid.tb.Uxa(wb[0])),kb=!1,Cb=!1,ob=!1,qa=!1;for(let ma=0;ma<wb.length&&!(kb&&ob&&Cb&&qa);ma++)!kb&&this.grid.tb.Tvi(wb[ma])&&(kb=!0),!ob&&this.grid.tb.emf(wb[ma],
!1)&&(ob=!0),!Cb&&this.grid.tb.ykc(wb[ma])&&(Cb=!0),!qa&&this.grid.tb.ijf(wb[ma])&&(qa=!0);ka.EwaSettings.xa(102)&&pb&&!this.grid.tb.aBb(wb[0])&&(qa?rb.buttons.push(Aa.ob(217)):rb.buttons.push(Aa.ob(216)));qa=kb;qa=!(new Y.a(this.$.ua)).Xh&&qa;ob&&!xb&&(ka.EwaSettings.xa(123)&&E.l(this.$.gg)&&(ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?za.buttons.push(Aa.ob(220)):za.buttons.push(Aa.ob(qa?220:271)),Cb&&za.buttons.push(Aa.ob(qa?218:269)),pb&&(this.grid.tb.ykc(wb[0])||
this.grid.tb.aBb(wb[0]))&&za.buttons.push(Aa.ob(qa?219:270))),za.buttons.push(Aa.ob(qa?215:268)));0<za.buttons.length&&(wb=Aa.mw(kb?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,C.a.instance.ga(1783),798637440),wb.menu.uc.push(za),rb.buttons.push(wb));0<rb.buttons.length&&ab.uc.push(rb)}}}BPh(ab,wb){this.grid.tb.tkf(wb)&&(wb=this.Xa.Jc(),this.grid.ha.ra.aca()?(wb.buttons.push(this.Xa.ob(241)),wb.buttons.push(this.Xa.ob(239))):wb.buttons.push(this.Xa.ob(240)),
ab.uc.push(wb))}xV(ab){return ab.cell.hasHyperlink}E1e(ab){this.GQh(ab);var wb=this.Xa.Jc();this.Wfd(wb);ab.uc.push(wb);this.Eic&&(wb=this.Xa.Jc(),this.Ofd(wb),ab.uc.push(wb))}FQh(ab,wb,xb){this.E1e(ab);this.o1e(ab,wb,xb)}GQh(ab){if(this.grid.ha.ra.eh&&!this.grid.jb.oj){var wb=this.Xa,xb=wb.Jc();oa.a(this.$).HVd()?xb.buttons.push(wb.ob(265)):xb.buttons.push(wb.ob(264));ab.uc.push(xb)}}static q6i(ab){const wb=ab.tLa(Ja.nod);wb&&wb.Ypd&Ja.nod&&ab.invoke(Ja.nod,null)}static XPh(ab,wb,xb){(xb=xb.da.Ba(254))?
(xb.Bjc()&&xb.yrf()&&ab.buttons.push(wb.ob(212)),xb.Bjc()&&xb.gmc()&&ab.buttons.push(wb.ob(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}YJj(){const ab=this.$.da.Ba(66).Xi,wb=this.grid.ha.ra.activeCell;return null!=ab&&!ab.hasActiveFilter||bb.c(this.$,wb)||!this.Tqi(wb)}Tqi(ab){const wb=ab.left;var xb=this.Kkd();if(null!=xb&&null!=xb.fbc&&xb.fbc.includes(wb-1))return!0;xb=this.skd();return null!=xb&&J.E(xb).contains(ab)&&
null!=xb.FilteredColumns&&xb.FilteredColumns.includes(wb-1)?!0:!1}Sqi(){var ab=this.$.da.Ba(66).Xi;const wb=this.Kkd();if(null!=ab)return ab.hasAutoFilter&&ab.hasActiveFilter;if(null!=wb)return null!=wb.fbc&&0<wb.fbc.length;ab=this.skd();return null!=ab&&J.E(ab).contains(this.grid.ha.ra.activeCell)&&null!=ab.FilteredColumns&&0<ab.FilteredColumns.length}Kkd(){const ab=this.$.da.Ba(66);ab.Qp(this.grid.ha.ra.activeCell);return ab.kxb(this.grid.ha.ra.activeCell)}skd(){return this.$.ua.getItemByName(this.$.na.sheetName).ZW}v_h(){var ab=
this.grid.ha.ra.activeCell,wb=0,xb=!1,rb=this.$.da.Ba(66),za=this.Kkd();rb=rb.Xi;null!=rb?(wb=rb.usedRange.top,xb=!0):null!=za?(wb=za.top,xb=!0):(za=this.skd(),null!=za&&J.E(za).contains(ab)&&(wb=za.FirstRow+1,xb=!0));return xb?(ab=ab.left,wb=G.Range.Hc(wb,ab),wb=this.grid.Jb(wb),xb="",null!=wb&&(xb=wb.text),this.k0g(xb,ab)):C.a.instance.ga(220)}k0g(ab,wb){null==ab||Za.a.ah(ab.trim())?ab=String.format(C.a.instance.nb(157),G.Range.sM(wb)):ab.length>Ja.$4d?(ab=ab.substring(0,Ja.$4d),ab=String.format(C.a.instance.nb(155),
ab)):ab=String.format(C.a.instance.nb(156),ab);return ab}bKj(){const ab=this.grid.ha.ra.selectedRanges;if(!ab||!ab.length)return!0;for(let wb=0;wb<ab.length;wb++)if(!this.grid.tb.Fla(ab[wb]))return!1;return!0}}Ja.ZLb="GridContextMenuRootName";Ja.kbi=y.a.OHe;Ja.nod=192;Ja.$4d=26;Object(r.a)(Ja,"GridContextMenu",n.a,[])},1261:function(r,B,a){r=a(0);var c=a(573),b=a(570),e=a(566),f=a(1032);class d{mjh(H,I){if(H&&!(1>H.length)&&I){var S=Object.assign(new e.a,{ExternalId:"msPresenceOuter",ControlList:[]});
this.Jgh(H,S.ControlList);I.push(S)}}Jgh(H,I){const S=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(I,S);I=Object.assign(new e.a,{Title:"",ControlList:[]});Array.add(S.Menu.MenuSectionList,I);this.Rih(H,I.ControlList)}Rih(H,I){for(let S=0;S<H.length;S++){const P=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",
S),Command:"336231556",DisplayName:H[S].userName,LabelText:H[S].userName,ImageBackColor:H[S].color,PersonaId:H[S].email,IsAnonymous:H[S].isAnonymous});Array.add(I,P)}}}Object(r.a)(d,"PresenceContextMenuSectionBuilder",null,[681]);var h=a(88),l=a(4),k=a(186),w=a(569),n=a(112),x=a(141),m=a(91),u=a(86),t=a(111),y=a(25);class v{constructor(H,I,S,P){this.d7d=this.p1=this.Vi=this.dE=this.t8=null;this.eZb=H;this.$Gg=P;this.eZb.QMa&&(this.Vi=new n.a(3,2,5E3,Object(h.a)(this,this.XXg,"authenticationCheckTask"),
2),l.AFrameworkApplication.ti.ig(this.Vi),this.Hg(I,S));this.eZb.epb(()=>{this.jCf()});this.eZb.IZa(()=>{this.kCf()})}get businessBar(){return this.p1||(this.p1=u.a.instance.og("CommonUI.IBusinessBar"))}get yAe(){return this.d7d||(this.d7d=u.a.instance.og("CommonUI.IBusinessBarEntryFactory"))}Hg(H,I){const S=l.AFrameworkApplication.rb;S.Je(y.a.authenticationLost,t.a.frame,H,96);S.Je(y.a.jye,t.a.frame,I,96);S.Qb(y.a.uCe,t.a.frame,k.ActionManager.q$c);S.Qb(y.a.vCe,t.a.frame,k.ActionManager.q$c);S.Qb(y.a.Wwd,
t.a.frame,k.ActionManager.q$c)}jCf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);l.AFrameworkApplication.rb.processAction(y.a.authenticationLost,2)}kCf(){this.jWj();l.AFrameworkApplication.rb.processAction(y.a.jye,2)}XXg(){this.eZb.authenticationCheck()}jWj(){this.dE&&(this.dE.hide(),this.dE.dispose(),this.dE=null);this.t8&&this.businessBar&&(l.AFrameworkApplication.ug||this.businessBar.removeEntry(this.t8),this.t8.dispose(),this.t8=null)}showDialog(H){m.a.Ja(this.dE);this.dE=new x.StandardDialog;
this.$Gg||(this.dE.yt=!1,this.dE.Rb=0);this.dE.wc(1,CommonUIStrings.l_SignIn);this.dE.jS(CommonUIStrings.l_DefaultDialogTitle,H,Object(h.a)(this,this.ru,"dialogHandler"))}ru(H){1===H?(w.a.K6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.rb.processAction(y.a.Wwd,2)):(this.SVd(),l.AFrameworkApplication.rb.processAction(y.a.vCe,2))}SVd(){this.businessBar&&this.yAe&&(this.t8=this.yAe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,
null),this.t8.closeable=!0,this.t8.addButton(CommonUIStrings.l_SignIn,v.q2g,""),this.t8.N$=Object(h.a)(this,this.t2g,"businessBarEntryCloseHandler"),this.businessBar.rE(this.t8,!1))}t2g(){this.Gqh();l.AFrameworkApplication.rb.processAction(y.a.uCe,2)}Gqh(){this.Vi&&(l.AFrameworkApplication.ti.$o(this.Vi),this.Vi=null)}dispose(){this.Vi=this.dE=this.t8=null}static q2g(){w.a.K6();l.AFrameworkApplication.rb.processAction(y.a.Wwd,2)}}Object(r.a)(v,"SignOutResponseUI",null,[3]);var A=a(257);class z{get name(){return"Common.App.UI"}Kh(H){H.register(d,
"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").tc()}init(){}dispose(){m.a.Ja(z.d2);z.d2=null}static main(){A.a.instance.si(new z)}}z.d2=null;Object(r.a)(z,"CommonAppUIPackage",null,[4,5]);a.d(B,"a",function(){return C});const C=()=>{Type.registerNamespace("CAUI");z.main()}},1262:function(r,B,a){var c=a(9);r=a(0);var b=a(240),e=a(228),f=a(50),d=a(38),h=a(15),l=a(91),k=a(4),w=a(84),n=a(8),x=a(24),m=a(71),u=a(44),t=a(151),y=a(49),v=a(45),A=a(12),
z=a(1),C=a(14),H=a(21),I=a(27),S=a(18),P=a(52);class D extends w.a{constructor(U,da,T,ka){super();this.isMac=I.a.isMac;this.qxa=!1;this.$=U;this.ariaLiveNotifier=ka;this.qo=T.e7b(U,null,da,S.a.GVe,P.a.Le(9),C.a.instance.ga(1740),"PulloutPointerDown")}Ilg(U){this.qxa!==U&&(this.hide(),(this.qxa=U)?this.qo.Cmg(S.a.AEh,P.a.Le(3)):this.qo.Cmg(S.a.GVe,P.a.Le(9)))}get kz(){return this.qo.kz}get buttonWidth(){return this.qo.buttonWidth}dispose(){this.qo.dispose();this.$=null;super.dispose()}domElement(U){return this.qo.domElement(U)}getButton(U){return this.qo.getButton(U,
!1)}mRb(U,da){this.qo.mRb(U,da,!1)}LBa(U,da){const T=H.h(this.$),ka=T.jb.Li(U);this.qo.mRb(this.qxa?C.a.instance.ga(1742):da?C.a.instance.ga(1740):C.a.instance.ga(1741),ka);da=this.isMac?da?C.a.instance.ga(1745):C.a.instance.ga(1746):da?C.a.instance.ga(1743):C.a.instance.ga(1744);var L=T.Eg(U,ka);U=T.Vf(ka).Dn;if(L&&0<=L.x&&0<=L.y){const fa=L.bottomRight.x+this.kz;L=L.topLeft.y-this.kz-this.buttonWidth;if(L<U.topLeft.y+this.kz){if(T.jb.wCa){this.hide();return}L=U.topLeft.y+this.kz}this.eo(fa,L,T.rtl,
ka);this.ariaLiveNotifier.wAa(da)}else this.hide()}eo(U,da,T,ka){this.qo.eo(U,da,T,ka,!1)}hide(){this.qo.hide()}}Object(r.a)(D,"PulloutLaunchButton",w.a,[]);var G=a(33),E=a(22);class O extends w.a{constructor(U,da,T,ka){super();this.DYa=this.pRc=this.hyc=this.CGa=this.XR=this.TO=null;this.eje=0;this.PEb=this.tBb=this.fIc=!1;this.gh=()=>{this.ixa&&(this.gridView?1===this.gridView.ha.Oe?(this.gridView.ha.ra.activeCell.equals(this.CGa)||this.lN||this.ey(),this.zqb.$p()):this.ey():h.ULS.shipAssertTag(537154141,
0,!1,"GridView is null during selection"))};this.Di=()=>{this.ey()};this.od=()=>{this.aX()};this.yc=()=>{this.ey()};this.jd=()=>{this.showCallout()};this.tza=()=>{if(this.Xg.Tk&&this.Xg.Tk.length)if(this.H1c)this.Xg.vFi||(this.fIc=this.Xg.Tk[0].BlockingDataForExpand),this.Xg.EYh&&h.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.eje=this.Xg.t8c&&this.Xg.T0e<this.Xg.t8c.left-1?this.Xg.t8c.left-1-this.Xg.T0e:-1,this.showCallout();else if(this.gridView.ha.ra.eh){var L=
this.gridView.ha.ra.activeCell;if(L&&this.XR){var fa=this.tableManager.Qp(L);this.ePc=!!fa;const wa=this.gridView.ha.ra.xd;fa=this.lN&&this.XR.vd(fa);const oa=this.Jld&&!this.lN&&wa.equals(this.selectedRange);fa||oa?(h.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.Xac=!0,z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.lN&&this.tableManager.qka(L)?h.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.lN?this.Eh.LBa(this.XR,this.lN):this.Eh.LBa(wa,this.lN):this.Eh.LBa(this.XR,this.lN),this.Nwc())):h.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.Ak=()=>{this.d8a()&&this.Eh.hide();1===this.gridView.ha.Oe&&this.aX()};this.yR=()=>{const L=this.gridView.ha.Oe;this.gridView.ha.ra.activeCell&&1===L&&this.aX()};this.Ht=()=>{if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.lN){if(this.XR&&
this.CGa){var L=this.tableManager.Qp(this.CGa);L&&1<L.bottom-L.top&&(--L.bottom,this.gridView.Yba(L)&&this.zqb.$p())}}else this.gridView.ha.ra.eh&&this.gridView.Yba(this.gridView.ha.ra.xd)&&this.zqb.$p();else this.XR&&this.CGa&&this.lN&&(L=this.tableManager.Qp(this.CGa))&&1<L.bottom-L.top&&(--L.bottom,this.gridView.Yba(L)&&this.zqb.$p())};this.aX=()=>{if(this.$&&this.gridView){if(this.Xac&&this.lN){const L=this.gridView.ha.ra.activeCell;this.XR=this.PZe();const fa=!!this.hyc&&this.hyc.contains(L);
if(this.XR&&(L.equals(this.CGa)||fa)){this.Eh.LBa(this.XR,this.lN);return}}this.Xac=!1;(this.XR=this.PZe())&&this.wma&&this.gridView&&this.gridView.Ca.ds(this.wma)?(this.H1c=!1,this.AZ()):(this.Xg.x2c(),this.Xg.Y3b());this.Xac||this.Eh.hide()}};this.$=U;this.tableManager=T;this.Eh=new D(U,this.jd,da,ka);this.Xg=da.$6c(U,T);this.Xac=this.H1c=!1;this.Jld=z.EwaSettings.xa(128);this.ePc=!0;this.UEa=!1;this.gridView=H.h(this.$);this.gridView.Xb.gl(this.Di);this.gridView.ev(this.yR);this.$.hl(this.od);
this.$.ij(this.yc);this.$.iC(this.Ak);this.gridView.view.Vs(this.Ht);this.gridView.ha.HT(this.gh);this.zqb=y.a.instance.create(this.aX,250,v.a.Zdj);h.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Xg.H0b(this.tza);G.a.uBb()&&(this.tBb=!0);this.aX();U.da.Ha(261,this)}get mc(){return this.Eh.domElement(1)}get wma(){return this.pRc}get selectedRange(){return this.DYa}get lN(){return this.ePc}get qxa(){return this.UEa}get zSf(){return this.eje}get jEb(){const U=this.Eh.domElement(this.Zea);
return U?A.DOMElementExtensions.isVisible(U):!1}get ixa(){return this.$.isEditMode&&z.EwaSettings.xa(128)?!(new t.a(this.$.ua)).Xh:!1}get USg(){return this.fIc}get Zea(){return this.wma?this.gridView.jb.Li(this.TO):1}dispose(){this.gridView&&(this.gridView.ha.PR(this.gh),this.gridView.view.Xq(this.Ht),this.gridView.Xb&&this.gridView.Xb.Zk(this.Di));if(this.$){const U=this.$;U.em(this.od);U.$k(this.yc);U.UF(this.Ak);H.h(U).ty(this.yR)}this.Xg&&this.Xg.Lvc(this.tza);l.a.Ja(this.Eh);this.Xg=this.$=this.gridView=
this.zqb=this.Eh=null;super.dispose()}ey(){this.Eh.hide()}Zda(){this.Eh?this.Eh.getButton(this.Zea).zdb():h.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}xtj(){this.XR=null}RRf(){this.Eh&&this.Eh.hide()}x$h(){if(!this.Jld||1!==this.selectedRange.width)return null;const U=this.selectedRange.clone();for(;this.gridView.Yba(U);){U.left+=1;U.right+=1;if(!this.gridView.Vf(this.gridView.jb.Li(U)).pi.xe(U))break;if(!this.gridView.Ca.ds(U))continue;const da=
this.gridView.Qj("PulloutManager.GetValidatedRangeToFill",U,2);try{if(O.G9j(da))return U}finally{da&&da.dispose()}}return null}Nwc(){this.Xg.Bdb()}showCallout(){this.ixa&&(this.Xg.I7a?(this.Eh.getButton(this.Zea).TIb(),d.TaskExtensions.za(f.GetServiceTaskFactory.Pa(this.$.da,8,9,0),U=>{U.result.Wgd("tableFieldList").J0(null,this.Eh.domElement(this.Zea),this.Xg,null,!0);this.Nwc()},this.$.ka,3)):(this.H1c=!0,this.AZ()))}PZe(){if(!this.ixa||!this.gridView||this.gridView.ha.Sa.jc||!this.gridView.ha.ra.eh)return null;
var U=this.gridView.ha.ra.activeCell,da=H.h(this.$).jb.Li(U);if(!U)return null;this.CGa=U.clone();var T=this.tableManager.Qp(U);this.ePc=!!T;if(this.lN){this.Eh.mRb(C.a.instance.ga(1740),da);this.TO=O.Xog(T);if(!this.TO)return null;U=!1;da=({zY:U}=this.tableManager.DIe(T,this.gridView)).returnValue||U;this.fIc=U;if(da)return this.hyc=new x.Range(T.top,T.left,T.bottom,T.right,!1,!1),this.pRc=new x.Range(this.TO.top,this.TO.right+1,this.TO.top,this.TO.right+1,!1,!1),this.tBb&&(this.UEa=!1,this.Eh.Ilg(this.UEa)),
this.TO}else if(this.Jld){this.DYa=this.gridView.ha.ra.xd.clone();T=this.selectedRange.isSingle&&H.h(this.$).tb.Ujf(this.selectedRange);const ka=H.h(this.$).tb.Sxa(this.selectedRange);this.tBb&&(this.UEa=T&&!ka);this.Eh.mRb(this.UEa?C.a.instance.ga(1742):C.a.instance.ga(1741),da);T&&!ka&&!this.PEb&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&E.a.equals(k.AFrameworkApplication.uiCulture,"en-us",!0)&&(k.AFrameworkApplication.Qq("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),
this.PEb=!0);this.TO=O.Xog(this.selectedRange);if(!(this.tBb&&T||ka)||!this.TO||!this.selectedRange||z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.qka(this.selectedRange))return null;this.pRc=this.x$h();if((z.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.Yba(this.selectedRange):this.gridView.Yba(this.TO))&&this.wma)return this.tBb&&this.Eh.Ilg(this.UEa),this.hyc=this.TO,h.ULS.sendTraceTag(537154137,
0,50,`PulloutManager:FindSelection, NextRange, ${this.wma?this.wma.toString():"null"}, RightColumnHeader, ${this.TO?this.TO.toString():"null"}, ActiveCell, ${U?U.toString():"null"}`),this.TO}return null}AZ(){this.lN?this.Xg.AZ(u.v(this.wma,this.$),!1,!0):this.UEa?this.Xg.T$i():z.EwaSettings.xa(128)&&this.Xg.AZ(u.v(this.selectedRange,this.$),!0,!1)}d8a(){return this.$.ea.isNamedObjectViewMode&&m.f(this.$.na)}static G9j(U){for(;U.$$mn();)if(U.$$cu().text||U.$$cu().NH||U.$$cu().oi||U.Qm.idf)return!1;
return!0}static Xog(U){return U.right===n.a.wg?null:new x.Range(U.top,U.right,U.top,U.right,!1,!1)}}Object(r.a)(O,"PulloutManager",w.a,[270,3]);var N=a(108),J=a(153),W=a(54),ea=a(70);class R extends e.a{constructor(U){super();this.$=U;this.Gb()}create(){c.a.Fa(U=>{const da=Object(ea.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(N.c)(J.a.resolve(W.L,{Wb:this.Na})):f.GetServiceTaskFactory.Pa(U.da,12,477,this.Na),T=f.GetServiceTaskFactory.Pa(U.da,66,134,this.Na),ka=f.GetServiceTaskFactory.Pa(U.da,
211,212,this.Na);let L=b.a.Ta(null);d.TaskExtensions.za(d.TaskExtensions.Md([da,T,L,ka],U.ka),()=>{this.qb(this.$.da.Ba(261)||new O(this.$,da.result,T.result,ka.result))},U.ka)})}static la(U){U.da.Ha(262,new R(U))}}Object(r.a)(R,"PulloutManagerFactory",e.a,[]);a.d(B,"a",function(){return Y});const Y=()=>{c.a.Fa(U=>{z.EwaSettings.xa(128)&&R.la(U)})}},1272:function(r,B,a){r=a(0);var c=a(197);class b{gVj(m,u){m.set_visible(!1);u.set_visible(!0)}}Object(r.a)(b,"DefaultTabSwitchBehaviour",null,[311]);
class e{}e.WVj="TabsContainer";e.DVj="TabTitlesContainer";e.BVj="TabTitle";e.CVj="TabTitleText";e.oZd="TabTitleActive";Object(r.a)(e,"MultitabControlStyles",null,[]);var f=a(88),d=a(47),h=a(90),l=a(92),k=a(57);class w{constructor(m,u,t){this.vk=m;this.Dp=u;this.OJc=t;this.Tfa=document.createElement("a");k.a.lzc(this.Tfa,this.Dp);Sys.UI.DomElement.addCssClass(this.Tfa,e.CVj);Sys.UI.DomElement.addCssClass(this.vk,e.BVj);this.vk.appendChild(this.Tfa);this.Tfa.tabIndex=0;this.OEc();d.a.addHandler(this.vk,
"click",this.OJc);d.a.addHandler(this.vk,"keyup",Object(f.a)(this,this.Gab,"onTitleKeyUp"))}get mc(){return this.vk}get title(){return this.Dp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.vk,e.oZd)}set isActive(m){this.setActive(m)}dispose(){d.a.removeHandler(this.vk,"keyup",Object(f.a)(this,this.Gab,"onTitleKeyUp"));d.a.removeHandler(this.vk,"click",this.OJc);this.vk=this.Tfa=null}setActive(m){m?Sys.UI.DomElement.addCssClass(this.vk,e.oZd):Sys.UI.DomElement.removeCssClass(this.vk,
e.oZd);this.Tfa&&this.Tfa.setAttribute(l.a.k$,m)}Gab(m){m.keyCode!==h.a.Sh&&m.keyCode!==h.a.cfa||this.OJc(m)}OEc(){this.vk.setAttribute(l.a.Jd,l.a.yq);this.Tfa.setAttribute(l.a.fv,this.Dp);this.Tfa.setAttribute(l.a.Jd,l.a.rqb)}}Object(r.a)(w,"TabTitleControl",null,[3]);var n=a(41);a.d(B,"a",function(){return x});class x{constructor(m,u=null,t=null){this.Pnb=this.Xnb=null;this.l1=-1;this.vk=m;this.Jga=u||new c.a;this.YHg=t||new b;this.fGa=new c.a;m=0;for(let y of this.Jga)this.rvd(this.l1)||(this.l1=
m),u=m++,this.fGa.add(new w(document.createElement("li"),y.title,this.vgh(u)))}get LCc(){return this.Jga.count}get activeTab(){return this.l1}set activeTab(m){this.$fg(m)}get mc(){return this.vk}get visible(){return n.a.isVisible(this.vk)}set visible(m){this.vk.style.visibility=m?"visible":"hidden"}PZf(){this.Xnb=document.createElement("ul");this.Xnb.className=e.DVj;this.Pnb=document.createElement("div");this.Pnb.className=e.WVj;for(let m=0;m<this.LCc;++m){const u=this.Jga.ma(m),t=this.fGa.ma(m);
u.set_visible(!1);t.isActive=!1;const y=document.createElement("div");u.render(y);this.Pnb.appendChild(y);this.Xnb.appendChild(t.mc)}this.mc.appendChild(this.Xnb);this.mc.appendChild(this.Pnb);this.rvd(this.l1)&&(this.fGa.ma(this.l1).isActive=!0,this.Jga.ma(this.l1).set_visible(!0))}dispose(){for(let m=0;m<this.LCc;++m)this.Jga.ma(m).dispose(),this.fGa.ma(m).dispose();this.fGa=this.Jga=this.vk=this.Pnb=this.Xnb=null}setFocus(){this.Jga.ma(this.l1).setFocus()}rvd(m){return 0<=m&&m<this.LCc}$fg(m){this.l1!==
m&&this.rvd(m)&&(this.YHg.gVj(this.Jga.ma(this.l1),this.Jga.ma(m)),this.fGa.ma(this.l1).isActive=!1,this.fGa.ma(m).isActive=!0,this.l1=m,this.setFocus())}vgh(m){return()=>{this.$fg(m)}}}Object(r.a)(x,"MultitabControl",null,[302,3])},1285:function(r,B,a){var c=a(9);r=a(0);var b=a(7),e=a(228),f=a(50),d=a(38),h=a(1);class l{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(r.a)(l,"FormulaAssistanceUIContext",null,[]);var k=a(108),w=a(153),n=a(54);class x extends e.a{constructor(u){super();
this.lyj="formulaAssistance";this.$=u;this.Gb()}create(){let u=this.$.da.Ba(448);if(u)this.qb(u);else{var t=h.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?k.c(w.a.resolve(n.m,{Wb:this.Na})):f.GetServiceTaskFactory.Pa(this.$.da,283,284,this.Na);d.TaskExtensions.za(t,()=>{d.TaskExtensions.za(k.c(t.result.Ll.loadScript(this.lyj)),()=>{u=this.$.da.Ba(448);if(!u){const y=Object(b.a)(new l,{isFeedbackAllowed:this.$.isFeedbackEnabled});u=this.$.da.Ha(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(y));
this.$.IDe(()=>{const v={};v.isFeedbackAllowed=this.$.isFeedbackEnabled;u.updateContext(v)})}this.qb(u)},this.$.ka,3)},this.$.ka,3)}}static la(u){u.da.Ha(449,new x(u))}}Object(r.a)(x,"FormulaAssistanceUIControlFactory",e.a,[]);a.d(B,"a",function(){return m});const m=()=>{c.a.Fa(u=>{x.la(u)})}},1286:function(r,B,a){var c=a(9);r=a(0);var b=a(58),e=a(228),f=a(50),d=a(38),h=a(21),l=a(15),k=a(34),w=a(216),n=a(24),x=a(71),m=a(1),u=a(1119),t=a(11),y=a(166),v=a(13),A=a(188),z=a(229),C=a(159),H=a(65),I=a(93),
S=a(151);class P{constructor(J,W,ea){this.oOa=1;this.D9=[];this.active=!1;this.htmlSanitizationHelper=null;this.onPointerDown=R=>{C.a.slim(R.Ea.rawEvent);return!1};this.Pw=()=>{const R=this.gridView.ald();if(!(0>=R||R===this.oOa||this.gridView.Jr)){var Y=!1,U=[],da=[];for(var T=this.D9.length-1;0<=T;T--){var ka=this.D9[T];if(this.$kd(ka)>R||ka.bottom<R)U.push(ka),this.D9.splice(T,1),Y=!0}for(T=this.tableManager.rangeList.length-1;0<=T;T--){ka=this.tableManager.rangeList[T];const L=this.$kd(ka);L<=
R&&ka.bottom>=R&&!(L<=this.oOa&&ka.bottom>=this.oOa)&&ka.Kka&&(da.push(ka),Y=!0)}if(Y){ka=this.gridView.tsc;for(let L of ka)for(let fa of L)for(let wa of fa)this.wjc?this.q7g(wa,U,da):this.r7g(wa,U,da,Y)}else l.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.oOa=R}};this.AGf=(R,Y)=>{Y.isRow||Y.nZc(this.Yfc)};this.BGf=(R,Y)=>{Y.isRow||(this.tableManager.rangeList.length||this.deactivate(),Y.aOd(this.Yfc))};this.Yfc=(R,Y)=>
{if(this.Td())this.activate();else if(R=this.active,this.deactivate(),!R){l.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Y=Y.gp)&&this.ndg(Y.y4,Y)};this.jJf=(R,Y)=>{!this.gridView.Jr&&(this.Td()?this.activate():(R=this.active,this.deactivate(),R||l.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Y=Y.gp)&&(R=u.a(Y.y4),this.ndg(R,Y)&&Y.hTd(R))};
this.Zd=()=>{this.gridView.jb.w4?this.deactivate():this.activate()};this.tableManager=J;this.gridView=W;this.$=W.$;this.htmlSanitizationHelper=ea;J.YYc(this.jJf);W.cQg(this.AGf);W.dQg(this.BGf);this.$.ua.Yf(this.Zd);this.$.Bb.Yf(this.Zd);this.Hwe(R=>{R.nZc(this.Yfc)});this.Td()&&(this.activate(),this.Pw(this,null));this.$.da.Ha(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.PNd(this.jJf),this.gridView.Goj(this.AGf),this.gridView.Hoj(this.BGf),this.$.ua.yg(this.Zd),this.$.Bb.yg(this.Zd),
this.Hwe(J=>{J.aOd(this.Yfc)}));this.gridView=this.tableManager=this.D9=null}get wjc(){return this.gridView.fD}DDc(J,W,ea){if(!x.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.jb.wCa)return W&&l.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const R=ea.P$e();var Y=R.length;if(R[Y-1]<J.left)return!1;var U=t.HelperMethods.Bx(new w.a(R),0,Y,J.left,t.HelperMethods.FF);if(0>U)return!1;
const da=J.k_d,T=J.qye;Y=Math.min(da.length+U,Y);let ka=0;if(!T)return l.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;U<Y;U++){const L=R[U];W?(ea.updateCellText(U,da[ka]),ea.updateCellAlignment(U,!0),ea.activateCellAutoFilter(U,T[ka]),this.Rqe(J,ka,L)):(ea.updateCellText(U,n.Range.sM(L)),ea.updateCellAlignment(U,!1),ea.deactivateCellAutoFilter(U),this.WPe(L));W&&ea.eEj();ka++}ea.an("HeaderSnappingFeature::toggleHeaderSnapping");
J.RBa=W;return!0}EDc(J,W,ea,R){if(!x.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.jb.wCa)return!0;if(!ea.length)return!1;var Y=R.length;if(R[Y-1]<J.left)return!1;var U=t.HelperMethods.Bx(new w.a(R),0,Y,J.left,t.HelperMethods.FF);if(0>U)return!1;const da=J.k_d,T=!!J.PHa&&0<J.PHa.length,ka=!!J.menuModel&&0<J.menuModel.length;for(let wa=U,oa=0,xa=Math.min(da.length+U,Y);wa<xa;wa++,oa++)if(Y=ea[wa]){var L=null;(U=Y.getElementsByClassName(k.a.ucd))&&(L=U[0]);if(L&&L.innerText){if(U=Y.getElementsByClassName(k.a.rue))for(var fa=
U.length-1;0<=fa;fa--)Y.removeChild(U[fa]);U=R[wa];W?(L.innerText=da[oa],Y.classList.add(k.a.aXe),T&&J.PHa[oa]&&(L=document.createElement("div"),m.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&m.EwaSettings.isChangeGateEnabled("OfficeVSO:7658740_ReduceInnerHTMLUsageForHeaderSnappingFeaturev2")&&this.htmlSanitizationHelper?(this.htmlSanitizationHelper.jh(L,J.PHa[oa]),fa=J.PHa[oa].split(H.a.GUg),3===fa.length?(fa=I.a.qf(fa[1]),this.eqe(L.firstChild,fa),y.a.instance.ta(v.a.uf,
L.firstChild,this.onPointerDown),A.a.instance.ta(v.a.rp,L.firstChild,this.onPointerDown)):(fa=new S.a(this.$.ua),(fa.Td(2048)||fa.Td(4096))&&l.ULS.sendTraceTag(509678873,0,10,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain click/pointer handlers for ShowAutoFilterMenu"),this.eqe(L.firstChild,null))):L.innerHTML=J.PHa[oa],ka&&J.menuModel[oa]&&this.Rqe(J,oa,U),Y.appendChild(L.firstChild))):(Y.classList.remove(k.a.aXe),L.textContent=n.Range.sM(U),this.WPe(U))}}J.RBa=W;return!0}eqe(J,
W){z.a.instance.ta(v.a.click,J,ea=>{W&&C.a.hrc(ea.Ea.rawEvent,966232027,W,this.$.get_id());return!0})}Rqe(J,W,ea){this.$.da.hb(8,R=>{R.ebc.oZi(J,W,ea)})}WPe(J){this.$.da.hb(8,W=>{W.ebc.pZi(J)})}r7g(J,W,ea,R){const Y=J.zt,U=u.a(J.y4);let da;for(let T=W.length-1;0<=T;T--)da=W[T],this.EDc(da,!1,U,Y)&&W.splice(T,1);for(W=ea.length-1;0<=W;W--)da=ea[W],this.EDc(da,!0,U,Y)&&this.D9.push(da);R&&J.hTd(U)}q7g(J,W,ea){if(J.r4g()){for(var R=W.length-1;0<=R;R--)this.DDc(W[R],!1,J)?(l.ULS.sendTraceTag(509166921,
0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),W.splice(R,1)):l.ULS.sendTraceTag(509166920,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation failed");for(W=ea.length-1;0<=W;W--)R=ea[W],this.DDc(R,!0,J)?(l.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.D9.push(R)):l.ULS.sendTraceTag(509166918,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation failed")}else l.ULS.sendTraceTag(509166922,
0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}ndg(J,W){const ea=this.wjc?W.P$e():W.zt;var R=ea[0];const Y=ea[ea.length-1],U=this.W9h(R,Y);let da=!1;for(let T=this.D9.length-1;0<=T;T--){const ka=this.D9[T];Y>=ka.left&&R<=ka.right&&(this.wjc?this.DDc(ka,!1,W):this.EDc(ka,!1,J,ea),this.D9.splice(T,1),da=!0)}for(let T=0,ka=U.length;T<ka;T++)if(R=U[T],this.wjc?this.DDc(R,!0,W):this.EDc(R,!0,J,ea))this.D9.push(U[T]),da=!0;return da}activate(){this.Td()&&!this.active&&
(this.gridView.view.Vs(this.Pw),this.active=!0)}deactivate(){this.active&&(this.gridView.view.Xq(this.Pw),this.active=!1)}Td(){return x.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.jb.XO&&0<this.tableManager.rangeList.length}Hwe(J){const W=this.gridView.tsc;for(let ea of W)for(let R of ea)for(let Y of R)J(Y)}W9h(J,W){const ea=[];if(!this.active)return ea;this.oOa=this.gridView.ald();for(let R=this.tableManager.rangeList.length-1;0<=R;R--){const Y=this.tableManager.rangeList[R];
Y.bottom>=this.oOa&&this.$kd(Y)<=this.oOa&&Y.left>=J&&Y.right<=W&&Y.Kka&&ea.push(Y)}return ea}$kd(J){const W=this.gridView.tb.uh(J);return W&&this.tableManager.jlf(J,W.usedRange.topLeft)?J.top+1:J.top}}Object(r.a)(P,"HeaderSnappingFeature",null,[3]);var D=a(108),G=a(153),E=a(54);class O extends e.a{constructor(J){super();this.$=J;this.Gb()}create(){const J=f.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Na);let W=b.Task.Ta(null);m.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
m.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")&&(W=m.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(D.c)(G.a.resolve(E.w,{Wb:this.Na})):f.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na));d.TaskExtensions.za(d.TaskExtensions.Md([W],this.ka),()=>{d.TaskExtensions.za(d.TaskExtensions.Md([J],this.ka),()=>{this.qb(this.$.da.Ba(68)||new P(J.result,h.h(this.$),W.result))},this.ka,11)},this.ka,
3)}static la(J){J.da.Ha(67,new O(J))}}Object(r.a)(O,"HeaderSnappingFactory",e.a,[]);a.d(B,"a",function(){return N});const N=()=>{c.a.Fa(O.la)}},1308:function(r,B,a){var c=a(9);r=a(0);var b=a(15),e=a(900),f=a(27),d=a(204),h=a(228),l=a(232),k=a(1),w=a(53),n=a(58),x=a(108),m=a(33),u=a(153),t=a(54);class y extends h.a{constructor(A){super();this.$=A;this.h7b=null;this.Gb()}create(){b.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");e.a.then(this.Zih(),A=>{this.qb(A)})}Zih(){if(this.h7b)return this.h7b;
const A=l.a.b2a(w.b(),d.a.none,"LoadResource","x10Scheduler loading");if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&f.a.Cw){const z=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ha(413,z);A.setResult(z);return this.h7b=A.task}(k.EwaSettings.OH()?z=>u.a.resolve(t.f,{Wb:this.Na}).then(C=>setTimeout(()=>z(C),0)):z=>this.$.da.hb(266,z))(()=>{this.REi(z=>{const C=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();z=x.b(n.Task.Ta(z.Ll));Promise.all([excelOnlineCalc.x10.ensureGroupAttached(z,
0),m.a.Hqb(this.$)?excelOnlineCalc.x10.ensureGroupAttached(z,2):0]).then(H=>H.some(I=>0<I)).then(H=>{this.$.da.Ha(413,C);A.setResult(C);k.EwaSettings.isChangeGateEnabled("OfficeVSO:7445021_LogAnyPluginInitialized")&&this.$.da.hb(491,I=>{I.dS.anyPluginInitialized=H})})})});return this.h7b=A.task}REi(A){k.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?void u.a.resolve(t.m,{Wb:this.Na}).then(z=>A(z)):this.$.da.hb(283,A)}static la(A){A.da.Ha(414,new y(A))}}Object(r.a)(y,
"PluginSchedulerFactory",h.a,[]);a.d(B,"a",function(){return v});const v=()=>{c.a.Fa(A=>{y.la(A)})}},1309:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(717),f=a(50),d=a(38),h=a(153),l=a(1),k=a(54);class w extends b.a{constructor(x){super();this.$=x;this.Gb()}static la(x){x.da.Ha(521,new w(x))}create(){const x=()=>excelOnlineCalc.FormulaAuthoringHelperSingletonGlobal.instance();l.EwaSettings.OH()?void h.a.resolve(k.p).then(()=>{this.qb(x())}):d.TaskExtensions.za(f.GetServiceTaskFactory.Pa(this.$.da,
266,265,0),()=>{this.qb(Object(e.a)(this.$.da,520,x))},this.$.ka,3)}}Object(r.a)(w,"FormulaAuthoringHelperFactory",b.a,[]);a.d(B,"a",function(){return n});const n=()=>{c.a.Fa(x=>{w.la(x)})}},1472:function(r,B,a){a.r(B);var c={};a.r(c);a.d(c,"AutoSumCommandHandler",function(){return W});var b={};a.r(b);var e=a(1109),f=a(0),d=a(714),h=a(155),l=a(15),k=a(189),w=a(63);const n=(ic,Gc,jd,ed,Qd,te)=>{if(Gc){const xe=ic.textBox;ic.eb||ic.startEdit(Gc,!0);ic.Ctd=!0;ic.text=jd;xe.caretPosition=Qd;Qd<te&&(ed&&
ic.TBa(),xe.selectRange(0,te+1),xe.selectRange(Qd,te))}};var x=a(73);class m{constructor(ic,Gc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=ic;this.type=Gc}H5a(){return this.sharedSheetRange}}Object(f.a)(m,"MacroRecorderAutoSumPayload",null,[123]);var u=a(44),t=a(379),y=a(198),v=a(50),A=a(38),z=a(164),C=a(352),H=a(29),I=a(1),S=a(196),P=a(290),D=a(21),G=a(134),E=a(572),O=a(58),N=a(54),J=a(153);let W=class extends k.a{constructor(ic){super();this.SSi=Gc=>{const jd=D.h(this.$);if(Gc=
Gc.Result){let ed=u.E(Gc.NewSelection),Qd=u.E(Gc.NewActiveCell);if(ed&&Qd)if(!Gc.Committed&&Gc.AutoSumFormula){const te=jd.Jb(Qd);te&&(jd.ha.updateSelection(ed,Qd,60),ed=Qd=u.E(Gc.MarkedArea),jd.$E=2,n(jd.oc,te,Gc.AutoSumFormula,!!ed,Gc.FormulaMarkStart,Gc.FormulaMarkEnd),ed&&Qd&&jd.ha.updateSelection(ed,Qd,0),jd.oc.Ctd=!1,A.TaskExtensions.za(v.GetServiceTaskFactory.create(this.$.da,153,this.ka,0),xe=>{xe.result.VJa(null)},this.ka,3))}else jd.ha.updateSelection(ed,Qd,60)}};this.$=ic}Mc(){return!1}executeCommand(ic,
Gc,jd){ic=Gc.command;switch(ic){case 1220954656:case 505713221:Gc=this.ZOe(0,Gc);break;case -1537138325:Gc=this.ZOe(parseInt(jd[x.a.Pc].toString(),10),Gc);break;default:Gc=S.a(ic)}return Gc}Ac(ic,Gc){if(ic=1===ic)switch(Gc.command){case 1220954656:case 505713221:case -1537138325:break;default:ic=!1}return ic}Rc(){return!1}ZOe(ic,Gc){const jd=D.h(this.$);jd.Ng.mM(!1);if(!D.h(this.$).ha.ra.eh)return Gc=D.h(this.$).ha.ra.nD,l.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${ic} due to discontinuous selection. Number of selected ranges is ${Gc}`),
this.aAa(),O.Task.Ta(!1);const ed=jd.kF();if(!ed)return null;const Qd=u.v(jd.ha.ra.xd,this.$),te=u.o(jd.ha.ra.activeCell,this.$),xe=u.o(ed,this.$),He=this.$.pa.va.$b(),We=()=>new m(Qd,ic);return this.$.$s(jd.ha.ra.selectedRanges,!0)?t.a(this.$.userOperationManager,(ye,$e,jf)=>{var gf=this.$.pa.va;ye=P.b(ye,this.SSi);const rf=gf.Oa(9,He);rf.selectedRange=Qd;rf.activeCell=te;rf.autoSumType=ic;rf.topLeftCell=xe;return w.g(gf,"AutoSum",rf,ye,$e,jf,ic,0)},ye=>new y.a(502,0,ye,64,We),Gc):O.Task.Ta(!1)}aAa(){E.a(G.a.discontinuousSelectionBlocking,
["OtherICE"],!0,!0,!1,!1,null);var ic=H.a.hd(1,1,751,2192,0,371863010,"DiscontinuousSelectionBlocking");I.EwaSettings.jy()?new C.a(this.$,ic):(ic=new z.ErrorDialog(this.$,ic),ic.initialize(),ic.fg())}};W=Object(h.b)([Object(J.d)(N.d),Object(h.c)(0,Object(N.o)())],W);Object(f.a)(W,"AutoSumCommandHandler",k.a,[222]);class ea extends d.a{constructor(ic){super(ic)}ld(){this.fd([new W(this.$)])}static la(ic){d.a.Rd(96,new ea(ic))}}Object(f.a)(ea,"AutoSumCommandHandlerFactory",d.a,[]);var R=a(9);String(c);
window.___1678693002876_closurehack=c;var Y=a(178),U=a(274),da=a(39),T=a(328),ka=a(1110),L=a(255),fa=a(68);class wa extends da.a{constructor(ic,Gc,jd){super();this.cUi=(ed,Qd)=>{if(!L.a(ed)&&Qd){const te=!!ed&&!!ed.RequestTelemetryData;D.h(this.$).Dh.kma(Qd.toString(),ed.StateId,te?ed.RequestTelemetryData.EcsOperationDuration:0,te?ed.RequestTelemetryData.EcsRequestDuration:0,te?ed.RequestTelemetryData.WfeRequestDuration:0)}};this.$=ic;this.tableManager=Gc;this.Zg=jd}$re(ic){this.addHandler("ekcvc",
ic)}nNd(ic){this.removeHandler("ekcvc",ic)}Mc(){return!1}executeCommand(ic,Gc){ic=Gc.command;switch(ic){case -730106152:Gc=this.Tld(Gc,3);break;case -1228228458:Gc=this.Tld(Gc,4);break;case -848953656:case 2045211913:if(this.Hwi()){Gc=O.Task.Ta(!0);break}Gc=this.Tld(Gc,1);break;default:Gc=S.a(ic)}return Gc}Ac(ic,Gc){if(ic=1===ic)switch(Gc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:ic=!1}return ic}Rc(){return!1}Tld(ic,Gc){const jd=D.h(this.$),ed=jd.ha.ra.selectedRanges,
Qd=ic.command,te=Y.a.create().toString();if(!this.$.$s(ed,!0)&&-730106152!==Qd)return O.Task.Ta(!0);const xe=u.r(ed,this.$);this.mOj(Qd,jd,ed,te);I.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.jfj();const He=this.$.pa.va.$b({ima:!0,$ka:1}),We=()=>new ka.a(Gc,xe);return t.a(this.$.userOperationManager,(ye,$e,jf)=>{this.$.vy();return w.d(this.$.pa.va,Gc,xe,!1,P.b(ye,this.cUi),$e,jf,te,He)},ye=>new y.a(508,0,ye,67,We),ic)}mOj(ic,Gc,jd,ed){if(-848953656!==
ic&&2045211913!==ic&&-730106152!==ic&&-1228228458!==ic)l.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${ic}.`);else if(!U.a.any(jd,te=>0<Gc.getRangeInformation(te).length)){var Qd=U.a.any(jd,te=>this.tableManager.Oud(te));if(-730106152!==ic&&-1228228458!==ic||!Qd)this.lSj(Gc,ic,ed,jd),-730106152!==ic&&-1228228458!==ic||this.Zg.vea(Gc,-730106152,{}),-1228228458!==ic&&2045211913!==ic&&-848953656!==ic||this.Zg.E8g(jd,ed),Gc.Dh.lS(ed,fa.BasicTelemetryCalculator.WQ)}}lSj(ic,
Gc,jd,ed){let Qd="";switch(Gc){case -1228228458:Qd="ClearAll";break;case 2045211913:case -848953656:Qd="ClearContent";break;case -730106152:Qd="ClearFormat";break;default:l.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${Gc}.`)}Gc=ed.length;ed=u.b(ed);ic.Dh.M0(15,jd,Qd+(", ranges to clear: "+Gc+", cells to clear: "+ed))}jfj(){this.raiseEvent("ekcvc",new T.a)}Hwi(){if(D.h(this.$).pz){const ic=this.$.da.Ba(296);return!!ic&&ic.BU.dB}return!1}}
Object(f.a)(wa,"ClearCommandHandler",da.a,[222,669]);var oa=a(108);class xa extends d.a{constructor(ic){super(ic)}ld(){const ic=v.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Na);let Gc;Gc=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(oa.c)(J.a.resolve(N.r,{Wb:this.Na})):v.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Na);A.TaskExtensions.za(A.TaskExtensions.Md([ic,Gc],this.ka),()=>{const jd=new wa(this.$,ic.result,Gc.result);
this.fd([jd]);this.$.da.Ha(313,jd)},this.ka,3)}static la(ic){d.a.Rd(101,new xa(ic))}}Object(f.a)(xa,"ClearCommandHandlerFactory",d.a,[]);var bb=a(1261),Za=a(1111),La=a(1173),va=a(1113),Ba=a(1114),Ea=a(1186),pa=a(91),$a=a(228),cb=a(4),ib=a(111),ta=a(47),Ya=a(11),Da=a(88),ba=a(156);class ya{}ya.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(f.a)(ya,"FileUploadDialogHTML",null,[]);var V=a(163),Z=a(25);class ja extends ba.a{constructor(ic){super(!1,!1,ja.Su);this.uzd=!1;this.ywf=!0;this.Hvf=0;this.Rb=1;this.wc(1,CommonUIStrings.l_Send);this.wc(0,CommonUIStrings.l_NoThanks);this.qg=ya.HTML;this.Avf=ic;this.we=ja.S2g}vj(ic,Gc,jd,ed=!1,Qd=!0){this.uzd=ed;this.wNj(Gc);this.Hvf=ic;Qd&&cb.AFrameworkApplication.XF(ic)}wNj(ic){if(ja.Su)this.dPj(ic);else{var Gc={};Gc[ja.O2g]=ic;Gc[ja.U2g]=CommonUIStrings.l_SendFileErrorReportMessage;Gc[ja.V2g]=
CommonUIStrings.l_SendFileErrorReportTextCaption;Gc[ja.T1c]="";Gc[ja.R2g]=CommonUIStrings.l_UserReportLinkText;Gc[ja.E3b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Da.a)(this,this.UDi,"legacyDialogHandler"),Gc);this.VW(ja.$2g)}}dPj(ic){ic={["id"]:this.we,["bodyControls"]:{["reportErrorCheckboxProps"]:this.uzd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.ywf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:cb.AFrameworkApplication.privacyUrl,["target"]:"_blank"}}},["errorMessage"]:ic,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Da.a)(this,this.TKd,"reactDialogHandler"),ic)}kab(){if(!ja.Su){var ic=document.getElementById(ja.X2g);ic&&(ic.className=ja.W2g,ic.appendChild(V.createClusteredImage(32,32,ja.T2g,null,!0,CommonUIStrings.l_DialogError)));
if(ic=document.getElementById(ja.Y2g))ic.innerText=CommonUIStrings.l_PrivacyStatement,ic.href=cb.AFrameworkApplication.privacyUrl,ta.a.addHandler(ic,"click",Object(Da.a)(this,this.y1i,"onPrivacyClickHandler"));this.ywf||(ic=document.getElementById(ja.T1c))&&ic.parentNode&&ic.parentNode.removeChild(ic);this.uzd||(ic=document.getElementById(ja.Q2g))&&ic.parentNode&&ic.parentNode.removeChild(ic)}}LD(){ja.Su||(super.LD(),document.getElementById(this.Oh("WACDialogPanel")).style.width=String.format("{0}px",
400))}UDi(ic,Gc){const jd=Gc[ja.T1c]||"";let ed=!0;void 0!==Gc[ja.E3b]&&null!==Gc[ja.E3b]&&(ed=Gc[ja.E3b]);this.ru(ic,jd,ed)}TKd(ic,Gc){this.ru(ic,Gc.text||"",Gc.reportErrorChecked)}ru(ic,Gc,jd){this.Avf&&(jd&&l.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Hvf),this.Avf(ic,Gc,jd))}y1i(ic){cb.AFrameworkApplication.rb.$d(Z.a.wJb,2,ic)}get DY(){return!1}static get Su(){return cb.AFrameworkApplication.sa.Qa.Fv&&cb.AFrameworkApplication.sa.Qa.kxi}}ja.O2g="WACDialogErrorMessage";
ja.U2g="WACDialogErrorReportMessage";ja.V2g="WACDialogErrorTextPrompt";ja.T1c="WACDialogInput";ja.Y2g="WACDialogPrivacyText";ja.X2g="WACDialogIconPanel";ja.T2g="CancelRequest_32x32x32";ja.W2g="WACDialogIcon";ja.$2g="WACDialogTextPanel";ja.E3b="WACDialogSendFileCheckbox";ja.Q2g="WACDialogSendFileCheckboxContainer";ja.R2g="WACDialogSendFileCheckboxText";ja.S2g="FileUploadErrorDialog";Object(f.a)(ja,"FileUploadErrorDialog",ba.a,[]);class la extends da.a{constructor(ic){super();this.iRf=0;this.jH=null;
this.Kmj=Gc=>{this.$nj(Gc)};this.V9g=(Gc,jd)=>{if(1===Gc&&this.jH.FileCollectionErrorStateId){Gc=this.$.pa.va;var ed=this.jH.MessageId,Qd=this.jH.OriginalEcsServerId,te=this.jH.FileCollectionErrorStateId;const xe=Gc.Oa(0);xe.errorMessageId=ed;xe.ecsServerId=Qd;xe.fileCollectionErrorStateId=te;xe.userComment=jd;Gc.i2c("CollectFile",xe,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=ic}pPg(ic){this.addHandler("fileCollectionComplete",ic)}$nj(ic){this.removeHandler("fileCollectionComplete",
ic)}U9g(ic,Gc,jd){this.iRf=Gc;this.jH=ic;this.pPg(jd);cb.AFrameworkApplication.privacyUrl=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;ic=new ja(this.V9g);cb.AFrameworkApplication.rb.Qb(Z.a.wJb,ib.a.frame,la.Ncj);ic.vj(0,"",null,!1,!1)}static Ncj(ic,Gc,jd,ed,Qd){ta.a.nu(Qd);cb.AFrameworkApplication.privacyUrl&&Ya.HelperMethods.nf(cb.AFrameworkApplication.privacyUrl,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(f.a)(la,"FileCollectionOperation",da.a,[671,3]);class ua extends $a.a{constructor(ic){super();
this.MUb=null;this.$=ic;this.Gb()}get tJh(){return this.MUb||(this.MUb=new la(this.$))}create(){A.TaskExtensions.za(v.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na),()=>{this.qb(this.tJh)},this.ka,3)}dispose(){pa.a.Ja(this.MUb);this.MUb=null;super.dispose()}static la(ic){ic.da.Ha(125,new ua(ic))}}Object(f.a)(ua,"FileCollectionCommandHandlerFactory",$a.a,[]);var eb=a(1189),Eb=a(1117),Wb=a(1285),Ab=a(7),Jb=a(658);class Gb{}Object(f.a)(Gb,"FreezePanesCommandParameters",null,[]);var Nb=a(8),
Ja=a(195),ab=a(24),wb=a(395),xb=a(28),rb=a(279),za=a(281),Aa=a(120);const pb=(ic,Gc,jd,ed,Qd,te,xe=null)=>{xe=ic.Oa(9,xe);xe.freezeSettings=Gc;return w.g(ic,"FreezeOrUnfreezePanes",xe,jd,ed,Qd,te,0)};class kb{constructor(ic){this.freezeOptions=null;this.freezeOptions=ic}getSheetName(){return this.freezeOptions.SheetName}}Object(f.a)(kb,"MacroRecorderSheetPaneFrozenPayload",null,[123]);var Cb=a(46);class ob{constructor(ic,Gc){this.ecc=this.UJd=null;this.DFf=()=>{I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.Pwc();if(this.ecc){const jd=rb.a(xb.a.Ya.ze,this.ecc);l.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${jd}`);this.ecc=null}this.rNf()};this.$=ic;this.gridView=D.h(ic);this.iD=Gc.Mtb(this.$.domElement,500,null,null);this.VLa=this.ULa=-1}Mc(ic,Gc){let jd=!1;switch(Gc){case 1844679312:jd=1!==ic&&!this.gridView.jb.w4}return jd}executeCommand(ic,Gc){ic=this.gridView.jb;const jd=this.gridView.pld();
cb.AFrameworkApplication.sa.Qa.Ew&&this.$.f_&&(1844679312===Gc.command||340334732===Gc.command||-806625837===Gc.command)&&Jb.ShyRibbon.yJ(1,2);switch(Gc.command){case 1844679312:return this.setFreezePanes(Gc,jd,ic.oj);case 340334732:return ic.xbc?O.Task.Ta(!1):this.VDj(Gc,jd);case -806625837:return ic.wCa?O.Task.Ta(!1):this.WDj(Gc,jd)}return O.Task.Ta(!1)}Ac(ic,Gc){ic=!1;switch(Gc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:ic=!0}return ic}Rc(){return!1}setFreezePanes(ic,
Gc,jd){if(jd)return this.zyc(ic,!1,0,0,0,0,Gc,null);var ed=this.gridView.ha.ra;jd=ed.activeCell.clone();ed=ed.activeRange;ed.Fg&&(l.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${jd.top}) and firstUnfreezeCell.Bottom (${jd.bottom}) to equal topLeftRange.Top (${Gc.top})`),jd.top=jd.bottom=Gc.top);ed.isRow&&(l.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${jd.left}) and firstUnfreezeCell.Right (${jd.right}) to equal topLeftRange.Left (${Gc.left})`),
jd.left=jd.right=Gc.left);jd.top===Gc.top&&jd.left===Gc.left&&(jd=ab.Range.Hc(jd.top+1,jd.left));ed=jd.top-1;const Qd=jd.left-1,te=ed-(Gc.top-1),xe=Qd-(Gc.left-1);return this.V9j(jd,te,xe)?this.zyc(ic,!0,ed,Qd,te,xe,Gc,jd):(this.$.tf(),this.rNf(),O.Task.Ta(!0))}VDj(ic,Gc){return this.zyc(ic,!0,0,Gc.left,0,1,Gc,null)}WDj(ic,Gc){return this.zyc(ic,!0,Gc.top,0,1,0,Gc,null)}V9j(ic,Gc,jd){const ed=this.gridView.Eg(ic),Qd=this.gridView.view.visibleArea;return!ed||Qd.topLeft.y>ed.bottomRight.y||Qd.topLeft.x>
ed.bottomRight.x||Qd.bottomRight.y<ed.bottomRight.y||Qd.bottomRight.x<ed.bottomRight.x?(l.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${ic}, rangeViewportArea=${ed?ed.toString():"null"}, visibleArea=${Qd.toString()}`),ic=H.a.hd(1,0,26,1491,0,2105967339,"FreezePaneSelectionNotInViewErr"),I.EwaSettings.jy()?new C.a(this.$,ic):(ic=new z.ErrorDialog(this.$,ic),ic.initialize(),ic.fg()),!1):0>=
Gc&&0>=jd?(l.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),ic=D.h(this.$).rtl?1493:1492,Gc=D.h(this.$).rtl?-2131054257:-1953454131,ic=H.a.hd(1,0,26,ic,0,Gc,"FreezePaneA1SelectedErr"),I.EwaSettings.jy()?new C.a(this.$,ic):(ic=new z.ErrorDialog(this.$,ic),ic.initialize(),ic.fg()),!1):!0}zyc(ic,Gc,jd,ed,Qd,te,xe,He){this.UJd=Cb.a(this.$).L9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.BT(this.DFf);this.iD.JTa();
this.gridView.OSj(Gc?"":"UnsetFreezePane");this.wGj(ic,Gc,this.gridView.jb);const We=Object(Ab.a)(new Gb,{SheetName:this.$.na.name,Freeze:Gc,FrozenRows:Qd,FrozenColumns:te,FirstRow:jd,FirstColumn:ed});l.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${Gc}, FrozenRows=${Qd}, FrozenColumns=${te}, FirstRow=${jd}, FirstColumn=${ed} `);const ye=()=>new kb(We);this.ecc=xb.a.Ya.ze;return t.a(this.$.userOperationManager,($e,jf,gf)=>{if(I.EwaSettings.xa(59)){var rf=
window.performance;rf.clearMarks();rf.mark("FreezePanes request sent")}(rf=this.gridView.Ep)?(rf=this.gxh(We,rf,xe,He),this.m_j(rf)):this.$.vy();return pb(this.$.pa.va,We,$e,jf,gf,Gc)},$e=>new y.a(151,0,$e,void 0,ye),ic)}gxh(ic,Gc,jd,ed){l.ULS.shipAssertTag(537159580,1,!!Gc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!ic.Freeze)return null;const Qd=za.a();Qd.State=1;Qd.IsEstimated=!0;let te=!1,xe=!1;const He=Gc.AQ(ab.Range.Hc(jd.top,jd.left));
let We=ic.FrozenRows;var ye=ic.FrozenColumns;1!==ic.FrozenRows||ic.FrozenColumns?ic.FrozenRows||1!==ic.FrozenColumns?(ye=Gc.AQ(ab.Range.Hc(ic.FirstRow+1,ic.FirstColumn+1)),Gc=Gc.AQ(ab.Range.Hc(jd.top,jd.left)),Qd.Width=ye.kj-He.kj,Qd.Height=ye.tj-He.tj,0<ic.FrozenRows&&(Qd.AbsoluteTop=ye.tj,xe=!0),0<ic.FrozenColumns&&(Qd.AbsoluteLeft=ye.kj,te=!0),We=ye.dL-Gc.dL,ye=ye.CJ-Gc.CJ):(Qd.Width=Gc.Sjd(Ja.a.Hc(jd.top,jd.left)),ed=ab.Range.Hc(jd.top,jd.left+1),Qd.AbsoluteLeft=He.kj+Qd.Width,te=!0):(Qd.Height=
Gc.Rjd(Ja.a.Hc(jd.top,jd.left)),ed=ab.Range.Hc(jd.top+1,jd.left),Qd.AbsoluteTop=He.tj+Qd.Height,xe=!0);xe&&(Qd.FirstFrozenRow=jd.top,Qd.FirstScrollableRow=ed.top);te&&(Qd.FirstFrozenColumn=jd.left,Qd.FirstScrollableColumn=ed.left);Qd.VisibleRows=We;Qd.VisibleColumns=ye;return Qd}m_j(ic){O.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.na&&this.$.ea&&(this.$.ea.lX(Nb.a.re,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),wb.b(this.$.na,ic,-1,void 0,!0))})}wGj(ic,
Gc,jd){if(!I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(ic.command){case 1844679312:if(Gc||-1===this.ULa&&-1===this.VLa)this.ULa=jd.yx-jd.width+this.gridView.scrollLeft,this.VLa=jd.zx-jd.height+this.gridView.scrollTop;break;case 340334732:if(Gc||-1===this.ULa)this.ULa=jd.yx-jd.width+this.gridView.scrollLeft;break;case -806625837:if(Gc||-1===this.VLa)this.VLa=jd.zx-jd.height+this.gridView.scrollTop}}Pwc(){const ic=this.gridView.jb;0<ic.width?
this.gridView.scrollLeft=Aa.a.l3b(this.gridView.domElement,D.h(this.$).rtl,0):-1!==this.ULa&&(this.gridView.scrollLeft=this.ULa,this.ULa=-1);0<ic.height?this.gridView.scrollTop=0:-1!==this.VLa&&(this.gridView.scrollTop=this.VLa,this.VLa=-1)}rNf(){this.iD.PTa();pa.a.Ja(this.UJd);this.UJd=null;this.gridView.YN(this.DFf)}}Object(f.a)(ob,"FreezePanesCommandHandler",null,[222]);var qa=a(70);class ma extends d.a{constructor(ic){super(ic)}ld(){const ic=Object(qa.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?
Object(oa.c)(J.a.resolve(N.L,{Wb:this.Na})):v.GetServiceTaskFactory.Pa(this.$.da,12,477,this.Na);A.TaskExtensions.za(ic,Gc=>{this.fd([new ob(this.$,Gc.result)])},this.$.ka)}static la(ic){ic.da.Ha(116,new ma(ic))}}Object(f.a)(ma,"FreezePanesCommandHandlerFactory",d.a,[]);var Ga=a(1202),vb=a(27),Ka=a(570),Pa=a(566),fb=a(31),Wa=a(1026),Ma=a(517),lb=a(1118);a(321);var Na=a(14),X=a(33);class F{constructor(ic,Gc){this.$=ic;this.fontServiceManager=Gc;this.menuId=this.I1c=this.xO=this.Hja=null;this.Ned=0;
this.kNi="+mn-lt";this.jKi="+mj-lt";this.eXi=()=>{this.b7f()};this.u1i=jd=>{this.pnf=!0;this.$.jz(ed=>{ed.yQa("FontName_New")});l.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${jd}`)};this.Cqi=!!String.fromCodePoint&&!vb.a.Dv&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.pnf=!1;this.Vl=I.EwaSettings.Vl();this.gridView=D.h(this.$);this.rl=X.a.rl();this.Fmf=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1);this.rl&&
this.fontServiceManager&&(this.fontServiceManager.djc?this.b7f():this.fontServiceManager.ate(this.eXi))}get themesManager(){this.fr||(Object(qa.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")?this.fr=J.a.gK(N.R):this.fr=this.$.da.Ba(422));return this.fr}b7f(){this.xO=this.fontServiceManager.ACc;this.Hja=this.fontServiceManager.gNh;this.Ned=2}get ACc(){return this.xO}x1e(ic,Gc,jd,ed=null){const Qd=Object.assign(new Ka.a,{Id:"FontDropdownMenu"});Qd.MenuSectionList=[];if(this.Vl&&this.themesManager){this.themesManager.Tac(ed);
if((null==this.themesManager.iG||this.themesManager.Uud)&&!I.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return Qd;ed=Object.assign(new Pa.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Na.a.instance.ga(1337),ControlList:this.c9h(ic,Gc,jd)});Qd.MenuSectionList.push(ed)}ed=Object.assign(new Pa.a,{ControlsId:"FontsMenuSectionControl"});if(this.Vl||this.rl)ed.Title=Na.a.instance.ga(1338);ed.ControlList=this.sZh(ic,Gc,jd);Qd.MenuSectionList.push(ed);return Qd}c9h(ic,Gc,
jd){var ed;const Qd=[];var te=this.gridView.ha.Sa.jc;te=5===(null===(ed=null===te||void 0===te?void 0:te.floatingObject)||void 0===ed?void 0:ed.type);let xe,He;this.themesManager.iG?(xe=this.themesManager.iG.ZAd,He=this.themesManager.iG.Ozd):l.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(ed=this.gLe(He,1,te,ic,Gc,jd))&&Qd.push(ed);(ic=this.gLe(xe,2,te,ic,Gc,jd))&&Qd.push(ic);return Qd}gLe(ic,Gc,jd,ed,Qd,te){var xe=2===Gc?this.kNi:this.jKi;let He;if(ic)jd=jd?xe:fb.a.df(ic),xe=fb.a.df(Ya.HelperMethods.Kec(ic,
Gc)),He=fb.a.df(ic);else{if(!I.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return null;jd=jd?xe:void 0;xe=fb.a.df(String.fromCodePoint(0));He="msofp"}return Object.assign(new Wa.a,{MenuItemId:2===Gc?lb.b:lb.a,CommandValueId:jd,LabelText:xe,LabelCss:String.format("font-size:12pt;font-family:{0};",He),Styles:F.tyb(He),AriaLabel:xe,Alt:xe,Command:ed.toString(),CommandPreviewId:Qd.toString(),CommandRevertId:te.toString(),Disabled:!ic})}sZh(ic,Gc,jd){if(this.I1c)return this.I1c.c9c;
let ed;const Qd=Ya.HelperMethods.wR(()=>{const te=this.Cqi&&!this.pnf;let xe=!1;this.Hja||(this.Ugf(),xe=!0,I.EwaSettings.isChangeGateEnabled("OfficeVSO:7477088_FontServiceRetryAndLogs")&&l.ULS.sendTraceTag(509654348,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: fontCodepointMap is Null. Initialize with old Font Dictionary."));ed=this.GJe(ic,Gc,jd,this.Hja,te,xe);ed.qAc&&!xe&&(l.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),
this.Ugf(),ed=this.GJe(ic,Gc,jd,this.Hja,te,ed.qAc));this.rl&&!ed.qAc&&(this.I1c=ed);te&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.u1i)});10<Qd&&l.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${Qd}`);return ed.c9c}GJe(ic,Gc,jd,ed,Qd,te){const xe=[];let He;const We=this.rl&&!te;He=We?"msofpNew":this.Fmf?"msofp_v4_29":"msofp";for(let rf in ed){var ye=rf,$e=ed[rf],jf=fb.a.df(ye),gf=void 0;if(We)if(gf=
this.xO?this.xO[ye]:null)gf=fb.a.df(gf);else return l.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${ye}`),{qAc:!0,c9c:[]};else gf=fb.a.df(Ya.HelperMethods.xO[ye]);ye=fb.a.df(ye);Qd||($e=0);jf=Object.assign(new Wa.a,{MenuItemId:jf,CommandValueId:jf,LabelText:Qd&&0<$e?fb.a.df(String.fromCodePoint($e)):gf,LabelCss:String.format("font-size:12pt;font-family:{0};",Qd&&0<$e?He:ye),Styles:F.tyb(Qd&&0<$e?He:
ye),AriaLabel:gf,Alt:gf,Command:ic.toString(),CommandPreviewId:Gc.toString(),CommandRevertId:jd.toString()});xe.push(jf)}return{qAc:te,c9c:xe}}VEj(ic){this.menuId=ic}oti(){return 2!==this.Ned&&3!==this.Ned?!1:!0}Ugf(){this.Fmf?(this.Hja={["Angsana New"]:983050,["Aptos Display"]:0,["Aptos Narrow"]:0,["Arial Black"]:983055,["Arial"]:983054,["Batang"]:983077,["Book Antiqua"]:983094,["Browallia New"]:983099,["Calibri"]:983102,["Cambria"]:983106,["Candara"]:983108,["Century"]:983111,["Comic Sans MS"]:983118,
["Consolas"]:983124,["Constantia"]:983125,["Corbel"]:983129,["Cordia New"]:983130,["Courier New"]:983132,["DilleniaUPC"]:983143,["Dotum"]:983145,["FangSong"]:983165,["Garamond"]:983183,["Georgia"]:983185,["Gulim"]:983212,["GungSuh"]:983216,["KaiTi"]:983253,["JasmineUPC"]:983248,["Malgun Gothic"]:983292,["Mangal"]:983296,["Meiryo"]:983299,["Microsoft JhengHei"]:983307,["Microsoft YaHei"]:983319,["MingLiU"]:983327,["MingLiU_HKSCS"]:983331,["MS Gothic"]:983280,["MS Mincho"]:983282,["MS PGothic"]:983284,
["MS PMincho"]:983286,["PMingliU"]:983362,["PMingLiU-ExtB"]:983364,["SimHei"]:983431,["SimSun"]:983433,["SimSun-ExtB"]:983435,["Source Sans Pro"]:983453,["Tahoma"]:983462,["THSarabunPSK"]:983461,["Times New Roman"]:983474,["Trebuchet MS"]:983485,["Verdana"]:983509,["Yu Gothic"]:983530,["Yu Mincho"]:983540},Ma.a.ni('@font-face{font-family:"msofp_v4_29";font-style:normal;font-weight:normal;src:url("https://fs.microsoft.com/fs/4.29/flat_officeFontsPreview.ttf") format(\'truetype\')}')):this.Hja={["Angsana New"]:983046,
["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,["Malgun Gothic"]:983258,
["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static tyb(ic){const Gc=
{};Gc["font-family"]=ic;Gc["font-size"]="12pt";ic={};ic.optionText=Gc;return ic}}Object(f.a)(F,"FontDropdownHelper",null,[670]);var na=a(717);class hb extends $a.a{constructor(ic){super();this.$=ic;this.Gb()}create(){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.hb(504,ic=>{this.qb(Object(na.a)(this.$.da,502,()=>new F(this.$,ic)))}):this.qb(Object(na.a)(this.$.da,502,()=>new F(this.$,null)))}static la(ic){ic.da.Ha(503,new hb(ic))}}Object(f.a)(hb,
"FontDropdownHelperFactory",$a.a,[]);var Ib=a(1286),vc=a(1120),nc=a(1221),Pb=a(1225),oc=a(1172),Ic=a(1197),ec=a(1308),mb=a(1262),Ob=a(1251);class Ta{constructor(ic){this.$=ic}Mc(){return!1}executeCommand(ic,Gc){ic=!1;Gc=Gc.command;switch(Gc){case 1910465940:ic=!0}return ic?O.Task.Ta(!0):S.a(Gc)}Ac(ic,Gc){switch(Gc.command){case 1910465940:return!0;default:return!1}}Rc(){return!1}}Object(f.a)(Ta,"NameManagerCommandHandler",null,[222]);class sb extends d.a{constructor(ic){super(ic)}ld(){this.fd([new Ta(this.$)])}static la(ic){d.a.Rd(493,
new sb(ic))}}Object(f.a)(sb,"NameManagerCommandHandlerFactory",d.a,[]);var zb=a(1208),db=a(1214),jb=a(1309),Ub=a(141);class xd extends Ub.StandardDialog{constructor(){super();this.ru=()=>{this.hide()}}showDialog(ic,Gc){try{this.we="OfficePyBlockPythonEditDialog",this.Rb=0,this.show({["type"]:"StandardDialogProps",["id"]:this.we,["headerText"]:ic,["resultHandler"]:this.ru,["titleText"]:Gc})}catch(jd){this.tHc(ic,Gc)}}tHc(ic){const Gc=new ba.a(!1,!1,!1);Gc.Rb=0;Gc.we="OfficePyBlockPythonEditLegacyDialog";
Gc.initializeAndShow(ic,this.stg,null)}stg(){this.hide()}}Object(f.a)(xd,"OfficePyBlockPythonEditDialog",Ub.StandardDialog,[]);class ne{constructor(ic){this.$=ic}Mc(){return!1}executeCommand(ic,Gc){ic=!1;Gc=Gc.command;switch(Gc){case 883532127:(new xd).showDialog("Python is not supported in Excel for the web","Excel for the web does not support calculating or interacting with Python formulas. To use Python formulas, open this file with the desktop app for Windows."),ic=!0}return ic?O.Task.Ta(!0):
S.a(Gc)}Ac(ic,Gc){switch(Gc.command){case 883532127:return I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficePyUX",!1);default:return!1}}Rc(){return!1}}Object(f.a)(ne,"OfficePyUXCommandHandler",null,[222]);class fe extends d.a{constructor(ic){super(ic)}ld(){this.fd([new ne(this.$)])}static la(ic){d.a.Rd(532,new fe(ic))}}Object(f.a)(fe,"OfficePyUXCommandHandlerFactory",d.a,[]);class Bd{constructor(ic,Gc){this.$=ic;this.properties=Gc}static getInstance(ic,Gc){return this.Ma||(this.Ma=
new this(ic,Gc))}static $Bb(){return!!this.Ma}Yag(){gd.ydc(this.$,this.properties).UAc(2,null)}dispose(){Bd.Ma=null}Dz(){this.dispose()}Cza(){}aLa(){return{}}}Object(f.a)(Bd,"AlignmentTaskPaneManager",null,[3]);var Ue=a(183),mc=a(1356);class Fc{constructor(ic,Gc){this.$=Gc;this.afd=ic}showTaskPane(ic,Gc){void Ue.UISurfaces.mj().then(jd=>{jd.showTaskPane("FormatCellsTaskPane",this.pu(ic,Gc));return null})}updateTaskPane(ic,Gc){void Ue.UISurfaces.mj().then(jd=>{jd.updateTaskPane("FormatCellsTaskPane",
this.pu(ic,Gc));return null})}hideTaskPane(){void Ue.UISurfaces.mj().then(ic=>{ic.hideTaskPane("FormatCellsTaskPane",2);return null})}close(){throw Error("Method not implemented.");}selectTaskPane(){throw Error("Method not implemented.");}pu(ic,Gc){ic={type:"FormatCellsTaskPaneProps",activePage:ic,callbacks:this.afd.aLa(),viewModelData:Gc};return Object.assign(new mc.a,{contentProps:ic,actionButtonProps:0!==ic.activePage&&{label:"Back",icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateTaskPane(0,
null)}},onHide:()=>{this.afd.Cza()},onClose:()=>{this.afd.Dz()},width:320})}}Object(f.a)(Fc,"FormatCellsTaskPane",null,[724]);var bd;(function(ic){ic[ic.noFormat=-1]="noFormat";ic[ic.general=0]="general";ic[ic.number=1]="number";ic[ic.currency=2]="currency";ic[ic.accounting=3]="accounting";ic[ic.date=4]="date";ic[ic.time=5]="time";ic[ic.percentage=6]="percentage";ic[ic.fraction=7]="fraction";ic[ic.scientific=8]="scientific";ic[ic.text=9]="text";ic[ic.special=10]="special";ic[ic.custom=11]="custom";
ic[ic.maxCategory=12]="maxCategory"})(bd||(bd={}));Object(f.b)("NumberFormatCategory",bd);var de=a(790),Md=a(1126),se=a(1322);class tc{constructor(){this.negativeCurrencyTypes=this.negativeNumberTypes=this.categoryDescriptionStrings=this.categories=null;this.decimalPlaces=this.currentCategory=0;this.isComma=!1}}Object(f.a)(tc,"NumberFormatModel",null,[]);class dd{constructor(){this.alignmentModel=this.numberFormatModel=null}}Object(f.a)(dd,"FormatCellsViewModel",null,[]);class Hd{constructor(ic,Gc){this.$1b=
!1;this.Utb=null;this.categoryDescriptionStrings=[Na.a.instance.ga(485),Na.a.instance.ga(486),Na.a.instance.ga(487),Na.a.instance.ga(488),Na.a.instance.ga(489),Na.a.instance.ga(490),Na.a.instance.ga(491),Na.a.instance.ga(492),Na.a.instance.ga(493),Na.a.instance.ga(494),Na.a.instance.ga(495),Na.a.instance.Ua(746)];this.Aza=()=>{let jd=new dd,ed=new tc;ed.categories=this.numberFormatViewModel.lk.Categories;ed.categoryDescriptionStrings=this.categoryDescriptionStrings;ed.negativeNumberTypes=this.numberFormatViewModel.lk.NegativeNumberTypes;
ed.negativeCurrencyTypes=this.numberFormatViewModel.lk.NegativeCurrencyTypes;let Qd=this.numberFormatViewModel.oyb();this.Utb=Qd;ed.currentCategory=Qd.NumberFormatCategory;ed.decimalPlaces=Qd.DecimalPlaces;ed.isComma=Qd.IsComma;jd.numberFormatModel=ed;gd.ydc(this.$,this.properties).UAc(1,jd)};this.zza=()=>{};this.$=ic;this.properties=Gc}static getInstance(ic,Gc){return this.Ma||(this.Ma=new this(ic,Gc))}static $Bb(){return!!this.Ma}Tbg(ic){this.properties=ic;gd.ydc(this.$,this.properties).UAc(1,null);
this.vhc(!0)}dispose(){this.elg();Hd.Ma=null}aLa(){return{onCategoryChange:ic=>{this.Utb.NumberFormatCategory=bd[ic.toLowerCase()];this.vhc()},onThousandSeparatorChanged:ic=>{this.Utb.IsComma=ic;this.vhc()},onDecimalPlacesChanged:ic=>{this.Utb.DecimalPlaces=ic;this.vhc()}}}Dz(){this.dispose()}Cza(){this.elg()}vhc(ic){let Gc=null;if(this.activeCell=this.ycc())x.a.Pc in this.properties&&this.properties[x.a.Pc]&&(Gc=parseInt(this.properties[x.a.Pc].toString(),10)),this.numberFormatViewModel?(this.$1b||
this.Zuc(),Gc||ic?this.Wsf(Gc):this.numberFormatViewModel.uvb(this.activeCell,this.Utb)):this.sih(Gc)}sih(ic){const Gc=v.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,0);A.TaskExtensions.za(Gc,()=>{this.numberFormatViewModel=new Md.a(this.$,Gc.result,new se.a(this.$));this.$1b||this.Zuc();this.numberFormatViewModel.CPd();this.Wsf(ic)},this.$.ka,3)}Zuc(){this.$1b=!0;this.numberFormatViewModel.RZa(this.Aza);this.numberFormatViewModel.NYc(this.zza)}Wsf(ic){ic=Object(Ab.a)(new de.a,{Caller:3,NumberFormatCategory:null!==
ic&&void 0!==ic?ic:-1});this.numberFormatViewModel.uvb(this.activeCell,ic)}ycc(){let ic;const Gc=D.h(this.$).ha.ra.activeCell;Gc&&(ic=u.o(Gc,this.$));return ic}elg(){this.$1b=!1;this.numberFormatViewModel&&(this.numberFormatViewModel.hdb(this.Aza),this.numberFormatViewModel.GNd(this.zza))}}Object(f.a)(Hd,"NumberFormatTaskPaneManager",null,[3]);class Xc extends da.a{constructor(ic,Gc){super();this.activePage=0;this.Rud=!1;this.K2h=()=>1===this.activePage?gd.pyb(this.$,this.properties).aLa():null;this.kSh=
()=>2===this.activePage?gd.exb(this.$,this.properties).aLa():null;this.$=ic;this.properties=Gc;this.Wbc=new Fc(this,ic);this.qI()}static getInstance(ic,Gc){return this.Ma||(this.Ma=new this(ic,Gc))}UAc(ic,Gc){this.Rud?this.Wbc.updateTaskPane(ic,Gc):(this.Wbc.showTaskPane(ic,Gc),this.Rud=!0);this.activePage=ic}Cza(){Hd.$Bb&&gd.pyb(this.$,this.properties).Cza();Bd.$Bb&&gd.exb(this.$,this.properties).Cza()}Dz(){Hd.$Bb()&&gd.pyb(this.$,this.properties).Dz();Bd.$Bb()&&gd.exb(this.$,this.properties).Dz();
this.dispose()}dispose(){this.$=null;this.N0d();this.Wbc.hideTaskPane();this.Wbc=null;this.Rud=!1;this.properties=null;Xc.Ma=null}qI(){}N0d(){}aLa(){return{onItemClick:ic=>{switch(ic){case 1:gd.pyb(this.$,this.properties).Tbg(this.properties);break;case 2:gd.exb(this.$,this.properties).Yag()}},numberFormatCallbacks:this.K2h(),alignmentCallbacks:this.kSh()}}}Object(f.a)(Xc,"FormatCellsTaskPaneManager",da.a,[]);class gd{constructor(){}static ydc(ic,Gc){return Xc.getInstance(ic,Gc)}static pyb(ic,Gc){return Hd.getInstance(ic,
Gc)}static exb(ic,Gc){return Bd.getInstance(ic,Gc)}}Object(f.a)(gd,"FormatCellsTaskPaneHelper",null,[]);class je{constructor(ic){this.$=ic}Mc(){return!1}executeCommand(ic,Gc,jd){ic=!1;Gc=Gc.command;switch(Gc){case 2055979337:gd.ydc(this.$,jd).UAc(0,null);ic=!0;break;case -395879625:gd.pyb(this.$,jd).Tbg(jd);ic=!0;break;case -2019948858:gd.exb(this.$,jd).Yag(),ic=!0}return ic?O.Task.Ta(!0):S.a(Gc)}Ac(ic,Gc){switch(Gc.command){case 2055979337:case -395879625:case -2019948858:return!0;default:return!1}}Rc(){return!1}}
Object(f.a)(je,"FormatCellsCommandHandler",null,[222]);class Ee extends d.a{constructor(ic){super(ic)}ld(){this.fd([new je(this.$)])}static la(ic){d.a.Rd(533,new Ee(ic))}}Object(f.a)(Ee,"FormatCellsCommandHandlerFactory",d.a,[]);var ae=a(472);class Yb{constructor(ic,Gc){this.$=ic;this.formulaAssistanceUIControl=Gc;this.isVisible=!1;this.gridView=Object(D.h)(this.$);this.container=document.createElement("div");this.$.domElement.appendChild(this.container)}show(ic,Gc,jd){this.isVisible=!0;ic=this.gridView.getCellBounds(ic,
!0);ic={top:ic.y,bottom:ic.y+ic.height,left:ic.x,right:ic.x+ic.width};Gc=Object.assign(Object.assign({},Gc),{callbacks:jd});this.formulaAssistanceUIControl.renderFormulaRepair(this.container,ic,Gc)}hide(){if(!this.isVisible)return!1;this.isVisible=!1;this.formulaAssistanceUIControl.dismiss(this.container);return!0}}Object(f.a)(Yb,"FormulaRepairControl",null,[]);var Sc=a(562),qd=a(5);class Id{constructor(ic,Gc,jd){this.$=ic;this.pluginScheduler=Gc;this.F1j=jd;this.ivd=!1;this.Gg=()=>{this.ivd=!1;this.control.hide();
void this.v0f()};this.aLa=ed=>({onCommit:this.onCommit(ed),onFeedback:this.onFeedback,onDismiss:this.onDismiss,onIgnore:this.onIgnore});this.onCommit=ed=>Qd=>{this.control.hide();this.gridView.setCell({Text:Qd.text,Fonts:[],TextRuns:[]},ed,0,127,null)};this.onDismiss=()=>{};this.onIgnore=()=>{this.qMf()};this.onFeedback=()=>{const ed={};ed[qd.a.VJ]="FormulaRepairCard";this.$.Yc(802602464,0,19,ed)};this.Di=()=>{this.control.hide()};this.dg=(ed,Qd)=>{Qd.E1a||void this.v0f()};this.gridView=Object(D.h)(this.$);
this.control=new Yb(this.$,this.F1j);this.gridView.ha.vA(this.Gg);this.gridView.Xb.PGa(this.Di);this.gridView.Xb.rm(this.dg)}qMf(){this.control.hide()&&(this.ivd=!0)}v0f(){return Object(h.a)(this,void 0,void 0,function*(){if(!this.gridView.eb&&!this.ivd){var ic=this.gridView.Jb(null);if(!Object(Sc.c)(ic)){var Gc=ic.cell;if(Gc.Pfc){const jd=yield this.pluginScheduler.getRequester().formulaRepair({formula:Gc.text},0);0!==jd.kind||Object(Sc.c)(jd.payload)||this.control.show(Gc,jd.payload,this.aLa(ic.range))}}}})}}
Object(f.a)(Id,"FormulaRepair",null,[]);Object(J.b)(N.t,{nR:"singleton"})(ic=>Object(h.a)(void 0,void 0,void 0,function*(){var Gc;const jd=yield J.a.resolve(N.o,ic),ed=J.a.resolve(ae.PluginSchedulerService,ic),Qd=Object(oa.d)(v.GetServiceTaskFactory.Pa(jd.da,448,449,null!==(Gc=ic.Wb)&&void 0!==Gc?Gc:0));Gc=J.a.resolve(ae.FunctionInfoManagerService,ic);const [te,xe,He]=yield Promise.all([ed,Qd,Gc]);return new Id(jd,te,xe,He)}));Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Object(e.a)();(()=>{R.a.Fa(ic=>{I.EwaSettings.isChangeGateEnabled("OfficeVSO:7505051_MoveBatchHandlerToNewServices")||
ea.la(ic)})})();R.a.Fa(xa.la);Object(bb.a)();Object(Za.a)();Object(La.a)();Object(va.a)();Object(Ba.a)();Object(Ea.a)();R.a.Fa(ua.la);Object(eb.a)();Object(Eb.a)();Object(Wb.a)();(()=>{R.a.Fa(ic=>{ma.la(ic)})})();Object(Ga.a)();Object(Ib.a)();Object(vc.a)();Object(nc.a)();Object(Pb.a)();Object(oc.a)();Object(Ic.a)();Object(ec.a)();Object(mb.a)();Object(db.a)();Object(Ob.a)();Object(zb.a)();Object(jb.a)();(()=>{R.a.Fa(ic=>{fe.la(ic)})})();(()=>{R.a.Fa(ic=>{sb.la(ic)})})();(()=>{R.a.Fa(ic=>{hb.la(ic)})})();
(()=>{R.a.Fa(ic=>{Ee.la(ic)})})();String(b);window.___1678693106909_closurehack=b},739:function(r,B,a){a.d(B,"a",function(){return N});r=a(0);var c=a(7),b=a(15),e=a(570),f=a(91),d=a(566),h=a(382),l=a(588),k=a(573),w=a(115),n=a(274),x=a(86),m=a(424),u=a(1433);B=a(84);var t=a(18),y=a(5),v=a(789),A=a(73),z=a(44),C=a(60),H=a(151),I=a(121),S=a(1),P=a(11),D=a(22),G=a(14),E=a(21),O=a(35);class N extends B.a{constructor(J,W,ea,R,Y,U,da,T,ka,L,fa,wa){super();this.doc=!1;this.AJc=this.nMc=this.contextMenuController=
null;this.$rd=!1;this.pxc=this.Lub=null;this.MC=()=>{this.contextMenuController?this.contextMenuController.MC():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.Wkg()};this.mb=J;this.Rxf=Y;this.vTc=L;this.HPf=U;this.populateOnlyOnce=da;this.nfi=fa;this.BWf(wa)}get contextMenuRoot(){return this.pxc}get $(){return this.mb}get Xa(){return this.vTc}get menuId(){return this.$.Cb+this.Rxf}get Owb(){this.nMc||
(this.nMc=I.a(this.$));return this.nMc}get Wrb(){this.AJc||(this.AJc=E.h(this.$).Xb);return this.AJc}Mc(J,W){J=!0;switch(W){case 1651433993:case 1675506831:case 966232027:J=this.Td(4096)||this.Td(2048);break;case 2045563128:J=this.Td(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:J=this.Td(8192)}return!J}Rc(J,W,ea){ea.IsShadowMenuOpen||v.i(this.$,v.d);J=!1;W===this.Sw&&(ea.IsShadowMenuOpen||v.i(this.$,v.a),W=Object(c.a)(new e.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,
MenuSectionList:[]}),this.fId(W,ea.IsShadowMenuOpen),ea.MenuItems=W,ea.IsShadowMenuOpen||v.i(this.$,v.c),J=!0);J&&this.doc&&P.HelperMethods.m3b&&!ea.IsShadowMenuOpen&&v.k(this.$);return J}fId(J,W){(W=this.TY(W))?(this.kff(W),J.MenuSectionList.push(...W.AE().MenuSectionList),this.jNg(J)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}TY(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}J0(J,W,ea,R,Y){J=Sys.UI.DomElement.getBounds(W);W=new Sys.UI.Point(J.x,J.y+J.height);this.$.isChromeRtl&&(W.x+=J.width);this.eo(W,Y)}eo(J,W,ea=0){W&&(J=O.a(this.$).ska(J));W=!0;if(this.nfi){let R;3===ea?(R=this.mLa(3))&&0<R.length?(W=!1,this.showFloatie(R,new Sys.UI.Bounds(J.x,J.y,0,0),ea)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===
ea&&this.$.isEditMode&&((R=this.mLa(2))&&0<R.length?R[0]!==N.B_e?(W=!1,this.cWd(R,new Sys.UI.Bounds(J.x,J.y,0,0),ea)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}W&&this.showContextMenu(new Sys.UI.Bounds(J.x,J.y,0,0),
ea)}mLa(){return null}Njd(J,W=null){let ea="";3===J?ea="touch":2===J&&(ea="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!C.a.rg&&C.a.rg.sK,["IsReactMLR"]:!!C.a.rg&&C.a.rg.BV,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:ea,["FloatieGroups"]:JSON.stringify(W)}}showContextMenu(J,W=0){const ea=this.Njd(W);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(ea)}`);this.contextMenuController?this.vB!==
y.a.UKd&&this.vB!==y.a.VKd||0===W?this.contextMenuController.bWd(this.vB,J,A.a.zb):this.contextMenuController.bWd(this.vB,J,W):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(J,W,ea){const R=this.Njd(ea,J);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(R)}`);this.contextMenuController?(this.JWf(),this.contextMenuController.SAc(J,
W,ea)):(J=JSON.stringify(J),b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${J}.`))}cWd(J,W,ea){var R=this.Njd(ea,J);R=JSON.stringify(R);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${R}`);this.contextMenuController?(this.JWf(),this.contextMenuController.aWd(J,W,ea,this.vB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}BWf(J){this.contextMenuController=
J}dispose(){this.$&&this.$.Ia.Ucb(this);this.mb=null;this.Wkg();this.pxc&&(f.a.Ja(this.pxc),this.pxc=null);super.dispose()}DPh(J){var W=this.$.da.Ba(204);W&&(W=W.lQh(this.Rxf))&&J.uc.push(W)}Td(J){return(new H.a(this.$.ua)).Td(J)}kff(J){for(const W of J.uc)if(Object(m.a)(298,W)){J=W;J.title&&(J.title=N.qf(J.title));for(const ea of J.buttons)Object(m.a)(299,ea)?(J=ea,J.label=N.qf(J.label),J.eS(N.qf(J.alt))):Object(m.a)(300,ea)&&this.kff(ea.menu)}}Oxf(J,W=!1){const ea=[];for(const R of J)ea.push(this.bQ(R,
W));return ea}bQ(J){const W=[];for(const ea of J.MenuItems)switch(ea.Type){case 3:W.push(this.kfh(ea));break;case 2:W.push(this.Wkh(ea));break;case 1:W.push(this.Kgh(ea))}return Object(c.a)(new d.a,{ControlList:W,Title:J.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Qfd(J,W){W=[this.Lub,J.RibbonCommand.toString(),W?this.C5e(W):this.C5e(J.Label),J.Disabled?J.Disabled.toString():"False"];let ea=J.CommandData;ea=D.a.hashCode(ea).toString();
W.push(ea,J.Identifier.toString());W=W.join("_");J.IsChecked&&(W+="_Checked");return W}mQh(J){const W=[this.Lub,D.a.hashCode(J.Title).toString()];for(const ea of J.MenuItems)W.push(ea.RibbonCommand.toString());return W.join("_")}w1e(J){var W=J.Label;W=D.a.hashCode(W).toString();W=[this.Lub,W];S.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&J.Id&&W.push(D.a.hashCode(J.Id).toString());W=W.join("_");J.IsChecked&&(W+="_Checked");return W}kfh(J){let W,
ea,R;({label:ea,sMa:R,Er:W}=this.rcc(J,!1));const Y=this.Qfd(J,ea);return Object(c.a)(new h.a,{Command:J.Disabled?(-251203935).toString():W.toString(),ExternalId:Y,Id:Y,Image16by16Class:R,LabelText:ea||J.Label,MenuItemId:J.CommandData,CommandValueId:J.CommandData})}Wkh(J){let W,ea,R;({label:ea,sMa:R,Er:W}=this.rcc(J,J.IsChecked));const Y=this.Qfd(J,ea);return Object(c.a)(new l.a,{Command:J.Disabled?(-251203935).toString():W.toString(),ExternalId:Y,Id:Y,Image16by16Class:R,LabelText:ea||J.Label,MenuItemId:J.CommandData,
CommandValueId:J.CommandData,IsChecked:J.IsChecked})}Kgh(J){let W;var ea;({label:W,sMa:ea}=this.F1e(J));const R=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});R.MenuSectionList.push(...this.Oxf(J.SubMenu.Sections,!0));const Y=this.w1e(J);J=W||J.Label;return Object(c.a)(new k.a,{ExternalId:Y,Id:Y,LabelText:J,PopulateOnlyOnce:!1,Menu:R,Image16by16Class:ea,ImageIsVisible:!!ea})}F1e(J){let W,ea;({label:J,sMa:W,Er:ea}=this.rcc(J,!0));return{label:J,sMa:W,Er:ea}}rcc(J,W){let ea;switch(J.Identifier){case 26:ea=
912804500;W=t.a.KWe;J=G.a.instance.ga(1951);break;case 3:ea=-1902148570;W=W?t.a.Oaa:null;J=G.a.instance.ga(1911);break;case 4:ea=-1902148570;W=W?t.a.Oaa:null;J=G.a.instance.ga(1912);break;case 5:ea=-1902148570;W=W?t.a.Oaa:null;J=null;break;case 1:ea=-1677817820;W=t.a.aac;J=G.a.instance.ga(233);break;case 2:ea=-1649376918;W=J.IsChecked?t.a.Zua:null;J=G.a.instance.ga(2122);break;case 23:ea=1701016594;W=J.IsChecked?t.a.Zua:null;J=G.a.instance.ga(2122);break;case 6:ea=-87741481;W=null;J=G.a.instance.ga(2123);
break;case 7:ea=1948650742;W=t.a.uVe;J=G.a.instance.ga(1949);break;case 8:ea=1933713114;W=t.a.tVe;J=G.a.instance.ga(1950);break;case 14:ea=504133448;W=t.a.dKa;J=G.a.instance.ga(144);break;case 30:ea=504133448;W=t.a.dKa;J=G.a.instance.Ua(744);break;case 32:ea=504133448;W=t.a.dKa;J=G.a.instance.ga(148);break;case 34:ea=504133448;W=t.a.dKa;J=G.a.instance.ga(150);break;case 27:ea=1701016594;W=W?t.a.dac:t.a.dKa;J=G.a.instance.ga(144);break;case 15:ea=-798968736;W=t.a.eKa;J=G.a.instance.ga(146);break;case 31:ea=
-798968736;W=t.a.eKa;J=G.a.instance.Ua(745);break;case 33:ea=-798968736;W=t.a.eKa;J=G.a.instance.ga(149);break;case 35:ea=-798968736;W=t.a.eKa;J=G.a.instance.ga(151);break;case 28:ea=1701016594;W=W?t.a.eac:t.a.eKa;J=G.a.instance.ga(146);break;case 21:ea=-2058042992;W=t.a.N3a;J=null;break;case 29:ea=1701016594;W=t.a.N3a;J=null;break;case 9:ea=1701016594;J=W=null;break;case 11:ea=-1494291901;J=W=null;break;case 25:ea=-1045020714;W=J.IsChecked?t.a.Zua:null;J=null;break;case 13:ea=1701016594;W=J.IsChecked?
t.a.Zua:null;J=G.a.instance.ga(153);break;case 16:ea=1701016594;W=t.a.U$b;J=G.a.instance.ga(1082);break;case 17:ea=1701016594;W=t.a.M3a;J=null;break;case 18:ea=1701016594;W=t.a.L3a;J=null;break;case 19:ea=1701016594;W=t.a.V$b;J=G.a.instance.ga(1087);break;case 20:ea=1701016594;W=t.a.Rbd;J=G.a.instance.ga(1088);break;case 24:ea=1675506831;J=W=null;break;case 22:ea=J.RibbonCommand;W=J.IsChecked?t.a.Oaa:null;J=null;break;case 36:ea=1461300262;W=null;J=G.a.instance.ga(152);break;case 38:ea=J.RibbonCommand;
W=t.a.gcd;J=G.a.instance.ga(1822);break;case 37:ea=1461300262;W=null;J=G.a.instance.ga(155);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(J)}`),ea=1461300262,J=W=null}return{label:J,sMa:W,Er:ea}}C5e(J){return D.a.hashCode(J+P.HelperMethods.EBj).toString()}jNg(J){if(!this.$.ea.amIAlone){var W=this.$.da.Ba(25);if(W&&!w.a.isEmpty(W.Dpa)&&(W=W.M$h(),!n.a.ah(W))){var ea=[];x.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").mjh(W,ea);J.MenuSectionList.push(...ea)}}}JWf(){this.$rd||
(this.Owb&&this.Owb.M0b(this.MC),this.Wrb&&this.Wrb.M0b(this.MC),this.$rd=!!this.Owb||!!this.Wrb)}Wkg(){this.Owb&&this.Owb.Qvc(this.MC);this.Wrb&&this.Wrb.Qvc(this.MC);this.$rd=!1}static Igd(J,W,ea){W=z.D(W);J=E.h(J);return ea?J.dwb(W.left):J.Ca.awa(W)}static frd(J,W){W=z.D(W);J=E.h(J).Ca.awa(W);return!(null===J||void 0===J||!J.ek)}static erd(J,W){return W?!!J:!(null===J||void 0===J||!J.ek)}static Ygd(J,W,ea){W=z.D(W);var R=E.h(J).Ca.awa(W);W=E.h(J).getCellBounds(R);const Y=R.r0c;R=R.n0c;let U=W.x+
Y.x;W=W.y+Y.y;ea&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(E.h(J).rtl||(U+=R),W-=R);return new Sys.UI.Point(U,W)}static Xgd(J,W,ea,R){if(W){var Y=E.h(J);R=R?Y.s_h(W):Y.getCellBounds(W);Y=W.r0c;W=W.n0c;var U=R.x+Y.x;R=R.y+Y.y;ea&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(E.h(J).rtl||(U+=W),R-=W);return new Sys.UI.Point(U,R)}b.ULS.sendTraceTag(509220164,0,15,`ContextMenuBase.getContextMenuCoordinates:\u00a0cellProxy is undefined, isHeaderCommandData=${R}`)}static zHh(J){try{Object(u.a)(J.CommandValueId)}catch(W){}}static qf(J){const W=
N.U2a.parseFromString(J,"text/html");return W?W.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),J)}}N.U2a=new DOMParser;N.B_e="Unsupported";Object(r.a)(N,"ContextMenuBase",B.a,[222,301,3])},789:function(r,B,a){a.d(B,"j",function(){return"ContextMenuPerf.A"});a.d(B,"b",function(){return"ContextMenuPerf.B"});a.d(B,"d",function(){return"ContextMenuPerf.C1"});a.d(B,"a",function(){return"ContextMenuPerf.C2"});a.d(B,"c",function(){return"ContextMenuPerf.D"});a.d(B,
"e",function(){return w});a.d(B,"f",function(){return m});a.d(B,"h",function(){return u});a.d(B,"i",function(){return t});a.d(B,"k",function(){return y});a.d(B,"g",function(){return A});var c=a(15),b=a(327),e=a(8),f=a(64),d=a(24),h=a(11),l=a(21),k=a(1);const w=(z,C)=>{var H=z.Jb(null);if((null===H||void 0===H?0:H.cell.ek)&&n(H,z,C))return z.getCellBounds(H.cell);H=z.ha.ra.activeCell;return(C=x(new d.Range(H.top,H.left,e.a.xg,H.left,!1,!1),2,!0,z,C)||x(new d.Range(1,H.left,H.top,H.left,!1,!1),2,!1,
z,C)||x(new d.Range(H.top,H.right,H.top,e.a.wg,!1,!1),1,!0,z,C)||x(new d.Range(H.top,1,H.top,H.right,!1,!1),1,!1,z,C)||null)&&C.ek?z.getCellBounds(C):Sys.UI.DomElement.getBounds(z.Iwa.mc)},n=(z,C,H)=>{var I=C.rtl,S=H.isChromeRtl;z=z.cell;return(H=l.h(H).$J(z))?(H=H.topLeft,I=H.x+=I===S?z.offsetWidth:0,S=H.y+=z.offsetHeight,C.view.visibleArea.contains(new f.a(I,S,0,0))):!1},x=(z,C,H,I,S)=>{z=I.Qj("ContextMenuHelper.FindFirstCellInViewportArea",z,C,H);try{for(z.$$rst();z.$$mn();){const P=z.$$cu();if(P&&
n(P,I,S))return P.cell}}finally{z&&z.dispose()}return null},m=z=>z.tb.n5(z.ha.ra.activeCell),u=z=>{z=l.h(z).ha.ra;return z.eh&&(z.xd.isRow||z.xd.Fg)},t=(z,C)=>{h.HelperMethods.n1c&&window.performance.mark(C)},y=()=>{if(b.a.grb){const z=v("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),C=v("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),H=v("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${z}], PrepInfraWork=[${C}], EWAPopulation =[${H}]`)}},
v=(z,C,H)=>{window.performance.measure(z,C,H);C=window.performance.getEntriesByName(z);C.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${z}] returned no measures.`);return C[C.length-1]?C[C.length-1].duration:-1},A=z=>k.EwaSettings.isChangeGateEnabled("OfficeVSO:7214067_CheckShareModeCapability")?z.Bd&33554432?!0:!1:!0},791:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{}c.YSe="ewa-ac";c.zxh="ewa-ac-param";c.dUe="ewa-function-help-link";c.P$b=
"ewa-lb";c.ZTe="ewa-fb-refactor";c.listItem="list-item";c.uEb="list-item-selected";c.yEb="list-table-touch";c.xEb="list-table";c.OCh="ewa-suggested-cell-name";c.h$g="columnName-header";c.ZUe="ewa-tt";c.kAh="ewa-function-link-container";c.eUe="ewa-function-udf-name";c.rtl="rtl";Object(r.a)(c,"CssClassNames",null,[])},831:function(r,B,a){a.r(B);r=a(0);var c=a(15),b=a(847),e=a(744),f=a(5),d=a(73),h=a(52),l=a(206),k=a(36),w=a(1),n=a(14);class x{constructor(ea,R,Y,U,da,T,ka,L){this.Iwg=ea;this.Jwg=R;this.Hwg=
Y;this.Uga=U;this.LHg=da;this.eEg=T;this.wlb=ka;this.fDg=L}get Cze(){return this.Iwg}get d3b(){return this.Jwg}get Bze(){return this.Hwg}get width(){return this.Uga}get eUj(){return this.LHg}get nRi(){return this.eEg}get lineHeight(){return this.wlb}get qEi(){return this.fDg}static Z_g(){return new x("BorderStyleSolidLine",1963,1,"1","",1,8,0)}static V_g(){return new x("BorderStyleDashedLine",1964,3,"1","5,3",1,8,0)}static W_g(){return new x("BorderStyleDottedLine",1965,4,"1","1,1",1,8,0)}static Y_g(){return new x("BorderStyleMediumLine",
1966,2,"2","",1,8,0)}static $_g(){return new x("BorderStyleThickLine",1967,5,"3","",1,8,0)}static X_g(){return new x("BorderStyleDoubleLine",1968,6,"1","",2,8,3)}}Object(r.a)(x,"BorderLineStyleProperties",null,[]);class m{constructor(){this.iconName=this.title=this.key=null}}Object(r.a)(m,"BorderLineStyleProps",null,[]);class u{constructor(ea){ea.UWf()}getBorderLineStyleProps(){const ea=a(831).BorderFormatManager.j0a,R=Array(Object.keys(ea).length);let Y=0;for(let T in ea){var U=T,da=ea[T];R[Y]=new m;
R[Y].key=U;U=da;R[Y].title=n.a.instance.ga(U.d3b);R[Y].iconName=U.Cze;Y++}return R}}Object(r.a)(u,"BorderMenuController",null,[435]);var t=a(90),y=a(243),v=a(13),A=a(113),z=a(24),C=a(49),H=a(45),I=a(215),S=a(11),P=a(21),D=a(35),G=a(44);class E{constructor(ea,R){this.oJb=this.ribbonCommandInfo=this.cellFormat=this.zq=this.Eb=this.ha=null;this.avc=!1;this.fRf=this.DMa=this.mRf=this.Dbe=this.hAa=this.jna=null;this.f3b=this.Gua=this.lRf=0;this.borderStyle=this.k0a=this.borderColor=null;this.dB=!1;this.N7b=
this.Obb=null;this.n0=()=>{if(!this.dB||P.h(this.$).pz)this.dB=!1,P.h(this.$).pz=!1,this.Gua=0,P.h(this.$).Ng.Ap(f.a.gV),1===this.$.Ia.uH()&&(P.h(this.$).KZ(G.d(this.mRf),this.lRf,this.$.na?this.$.na.sheetName:null,null,this.fRf.clone(),null,null,0,"DrawBorderBehavior.ResetBehavior",!0),P.h(this.$).oTa(!0)),this.Rv(),this.Y0d(),this.Xj(),this.avc=!1,this.hAa=this.jna=null,this.zq&&(this.zq.cancel(),this.zq.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};
this.onPointerDown=Y=>{try{if(Y=this.ve(Y),P.h(this.$).pz=!0,this.jna={},this.hAa={},this.Obb=null,this.krb(this.f3b),2===Y.wb){const U=P.h(this.$).ha.Zp(Y.clientPoint,Y.Ob,5,void 0,void 0,!1);U&&(this.N7b=this.DMa=U,this.bkj())}}catch(U){P.h(this.$).pz=!1}return!0};this.aj=Y=>{try{Y=this.ve(Y);const U=P.h(this.$).ha.Zp(Y.clientPoint,Y.Ob,5,void 0,void 0,!1),da=P.h(this.$).Ca.ds(U);if(!this.oJb||da&&(da.SQ!==this.oJb.SQ||da.RQ!==this.oJb.RQ))if(this.dB=!0,this.oJb=da,U){let T=new z.Range(this.DMa.top,
this.DMa.left,this.DMa.top,this.DMa.left,!0,!1);T.union(U);T=P.h(this.$).ha.T4h(T);this.k3b(U);this.z1f(this.Obb,T);if(this.bottomRightCorner(T.bottom,T.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;const ka=new z.Range(T.top,T.left,T.bottom+1,T.right+1,!0,!1),L=P.h(this.$).iaa("DrawBorderBehavior.OnPointerMove",[ka]);if(this.jna&&this.hAa)for(;L.$$mn();){const fa=L.$$cu(),wa=fa.cell.getRange().toString();
wa in this.jna&&1!==this.Gua||(this.jna[wa]=fa,this.hAa[wa]=fa.cell.JM())}this.Obb=ka;this.N7b=T;P.h(this.$).KZ([T],0,this.$.na.sheetName,null,T.topLeft,null,null,0,"DrawBorderBehavior.OnPointerMove",!0);this.Zg.vea(P.h(this.$),-1690267012,this.cellFormat,!0,null,[T])}return!0}catch(U){return P.h(this.$).pz=!1}};this.fh=Y=>{Y=this.ve(Y);(Y=P.h(this.$).ha.Zp(Y.clientPoint,Y.Ob,5,void 0,void 0,!1))?this.dB&&(this.k3b(Y),this.DMa.union(Y),3===this.Gua?this.krb(0):this.krb(this.f3b),P.h(this.$).KZ([this.DMa],
0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp1",!0),this.Zg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.Gua?this.krb(0):this.krb(this.f3b),P.h(this.$).KZ([this.N7b],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp2",!0),this.Zg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.dB=!1;this.Y0d();this.hAa=this.jna=null;return!0};this.onKeyDown=Y=>{Y=this.ve(Y);if(this.dB||[17,16,18,20].includes(Y.Ea.keyCode))return!0;
this.n0();return!1};this.onKeyUp=Y=>{Y=this.ve(Y);if(Y.Ea.keyCode===t.a.sG&&this.dB)return this.dB=!1,this.z1f(this.Obb,this.N7b,!0),this.Y0d(),!0;if(this.dB||Y.Ea.keyCode===t.a.Epa||Y.Ea.keyCode===t.a.zHc||Y.Ea.keyCode===t.a.yHc||[17,16,18,20,37,39,38,40,33,34,9,13].includes(Y.Ea.keyCode)||Y.Ea.keyCode===t.a.y5d||Y.Ea.keyCode===t.a.u5d||Y.Ea.keyCode===t.a.q5d)return!0;this.n0();return!1};this.qD=(Y,U)=>{P.h(this.$).pz&&!this.mii.includes(U.Ud.command)&&(Y=JSON.stringify(U.Ud),c.ULS.sendTraceTag(537159512,
0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${Y} `),this.n0())};this.$=ea;this.Zg=R}get mii(){return this.Dbe||(this.Dbe=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}uKg(ea){c.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=P.h(this.$).ha;this.Eb=P.h(this.$).Eb;
this.ribbonCommandInfo=ea;this.mRf=G.d(this.ha.ra.selectedRanges);this.lRf=this.ha.ra.Mq;this.fRf=this.ha.ra.activeCell.clone();this.Eb&&this.Eb.ynd();this.Nt();this.Gj()}dispose(){this.n0();this.oJb=this.ribbonCommandInfo=this.cellFormat=null}krb(ea){var {BorderFormatManager:R}=a(831);this.cellFormat={};const Y={};this.borderColor=this.borderColor||R.i9c;var U=l.a.rH(this.borderColor,!1);Y.Color=[U,U,U,U];w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.k0a&&(Y.ThemeBorderColor=
[this.k0a,this.k0a,this.k0a,this.k0a],Y.ColorTypeOption=1);U=a(831).BorderFormatManager.j0a;this.borderStyle=this.borderStyle||R.borderStyleSolidLine;R=U[this.borderStyle].Bze;Y.LineStyle=[R,R,R,R];this.cellFormat.BorderFormat=Y;this.cellFormat.ValidMembers=128;this.cellFormat.Border=ea}Nt(){for(const ea of P.h(this.$).Cn)y.a.instance.ta(v.a.pointerDown,ea.domElement,this.onPointerDown);A.KeyInputManager.instance.ta(v.a.Vb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.ta(v.a.Qd,
document.documentElement,this.onKeyUp)}bkj(){for(const ea of P.h(this.$).Cn)y.a.instance.ta(v.a.mk,ea.domElement,this.aj),y.a.instance.ta(v.a.Of,ea.domElement,this.fh);y.a.instance.ta(v.a.Of,document.documentElement,this.fh);y.a.instance.ta(v.a.sB,document.documentElement,this.fh);this.avc=!0}Rv(){try{for(const ea of P.h(this.$).Cn)y.a.instance.Aa(v.a.pointerDown,ea.domElement,this.onPointerDown);A.KeyInputManager.instance.Aa(v.a.Vb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.Aa(v.a.Qd,
document.documentElement,this.onKeyUp)}catch(ea){P.h(this.$).pz=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${ea}`)}}Y0d(){if(this.avc)try{this.avc=!1;for(const ea of P.h(this.$).Cn)y.a.instance.Aa(v.a.mk,ea.domElement,this.aj),y.a.instance.Aa(v.a.Of,ea.domElement,this.fh);y.a.instance.Aa(v.a.Of,document.documentElement,this.fh);y.a.instance.Aa(v.a.sB,document.documentElement,this.fh)}catch(ea){P.h(this.$).pz=!1,c.ULS.sendTraceTag(537159513,
0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${ea}`)}}Gj(){this.$.ua.Yf(this.n0);P.h(this.$).Xb.gl(this.n0);P.h(this.$).uE(this.n0);this.$.Ia.Gsa(this.qD)}Xj(){this.$.ua.yg(this.n0);P.h(this.$).Xb.Zk(this.n0);P.h(this.$).VF(this.n0);this.$.Ia.Ena(this.qD)}z1f(ea,R,Y=!1){if(ea&&this.jna&&this.hAa)for(ea=P.h(this.$).iaa("DrawBorderBehavior.ApplyBordersOnPreviewCells",[ea]);ea.$$mn();){var U=ea.$$cu().cell.getRange();if(Y||!R.contains(U)||1===this.Gua){U=
U.toString();const da=k.a.Ic(this.jna,U);if(da){const T=k.a.Ic(this.hAa,U);this.setBorders(da,T);delete this.jna[U];delete this.hAa[U]}}}}setBorders(ea,R){var Y=ea.cell;const U=Y.getRange();Y.Tcb();U.right!==this.Obb.right&&(Y=new z.Range(U.top,U.left-1,U.bottom,U.left-1,!0,!1),P.h(this.$).Ca.ds(Y).jRa(3));U.bottom!==this.Obb.bottom&&(Y=new z.Range(U.top-1,U.left,U.top-1,U.right,!0,!1),P.h(this.$).Ca.ds(Y).jRa(1));if(null===R||void 0===R?0:R.Borders.length){Y={};let ka=0;const L=Array(4),fa=Array(4);
for(var da=0;4>da;da++)L[da]=1,fa[da]=0;for(var T of R.Borders)R=T.BorderPosition,L[R]=T.BorderLineStyle,da=new I.a(T.Color.Red,T.Color.Green,T.Color.Blue),fa[R]=da.pS(),ka|=S.HelperMethods.T4a(T.BorderPosition);Y.LineStyle=L;Y.Color=fa;T={};T.BorderFormat=Y;T.Border=ka;this.Zg.IFj(ea,T,U)}}k3b(ea){const R=new z.Range(Math.max(1,ea.top-1),Math.max(1,ea.left-1),ea.bottom+1,ea.right+1,!1,!1);P.h(this.$).gN(R)||this.zq&&this.zq.Wn||(this.zq=C.a.instance.create(()=>{P.h(this.$).yv(R,60,"DrawBorderBehavior.BringRangeIntoView")},
40,H.a.bth))}bottomRightCorner(ea,R){return 1048576<=ea||16384<=R?!0:!1}ve(ea){return D.a(this.$).ve(ea)}}Object(r.a)(E,"DrawBorderBehavior",null,[3]);var O=a(54),N=a(70),J=a(153);a.d(B,"BorderFormatManager",function(){return W});class W{constructor(ea,R,Y){this.aTb=null;this.QF={};this.QTb=this.fr=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=ea;this.L8d=W.i9c;this.M8d=W.borderStyleSolidLine;this.Zg=R;this.Xa=Y;w.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||
this.$.da.Ha(296,this);this.BU=new E(this.$,this.Zg);this.gD=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get YIa(){return this.M8d}get p3(){return this.L8d}get cua(){return this.QTb}get themesManager(){this.fr||(Object(N.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")?this.fr=J.a.gK(O.R):this.fr=this.$.da.Ba(422));return this.fr}fbf(ea,R){c.ULS.sendTraceTag(537159564,
0,50,`HandleBorderCommand : Begin handling, Command being executed: ${R.command.toString()}`);const Y={},U={};var da=l.a.rH(this.p3,!1);U.Color=[da,da,da,da];this.gD&&this.cua&&(U.ThemeBorderColor=[this.cua,this.cua,this.cua,this.cua],U.ColorTypeOption=1);ea=-600086683===R.command?"OutsideBorders":ea[d.a.Pc];U.LineStyle=k.a.Ic(W.nQf,ea);U.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${ea}`):(da=W.j0a[this.YIa].Bze,
U.LineStyle=[da,da,da,da],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.YIa}`));da=k.a.hq(W.WZg,ea,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${ea}, the border color selected is ${this.p3}`);Y.BorderFormat=U;4!==da&&8!==da||!this.$.na.displayRtl||(da=4===da?8:4);Y.ValidMembers=128;Y.Border=da;this.Zg.formatCells(-1690267012,
Y,R);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${R.command.toString()}`);return!0}Rld(ea,R,Y){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${ea.toString()} is being executed, the previous border color is ${this.p3}`);if(this.gD){if((R.SqmControlId||"").includes("ThemeColorPicker")){let U,da;({themeIndex:U,nCa:da}=this.themesManager.getThemeColor(R.Color)).returnValue?(this.QTb={},this.cua.ThemeColorIndex=U,this.cua.ThemeColorRow=da):this.QTb=
null}else this.QTb=null;this.BU.k0a=this.cua}this.L8d=-1803452024===ea?W.i9c:R.Color;this.BU.borderColor=this.p3;this.oRe(Y);this.$.tf();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${ea.toString()} is being executed, the updated border color is ${this.p3}`);return!0}zdi(ea){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const R=this.Xa.Bq();var Y=this.Xa.Jc();R.uc.push(Y);const U=this.Xa.HC("StyleDashGallery",1,"Size120by20");Y.buttons.push(U);Y=
W.j0a;for(let da in Y){const T=da,ka=Y[da],L=n.a.instance.ga(ka.d3b);U.hu(T,-2118943501,"QueryBorderStyle",ka.d3b,T,T,void 0,void 0,L)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");ea.MenuItems=R.AE();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}Qbi(ea,R){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.YIa}`);ea=ea[d.a.Pc];if(W.AAi(ea))this.M8d=ea,c.ULS.sendTraceTag(537159554,0,50,
`RibbonCommand.BorderStyle: Updated Border Style is ${this.YIa}`);else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${ea}`),!0;this.BU.borderStyle=this.YIa;this.oRe(R);this.$.tf();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.YIa}`);return!0}Wld(ea){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${ea.command.toString()}`);
this.$Wc(ea,64,this.p3,110,1);return!0}Xld(ea){c.ULS.sendTraceTag(537159523,0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${ea.command.toString()}`);this.$Wc(ea,112,this.p3,111,2);return!0}vbf(ea){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${ea.command.toString()}`);this.$Wc(ea,112,"white",112,3);return!0}Fdi(ea){this.hEj(this.YZg,ea,ea.MenuItemId?ea.MenuItemId:W.borderStyleSolidLine)}hEj(ea,R,Y){Y in ea?(ea=
ea[Y],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${Y}`),this.jEj(R,ea)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${Y}' in BorderLineStyleButtons dictionary`)}Qdi(ea,R){const Y=ea[d.a.Pc];return"DrawBorder"===Y?this.Wld(R):"DrawBorderGrid"===Y?this.Xld(R):"EraseBorder"===Y?this.vbf(R):this.fbf(ea,R)}UWf(){this.aTb||this.a0g()}DTh(){return new u(this)}get YZg(){this.UWf();return this.aTb}a0g(){this.aTb={};let ea=0;const R=
W.j0a;for(let Y in R){const U=R[Y],da=U.Cze;n.a.instance.ga(U.d3b);this.aTb[da]=da;this.Mcb(da,()=>appChrome.buildBorderStyleIconNew(U.eUj,U.width,U.nRi,U.lineHeight,U.qEi));ea++}}Mcb(ea,R){if(!(ea in this.QF)){const Y={};R=R();Y[ea]=R;appChrome.api.registerIconProvider(()=>Y);this.QF[ea]=!0}return ea}jEj(ea,R){ea.MenuItemId&&(ea[b.a.On]=ea.MenuItemId===this.YIa,ea[e.a.Icon]=R)}$Wc(ea,R,Y,U,da){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");
this.Y6g(ea,da)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.BU.n0()):(P.h(this.$).pz&&this.BU.n0(),h.a.current&&(U=String.format(f.a.iua,h.a.current.Un(U)),P.h(this.$).Ng.Ap(U)),this.BU.f3b=R,this.BU.borderColor=Y,P.h(this.$).pz=!0,this.BU.uKg(ea),this.BU.Gua=da)}oRe(ea){if(ea)switch(this.BU.Gua){case 2:this.Xld(ea);break;default:this.Wld(ea)}}Y6g(ea,R){return this.BU.Gua===R&&-236759591!==ea.command&&-2118943501!==
ea.command?!0:!1}static get j0a(){return W.X6d||(W.X6d={["BorderStyleSolidLine"]:x.Z_g(),["BorderStyleDashedLine"]:x.V_g(),["BorderStyleDottedLine"]:x.W_g(),["BorderStyleMediumLine"]:x.Y_g(),["BorderStyleThickLine"]:x.$_g(),["BorderStyleDoubleLine"]:x.X_g()})}static get WZg(){return W.W6d||(W.W6d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,
["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get nQf(){return W.Lie||(W.Lie={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:W.Enh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static AAi(ea){return ea?ea in W.nQf||ea in W.j0a:!1}}W.W6d=null;W.X6d=null;W.Lie=null;W.i9c="black";W.borderStyleSolidLine=
"BorderStyleSolidLine";W.Enh=[1,1,1,1];Object(r.a)(W,"BorderFormatManager",null,[413])},860:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{}c.edit="Edit";c.clipboard="Clipboard";c.copy="Copy";c.color="Color";c.fYg="AutoFill";c.Xvj="RowOperations";c.i$g="ColumnOperations";c.Q$j="ViewModeRowOperations";c.P$j="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.vIj="ShapeStyle";c.pMh="FloatingObjectClipboard";c.lPf="PivotTableCopyDelete";c.nPf="PivotTableFieldListActions";
c.TCe="CellFloatie";c.rIj="ShapeFloatie";c.contextMenu="ContextMenu";c.cbi="GridContextMenu";c.a$i="PivotTableContextMenu";c.qMh="FloatingObjectContextMenu";c.b6g="CellRTEFloatie";c.R9f="ShapeRTEFloatie";Object(r.a)(c,"FloatieGroupIdentifiers",null,[])},861:function(r,B,a){a.d(B,"a",function(){return k});r=a(0);var c=a(91),b=a(229),e=a(13),f=a(243);B=a(242);var d=a(12),h=a(77),l=a(21);class k extends B.a{constructor(w,n,x){super(n);this.Mmc=this.oR=!1;this.An=this._selectedRowListBox=this.vOa=null;
this.YGf=m=>this.onItemClick(m);this.ZEd=m=>{h.g(m.Ea);this.raiseEvent(k.S5a);this.raiseEvent(k.CSd);return!0};this.onScroll=m=>{h.g(m);this.vKd();this.raiseEvent(k.S5a)};this.onBlur=m=>{h.g(m);this.vKd()};this.onPointerDown=()=>{this.vKd();this.raiseEvent(k.S5a);this.raiseEvent(k.Xza);return!1};this.lHb=m=>{const u=m.Ea;if(u.button===Sys.UI.MouseButton.leftButton||u.button===Sys.UI.MouseButton.rightButton||u.type.includes("touch"))this.Jj=this.Tcc(u),this.onPointerDown(m);this.raiseEvent(k.Ivd);
return!1};this.mb=w;this.tEb=x;this.YBa(!0)}O9(w){this.get_events().addHandler(k.S5a,w)}Qda(w){this.get_events().removeHandler(k.S5a,w)}J0b(w){this.get_events().addHandler(k.uod,w)}Ovc(w){this.get_events().removeHandler(k.uod,w)}xpb(w){this.get_events().addHandler(k.CSd,w)}aLb(w){this.get_events().removeHandler(k.CSd,w)}upb(w){this.get_events().addHandler(k.Xza,w)}YKb(w){this.get_events().removeHandler(k.Xza,w)}LYc(w){this.get_events().addHandler(k.Ivd,w)}CNd(w){this.get_events().removeHandler(k.Ivd,
w)}get Jj(){return this._selectedRowListBox}set Jj(w){this.sCa(this._selectedRowListBox);w?(this._selectedRowListBox=w,this.sCa(this._selectedRowListBox),this.cyc(w)):this._selectedRowListBox=null}get LV(){return this.tEb.ListCellClass}get N5(){return this.tEb.ListTableClass}get bI(){return 8}get qFb(){return 5}get Lmc(){return 24}get Kmc(){return 35}get Nf(){return this.domElement}get $(){return this.mb}dispose(){this.N7(!1);this.YBa(!1);c.a.sc([this.vOa]);this.vOa=null;super.dispose()}Tcc(w){return d.DOMElementExtensions.Thd(w.target,
"tr",!0)}jB(w){if(w){if(!this.Jj){var n=this.An;if(!n||!n.rows.length)return;this.Jj=n.rows[0];0<w?w--:w++}n=this.Jj;for(let x=0,m=Math.abs(w);x<m;x++)if(0>w){if(!n.previousSibling)break;n=n.previousSibling}else{if(!n.nextSibling)break;n=n.nextSibling}n&&(this.Jj=n)}}apb(w,n){d.DOMElementExtensions.toggleCssClass(w,this.tEb.ListTableClassInTouch,n)}N7(w){const n=this.An;n&&(w&&!this.Mmc?(b.a.instance.ta(e.a.click,n,this.YGf),b.a.instance.ta(e.a.yk,n,this.ZEd),f.a.instance.ta(e.a.pointerDown,n,this.lHb),
this.Mmc=!0):this.Mmc&&(b.a.instance.Aa(e.a.click,n,this.YGf),b.a.instance.Aa(e.a.yk,n,this.ZEd),f.a.instance.Aa(e.a.pointerDown,n,this.lHb),this.Mmc=!1))}sCa(w){let n=null;w&&(n=d.DOMElementExtensions.hk(w,this.tEb.ListCellClass))&&n.classList.toggle(this.tEb.ListCellSelectedClass);return n}YBa(w){this.Nf&&(w&&!this.oR?(this.vOa=this.Fe.qe(this.Nf),this.vOa.la("scroll",this.onScroll),this.vOa.la("blur",this.onBlur),f.a.instance.ta(e.a.pointerDown,this.domElement,this.onPointerDown),this.oR=!0):this.oR&&
(c.a.Ja(this.vOa),this.vOa=null,f.a.instance.Aa(e.a.pointerDown,this.domElement,this.onPointerDown),this.oR=!1))}onItemClick(w){return this.ZEd(w)}cyc(w){if(w){var n=w.offsetTop,x=this.Nf.scrollTop;n<x?this.B4f(!0):n+w.offsetHeight>x+this.Nf.clientHeight&&this.B4f(!1)}}B4f(w){this.Nf.scrollTop=w?this.Jj.offsetTop:this.Jj.offsetTop+this.Jj.offsetHeight-this.Nf.clientHeight}vKd(){l.h(this.$).eb&&this.raiseEvent(k.uod)}}k.S5a="GotFocus";k.uod="IgnoreBlur";k.CSd="SetCell";k.Xza="PointerDown";k.Ivd="ItemPointerDown";
Object(r.a)(k,"ListBox",B.a,[305,3])},934:function(r,B,a){a.d(B,"a",function(){return b});r=a(0);var c=a(22);class b{compare(e,f){return c.a.compare(e,f,!0)}}Object(r.a)(b,"IgnoreCaseComparer",null,[333])},935:function(r,B,a){a.d(B,"a",function(){return f});r=a(0);var c=a(24),b=a(11),e=a(184);class f{constructor(d){this.Ca=d}eNb(d,h,l){const k=h.Border;h=h.BorderFormat;let w=0,n=!1;if(0===k)d.cell.Tcb(),this.uKb(d.cell.getRange());else{for(let x=0;3>=x;x++)f.HJj(d,l,x,k)&&(w|=b.HelperMethods.T4a(x),
this.s1d(d.cell.getRange(),x,h),n=!0);b.HelperMethods.$Q(k,16)&&!e.c(d,0,l)&&(w|=2,this.s1d(d.cell.getRange(),0,h),n=!0);b.HelperMethods.$Q(k,32)&&!e.c(d,2,l)&&(w|=4,this.s1d(d.cell.getRange(),2,h),n=!0);n&&(l=d.cell.zv.Be,b.HelperMethods.$Q(w,2)&&this.hag(d,l,0)&&(w&=-3),b.HelperMethods.$Q(w,1)&&this.gag(d,l,1)&&(w&=-2),b.HelperMethods.$Q(w,4)&&this.hag(d,l,2)&&(w&=-5),b.HelperMethods.$Q(w,8)&&this.gag(d,l,3)&&(w&=-9),d.cell.setBorders(h,w,!1))}}zQ(d,h){d=f.$1e(d,h);return d.wz?(d=this.Ca.Tja(d))&&
d.length?d:null:null}uKb(d){for(let l=0;3>=l;l++){var h=f.$1e(d,l);if(!h.wz)continue;h=this.Ca.Tja(h);if(!h||!h.length)continue;const k=f.x7e(l);for(let w=0;w<h.length;w++)h[w].jRa(k)}}s1d(d,h,l){if(d=this.zQ(d,h)){var k=f.x7e(h),w=b.HelperMethods.T4a(k);for(let n=0;n<d.length;n++){const x=d[n];this.zqi(x,k)&&f.setBorders(x,l,w,h,k)}}}zqi(d,h){const l=d.zv.Be;var k=d.getRange();k=this.zQ(k,h);let w=!1,n=!1,x=!1,m=!1;k&&(w=f.Z7a(k,!0),n=f.Z7a(k,!1),m=f.Rsd(k),x=1===k.length?!0:!1);switch(h){case 0:return f.Lpi(d,
l,m,n,x);case 1:return f.Hpi(d,l,m,w,x);case 2:return f.Ipi(d,l,m,w,x);case 3:return f.Jpi(d,l,m,n,x)}return!1}hag(d,h,l){if(!d.cell.sz)return!1;const k=d.range,w=this.zQ(k,l),n=e.c(d,l,h);let x=!1;h=0===l?k.top<h.top:k.left<h.left;!f.iCb(d.cell)&&w&&1!==w.length&&(x=(0===l?f.Z7a(w,!0):f.Z7a(w,!1))?!1:!0);return!n&&x||h?!0:!1}gag(d,h,l){const k=d.cell,w=this.zQ(k.getRange(),l);d=e.c(d,l,h);h=!1;if(w){const x=f.Z7a(w,!0);var n=f.Z7a(w,!1);const m=x&&!n;n=n&&!x;1!==l||f.kDb(k)?3!==l||f.XBb(k)||f.OJj(k,
w,n,m)&&(h=!0):f.NJj(k,w,x,n)&&(h=!0)}return!d&&h||f.iCb(k)?!0:!1}static U_g(d,h,l){const k={};k.LineStyle=Array(4);k.LineStyle[l]=d.LineStyle[h];k.Color=Array(4);k.Color[l]=d.Color[h];return k}static Yif(d,h,l,k,w){return b.HelperMethods.$Q(d,w)&&e.c(h,l,k)}static HJj(d,h,l,k){return f.Yif(k,d,l,h,b.HelperMethods.T4a(l))||f.Yif(k,d,l,h,64)||112===k}static setBorders(d,h,l,k,w){h=f.U_g(h,k,w);d.setBorders(h,l,!1)}static $1e(d,h){switch(h){case 0:return new c.Range(d.top-1,d.left,d.top-1,d.right,!1,
!1);case 2:return new c.Range(d.top,d.left-1,d.bottom,d.left-1,!1,!1);case 1:return new c.Range(d.bottom+1,d.left,d.bottom+1,d.right,!1,!1);case 3:return new c.Range(d.top,d.right+1,d.bottom,d.right+1,!1,!1)}return d}static x7e(d){switch(d){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static Z7a(d,h){for(let l=0;l<d.length;l++){const k=d[l];if(k.sz)return h?f.XBb(k):f.kDb(k)}return!1}static iCb(d){const h=d.zv.Be,l=d.getRange();return d.sz&&(l.top<h.top||l.bottom>h.bottom||l.left<
h.left||l.right>h.right)?!0:!1}static Rsd(d){for(let h=0;h<d.length;h++)if(f.iCb(d[h]))return!0;return!1}static NJj(d,h,l,k){if(!d.sz){if(!l||f.Rsd(h))return!0}else if(f.XBb(d)&&(1===h.length&&f.hWg(d,h[0])||!l))return!0;return k}static OJj(d,h,l,k){if(!d.sz){if(!l||f.Rsd(h))return!0}else if(f.kDb(d)&&(1===h.length&&f.iWg(d,h[0])||!l))return!0;return d.bca||k}static Lpi(d,h,l,k,w){const n=d.getRange();return f.XBb(d)?f.iCb(d)||w:h.top===n.top||!k||l}static Hpi(d,h,l,k,w){const n=d.getRange();return f.XBb(d)?
h.bottom===n.bottom&&w:k&&!l||h.bottom===n.bottom}static Ipi(d,h,l,k,w){const n=d.getRange();return f.kDb(d)?f.iCb(d)||w:h.left===n.left||!k||l}static Jpi(d,h,l,k,w){const n=d.getRange();return d.bca?!1:f.kDb(d)?h.right===n.right&&w:k&&!l||h.right===n.right}static XBb(d){return 0<d.getRange().right-d.getRange().left}static kDb(d){return 0<d.getRange().bottom-d.getRange().top}static iWg(d,h){d=d.getRange();h=h.getRange();return d.top===h.top&&d.bottom===h.bottom}static hWg(d,h){d=d.getRange();h=h.getRange();
return d.left===h.left&&d.right===h.right}}Object(r.a)(f,"BorderModelAccessorHelper",null,[])},937:function(r,B,a){a.d(B,"a",function(){return d});r=a(0);var c=a(91);B=a(99);var b=a(49),e=a(45),f=a(77);class d extends B.a{constructor(h,l){super(l.textBox.domElement);this.k0c=null;this.PSi=()=>{this.CDd()};this.HEf=(k,w)=>{this.dg(k,w)};this.LEf=(k,w)=>{this.Di(k,w)};this.mb=h;this.XI=l;l.J2&&(l.J2.add(this),l.gl(this.LEf),l.rm(this.HEf))}get $(){return this.mb}get gb(){return this.XI}dispose(){const h=
this.XI;if(null===h||void 0===h?0:h.J2)h.J2.remove(this),h.Zk(this.LEf),h.dm(this.HEf);c.a.Ja(this.k0c);this.XI=null;super.dispose()}Wh(h,l){switch(l){case -1470715894:case -1231471547:this.JY(!1);break;default:if(this.ZJd(h,l))return f.g(h),!0;d.Mvi(l)||this.JY(!1)}return!1}JY(){c.a.Ja(this.k0c);this.k0c=b.a.instance.create(this.PSi,10,e.a.xEi)}Di(){this.JY(!1)}static Mvi(h){switch(h){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(r.a)(d,"ListAutoCompleteBehavior",
B.a,[308,3])},973:function(r,B,a){function c(d,h,l){return{name:d,dataType:1,value:h,classification:l?l:4}}a.d(B,"a",function(){return b});a.d(B,"c",function(){return e});a.d(B,"b",function(){return f});r=[{name:"featureNameField",dataType:0,value:"FormulaSmartSuggestions",classification:4},{name:"ver",dataType:0,value:"1.0.0",classification:4}];B={dataCategories:2,samplingPolicy:1,diagnosticLevel:100};const b={eventName:"Office.Excel.FormulaSmartSuggestions.Seen",eventFlags:B,dataFields:[...r,c("isFeatureSeen",
!0)]},e={eventName:"Office.Excel.FormulaSmartSuggestions.Tried",eventFlags:B,dataFields:[...r,c("isFeatureTried",!0)]},f={eventName:"Office.Excel.FormulaSmartSuggestions.Succeeded",eventFlags:B,dataFields:[...r,c("isFeatureSucceeded",!0)]}}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/05d03fd0d6c25f460d52dd0cbe809e05/EwaDSEsNext.kpae.js.map