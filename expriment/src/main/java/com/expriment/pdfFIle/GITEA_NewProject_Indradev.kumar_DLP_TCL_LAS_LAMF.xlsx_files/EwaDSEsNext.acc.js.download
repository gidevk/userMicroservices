'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1157:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1158:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1159:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".ewa-svg-icon{height:100%;width:100%}")}},1160:function(r,B,a){function c(k,w){this.ID=k;this.type=w}function b(k,w){this.value=k;this.contextId=w}function e(k,w,n,x,m,u,t,y){this.type=k;this.startTime=null==n||void 0==n.value?new b(n,null):n;this.endTime=null==x||void 0==x.value?new b(x,null):x;null!=m&&void 0!=m.value||new b(m,null);null!=u&&void 0!=u.value||new b(u,null);this.operationType=y}function f(k){this.ID=
k}function d(){this.Ze=[];this.Tpb=[];this.YZc=0;this.duration=this.startTime=null;this.Z9b={};this.mAd=this.SAd=this.w0c=-1}function h(k){var w;return(null!=document.body.style.msTransform?w=k.style.msTransform:null!=document.body.style.webkitTransform?w=k.style.webkitTransform:null!=document.body.style.mozTransform?w=k.style.Odk:null!=document.body.style.oTransform?w=k.style.Sdk:null!=document.body.style.transform&&(w=k.style.transform),w)?(w=w.replace("rotate(",""),w=w.replace("deg)",""),parseFloat(w)):
0}a.d(B,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);e.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),oek:new b(0,null),rdk:new b(0,null),operationType:0};r=Array(1);r[0]=new b(0,0);new f(0,[new e(5,0,0,0,null,1,1,0)]);new f(1,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0)]);new f(2,[new e(1,3,0,167,null,0,1,1),new e(2,3,0,167,null,0,1,1)]);new f(3,[new e(3,3,0,167,null,0,1,1),new e(4,3,0,167,null,0,1,1)]);new f(4,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,167,null,1,1,0)]);new f(5,[new e(5,2,0,167,null,
0,1,0)]);new f(6,[new e(1,3,0,100,null,0,1,1),new e(2,3,0,100,null,0,1,1)]);new f(7,[new e(3,3,0,100,null,0,1,1),new e(4,3,0,100,null,0,1,1)]);new f(8,[new e(5,2,0,100,null,1,1,0)]);new f(9,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,1,1,0)]);new f(10,[new e(5,2,0,100,null,0,1,0)]);new f(11,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(12,[new e(3,3,0,267,null,0,1,1),new e(4,3,0,267,null,0,1,1)]);new f(13,[new e(5,2,0,267,null,1,1,0)]);new f(14,[new e(5,2,0,0,null,0,2,0),new e(5,
2,0,267,null,1,1,0)]);new f(15,[new e(5,2,0,267,null,0,1,0)]);new f(16,[new e(6,3,0,267,null,0,1,1),new e(7,3,0,267,null,0,1,1)]);new f(17,[new e(1,3,0,750,null,0,1,1),new e(2,3,0,750,null,0,1,1)]);new f(18,[new e(3,3,0,750,null,0,1,1),new e(4,3,0,750,null,0,1,1)]);new f(19,[new e(5,2,0,750,null,1,1,0)]);new f(20,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,750,null,1,1,0)]);new f(21,[new e(6,3,0,1E3,null,0,1,1),new e(7,3,0,1E3,null,0,1,1)]);new f(22,[new e(1,3,0,367,null,0,1,1),new e(2,3,0,367,null,0,
1,1)]);new f(23,[new e(3,3,0,367,null,0,1,1),new e(4,3,0,367,null,0,1,1)]);new f(24,[new e(5,2,0,367,null,1,1,0)]);new f(25,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,367,null,1,1,0)]);new f(26,[new e(5,2,0,367,null,0,1,0)]);new f(27,[new e(6,2,0,r[0],null,0,1,1),new e(7,2,0,r[0],null,0,1,1)]);new f(28,[new e(5,2,0,0,null,1,1,0),new e(5,2,0,50,null,0,1,0)]);new f(29,[new e(1,3,0,433,null,0,1,1),new e(2,3,0,433,null,0,1,1)]);new f(30,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0),new e(2,3,0,0,
null,40,1,1),new e(2,3,0,100,null,0,1,1)]);new f(31,[new e(2,0,0,0,null,32,1,1),new e(2,0,0,100,null,32,1,1),new e(2,3,101,350,null,0,1,1),new e(3,0,0,0,null,0,2,1),new e(3,0,0,100,null,0,2,1),new e(3,3,101,350,null,0,1,1),new e(5,0,0,0,null,0,2,0),new e(5,0,0,100,null,1,1,0)]);new f(32,[new e(2,3,0,267,null,32,1,1),new e(3,3,0,267,null,0,2,1),new e(5,2,0,0,null,1,0,0),new e(5,2,0,267,null,0,2,0)]);new f(33,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,0,2,0),new e(5,2,101,267,null,1,1,0)]);new f(34,
[new e(1,10,0,300,null,0,1,1),new e(2,10,0,300,null,0,1,1)]);new f(35,[new e(3,10,0,300,null,0,1,1),new e(4,10,0,300,null,0,1,1)]);new f(36,[new e(1,8,0,750,null,0,1,1),new e(2,8,0,750,null,0,1,1)]);new f(37,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,200,null,0,2,0),new e(5,3,201,500,null,1,1,0)]);new f(38,[new e(1,2,0,0,null,0,2,1),new e(2,2,0,0,null,0,2,1),new e(1,2,0,200,null,0,2,1),new e(2,2,0,200,null,0,2,1),new e(1,3,201,267,null,0,1,1),new e(2,3,201,267,null,0,1,1)]);new f(39,[new e(1,3,0,267,
null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(40,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(41,[new e(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(k){window.setTimeout(k,16)}}();d.prototype={Ze:null,AUg:5,Tpb:null,YZc:0,startTime:null,
duration:null,Z9b:null,w0c:-1,SAd:-1,mAd:-1};d.prototype.Start=function(){this.startTime=new Date;this.Z9b={}};d.prototype.GetRecentAnimationStats=function(){var k,w=[],n=0;for(k=l.YZc;k<l.AUg;k++)null!=l.Tpb[k]&&(w[n]=l.Tpb[k],n++);for(k=0;k<l.YZc;k++)null!=l.Tpb[k]&&(w[n]=l.Tpb[k],n++);return w};d.prototype.GetAnimationSqmStats=function(){var k=[];return k[0]=0>l.w0c?0:l.w0c,k[1]=0>l.SAd?0:l.SAd,k[2]=0>l.mAd?0:l.mAd,k};var l=new d},1161:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);
const b=()=>{c.a.ni(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1177:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(39);class f extends e.a{constructor(F){super();F.da.Ha(376,this)}iSg(F){this.addHandler("TAF",F)}qqj(F){this.removeHandler("TAF",F)}wfj(){this.raiseEvent("TAF")}}Object(r.a)(f,"GridHighlightBehaviorEventManager",e.a,[385,3]);class d extends b.a{constructor(F){super();this.$=F;this.Gb()}create(){this.qb(this.$.da.Ba(376)||new f(this.$))}static la(F){F.da.Ha(377,new d(F))}}Object(r.a)(d,"GridHighlightBehaviorEventManagerFactory",b.a,[]);var h=
a(50),l=a(38),k=a(27),w=a(84),n=a(15),x=a(243),m=a(13),u=a(166),t=a(5),y=a(121),v=a(12);class A extends Sys.EventArgs{constructor(F,na){super();this.start=F;this.P6a=na}}Object(r.a)(A,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var z=a(33);class C extends e.a{constructor(F){super();this.Rnc=[3];this.Tqa=void 0;this.gridView=F;this.ekg=z.a.LH(this.gridView.$);this.bN=z.a.LH(this.gridView.$)}get coloredReferencesManager(){const F=this.gridView.$.da.Ba(281);F||n.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return F}get SA(){if(this.Tqa)return this.Tqa;const F=this.gridView.$.da.Ba(464);F||n.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
F.SA||n.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.Tqa=F.SA}LQg(F){this.addHandler("mrek",F)}XN(F,na,hb){for(const Ib of this.gridView.Cn)x.a.instance.ta(m.a.mk,Ib.domElement,F);x.a.instance.ta(m.a.Of,document.documentElement,na);this.gridView.oc.f$b(!0);hb&&x.a.instance.ta(m.a.sB,this.gridView.zj,na)}d1d(F,na,hb){for(const Ib of this.gridView.Cn)x.a.instance.Aa(m.a.mk,Ib.domElement,F);x.a.instance.Aa(m.a.Of,document.documentElement,
na);this.gridView.oc.f$b(!1);hb&&x.a.instance.Aa(m.a.sB,this.gridView.zj,na)}wkj(F,na){for(const hb of this.gridView.Cn)u.a.instance.ta(m.a.mg,hb.domElement,F);u.a.instance.ta(m.a.Ae,document.documentElement,na)}K2j(F,na){for(const hb of this.gridView.Cn)u.a.instance.Aa(m.a.mg,hb.domElement,F);u.a.instance.Aa(m.a.Ae,document.documentElement,na)}W6c(F,na,hb,Ib){const vc=document.createElement("div");vc.className=na;for(const nc of hb)vc.classList.add(nc);F.appendChild(vc);x.a.instance.ta(m.a.pointerDown,
vc,Ib);return vc}h9e(F){F=F.Ob.parentNode;if(!F)return n.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;F=parseInt(F.getAttribute(t.a.P6a),10);return isNaN(F)?(n.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Eb.WC(3,1,F)}zNb(F,na,hb=!0){F=hb&&(this.bN?!!this.SA&&this.SA.jvi(F):!!this.coloredReferencesManager&&
this.coloredReferencesManager.ivi(F));for(const Ib of na)v.DOMElementExtensions.setVisible(Ib,F)}xcc(){return this.gridView.Ul?y.a(this.gridView.$):this.gridView.Xb}nVf(){if(this.bN){var F=this.xcc();F&&this.SA?this.ekg?F.VD(null):this.SA.Rgb(F,null):(n.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Eb.Tj(this.Rnc),this.gridView.Eb.Bk(null,this.Rnc))}else this.gij()}gij(){const F=
this.xcc();F&&this.coloredReferencesManager?this.ekg?F.VD(null):this.coloredReferencesManager.VD(F,null):(n.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Eb.Tj(this.Rnc),this.gridView.Eb.Bk(null,this.Rnc))}vTf(F,na){this.raiseEvent("mrek",new A(F,na))}}Object(r.a)(C,"BehaviorHelperMethods",e.a,[]);var H=a(91),I=a(41);e=a(99);class S extends e.a{constructor(F,na=null){super(F,
na)}c_a(){}}Object(r.a)(S,"HighlightFlyweightBehavior",e.a,[]);var P=a(18),D=a(465),G=a(73),E=a(11),O=a(120),N=a(229),J=a(47);e=a(242);var W=a(8),ea=a(76),R=a(1),Y=a(35);class U extends e.a{constructor(F,na,hb){super(document.createElement("div"));this.L7b=null;this.SRb=!1;this.onPointerDown=Ib=>{Ib=Y.a(this.$)?Y.a(this.$).ve(Ib):Ib;this.SRb=!1;if(3===(G.a.zb=Ib.wb)){const vc=Ib.Ea.rawEvent,nc=vc.srcElement||vc.target;v.DOMElementExtensions.Df(this.domElement,nc)&&v.DOMElementExtensions.Df(vc.currentTarget,
nc)&&(this.SRb=!0,this.L7b=Ib.clientPoint)}return!1};this.fh=Ib=>{Ib=Y.a(this.$)?Y.a(this.$).ve(Ib):Ib;this.raiseEvent("GrPointerUp",Ib);return this.SRb=!1};this.aj=Ib=>{Ib=Y.a(this.$)?Y.a(this.$).ve(Ib):Ib;3===Ib.wb&&this.SRb&&this.Bfi(Ib.clientPoint)&&(this.raiseEvent("GrDrag"),this.SRb=!1);return!1};this.jd=Ib=>{Y.a(this.$)&&Y.a(this.$).ve(Ib);return!0};this.$=hb;hb=!R.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(hb?ea.a.eXe:ea.a.dXe);this.domElement.classList.add(ea.a.jac);
F.appendChild(this.domElement);v.DOMElementExtensions.setVisible(this.domElement,!1);this.WLa=document.createElement("div");this.WLa.classList.add(ea.a.iac);this.WLa.style.borderColor=na;this.domElement.appendChild(this.WLa);x.a.instance.ta(m.a.pointerDown,this.domElement,this.onPointerDown);x.a.instance.ta(m.a.Of,this.domElement,this.fh);u.a.instance.ta(m.a.Ae,this.domElement,this.fh);x.a.instance.ta(m.a.mk,this.domElement,this.aj);u.a.instance.ta(m.a.mg,this.domElement,this.aj);N.a.instance.ta(m.a.click,
this.domElement,this.jd)}Dse(F){this.addHandler("GrDrag",F)}ZYf(F){this.removeHandler("GrDrag",F)}Cse(F){this.addHandler("GrContxt",F)}YYf(F){this.removeHandler("GrContxt",F)}Ese(F){this.addHandler("GrPointerUp",F)}$Yf(F){this.removeHandler("GrPointerUp",F)}dispose(){J.a.yna(this.domElement);super.dispose()}Xmg(F){this.domElement.parentNode.removeChild(this.domElement);F.appendChild(this.domElement)}s6f(){this.domElement.classList.remove(ea.a.jac);this.WLa.classList.remove(ea.a.iac);this.WLa.classList.add(ea.a.fXe)}klg(){this.WLa.classList.remove(ea.a.fXe);
this.WLa.classList.add(ea.a.iac);this.domElement.classList.add(ea.a.jac)}Bfi(F){return!!this.L7b&&(3<Math.abs(F.x-this.L7b.x)||3<Math.abs(F.y-this.L7b.y))}static wxb(F){return R.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(F=Y.a(F.$)?Y.a(F.$).zoom:W.a.E_,Math.round(9/Math.max(F,1))):9}}U.Yzd=0;Object(r.a)(U,"TouchGrippie",e.a,[]);class da extends S{constructor(F,na,hb,Ib){super(na);this.cvd=this.w_c=this.gqb=!1;this.Drb=null;this.Sba=this.Yud=!1;this.Pw=()=>{this.gqb&&this.Yud?
this.Doa():this.C4()};this.tGf=nc=>{3===nc.wb&&(this.Yud=!0,this.Doa());return!1};this.uGf=nc=>{if(3===nc.wb){if(!nc.Ob||this.Ssi(nc))return!1;this.Yud=!1;this.C4()}return!1};this.gh=()=>{this.Sba&&this.h1d();this.Doa();this.cvd=!1};this.zr=()=>{this.C4();this.cvd=!0};this.Eza=(nc,Pb)=>{Pb.G4===this.G4&&(Pb.visible?this.cvd||this.Doa():this.C4())};this.bMf=()=>{this.vGf(this.MO.domElement,!1)};this.BCf=()=>{this.vGf(this.gM.domElement,!0)};this.Aqc=(nc,Pb)=>{this.ha.rAa(Pb)};this.Bqc=(nc,Pb)=>{this.ha.rAa(D.b(Pb))};
this.mHb=()=>{3===G.a.zb?this.Doa():this.C4();this.Sba&&1===G.a.zb&&this.h1d()};this.cMf=()=>{this.YBj()};this.pQe=()=>{this.C4()};this.Bn=()=>{this.ha.Sa.jc&&this.C4()};this.pCf=()=>{this.C4()};this.nGf=(nc,Pb)=>{this.h1d();3===Pb.wb?this.Doa():this.C4()};this.suc=()=>{this.gqb&&(this.C4(),this.Doa())};const vc=hb.$;this.Ns=hb;this.ha=hb.ha;this.Dba=F;this.Azj=na;this.paneType=Ib;F=this.domElement.currentStyle;na="#000000";F&&(na=F.borderTopColor);this.MO=new U(this.Udd(),na,vc);this.gM=new U(this.Udd(),
na,vc);this.Pmf=vc.ea.isNamedObjectViewMode&&1===vc.workbookContext.NovMode;this.MO.Dse(this.bMf);this.MO.Cse(this.Aqc);this.MO.Ese(this.Bqc);this.gM.Dse(this.BCf);this.gM.Cse(this.Aqc);this.gM.Ese(this.Bqc);for(const nc of this.gridView.Cn)u.a.instance.ta(m.a.uf,nc.domElement,this.uGf),u.a.instance.ta(m.a.Ae,nc.domElement,this.tGf);hb.view.Vs(this.Pw);hb.Xb.gl(this.pQe);hb.Eb.wpb(this.Eza);hb.wYc(this.pCf);vc.iC(this.suc);hb.ev(this.suc);this.ha.C2(this.gh);this.ha.R9(this.zr);hb.uE(this.Bn);this.ha.D0b(this.nGf);
G.a.Nse(this.mHb);l.TaskExtensions.za(h.GetServiceTaskFactory.Pa(vc.da,376,377,0),nc=>{nc.result.iSg(this.cMf)},vc.ka,3)}get gridView(){return this.Ns}dispose(){H.a.sc([this.MO,this.gM]);this.MO.ZYf(this.bMf);this.MO.YYf(this.Aqc);this.MO.$Yf(this.Bqc);this.gM.ZYf(this.BCf);this.gM.YYf(this.Aqc);this.gM.$Yf(this.Bqc);for(var F of this.gridView.Cn)u.a.instance.Aa(m.a.uf,F.domElement,this.uGf),u.a.instance.Aa(m.a.Ae,F.domElement,this.tGf);this.gridView.view.Xq(this.Pw);this.gridView.Xb.Zk(this.pQe);
this.gridView.Eb.$Kb(this.Eza);this.gridView.mNd(this.pCf);this.gridView.$.UF(this.suc);this.gridView.ty(this.suc);this.ha.j0(this.gh);this.ha.Tda(this.zr);this.gridView.VF(this.Bn);this.ha.Hvc(this.nGf);G.a.hZf(this.mHb);this.Sba&&n.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(F=this.gridView.$.da.Ba(376))&&F.qqj(this.cMf);super.dispose()}dTa(){if(!this.Dba.range||!this.Dba.range.equals(this.aeb))return!1;const F=!this.gridView.yNa();return this.gridView.eb&&
F&&(this.aeb.isRow||this.aeb.Fg)?!1:this.Sba?!0:3===G.a.zb}C4(){this.gqb&&(this.MO.set_visible(!1),this.gM.set_visible(!1),this.gqb=!1)}Doa(){if(this.dTa()){this.w6j();var F=v.DOMElementExtensions.getBoundingClientRect(this.Drb);F||n.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",this.gridView.$.ea.isNamedObjectViewMode,this.Pmf,this.w_c,this.gridView.zj,
this.gridView.jb.oj);var na=v.DOMElementExtensions.getBoundingClientRect(this.Azj),hb=new Sys.UI.Bounds(na.x-F.x,na.y-F.y,na.width,na.height),Ib=this.aeb,vc=Ib.topLeft,nc=Ib.bottomRight,Pb=Ib.isRow||Ib.Fg;if(Ib.Fg){var oc=this.YKh();Ib=hb.x-2*U.wxb(this.gridView);var Ic=oc;var ec=hb.x+na.width}else Ib.isRow?(Ib=ec=this.XKh(),Ic=hb.y-2*U.wxb(this.gridView),oc=hb.y+na.height):(Ic=hb.y,oc=hb.y+na.height,this.gridView.rtl?(Ib=hb.x+na.width,ec=hb.x):(Ib=hb.x,ec=hb.x+na.width));na=U.Yzd+(Pb?0:U.wxb(this.gridView));
this.MO.style.left=E.HelperMethods.zc(Ib-na);this.MO.style.top=E.HelperMethods.zc(Ic-na);this.gM.style.left=E.HelperMethods.zc(ec-na);this.gM.style.top=E.HelperMethods.zc(oc-na);this.MO.set_visible(this.hlf(Ic,Ib,vc,Pb,F));this.gM.set_visible(this.hlf(oc,ec,nc,Pb,F));this.gqb=!0}}hlf(F,na,hb,Ib,vc){const nc=v.DOMElementExtensions.getBoundingClientRect(this.gridView.Vf(this.paneType).domElement);vc=new Sys.UI.Bounds(nc.x-vc.x-3,nc.y-vc.y-3,nc.width+6,nc.height+6);return(this.gridView.jb.Li(hb)===this.paneType||
Ib)&&I.a.cR(vc,new Sys.UI.Point(na,F))}w6j(){if(this.Pmf!==this.w_c){this.Drb=null;const F=this.Udd();this.MO.Xmg(F);this.gM.Xmg(F)}}YKh(){return(this.gridView.view.visibleArea.height+this.gridView.jb.height+U.Yzd-U.wxb(this.gridView))/2}XKh(){return(this.gridView.view.visibleArea.width+this.gridView.jb.width+U.Yzd-U.wxb(this.gridView))/2}pKf(){this.Doa()}Ssi(F){return v.DOMElementExtensions.WRa(F.Ob,P.a.vo)&&(this.Vti(F)||this.Wti(F))}Wti(F){if(this.gridView.rtl)F=F.clientPoint.x;else{const na=v.DOMElementExtensions.getBoundingClientRect(F.Ob);
F=F.clientPoint.x-(na.x+na.width-O.a.Ku)}return 0<F&&F<=O.a.Ku}Vti(F){const na=v.DOMElementExtensions.getBoundingClientRect(F.Ob);F=F.clientPoint.y-(na.y+na.height-O.a.Ku);return 0<F&&F<=O.a.Ku}vGf(F,na){this.Sba&&n.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.G2c(F,na,this.Sba);this.C4()}YBj(){this.Sba||(n.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Sba=!0,this.MO.s6f(),this.gM.s6f(),this.gridView.ha.sourceRange=
this.gridView.ha.ra.xd,this.Doa())}h1d(){this.Sba&&(n.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Sba=!1,this.MO.klg(),this.gM.klg())}Udd(){this.Drb||(this.w_c=!1,this.Drb=this.gridView.zj);return this.Drb}}Object(r.a)(da,"SelectionTouchGrippiesBehaviorBase",S,[]);class T extends da{constructor(F,na,hb,Ib){super(F,na,hb,Ib)}get G4(){return 19}get aeb(){return this.gridView.ha.ra.activeRange}dTa(){const F=this.gridView.ei||this.gridView.eb;return!this.gridView.ha.ra.eh&&
!F&&super.dTa()}}Object(r.a)(T,"DiscontinuousSelectionTouchGrippiesBehavior",da,[]);var ka=a(384);class L extends S{constructor(F){super(F);const na=document.createElement("div");na.className=ea.a.iGh;F.appendChild(na)}}Object(r.a)(L,"SelectionBorderBehavior",S,[]);class fa{}fa.Acd="ewr-selection-draghandle";fa.Bcd="ewr-selection-draghandle-grab";fa.bGh="ewr-selection-draghandle-top-ie";fa.cGh="ewr-selection-draghandle-top-ie-enhanced";fa.$Fh="ewr-selection-draghandle-top";fa.aGh="ewr-selection-draghandle-top-enhanced";
fa.QFh="ewr-selection-draghandle-bottom-ie";fa.RFh="ewr-selection-draghandle-bottom-ie-enhanced";fa.OFh="ewr-selection-draghandle-bottom";fa.PFh="ewr-selection-draghandle-bottom-enhanced";fa.UFh="ewr-selection-draghandle-left-ie";fa.VFh="ewr-selection-draghandle-left-ie-enhanced";fa.SFh="ewr-selection-draghandle-left";fa.TFh="ewr-selection-draghandle-left-enhanced";fa.YFh="ewr-selection-draghandle-right-ie";fa.ZFh="ewr-selection-draghandle-right-ie-enhanced";fa.WFh="ewr-selection-draghandle-right";
fa.XFh="ewr-selection-draghandle-right-enhanced";fa.dGh="ewr-selection-dragtooltip";fa.eGh="ewr-selection-dragtooltip-updated";fa.pGh="ewr_selection_rearrangeleft";fa.qGh="ewr_selection_rearrangeright";fa.rGh="ewr_selection_rearrangetop";fa.oGh="ewr_selection_rearrangebottom";fa.selecting="selecting";fa.sGh="ewr-selection-resizemarqueehandle";fa.vGh="ewr-selection-resizemarqueehandle-topleft";fa.wGh="ewr-selection-resizemarqueehandle-topright";fa.tGh="ewr-selection-resizemarqueehandle-bottomleft";
fa.uGh="ewr-selection-resizemarqueehandle-bottomright";fa.EFh="ewr-marquee-thick";fa.IFh="ewr-resizemarqueehandle-thick";Object(r.a)(fa,"CssClassNames",null,[]);var wa=a(258),oa=a(21);class xa extends L{constructor(F,na,hb,Ib){super(F);this.OTa=!1;this.ope=this.ppe=null;this.vsa=0;this.Sp=R.EwaSettings.getBooleanFeatureGate(ka.a.F9b,!1);this.qsi=R.EwaSettings.getBooleanFeatureGate(ka.a.Ssh,!1);this.r3d=this.Pnd=this.e3=0;this.lW=this.Ib=this.sourceRange=this.lna=null;this.fh=vc=>{vc=Y.a(this.$).ve(vc);
return this.aJf(vc)};this.onPointerDown=vc=>{vc=Y.a(this.$).ve(vc);if(R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)&&!this.hfb())return!1;if(2===vc.wb&&vc.Zn===Sys.UI.MouseButton.leftButton&&!this.OTa){var nc=this.kkd(vc);if(!nc)return n.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Ib=nc.clone();this.sourceRange=this.Ib.clone();this.lna=this.Ib;if(nc=this.W1h(vc))if(this.Rm=5,this.r3d=nc.top-
this.sourceRange.top,this.Pnd=nc.left-this.sourceRange.left,oa.h(this.$).Ng.Ap(this.Sp?xa.$ub:xa.JPe),this.yFd(vc),this.OTa=!0,wa.b(this.$,!0),R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))return!0}return!1};this.aj=vc=>{vc=Y.a(this.$).ve(vc);if(this.Sp&&this.zFd(vc))return!0;if(vc=this.ha.Zp(vc.clientPoint,vc.Ob,5,void 0,void 0,!0)){vc=this.Irb(vc);if(this.Ib.equals(vc))return!0;this.Ib=vc;if(!this.tS())return n.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.Jac(!0),!1}return!0};this.od=(vc,nc)=>{nc.jN||(R.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&!R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?this.CSa(this.$.isEditMode&&this.hfb()):this.CSa(this.$.isEditMode))};this.fz=[];this.$=na;this.ha=oa.h(this.$).ha;this.paneType=hb;this.oo=Ib;na=R.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.JRd=this.qsi?na?[fa.aGh,fa.PFh,fa.TFh,fa.XFh]:[fa.cGh,fa.RFh,
fa.VFh,fa.ZFh]:na?[fa.$Fh,fa.OFh,fa.SFh,fa.WFh]:[fa.bGh,fa.QFh,fa.UFh,fa.YFh];if(!R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))for(const vc of this.JRd)na=this.oo.W6c(F,vc,this.Sp?[fa.Bcd]:[fa.Acd],this.onPointerDown),this.fz.push(na);this.$.hl(this.od);R.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.CSa(this.$.isEditMode)}get Eb(){return oa.h(this.$).Eb}get Rm(){return this.ha.selectionType}set Rm(F){this.ha.selectionType=
F}dispose(){this.fz.forEach(F=>{x.a.instance.Aa(m.a.pointerDown,F,this.onPointerDown)});this.fz.length=0;this.lna=this.sourceRange=this.Ib=null;n.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.vsa}, EwaControl is null : ${!this.$}`);this.$&&(this.$.em(this.od),1===this.vsa&&(n.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.AJ(this.ope,this.ppe,!1)));super.dispose()}aJf(F){if(5!==
this.Rm)return!1;(F=this.JPa(F))||this.Jac(!1);wa.b(this.$,!1);return F}XN(F,na){n.ULS.shipAssertTag(537159377,0,!this.vsa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.vsa+=1;this.ope=F;this.ppe=na;this.oo.XN(F,na,this.d0d())}Irb(F){if(!F||!this.Ib)return n.ULS.shipAssertTag(537159376,0,!!F,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),n.ULS.shipAssertTag(537159375,0,!!this.Ib,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),
null;const na=this.Ib.clone();1!==this.e3&&(na.left=Math.max(F.left-this.Pnd,1),na.right=na.left+this.sourceRange.width-1);2!==this.e3&&(na.top=Math.max(F.top-this.r3d,1),na.bottom=na.top+this.sourceRange.height-1);return this.Jpb(na)}AJ(F,na,hb=!0,Ib=!0){n.ULS.shipAssertTag(537159374,0,1===this.vsa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.vsa;this.Sp||oa.h(this.$).Ng.Ap(t.a.gV);this.oo.d1d(F,na,this.d0d());hb&&this.gEe(Ib);this.e3=0;this.OTa=!1}Jpb(F){var na=
oa.h(this.$);let hb=F;if(na.jb.w4){if(!na.Jb(F.topLeft)){na=na.Qj("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",na.xQ,this.lna.top!==F.top?1:2);try{na.Lk=this.lna.top<F.top||this.lna.left<F.left,na.Iv(F.topLeft),hb=na.$$cu().range}finally{na&&na.dispose()}}hb.right=hb.left+F.width-1;hb.bottom=hb.top+F.height-1}return this.lna=hb}CSa(F){this.fz.forEach(na=>{v.DOMElementExtensions.setVisible(na,F)})}W1h(F){const na=F.Ob;F=F.clientPoint;if(!na||!F)return n.ULS.shipAssertTag(537159373,0,!!na,
"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),n.ULS.shipAssertTag(537159372,0,!!F,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;F.y+=na===this.fz[xa.I9b]?2:na===this.fz[xa.MPe]?-2:0;F.x+=na===this.fz[xa.OPe]?2:na===this.fz[xa.H9b]?-2:0;return this.ha.Zp(F,na,5,void 0,void 0,!0)}}xa.JPe="move";xa.p6c="copy";xa.$ub="grabbing";xa.I9b=0;xa.MPe=1;xa.OPe=2;xa.H9b=3;Object(r.a)(xa,"DragSelectionClickBehaviorBase",L,[]);class bb extends xa{constructor(F,
na,hb,Ib,vc,nc){super(F,na,hb,vc);this.gb=this.ZF=null;this.Ubf=()=>{this.Jac(!0)};if(R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))for(const Pb of this.JRd)na=this.oo.W6c(F,Pb,this.Sp?[fa.Bcd]:[fa.Acd],this.onPointerDown),this.fz.push(na);R.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.CSa(this.$.isEditMode);this.gridView=oa.h(this.$);this.BF=Ib;this.coloredReferencesManager=this.$.da.Ba(281);n.ULS.shipAssertTag(537159391,
0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.bN=z.a.LH(this.$))F=this.$.da.Ba(464),n.ULS.shipAssertTag(512312961,0,!!F,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.SA=F.SA;for(const Pb of this.fz)x.a.instance.ta(m.a.mW,Pb,this.BF.iff),x.a.instance.ta(m.a.sB,Pb,this.BF.jff);this.c_a(nc)}c_a(F){this.oo.zNb(F,
this.fz);this.BF.o0()}yFd(F){n.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.zMa=!0;this.gb.CE(!1);this.Rm=5;this.BF.QPe(F.Ob);this.gb.textBox.removeSelection();this.gb.M0b(this.Ubf);this.XN(this.aj,this.fh);this.e3=this.sourceRange.isRow?1:this.sourceRange.Fg?2:0}JPa(){const F=this.XW();this.Rm=-1;this.AJ(this.aj,this.fh);return F}gEe(){this.gridView.zMa=!1;this.BF.RPe(this.fz[0]);this.gb.textBox.setCaretPositionToEnd();
this.gb.Qvc(this.Ubf);this.oo.nVf()}Jac(F){n.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");F&&this.AJ(this.aj,this.fh)}kkd(F){this.gb=this.oo.xcc();this.ZF=this.oo.h9e(F);return this.gb&&this.ZF&&this.ZF.range?this.ZF.range:(n.ULS.shipAssertTag(537159388,0,!!this.gb,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),n.ULS.shipAssertTag(537159387,0,!!this.ZF,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),
n.ULS.shipAssertTag(537159386,0,!!this.ZF.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}XW(){return this.ZF?this.bN?this.SA.KFb(this.gb,this.ZF,this.Ib):this.coloredReferencesManager.KFb(this.gb,this.ZF,this.Ib):(n.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)}tS(){return this.XW()}d0d(){return!0}zFd(){return!1}hfb(){return!0}}
Object(r.a)(bb,"DragMarqueeClickBehavior",xa,[]);var Za=a(90),La=a(113),va=a(178),Ba=a(86),Ea=a(424),pa=a(729),$a=a(230),cb=a(29),ib=a(46);class ta extends xa{constructor(F,na,hb,Ib,vc){super(F,na,hb,vc);this.rr=null;this.Fg=this.isRow=!1;this.gh=()=>{this.domElement.classList.remove(fa.selecting)};this.zr=()=>{this.domElement.classList.add(fa.selecting)};this.Zc=()=>{if(this.$.isEditMode){const nc=this.hfb();this.CSa(nc)}};this.tableManager=Ib;if(R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1)){if(0===ta.m$c.length)for(const nc of this.JRd)na=document.createElement("div"),na.className=nc,na.classList.add(this.Sp?fa.Bcd:fa.Acd),ta.m$c.push(na);for(const nc of ta.m$c)F.appendChild(nc),x.a.instance.ta(m.a.pointerDown,nc,this.onPointerDown),this.fz.push(nc)}R.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&!R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?this.CSa(this.hfb()&&this.$.isEditMode):this.CSa(this.$.isEditMode);
this.hm={};this.oz=!1;this.ha.R9(this.zr);this.ha.C2(this.gh);R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)||this.ha.$L(this.Zc);this.a3d=R.EwaSettings.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.Tda(this.zr),this.ha.j0(this.gh),R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)||this.ha.NR(this.Zc),R.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||
this.ha.bwc(this.Eab));if(this.hm)for(let F=1;4>=F;F++)v.DOMElementExtensions.yf(this.hm[F.toString()]);this.hm=this.rr=null;super.dispose()}gEe(F){F&&(this.Sp&&oa.h(this.$).Ng.Ap(t.a.gV),La.KeyInputManager.instance.Aa(m.a.Vb,this.domElement.ownerDocument.body,this.onKeyDown),this.oz=!1);for(F=1;4>=F;F++){const na=this.hm[F.toString()];na&&na.parentNode.removeChild(na);this.hm[F.toString()]=null}this.rr=null}kkd(){return this.ha.ra.xd}XW(){this.ha.updateSelection(this.Ib,this.Ib.topLeft,0);return!0}tS(F=
!1){this.Eb.Bk(this.Ib,this.kba());this.Eb.$q(this.kba());this.FI(F);return!0}vpa(F=!1){this.Eb.Bk(this.Ib,this.rr);this.Eb.$q(this.rr);this.FI(F)}Jac(){n.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}d0d(){return!1}v7(F,na,hb,Ib,vc=!1){var nc=v.DOMElementExtensions.getBoundingClientRect(na);let Pb=na===this.fz[xa.I9b]||na===this.fz[xa.MPe];if(this.Sp){var oc=na===this.fz[xa.OPe]||na===this.fz[xa.H9b];
this.isRow&&oc||this.Fg&&Pb?oc="100px":(Pb=this.isRow||Pb,oc=(Pb?vc?ta.$Yj:ta.eZj:vc?ta.ZYj:ta.bZj)+"px");na=Pb?na===this.fz[xa.I9b]?"top":"bottom":na===this.fz[xa.H9b]?"right":"left";F=100*(Pb?F.x-nc.x:F.y-nc.y)/(Pb?nc.width:nc.height);for(nc=1;4>=nc;nc++){Ib=document.createElement("div");var Ic=document.createElement("div");const ec=document.createElement("div");Ib.appendChild(Ic);Ib.appendChild(ec);vc&&(Ic=document.createElement("div"),Ib.appendChild(Ic),ec.style.fontWeight="bold");Ib.className=
fa.eGh;this.hm[nc.toString()]=Ib;this.Eb.WC(hb,nc).kg.appendChild(Ib);Ib=this.hm[nc.toString()];Ib.style[na]=oc;Ib.style[Pb?"left":"top"]=F+"%"}}else for(vc=(Pb?-ta.dZj:-ta.aZj)+"px",oc=Pb?na===this.fz[xa.I9b]?"top":"bottom":na===this.fz[xa.H9b]||Ib?"right":"left",na=100*(Pb?Ib?0:F.x-nc.x:F.y-nc.y)/(Pb?nc.width:nc.height),F=1;4>=F;F++)nc=document.createElement("div"),nc.className=fa.dGh,this.hm[F.toString()]=nc,this.Eb.WC(hb,F).kg.appendChild(nc),nc=this.hm[F.toString()],nc.style[oc]=vc,nc.style[Pb?
"left":"top"]=na+"%"}Qmg(F,na,hb){const Ib=oa.h(this.$),vc=Ib.Eg(F);var nc=Ib.Vf(this.paneType);hb=pa.a.Qu(nc.view.ui,this.domElement.parentNode,hb,Ib.rtl);nc=!1;let Pb=2;na&&hb.y-vc.topLeft.y>vc.height/2?(nc=!0,Pb=1):!na&&hb.x-vc.topLeft.x>vc.width/2&&(nc=!0);if(nc){na=Ib.Qj("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Ib.xQ,Pb);try{na.Iv(F),na.$$mn(),na.$$cu()}finally{na&&na.dispose()}}}gsb(F){this.Eb.Tj(this.rr);this.AJ(this.Rma,this.Sma,void 0,F)}bU(F){this.Eb.Tj(this.kba());
this.AJ(this.aj,this.fh,void 0,F)}Jxb(){return this.Sp?48:6}kba(){return this.Sp?ta.Tsh:ta.Wsh}t7a(F){return F.Ea.keyCode===Za.a.Epa||k.a.isMac&&F.Ea.keyCode===Za.a.cVa}SAb(F){F=oa.h(this.$).getRangeInformation(F);for(let na=0,hb=F.length;na<hb;++na)if(Object(Ea.a)($a.PivotTableRange,F[na]))return F=cb.a.hd(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),ib.a(this.$).St([F]),!0;return!1}}ta.aZj=50;ta.dZj=25;ta.bZj=-85;ta.eZj=-40;ta.ZYj=-120;ta.$Yj=-50;ta.Wsh=[6];ta.Tsh=[48];ta.m$c=[];Object(r.a)(ta,
"DragSelectionClickBehaviorTemporary",xa,[]);var Ya=a(24),Da=a(801),ba=a(44),ya=a(198),V=a(117),Z=a(290),ja=a(63);const la=(F,na,hb,Ib,vc,nc,Pb,oc=null)=>{oc=F.Oa(41,oc);oc.sourceRange=na;oc.destinationRange=hb;return ja.g(F,"RearrangeRowColumn",oc,Ib,vc,nc,Pb,0)},ua=(F,na,hb,Ib,vc,nc,Pb=null)=>{Pb=F.Oa(1,Pb);Pb.moveRange=na;return ja.g(F,"MoveLineItems",Pb,hb,Ib,vc,nc,0)};class eb{constructor(F,na){this.destinationRange=this.sourceRange=null;this.sourceRange=F;this.destinationRange=na}}Object(r.a)(eb,
"MacroRecorderTableRowColumnRearrangedPayload",null,[123]);var Eb=a(14);class Wb extends ta{constructor(F,na,hb,Ib,vc){super(F,na,hb,Ib,vc);this.xea=null;this.jR=this.kR=!1;this.Sqf=0;this.HBa=this.Eua=null;this.KJ=0;this.J9b=Eb.a.instance.ga(2269);this.SPe=Eb.a.instance.ga(2270);this.fAc=Eb.a.instance.ga(2271);this.o$f=Eb.a.instance.ga(2272);this.onKeyDown=nc=>{if(this.Sp){if(this.t7a(nc)||nc.Ea.keyCode===Za.a.dVa)return this.sNa||(La.KeyInputManager.instance.ta(m.a.Qd,this.domElement.ownerDocument.body,
this.onKeyUp),this.sNa=!0),!this.YZ&&this.t7a(nc)&&(oa.h(this.$).Ng.Ap(xa.p6c),this.YZ=!0),this.ZZ||nc.Ea.keyCode!==Za.a.dVa||(oa.h(this.$).Ng.Ap(xa.$ub),this.ZZ=!0,2===this.KJ?(this.bU(!1),this.e3=0,this.rr=this.jR?[11]:[12],this.kR=this.jR,this.eMd(),this.vpa()):3===this.KJ?(this.fsb(!1),this.e3=this.isRow?1:2,this.una(),this.tS()):1===this.KJ&&(this.gsb(!1),this.una(),this.tS())),!0}else if(!this.YZ&&(nc.Ea.keyCode===Za.a.Epa||k.a.isMac&&nc.Ea.keyCode===Za.a.cVa))return La.KeyInputManager.instance.ta(m.a.Qd,
this.domElement.ownerDocument.body,this.onKeyUp),oa.h(this.$).Ng.Ap(xa.p6c),this.YZ=!0;return!1};this.onKeyUp=nc=>{if(this.Sp){if(this.t7a(nc)||nc.Ea.keyCode===Za.a.dVa)return this.Sqf=this.t7a(nc)?0:1,this.oz&&oa.h(this.$).Ng.Ap(xa.$ub),nc.Ea.keyCode===Za.a.dVa&&(2===this.KJ?(this.fsb(!1),this.e3=0,this.una(!0),this.tS(!0)):3===this.KJ?(this.bU(!1),this.e3=this.isRow?1:2,this.rr=this.isRow?[11]:[12],this.eMd(!0),this.vpa(!0)):1===this.KJ&&(this.bU(!1),this.rr=this.jR?[11]:[12],this.iKb(!0),this.vpa(!0))),
this.yEc(this.Sqf),!0}else if(nc.Ea.keyCode===Za.a.Epa||k.a.isMac&&nc.Ea.keyCode===Za.a.cVa)return this.yEc(),this.oz&&oa.h(this.$).Ng.Ap(xa.JPe),!0;return!1};this.Sma=nc=>{nc=Y.a(this.$).ve(nc);5===this.Rm?this.aJf(nc):(this.oz=!1,this.Eb.Tj(this.rr),!this.$.$s([this.Ib],!1)||this.dij()||this.Mmf()||(this.ha.sourceRange=this.sourceRange.clone(),this.Sp?this.qdj():this.YXe(),this.cca()?this.Ib.top>this.sourceRange.top&&(nc=this.Ib.height,this.Ib.top-=nc,this.Ib.bottom-=nc):this.Ib.left>this.sourceRange.left&&
(nc=this.Ib.width,this.Ib.left-=nc,this.Ib.right-=nc),this.XW()),this.Yxd());this.AJ(this.Rma,this.Sma);this.tableRange=null;this.Rm=-1;this.Sp&&(this.xea=null,this.KJ=0);return!0};this.DHb=()=>{this.oz=!1;this.KJ=0;this.Eb.Tj(this.rr);if(!this.$.$s([this.Ib],!1))return this.AJ(this.CHb,this.DHb),this.Rm=-1,!0;if(!(this.ha.ra.xd.equals(this.Ib)||this.SAb(this.Ib)||this.SAb(this.sourceRange)||this.Mmf()||(this.XW(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Yc(-694765314,2,30,{[t.a.KJa]:this.YZ,
[t.a.E$c]:!0,[t.a.F$c]:this.kR,[t.a.Caa]:this.ha.sourceRange,[t.a.Baa]:this.ha.ra.xd,[t.a.Xub]:this.ZZ}),this.YZ))){if(this.Ib.top>this.sourceRange.top&&(this.isRow||this.Ib.left===this.sourceRange.left&&this.kR)){var nc=this.Ib.height;this.Ib.top-=nc;this.Ib.bottom-=nc}else this.Ib.left>this.sourceRange.left&&(this.Fg||this.Ib.top===this.sourceRange.top&&!this.kR)&&(nc=this.Ib.width,this.Ib.left-=nc,this.Ib.right-=nc);this.XW()}this.AJ(this.CHb,this.DHb);this.xea=this.tableRange=null;this.Rm=-1;
this.kR=!1;this.Yxd();return!0};this.Rma=nc=>{const Pb=R.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Pb&&(nc=Y.a(this.$).ve(nc));var oc=nc.clientPoint;Pb||(nc=Y.a(this.$).ve(nc));this.Sp&&(this.lW=nc);if(nc=this.ha.Zp(oc,nc.Ob,5,void 0,void 0,!0)){if(this.tableRange.contains(nc.topLeft)){if(this.Qmg(nc,this.cca(),oc),this.Ib=this.VHa(nc),this.ha.sourceRange=this.Ib,this.Eb.Bk(this.Ib,this.rr),this.Eb.$q(this.rr),this.Eb.Tj(this.kba()),6!==this.Rm){for(oc=1;4>=
oc;oc++)nc=this.hm[oc.toString()],nc.parentNode.removeChild(nc),this.Eb.WC(this.cca()?11:12,oc).kg.appendChild(nc);this.Rm=6}}else if(this.Ib=this.Irb(nc),this.Sp)this.ubf(!1);else if(this.Eb.Bk(this.Ib,this.kba()),this.Eb.$q(this.kba()),this.Eb.Tj(this.rr),5!==this.Rm){for(oc=1;4>=oc;oc++)nc=this.hm[oc.toString()],nc.parentNode.removeChild(nc),this.Eb.WC(this.Jxb(),oc).kg.appendChild(nc);this.Rm=5}this.FI()}return!0};this.CHb=nc=>{var Pb=R.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Pb&&(nc=Y.a(this.$).ve(nc));var oc=nc.clientPoint;Pb||(nc=Y.a(this.$).ve(nc));this.lW=nc;if(Pb=this.ha.Zp(oc,nc.Ob,5,void 0,void 0,!0)){if(this.$cf(Pb))return this.Ib=this.Irb(Pb),this.tbf(!1),!0;var Ic=oa.h(this.$),ec=Ic.Eg(Pb),mb=Ic.Vf(this.paneType);oc=pa.a.Qu(mb.view.ui,this.domElement.parentNode,oc,Ic.rtl);mb=!1;let Ob=2;this.kR=!1;if(this.isRow||this.Fg){this.isRow&&oc.y-ec.topLeft.y>ec.height/2?(mb=!0,Ob=1):this.Fg&&oc.x-ec.topLeft.x>ec.width/2&&(mb=!0);if(mb){nc=Ic.Qj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",
Ic.xQ,Ob);try{nc.Iv(Pb),nc.$$mn(),Pb=nc.$$cu().range}finally{nc&&nc.dispose()}}this.Ib=this.Irb(Pb)}else{oc.x-ec.topLeft.x===ec.width?(this.kR=!1,mb=!0):oc.y-ec.topLeft.y>ec.height/2&&(this.kR=mb=!0,Ob=1);this.xea&&(this.kR=this.jR);if(mb){Ic=Ic.Qj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Ic.xQ,Ob);try{Ic.Iv(Pb),Ic.$$mn(),Pb=Ic.$$cu().range}finally{Ic&&Ic.dispose()}}this.Eb.Tj(this.rr);this.rr=this.kR?[11]:[12];for(Ic=1;4>=Ic;Ic++)(ec=this.hm[Ic.toString()])&&ec.parentNode.removeChild(ec),
this.hm[Ic.toString()]=null;this.v7(nc.clientPoint,nc.Ob,this.kR?11:12,!0);this.Ib=this.VHa(Pb)}this.ha.sourceRange=this.Ib;this.Eb.Bk(this.Ib,this.rr);this.Eb.$q(this.rr);this.Eb.Tj(this.kba());if(6!==this.Rm){for(nc=1;4>=nc;nc++)Pb=this.hm[nc.toString()],Pb.parentNode.removeChild(Pb),this.Eb.WC(this.isRow||this.kR?11:12,nc).kg.appendChild(Pb);this.Rm=6}this.FI()}return!0};this.Eab=()=>{this.Sp?this.oz&&5<=this.Rm&&(this.tableRange?this.ZZ?this.bU(!0):this.gsb(!0):this.ZZ?this.isRow||this.Fg?this.bU(!0):
this.fsb(!0):this.isRow||this.Fg?this.fsb(!0):this.bU(!0)):this.oz&&5<=this.Rm&&(this.tableRange?(this.Eb.Tj(this.rr),this.AJ(this.Rma,this.Sma)):(this.Eb.Tj(this.kba()),this.AJ(this.aj,this.fh)))};this.tableRange=null;this.sNa=this.YZ=this.ZZ=!1;this.ha.cZc(this.Eab)}dispose(){R.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.bwc(this.Eab);this.YZ&&this.yEc();this.Sp&&this.ZZ&&this.yEc(1);super.dispose()}yFd(F){this.Sp&&(this.lW=F,this.xea=null,
this.jR=this.isRow=this.Fg=this.kR=!1,La.KeyInputManager.instance.ta(m.a.Vb,this.domElement.ownerDocument.body,this.onKeyDown));this.oz=!0;this.tableRange=this.W3g(this.tableManager.Qp(this.sourceRange.topLeft));oa.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Sp?(this.xea=this.tableRange,this.KJ=1,this.rr=(this.jR=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Rm=6,this.XN(this.Rma,this.Sma),this.Eua=this.J9b,
this.HBa=this.fAc,this.v7(F.clientPoint,F.Ob,this.jR?11:12,!0,!0),this.vpa(!0)):(this.rr=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Rm=6,this.XN(this.Rma,this.Sma),this.v7(F.clientPoint,F.Ob,this.isRow?11:12,!0)):(this.tableRange=null,this.Sp?(this.isRow=this.sourceRange.isRow,this.Fg=this.sourceRange.Fg,this.isRow||this.Fg?(this.KJ=3,this.e3=this.isRow?1:2,this.Rm=6,this.rr=this.isRow?[11]:[12],this.XN(this.CHb,this.DHb),
this.Eua=this.J9b,this.HBa=this.fAc,this.v7(F.clientPoint,F.Ob,this.isRow?11:12,!0,!0),this.vpa(!0)):(this.KJ=2,this.e3=0,this.XN(this.aj,this.fh),this.Eua=this.SPe,this.HBa=this.o$f,this.v7(F.clientPoint,F.Ob,this.Jxb(),!1,!0),this.tS(!0))):(this.XN(this.aj,this.fh),La.KeyInputManager.instance.ta(m.a.Vb,this.domElement.ownerDocument.body,this.onKeyDown),this.e3=this.sourceRange.isRow?1:this.sourceRange.Fg?2:0,this.v7(F.clientPoint,F.Ob,this.Jxb(),!1),this.tS()))}JPa(){this.oz=!1;this.Sp&&(this.KJ=
0);this.Eb.Tj(this.kba());if(!this.$.$s([this.Ib],!1))return this.AJ(this.aj,this.fh),this.Rm=-1,!0;if(this.ha.ra.xd.equals(this.Ib)||this.SAb(this.Ib)||this.SAb(this.sourceRange))this.Rm=-1;else{this.XW();this.ha.sourceRange=this.sourceRange.clone();const F=this.ha.sourceRange,na=this.ha.ra.xd;this.Sp?this.$.Yc(-694765314,2,30,{[t.a.KJa]:this.YZ,[t.a.Caa]:F,[t.a.Baa]:na,[t.a.Xub]:this.ZZ}):this.$.Yc(-694765314,2,30,{[t.a.KJa]:this.YZ,[t.a.Caa]:F,[t.a.Baa]:na})}!this.Sp&&this.tableRange||this.AJ(this.aj,
this.fh);this.Yxd();return!0}zFd(F){const na=this.ha.Zp(F.clientPoint,F.Ob,5,void 0,void 0,!0);this.lW=F;return this.$cf(na)?(this.Ib=this.VHa(na),this.tbf(!0),!0):this.gfi(na)?(this.Ib=this.Irb(na),this.ubf(!0),!0):!1}FI(F=!1){const na=this.Ib.toString();if(this.Sp)for(var hb=1;4>=hb;hb++)if(this.a3d){const Ib=this.hm[hb.toString()];Ib&&Ib.childNodes&&0<Ib.childNodes.length&&(Ib.childNodes[0].innerText=na,Ib.childNodes[1].innerText=this.Eua,F&&(Ib.childNodes[2].innerText=this.HBa))}else this.hm[hb.toString()].childNodes[0].innerText=
na,this.hm[hb.toString()].childNodes[1].innerText=this.Eua,F&&(this.hm[hb.toString()].childNodes[2].innerText=this.HBa);else for(F=1;4>=F;F++)if(this.a3d){if(hb=this.hm[F.toString()])hb.innerText=na}else this.hm[F.toString()].innerText=na}$cf(F){return!!this.xea&&1!==this.KJ&&!!F&&this.xea.contains(F.topLeft)}gfi(F){return!!this.xea&&1===this.KJ&&!!F&&!this.xea.contains(F.topLeft)}tbf(F){this.tableRange=this.xea;this.KJ=1;const na=!this.ZZ;F?(this.bU(!1),this.rr=this.jR?[11]:[12],this.iKb(na),this.vpa(na)):
(this.fsb(!1),this.una(na),this.tS(na))}ubf(F){this.tableRange=null;this.KJ=2;const na=!this.ZZ;F?(this.bU(!1),this.rr=this.jR?[11]:[12],this.kR=this.jR,this.eMd(na),this.vpa(na)):(this.gsb(!1),this.una(na),this.tS(na))}hfb(){if(!oa.h(this.$).ha.ra.eh)return!1;const F=oa.h(this.$).getRangeInformation(this.ha.ra.xd);for(const na of F)if(Object(Ea.a)($a.PivotTableRange,na))return!1;return!0}W3g(F){if(F&&F.contains(this.sourceRange)&&!F.equals(this.sourceRange)){if(F.Kka&&this.sourceRange.bottom===this.sourceRange.top&&
this.sourceRange.top===F.top){const na=new Ya.Range(this.sourceRange.top,this.sourceRange.left,F.bottom,this.sourceRange.right,!1,!1);if(!na.equals(F))return this.sourceRange=na,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),F}this.Sp?this.jR=F.left===this.sourceRange.left&&F.right===this.sourceRange.right:this.isRow=F.left===this.sourceRange.left&&F.right===this.sourceRange.right;if(F.top===this.sourceRange.top&&F.bottom===this.sourceRange.bottom||this.cca())return F}return null}VHa(F){const na=
F.clone();this.cca()?na.left=Math.max(F.left-this.Pnd,1):na.top=Math.max(F.top-this.r3d,1);na.right=na.left+this.sourceRange.width-1;na.bottom=na.top+this.sourceRange.height-1;return this.Jpb(na)}Mmf(){const F=this.Ib.topLeft.vd(this.sourceRange);return F||this.Sp&&!this.tableRange?F:this.cca()?this.Ib.top===this.sourceRange.bottom+1:this.Ib.left===this.sourceRange.right+1}dij(){if(this.cca()&&this.Ib.left!==this.tableRange.left||!this.cca()&&this.Ib.top!==this.tableRange.top){const F=cb.a.hd(1,1,
0,918,0,2065438552,"RearrangeInvalidDest");ib.a(this.$).St([F]);return!0}return!1}qdj(){const F=this.$.Mb.Kc("UserAction","RearrangeRowColumnClientSide"),na={["CopyPasteTargetType"]:1,["OperationId"]:va.a.create().toString(),["Stopwatch"]:F,["DragDropIsShiftKeyDown"]:this.ZZ,["EncounteredDeploymentErrors"]:!1},hb=this.YZ?2:1,Ib=this.$.da.Ba(254);(new Promise((vc,nc)=>{this.YXe(Pb=>{Pb.Errors&&0<Pb.Errors.length?nc(new Da.a(22,Pb.Errors)):vc(!0)},Pb=>{Pb=V.a.Ue(Pb.data);nc(new Da.a(22,Pb))})})).then(()=>
{n.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Ib&&Ib.iIi(na,hb,this.sourceRange,this.Ib);return Promise.resolve(!0)},vc=>{n.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${vc?copyPasteInfra.getStringifiedError(vc):"null"}, copyPasteTargetType="${1}"`);return Ib?Ib.R1i(vc,na,hb,this.sourceRange,this.Ib):Promise.reject(vc)})}YXe(F=null,na=null){const hb={};this.cca()?
(hb.FirstRow=this.Ib.top-1,hb.FirstColumn=0,hb.DeltaColumn=0,hb.DeltaRow=this.Ib.bottom-this.Ib.top+1):(hb.FirstRow=0,hb.FirstColumn=this.Ib.left-1,hb.DeltaColumn=this.Ib.right-this.Ib.left+1,hb.DeltaRow=0);hb.LastRow=W.a.iB;hb.LastColumn=W.a.ky;hb.SheetName=this.$.ua.na?this.$.ua.na.name:this.$.Bb.getItemByName(this.$.Bb.na.name).sheetName;const Ib=ba.v(this.sourceRange,this.$);this.$.userOperationManager.Oc(new ya.a(514,0,(vc,nc,Pb)=>la(this.$.pa.va,Ib,hb,F?Z.b(vc,F):vc,na?Z.a(nc,na):nc,Pb,null),
64,()=>new eb(Ib,hb)),null)}yEc(F=0){0===F?this.YZ=!1:1===F&&(this.ZZ=!1);this.Sp&&(this.YZ||this.ZZ)||(La.KeyInputManager.instance.Aa(m.a.Qd,this.domElement.ownerDocument.body,this.onKeyUp),this.sNa=!1)}una(F=!1){this.Rm=5;this.XN(this.aj,this.fh);this.Eua=this.SPe;this.HBa=this.o$f;this.v7(this.lW.clientPoint,this.lW.Ob,this.Jxb(),!1,F)}eMd(F=!1){this.Rm=6;this.XN(this.CHb,this.DHb);this.Eua=this.J9b;this.HBa=this.fAc;this.v7(this.lW.clientPoint,this.lW.Ob,this.isRow||this.jR?11:12,!0,F)}iKb(F=
!1){this.Rm=6;this.XN(this.Rma,this.Sma);this.Eua=this.J9b;this.HBa=this.fAc;this.v7(this.lW.clientPoint,this.lW.Ob,this.cca()?11:12,!0,F)}cca(){return!this.Sp&&this.isRow||this.Sp&&this.jR}fsb(F){this.Eb.Tj(this.rr);this.AJ(this.CHb,this.DHb,void 0,F)}Yxd(){const F=Ba.a.instance.Tb("Common.ISystemInitiatedFeedback");F&&F.execute(na=>{na.logActivity("DragDrop",null)})}}Object(r.a)(Wb,"DragSelectionClickBehaviorCellRangeAndTable",ta,[]);var Ab=a(325),Jb=a(151);class Gb extends ta{constructor(F,na,
hb,Ib,vc){super(F,na,hb,Ib,vc);this.Eab=()=>{this.oz&&this.gsb(!0);5===this.Rm&&this.bU(!0)};this.Sma=nc=>{Y.a(this.$).ve(nc);this.oz=!1;this.Eb.Tj(this.rr);this.ha.sourceRange=this.sourceRange.clone();this.Eof?this.$.Yc(927125067,G.a.zb,30,null):this.pxa?(this.XW(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Yc(-694765314,2,30,{[t.a.KJa]:!0,[t.a.Caa]:this.ha.sourceRange,[t.a.Baa]:this.ha.ra.xd,[t.a.Xub]:!1}),n.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),
oa.h(this.$).Ng.Ap(t.a.gV),this.pxa=!1):this.hdj();this.AJ(this.Rma,this.Sma);this.Rm=-1;return!0};this.Rma=nc=>{nc=Y.a(this.$).ve(nc);const Pb=nc.clientPoint;this.lW=nc;let oc=this.ha.Zp(Pb,nc.Ob,5,void 0,void 0,!0);if(oc){if(!this.Jtd(oc))return this.eci(nc),!0;this.Qmg(oc,this.isRow,Pb);if(this.isRow||this.Fg)this.Ib=this.VHa(oc);this.ha.sourceRange=this.Ib;this.Eb.Bk(this.Ib,this.rr);this.Eb.$q(this.rr);this.Eb.Tj(this.kba());this.FI()}return!0};this.onKeyDown=nc=>this.t7a(nc)?(this.sNa||(La.KeyInputManager.instance.ta(m.a.Qd,
this.domElement.ownerDocument.body,this.onKeyUp),this.sNa=!0),this.pxa||(oa.h(this.$).Ng.Ap(xa.p6c),this.pxa=!0),!0):!1;this.onKeyUp=nc=>{this.t7a(nc)&&(La.KeyInputManager.instance.Aa(m.a.Qd,this.domElement.ownerDocument.body,this.onKeyUp),this.sNa=!1,this.oz?oa.h(this.$).Ng.Ap(xa.$ub):oa.h(this.$).Ng.Ap(t.a.gV),this.pxa=!1);return!0};this.cIf=nc=>{nc.Errors&&0<nc.Errors.length?(n.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${cb.a.qc(nc.Errors)}]`),
this.Ib.left=this.sourceRange.left,this.Ib.right=this.sourceRange.right,this.Ib.top=this.sourceRange.top,this.Ib.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Ib.top&&this.sourceRange.bottom>=this.Ib.top-1?(this.Ib.top=this.sourceRange.top,this.Ib.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Ib.top||(this.Ib.top-=this.sourceRange.height),this.Ib.bottom=this.Ib.top+this.sourceRange.height-1):this.sourceRange.left<=this.Ib.left&&this.sourceRange.right>=this.Ib.left-
1?(this.Ib.left=this.sourceRange.left,this.Ib.right=this.sourceRange.right):(this.sourceRange.left>this.Ib.left||(this.Ib.left-=this.sourceRange.width),this.Ib.right=this.Ib.left+this.sourceRange.width-1);this.XW();this.Rm=-1};this.bIf=nc=>{nc=V.a.Ue(nc.data);n.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${cb.a.qc(nc)}]`)};this.ha.cZc(this.Eab);this.pxa=this.sNa=!1}dispose(){R.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&
this.ha&&this.ha.bwc(this.Eab);super.dispose()}yFd(F){this.lW=F;this.isRow=this.Fg=!1;this.oz=!0;La.KeyInputManager.instance.ta(m.a.Vb,this.domElement.ownerDocument.body,this.onKeyDown);this.hc=this.tableManager.qka(this.sourceRange);this.Ajf=this.cxi(this.Ib);this.hc||n.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.Eof=(new Jb.a(this.$.ua)).Xh;oa.h(this.$);oa.h(this.$).Ng.Ap(xa.$ub);this.Jtd(this.Ib)?
(this.isRow=this.Wxi(),this.Fg=this.sri(),this.isRow||this.Fg?(this.h8a=!1,this.iKb(F),this.Ib=this.VHa(this.Ib),this.vpa()):(this.h8a=!0,this.una(F),this.tS())):(this.h8a=!0,this.una(F),this.tS())}JPa(){return this.Eof?(this.$.Yc(927125067,G.a.zb,30,null),this.bU(!0),this.h8a=!1,this.Rm=-1,!0):this.pxa||R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MovePivotTables",!1)&&R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)&&this.Ajf?(this.XW(),this.ha.sourceRange=
this.sourceRange.clone(),this.$.Yc(-694765314,2,30,{[t.a.KJa]:this.pxa,[t.a.Caa]:this.ha.sourceRange,[t.a.Baa]:this.ha.ra.xd,[t.a.Xub]:!1}),n.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.pxa}"`),oa.h(this.$).Ng.Ap(t.a.gV),this.bU(!0),this.oz=this.h8a=!1,this.Rm=-1,this.Ajf=!1,!0):5===this.Rm?(this.bU(!0),this.h8a=!1,this.ANj(),this.Rm=-1,!0):!1}zFd(F){const na=this.ha.Zp(F.clientPoint,F.Ob,5,void 0,void 0,
!0);this.lW=F;return this.h8a?!1:this.Jtd(na)?(this.fci(F),!0):!1}FI(){let F=new Ya.Range(this.Ib.top,this.Ib.left,this.Ib.bottom,this.Ib.right,!1,!0);6===this.Rm&&(this.isRow?(--F.top,F.bottom=F.top+this.Ib.height-1):(--F.left,F.right=F.left+this.Ib.width-1));for(let na=1;4>=na;na++)if(this.a3d){const hb=this.hm[na.toString()];hb&&hb.childNodes&&0<hb.childNodes.length&&(hb.childNodes[0].innerText=F.toString())}else this.hm[na.toString()].childNodes[0].innerText=F.toString()}hfb(){if(!oa.h(this.$).ha.ra.eh)return!1;
var F=oa.h(this.$).getRangeInformation(this.ha.ra.xd);for(var na of F)if(Object(Ea.a)($a.PivotTableRange,na)&&(F=this.tableManager.qka(na)))return na=!F.isOlap||!F.YNa(!0),n.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",F),F.isActionable&&na;return!1}VHa(F){F=F.clone();this.isRow?(F.left=this.sourceRange.left,F.right=this.hc.right,F.bottom=F.top+this.sourceRange.height-1):this.Fg?(F.top=this.sourceRange.top,
F.bottom=this.hc.zB.bottom,F.right=F.left+this.sourceRange.width-1):n.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.Jpb(F)}hdj(){const F={},na=ba.v(this.sourceRange,this.$);oa.h(this.$).getRangeInformation(this.Ib);if(this.isRow){na.FirstColumn=F.FirstColumn=this.Ib.left-1;na.LastColumn=F.LastColumn=this.Ib.right-1;if(this.sourceRange.top<=this.Ib.top&&this.sourceRange.bottom>=this.Ib.top-1){n.ULS.sendTraceTag(520176345,
0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Ib.top?F.LastRow=F.FirstRow=this.Ib.top-1:(F.FirstRow=this.Ib.top-this.sourceRange.height-1,F.LastRow=F.FirstRow+this.sourceRange.height-1)}else{F.FirstRow=this.Ib.top;F.LastRow=this.Ib.bottom-1;if(this.sourceRange.left<=this.Ib.left&&this.sourceRange.right>=this.Ib.left-1){n.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}F.LastColumn=
this.sourceRange.left>this.Ib.left?F.FirstColumn=this.Ib.left-1:F.FirstColumn=this.Ib.left-this.sourceRange.width-1}const hb={};hb.SheetName=this.$.ua.na?this.$.ua.na.name:this.$.Bb.getItemByName(this.$.Bb.na.name).sheetName;hb.Ranges=Array(2);hb.Ranges[0]=na;hb.Ranges[1]=F;this.JHh(hb)}JHh(F){this.$.userOperationManager.Oc(new ya.a(265,0,(na,hb,Ib)=>ua(this.$.pa.va,F,this.cIf?Z.b(na,this.cIf):na,this.bIf?Z.a(hb,this.bIf):hb,Ib,null),64),null)}Jtd(F){return null!==this.hc&&(null===this.hc.zB||F.left>=
this.hc.zB.left)&&(null===this.hc.ME||F.right<=this.hc.ME.right)&&(!R.EwaSettings.isChangeGateEnabled("OfficeVSO:7666231_CannotSortColumnsInPivotTable")&&(null===this.hc.zB||F.top>=this.hc.zB.top)||R.EwaSettings.isChangeGateEnabled("OfficeVSO:7666231_CannotSortColumnsInPivotTable")&&this.hAi(F))&&(null===this.hc.zB||F.bottom<=this.hc.zB.bottom)}hAi(F){return this.isRow?null!==this.hc.zB&&F.top>=this.hc.zB.top:this.Fg?null!==this.hc.ME&&F.top>=this.hc.ME.top:null===this.hc.top||F.top>=this.hc.top}cxi(F){return null!==
this.hc&&this.hc.left>=F.left&&this.hc.right<=F.right&&this.hc.top>=F.top&&this.hc.bottom<=F.bottom}Wxi(){return null!==this.hc&&null!==this.hc.zB&&this.hc.zB.top<=this.Ib.top&&this.hc.zB.left<=this.Ib.left&&this.hc.zB.right>=this.Ib.left}sri(){return null!==this.hc&&null!==this.hc.ME&&this.hc.ME.top===this.Ib.top&&this.hc.ME.left<=this.Ib.left&&this.hc.ME.right>=this.Ib.right}iKb(F){this.Rm=6;this.rr=this.isRow?[11]:[12];this.XN(this.Rma,this.Sma);this.v7(F.clientPoint,F.Ob,this.isRow?11:12,!0,!1)}una(F){this.Rm=
5;this.XN(this.aj,this.fh);this.v7(F.clientPoint,F.Ob,this.Jxb(),!1,!1)}fci(F){this.bU(!1);this.iKb(F);this.Ib=this.VHa(this.Ib);this.vpa()}eci(F){this.gsb(!1);this.una(F);this.tS()}ANj(){if(!this.SAb(this.Ib)){var F=cb.a.hd(1,0,904,903,0,2069074184,"PivotTableInvalidMove");F.HelpTopicId=Ab.a.oRj;F.HelpDescription=Eb.a.instance.ga(913);ib.a(this.$).St([F])}}}Object(r.a)(Gb,"DragSelectionClickBehaviorPivotTableRange",ta,[]);var Nb=a(380);class Ja extends L{constructor(F,na){super(F);this.gh=()=>{this.domElement.classList.remove(fa.selecting);
Nb.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.zr=()=>{this.domElement.classList.add(fa.selecting)};this.onPointerDown=hb=>{2===hb.wb&&hb.Zn===Sys.UI.MouseButton.leftButton&&(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.ra.xd,Nb.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.Tca=()=>{this.gridView.$.Yc(1983983164,2,30,null);return!0};this.od=()=>{v.DOMElementExtensions.setVisible(this.Vaa,this.gridView.$.isEditMode)};
this.B6=()=>{v.DOMElementExtensions.setVisible(this.Vaa,!1)};this.A6=()=>{v.DOMElementExtensions.setVisible(this.Vaa,!0)};this.pGf=()=>{v.DOMElementExtensions.setVisible(this.Vaa,!1)};this.oGf=()=>{v.DOMElementExtensions.setVisible(this.Vaa,!0)};this.VGb=(hb,Ib)=>{v.DOMElementExtensions.setVisible(this.Vaa,!Ib.spe)};this.gridView=na;na=document.createElement("div");na.className=ea.a.hGh;this.Vaa=na;this.od(null,null);F.appendChild(na);x.a.instance.ta(m.a.pointerDown,this.Vaa,this.onPointerDown);N.a.instance.ta(m.a.yk,
this.Vaa,this.Tca);this.gridView.ha.R9(this.zr);this.gridView.ha.C2(this.gh);this.gridView.$.hl(this.od);this.gridView.$.pb.e1b(this.B6);this.gridView.$.pb.d1b(this.A6);this.gridView.ese(this.VGb);this.gridView.oc.gl(this.pGf);this.gridView.oc.rm(this.oGf)}dispose(){x.a.instance.Aa(m.a.pointerDown,this.Vaa,this.onPointerDown);N.a.instance.Aa(m.a.yk,this.Vaa,this.Tca);this.gridView.$&&(this.gridView.ha.Tda(this.zr),this.gridView.ha.j0(this.gh),this.gridView.$.em(this.od),this.gridView.$.pb.fwc(this.B6),
this.gridView.$.pb.ewc(this.A6),this.gridView.GYf(this.VGb),this.gridView.oc.Zk(this.pGf),this.gridView.oc.dm(this.oGf));super.dispose()}}Object(r.a)(Ja,"FillHandleClickBehavior",L,[]);class ab extends S{constructor(F,na){super(F);this.h3i=hb=>{const Ib=E.HelperMethods.zo(hb);var vc=this.xwa.w3d(hb.clientPoint);if(!vc)return!1;var nc=vc.je,Pb=this.xwa.Ca.Wxb(nc.hashCode).Lva(vc.TI);if(!Pb)return!1;hb=nc.jj.domElement;vc=E.HelperMethods.dre(E.HelperMethods.ryb(nc.domElement,hb),vc.TI);nc=0;Pb=this.xwa.Jb(Pb.getRange());
for(let Ic=0,ec=ab.UCe.length;Ic<ec;++Ic){const mb=ab.UCe[Ic];if((128===mb||64===mb)&&this.xwa.$.isEditMode)continue;var oc=Pb.tLa(mb);if(!oc||!oc.a7a||"none"===oc.a7a.style.display)continue;oc=oc.a7a;const Ob=E.HelperMethods.ryb(oc,hb);oc=new Sys.UI.Bounds(Ob.x,Ob.y,oc.offsetWidth,oc.offsetHeight);if(I.a.cR(oc,vc)){nc=mb;break}}return 0!==nc?(Pb.invoke(nc,Ib),!0):!1};this.JAg=na;N.a.instance.ta(m.a.click,F,this.h3i)}get xwa(){return this.JAg}}ab.UCe=[1,2,32,256,128,64];Object(r.a)(ab,"IPadSelectionClickThroughBehavior",
S,[]);var wb=a(22);class xb{constructor(F){this.iff=na=>{this.aFc(na.Ob,1);return!0};this.jff=na=>{this.aFc(na.Ob,-1);return!0};this.gh=()=>{this.xsd=!1};this.zr=()=>{this.xsd=!0};this.gridView=F;this.y6a=0;this.xsd=this.zjc=!1;this.H5=Number.NaN;this.gridView.ha.R9(this.zr);this.gridView.ha.C2(this.gh);this.gridView.ha.cZc(this.gh)}dispose(){this.gridView.ha.Tda(this.zr);this.gridView.ha.j0(this.gh);this.gridView.ha.bwc(this.gh)}o0(){this.y6a=0;this.zjc=!1;this.H5=Number.NaN}QPe(F){this.zjc=!0;this.aFc(F,
1)}RPe(F){this.zjc=!1;this.aFc(F,-1)}aFc(F,na){if(F)if(F.parentNode)if(this.xsd)isNaN(this.H5)||(this.qFc(this.H5,!1),this.H5=Number.NaN);else if(F=parseInt(F.parentNode.getAttribute(t.a.P6a),10),isNaN(F))n.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.H5)&&F!==this.H5){if(this.zjc)return;this.qFc(this.H5,!1)}if(isNaN(this.H5)||F!==this.H5)this.H5=F,this.y6a=0;!this.y6a&&0<na&&this.qFc(F,!0);this.y6a=
Math.max(this.y6a+na,0);!this.y6a&&0>na&&(this.qFc(F,!1),this.H5=Number.NaN)}else n.ULS.shipAssertTag(537159367,0,!!F.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else n.ULS.shipAssertTag(537159368,0,!!F,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}qFc(F,na){for(let Ib=1;4>=Ib;Ib++){var hb=this.gridView.Eb.WC(3,Ib,F).kg;v.DOMElementExtensions.toggleCssClass(hb,fa.EFh,na);for(hb=hb.firstChild;hb;hb=hb.nextSibling)wb.a.contains(hb.className,"resizemarqueehandle",
!0)&&v.DOMElementExtensions.toggleCssClass(hb,fa.IFh,na)}}}Object(r.a)(xb,"MarqueeHoveringManager",null,[]);var rb=a(188),za=a(87),Aa=a(843),pb=a(1271);class kb extends S{constructor(F,na){super(F);this.orc=()=>{if(!this.Av)return n.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Av.mgj(this.Bba);this.Av.Kvh(this.Cba);if(3===this.Av.model.state)return!0;this.Av.fod(!0);return!0};this.ada=()=>{if(!this.Av)return!1;this.Av.iTf(!1);
this.Av.vPd(this.Cba,!1);if(3===this.Av.model.state)return!0;this.Av.fod(!1);return!0};this.onPointerDown=hb=>this.Av?2===hb.wb&&hb.Zn===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.sHb=()=>{if(!this.Av)return!1;this.Av.vPd(this.Cba,!0);this.Av.fod(!1);this.Av.DJa();return!0};this.onDoubleClick=hb=>{if(hb.Ea)return hb.Ea.stopPropagation(),!0;n.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.Av=Object(za.a)(pb.a,na.metadata);
this.Cba=document.createElement("div");this.Cba.id=`${F.id}-${t.a.KCe}`;this.Cba.className=Aa.a.D5g;this.Bba=document.createElement("div");this.Bba.id=`${F.id}-${t.a.S2c}`;this.Bba.className=Aa.a.S2c;this.NQ=document.createElement("div");this.NQ.appendChild(this.Bba);this.NQ.className=Aa.a.C5g;this.Cba.appendChild(this.NQ);F.appendChild(this.Cba);n.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");
x.a.instance.ta(m.a.mW,this.NQ,this.orc);x.a.instance.ta(m.a.sB,this.NQ,this.ada);x.a.instance.ta(m.a.pointerDown,this.NQ,this.onPointerDown);rb.a.instance.ta(m.a.click,this.NQ,this.sHb);rb.a.instance.ta(m.a.yk,this.NQ,this.onDoubleClick);v.DOMElementExtensions.setVisible(this.NQ,na.isVisible)}dispose(){x.a.instance.Aa(m.a.mW,this.NQ,this.orc);x.a.instance.Aa(m.a.sB,this.NQ,this.ada);x.a.instance.Aa(m.a.pointerDown,this.NQ,this.onPointerDown);rb.a.instance.Aa(m.a.click,this.NQ,this.sHb);rb.a.instance.Aa(m.a.yk,
this.NQ,this.onDoubleClick);v.DOMElementExtensions.yf(this.Bba);this.Bba=null;v.DOMElementExtensions.yf(this.Cba);this.Av=this.Cba=null;super.dispose()}c_a(F){this.Av=Object(za.a)(pb.a,F.metadata);F.isVisible!==F.nya&&(this.Av.pHj(F.isVisible?1:0),v.DOMElementExtensions.setVisible(this.Cba,F.isVisible))}}Object(r.a)(kb,"RangeCatchUpActivityHighlightBehavior",S,[]);class Cb extends da{constructor(F,na,hb,Ib){super(F,na,hb,Ib)}get G4(){return 16}get aeb(){return this.gridView.ha.rangePicker.ggd(!1)}dTa(){return(this.gridView.inRangePicker||
this.gridView.ei)&&super.dTa()}}Object(r.a)(Cb,"RangePickerTouchGrippiesBehavior",da,[]);class ob extends S{constructor(F,na){super(F);const hb=document.createElement("div"),Ib=document.createElement("div");hb.className=na?fa.pGh:fa.rGh;Ib.className=na?fa.qGh:fa.oGh;F.appendChild(hb);F.appendChild(Ib)}}Object(r.a)(ob,"RearrangeHighlightBehavior",S,[]);var qa;(function(F){F[F.topLeft=0]="topLeft";F[F.topRight=1]="topRight";F[F.bottomLeft=2]="bottomLeft";F[F.bottomRight=3]="bottomRight";F[F.error=4]=
"error"})(qa||(qa={}));Object(r.b)("Corner",qa);class ma extends S{constructor(F,na,hb,Ib,vc){super(F);this.gb=this.ZF=null;this.q3=0;this.Ib=this.sourceRange=null;this.OTa=!1;this.onPointerDown=nc=>{nc=Y.a(this.$).ve(nc);if(this.O$f(nc)&&!this.OTa){this.Guf();this.gb=this.oo.xcc();this.ZF=this.oo.h9e(nc);if(!this.gb||!this.ZF||!this.ZF.range)return n.ULS.shipAssertTag(537159361,0,!!this.gb,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),n.ULS.shipAssertTag(537159360,0,!!this.ZF,
"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),n.ULS.shipAssertTag(537159331,0,!!this.ZF.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Ib=this.ZF.range.clone();this.sourceRange=this.Ib.clone();this.q3=this.X4e(nc);if(4===this.q3)return n.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Pb=this.P6e(nc,!0);if(!Pb)return n.ULS.shipAssertTag(537159329,0,!1,
"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.kKe(Pb))return n.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.zMa=!0;this.gb.CE(!1);this.BF.QPe(nc.Ob);this.oo.vTf(!0,this.Dba.dU);this.gb.textBox.removeSelection();this.gb.M0b(this.Vbf);this.QWf();this.OTa=!0;wa.b(this.$,!0)}return!0};this.aj=nc=>{nc=Y.a(this.$).ve(nc);nc=this.P6e(nc,!1);if(!nc)return!0;
nc=this.kKe(nc);if(!nc)return n.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.sbc(!0),!1;if(this.Ib.equals(nc))return!0;this.Ib=nc;nc=this.tS();nc||(n.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.sbc(!0));return nc};this.fh=nc=>{Y.a(this.$).ve(nc);nc=this.XW();n.ULS.shipAssertTag(537159325,0,nc,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.sbc(!nc);
return nc};this.Vbf=()=>{this.sbc(!0)};this.gridView=na;this.$=na.$;this.aL=[];this.ha=this.gridView.ha;this.BF=hb;this.oo=Ib;this.Dba=vc;this.coloredReferencesManager=this.$.da.Ba(281);n.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.bN=z.a.LH(this.$))na=this.$.da.Ba(464),n.ULS.shipAssertTag(510255176,0,!!na,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),
this.SA=na.SA;for(const nc of this.f1f())na=this.oo.W6c(F,nc,this.Rte(),this.onPointerDown),this.aL.push(na);for(const nc of this.aL)x.a.instance.ta(m.a.mW,nc,this.BF.iff),x.a.instance.ta(m.a.sB,nc,this.BF.jff);this.c_a(vc)}dispose(){this.aL.forEach(F=>{x.a.instance.Aa(m.a.pointerDown,F,this.onPointerDown)});this.aL.length=0;super.dispose()}c_a(F){this.Dba=F;this.$te(F);this.oo.zNb(F,this.aL,this.DVd());this.BF.o0()}P6e(F,na){const hb=F.Ob;F=F.clientPoint;if(!hb||!F)return n.ULS.shipAssertTag(537159324,
0,!!hb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),n.ULS.shipAssertTag(537159323,0,!!F,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;na&&(F=this.Iyf(F));na=this.ha.Zp(F,hb,0,!0,!1,!0);na||(F=this.Iyf(F),na=this.ha.Zp(F,hb,0,!0,!1,!0));return na}Iyf(F){F.y+=0===this.q3||1===this.q3?2:-2;F.x+=0===this.q3||2===this.q3?2:-2;return F}kKe(F){if(!F||!this.sourceRange)return n.ULS.shipAssertTag(537159322,0,!!F,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),
n.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.q3)return new Ya.Range(F.top,F.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.q3)return new Ya.Range(F.top,this.sourceRange.left,this.sourceRange.bottom,F.right,!0,!1);if(2===this.q3)return new Ya.Range(this.sourceRange.top,F.left,F.bottom,this.sourceRange.right,!0,!1);if(3===this.q3)return new Ya.Range(this.sourceRange.top,this.sourceRange.left,
F.bottom,F.right,!0,!1);n.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${qa[this.q3]}`);return null}XW(){return this.bN?this.SA.KFb(this.gb,this.ZF,this.Ib):this.coloredReferencesManager.KFb(this.gb,this.ZF,this.Ib)}tS(){return this.XW()}sbc(F){F&&n.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.BF.RPe(this.aL[0]);
this.oo.vTf(!1,this.Dba.dU);this.gb.textBox.setCaretPositionToEnd();this.gb.Qvc(this.Vbf);this.dlg();this.OTa=this.gridView.zMa=!1;wa.b(this.$,!1);this.oo.nVf()}}Object(r.a)(ma,"ResizeMarqueeBehaviorBase",S,[]);class Ga extends ma{constructor(F,na,hb,Ib,vc){super(F,na,hb,Ib,vc)}f1f(){return[fa.vGh,fa.wGh,fa.tGh,fa.uGh]}Rte(){return[fa.sGh]}X4e(F){F=F.Ob;if(F===this.aL[0])return 0;if(F===this.aL[1])return 1;if(F===this.aL[2])return 2;if(F===this.aL[3])return 3;n.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4}QWf(){this.oo.XN(this.aj,this.fh,!0)}dlg(){this.oo.d1d(this.aj,this.fh,!0)}O$f(F){return 2===(G.a.zb=F.wb)&&F.Zn===Sys.UI.MouseButton.leftButton}DVd(){return!0}Guf(){n.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}$te(F){for(const na of this.aL)na.style.backgroundColor=F.kg.style.borderColor}}Object(r.a)(Ga,"ResizeMarqueeMouseBehavior",ma,[]);class vb extends ma{constructor(F,na,hb,Ib,vc){super(F,na,hb,Ib,vc);
this.mHb=()=>{const nc=3===G.a.zb;this.owd&&!nc?this.oo.zNb(this.Dba,this.aL,!1):!this.owd&&nc&&this.oo.zNb(this.Dba,this.aL,!0);this.owd=nc};this.m2i=(nc,Pb)=>{Pb.P6a===this.Dba.dU&&this.oo.zNb(this.Dba,this.aL,!Pb.start&&this.DVd())};G.a.Nse(this.mHb);this.owd=3===G.a.zb;this.oo.LQg(this.m2i)}dispose(){G.a.hZf(this.mHb);super.dispose()}f1f(){return[ea.a.xFh,ea.a.wFh]}Rte(){const F=!R.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[F?ea.a.eXe:ea.a.dXe,ea.a.jac,F?ea.a.vFh:
ea.a.iac]}X4e(F){F=F.Ob;if(F===this.aL[0])return 0;if(F===this.aL[1])return 3;n.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}QWf(){k.a.Cw?this.oo.XN(this.aj,this.fh,!1):this.oo.wkj(this.aj,this.fh)}dlg(){k.a.Cw?this.oo.d1d(this.aj,this.fh,!1):this.oo.K2j(this.aj,this.fh)}O$f(F){return 3===(G.a.zb=F.wb)}DVd(){return 3===G.a.zb}Guf(){n.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}$te(){}}
Object(r.a)(vb,"ResizeMarqueeTouchBehavior",ma,[]);class Ka extends S{constructor(F,na){super(F);Ka.utb(F,P.a.NFh+" "+ea.a.$ua,null===na||void 0===na?void 0:na.horizontal);Ka.utb(F,P.a.MFh+" "+ea.a.$ua,null===na||void 0===na?void 0:na.vertical);Ka.utb(F,P.a.JFh+" "+ea.a.$ua,null===na||void 0===na?void 0:na.horizontal);Ka.utb(F,P.a.LFh+" "+ea.a.$ua,null===na||void 0===na?void 0:na.vertical);Ka.utb(F,ea.a.KFh)}static utb(F,na,hb){const Ib=document.createElement("div");Ib.className=na;hb&&(Ib.style.backgroundImage=
`url("${hb}")`);F.appendChild(Ib)}}Object(r.a)(Ka,"SelectionCutCopyBehavior",S,[]);class Pa extends S{constructor(F){super(F);appChrome.renderSpinner(F)}}Object(r.a)(Pa,"SelectionPasteBehavior",S,[]);class fb extends S{constructor(F,na){super(F);fb.Jtb(F,P.a.nGh+" "+ea.a.$ua,null===na||void 0===na?void 0:na.horizontal);fb.Jtb(F,P.a.mGh+" "+ea.a.$ua,null===na||void 0===na?void 0:na.vertical);fb.Jtb(F,P.a.jGh+" "+ea.a.$ua,null===na||void 0===na?void 0:na.horizontal);fb.Jtb(F,P.a.lGh+" "+ea.a.$ua,null===
na||void 0===na?void 0:na.vertical);fb.Jtb(F,ea.a.kGh)}static Jtb(F,na,hb){const Ib=document.createElement("div");Ib.className=na;hb&&(Ib.style.backgroundImage=`url("${hb}")`);F.appendChild(Ib)}}Object(r.a)(fb,"SelectionRangePickerBehavior",S,[]);class Wa extends da{constructor(F,na,hb,Ib){super(F,na,hb,Ib)}get G4(){return 0}get aeb(){return this.gridView.ha.ra.xd}dTa(){const F=this.gridView.ei||this.gridView.eb;return this.gridView.ha.ra.eh&&!F&&super.dTa()}}Object(r.a)(Wa,"SelectionTouchGrippiesBehavior",
da,[]);var Ma=a(52);class lb extends w.a{constructor(F,na){super();this.K_a=(hb,Ib)=>{hb=Ib.G4;const vc=this.gridView;Ib=Ib.mhi;const nc=Ib.kg,Pb=Ib.yY;k.a.Pg&&Pb.push(new ab(nc,vc));switch(hb){case 24:Ib.yY.push(new kb(nc,Ib));break;case 0:Ib.yY.push(new Ja(nc,vc));k.a.lp||(Pb.push(new Wb(nc,this.gridView.$,Ib.paneType,this.tableManager,this.oo)),R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Pb.push(new Gb(nc,this.gridView.$,Ib.paneType,this.tableManager,
this.oo)));Pb.push(new Wa(Ib,nc,vc,Ib.paneType));break;case 3:Pb.push(new L(nc));k.a.lp||(Pb.push(new bb(nc,this.gridView.$,Ib.paneType,this.BF,this.oo,Ib)),Pb.push(new Ga(nc,this.gridView,this.BF,this.oo,Ib)),Pb.push(new vb(nc,this.gridView,this.BF,this.oo,Ib)));break;case 4:case 5:Pb.push(new Ka(nc,this.lve));break;case 30:Pb.push(new Pa(nc));break;case 16:Pb.push(new fb(nc,this.lve));Pb.push(new Cb(Ib,nc,vc,Ib.paneType));break;case 11:case 12:Pb.push(new ob(nc,11===hb));break;case 17:Pb.push(new L(nc));
break;case 19:Pb.push(new L(nc)),Pb.push(new T(Ib,nc,vc,Ib.paneType))}Ib.P2b=!0};this.$=F;this.gridView=oa.h(F);this.tableManager=na;this.BF=new xb(this.gridView);this.oo=new C(this.gridView);this.gridView.Eb&&(this.gridView.Eb.gQg(this.K_a),this.gridView.Eb.update(!1));F.da.Ha(64,this)}get lve(){R.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.kve&&(this.kve={vertical:Ma.a.current.Un(105),horizontal:Ma.a.current.Un(106)});return this.kve}dispose(){this.gridView.Eb.Joj(this.K_a);
this.BF&&(this.BF.dispose(),this.BF=null);super.dispose()}}Object(r.a)(lb,"GridHighlightsBehaviorManager",w.a,[]);class Na extends b.a{constructor(F){super();this.$=F;this.Gb()}create(){l.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Na),F=>{this.qb(this.$.da.Ba(64)||new lb(this.$,F.result))},this.ka,3)}static la(F){F.da.Ha(149,new Na(F))}}Object(r.a)(Na,"GridHighlightsBehaviorManagerFactory",b.a,[]);a.d(B,"a",function(){return X});const X=()=>{c.a.Fa(Na.la);c.a.Fa(d.la)}},
1184:function(r,B,a){var c=a(9),b=a(0),e=a(714),f=a(50),d=a(38),h=a(196),l=a(58);class k{constructor(Pb){this.hth=Pb}Mc(){return!1}executeCommand(Pb,oc){Pb=oc.command;oc=null;switch(Pb){case 1243860697:this.hth.JYj();break;default:oc=h.a(Pb)}return oc||l.Task.Ta(!0)}Ac(Pb,oc){return 1243860697===oc.command}Rc(){return!1}}Object(b.a)(k,"SheetDropdownMenuCommandHandler",null,[222]);var w=a(70),n=a(153),x=a(54);class m extends e.a{constructor(Pb){super(Pb)}ld(){Object(w.b)("OfficeVSO:7624897_MigrateContextMenuController")?
void n.a.resolve(x.G,{Wb:this.Na}).then(()=>{d.TaskExtensions.za(f.GetServiceTaskFactory.Pa(this.$.da,32,33,this.Na),Pb=>{this.fd([new k(Pb.result.h$f)])},this.$.ka)}):this.$.jz(Pb=>{Pb.ghc().then(()=>{d.TaskExtensions.za(f.GetServiceTaskFactory.Pa(this.$.da,32,33,this.Na),oc=>{this.fd([new k(oc.result.h$f)])},this.$.ka)})})}static la(Pb){e.a.Rd(392,new m(Pb))}}Object(b.a)(m,"SheetDropdownMenuCommandHandlerFactory",e.a,[]);var u=a(15),t=a(228),y=a(5),v=a(81),A=a(33),z=a(1),C=a(27),H=a(188),I=a(13),
S=a(91),P=a(47),D=a(243),G=a(166),E=a(113),O=a(41),N=a(424),J=a(87),W=a(14),ea=a(36);class R{constructor(){this.sOe=new ea.a(!0);this.eLc=0}get X9c(){return this.eLc}get navigationButtonsDisabled(){return!!(this.X9c&1)}get operationButtonsDisabled(){return!!(this.X9c&2)}EVg(Pb,oc){this.sOe.add(Pb,oc);this.vS()}vS(){this.eLc=0;ea.a.forEach(this.sOe.Du,Pb=>{this.eLc=this.X9c|Pb.value})}}Object(b.a)(R,"SheetTabBarDisabledStateManager",null,[]);var Y=a(242),U=a(34);class da{}da.ICh="ewa-stb-uir";da.sCh=
"ewa-stb-navarea";da.tCh="ewa-stb-navarea-dimensions";da.vCh="ewa-stb-navbutton";da.lU="cui-disabled";da.uCh="ewa-stb-navareaextra";da.Cia="cui-img-container";da.mCh="ewa-stb-contentarea";da.KUe="ewa-stb-left-scrollable";da.VUe="ewa-stb-right-scrollable";da.GCh="ewa-stb-tabarea";da.FCh="ewa-stb-sheettabmoveindicator";da.XUe="ewa-stb-tabs";da.qVj="tab-active";da.yVj="tab-inactive";da.xVj="tab-hover";da.HCh="ewa-stb-tabs-ghost";da.sVj="tab-anchor-text";da.dark="dark";da.light="light";da.rVj="tab-active-text";
da.vVj="tab-content-container";da.AVj="tab-text";da.yCh="ewa-stb-nsv-inactive";da.zCh="ewa-stb-nsv-inactive-svg";da.wCh="ewa-stb-nsv-active";da.xCh="ewa-stb-nsv-active-svg";da.fBh="ewa_nsv_margin";da.nCh="ewa-stb-disable-scrollbar";da.PDi="leave-size-fixed-on-tab-hover-old";da.ODi="leave-size-fixed-on-tab-hover";da.OUe="ewa-stb-locked-sheet";da.PUe="ewa-stb-locked-sheet-svg-16px";da.oCh="ewa-stb-dropdown-menu-button";da.Axh="ewa-active-sheet-menu-item";Object(b.a)(da,"CssClassNames",null,[]);var T=
a(751),ka=a(18),L=a(269),fa=a(106),wa=a(198),oa=a(256),xa=a(45),bb=a(295),Za=a(52),La=a(12),va=a(77),Ba=a(275),Ea=a(11),pa=a(104),$a=a(354),cb=a(21),ib=a(190),ta=a(380),Ya=a(376),Da=a(46),ba=a(229),ya=a(90);class V extends Y.a{constructor(Pb,oc,Ic=!1){super(Pb);this.Gbb=this.ota=null;this.$=oc;this.IX=Ic}get disabled(){return this.IX}dispose(){this.Gbb=this.ota=this.$=null;super.dispose()}rS(Pb){this.IX=Pb;this.domElement.setAttribute(y.a.$sa,Pb.toString());La.DOMElementExtensions.toggleCssClass(this.domElement,
T.a.lU,Pb)}}Object(b.a)(V,"SheetBarButton",Y.a,[]);var Z=a(732);class ja extends V{constructor(Pb,oc,Ic,ec=!1){super(document.createElement("a"),oc,ec);this.jd=mb=>{this.disabled||this.$.Yc(-1935155518,mb.wb,30,null);return!0};this.uHb=mb=>{mb="mouseover"===mb.type||"focus"===mb.type;const Ob=ta.a(this.$)?this.Gbb:this.ota;Ea.HelperMethods.u_d(Ob,this.Lha,this.Lha+y.a.Jgc,mb&&!cb.h(this.$).inRangePicker)};this.Di=()=>{this.rS(!0)};this.dg=()=>{this.rS(!1)};this.Lha=z.EwaSettings.xa(437)?ka.a.Qbd:
ka.a.FVe;this.ota=Ic.ob(this.domElement,W.a.instance.ga(509),0,this.Lha,W.a.instance.ga(510),Z.a.k5c,ec);Pb.appendChild(this.domElement);this.Gc.la("contextmenu",mb=>{va.g(mb)});z.EwaSettings.xa(437)||(this.Gc.la("mouseover",this.uHb),this.Gc.la("mouseout",this.uHb));ba.a.instance.ta(I.a.click,this.domElement,this.jd);this.Qla=E.KeyInputManager.instance.Mt(this.domElement,this.jd,ya.a.Sh,ya.a.nX);cb.h(this.$).oc.gl(this.Di);cb.h(this.$).oc.rm(this.dg)}dispose(){ba.a.instance.Aa(I.a.click,this.domElement,
this.jd);E.KeyInputManager.instance.ix(this.domElement,this.Qla);cb.h(this.$)&&cb.h(this.$).oc&&(cb.h(this.$).oc.Zk(this.Di),cb.h(this.$).oc.dm(this.dg));super.dispose()}rS(Pb){const oc=ja.M$f(this.$);super.rS(Pb||oc)}static M$f(Pb){return!Pb.isEditMode||!Pb.ua.count}}Object(b.a)(ja,"InsertSheetButton",V,[]);class la extends V{constructor(Pb,oc,Ic){super(document.createElement("a"),oc);this.jd=ec=>{this.$.Yc(-684145703,ec.wb,0,null);return!0};this.uHb=ec=>{Ea.HelperMethods.u_d(this.GAe,this.Lha,this.Lha+
y.a.Jgc,("mouseover"===ec.type||"focus"===ec.type)&&!cb.h(this.$).inRangePicker)};this.$=oc;this.Lha=z.EwaSettings.xa(437)?ka.a.Qbd:ka.a.FVe;this.GAe=Ic.ob(this.domElement,W.a.instance.ga(511),0,this.Lha,W.a.instance.ga(512),Z.a.k5c);Pb.appendChild(this.domElement);this.Gc.la("contextmenu",ec=>{va.g(ec)});this.Gc.la("mouseover",this.uHb);this.Gc.la("mouseout",this.uHb);ba.a.instance.ta(I.a.click,this.domElement,this.jd);this.Qla=E.KeyInputManager.instance.Mt(this.domElement,this.jd,ya.a.Sh,ya.a.nX)}dispose(){ba.a.instance.Aa(I.a.click,
this.domElement,this.jd);E.KeyInputManager.instance.ix(this.domElement,this.Qla);this.GAe=null;super.dispose()}}Object(b.a)(la,"InsertTemplateButton",V,[]);class ua{constructor(Pb,oc){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Pb;this.newSheetIndex=oc}getSheetName(){return this.sheetName}}Object(b.a)(ua,"MacroRecorderSheetReorderedPayload",null,[123]);var eb=a(96);class Eb extends Y.a{constructor(Pb,oc){super(document.createElement("div"));this.CR=()=>{u.ULS.sendTraceTag(537153794,0,
50,"SheetDropdownMenu.OnSheetsChanges");this.g_f(!1,"OnSheetsChanged")};this.VVi=()=>{this.Gj()};this.UVi=()=>{this.Xj()};this.$=Pb;this.$Vj=oc;this.LU=!1;this.lQb=0}dispose(){this.Xj();super.dispose()}JYj(){this.g_f(!0,"TogglerSheetDropdownMenu")}g_f(Pb,oc){u.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${oc}, toggle: ${Pb}, toggleStateId: ${this.lQb}`);Pb&&(this.lQb+=1);const Ic=this.$.Mb.Kc("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${oc}, toggle: ${Pb}, toggleStateId: ${this.lQb}, sheetCount: ${this.$.ua.count}`);
Pb=this.okh();appChrome.renderSheetDropdownMenu(this.domElement,this.$Vj,Pb,this.lQb,this.VVi,this.UVi,()=>{Ic.stop()},ta.a(this.$))}okh(){const Pb=this.$.ua,oc=[];for(let ec=0;ec<Pb.count;ec++){var Ic=Object(J.a)(pa.a,Pb.getItem(ec));0===Ic.EB&&(Ic=this.nkh(Ic),oc.push(Ic))}return oc}nkh(Pb){const oc={};oc.key=Pb.name;oc.text=Pb.name;oc.onClick=this.pkh(Pb);Pb.active&&(oc.className=ta.a(this.$)?"ewa-active-sheet-menu-item-present-mode":da.Axh);return oc}pkh(Pb){return()=>{const oc=new eb.a(-1876836819,
0,this.$.xc,30,null);this.$.Ia.Hb(oc,{[y.a.MUd]:Pb.name})}}Gj(){if(!this.LU){const Pb=this.$.ua;Pb.Yf(this.CR);Pb.zYc(this.CR);Pb.sY(this.CR);Pb.iha(this.CR);Pb.RGa(this.CR);Pb.Kse(this.CR);Pb.NZa(this.CR);this.LU=!0}}Xj(){if(this.LU){const Pb=this.$.ua;Pb.yg(this.CR);Pb.pNd(this.CR);Pb.b7(this.CR);Pb.Gna(this.CR);Pb.qRa(this.CR);Pb.fZf(this.CR);Pb.RKb(this.CR);this.LU=!1}}}Object(b.a)(Eb,"SheetDropdownMenu",Y.a,[478,3]);var Wb=a(358);class Ab extends V{constructor(Pb,oc,Ic){super(document.createElement("a"),
Pb,!0);this.Uf=()=>{this.rS(!1);this.$.ea.Zm(this.Uf)};this.jd=ec=>{this.dig(ec.wb);return!0};this.onKeyDown=ec=>13===ec.Ea.keyCode||32===ec.Ea.keyCode?(this.dig(ec.wb),!0):!1;this.ota=oc.ob(this.domElement,W.a.instance.ga(513),0,ka.a.lCh,W.a.instance.ga(513),Z.a.zbi,this.disabled);this.domElement.classList.add(da.oCh);Ic.appendChild(this.domElement);this.lvh();this.dkj()}dispose(){this.F2j();super.dispose()}rS(Pb){super.rS(Pb||!this.$.ea.jla)}lvh(){const Pb=this.$.ea;Pb.Kf?this.rS(!1):Pb.Zj(this.Uf)}dig(Pb){this.disabled||
(u.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${Wb.a[Pb]}`),this.$.Ia.Hb(new eb.a(1243860697,Pb,this.$.xc,30,null)))}dkj(){ba.a.instance.ta(I.a.click,this.domElement,this.jd);E.KeyInputManager.instance.ta(I.a.Vb,this.domElement,this.onKeyDown)}F2j(){ba.a.instance.Aa(I.a.click,this.domElement,this.jd);E.KeyInputManager.instance.Aa(I.a.Vb,this.domElement,this.onKeyDown)}}Object(b.a)(Ab,"SheetDropdownMenuAnchor",V,[]);var Jb=a(63);const Gb=(Pb,oc,Ic,ec,mb,Ob,Ta,
sb=null)=>{sb=Pb.Oa(9,sb);sb.sheetName=oc;sb.newSheetIndex=Ic;return Jb.g(Pb,"ReorderSheets",sb,ec,mb,Ob,Ta,0)};var Nb=a(183),Ja=a(138),ab=a(197),wb=a(132),xb=a(60),rb=a(215),za=a(206),Aa=a(174),pb=a(133);class kb{constructor(Pb,oc,Ic){this.ym=oc;this.Fw=Ic;this.sheet=Pb;this.altText=W.a.instance.ga(1994)}UH(){return this.sheet.active}rsd(){return this.sheet.isLockPausedInSession}zta(){return this.ym?ka.a.NUe:this.UH()?ka.a.MUe:ka.a.LUe}Voa(){return this.sheet.Xh?Z.a.uSf:Z.a.s2j}bZd(){return 16}Yha(){return null}Ata(){return this.ym?
this.Fw?da.PUe:da.OUe:null}E_d(){return null}Es(){return null}Eod(){return 0}e_c(){return!0}}Object(b.a)(kb,"LockPausedSheetIconDataSource",null,[471]);class Cb{constructor(Pb,oc,Ic){this.ym=oc;this.Fw=Ic;this.sheet=Pb;this.altText=W.a.instance.ga(1993)}UH(){return this.sheet.active}rsd(){return this.sheet.Xh}zta(){return this.ym?ka.a.NUe:this.UH()?ka.a.MUe:ka.a.LUe}Voa(){return Z.a.uSf}bZd(){return 16}Yha(){return null}Ata(){return this.ym?this.Fw?da.PUe:da.OUe:null}E_d(){return null}Es(){return null}Eod(){return 0}e_c(){return!0}}
Object(b.a)(Cb,"LockedSheetIconDataSource",null,[471]);class ob{constructor(Pb,oc,Ic,ec){this.sheet=Pb;this.altText=W.a.instance.ga(1908);this.YYj=oc;this.Pag=Ic;this.Fw=ec}UH(){return this.sheet.active}rsd(){return this.sheet.ie.uz}Yha(){return this.Fw?this.UH()?da.xCh:da.zCh:this.UH()?da.wCh:da.yCh}zta(){return!this.UH()&&this.Pag()?ka.a.kEh:ka.a.jEh}Voa(){return!this.UH()&&this.Pag()?Z.a.iJj:Z.a.hJj}bZd(){return 14}Ata(){return da.fBh}E_d(){return this.sheet.ie.Fob}Es(){return this.YYj}Eod(){return 8}e_c(){return!1}}
Object(b.a)(ob,"NamedSeetViewSheetIconDataSource",null,[471]);var qa=a(167),ma=a(136);class Ga{constructor(Pb,oc){this.ora=this.C1=this.cCa=this.Gl=null;this.snf=!1;this.SUc=this.Voa=this.Ata=this.Yha=this.zta=null;this.DN=()=>{this.dataSource.UH()&&d.TaskExtensions.za(this.CEb,()=>{dialogControls.renderToolTip(this.dataSource.Es(),"SheetIconTooltip",this.dataSource.E_d(),this.JI,10,!1,!1,1)},this.$.ka,3)};this.CN=()=>{this.dataSource.UH()&&this.clearToolTip()};this.$=Pb;this.dataSource=oc;this.Fw=
A.a.Ztd()}get Gc(){return this.C1||(this.C1=ma.a.instance.qe(this.JI))}get CEb(){if(this.ora)return this.ora;const Pb=new qa.a;this.$.jz(oc=>{d.TaskExtensions.za(oc.Axd(),()=>{Pb.setResult(!0)},this.$.ka,3)});return this.ora=Pb.task}get JI(){return this.SUc}Amg(){if(this.JI&&(this.Gl||this.cCa)){if(this.Fw){var Pb=this.dataSource.Voa();this.Voa!==Pb&&(this.cCa&&this.cCa.parentNode.removeChild(this.cCa),this.nhf(),this.Voa=Pb)}else Pb=this.dataSource.zta(),this.zta!==Pb&&(this.uOd(this.Gl,this.zta,
Pb),this.zta=Pb);Pb=this.dataSource.Yha();this.Yha!==Pb&&(this.Fw?this.brj(this.cCa,this.Yha,Pb):this.uOd(this.Gl,this.Yha,Pb),this.Yha=Pb);Pb=this.dataSource.Ata();this.Ata!==Pb&&(this.uOd(this.JI,this.Ata,Pb),this.Ata=Pb);this.dataSource.Es()&&!this.dataSource.UH()&&this.clearToolTip()}}aOj(Pb,oc,Ic){this.Ami(Pb,oc,Ic);La.DOMElementExtensions.setVisible(this.JI,this.dataSource.rsd())}clearToolTip(){d.TaskExtensions.za(this.CEb,()=>{dialogControls.clearToolTip(this.dataSource.Es())},this.$.ka,3)}Ami(Pb,
oc,Ic){this.JI&&this.snf!==Pb&&(this.JI.parentNode.removeChild(this.JI),this.Ata=this.Yha=this.Voa=this.zta=this.SUc=null,this.dataSource.Es()&&(this.Gc.detach("mouseover",!0),this.Gc.detach("mouseout",!0)));this.JI||(this.SUc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.JI,T.a.Cia),Sys.UI.DomElement.addCssClass(this.JI,ka.a.kv),z.EwaSettings.xa(437)?Pb===this.dataSource.e_c()?oc.appendChild(this.JI):oc.insertBefore(this.JI,Ic):Pb?oc.insertBefore(this.JI,Ic):oc.appendChild(this.JI),
this.Fw?this.nhf():(this.Gl=document.createElement("img"),this.Gl.tabIndex=-1,this.Gl.alt=this.dataSource.altText,this.JI.appendChild(this.Gl),this.Gl.src=Za.a.Le(this.dataSource.Eod())),this.dataSource.Es()&&(this.Gc.la("mouseover",this.DN,!0),this.Gc.la("mouseout",this.CN,!0)),this.snf=Pb)}brj(Pb,oc,Ic){Pb&&(Sys.UI.DomElement.removeCssClass(Pb,oc),Sys.UI.DomElement.addCssClass(Pb,Ic))}uOd(Pb,oc,Ic){oc&&Sys.UI.DomElement.removeCssClass(Pb,oc);Ic&&Sys.UI.DomElement.addCssClass(Pb,Ic)}dispose(){S.a.Ja(this.C1)}nhf(){const Pb=
this.$.da.Ba(388);Pb?(this.cCa=Pb.uka(this.dataSource.Voa(),this.dataSource.bZd()))?this.JI.appendChild(this.cCa):u.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Voa()} was not found.`):u.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(b.a)(Ga,"SheetIcon",null,[3]);var vb=a(359),Ka=a(99),Pa=a(165);class fb extends Ka.a{constructor(Pb,oc){super(Pb.domElement);this.onKeyDown=Ic=>
{121===Ic.keyCode&&Ic.shiftKey&&!this.woa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.woa.anchor),va.g(Ic))};this.Tca=Ic=>{if(!this.$.isEditMode||this.woa.disabled)return!0;this.rename(!1,Ic.wb);return!0};this.$l=Ic=>this.woa.disabled?!0:this.showContextMenu(Ic.clientPoint,Ic.wb,Ic.Ob);this.zle=Pb;this.$=oc;ba.a.instance.ta(I.a.yk,Pb.domElement,this.Tca);vb.a.instance.ta(Pb.domElement,this.$l);this.Gc.la("keydown",this.onKeyDown)}get woa(){return this.zle}dispose(){this.woa&&(ba.a.instance.Aa(I.a.yk,
this.woa.domElement,this.Tca),vb.a.instance.Aa(this.woa.domElement,this.$l),this.zle=null);this.$=null;super.dispose()}showContextMenu(Pb,oc,Ic){this.woa.activate(oc,A.a.Mud());oc=new eb.a(-1075099431,oc,this.$.xc,30,null);let ec;return!Pa.a(ec=this.$.Ia.Hb(oc,{[y.a.j$f]:Pb,[fb.$Ij]:this.woa.sheet,[y.a.k$f]:Ic}))&&(6!==ec.status||ec.result)}rename(Pb,oc){this.$.Yc(817296323,oc,Pb?19:0,null)}}fb.$Ij="Sheet";Object(b.a)(fb,"SheetOpsSheetClickHelper",Ka.a,[]);var Wa=a(40),Ma=a(62),lb=a(108);class Na extends V{constructor(Pb,
oc,Ic,ec,mb,Ob,Ta){super(document.createElement("li"),Pb);this.YIj=100;this.ZIj=500;this.K4c=this.J4c=0;this.k8c=.5;this.LU=this.KUd=!1;this.color=this.RKc=this.OE=this.WFb=this.IO=null;this.okc=this.bmf=!1;this.Q7b="#BEBBB8";this.qIc=null;this.onKeyDown=sb=>13!==sb.Ea.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Cz=sb=>32!==sb.Ea.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.DN=()=>{this.disabled||this.I0.eR||this.noa(!0,void 0,"OnMouseOver")};this.CN=()=>{this.disabled||
this.noa(!1,void 0,"OnMouseOut")};this.tHb=()=>{this.I0.eR||(this.CSj(),Object(Ma.c)(this.sheet.sheetProcessedData)||cb.h(this.$).SAa(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.t6=()=>{this.BRe(!1);return!1};this.jd=sb=>{if(this.disabled)return!0;const zb=cb.h(this.$);this.sheet.active||3!==sb.wb?this.ym?this.activateSheet(sb.wb):A.a.Mud()&&zb.focus():(!A.a.WNa()&&!this.nDb||zb.eb||zb.ei||zb.Fub(),this.activateSheet(sb.wb));return 3!==sb.wb};this.onPointerDown=sb=>{if(this.disabled)return!0;
this.BRe(!0);cb.h(this.$).inRangePicker&&u.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var zb=3===sb.wb;if(2===sb.wb||zb&&this.Oxa)this.ym?(this.noa(!0,!zb,"OnPointerDown"),zb=l.Task.delay(zb?this.ZIj:this.YIj).Yo(()=>!0)):zb=this.activateSheet(sb.wb),this.GCb&&(this.okc=!0,this.I0.qwc=d.TaskExtensions.za(zb,()=>{this.okc&&this.I0.G3i(this,sb)},this.ka,11));return!1};this.fh=sb=>{if(this.disabled||
!this.GCb&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.okc=!1;this.ym&&this.noa(2===sb.wb,void 0,"OnPointerUp");this.I0.qwc&&(d.TaskExtensions.za(this.I0.qwc,()=>{this.I0.F3i()},this.ka,11),this.I0.qwc=null);return!1};this.HN=()=>{this.okc=!1;this.KUd||this.noa(!1,void 0,"OnTouchMove");return!1};this.SEe=new fb(this,Pb);this.ym=Ob;this.Fw=Ta;this.nDb=A.a.nDb();this.ord=z.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&
!this.Fw;this.ym?(this.J4c=18,this.K4c=20):(this.J4c=19,this.K4c=22);this.$=Pb;this.PYb=ec;this.I0=mb;this.GCb=mb.Hue();this.ykh();this.qeh();this.god=Pb.Mb.vg("UserAction",this.name);this.qsd=!1;La.DOMElementExtensions.Rt(this.domElement,y.a.yq,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.OE);this.uoa=new ab.a;Pb=new Cb(this.sheet,this.ym,this.Fw);this.uoa.add(new Ga(this.$,Pb));this.$.ea.TNb&&(Pb=new kb(this.sheet,this.ym,this.Fw),this.uoa.add(new Ga(this.$,Pb)));
this.ord||(Pb=new ob(this.sheet,this.I0.$zc,()=>this.color?Na.NVd(this.color):!1,this.Fw),this.WFb=new Ga(this.$,Pb),this.uoa.add(this.WFb));this.Oxa=this.I0.Oxa;this.thb();this.wlj();this.Lze=new bb.a(this.domElement,1);oc.insertBefore(this.domElement,Ic);ta.a(this.$)&&this.ung(!0)}get Rnh(){return this.RKc||(this.RKc=za.a.cp("#F5F5F5"))}get name(){return this.IO.innerText}set name(Pb){this.IO&&(this.IO.innerText=Pb,this.OEc(),this.vng())}get sheet(){return this.PYb}get anchor(){return this.qIc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Pb){this.anchor.tabIndex=
Pb}qZh(){return La.DOMElementExtensions.If(this.anchor)?this.anchor:null}dispose(){if(this.LU){D.a.instance.Aa(I.a.pointerDown,this.domElement,this.onPointerDown);E.KeyInputManager.instance.Aa(I.a.Vb,this.domElement,this.onKeyDown);E.KeyInputManager.instance.Aa(I.a.np,this.domElement,this.Cz);ba.a.instance.Aa(I.a.click,this.domElement,this.jd);D.a.instance.Aa(I.a.mW,this.domElement,this.tHb);D.a.instance.Aa(I.a.sB,this.domElement,this.t6);if(this.GCb||z.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))D.a.instance.Aa(I.a.Of,
this.domElement,this.fh),this.Oxa&&(G.a.instance.Aa(I.a.Ae,this.domElement,this.fh),G.a.instance.Aa(I.a.mg,this.domElement,this.HN));this.LU=!1;this.Q7b="#BEBBB8"}S.a.sc([this.SEe,this.Lze]);this.IO=this.OE=this.qIc=this.I0=this.Lze=this.SEe=null;if(this.uoa){for(let Pb of this.uoa)Pb.dispose();this.uoa=null}this.color=this.PYb=null;super.dispose()}rS(Pb){Pb&&this.noa(!1,!1);super.rS(Pb)}Pbg(Pb){if(xb.a.rg.dR){this.yOe();var oc=Object(w.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Object(lb.c)(n.a.resolve(x.A,
{Wb:1})):f.GetServiceTaskFactory.Pa(this.$.da,322,323,1);d.TaskExtensions.za(oc,Ic=>{Nb.UISurfaces.xH().then(ec=>{const mb=Ic.result;mb.cFj(ec);mb.show(Pb);return null},ec=>{u.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${ec}`);return null})},this.ka,3)}}hre(){if(this.sheet.active&&this.$.Hp){var Pb=this.$.Hp,oc=cb.h(this.$),Ic=oc.qj;if(this.sheet.ie.uz){if(!this.WFb){const ec=new ob(this.sheet,this.I0.$zc,()=>this.color?Na.NVd(this.color):
!1,this.Fw);this.WFb=new Ga(this.$,ec);this.uoa.add(this.WFb)}Ic&&oc.ihb(1);Pb.classList.add(ka.a.iXe);Pb=Na.R6e(y.a.lzf);oc=Na.R6e(y.a.BBd);"true"===Pb&&"true"===oc?this.$.ea.EVd&&this.$.ea.lOb&&(this.sheet.ie.tK?(Pb=1,Ja.a.Bs(y.a.BBd,"false",Ja.a.v_),this.$.ea.lOb=!1):Pb=0,Ja.a.Bs(y.a.lzf,"false",Ja.a.v_),this.$.ea.EVd=!1,this.Pbg(Pb)):this.sheet.ie.tK&&"true"===oc&&this.$.ea.lOb&&(Ja.a.Bs(y.a.BBd,"false",Ja.a.v_),this.$.ea.lOb=!1,this.Pbg(2))}else this.yOe(),Ic&&oc.ihb(0),Pb.classList.remove(ka.a.iXe)}}yOe(){const Pb=
Object(w.a)({TV:322,new:x.A,registry:this.$.da,p6g:"OfficeVSO:7629405_namedSheetViewPublic_Migration"});Pb&&Pb.dismiss()}thb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.g8a()?da.qVj:da.yVj;z.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.IO.parentNode.classList.add(da.ODi):this.IO.parentNode.classList.add(da.PDi);this.vng();this.ord&&this.hre();this.bOj();this.Eng();this.OEc();this.ord||this.hre()}E3i(){this.KUd=!0;this.noa(!0,!0,"OnSheetReorderStarted")}D3i(){this.KUd=
!1;this.noa(!1,void 0,"OnSheetReorderEnded")}activate(Pb=0,oc=!1){this.F4b()||(this.sheet.activate(),oc&&cb.h(this.$).focus(),Pb={["InputMethod"]:Wb.a[Pb],["AppMode"]:this.$.xc,["Location"]:"canvas"},pb.b(this.$).qd(wb.a.VIj,Pb))}ung(Pb){this.Q7b=Pb?"#797775":"#BEBBB8";this.k8c=Pb?-.5:.5;this.RKc=Pb?za.a.cp("#3B3A39"):za.a.cp("#F5F5F5");this.Eng()}NBj(Pb){this.GCb=Pb}eEd(Pb){Pb.A5c();this.eDe(Pb)}eDe(Pb){Pb.C1a();this.sheet.activate()}GKg(Pb){Pb=new eb.a(-1876836819,Pb,this.$.xc,30,null);return this.$.Ia.Hb(Pb,
{[y.a.MUd]:this.sheet.name})}vng(){this.IO.parentNode.setAttribute("sheet-title",this.IO.innerText)}OEc(){const Pb=this.MSh();this.anchor.setAttribute(y.a.fv,Pb);this.anchor.setAttribute(y.a.k$,this.sheet.active.toString())}MSh(){const Pb=this.sheet.ie.uz,oc=this.sheet.ie.Fob,Ic=this.sheet.Xh,ec=this.sheet.isLockPausedInSession;return Pb&&Ic?String.format(W.a.instance.nb(20),this.name,oc):Pb&&ec?String.format(W.a.instance.nb(22),this.name,oc):Pb?String.format(W.a.instance.nb(19),this.name,oc):Ic?
String.format(W.a.instance.nb(18),this.name):ec?String.format(W.a.instance.nb(21),this.name):this.name}activateSheet(Pb=0){if(A.a.Mud()){if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.F4b())return l.Task.Ta(!1);Aa.a.current.hO="ActivateSheet";this.sheet.activate();return l.Task.Ta(!0)}return this.GKg(Pb)}Eng(){const Pb=this.sheet.tabColor;this.color=Pb?za.a.cp(Pb):this.Rnh;this.bmf=Na.NVd(this.color);this.noa(!1,void 0,"UpdateTabColor")}noa(Pb,oc=!1,
Ic=null){if(this.sheet){Ic=this.sheet.active;var ec=this.g8a(),mb=!!this.sheet.tabColor,Ob=za.a.kG(Ic||ec?rb.a.white:this.color);this.OE.style.background="";Ic||ec?(mb?z.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.kMa?this.TGj():this.ym?this.SGj():this.RGj():this.ym||(this.OE.style.backgroundColor=Ob),this.OE.style.height=this.J4c.toString()+"px"):(this.OE.style.filter="",this.OE.style.backgroundColor=Ob,this.OE.style.height=this.K4c.toString()+"px");
this.IO.className=Ic?da.rVj:ec?da.dark:this.bmf?da.light:da.dark;for(let Ta of this.uoa)Ta.Amg();this.ym&&(Pb&&!mb&&(this.OE.style.backgroundColor="#E1DFDD"),La.DOMElementExtensions.toggleCssClass(this.domElement,da.xVj,Pb),oc?(mb||(this.OE.style.backgroundColor=this.Q7b),this.domElement.style.backgroundColor=this.Q7b):(mb||(this.OE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.IO.style.fontWeight=Ic||ec||!this.ym&&Pb?this.ym?"600":"bold":""}else u.ULS.sendTraceTag(537153687,
0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${Ic}`)}SGj(){const Pb=this.OE.style,oc=za.a.kG(Na.b3c(this.color,this.k8c));Pb.background=oc}RGj(){const Pb=this.OE.style,oc=za.a.kG(Na.b3c(this.color,1)),Ic=za.a.kG(Na.b3c(this.color,this.k8c));Pb.background=`$linear-gradient(${oc}, ${Ic})`}TGj(){this.OE.style.background="transparent"}qeh(){this.qIc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=
da.sVj;La.DOMElementExtensions.Rt(this.anchor,y.a.rqb,null,null);this.tabIndex=-1}ykh(){this.OE=document.createElement("span");this.OE.className=da.vVj;this.IO=document.createElement("span");this.IO.className=da.AVj;this.IO.dir=this.sheet.rtlName?"rtl":"ltr";this.OE.appendChild(this.IO)}bOj(){const Pb=this.$.oJ;for(let oc of this.uoa)oc.aOj(Pb,this.OE,this.IO)}g8a(){return cb.h(this.$).g8a(this.sheet)}CSj(){this.god.start();this.qsd=!0}BRe(Pb){this.qsd&&(this.god.stop(),u.ULS.sendTraceTag(537153686,
0,50,Wa.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.god.Fc,["Has been clicked"]:Pb})),this.qsd=!1)}wlj(){D.a.instance.ta(I.a.pointerDown,this.domElement,this.onPointerDown);E.KeyInputManager.instance.ta(I.a.Vb,this.domElement,this.onKeyDown);E.KeyInputManager.instance.ta(I.a.np,this.domElement,this.Cz);this.Gc.la("mouseover",this.DN);this.Gc.la("mouseout",this.CN);D.a.instance.ta(I.a.mW,this.domElement,this.tHb);D.a.instance.ta(I.a.sB,this.domElement,
this.t6);if(this.GCb||z.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))D.a.instance.ta(I.a.Of,this.domElement,this.fh),this.Oxa&&(G.a.instance.ta(I.a.Ae,this.domElement,this.fh),G.a.instance.ta(I.a.mg,this.domElement,this.HN));ba.a.instance.ta(I.a.click,this.domElement,this.jd);this.LU=!0}F4b(){const Pb=this.$.da.Ba(65);return Pb&&Pb.kla()?(Pb.Lxc(),this.eDe(Pb),!0):!1}static R6e(Pb){let oc=Ja.a.get(Pb);oc||(Ja.a.Bs(Pb,"true",Ja.a.v_),oc=Ja.a.get(Pb));return oc}static b3c(Pb,
oc){if(1<oc||-1>oc)return Pb;let Ic=Pb.r,ec=Pb.g;Pb=Pb.b;0<oc?(Ic=Ic*(1-oc)+255*oc,ec=ec*(1-oc)+255*oc,Pb=Pb*(1-oc)+255*oc):(Ic*=1+oc,ec*=1+oc,Pb*=1+oc);return rb.a.Swb(Math.round(Ic),Math.round(ec),Math.round(Pb))}static NVd(Pb){return 128>=(222*Pb.r+707*Pb.g+71*Pb.b)/1E3}}Object(b.a)(Na,"SheetTabButton",V,[]);class X extends V{constructor(Pb,oc,Ic){super(document.createElement("a"),oc);this.Lha=z.EwaSettings.xa(437)?ka.a.Qbd:ka.a.EDh;Ic.ob(this.domElement,W.a.instance.ga(713),0,this.Lha,W.a.instance.ga(713),
Z.a.k5c,!0);Pb.appendChild(this.domElement);this.Gc.la("contextmenu",ec=>{va.g(ec)})}}Object(b.a)(X,"WorkbookProtectionButton",V,[]);var F=a(53),na=a(43),hb=a(61);class Ib extends Y.a{constructor(Pb,oc,Ic=null,ec=null){super(oc);this.sheetTabActivatePreviousHidden=W.a.instance.ga(722);this.sheetTabActivateNextHidden=W.a.instance.ga(724);this.svgIconProvider=null;this.yh=[];this.IK=Array(6);this.LBd=Array(6);this.WSa=this.OAb=this.FH=this.Teb=this.dAc=this.RUd=this.Dm=null;this.isRtl=!1;this.JV=this.hz=
0;this.C9b=this.pwc=!1;this.dtc=this.Wna=0;this.zM=this.D3=this.Eaa=this.L9b=null;this.cfc=this.$C=0;this.zPb=null;this.IDb=-1;this.s3=null;this.isc=0;this.VBc=-1;this.nna=0;this.vua=new R;this.WOc=!1;this.qwc=this.eAc=this.UNb=this.wle=this.z_=null;this.wde=!1;this.htmlSanitizationHelper=this.vle=null;this.uD=(mb,Ob)=>{this.cLf(Ob.item)};this.Hza=(mb,Ob)=>{mb=this.$.ua.na.index;for(let Ta=0,sb=this.yh.length;Ta<sb;Ta++){const zb=this.eV(Ta);if(zb.name===Ob.oldName){zb.name=Ob.newName;this.g0();Ta===
mb&&this.k7(6);break}}};this.gLf=(mb,Ob)=>{(mb=this.fwb(Ob.item))&&mb.thb()};this.hLf=(mb,Ob)=>{Ob.visible?(this.OSa(!1),this.dLf(Ob.item)):this.cLf(Ob.item)};this.p6=mb=>{this.eR?(this.s3=mb,this.VQb()):(this.s3&&(this.dtc+=this.s3.clientPoint.x-mb.clientPoint.x),this.s3=mb,Math.abs(this.dtc)>=this.$sh&&this.VQb());return!0};this.HN=mb=>{mb.Ea.preventDefault();return!1};this.H4f=mb=>{this.E4f(mb,!0)};this.G4f=mb=>{this.E4f(mb,!1)};this.q6=mb=>{if(this.eR){this.C9b=this.Usi(mb);let Ob;mb=(Ob=this.eV(this.$C+
1))?Ob.sheet:null;this.reorderSheets(mb,this.$C+1===this.PUd,!0)}this.FU();return!0};this.rj=(mb,Ob)=>{Ob.OF&&this.p2d(Ob.OF);this.jzc(!1);this.g0();Ob.na&&(this.p2d(Ob.na),this.k7(6),this.ea.Xma())};this.FBf=(mb,Ob)=>{this.IFc(Ob.item)};this.GBf=(mb,Ob)=>{this.IFc(Ob.item)};this.HBf=(mb,Ob)=>{this.IFc(Ob.item)};this.DPa=(mb,Ob)=>{this.IFc(Ob.item)};this.nza=()=>{this.$3c()};this.od=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.$3c();this.U7c();z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&(hb.d(this.$)||hb.e(this.$))&&(na.PageLoadTrackingInfo.instance.QR(y.a.FBa,["sheetTabBar"]),na.PageLoadTrackingInfo.instance.DW(y.a.FBa,["sheetTabBar"]));this.C7c();this.g0();this.OSa(!0);this.k7(6)};this.Ak=()=>{this.isVisible&&(this.g0(),this.k7(6))};this.xf=()=>{Object(N.a)(ja,this.FH)===fa.k(this.$.gg)&&this.C7c();for(const mb of this.yh)mb.NBj(!fa.k(this.$.gg))};this.fLf=(mb,Ob)=>{this.Tqj(Ob.item,Ob.isUserOperation)};this.KHb=(mb,Ob)=>{this.dLf(Ob.item)};this.onKeyDown=mb=>{switch(mb.keyCode){case 9:var Ob=
this.domElement.querySelectorAll(La.DOMElementExtensions.Hq);const Ta=La.DOMElementExtensions.Dl(Ob);Ob=La.DOMElementExtensions.UA(Ob);La.DOMElementExtensions.xBa(mb,Ta,Ob);break;case 39:case 37:La.DOMElementExtensions.C7f(mb,this.domElement.querySelectorAll(La.DOMElementExtensions.Hq),39===mb.keyCode?!this.isRtl:this.isRtl)}u.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${mb.keyCode}`)};this.onScroll=()=>{this.Dm.scrollLeft!==this.Wna&&this.cXj()};this.FN=mb=>{if(mb.ctrlKey||
mb.f3)return!1;this.Dm.scrollLeft+=Math.floor(30*mb.iDa);if(this.eR){const Ob=this.r5e("OnMouseWheel");Ob&&this.eZd(0<mb.iDa,Ob.x+Ob.width/2)}return!0};this.LF=(mb,Ob)=>{if(this.vua)this.jcf("PartialInteractivity",Ob.TL?3:0);else{this.FU(!1);this.wTd(Ob.TL);for(const Ta of this.Fye)Ta&&Ta.rS(Ob.TL);for(const Ta of this.yh)Ta&&Ta.rS(Ob.TL)}};this.VGb=(mb,Ob)=>{mb=0;Ob.spe&&(mb=2|(Ob.aJj?1:0));this.jcf("ComponentRangePicker",mb)};this.$=Pb;this.ea=this.$.ea;this.T9b=!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");
this.ym=z.EwaSettings.xa(437);this.Fw=A.a.Ztd();this.Cof=this.ym&&!this.$.Ev;this.wde=this.ym&&!C.a.Cw;this.xui=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.POi=this.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;this.OOi=this.$.ya.SheetTabNavigateButtonIntervalPeriodMS;this.$sh=this.$.ya.SheetTabDragStartPixelThreshold;this.uQa=this.vQa=-1;this.X5c=!1;this.htmlSanitizationHelper=ec;this.Fw&&(this.svgIconProvider=Ic);this.oC=new bb.a(this.domElement,3);this.ym&&
this.domElement.classList.add(da.ICh);this.fih();this.Jfh();this.gih();z.EwaSettings.eN()&&document.getElementById(y.a.yba)||this.ljh();this.jzc(!0);this.od(null,null);Pb=this.$.ua;Pb.Yf(this.rj);Pb.zYc(this.nza);Pb.sY(this.uD);Pb.iha(this.KHb);Pb.RGa(this.Hza);Pb.Kse(this.fLf);Pb.NZa(this.hLf);Pb.sQg(this.gLf);Pb.KYc(this.FBf);Pb.Hse(this.GBf);Pb.Ise(this.HBf);Pb.Jse(this.DPa);this.$.hl(this.od);this.$.iC(this.Ak);L.a(this.$).fi(this);this.$.da.Ha(32,this);z.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&
this.$.ea.ju(this.xf);this.cAc=this.Fe.qe(this.domElement);this.cAc.la("keydown",this.onKeyDown);Da.a(this.$).Tp()&&this.LF(null,new Ya.a(!0));Da.a(this.$).Wf.Q9(this.LF);cb.h(this.$).ese(this.VGb);this.cAc.la("mousedown",mb=>{mb.preventDefault()});H.a.instance.ta(I.a.lD,this.domElement,this.FN);this.QUd=this.Fe.qe(this.Dm);this.QUd.la("scroll",this.onScroll);this.cXj=Ba.b(()=>{this.g0()},200,this.$.ka,xa.a.fJj,!0);this.$.YA(y.a.gQj);this.Cof&&(this.vle=new Eb(this.$,this.WSa.domElement));z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&na.PageLoadTrackingInfo.instance.k0(y.a.FBa,["sheetTabBar"])}get mc(){return this.domElement}get If(){return this.isVisible}get ee(){return oa.a.OUd}get eR(){return this.WOc}get PUd(){return this.yh.length}get $zc(){return this.wle}get Oxa(){return this.wde}get navigationButtonsDisabled(){return!!this.vua&&this.vua.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.vua&&this.vua.operationButtonsDisabled}get KBd(){return this.ym?this.$.oJ?[ka.a.T$b,ka.a.SUe,ka.a.UUe,ka.a.S$b,
ka.a.Xua,ka.a.Xua]:[ka.a.S$b,ka.a.UUe,ka.a.SUe,ka.a.T$b,ka.a.Xua,ka.a.Xua]:this.$.oJ?[ka.a.T$b,ka.a.RUe,ka.a.TUe,ka.a.S$b,ka.a.Xua,ka.a.Xua]:[ka.a.S$b,ka.a.TUe,ka.a.RUe,ka.a.T$b,ka.a.Xua,ka.a.Xua]}get MBd(){return this.$.oJ?[null,Z.a.JGe,Z.a.HGe]:[null,Z.a.HGe,Z.a.JGe]}get PQf(){return this.$.oJ?[null,Z.a.KGe,Z.a.IGe]:[null,Z.a.IGe,Z.a.KGe]}get oEb(){if(this.isRtl){if(C.a.xF)return 0;if(C.a.Ff)return-1*(this.Dm.scrollWidth-this.Dm.clientWidth);if(C.a.Cw)return this.Dm.scrollWidth-this.Dm.clientWidth;
u.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get VLb(){if(this.isRtl){if(C.a.xF)return this.Dm.scrollWidth-this.Dm.clientWidth;if(C.a.Ff||C.a.Cw)return 0;u.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Dm.scrollWidth-this.Dm.clientWidth}get Fye(){return this.vua?[this.FH,this.OAb]:[this.FH,this.OAb,this.WSa]}get zVj(){return this.yh.concat(this.WSa)}get h$f(){return this.vle}ob(Pb,oc,
Ic,ec,mb,Ob,Ta=!1){Pb.removeAttribute("Href");Pb.setAttribute(y.a.Jd,y.a.Ws);Pb.className=da.vCh;Pb.title=oc;Pb.tabIndex=0;this.Fw&&Ob?Ic=this.svgIconProvider.Lba(Ob,12,12,Pb,24,24):(oc=document.createElement("span"),oc.className=this.ym?ka.a.c9g:ka.a.kv,oc.classList.add(T.a.Cia),oc.tabIndex=-1,Pb.appendChild(oc),Ob=document.createElement("img"),Ob.src=Za.a.Le(Ic),Ob.className=ec,Ob.alt=mb,Ob.tabIndex=-1,oc.appendChild(Ob),Ic=Ob);Ta&&Pb.classList.add(T.a.lU);return Ic}dispose(){if(this.$){var Pb=
this.$.ua;Pb.yg(this.rj);Pb.pNd(this.nza);Pb.b7(this.uD);Pb.Gna(this.KHb);Pb.qRa(this.Hza);Pb.fZf(this.fLf);Pb.RKb(this.hLf);Pb.Qoj(this.gLf);Pb.BNd(this.FBf);Pb.cZf(this.GBf);Pb.dZf(this.HBf);Pb.eZf(this.DPa);this.$.em(this.od);this.$.UF(this.Ak);Da.a(this.$)&&Da.a(this.$).Wf.Rda(this.LF);this.vua&&cb.h(this.$).GYf(this.VGb);H.a.instance.Aa(I.a.lD,this.domElement,this.FN)}S.a.sc(this.LBd);this.LBd=null;if(this.IK)for(Pb=0;Pb<this.IK.length;Pb++){const oc=La.DOMElementExtensions.cK(this.IK[Pb],this.domElement,
!1,"a");oc&&P.a.yna(oc)}S.a.Ja(this.oC);S.a.Ja(this.cAc);S.a.Ja(this.QUd);this.QUd=this.cAc=this.OAb=this.FH=this.oC=null;this.$&&this.FU(!1);this.Eaa=null;this.OSd(null,"Dispose");this.zPb=this.zM=this.L9b=null;this.$3c();this.Teb=this.dAc=this.RUd=this.Dm=this.IK=this.$=this.ea=null;super.dispose()}eg(Pb,oc){if(!oc){u.ULS.shipAssertTag(537153760,0,0<this.yh.length,"There is no sheet tab button.");if(!this.yh.length)return!1;Pb=null;for(const Ic of this.yh)if(Pb=Ic.qZh())break;if(!Pb)return u.ULS.shipAssertTag(537153759,
0,!1,"There is no focusable tab element."),!1;La.DOMElementExtensions.setFocus(Pb)}return!oc}Bh(Pb){return La.DOMElementExtensions.Df(this.mc,Pb)}Bj(){}ik(){}reorderSheets(Pb,oc,Ic){if(this.z_&&this.z_!==Pb){const ec=this.z_.index;this.Sqj(this.z_,Pb,oc);Pb=Pb?Pb.index-1:oc?this.$.ua.count-1:0;ec!==Pb&&(this.pIi(ec,Pb,Ic),this.Qvh(this.z_.name,Pb))}}L$h(Pb){Pb=this.tja(Pb);return-1!==Pb&&this.hz<=Pb&&Pb<=this.JV?this.yh[Pb].domElement:null}e7j(Pb){if(this.Fw){for(var oc=0;oc<this.IK.length;oc++){const Ic=
this.IK[oc];if(Ic&&this.svgIconProvider){const ec=Ic.parentNode;this.jYf(Ic);ec&&(this.IK[oc]=this.svgIconProvider.Lba(Pb?this.PQf[oc]:this.MBd[oc],12,12,ec,24,24))}}for(oc=0;oc<this.yh.length;oc++)this.yh[oc].ung(Pb);this.WSa&&this.WSa.ota&&this.tng(Z.a.Abi,this.WSa,Pb);this.FH&&this.FH.ota&&this.tng(Z.a.iah,this.FH,Pb)}}tng(Pb,oc,Ic){oc.Gbb||(oc.Gbb=this.svgIconProvider.Lba(Pb,12,12,oc.ota.parentNode,24,24));oc.Gbb&&(La.DOMElementExtensions.setVisible(oc.ota,!Ic),La.DOMElementExtensions.setVisible(oc.Gbb,
Ic))}G3i(Pb,oc){var Ic=cb.h(this.$);const ec=Ic.inRangePicker,mb=Ea.HelperMethods.zo(oc);if(Ic.eb&&!ec){const Ob=Ic.Ul?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Ta=void 0;z.EwaSettings.i8a&&(Ta=[Object(ib.a)(Ic.oc.textBox.jCa)]);ib.b(this.$).ACa(mb.rawEvent,Ob,Ta);Ic.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Ic=this.Oxa&&3===oc.wb;!(2===oc.wb&&mb.button===Sys.UI.MouseButton.leftButton||Ic)||ec||this.eR||Da.a(this.$).Tp()||(Ic&&Pb.E3i(),this.IDb=oc.clientPoint.x,
this.s3=oc,this.bZg(Pb))}F3i(){this.g0()}Hue(){return this.$.isEditMode&&!fa.k(this.$.gg)}g0(){const Pb=Ea.HelperMethods.wR(()=>{this.Z4j();this.ym&&this.vGj();this.wTd()});u.ULS.sendTraceTag(537153757,0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Pb}`)}vGj(){const Pb=this.JV===this.yh.length-1;La.DOMElementExtensions.toggleCssClass(this.Teb,this.$.oJ?da.VUe:da.KUe,!!this.hz);La.DOMElementExtensions.toggleCssClass(this.Teb,this.$.oJ?da.KUe:da.VUe,!Pb)}wTd(Pb=!1){const oc=
!this.hz,Ic=this.JV===this.yh.length-1;this.g8f(4,this.sheetTabActivatePreviousHidden,!oc);this.g8f(5,this.sheetTabActivateNextHidden,!Ic);this.wzc(0,oc||Pb);this.wzc(1,oc||Pb);this.wzc(2,Ic||Pb);this.wzc(3,Ic||Pb)}g8f(Pb,oc,Ic){if(Pb=this.IK[Pb]){La.DOMElementExtensions.setVisible(Pb,Ic);var ec=this.W6e(Pb);ec.title="img"===Pb.nodeName?Pb.alt=0<this.yh.length&&Ic?oc:"":Pb.title=0<this.yh.length&&Ic?oc:"";ec.tabIndex=Ic?0:-1}}W6e(Pb){return this.Fw?Pb.parentNode:Pb.parentNode.parentNode}wzc(Pb,oc){if(Pb=
this.IK[Pb])Pb=this.W6e(Pb),void 0!==Pb&&null!==Pb&&(!this.yh.length||oc?(Pb.classList.add(T.a.lU),Pb.setAttribute(y.a.$sa,"true")):(Pb.classList.remove(T.a.lU),Pb.setAttribute(y.a.$sa,"false")))}OSa(Pb){const oc=this.$.oJ?this.yh.length-1:0;let Ic=this.z9e(this.$.oJ?0:this.yh.length-1);Ic&&(Ic.borderRightWidth=Pb?"1px":"0");this.hz!==this.JV&&(Ic=this.z9e(oc))&&(Ic.borderRightWidth="0")}wre(Pb,oc){this.yh||(this.yh=[]);-1===oc?this.yh.push(Pb):this.yh.splice(oc,0,Pb)}j7b(Pb,oc){let Ic=-1,ec=null;
oc||(Ic=this.z2h(Pb.index),-1!==Ic&&(ec=this.JLa(Ic)));Pb=new Na(this.$,this.Dm,ec,Pb,this,this.ym,this.Fw);this.wre(Pb,Ic);La.DOMElementExtensions.setVisible(Pb.domElement,!0)}k7(Pb){const oc=Ea.HelperMethods.wR(()=>{switch(Pb){case 0:this.byc(0);break;case 1:this.byc(this.hz-1);break;case 2:this.byc(this.hz+1);break;case 3:this.scrollIntoView(this.yh.length-1);break;case 4:this.hz&&1<=this.yh.length&&(this.cpe(this.hz-1),this.iRd());break;case 5:this.JV!==this.yh.length-1&&1<=this.yh.length&&(this.cpe(this.JV+
1),this.iRd());break;case 6:this.iRd()}});this.T9b&&this.eR&&this.VQb();u.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Pb}, duration = ${oc}`)}cpe(Pb){(Pb=this.eV(Pb))&&Pb.activate()}vLh(Pb){if(0===Pb.EB){const oc=this.$.ua;let Ic=0;for(let ec=0,mb=oc.count;ec<mb;ec++){const Ob=Object(J.a)(pa.a,oc.getItem(ec));if(Ob===Pb)return Ic;0===Ob.EB&&Ic++}}return-1}jLh(Pb){const oc=this.$.ua;for(let Ic=Pb.index+1,ec=oc.count;Ic<ec;Ic++)if(Pb=Object(J.a)(pa.a,oc.getItem(Ic)),
0===Pb.EB)return Pb;return null}tja(Pb){for(let oc=0;oc<this.yh.length;oc++){const Ic=this.eV(oc);if(!Ic)u.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${oc}] is null even though index is not out of bounds!`);else if(Ic.sheet===Pb)return oc}return-1}fwb(Pb){Pb=this.tja(Pb);return this.eV(Pb)}pIi(Pb,oc,Ic){const ec={};ec.a=this.$.ya.UserSessionId;ec.b=Ic;ec.c=this.C9b;ec.d=Pb;ec.e=oc;ec.f=this.$.ua.count;F.b().Ze(2,ec,Ic)}Sqj(Pb,oc,Ic){const ec=Object(J.a)($a.a,
this.$.ua);oc?(oc=oc.index,oc=Pb.index<oc?oc-1:oc):oc=Ic?ec.count-1:0;ec.reorderSheet(Pb,oc,!0)}ZDj(Pb){cb.h(this.$).Ng.Ap(Pb)}bZg(Pb){if(!this.pwc){const oc=this.domElement.ownerDocument.body;D.a.instance.ta(I.a.mk,document.documentElement,this.p6);this.Oxa&&(G.a.instance.ta(I.a.mg,document.documentElement,this.p6),G.a.instance.ta(I.a.mg,this.domElement,this.HN));D.a.instance.ta(I.a.Of,document.documentElement,this.q6);G.a.instance.ta(I.a.Ae,oc,this.q6);this.pwc=!0}this.z_=Pb.sheet;this.C9b=!1;this.zM=
null;this.L9b=Pb;this.Eaa=Pb.domElement;this.OSd(La.DOMElementExtensions.getBoundingClientRect(this.Eaa),"BeginSheetTabButtonDrag")}FU(Pb=!0){if(this.pwc){this.ZDj(y.a.gV);const oc=this.domElement.ownerDocument.body;D.a.instance.Aa(I.a.mk,document.documentElement,this.p6);this.Oxa&&(G.a.instance.Aa(I.a.mg,document.documentElement,this.p6),G.a.instance.Aa(I.a.mg,this.domElement,this.HN));D.a.instance.Aa(I.a.Of,document.documentElement,this.q6);G.a.instance.Aa(I.a.Ae,oc,this.q6);this.WOc=this.pwc=!1}this.dtc=
0;this.C9b=!1;this.z_=null;this.Eaa&&(this.Eaa.style.visibility="visible",this.Eaa=null);this.L9b=null;this.OSd(null,"EndSheetTabButtonDrag");this.zM&&(this.zM.parentNode&&this.zM.parentNode.removeChild(this.zM),this.zM=null);this.gtj(Pb)}gtj(Pb){this.pYd(Pb);this.$C=this.IDb=-1}Qvh(Pb,oc){const Ic=this.$.pa,ec=Ic?Ic.va:null;this.$.userOperationManager.Oc(new wa.a(557,0,(mb,Ob,Ta)=>Gb(ec,Pb,oc,mb,Ob,Ta,null),64,()=>new ua(Pb,oc)),null)}eV(Pb){return 0<=Pb&&Pb<this.yh.length?this.yh[Pb]:null}v7h(Pb){return(Pb=
this.eV(Pb))?Pb.sheet:null}JLa(Pb){return(Pb=this.eV(Pb))?Pb.domElement:null}z9e(Pb){return(Pb=this.JLa(Pb))?Pb.style:null}z2h(Pb){const oc=this.$.ua;Pb+=1;let Ic=-1;const ec=this.yh?this.yh.length:0;for(;Pb<oc.count;){const mb=Object(J.a)(pa.a,oc.getItem(Pb));if(0===mb.EB){for(Ic=0;Ic<ec&&this.v7h(Ic)!==mb;Ic++);break}Pb++}return-1===Ic||Ic===ec?-1:Ic}cLf(Pb){var oc=this.fwb(Pb);oc&&(this.eR&&(u.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),
z.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.FU()),this.Dm.removeChild(oc.domElement),oc=Array.indexOf(this.yh,oc),this.yh.splice(oc,1),this.g0(),(!this.isRtl&&oc===this.yh.length||this.isRtl&&!oc)&&this.OSa(!0),this.T9b&&this.eR?Pb===this.z_?(this.FU(),this.k7(6)):this.VQb():this.k7(6))}dLf(Pb){const oc=Object(J.a)(pa.a,Pb);this.eR&&(u.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),
z.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.FU());if(0===oc.EB){this.OSa(!1);var Ic=this.tja(Pb);-1===Ic&&(u.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.j7b(oc,!1),Ic=this.tja(Pb));this.scf(Ic,!0)}}Tqj(Pb,oc){const Ic=this.fwb(Pb);Ic&&(this.eR&&!oc&&(u.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),
z.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.FU()),Pb=this.mVj(Pb,Ic),!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&Pb&&oc&&Pb.D3i())}mVj(Pb,oc){var Ic=Array.indexOf(this.yh,oc);const ec=this.vLh(Object(J.a)(pa.a,Pb));if(-1===ec||-1===Ic)return null;this.OSa(!1);({YLh:this.hz,RCi:this.JV}=Ib.Pqj(Ic,ec,this.hz,this.JV));oc&&oc.domElement.parentNode===this.Dm&&(this.Dm.removeChild(oc.domElement),
this.yh.splice(Ic,1));oc=this.jLh(Pb);Ic=this.tja(oc);oc=new Na(this.$,this.Dm,this.JLa(Ic),Object(J.a)(pa.a,Pb),this,this.ym,this.Fw);this.wre(oc,Ic);Ic=this.tja(Pb);this.scf(Ic,!1,!this.ym);return oc}Fwh(){const Pb=this.yh?this.yh.length:0,oc=this.hz,Ic=this.JV;for(let ec=0;ec<Pb;ec++){const mb=this.eV(ec),Ob=ec>=oc;mb&&(mb.tabIndex=Ob&&ec<=Ic?0:-1)}}J3j(){const Pb=this.yh?this.yh.length:0;for(let oc=0;oc<Pb;oc++){const Ic=this.eV(oc);Ic&&Ic.thb()}}scf(Pb,oc,Ic=!0){oc&&Pb<=this.hz&&this.hz++;this.Fwh();
this.OSa(!0);this.g0();this.T9b&&this.eR?this.VQb():Ic&&this.k7(6)}jzc(Pb){const oc=this.$.oJ;if(Pb||this.isRtl!==oc)this.isRtl=oc,this.domElement.classList.remove(this.isRtl?ka.a.QUe:ka.a.WUe),this.domElement.classList.add(this.isRtl?ka.a.WUe:ka.a.QUe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.J3j();Pb||this.OSa(!0);for(Pb=0;Pb<this.IK.length;Pb++)0!==Pb&&3!==Pb&&(!this.ym||4!==Pb&&5!==Pb)&&this.h8f(Pb)}fih(){const Pb=this.RUd=document.createElement("div");Pb.className=da.sCh;this.ym&&Pb.classList.add(da.tCh);
this.domElement.appendChild(Pb);this.c7b(Pb,1,717,716);this.c7b(Pb,2,719,718);this.Cof&&(this.WSa=new Ab(this.$,this,Pb));this.ym||this.c7b(Pb,4,723,722)}gih(){const Pb=this.dAc=document.createElement("div");Pb.className=da.uCh;this.domElement.appendChild(Pb);this.ym||this.c7b(Pb,5,725,724);this.C7c()}ljh(){const Pb=document.getElementById(y.a.WIj),oc=document.getElementById(y.a.XIj);Pb&&!oc&&u.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Pb.parentNode.id}. progressBar div has child: ${!!Pb.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(y.a.HUd)}`);
const Ic=A.a.Hof(this.$);if(Ic&&Pb&&oc)this.domElement.appendChild(Pb),this.UNb=Pb.firstChild,this.eAc=document.getElementById(y.a.HUd),oc.style.visibility="visible";else{const ec=document.createElement("div"),mb=document.createElement("div");ec.className=ka.a.DCh;mb.className=ka.a.BCh;z.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(mb.id=y.a.Peb);mb.style.display="none";const Ob=document.createElement("div");Ob.className=ka.a.ECh;const Ta=document.createElement("div");
Ta.className=ka.a.CCh;const sb=document.createElement("div");sb.className=ka.a.ACh;mb.appendChild(Ob);mb.appendChild(Ta);mb.appendChild(sb);ec.appendChild(mb);this.domElement.appendChild(ec);this.UNb=mb;this.eAc=Ta;u.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Ic,Pb,oc)}}h8f(Pb){var oc=this.IK[Pb];if(oc)if(this.Fw){const Ic=
oc.parentNode;this.jYf(oc);oc=ta.a(this.$)?this.PQf[Pb]:this.MBd[Pb];this.IK[Pb]=this.svgIconProvider.Lba(oc,12,12,Ic,24,24)}else oc.className=this.KBd[Pb]}jYf(Pb){(null===Pb||void 0===Pb?0:Pb.parentNode)&&Pb.parentNode.removeChild(Pb)}Jfh(){const Pb=this.Teb=document.createElement("div");Pb.className=da.mCh;this.domElement.appendChild(Pb);this.qkh(Pb)}qkh(Pb){const oc=document.createElement("div");oc.className=da.GCh;oc.classList.add(da.nCh);this.$.printingEnabled||oc.classList.add(U.a.cXe);Pb.appendChild(oc);
this.Dm=document.createElement("ul");La.DOMElementExtensions.Rt(this.Dm,y.a.K_c,null,null);this.Dm.className=U.a.XUe;oc.appendChild(this.Dm);this.Zhh();this.wle=document.createElement("div");this.$zc.id="SheetIconTooltipContainer";oc.appendChild(this.$zc)}Zhh(){const Pb=document.createElement("div");var oc="<div class='"+ka.a.g9g+"'>{0}</div>";const Ic=Za.a.r3e(ka.a.DDh);oc=String.format(oc,Ic);z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.jh(Pb,oc):Pb.innerHTML=oc;Pb.className=da.FCh;La.DOMElementExtensions.setVisible(Pb,!1);this.Dm.appendChild(Pb)}U7c(){const Pb=this.$.ua;for(let oc=0,Ic=Pb.count;oc<Ic;oc++){const ec=Object(J.a)(pa.a,Pb.getItem(oc));0===ec.EB&&(this.j7b(ec,!0),ec.active&&ec.activate())}}$3c(){S.a.sc(this.yh);this.yh=[];this.JV=this.hz=0}c7b(Pb,oc,Ic,ec){const mb=document.createElement("a");Pb.appendChild(mb);Pb=this.MBd[oc];this.IK[oc]=this.ob(mb,W.a.instance.ga(ec),
0,this.KBd[oc],W.a.instance.ga(Ic),Pb);if(5===oc||4===oc)La.DOMElementExtensions.cK(this.IK[oc],mb,!1,"span").style.marginTop="10px";this.h8f(oc);Ic=this.LBd[oc]=this.Fe.qe(mb);D.a.instance.ta(I.a.pointerDown,mb,Ta=>Ta.ctrlKey&&this.mVi(oc)?!0:this.kIf(oc));D.a.instance.ta(I.a.Of,mb,()=>this.lIf());G.a.instance.ta(I.a.Ae,mb,()=>this.lIf());D.a.instance.ta(I.a.pointerOut,mb,()=>this.S3c());E.KeyInputManager.instance.ta(I.a.Vb,mb,Ta=>13!==Ta.Ea.keyCode&&32!==Ta.Ea.keyCode||this.X5c?!1:(this.X5c=!0,
this.kIf(oc)));E.KeyInputManager.instance.ta(I.a.Qd,mb,Ta=>13===Ta.Ea.keyCode||32===Ta.Ea.keyCode?(this.X5c=!1,this.S3c()):!1);const Ob=this.Hue();ec=Ta=>{"mouseup"===Ta.type&&this.eR||va.g(Ta);mb.classList.contains(T.a.lU)||(Ob?this.q0i(Ta,oc):this.ym||this.mIf(Ta,oc))};Ic.la("mouseover",ec);Ic.la("mouseout",ec);Ic.la("focus",ec);Ic.la("blur",ec);Ob&&Ic.la("mouseup",ec)}Usi(Pb){let oc=!1;const Ic=this.$.Bf;Ic&&(oc=O.a.cR(La.DOMElementExtensions.getBoundingClientRect(Ic),Pb.clientPoint));return oc}VQb(){if(!this.zM){u.ULS.sendTraceTag(537153743,
0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.zM=this.Eaa.cloneNode(!0);if(!this.f3f(this.zM,this.Eaa,!0,"UpdateDragAndDropState"))return;this.Eaa.style.visibility="hidden";this.zM.classList.add(da.HCh);this.zM.style.borderRightWidth="";this.cfc=this.s3.clientPoint.x-this.D3.width/2;this.zM.style.left=this.cfc+"px";this.$C=this.tja(this.z_);0>this.$C&&u.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.T9b&&
(this.$C=this.tja(this.z_));var Pb=La.DOMElementExtensions.getBoundingClientRect(this.Dm);const oc=Pb.x;Pb=Pb.x+Pb.width;let Ic=this.s3.clientPoint.x-this.D3.width/2;Ic=Math.min(Ic,Pb-this.D3.width);Ic=Math.max(Ic,oc);this.zM.style.transform="translateX("+Math.abs(Ic-this.cfc)*(this.cfc<Ic?1:-1)+"px)";const ec=this.s3.clientPoint.x>this.IDb;let mb=this.s3.clientPoint.x;Ic>=Pb-this.D3.width?(mb=Pb-this.D3.width/2,this.fRd()||this.nna||(u.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),
this.isc=this.Dm.scrollLeft,this.nna=window.requestAnimationFrame(this.H4f))):Ic<=oc?(mb=oc+this.D3.width/2,this.eRd()||this.nna||(u.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.isc=this.Dm.scrollLeft,this.nna=window.requestAnimationFrame(this.G4f))):this.nna&&(u.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),
this.pYd());this.s3.clientPoint.x!==this.IDb&&(this.eZd(ec,mb),this.IDb=this.s3.clientPoint.x);this.WOc=!0}eZd(Pb,oc){let Ic;for(;({c4b:Ic}=this.ath(oc,Pb)).returnValue;)this.zPb=Ic,this.vUg(Pb)}vUg(Pb){if(this.zPb){var oc=(Pb?1:-1)*this.D3.width;if(Pb&&!this.$.oJ||!Pb&&this.$.oJ){var Ic=this.Eaa;var ec=this.$C+1;var mb=!0}else Ic=(ec=this.eV(this.$C+1))?ec.domElement:null,ec=this.$C-1,mb=!1;if(this.f3f(this.zPb,Ic,mb,"AnimateSheetSwap")){u.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.$C} and other sheet-index ${ec}. amount of sheets in the bar: ${this.PUd} isMovingRight: ${Pb}`);
0<=this.$C&&this.$C<this.yh.length&&0<=ec&&ec<this.yh.length?(Pb=this.yh[ec],this.yh[ec]=this.yh[this.$C],this.yh[this.$C]=Pb):(u.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.yh.length}, ghostIndex: ${this.$C}, swappedSheetIndex: ${ec}`),this.FU());this.$C=ec;var Ob=this.zPb;Ob.style.transform="translateX("+oc+"px)";window.requestAnimationFrame(()=>{Ob.style.transform="translateX(0px)"})}}}f3f(Pb,oc,Ic,ec){const mb=Ob=>Ob?`Node ID: ${Ob.id} , Node class: ${Ob.className}, Node name: ${Ob.nodeName},`:
null;try{return this.Dm.insertBefore(Pb,oc),!0}catch(Ob){return Pb=this.fwb(this.z_),u.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",Pb?Pb!==this.L9b?"Changed":"NoChange":"Removed",ec,mb(oc),
mb(oc.parentNode),mb(this.Dm),Ic,this.$C,this.PUd,Ob),this.FU(),!1}}ath(Pb,oc){var Ic=this.$.oJ===oc?this.eV(this.$C-1):this.eV(this.$C+1);if(!Ic)return{returnValue:!1,c4b:null};Ic=Ic.domElement;const ec=La.DOMElementExtensions.getBoundingClientRect(Ic);return this.D3?oc?{returnValue:Pb+this.D3.width/2>=ec.x+.5*ec.width,c4b:Ic}:{returnValue:Pb-this.D3.width/2<=ec.x+.5*ec.width,c4b:Ic}:(u.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.FU(),{returnValue:!1,c4b:Ic})}E4f(Pb,oc){let Ic;Ic=oc?this.H4f:this.G4f;if(-1===this.VBc)this.VBc=Pb,this.nna=window.requestAnimationFrame(Ic);else{Pb=Math.floor((Pb-this.VBc)/1E3*300);var ec=this.VLb>this.oEb?1:-1;this.scrollLeft(Math.abs(this.Dm.scrollLeft-(oc?this.isc+Pb*ec:this.isc-Pb*ec))*(oc?-1:1));if(Pb=this.r5e("ScrollStep"))this.eZd(oc,Pb.x+Pb.width/2),oc&&!this.fRd()||!oc&&!this.eRd()?this.nna=window.requestAnimationFrame(Ic):(u.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.pYd())}}fRd(){const Pb=this.VLb>this.oEb;return Pb&&this.Wna>=this.VLb||!Pb&&this.Wna<=this.VLb}eRd(){const Pb=this.VLb>this.oEb;return Pb&&this.Wna<=this.oEb||!Pb&&this.Wna>=this.oEb}pYd(Pb=!0){this.Dm&&(this.Wna=this.Dm.scrollLeft);window.cancelAnimationFrame(this.nna);this.nna=0;this.VBc=-1;Pb&&this.g0()}OSd(Pb,oc){Pb||u.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${oc}`);this.D3=Pb}mVi(Pb){return 2===Pb?(this.k7(3),
!0):1===Pb?(this.k7(0),!0):!1}kIf(Pb){u.ULS.shipAssertTag(537153732,0,-1===this.vQa&&-1===this.uQa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.vQa&&(window.clearTimeout(this.vQa),this.vQa=-1);-1!==this.uQa&&(window.clearInterval(this.uQa),this.uQa=-1);this.k7(Pb);this.vQa=window.setTimeout(()=>{this.RSj(Pb)},this.POi);return!0}RSj(Pb){this.uQa=window.setInterval(()=>{this.k7(Pb)},this.OOi)}lIf(){this.S3c();
return!this.eR}S3c(){window.clearTimeout(this.vQa);window.clearInterval(this.uQa);this.uQa=this.vQa=-1;return!0}mIf(Pb,oc){const Ic=this.KBd[oc];Ea.HelperMethods.u_d(this.IK[oc],Ic,Ic+y.a.Jgc,"mouseover"===Pb.type||"focus"===Pb.type)}q0i(Pb,oc){const Ic=this.xjc(oc),ec=5===oc;if("mouseup"===Pb.type){if(ec||4===oc)Ic||this.reorderSheets(null,ec,!1),this.FU()}else this.ym||this.mIf(Pb,oc)}xjc(Pb){return!!La.DOMElementExtensions.Thd(this.IK[Pb],"a").title}IFc(Pb){this.p2d(Pb);this.g0()}p2d(Pb){(Pb=this.fwb(Pb))&&
Pb.thb()}iRd(){var Pb=this.$.ua;if(Pb.na&&(!hb.e(this.$)||Pb.count))if(Pb=this.tja(Pb.na),-1===Pb)u.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var oc=this.JLa(Pb);Pb<this.hz?this.byc(Pb):Pb>this.hz&&!this.Nud(oc)&&this.scrollIntoView(Pb)}}Z4j(){this.hz=0;this.JV=this.yh.length-1;let Pb=!1;for(let oc=0;oc<this.yh.length;oc++){const Ic=this.eV(oc);if(!Ic)break;const ec=this.Nud(Ic.domElement);Ic.tabIndex=ec?0:-1;if(!Pb&&
ec)this.hz=oc,Pb=!0;else if(Pb&&!ec){this.JV=oc-1;break}}}byc(Pb){this.$.ua.count&&(this.yh.length||this.U7c(),this.w6f(this.JLa(Math.max(0,Math.min(Pb,this.yh.length-1)))),this.g0())}scrollIntoView(Pb){u.ULS.shipAssertTag(537153697,0,Pb>=this.hz,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.ua.count){this.yh.length||this.U7c();var oc=this.JLa(Math.max(0,Math.min(Pb,this.yh.length-1))),Ic=this.JLa(this.hz);if(!this.Nud(oc)){oc=
La.DOMElementExtensions.getBoundingClientRect(oc);var ec=La.DOMElementExtensions.getBoundingClientRect(this.Teb);oc=this.isRtl?ec.x-oc.x:oc.x+oc.width-(ec.x+ec.width);for(ec=0;Ic&&ec<oc;){const mb=La.DOMElementExtensions.getBoundingClientRect(Ic);ec+=mb.width;Ic=Ic.nextSibling}Ic?this.w6f(Ic):u.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.hz}, lastVisibleSheetTabIndex = ${this.JV}, scroll to index: ${Pb}`)}this.g0()}}w6f(Pb){const oc=
La.DOMElementExtensions.getBoundingClientRect(this.Dm);Pb=La.DOMElementExtensions.getBoundingClientRect(Pb);this.isRtl?this.scrollLeft(Math.floor(oc.x+oc.width-(Pb.x+Pb.width+.5))):this.scrollLeft(Math.ceil(oc.x-Pb.x-.5))}scrollLeft(Pb){(0>Pb&&this.fRd()||0<Pb&&this.eRd())&&u.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const oc=this.Dm.scrollLeft;if(this.isRtl){if(C.a.xF||C.a.Ff){this.Dm.scrollLeft=this.Wna=oc-Pb;
return}if(C.a.MH){this.Dm.scrollLeft=this.Wna=oc+Pb;return}u.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Dm.scrollLeft=this.Wna=oc-Pb}Nud(Pb){Pb=La.DOMElementExtensions.getBoundingClientRect(Pb);const oc=La.DOMElementExtensions.getBoundingClientRect(this.Teb);return Pb&&oc?Pb.x>=oc.x-1&&Pb.x+Pb.width<=oc.x+oc.width+1:(u.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}Aih(){const Pb=
this.dAc;if(ja.M$f(this.$))this.ym?(S.a.Ja(this.FH),this.FH=new ja(Pb,this.$,this,!0)):(S.a.Ja(this.FH),this.FH=null);else if(!this.FH||this.ym)S.a.Ja(this.FH),fa.k(this.$.gg)?this.FH=new X(Pb,this.$,this):this.FH=new ja(Pb,this.$,this)}qKe(Pb,oc){var Ic=this.$.ua;if(!this.$.isEditMode||!Ic.count)S.a.Ja(oc),oc=null;else if(!oc)if(Ic=this.ym?this.RUd:this.dAc,fa.k(this.$.gg))oc=new X(Ic,this.$,this);else switch(Pb){case 0:oc=new ja(Ic,this.$,this);break;case 1:oc=new la(Ic,this.$,this);break;default:u.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return oc}C7c(){this.xui?(this.FH=this.qKe(0,this.FH),this.OAb=this.qKe(1,this.OAb)):this.Aih()}r5e(Pb){const oc=La.DOMElementExtensions.getBoundingClientRect(this.zM);oc||(u.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Pb}: GetBoundingClientRect returned null for the dragged sheet.`),this.FU());return oc}jcf(Pb,
oc){this.vua.EVg(Pb,oc);this.FU(!1);this.wTd(this.navigationButtonsDisabled);for(const Ic of this.zVj)Ic&&Ic.rS(this.navigationButtonsDisabled);for(const Ic of this.Fye)Ic&&Ic.rS(this.operationButtonsDisabled)}static Pqj(Pb,oc,Ic,ec){Pb<Ic?(oc>Ic&&Ic--,oc>ec&&ec--):Pb>ec?(oc<Ic&&Ic++,oc<ec&&ec++):oc<Ic&&Ic++;return{YLh:Ic,RCi:ec}}}Object(b.a)(Ib,"SheetTabBarControl",Y.a,[430,3,63]);class vc extends t.a{constructor(Pb){super();this.$=Pb;this.Gb()}create(){const Pb=this.$.Cb;if(v.a(this.$.ya,1))na.PageLoadTrackingInfo.instance.Vda(y.a.FBa,
["sheetTabBar"]);else{var oc=document.getElementById(Pb+y.a.a9c);if(oc){z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&na.PageLoadTrackingInfo.instance.sBa(y.a.FBa);var Ic=performance.now(),ec=l.Task.Ta(null);z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")&&(ec=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?
Object(lb.c)(n.a.resolve(x.w,{Wb:this.Na})):f.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na));var mb=A.a.Ztd()?f.GetServiceTaskFactory.Pa(this.$.da,388,387,this.Na):l.Task.Ta(null);d.TaskExtensions.za(d.TaskExtensions.Md([mb,ec],this.$.ka),()=>{const Ob=performance.now();this.qb(this.$.da.Ba(32)||new Ib(this.$,oc,mb.result,ec.result));const Ta=performance.now();z.EwaSettings.isChangeGateEnabled("OfficeVSO:7644765_investigateSheetTabTtvrReg")&&u.ULS.sendTraceTag(509204041,0,50,`SheetTabBarFactory.Create: { "beforeInitTime": ${Ic.toFixed(3)}, "afterInitBeforeCtorTime": ${Ob.toFixed(3)}, "afterCtorTime": ${Ta.toFixed(3)}, "diff1": ${(Ob-
Ic).toFixed(3)}, "diff2": ${(Ta-Ob).toFixed(3)} }`)},this.$.ka,3)}else na.PageLoadTrackingInfo.instance.Vda(y.a.FBa,["sheetTabBar"])}}static la(Pb){Pb.da.Ha(33,new vc(Pb))}}Object(b.a)(vc,"SheetTabBarFactory",t.a,[]);a.d(B,"a",function(){return nc});const nc=()=>{c.a.Fa(Pb=>{vc.la(Pb);m.la(Pb)})}},1191:function(r,B,a){r={};a.r(r);a.d(r,"EmbeddedWorkbookReadoutHandler",function(){return ta});var c={};a.r(c);a.d(c,"WorkbookReadoutHandler",function(){return Ya});var b=a(9),e=a(1),f=a(0),d=a(228),h=a(15),
l=a(34),k=a(5),w=a(12),n=a(22),x=a(14),m=a(263),u=a(21),t=a(31);class y{constructor(ya){this.Gxc=ya||""}static get jRe(){return y.q$d||(y.q$d=new y(""))}static get Uyd(){return y.yfe||(y.yfe=y.XU(2).Gxc)}static wva(ya){ya=t.a.Og(ya||"");return new y(ya)}static Nja(ya){return y.wva(x.a.instance.ga(ya))}static XU(ya){return new y(x.a.instance.Ua(ya))}static fcc(ya,...V){return y.vOh(x.a.instance.nb(ya),...V)}static vOh(ya,...V){const Z=V.length,ja=Array(Z);for(let la=0;la<Z;la++)ja[la]=(V[la]||y.jRe).Gxc;
return new y(String.format(ya,ja))}}y.q$d=null;y.yfe=null;Object(f.a)(y,"SafeHtml",null,[421]);const v=(ya,V)=>{V&&(ya.append(V),ya.append(y.Uyd))};var A=a(158),z=a(127),C=a(7),H=a(351),I=a(184);class S{constructor(ya,V,Z,ja=null){this.tDf=(la,ua)=>{this.GUf(ua.Ud.command)};this.p5f=()=>{if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&!this.$.ea.Yb){var la={["PoliteCount"]:this.A$i,["AlertCount"]:this.GTg,["TotalLiveRegionUpdates"]:this.oZj};A.a.sendTelemetryEvent(Object(C.a)(new H.a,
{name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:z.a.ki(la)}))}};this.$=ya;this.htmlSanitizationHelper=ja;this.lfa=document.createElement("div");this.lfa.setAttribute(k.a.I2,k.a.$j);this.lfa.className=l.a.Kbd;V.insertBefore(this.lfa,Z);this.zga=document.createElement("div");this.zga.setAttribute(k.a.I2,k.a.$j);this.zga.className=l.a.Kbd;V.insertBefore(this.zga,this.lfa);this.tDg=x.a.instance.Ua(2);this.s$=document.createElement("div");this.s$.setAttribute(k.a.Jd,k.a.Zsa);this.s$.setAttribute(k.a.ata,
k.a.mqb);this.s$.className=l.a.Kbd;V.insertBefore(this.s$,this.zga);this.qne=this.f6d=this.Fie=0;this.Qbe=!0;this.register();this.$.da.Ha(211,this)}get Aya(){return this.tDg}get isActive(){return!0}get activeCell(){return u.h(this.$).Jb(null)}get A$i(){return this.Fie}get GTg(){return this.f6d}get oZj(){return this.qne}get lBb(){return e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmationForFreewayScenarios",!1)}dispose(){this.$&&this.unregister();w.DOMElementExtensions.yf(this.s$);
w.DOMElementExtensions.yf(this.lfa);w.DOMElementExtensions.yf(this.zga);this.zga=this.lfa=this.s$=this.$=null}setEnabled(ya){this.h7f(this.zga,ya)}iDj(){this.h7f(this.lfa,!0)}readText(ya){this.wcb(y.wva(ya),!0)}wAa(ya){this.wcb(y.wva(ya),!1)}JUf(ya,V){if(1>V||!ya)h.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var Z=new Sys.StringBuilder;ya=String.format(x.a.instance.nb(34),V,ya);v(Z,ya);v(Z,x.a.instance.ga(857));this.wcb(y.wva(Z.toString()),!1)}}Nhj(ya,V,Z){if(1>Z||
1>V||V>Z||!ya)h.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var ja=new Sys.StringBuilder;v(ja,ya);ja.append(String.format(x.a.instance.nb(55),V,Z));this.wcb(y.wva(ja.toString()),!1)}}GUf(ya){this.lBb||(ya=this.b6h(ya),this.wcb(ya,!1))}Lhj(ya){this.lBb&&(ya=this.a6h(ya),this.wcb(ya,!1))}wcb(ya,V){if(ya=ya?ya.Gxc:null)V=V?this.zga:this.lfa,n.a.equals(V.innerHTML,ya,!1)&&(ya+=y.Uyd),this.Jig(V),this.htmlSanitizationHelper.jh(V,ya)}vcb(ya,V){this.s$.getAttribute(k.a.ata)!==
V&&this.s$.setAttribute(k.a.ata,V);ya=ya?y.wva(ya).Gxc:"";this.Jig(this.s$);this.htmlSanitizationHelper.jh(this.s$,ya)}Ohj(ya,V,Z,ja){const la=x.a.instance.nb(54);h.ULS.shipAssertTag(537153949,0,!(void 0===ya||null===ya));h.ULS.shipAssertTag(537153948,0,!(void 0===V||null===V));h.ULS.shipAssertTag(537153947,0,!(void 0===Z||null===Z));h.ULS.shipAssertTag(537153946,0,!(void 0===ja||null===ja));h.ULS.shipAssertTag(537153945,0,!(void 0===la||null===la));ya=String.format(la,ya||"",V||"",Z||"",ja||"");
this.vcb(ya,k.a.uHa)}N3j(ya){var V=this.zga.style;ya?(ya=m.a.t3b(ya.cell,V),V=ya.HB,V.top=V.left=V.bottom=V.right=null,ya.E2()):V.cssText=""}b6h(ya){if(this.lBb)return null;switch(ya){case -1985798686:return y.Nja(12);case -911352779:return y.Nja(11);case 237279923:return y.Nja(13);case -1502853784:return y.XU(81);case -111689794:return y.XU(78);case -287251124:return this.akd(1333,V=>V.bold);case -1925065947:return this.akd(1334,V=>V.italic);case 1764140053:return this.akd(1335,V=>V.underline)}return null}a6h(ya){if(!this.lBb||
6!==ya.Ve)return null;switch(ya.command){case -1985798686:return y.Nja(12);case -911352779:return y.Nja(11);case 237279923:return y.Nja(13);case -1502853784:return y.XU(81);case -111689794:return y.XU(78);case 368460465:return ya=this.$.na.hasAutoFilter,this.Qbe&&(ya=!ya,this.Qbe=!1),this.Iyb(1970,ya);case 1941920197:return y.Nja(836);case 1051390410:return y.XU(589);case 1542466017:return y.XU(591);case -706918724:return y.XU(590);case 369708605:return y.XU(592);case -1215659745:return y.XU(523);
case 1783960667:return y.XU(521);case -1355155015:return y.XU(554);case -1158102843:return y.XU(522);case -287251124:return this.Iyb(1333,this.fjc(ya.command));case -1925065947:return this.Iyb(1334,this.fjc(ya.command));case 1764140053:return this.Iyb(1335,this.fjc(ya.command));case -1590502662:return this.Iyb(1336,this.fjc(ya.command));case 862890474:return ya=y.wva(String(this.eka())),y.fcc(214,ya);case 963349338:return ya=y.wva(String(this.eka())),y.fcc(214,ya)}return null}register(){h.ULS.shipAssertTag(537153944,
0,!!this.$,"Can't register to ewaControl's events");this.$&&(h.ULS.shipAssertTag(537153943,0,!!this.$.Ia,"Can't register to CommandHandlerManager's event"),this.$.Ia&&this.$.Ia.Gsa(this.tDf),this.$.ea&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&this.$.ea.wA(this.p5f))}unregister(){this.$&&(this.$.Ia.Ena(this.tDf),e.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&this.$.ea.wB(this.p5f))}h7f(ya,V){const Z=ya===this.lfa;V?
(ya.setAttribute(k.a.ata,k.a.uHa),Z&&ya.setAttribute(k.a.Jd,k.a.Zsa),ya.setAttribute(k.a.I2,k.a.xq),ya.removeAttribute(k.a.I2),this.htmlSanitizationHelper.jh(ya,ya.innerHTML+" ")):(ya.removeAttribute(k.a.ata),Z&&ya.removeAttribute(k.a.Jd),ya.setAttribute(k.a.I2,k.a.$j))}akd(ya,V){const Z=this.activeCell;if(!Z)return null;const ja=e.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),la=[7,8];V=V(Z)?!0:!1;return y.fcc(ja?la[+V]:la[+!V],y.Nja(ya))}Jig(ya){e.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&
("polite"===ya.FWg&&this.Fie++,"alert"===ya.role&&this.f6d++,this.qne++)}Iyb(ya,V){return this.lBb&&this.activeCell?y.fcc(V?7:8,y.Nja(ya)):null}fjc(ya){var V=u.h(this.$);const Z=I.a(V.Jb(null));e.EwaSettings.vb()&&V.eb&&(Z.Font=V.Mh.Uva(Z.Font));V=Z.Font;switch(ya){case -287251124:return V.Bold;case -1925065947:return V.Italic;case 1764140053:return V.Underline;case -1590502662:return V.Strikethrough}return!1}eka(){let ya=u.h(this.$);const V=I.a(ya.Jb(null));e.EwaSettings.vb()&&ya.eb&&(V.Font=ya.Mh.Uva(V.Font));
return V.Font.FontSize}}Object(f.a)(S,"AriaLiveNotifier",null,[398,365,3]);var P=a(50),D=a(38),G=a(108),E=a(153),O=a(54);class N extends d.a{constructor(ya){super();this.$=ya;this.Gb()}create(){const ya=e.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(G.c)(E.a.resolve(O.w,{Wb:this.Na})):P.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na);D.TaskExtensions.za(D.TaskExtensions.Md([ya],this.$.ka),()=>{this.qb(this.$.da.Ba(211)||new S(this.$,
this.$.nv,this.$.Bf,ya.result))},this.ka,3)}static la(ya){ya.da.Ha(212,new N(ya))}}Object(f.a)(N,"AriaLiveNotifierFactory",d.a,[]);var J=a(27),W=a(219);class ea{constructor(ya,V){this.f0=this.e0=this.IR=null;this.Gja=V;this.Djh(ya);this.Ebj();e.EwaSettings.vb()&&ya.da.Ha(244,this)}get isActive(){return!!this.Gja&&document.activeElement===this.Gja}readText(ya){ya=e.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?ya:String.format(x.a.instance.nb(30),ya);
this.IR.setAttribute(k.a.fv,ya);this.e0.setAttribute(k.a.fv,ya);this.jVj()}dispose(){this.f0&&this.f0.parentNode&&this.f0.parentNode.removeChild(this.f0);this.e0=this.IR=this.f0=this.Gja=null}Djh(ya){var V=ya.Cb+"readoutElementWrapper";const Z=ya.Cb+"readoutElement1",ja=ya.Cb+"readoutElement2";this.f0=document.getElementById(V);this.f0||(this.f0=document.createElement(W.a.div),this.f0.id=V,this.IR=document.createElement(W.a.label),this.IR.id=Z,this.IR.setAttribute(k.a.Jd,k.a.E_a),this.e0=document.createElement(W.a.label),
this.e0.id=ja,this.e0.setAttribute(k.a.Jd,k.a.E_a),this.IR.style.width="0px",this.IR.style.height="0px",this.e0.style.width="0px",this.e0.style.height="0px",this.IR.tabIndex=-1,this.e0.tabIndex=-1,this.f0.appendChild(this.IR),this.f0.appendChild(this.e0),ya=ya.Cb+k.a.f6b,V=document.getElementById(ya),h.ULS.shipAssertTag(537153942,3,!!V,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${ya}`),V&&V.appendChild(this.f0))}Ebj(){this.Gja&&this.IR&&this.e0&&(this.Gja.setAttribute(k.a.vY,
this.IR.id),this.Gja.setAttribute(k.a.k2b,`${this.IR.id} ${this.e0.id}`))}jVj(){if(this.isActive){let ya="";w.DOMElementExtensions.hasAttribute(this.Gja,k.a.vY)&&(ya=this.Gja.getAttribute(k.a.vY).toString());this.Gja.setAttribute(k.a.vY,ya===this.IR.id?this.e0.id:this.IR.id)}else h.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static J7a(){if(null==ea.Dwb)if(e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",
!1)&&!J.a.JNa)ea.Dwb=!0,h.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(ea.Dwb=!1,J.a.MH||J.a.Ff)ea.Dwb=!0,h.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return ea.Dwb}static la(ya){ea.J7a()&&ya.da.Ha(244,new ea(ya,u.h(ya).oc.textBox.Ge))}}ea.Dwb=null;Object(f.a)(ea,"FocusBasedReadout",null,[365,3]);class R extends d.a{constructor(ya){super();
this.$=ya;this.Gb()}create(){ea.J7a()?u.h(this.$).oc.textBox.NP(()=>{const ya=this.$.da.Ba(244)||new ea(this.$,u.h(this.$).oc.textBox.Ge);this.qb(ya)}):this.qb(null)}static la(ya){ya.da.Ha(315,new R(ya))}}Object(f.a)(R,"FocusBasedReadoutFactory",d.a,[]);var Y=a(91),U=a(87);const da=ya=>{switch(ya){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;
case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var T=a(24),ka=a(44),L=a(217),fa=a(49),wa=a(45),oa=a(119);class xa{static get Bgj(){return xa.kje||(xa.kje=RegExp("([A-Z]+)","g"))}static get Agj(){return xa.jje||
(xa.jje=RegExp("([A-Z])","g"))}static get m7g(){return xa.J7d||(xa.J7d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Qjd(ya){return xa.n8e(ya.toString())}static n8e(ya){return xa.m7g.test(ya)?ya.replace(xa.Bgj,"$1 ").replace(xa.Agj,' "$1"').trim():ya}static lrj(ya){const V=ya.lastIndexOf("!");return ya.substring(0,-1<V?V+1:0)+xa.n8e(ya.substring(-1<V?V+1:0,ya.length))}}xa.kje=null;xa.jje=null;xa.J7d=null;Object(f.a)(xa,
"RangeAriaExtensions",null,[]);class bb{constructor(){this.activeItemName=null;this.pof=!1;this.tableName=null;this.s1a=0;this.PCc=!1}}Object(f.a)(bb,"SelectionReadoutState",null,[]);a(71);var Za=a(73);class La{constructor(ya,V,Z,ja,la){this.gridReadoutNotifier=null;this.pcb=!1;this.qta=this.yqb=null;this.Dda=()=>{e.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?h.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
u.h(this.$).eb||this.q2b.$p()};this.fSi=()=>{if(!u.h(this.$).ha.Sa.jtd){var ua,eb=({activeCell:ua}=this.IRh()).returnValue;this.readText(eb,ua)}};this.xp=()=>{const ua=this.activeCell;this.readText("Editing",ua);e.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||ua&&ua.Tfc&&!u.h(this.$).Ocf||this.q2b.cancel()};this.Zc=()=>{e.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?h.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.Dda(),this.pcb&&u.h(this.$).inRangePicker&&1===Za.a.zb&&(null===this.yqb?this.yqb=fa.a.instance.create(this.jLd,La.dXc,"readSelectedRanges"):this.yqb.$p()))};this.$=V;this.ariaLiveNotifier=ya;this.sparklineManager=ja;this.tableManager=Z;this.DD=new bb;this.J7a=ea.J7a();this.pcb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.J7a&&(e.EwaSettings.vb()?this.gridReadoutNotifier=la:this.gridReadoutNotifier=V.da.Ba(244),h.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),La.dXc=700);this.q2b=fa.a.instance.create(this.fSi,La.dXc,wa.a.Kzj,!1);this.Gj()}get activeCell(){return u.h(this.$).Jb(null)}dispose(){this.$&&this.Xj();Y.a.Ja(this.q2b);this.sparklineManager=this.$=this.q2b=null}V2e(ya,V,Z=!0){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:7449834_NoReadoutWhenFindAndReplaceDialogOpen")&&this.$.pb.Gw&&null!==this.$.pb.kh&&null!==this.$.pb.kh.pc&&"FindAndReplaceDialog"===this.$.pb.kh.pc||!ya)return"";
var ja=this.$.da;const la=new Sys.StringBuilder;this.qVg(la,ya,V);if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var ua=this.tableManager.qka(ya.range);(null===ua||void 0===ua?0:ua.XVd)&&this.Gve(la,ua);ua=this.tableManager.Qp(ya.range);(null===ua||void 0===ua?0:ua.Kka)&&this.Gve(la,ua)}ua=ya.xba?this.Q5e(ya):ya.text;v(la,ua);ua=this.$.activeItemName;this.DD.activeItemName!==ua&&(v(la,ua),this.DD.activeItemName=ua);ua=1===V.length?ka.L(V).isSingle?"":x.a.instance.ga(853):
String.format(x.a.instance.nb(31),V.length);v(la,ua);for(var eb of V)v(la,xa.Qjd(eb)),1===V.length&&La.iAi(eb)&&(ua=u.h(this.$).Ca.ds(eb.bottomRight),void 0!==ua&&null!==ua&&ua.text&&(ua=ua.xba?this.P5e(ua,ua.text):ua.text,v(la,ua)));eb=ya.cell;eb=this.r3h(eb.Yvj,eb.j$g);v(la,eb);this.$Ug(la,ya);Z&&(ya.m8a?v(la,x.a.instance.ga(841)):ya.Mxa&&v(la,x.a.instance.ga(842)));if(ya.hasAutoFilter||ya.x4)this.rVg(la,ya.hasAutoFilter?ya.cell.autoFilterType:ya.cell.Y9i),Z&&v(la,x.a.instance.ga(844));L.c(this.$,
ya.range)&&v(la,x.a.instance.ga(848));this.XUg(la,ya);Z=(Z=ja.Ba(14))?Z.LSh():"";v(la,Z);ya.WA&&(Z=u.h(this.$).Ca.ds(ya.range),Z=!!Z&&Z.hasIgnorableError,La.vJj(ya)?La.YUg(la,ya):e.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&Z?v(la,x.a.instance.ga(846)):v(la,x.a.instance.ga(845)));ya.TM&&(v(la,x.a.instance.ga(847)),ya.pzb&&v(la,String.format(x.a.instance.nb(16),ya.Fmh)),v(la,ya.iconName));ya.hasRichValueIcon&&(eb=this.$.da.Ba(271),Z="",eb&&ya.cell.Bsf&&(eb=eb.zU(ya.cell.Bsf))&&
eb.DomainId.Id!==La.Rak&&(Z=eb.Name),ya.cell.Xpi?(v(la,String.format(x.a.instance.nb(187),Z)),v(la,x.a.instance.ga(1812))):(v(la,String.format(x.a.instance.nb(185),Z)),v(la,x.a.instance.ga(1811))));this.qfi(ya)&&v(la,La.KZh(ya));(ja=ja.Ba(231))&&v(la,ja.b6e(V,!0));1===V.length&&V[0].isSingle&&La.uJj(ya,V[0],this.$)&&(V=this.$.da.Ba(271))&&v(la,V.WSh());ya.oQb&&ya.pQb&&v(la,ya.pQb);(V=ya.cell.Y5g)&&v(la,V);ya.xNa&&ya.OIb&&(ya=ya.OHd)&&(v(la,x.a.instance.ga(1985)),v(la,ya));return la.toString()}VAe(ya){this.qta=
this.DD;this.DD=Object(C.a)(new bb,{activeItemName:this.qta.activeItemName,PCc:ya?this.qta.PCc:!1,tableName:ya?this.qta.tableName:"",s1a:ya?this.qta.s1a:-1})}A1f(){this.qta&&(this.DD=this.qta,this.qta=null)}r3h(ya,V){return 2===ya||2===V?x.a.instance.ga(875):1===ya||1===V?x.a.instance.ga(876):""}Q5e(ya){return this.P5e(ya.cell,ya.text)}qVg(ya,V,Z){if(Z&&1===Z.length&&Z[0].isSingle){Z="";var ja=this.tableManager.qka(V.range);if(ja){Z=ja.pivotTableName;this.f_c(ya,Z);var la=ja.Uic?x.a.instance.ga(835):
"";e.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(la+=(ja.altText?ja.altText+" . ":"")+(ja.altTextSummary?ja.altTextSummary:""));this.Ive(ya,!0,Z,la);v(ya,this.tableManager.Uxi(ja,V.range)?x.a.instance.ga(838):"");v(ya,this.tableManager.rri(ja,V.range)?x.a.instance.ga(837):"")}else if(ja=this.tableManager.Qp(V.range)){Z=(la=u.h(this.$).tb.uh(V.range))?la.name:"";this.f_c(ya,Z);let ua="";la&&(ua=(la.bUa?la.bUa+" . ":"")+(la.cUa?la.cUa:""));this.Ive(ya,
!1,Z,ua);v(ya,this.tableManager.jlf(ja,V.range)?x.a.instance.ga(837):"")}else this.f_c(ya,Z),this.DD.tableName="",this.DD.s1a=-1}}f_c(ya,V){V!==this.DD.tableName&&this.DD.tableName&&(ya.append(x.a.instance.ga(this.DD.PCc?834:833)),v(ya," "+this.DD.tableName))}Ive(ya,V,Z,ja){Z!==this.DD.tableName&&(ya.append(x.a.instance.ga(V?832:831)),v(ya," "+Z),v(ya,ja),this.DD.tableName=Z,this.DD.PCc=V,this.DD.s1a=-1)}Gve(ya,V){const Z=u.h(this.$).ha.ra.activeCell;if(Z.top!==V.top&&Z.left!==this.DD.s1a){ya.append(x.a.instance.ga(837));
V=new T.Range(V.top,Z.left,V.top,Z.left,!0,!0);v(ya,xa.Qjd(V));if(V=u.h(this.$).Jb(V))V=V.xba?this.Q5e(V):V.text,v(ya,V);this.DD.s1a=Z.left}}P5e(ya,V){const Z=ya.B6a;return ya.Dwa?String.format(x.a.instance.nb(14),V,Z):String.format(x.a.instance.nb(13),V,xa.lrj(Z))}Gj(){h.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var ya=u.h(this.$);h.ULS.shipAssertTag(537153929,0,!!ya,"Can't register to grid's events");ya&&(ya.Xb.gl(this.xp),ya.Ca.dw(this.Dda),ya.uE(this.Dda),
this.pcb&&ya.Xb.rm(this.dg.bind(this)),ya=ya.ha,h.ULS.shipAssertTag(537153928,0,!!ya,"Can't register to selectionManager's events"),ya&&(ya.jC(this.Zc),ya.vA(this.Dda),ya.Sa.A2(this.Dda),this.pcb&&(this.jLd=this.jLd.bind(this))))}}Xj(){if(this.$){var ya=u.h(this.$);ya&&(ya.Xb.Zk(this.xp),ya.Ca.Xw(this.Dda),ya.VF(this.Dda),this.pcb&&ya.Xb.dm(this.dg),ya=ya.ha)&&(ya.xB(this.Dda),ya.TF(this.Dda),ya.Sa.Fna(this.Dda))}}readText(ya,V){this.J7a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?
this.gridReadoutNotifier.readText(ya):(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(ya),this.pcb&&!V||this.ariaLiveNotifier.N3j(V))}dg(){this.yqb&&this.yqb.cancel()}jLd(){this.readText(this.O6h())}O6h(){let ya="";u.h(this.$).ha.rangePicker.RK.forEach(()=>{ya+=void 0});return ya+=" selected"}IRh(){let ya;ya=null;var V=u.h(this.$).ha;if(1!==V.Oe&&!V.Sa.jc)return h.ULS.sendTraceTag(537153927,0,
15,`selectionManager.CommandSelectionMode=${V.Oe} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:ya};switch(V.Oe){case 2:return{returnValue:this.NUh(V),activeCell:ya};case 64:var Z=V.Sa.jc.floatingObject,ja="";if(V=V.Sa.jc.Hs||V.Sa.jc.Od)ja=(ja=V.firstChild)?w.DOMElementExtensions.getTextContent(ja):"";return{returnValue:String.format(x.a.instance.nb(53),La.vcc(Z.altText,Z.altTextDescription,Z.name),ja,Z.altTextDescription),activeCell:ya};case 4:return{returnValue:La.iUg(V.Sa.jc.floatingObject),
activeCell:ya};case 512:return{returnValue:oa.a.w4e(V.Sa.jc.floatingObject.R$c),activeCell:ya};case 8:return Z=(Z=V.Sa.jc.floatingObject)?Z.name:"",{returnValue:String.format(x.a.instance.nb(51),Z),activeCell:ya};case 1:return ya=this.activeCell,{returnValue:this.V2e(ya,V.ra.selectedRanges),activeCell:ya}}return{returnValue:"",activeCell:ya}}NUh(ya){const V=new Sys.StringBuilder;V.append(La.E6g(ya));const Z=this.$.da.Ba(231);Z&&v(V,Z.b6e(ya.Sa.jc.floatingObject,!1));return V.toString()}qfi(ya){ya=
ya.jjf();let V=!1;this.DD.pof!==ya&&(this.DD.pof=ya,V=!0);return V}$Ug(ya,V){if(V.zzb)if(V=this.sparklineManager.O7h(V)){var Z=x.a.instance,ja=Z.ga;a:switch(V.type){case 0:var la=828;break a;case 1:la=829;break a;default:la=830}Z=ja.call(Z,la);v(ya,String.format(x.a.instance.nb(25),Z));V=String.format(x.a.instance.nb(24),xa.Qjd(V.FRj));v(ya,V)}else h.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),v(ya,String.format(x.a.instance.nb(25),""))}rVg(ya,V){switch(V){case 1:case 11:v(ya,
x.a.instance.ga(849));break;case 6:v(ya,x.a.instance.ga(849));v(ya,x.a.instance.ga(851));break;case 7:v(ya,x.a.instance.ga(849));v(ya,x.a.instance.ga(852));break;case 2:v(ya,x.a.instance.ga(850));v(ya,x.a.instance.ga(851));break;case 3:v(ya,x.a.instance.ga(850));v(ya,x.a.instance.ga(852));break;default:v(ya,x.a.instance.ga(850))}}XUg(ya,V){var Z;const ja=this.$.da.Ba(65);V=ja?ja.dLa(V.range):null;let la="";const ua=Object(U.a)(395,V);if(V)la=!V.T7a&&ua&&ua.Gzi?String.format(x.a.instance.nb(29),ua.bWj):
String.format(x.a.instance.nb(23),V.author);else if(null===(Z=null===ja||void 0===ja?void 0:ja.Wm)||void 0===Z?0:Z.lF)la=String.format(x.a.instance.nb(28),ja.Wm.vN.author);v(ya,la)}static iUg(ya){return String.format(x.a.instance.nb(52),La.vcc(ya.altText,ya.altTextDescription,ya.name),ya.altTextDescription)}static KZh(ya){return x.a.instance.ga(ya.jjf()?839:840)}static vcc(ya,V,Z){return ya||V?ya:Z}static E6g(ya){var V=ya.Sa.jc;ya=V.floatingObject;const Z=ya.ed,ja=Z.ChartTitle,la=ya.altText,ua=ya.altTextDescription,
eb=!!(Z.Attributes&4);return(V=V.getSelectionDescription())?V:Z.DataRangeForDisplay?String.format(x.a.instance.nb(eb?49:47),La.vcc(la,ua,ya.name),ua,ja,x.a.instance.ga(da(Z.ChartCategory)),Z.DataRangeForDisplay):String.format(x.a.instance.nb(eb?50:48),La.vcc(la,ua,ya.name),ua,ja,x.a.instance.ga(da(Z.ChartCategory)))}static vJj(ya){return e.EwaSettings.xa(101)&&(ya.B7a||ya.Tic)}static YUg(ya,V){if(!V.Ooa)h.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");
else if(V.B7a)V=V.Ooa.topLeft.toString(),v(ya,String.format(x.a.instance.nb(26),V));else if(V.Tic){var Z=V.Ooa.qS();V=(Z.LastColumn-Z.FirstColumn+1).toString();Z=(Z.LastRow-Z.FirstRow+1).toString();v(ya,String.format(x.a.instance.nb(27),V,Z))}}static uJj(ya,V,Z){return ya.WA||!e.EwaSettings.xa(131)?!1:(ya=Z.da.Ba(271))?ya.xic(V):!1}static iAi(ya){return ya.top===ya.bottom&&ya.left+1===ya.right||ya.top+1===ya.bottom&&ya.left===ya.right}}La.Rak=268435712;La.dXc=500;Object(f.a)(La,"SelectionReadoutHandler",
null,[396,3]);var va=a(58),Ba=a(717),Ea=a(70);class pa extends d.a{constructor(ya){super();this.$=ya;this.Gb()}create(){const ya=this.$.da,V=P.GetServiceTaskFactory.Pa(ya,211,212,this.Na),Z=P.GetServiceTaskFactory.Pa(ya,66,134,this.Na),ja=Object(Ea.b)("OfficeVSO:7624512_MigrateSparklineManagerService")?Object(G.c)(E.a.resolve(O.Q,{Wb:this.Na})):P.GetServiceTaskFactory.Pa(ya,240,239,this.Na);let la=va.Task.Ta(null);e.EwaSettings.vb()&&(la=P.GetServiceTaskFactory.Pa(ya,244,315,this.Na));D.TaskExtensions.za(D.TaskExtensions.Md([V,
Z,ja,la],this.ka),()=>{const ua=Object(Ba.a)(this.$.da,226,()=>new La(V.result,this.$,Z.result,ja.result,la.result));this.qb(ua)},this.$.ka,3)}static la(ya){ya.da.Ha(227,new pa(ya))}}Object(f.a)(pa,"SelectionReadoutHandlerFactory",d.a,[]);var $a=a(155);class cb{constructor(ya,V){this.$=V;this.ariaLiveNotifier=ya}RUf(){const ya=this.NSh();this.ariaLiveNotifier.vcb(ya,k.a.mqb)}NSh(){const ya=new Sys.StringBuilder;this.$.workbookContext&&v(ya,this.$.workbookContext.WorkbookFileName);v(ya,x.a.instance.ga(855));
v(ya,this.PSh());v(ya,this.OSh());v(ya,x.a.instance.ga(856));return ya.toString()}PSh(){return this.$.isEditMode?x.a.instance.ga(860):x.a.instance.ga(861)}OSh(){var ya=this.aak();const V=this.$.ua.na;ya=1!==ya?String.format(x.a.instance.nb(32),ya):x.a.instance.ga(854);ya=new Sys.StringBuilder(ya);V&&V.sheetName&&(ya.append(y.Uyd),ya.append(String.format(x.a.instance.nb(33),V.sheetName)));return ya.toString()}aak(){let ya=0;for(const V of this.$.ua.items)V.visible&&ya++;return ya}}Object(f.a)(cb,"WorkbookReadout",
null,[]);var ib=a(472);let ta=class{constructor(ya,V,Z){this.hHf=()=>{this.g4d.RUf();this.ariaLiveNotifier.setEnabled(!0)};this.$=V;this.ariaLiveNotifier=ya;this.g4d=new cb(ya,V);this.Kbc=Z.wjd(this.$);this.Kbc.zQg(this.hHf)}dispose(){this.Kbc&&this.Kbc.Xoj(this.hHf);this.Kbc=this.ariaLiveNotifier=this.$=null}};ta=Object($a.b)([Object(E.d)(O.n),Object($a.c)(0,Object(ib.AriaLiveNotifierService)()),Object($a.c)(1,Object(O.o)()),Object($a.c)(2,Object(O.L)())],ta);Object(f.a)(ta,"EmbeddedWorkbookReadoutHandler",
null,[3]);let Ya=class{constructor(ya,V){this.$V=()=>{this.Ld||this.hve()};this.Ld=!1;this.YY=V.VY;this.ariaLiveNotifier=ya;this.g4d=new cb(ya,V);this.YY&&this.YY.XQ?this.hve():this.Gj()}dispose(){this.Xj();this.ariaLiveNotifier=this.YY=null;this.Ld=!0}Gj(){if(this.YY){this.YY.ev(this.$V);this.YY.Ca.dw(this.$V);this.YY.uE(this.$V);var ya=Object(U.a)(214,this.YY);ya&&(ya.Xb.gl(this.$V),ya.ha.jC(this.$V),ya.ha.vA(this.$V),ya.ha.Sa.A2(this.$V))}else h.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}Xj(){if(this.YY){this.YY.Ca.Xw(this.$V);
this.YY.VF(this.$V);const ya=Object(U.a)(214,this.YY);ya&&(ya.Xb.Zk(this.$V),ya.ha.xB(this.$V),ya.ha.TF(this.$V),ya.ha.Sa.Fna(this.$V))}}hve(){this.g4d.RUf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.iDj();this.dispose()}};Ya=Object($a.b)([Object(E.d)(O.U),Object($a.c)(0,Object(ib.AriaLiveNotifierService)()),Object($a.c)(1,Object(O.o)())],Ya);Object(f.a)(Ya,"WorkbookReadoutHandler",null,[3]);class Da extends d.a{constructor(ya){super();this.$=ya;this.Gb()}create(){const ya=P.GetServiceTaskFactory.Pa(this.$.da,
211,212,this.Na);if(this.$.wF){const V=Object(Ea.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(G.c)(E.a.resolve(O.L,{Wb:this.Na})):P.GetServiceTaskFactory.Pa(this.$.da,12,477,this.Na);D.TaskExtensions.za(D.TaskExtensions.Md([ya,V],this.$.ka),()=>{const Z=Object(Ba.a)(this.$.da,228,()=>new ta(ya.result,this.$,V.result));this.qb(Z)},this.$.ka,3)}else D.TaskExtensions.za(ya,V=>{const Z=Object(Ba.a)(this.$.da,228,()=>new Ya(V.result,this.$));this.qb(Z)},this.$.ka,3)}static la(ya){ya.da.Ha(229,
new Da(ya))}}Object(f.a)(Da,"WorkbookReadoutHandlerFactory",d.a,[]);a.d(B,"a",function(){return ba});const ba=()=>{b.a.Fa(ya=>{N.la(ya);e.EwaSettings.vb()?R.la(ya):ea.la(ya);pa.la(ya);Object(Ea.b)("OfficeVSO:7641163_MigratingWorkbookReadoutHandlerService")||Da.la(ya)})};String(c);String(r);window.___1678693024267_closurehack=c;window.___1678693024267_closurehack=r},1195:function(r,B,a){var c=a(9);r=a(0);var b=a(714),e=a(50),f=a(38),d=a(15),h=a(4),l=a(34),k=a(5),w=a(24),n=a(73),x=a(59);class m{constructor(eb,
Eb){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=eb;this.sortType=Eb}YU(){return this.autoFilterOptions}}Object(r.a)(m,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[123]);class u{constructor(eb){this.autoFilterOptions=null;this.autoFilterOptions=eb}YU(){return this.autoFilterOptions}}Object(r.a)(u,"MacroRecorderRangeItemFilteredPayload",null,[123]);var t=a(1163),y=a(44),v=a(379),A=a(198),z=a(63),C=a(182),H=a(217),I=a(49),S=a(45),P=a(12),D=a(255),G=a(1),E=a(196),O=a(22),
N=a(290),J=a(21);class W{constructor(eb,Eb){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=eb;this.tableRange=y.l(eb.Ranges[0],eb.SheetName);this.styleIndex=Eb}}Object(r.a)(W,"MacroRecorderTableStyleAppliedPayload",null,[123]);class ea extends W{constructor(eb,Eb,Wb,Ab){super(eb,Wb);this.isCreation=this.hasHeaders=!1;this.hasHeaders=Eb;this.isCreation=Ab}}Object(r.a)(ea,"MacroRecorderRangeFormatedAsTablePayload",W,[]);class R{constructor(eb,Eb,Wb){this.description=this.title=
this.tableRange=null;this.tableRange=eb;this.title=Eb;this.description=Wb}Qp(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(r.a)(R,"MacroRecorderTableAltTextEditedPayload",null,[123]);class Y{constructor(eb,Eb){this.newName=this.oldName=null;this.oldName=eb;this.newName=Eb}}Object(r.a)(Y,"MacroRecorderTableRenamedPayload",null,[123]);class U{constructor(eb){this.originalRange=null;this.originalRange=eb}}Object(r.a)(U,"MacroRecorderTableResizedPayload",
null,[123]);class da{constructor(eb,Eb,Wb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=eb;this.optionType=Eb;this.isPivotTable=Wb}}Object(r.a)(da,"MacroRecorderTableStyleOptionToggledPayload",null,[123]);var T=a(29),ka=a(46);class L{constructor(eb){this.tableName=null;this.tableName=eb}}Object(r.a)(L,"MacroRecorderTableConvertedToRangePayload",null,[123]);var fa=a(827);class wa{constructor(eb,Eb,Wb){this.isQueryTable=!1;this.sharedSheetRange=Eb;this.$=eb;this.ai=this.$.Mb.vg("UserAction",
"ConvertToRangeManager");this.tableName=Wb}ubb(){this.ai.start();const eb=this.$.pa.va.$b();return fa.i(this.$.pa.va,this.sharedSheetRange,Eb=>{this.showDialog(Eb)},null,null,null,eb)}showDialog(eb){d.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.ai.Fc} milliseconds`);eb&&!D.a(eb)&&((this.isQueryTable=eb.Result)?(eb=T.a.hd(3,2,0,738,0,-66108047,"ConvertToRange"),f.TaskExtensions.za(ka.a(this.$).vj(eb),Eb=>{d.ULS.sendTraceTag(537151192,
0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.ai.Fc} milliseconds`);0===Eb.result&&this.sdh()},this.$.ka,11)):this.tdh());this.ai.stop();d.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.ai.Fc} milliseconds`)}Vze(){const eb={};eb.IsQueryTable=this.isQueryTable;eb.Range=this.sharedSheetRange;return eb}sdh(){const eb=this.$.pa.va;d.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");
this.sif(194,(Eb,Wb,Ab)=>fa.d(eb,this.Vze(),Eb,Wb,Ab,null));d.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}tdh(){const eb=this.$.pa.va;d.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.sif(193,(Eb,Wb,Ab)=>fa.c(eb,this.Vze(),Eb,Wb,Ab,null),()=>new L(this.tableName));d.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}sif(eb,Eb,Wb=null){v.a(this.$.userOperationManager,Eb,Ab=>new A.a(eb,0,Ab,void 0,Wb),
null)}}Object(r.a)(wa,"ConvertToRangeManager",null,[]);var oa=a(1162),xa=a(972),bb=a(14);class Za extends xa.a{constructor(eb,Eb){super(eb);this.FPb=Eb}get pc(){return"FormatAsTableDialog"}get MB(){return 215}get ll(){return bb.a.instance.ga(732)}ak(){const eb=y.s(this.daa.TableRange);return()=>new ea(eb,this.hasHeaders,this.FPb,!0)}ZG(){const eb=y.s(this.daa.TableRange),Eb=this.daa.HasTotalRow;return(Wb,Ab,Jb)=>fa.h(this.$.pa.va,eb,this.hasHeaders,!1,Eb,this.FPb,Wb,Ab,Jb,null)}}Object(r.a)(Za,"FormatAsTableReactDialog",
xa.a,[]);xa=a(292);var La=a(93);class va extends xa.a{constructor(eb){super(eb);this.QVj=(Eb,Wb)=>{1===Eb&&this.I_j(y.E(this.tOf(Wb[va.ZTf])))};this.eyb=Eb=>{Eb=this.Nid(Eb);return this.Mfd(Eb)};this.gridView=J.h(eb);this.ra=this.gridView.ha.ra;this.jsc=this.gridView.tb.uh(this.ra.activeCell).usedRange;eb=this.NM(this.jsc.toString());this.initializeAndShow(bb.a.instance.ga(733),this.QVj,eb)}get pc(){return"ResizeTableDialog"}tOf(eb){eb=eb.startsWith("=")?eb.substring(1,eb.length):eb;if(({sheetName:eb,
range:Eb}=y.ab(eb,this.$.ua)).returnValue&&Eb){var Eb=y.v(Eb,this.$);Eb.SheetName=O.a.equals(eb,"",!0)?this.$.na.name:eb;return Eb}return null}NM(eb){return{[va.oV]:"ResizeTableDialog",[va.ZTf]:eb,["getInputErrorIfInvalid"]:this.eyb}}Nid(eb){eb=this.tOf(eb);if(!eb)return 1;const Eb=y.E(eb);return O.a.equals(eb.SheetName,this.$.na.sheetName,!0)&&this.jsc.top===Eb.top&&this.jsc.vd(Eb)?0:2}Mfd(eb){let Eb="";switch(eb){case 1:Eb=bb.a.instance.ga(75);break;case 2:Eb=La.a.qf(bb.a.instance.ga(74))}return Eb}I_j(eb){this.$.Yc(-1400250766,
n.a.zb,8,{["ResizeTableRange"]:eb,["OriginalTableRange"]:this.jsc})}}va.oV="id";va.ZTf="range";Object(r.a)(va,"ResizeTableDialog",xa.a,[]);class Ba extends xa.a{constructor(eb){super(eb);eb=J.h(this.$);eb=eb.tb.uh(eb.ha.ra.activeCell);O.a.ah(eb.bUa)?this.LGd="":this.LGd=eb.bUa;O.a.ah(eb.cUa)?this.KGd="":this.KGd=eb.cUa;eb=this.NM(this.LGd,this.KGd);this.initializeAndShow(bb.a.instance.ga(742),this.EVj,eb)}get pc(){return"TableAltTextDialog"}EVj(eb,Eb){1===eb&&(eb=Eb[Ba.gYj],Eb=Eb[Ba.Qoh],eb===this.LGd&&
Eb===this.KGd||this.$.Yc(868579142,n.a.zb,8,{["Title"]:eb,["Description"]:Eb}))}NM(eb,Eb){return{["id"]:"AltTextDialog",["title"]:eb,["description"]:Eb}}}Ba.oV="id";Ba.gYj="title";Ba.Qoh="description";Object(r.a)(Ba,"TableAltTextDialog",xa.a,[]);var Ea=a(787),pa=a(788),$a=a(118),cb=a(74),ib=a(58),ta=a(33),Ya=a(150),Da=a(106),ba=a(153),ya=a(54);class V{constructor(eb,Eb,Wb,Ab){this.menuId=null;this.mSa=-1;this.hVi=Jb=>{if(!D.a(Jb)){const Nb=J.h(this.$);var Gb=new w.Range(1,1,1,1,!0,!1);Gb=y.v(Gb,this.$);
null!=Jb.Result&&(Ya.a("CreateSampleTable.NewSheet"),Gb.SheetName=Jb.Result.toString());Nb.sg(Gb,null,null,null,0,"TableCommandHandler.OnCreateSampleTableDone")}};this.KLf=()=>{this.Kda()};this.Y4i=Jb=>{if(!(this.ra.LMa()||(!G.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||D.a(Jb)||this.eNa())&&D.a(Jb)&&this.eNa())){Jb=this.ra.activeCell;var Gb=this.ra.activeRange;const Nb=this.tableManager.Xi.usedRange;2===this.mSa&&C.g(this.tableManager.Xi)&&Jb.bottom===
Nb.bottom&&(Gb=Gb.v5?new w.Range(Gb.top-1,Gb.left,Gb.bottom-1,Gb.right,!1,!0):new w.Range(Gb.top,Gb.left,Gb.bottom-1,Gb.right,!1,!0),Jb=Gb.contains(Jb)?Jb:w.Range.Hc(Gb.bottom,Jb.left),J.h(this.$).ha.updateSelection(Gb,Jb,0,3))}};this.q4i=Jb=>{D.a(Jb)?(d.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),this.$.tf()):d.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.p4i=
()=>{d.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.tf()};this.r4i=(Jb,Gb)=>{Gb&&this.OO(Gb);D.b(Jb,-569193796)&&(cb.a(this.$).kd.WL(-569193796),this.DDi(Jb.Errors[0]))};this.$=eb;this.tableManager=Eb;this.namedSheetViewPublic=Wb;this.frame=this.$.frame;this.ha=J.h(this.$).ha;this.ra=this.ha.ra;this.aB=G.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.bB=ta.a.bB();this.tableStyleManager=Ab;this.tableStyleManager.GRg(this.KLf)}Mc(eb,
Eb){switch(Eb){case -544558380:return!(this.tableManager&&this.ra.YM()&&!this.eNa()&&C.d(this.tableManager.Xi));case 1544516694:return!(this.tableManager&&(this.ra.YM()?!this.eNa():this.ra.LMa()));case -697806646:case 323142015:return!this.ra.YM();case 341449783:case 2128797448:return G.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.ra.YM()?!this.eNa():this.ra.LMa())):!(this.tableManager&&this.tableManager.Oud(this.ra.activeCell));case -123538519:return!(this.ra.YM()&&
this.tableStyleManager&&this.tableStyleManager.Pud());case 756677940:return!this.tpi();case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.upi());case 844144422:return!this.ra.YM();case -723113214:return!this.ra.YM();case 1371713064:case 875133075:return!ta.a.bB()||Da.k(this.$.gg)}return!1}executeCommand(eb,Eb,Wb){var Ab;eb=f.TaskExtensions.Yj();const Jb=this.$.pa.va;let Gb=null,Nb=1;const Ja=Eb.command,ab=this.$.pa.va.$b();let wb=null;if(this.bB)switch(Ja){case -2058042992:case 504133448:case -798968736:case 477776686:H.d(this.$,
Wb.TopCellAddress,Ja,null);break;case -1400250766:H.d(this.$,Wb.OriginalTableRange,Ja,null);break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 341449783:case 1544516694:case 2128797448:const rb=J.h(this.$);H.d(this.$,rb.ha.ra.activeCell,Ja,null)}switch(Ja){case -2058042992:const rb=x.a.Yh(Wb[n.a.Sf]);G.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&!rb.CriteriaType&&(rb.CriteriaType=0);V.t6f(this.$,rb);Gb=
(F,na,hb)=>fa.a(Jb,rb,null,null,!1,!1,!1,Ea.a.K5a($a.a.fta,pa.a.clearAutoFilter,F),na,hb,null);Nb=176;wb=()=>new u(rb);break;case 504133448:case -798968736:case 477776686:const za=x.a.Yh(Wb[n.a.Sf]),Aa=Wb.TopCellAddress;V.t6f(this.$,za);const pb=504133448===Eb.command?1:-798968736===Eb.command?2:3;if(Aa){Wb=this.tableManager.Qp(Aa);if(!Wb){var xb=this.$.ua.na;(null===(Ab=y.E(xb.ZW))||void 0===Ab?0:Ab.contains(Aa))?Wb=y.E(xb.ZW):d.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(Wb&&
!this.$.y_c([Wb],!0,1))break}else if(Wb&&!this.$.$s([Wb],!0,1))break}Gb=(F,na,hb)=>z.H(Jb,za,pb,N.b(F,this.r4i),na,hb,Aa,ab);Nb=177;wb=()=>new m(za,pb);break;case 341449783:case 2128797448:this.mSa=341449783===Ja?0:2;({fDa:Gb,operationName:Nb,ak:wb}=this.toggleTableStyleOption(Jb,ab));break;case -712419744:this.aB?this.cif(Wb[k.a.event]):this.cif(null);break;case 875133075:case 1371713064:let kb=y.r(this.ra.selectedRanges,this.$);if(!kb)break;const Cb=this.y6h(Wb);Gb=(F,na,hb)=>fa.e(Jb,kb,Cb,N.b(F,
this.hVi),na,hb,null,ab);Ab="TestHost"===this.$.ya.DocumentHostInfo.HostTier;d.ULS.shipAssertTag(512275419,0,"OneDriveWOPI"===this.$.ya.HostName||Ab,"TableCommandHandler.CreateSampleTable: command executed for non-consumer audience and missing macro recorder");Nb=1025;break;case 1868184698:if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({oBb:Ab,fDa:Gb,ak:wb}=this.vjg(null,ab),Ab)){Nb=206;break}new oa.a(this.$);break;case 844144422:new va(this.$);break;case 1544516694:case -544558380:if(Ab=
Wb[n.a.Pc])this.mSa=this.N8h(Ab),-1!==this.mSa&&({fDa:Gb,operationName:Nb,ak:wb}=this.toggleTableStyleOption(Jb,ab));break;case 756677940:if(this.eNa()&&this.tnf()){d.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}const ob=Wb.Text,qa=this.J0h();if(qa){Gb=(na,hb,Ib)=>fa.j(Jb,ob,qa,N.b(na,this.q4i),N.a(hb,this.p4i),Ib,ab);Nb=217;let F=null;this.tableManager.Xi?F=this.tableManager.Xi.name:
this.tableManager.qJd?F=this.tableManager.qJd.name:d.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");F&&(wb=()=>new Y(F,ob))}else return d.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),ib.Task.Ta(!1);break;case 323142015:if(this.eNa())break;return(new wa(this.$,this.egd(),this.tableManager.Xi.name)).ubb();
case -1400250766:Nb=211;Gb=this.Utj(Wb,Jb,ab);const ma=y.m(Wb.OriginalTableRange,this.$.ua.na);wb=()=>new U(ma);break;case 1872288872:this.tableManager.ifj();break;case -123538519:const Ga=this.M8h(Wb);Ab=O.a.contains(Wb[n.a.Pc],k.a.mJb,!0)||O.a.contains(Wb[k.a.dG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";d.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${Ab} with style index ${Ga.toString()}`);let vb=this.l9e();vb&&
(Gb=(F,na,hb)=>fa.b(Jb,vb,Ga,F,na,hb,null,ab),wb=()=>new W(vb,Ga),Nb=212);break;case 753331043:Ab=Wb[n.a.Pc];if(!Ab)break;const Ka=Number.parseInvariant(Ab);if(this.ra.YM()){d.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${Ka}`);let F=this.l9e();F&&(Gb=(na,hb,Ib)=>fa.h(Jb,F,!1,!1,!1,Ka,na,hb,Ib,null,ab),wb=()=>new ea(F,!1,Ka,!1),Nb=215);break}if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({oBb:Wb,
fDa:Gb,ak:wb}=this.vjg(Ka,ab),Wb)){Nb=215;break}d.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${Ka}`);new Za(this.$,Number.parseInvariant(Ab));break;case 71074531:const Pa=Wb.HasHeader,fb=Wb.TableRange;if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:7553123_formattablefromrange")){const F=null!==(xb=Wb.StyleIndex)&&void 0!==xb?xb:22;let na=y.s(fb);Gb=(hb,Ib,vc)=>fa.h(Jb,na,Pa,!1,!1,F,hb,Ib,vc,null,ab);wb=()=>new ea(na,Pa,F,!0)}else Gb=
(F,na,hb)=>fa.f(Jb,fb,Pa,!1,!1,F,na,hb,null),wb=()=>new t.a(Pa,fb);Nb=206;break;case -723113214:new Ba(this.$);break;case 868579142:d.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Nb=1022;const Wa=Wb.Title,Ma=Wb.Description,lb=this.egd();Gb=(F,na,hb)=>fa.g(Jb,Wa,Ma,lb,F,na,hb,null);let Na,X;this.tableManager.Xi&&(Na=O.a.ah(this.tableManager.Xi.bUa)?"":this.tableManager.Xi.bUa,X=O.a.ah(this.tableManager.Xi.cUa)?"":this.tableManager.Xi.cUa);wb=Wa==Na?()=>new R(lb,void 0,Ma):Ma==X?()=>
new R(lb,Wa,void 0):()=>new R(lb,Wa,Ma);break;default:return E.a(Ja)}if(Gb){const rb=za=>new A.a(Nb,0,za,void 0,wb);eb=!this.namedSheetViewPublic||-2058042992!==Ja&&504133448!==Ja&&-798968736!==Ja&&477776686!==Ja?v.a(this.$.userOperationManager,Gb,rb,Eb):this.namedSheetViewPublic.lTa().continueWith(za=>{za.result&&v.a(this.$.userOperationManager,Gb,rb,Eb)})}return eb}toggleTableStyleOption(eb,Eb){const Wb=this.ra.LMa();d.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${Wb?"PivotTable":
"table"} style option ${this.mSa} was toggled.`);const Ab=this.egd();return{fDa:(Jb,Gb,Nb)=>fa.l(eb,Ab,this.mSa,N.b(Jb,this.Y4i),Gb,Nb,null,Eb),operationName:196,ak:()=>new da(Ab,this.mSa,Wb)}}Utj(eb,Eb,Wb){const Ab=eb.OriginalTableRange,Jb=y.m(eb.ResizeTableRange,this.$.ua.na),Gb=()=>{this.tableManager.kgg(Ab)},Nb=Ja=>{Ja.Errors&&this.tableManager.kgg(Ab)};return(Ja,ab,wb)=>fa.k(Eb,Jb,N.b(Ja,Nb),N.a(ab,Gb),wb,null,Wb)}M8h(eb){var Eb=-1;eb[n.a.Pc]&&(Eb=eb[n.a.Pc],Eb=O.a.contains(Eb,k.a.mJb,!0)?this.tableStyleManager.dyb(Eb):
Number.parseInvariant(eb[n.a.Pc]));return Eb}y6h(eb){return(eb=eb[n.a.Pc])?Number.parseInvariant(eb):0}Ac(eb,Eb){eb=!1;switch(Eb.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 756677940:case 868579142:eb=!0;break;case 875133075:case 1371713064:eb=ta.a.bB()}return eb}Rc(eb,
Eb,Wb){eb=!1;switch(Eb){case "PopulateTableMoreStylesMenu":this.menuId=Wb.MenuId;this.tableStyleManager.Pud()||this.tableStyleManager.L5a("formatAsTableMenu");eb=this.tableStyleManager.QPf(Eb,Wb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Wb.MenuId,this.tableStyleManager.Pud()||this.tableStyleManager.L5a("accessibilityTab"),eb=this.tableStyleManager.QPf(Eb,Wb)}return eb}dispose(){this.tableStyleManager.Ppj(this.KLf)}Kda(){(O.a.contains(this.menuId,"Format",!0)||O.a.contains(this.menuId,
"Accessible",!0))&&this.menuId&&this.frame.jx(this.menuId)}egd(){return y.v(this.ra.activeCell,this.$)}J0h(){const eb=this.tableManager.gwd;return eb?y.v(eb,this.$):null}cif(eb){if(this.tableManager){var Eb=J.h(this.$),Wb=this.ra.activeCell,Ab=this.tableManager.Qp(Wb),Jb=null;if(!Ab||Ab.RBa)for(let Gb of Eb.iia)for(let Nb of Gb)Eb=Nb.zt,Wb.left>=Eb[0]&&Wb.left<=Eb[Eb.length-1]&&(Jb=(Eb=Nb.es(Wb).cK())?P.DOMElementExtensions.hk(Eb,l.a.rue):null);else{const Gb=Eb.Jb(w.Range.Hc(Ab.top,Wb.left));if(this.aB){I.a.instance.create(()=>
{Gb.invoke(8,eb)},0,S.a.fgg,!0,!0);return}Jb=Gb.tLa(56).a7a}Jb&&I.a.instance.create(()=>{P.DOMElementExtensions.Qhc(Jb,null)},0,S.a.fgg,!0,!0)}}N8h(eb){eb=Number.parseInvariant(eb);return-1<eb&&8>=eb?eb:-1}eNa(){return!this.tableManager.Xi}tnf(){return this.tableManager.qJd?!1:(d.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}upi(){const eb=this.ra.YM(),Eb=this.ra.eh&&!J.h(this.$).tb.o5(this.ra.xd);return eb||Eb}tpi(){return this.ra.YM()||
!this.tnf()}Q8h(eb){const Eb=[];for(const Wb of eb)if(eb=H.b(this.$,Wb),null===eb||void 0===eb?0:eb.length)for(const Ab of eb)Ab.usedRange&&!Eb.includes(Ab.usedRange)&&Eb.push(Ab.usedRange);return Eb}l9e(){const eb=this.ra.selectedRanges;let Eb=[];if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))Eb=this.Q8h(eb);else for(const Wb of eb)J.h(this.$).tb.o5(Wb)&&Eb.push(Wb);return Eb&&Eb.length?y.r(Eb,this.$):null}OO(eb){ta.a.Ela(this.$)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Pa(this.$.da,
430,431,1),Eb=>{Eb.result.Qea(eb);d.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ka,3)}DDi(eb){G.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")?void ba.a.resolve(ya.P,{Wb:0}).then(Eb=>{Eb.YKe(this.$,eb)}):f.TaskExtensions.za(e.GetServiceTaskFactory.Pa(this.$.da,446,447,0),Eb=>{Eb.result.YKe(this.$,eb)},this.$.ka,3)}static t6f(eb,Eb){Eb.SheetName=eb.na.name;Eb.NamedObjectView=eb.ea.isNamedObjectViewMode}vjg(eb,
Eb){let Wb,Ab;if(!this.ra.eh||1!=this.ra.xd.hw)return{oBb:!1,fDa:Wb,ak:Ab};let Jb=y.v(this.ra.xd,this.$);Jb.LastColumn=Jb.FirstColumn+3-1;Jb.LastRow=Jb.FirstRow+4-1;const Gb=y.E(Jb),Nb=J.h(this.$);if(!Gb.wz||!Nb.tb.Fla(Gb))return{oBb:!1,fDa:Wb,ak:Ab};h.AFrameworkApplication.Qq("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{oBb:!1,fDa:Wb,ak:Ab};if(null==eb)Wb=(Ja,ab,wb)=>fa.f(this.$.pa.va,
Jb,!1,!1,!1,Ja,ab,wb,Eb),Ab=()=>new t.a(!1,Jb);else{const Ja=y.s(Jb);Wb=(ab,wb,xb)=>fa.h(this.$.pa.va,Ja,!1,!1,!1,eb,ab,wb,xb,Eb);Ab=()=>new ea(Ja,!1,eb,!0)}return{oBb:!0,fDa:Wb,ak:Ab}}}Object(r.a)(V,"TableCommandHandler",null,[222]);var Z=a(70),ja=a(108);class la extends b.a{constructor(eb){super(eb)}dispose(){super.dispose()}ld(){const eb=e.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Na),Eb=e.GetServiceTaskFactory.create(this.$.da,330,this.ka,this.Na),Wb=Object(Z.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?
Object(ja.c)(ba.a.resolve(ya.z,{Wb:this.Na})):e.GetServiceTaskFactory.Pa(this.$.da,309,310,this.Na);if(ta.a.bB()){const Ab=e.GetServiceTaskFactory.create(this.$.da,128,this.ka,this.Na);f.TaskExtensions.za(ib.Task.uG(eb,Wb,Eb,Ab),()=>{this.fd([new V(this.$,eb.result,Wb.result,Eb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.ka,3)}else f.TaskExtensions.za(ib.Task.uG(eb,Wb,Eb),()=>{this.fd([new V(this.$,eb.result,Wb.result,Eb.result)],[2128797448,341449783,
1544516694,-544558380,-123538519,753331043,756677940])},this.$.ka,3)}static la(eb){b.a.Rd(86,new la(eb))}}Object(r.a)(la,"TableCommandHandlerFactory",b.a,[]);a.d(B,"a",function(){return ua});const ua=()=>{c.a.Fa(eb=>{la.la(eb)})}},1198:function(r,B,a){r=a(0);var c=a(88),b=a(558),e=a(15);class f{constructor(){this.RHc={}}wKg(xa){this.RHc[xa.id.toString()]=xa}jQi(xa){const bb=this.RHc;for(let Za in bb)bb[Za].notify(xa,!1);this.RHc={}}nej(xa,bb){bb&&this.wKg(bb);return this.SJf(xa,bb)}pad(xa){this.jQi(xa)}fRe(xa,
bb){xa.notify(bb,!0)}}Object(r.a)(f,"AEventEmitter",null,[381]);var d;(function(xa){xa[xa.notStarted=0]="notStarted";xa[xa.waiting=1]="waiting";xa[xa.shouldRetry=2]="shouldRetry";xa[xa.complete=3]="complete"})(d||(d={}));Object(r.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(xa){e.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[xa]},"ResultType",this.K8e());this._state=xa}}Object(r.a)(h,
"AEventResult",null,[463]);class l extends h{constructor(){super();this.dVc=this.Bmb=null;this.state=0;this.YNc=this.bce=!1}get ER(){return this.Bmb}get Soa(){return this.dVc}get Mni(){return this.bce}K8e(){return"GetMoreInfo Result"}}Object(r.a)(l,"GetMoreInfoResult",h,[493,463]);var k=a(4),w=a(82),n=a(41),x=a(704),m=a(381),u=a(172),t=a(657),y=a(581),v=a(111),A=a(25);class z{constructor(xa,bb,Za,La,va,Ba,Ea,pa){this.La=xa;this.rh=bb;this.Yvg=Za;this.n1=La;this.pe=va;this.CMc=Ba;this.OAg=Ea;this.uZb=
pa}Tjj(){this.D$a.Qb(A.a.openUrlInNewTab,v.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.D$a.Qb(A.a.aQa,v.a.frame,Object(c.a)(this,this.aQa,"openDocumentUrl"));k.AFrameworkApplication.yM?this.guf():this.D$a.Je(A.a.B9b,v.a.frame,Object(c.a)(this,this.B9b,"documentLoaded"),96)}openUrlInNewTab(xa,bb,Za,La,va){va&&va.MenuItemId&&(e.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:va.SourceControlId,["AppType"]:y.a[this.Ica]}),n.a.nf(va.MenuItemId.toString(),"_blank",
void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}aQa(xa,bb,Za,La,va){if(va&&va.MenuItemId){const Ba=k.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),Ea=k.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");e.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Ba,Ea);if(Ba&&Ea){e.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:va.SourceControlId,["AppType"]:y.a[this.Ica]});xa=va.MenuItemId.toString();
const pa={};pa[m.a.UQa]="1";pa[m.a.documentUrl]=xa;pa[m.a.reason]=t.a.open;e.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");k.AFrameworkApplication.JQ().execute($a=>{$a.uj(u.a.fZ,pa)})}else this.openUrlInNewTab(xa,bb,Za,La,va)}return 32}B9b(){this.guf();return 32}FOa(xa,bb,Za=""){if(bb&&bb.sF){const La=x.a[bb.status];bb=bb.sF.getTime();const va=this.vw()-bb;e.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:xa,["RequestStatus"]:La,
["ElapsedMs"]:va,["StartTime"]:bb,["Notes"]:Za})}else e.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:xa})}guf(){var xa=k.AFrameworkApplication.fa.qa("QPGVCI"),bb=w.a.xw(document.URL,"wdNewAndOpenCt",xa);if(bb){bb=parseInt(bb);var Za=w.a.xw(document.URL,"wdPreviousSession",xa);xa=w.a.xw(document.URL,"wdPreviousCorrelation",xa);var La=k.AFrameworkApplication.fa.qa("NAOPLP");if(k.AFrameworkApplication.yM){var va=k.AFrameworkApplication.yM.getTime();
!bb||bb>va?e.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:bb,["DocumentLoadedTime"]:va,["SessionId"]:Za,["Correlation"]:xa}):e.ULS.sendTraceTag(5849683,202,La?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:va-bb,["ClickTimestamp"]:bb,["SessionId"]:Za,["Correlation"]:xa})}else e.ULS.sendTraceTag(5849681,202,La?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:bb,["SessionId"]:Za,["Correlation"]:xa})}}get D$a(){return this.La.value}get bGb(){return this.rh.value}get Bzf(){return this.Yvg.value}get Ica(){return this.n1.value}get Toc(){return this.pe.value}get vw(){return this.CMc}get C_(){return this.OAg.value}get supportsGetMoreInfoForPersonalStorage(){return this.uZb.value}static get instance(){return z.Ma||(z.Ma=z.HM())}static HM(){return new z(new b.a(()=>k.AFrameworkApplication.rb),new b.a(()=>k.AFrameworkApplication.Hd),new b.a(()=>
k.AFrameworkApplication.sa),new b.a(()=>k.AFrameworkApplication.sa.Qa.ri),new b.a(()=>k.AFrameworkApplication.ti),()=>(new Date).getTime(),new b.a(()=>k.AFrameworkApplication.sa.Qa.C_),new b.a(()=>k.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}z.Ma=null;Object(r.a)(z,"NewAndOpenCommonHelpers",null,[380]);var C=a(112);class H{constructor(xa,bb,Za){this.GYb=this.Vi=null;this.rTc=0;this.DGg=xa;this.pe=bb;this.t9d=Za}pTg(){this.rTc=this.Kdb+1}zPd(xa){this.Vi&&(this.pe.$o(this.Vi),this.Vi=
null);xa&&(this.rTc=0)}LSj(xa){const bb=this.YXj;0<=bb?(this.pTg(),this.zPd(!1),this.Vi=new C.a(4,1,bb,xa,107),this.pe.ig(this.Vi)):(this.zPd(!0),e.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.t9d}))}get Kdb(){return this.rTc}get YXj(){return this.Kdb>=this.W5f.length?-1:this.W5f[this.Kdb]}get W5f(){if(!this.GYb){const xa=(this.DGg.value||"0").split(",");this.GYb=[];for(let bb=0;bb<xa.length;bb++){const Za=parseInt(xa[bb]);isNaN(Za)?e.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
{["Action"]:this.t9d,["Entry"]:xa[bb]}):Array.add(this.GYb,Za)}}return this.GYb}}Object(r.a)(H,"RetryHelper",null,[]);var I=a(40),S=a(31);class P extends f{constructor(xa,bb){super();this.W1=xa;this.bnb=new H(bb,this.FFb.Toc,"GetMoreInfo");this.So=new l}pKi(){this.Qzd("Document opened")}Phh(xa){return()=>{this.Qzd(xa,!0)}}SJf(xa,bb=null){e.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:xa});3===this.So.state?(bb&&this.fRe(bb,this.So),e.ULS.sendTraceTag(5849619,
202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:xa})):this.Qzd(xa);return this.So}Qzd(xa,bb=!1){this.bnb.zPd(!bb);1===this.So.state?e.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:xa,["RetryIndex"]:this.bnb.Kdb}):(e.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:xa,["RetryIndex"]:this.bnb.Kdb}),this.So.state=1,bb=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.FFb.C_,k.AFrameworkApplication.xi),
this.FFb.bGb.eha(bb,1,null,null,[P.tie,P.tme],!1,5,this.Vgh(),this.Ugh(xa),null))}Vgh(){return xa=>{var bb=!1;let Za=!1;var La=!1,va;k.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody")&&(xa.data.me?({ot:va}=I.d(xa.data.me)).returnValue?va?(La=!0,this.So.dVc=va.StorageServiceDisplayName,this.So.Bmb=P.Opf(va.PersonalFileStorageUrl)?va.PersonalFileStorageUrl:"",""===this.So.ER&&"SharePointOnlineConsumer"===k.AFrameworkApplication.fa.Wa("FileSource")&&(this.So.Bmb=w.a.Mda(k.AFrameworkApplication.breadcrumbFolderUrl)),
bb=""===this.So.ER&&""!==this.So.Soa):e.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));La||((va=xa.data.responseHeaders)?
(this.So.dVc=(va[P.tme]||"").toString(),bb=(va[P.tie]||"").toString(),this.So.Bmb=P.Opf(bb)?bb:"",""===this.So.ER&&"SharePointOnlineConsumer"===k.AFrameworkApplication.fa.Wa("FileSource")?(this.So.Bmb=w.a.Mda(k.AFrameworkApplication.breadcrumbFolderUrl),bb=""===this.So.ER&&""!==this.So.Soa):bb=""===bb&&""!==this.So.Soa):(e.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Za=!0));La=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.bnb.Kdb,Za,bb,La);this.FFb.FOa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",xa.data,La);this.m6f(3,bb,Za)}}Ugh(xa){return bb=>{this.FFb.FOa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",bb.data,"Failure");this.m6f(2);this.bnb.LSj(this.Phh(xa))}}m6f(xa,bb=!1,Za=!1){this.So.state=xa;this.So.bce=bb;this.So.YNc=Za;this.pad(this.So)}get FFb(){return this.W1.value}static get instance(){return P.Ma||(P.Ma=P.HM())}static HM(){return new P(new b.a(()=>z.instance),new b.a(()=>
k.AFrameworkApplication.U1h))}static Opf(xa){if(!xa)return e.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(S.a.cl(xa).startsWith("https://"))return!0;e.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}P.tie="PersonalFileStorageUrl";P.tme="StorageServiceDisplayName";P.Ma=null;Object(r.a)(P,"GetMoreInfoActor",f,[]);var D=a(107),G=a(101);class E{constructor(xa,bb,Za,La,va){this.uBg=6E4;this.cgf="inactive";this.gpe=
"active";this.ZS=!0;this.pe=xa;this.uAg=bb;this.CMc=Za;this.KZb=La;this.Za=new G.a;va&&this.ESj();this.eee=this.l6e()}Ype(xa){this.Za.addHandler(this.gpe,xa)}SMg(xa){this.Za.addHandler(this.cgf,xa)}ESj(){const xa=new C.a(5,2,this.uBg,Object(c.a)(this,this.Pii,"inactiveLoop"),108);this.Qii.ig(xa)}Pii(){const xa=this.l6e(),bb=this.vw()-xa;bb>this.xDc&&this.ZS&&(e.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:bb}),this.ZS=!1,this.Za.raiseEvent(this.cgf));xa-this.eee>
this.xDc&&(this.ZS=!0,this.Za.raiseEvent(this.gpe));this.eee=xa}get Qii(){return this.pe.value}get l6e(){return this.uAg}get vw(){return this.CMc}get xDc(){return this.KZb.value}static get instance(){return E.Ma||(E.Ma=E.HM())}static HM(){return new E(new b.a(()=>D.a.instance),()=>k.AFrameworkApplication.Kwd.getTime(),()=>(new Date).getTime(),new b.a(()=>k.AFrameworkApplication.xDc),!0)}}E.Ma=null;Object(r.a)(E,"InactivityManager",null,[]);var O=a(87),N=a(932);class J extends h{constructor(){super();
this.rge=this.tge=this.sge=null;this.state=this.mne=0;this.YNc=!1}get nBd(){return this.sge}get Myf(){return this.tge}get mBd(){return this.rge}get dYj(){return this.mne}K8e(){return"MruActor Result"}}Object(r.a)(J,"MruResult",h,[462,463]);var W=a(244);class ea{constructor(xa,bb,Za){this.task=null;this.mhc=xa;this.$Li=bb;this.taskManager=Za;this.retryCount=this.RAb=0;this.CSc=this.ODb=null}swi(xa,bb){return xa===W.a.Sed||20===bb||18===bb||3===bb}Mxi(xa){return 3===xa||5===xa||6===xa||7===xa||9===
xa||10===xa||11===xa||12===xa||13===xa||14===xa||15===xa||16===xa||23===xa||26===xa||27===xa||28===xa}get Ptc(){return this.CSc}reset(){this.RAb=this.retryCount=0;this.CSc=this.ODb=null;this.task&&(this.taskManager.$o(this.task),this.task=null)}Wmi(xa,bb,Za,La){this.CSc=String.format("{0}_{1}",Za,La);if(this.retryCount>=this.$Li)return e.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.swi(Za,La))return e.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),
!1;if(this.Mxi(La)&&1<=this.RAb)return this.ODb=Za,!1;bb=Math.max(bb,this.mhc*Math.pow(2,this.RAb));if(26===La)bb=Math.max(bb,3E4);else if(27===La||28===La)bb=Math.max(bb,6E4);9===La||412===Za&&(null==this.ODb||412!==this.ODb)?bb=500:this.RAb+=1;this.ODb=Za;this.retryCount+=1;this.task&&this.taskManager.$o(this.task);e.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",bb);this.task=new C.a(2,1,bb,xa,107);this.taskManager.ig(this.task);return!0}}Object(r.a)(ea,"RetryManager",
null,[]);var R=a(102),Y=a(143),U=a(140);class da{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(r.a)(da,"WriteOptions",null,[]);var T=a(565),ka=a(199);class L extends f{constructor(xa,bb,Za,La,va,Ba,Ea){super();this.W1=xa;this.mDg=bb;this.Qra=new ea(k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.vD.Toc);this.qsa=new ea(k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.vD.Toc);this.CFg=Za;this.Coe=La;this.OJg={};this.bT=new J;this.qAg=va;this.QWb="";this.Wv=Ba;this.t$d=Ea}get YGc(){return this.OJg}Nlj(){this.vD.D$a.Qb(A.a.renameMostRecentlyUsedFileEntry,v.a.frame,Object(c.a)(this,this.Eqj,"renameMruEntry"))}Eqj(){return this.n4d("Rename")}zKi(){this.Owf("File Opened")}AKi(){this.Owf("IntervalUpdate")}Owf(xa){e.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:xa});this.n4d(xa)}k4(xa){(xa=S.a.k4(xa))&&xa.startsWith(".")&&(xa=xa.substring(1,xa.length));return xa}n2e(){switch(this.vD.Ica){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}u$h(xa){var bb=this.qAg();if(!bb)return null;const Za=new da;Za.documentUrl=this.t$d.value?encodeURI(bb):bb;Za.mruItemId=this.QWb;Za.app=this.n2e();if(bb=this.Wv())Za.folderName=bb.breadcrumbFolderName,
bb=bb.ln,Za.documentName=S.a.Pp(bb),Za.documentExt=this.k4(bb);xa&&(Za.documentName?Za.documentName.length?255<=Za.documentName.length?xa.set("DocumentNameLength","Long"):2084<=Za.documentName.length&&xa.set("DocumentNameLength","VeryLong"):xa.set("DocumentNameLength","0"):xa.set("DocumentNameLength","Null"));return JSON.stringify(Za)}n4d(xa,bb=!1){if(4===this.vD.Ica&&!k.AFrameworkApplication.Aua)return 2;var Za=Y.a.Wr();Za&&(Za.set("Trigger",xa),Za.set("IsRetry",bb?"true":"false"),Za.set("MruIdSent",
this.QWb?"true":"false"),Za.set("URLEncoded",this.t$d.value?"true":"false"));R.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Za);xa=this.u$h(Za);if(!xa)return bb=!k.AFrameworkApplication.webEditingEnabled,Za&&(Za.set("WebEditingIsEnabled",k.AFrameworkApplication.webEditingEnabled?"true":"false"),Za.set("ProtectedFile",k.AFrameworkApplication.Ztc?"true":"false")),R.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",bb,!1,Object.assign(new ka.a,{extendedProperties:Za})),2;this.qsa&&
!bb&&this.qsa.reset();Za=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.vD.C_,this.localeName);this.Coe?this.YGc["X-FileId"]=k.AFrameworkApplication.xi:Za+=String.format("&{0}",k.AFrameworkApplication.xi);k.AFrameworkApplication.Ub&&(this.YGc["X-Office-AudienceGroup"]=Object(O.a)(String,k.AFrameworkApplication.Ub.AudienceGroup)||"");this.YGc["X-Timeout"]=15E3;return this.vD.bGb.Mm(Za,2,xa,this.YGc,!0,5,Object(c.a)(this,this.Bbk,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.Alh,
"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}Bbk(xa){this.$bf(xa.data)}$bf(xa){const bb=Y.a.Wr();this.qsa&&(bb&&this.qsa.Ptc&&(bb.set("LastError",this.qsa.Ptc),bb.set("NumRetries",this.qsa.retryCount.toString())),this.qsa.reset());const Za=N.c(xa.me);Za&&Za.diagnostics_data&&(this.QWb=Za.diagnostics_data.mru_id);xa=+xa.h3-+xa.sF;bb&&bb.set("RequestDuration",xa.toString());R.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ka.a,{extendedProperties:bb}))}Alh(xa){if(xa.data.httpStatus===
W.a.Otb)this.$bf(xa.data);else{var bb=xa.data.httpStatus===W.a.eJb,Za=Y.a.Wr();this.mcf(this.qsa,xa,this.nlh(),Za);Za&&(Za.set("StatusCode",xa.data.httpStatus.toString()),bb||this.NXc(xa.data,Za));R.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",xa.data.httpStatus),bb,!1,Object.assign(new ka.a,{extendedProperties:Za}))}}nlh(){return()=>{this.n4d("Retry",!0)}}$1h(){this.Mnc("Polling")}Z1h(){this.Mnc("Retry",!0)}rKi(){this.Mnc("Open")}qKi(){this.Mnc("Activity")}Mnc(xa,
bb=!1){e.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:xa});const Za=Y.a.Wr();Za&&(Za.set("Trigger",xa),Za.set("IsRetry",bb?"true":"false"));R.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Za);this.Qra&&!bb&&this.Qra.reset();this.Wgh(Object(c.a)(this,this.b2h,"getMruV2FromServerSuccessCallback"),Object(c.a)(this,this.Y1h,"getMruFromServerFailureCallback"))}NXc(xa,bb){xa&&xa.responseHeaders&&(xa=xa.responseHeaders["X-CorrelationId"])&&bb.set("ServerCorrelationId",
xa)}bHi(xa,bb){xa&&(bb&&bb.set("RequestDuration",(+xa.h3-+xa.sF).toString()),R.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ka.a,{extendedProperties:bb})))}b2h(xa){this.c2h(xa)}c2h(xa){var bb="";let Za=null,La=null,va=null;const Ba=N.c(xa.data.me);Ba&&(Za=Ba.places?Ba.places.items:[],La=Ba.documents?Ba.documents.items:[],(va=N.a(Ba,!1))&&(bb=I.c(va)));k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Qa.e_&&U.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(bb,
!0));bb=Y.a.Wr();this.Qra&&(bb&&this.Qra.Ptc&&(bb.set("LastError",this.Qra.Ptc),bb.set("NumRetries",this.Qra.retryCount.toString())),this.Qra.reset());va||Za||La?(this.vD.FOa("MruActor.GetMruV2FromServerSuccessCallback",xa.data,"Success"),this.wFc(3,va,Za,La),this.bHi(xa.data,bb)):(this.vD.FOa("MruActor.GetMruV2FromServerSuccessCallback",xa.data,"Failure: Invalid JSON"),bb&&this.NXc(xa.data,bb),R.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ka.a,{extendedProperties:bb})),
this.wFc(3,null,null,null,!0));this.pad(this.bT)}mcf(xa,bb,Za,La){let va=0,Ba=0;const Ea=N.c(bb.data.me);Ea&&(null!=Ea.response_code&&(va=Ea.response_code,La&&La.set("MruResponseCode",va.toString()),9===va&&(this.QWb="")),Ea.error_data&&null!=Ea.error_data.retry_after_ms&&(Ba=Ea.error_data.retry_after_ms,La&&La.set("ExpectedRetryAfter",Ba.toString())));xa&&(bb=xa.Wmi(Za,Ba,bb.data.httpStatus,va),La&&(La.set("CurrentRetryCount",xa.retryCount.toString()),La.set("RetryScheduled",bb?"true":"false")))}Y1h(xa){this.a2h(xa)}a2h(xa){const bb=
xa.data.httpStatus===W.a.eJb,Za=Y.a.Wr();Za&&(Za.set("StatusCode",xa.data.httpStatus.toString()),bb||this.NXc(xa.data,Za));this.vD.FOa("MruActor.GetMruFromServerFailureCallback",xa.data,"Failure");this.wFc(2);this.mcf(this.Qra,xa,Object(c.a)(this,this.Z1h,"getMruFromServerRetryTask"),Za);R.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",xa.data.httpStatus),bb,!1,Object.assign(new ka.a,{extendedProperties:Za}));this.pad(this.bT);k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Qa.e_&&
U.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}wFc(xa,bb=null,Za=null,La=null,va=!1){if(3!==this.bT.state||3===xa)this.bT.sge=bb,this.bT.tge=Za,this.bT.rge=La,this.bT.state=xa,this.bT.YNc=va,this.bT.mne=this.vD.vw()}SJf(xa,bb){e.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:xa,["ResultState"]:this.bT.state});bb&&3===this.bT.state&&this.fRe(bb,this.bT);return this.bT}Wgh(xa,bb){this.wFc(1);
let Za;const La={};Za=String.format(this.vD.C_+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.n2e(),this.localeName);this.CFg.value||(Za+="&entity=docs");k.AFrameworkApplication.Ub&&(La["X-Office-AudienceGroup"]=Object(O.a)(String,k.AFrameworkApplication.Ub.AudienceGroup)||"");this.Coe?La["X-FileId"]=k.AFrameworkApplication.xi:Za+=String.format("&{0}",k.AFrameworkApplication.xi);this.vD.bGb.Mm(Za,1,null,La,!0,5,xa,bb,null)}get vD(){return this.W1.value}get localeName(){return this.mDg.value}static get instance(){return L.Ma||
(L.Ma=L.HM())}static HM(){return new L(new b.a(()=>z.instance),new b.a(()=>T.a.bK(k.AFrameworkApplication.lcid).name),new b.a(()=>k.AFrameworkApplication.sa.Qa.Fv),k.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>k.AFrameworkApplication.sa.Qa.Kx,()=>k.AFrameworkApplication.um,new b.a(()=>k.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}L.Ma=null;Object(r.a)(L,"MruActor",f,[]);class fa{constructor(){this.eob=this.tje=this.$a=null;this.Jm=!1}get name(){return"Common.App.NewAndOpen.Core"}Kh(xa){this.$a=
xa;xa.register(380,"Common.INewAndOpenCommonHelpers").tc().Bc(()=>z.instance);xa.register(381,"Common.IEventEmitter<Common.IGetMoreInfoResult>").tc().Bc(()=>P.instance);xa.register(381,"Common.IEventEmitter<Common.IMruResult>").tc().Bc(()=>L.instance)}init(){k.AFrameworkApplication.fa.zu(()=>{this.CAb()})}CAb(){this.$a.resolve("Common.INewAndOpenCommonHelpers");this.$a.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.$a.resolve("Common.IEventEmitter<Common.IMruResult>");var xa=!1;z.instance.Tjj();
k.AFrameworkApplication.tma&&(xa=!0);k.AFrameworkApplication.IUf&&(L.instance.rKi(),0<k.AFrameworkApplication.Nyf&&this.Fqe(),this.oIj(),xa=!0);k.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&xa&&P.instance.pKi();k.AFrameworkApplication.b6j&&(xa=L.instance,xa.Nlj(),xa.zKi(),D.a.instance.ig(this.c6j))}oIj(){E.instance.Ype(Object(c.a)(L.instance,L.instance.qKi,"makeGetMruRequestActivityTrigger"));E.instance.Ype(Object(c.a)(this,this.Fqe,"addGetMruFromServerTask"));E.instance.SMg(Object(c.a)(this,
this.uoh,"deleteGetMruFromServerTask"))}uoh(){D.a.instance.$o(this.Oyf)}Fqe(){D.a.instance.ig(this.Oyf)}get Oyf(){return this.tje||(this.tje=new C.a(5,2,k.AFrameworkApplication.Nyf,Object(c.a)(L.instance,L.instance.$1h,"getMruFromServerTask"),109))}get c6j(){return this.eob||(this.eob=new C.a(2,2,6E4*k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(L.instance,L.instance.AKi,"makeUpdateMruTask"),197))}dispose(){this.Jm||(this.Jm=
!0,this.eob&&(D.a.instance.$o(this.eob),this.eob=null))}}Object(r.a)(fa,"CorePackageManager",null,[4,5,3]);var wa=a(257);a.d(B,"a",function(){return oa});const oa=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");wa.a.instance.si(new fa)}},1203:function(r,B,a){r=a(0);var c=a(4),b=a(228),e=a(15),f=a(88),d=a(56),h=a(203);class l{constructor(){this.ile=this.kUc=!1;const la=c.AFrameworkApplication.Nj;0>=la||(this.Nj=la,e.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",
{["AccessTokenTtl"]:this.Nj,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Fha}),h.a.instance.fZc(Object(f.a)(this,this.QPa,"onSessionExpiredDetected")),h.a.instance.dZc(Object(f.a)(this,this.OKf,"onSessionExpiringDetected")))}QPa(){h.a.instance.WNd(Object(f.a)(this,this.QPa,"onSessionExpiredDetected"));e.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.kei()}OKf(){h.a.instance.VNd(Object(f.a)(this,this.OKf,"onSessionExpiringDetected"));this.ile||this.kUc||
(e.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.ile=!0,this.nPj())}kei(){this.kUc||(c.AFrameworkApplication.XF(d.a.Myc),this.kUc=!0,this.mPj())}}Object(r.a)(l,"ASessionExpirationManager",null,[]);var k=a(91),w=a(39),n=a(29),x=a(14),m=a(46),u=a(259),t=a(6),y=a(85),v=a(262),A=a(74);class z extends l{constructor(la){super();this.Ra=new w.a;this.kH=this.Ynb=!1;this.$=la}gte(la){this.Ra.addHandler("SessionExpired",la)}rpb(la){this.Ra.addHandler("TokenRefreshed",
la)}Wvc(la){this.Ra.removeHandler("TokenRefreshed",la)}get accessTokenExpiringMessage(){const la=(new Date(this.Nj)).format(this.$.ya.ShortTimeFormat);return String.format(x.a.instance.nb(78),la)}get tokenExpired(){return this.Ynb}get Yeb(){return!1}get fca(){return!1}get XLd(){return!1}get E5(){return!1}Vfc(){return h.a.instance.hR(c.AFrameworkApplication.Nj)}dispose(){k.a.Ja(this.Ra);this.$=null}nPj(){this.$.isEditMode&&this.qfc(!1)}mPj(){this.Ynb=!0;this.qfc(!0);this.Ra.raiseEvent("SessionExpired")}qfc(la){e.ULS.sendTraceTag(537170715,
0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${la}, GotDeploymentOrTimedOutError ${this.$.ea.IZ}`);const ua=this.$.pb.Zo;la&&ua&&ua.isVisible&&1299163859===ua.error.MessageId&&this.$.pb.Zo.lv();const eb=this.hd(la);m.a(this.$).Br(new u.a(t.a.tw,5,()=>{const Eb=A.a(this.$),Wb=Eb.kd.activityState;Wb[y.a.p2]=this.$.mrb(this.$.isEditMode);Wb[y.a.VL]=y.a.A$a;Wb[v.a.Fp]=t.a.accessTokenExpiringWarning;Eb.kd.ir([eb])}))}hd(la){return la?n.a.SKe():this.kkh()}kkh(){const la=
n.a.hd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");la.Description=this.accessTokenExpiringMessage;return la}}Object(r.a)(z,"EwaAccessTokenExpirationManager",l,[454,455,3]);var C=a(7),H=a(178),I=a(82),S=a(654),P=a(28);class D{constructor(la,ua){this.eKb=!1;this.correlationID=la;this.d8c=ua;this.JDc=!1;this.creationTime=P.a.Ya.Zb}}Object(r.a)(D,"RefreshAccessTokenContext",null,[]);var G=a(59),E=a(63),O=a(168),N=a(45),J=a(116),W=a(125),ea=a(1),R=a(22),Y=a(152),U=a(37),da=a(123);class T{}Object(r.a)(T,
"Error",null,[]);class ka{}Object(r.a)(ka,"NamedResult",null,[]);class L extends ka{}Object(r.a)(L,"ErrorInfo",ka,[]);class fa{constructor(la,ua){this.NZb=la;this.EG=ua}get tokens(){return this.NZb}get errors(){return this.EG}}Object(r.a)(fa,"TokenRefreshArgs",null,[452]);class wa{constructor(la,ua){this.documentVisibilityObserver=null;this.Ra=new w.a;this.Gx=null;this.Ofb=this.Vmb=!1;this.Ruc=null;this.lKb=!1;this.Pyd=!0;this.qee=this.Nde=this.kH=this.Ynb=!1;this.LS=null;this.acf=()=>{if(this.$.ea.Yb)this.ycf(!1);
else if(this.Pyd){this.Pyd=!1;const eb=A.a(this.$);e.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${eb.Vh?eb.Vh.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Ehg()}]`)}};this.Wc=(eb,Eb)=>{this.context&&(eb=this.$.ea,Eb.GH&&this.context.eKb&&!this.context.JDc?(this.context.JDc=!0,Eb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Eb.IsUserActive=
eb.He.xr,Eb.RefreshAccessTokenCorrelationID=this.context.correlationID,Eb=G.a.Ec(Eb),e.ULS.sendTraceTag(537170708,0,50,Eb)):!this.Vmb||eb.Yb||this.context.d8c||(Eb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Gx&&(this.Gx.cancel(),Eb.Aborted=!0,Eb.ResetStopRefreshRetriesUntilTokenExpired=!0,this.Ofb=!1),Eb.TimeUntilTokenExpirationInMin=this.Ehg(),Eb.RefreshAccessTokenCorrelationID=this.context.correlationID,Eb=G.a.Ec(Eb),e.ULS.sendTraceTag(572019856,
0,50,Eb)))};this.Bza=()=>{if(this.context&&this.context.eKb&&!this.context.JDc){var eb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};eb.CreatedForExpired=this.context.d8c;eb.RefreshAccessTokenCorrelationID=this.context.correlationID;eb.OpenWorkbookErrors=n.a.qc(this.$.ea.MF);eb.ExecutionContextErrors=n.a.qc(A.a(this.$).kd.errors);eb.accesstokenTTL=c.AFrameworkApplication.Nj;eb=G.a.Ec(eb);e.ULS.sendTraceTag(537170707,0,15,eb)}};this.xcf=()=>{this.Ofb=!1;this.ycf(!0)};this.jGd=
()=>{this.lKb&&(this.$.ea.He.OAa(this.jGd),this.lKb=!1);this.deg()};this.$=la;this.y_d=ua;this.ULd=la.Mb.vg("WebServiceCall","refreshToken");h.a.instance.fZc(this.xcf);h.a.instance.dZc(this.acf);ua=this.$.ea;ua.Oj(this.Wc);ua.T0b(this.Bza);this.eNi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.p$f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.WVf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Jng(la.ea.VNf,c.AFrameworkApplication.Nj);la=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.Nj,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Fha,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.c4d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.e4d});e.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${la}`);this.$.da.hb(291,eb=>{this.documentVisibilityObserver=eb})}gte(la){this.Ra.addHandler("SessionExpired",la)}rpb(la){this.Ra.addHandler("TokenRefreshed",la)}Wvc(la){this.Ra.removeHandler("TokenRefreshed",la)}get tokenExpired(){return this.Ynb}get fca(){return this.Nde}get E5(){return this.qee}get context(){return this.LS}get Yeb(){return this.E5?
!1:this.$.ea.He.xr?1>da.a.g6:6>da.a.h6}get XLd(){return this.Vmb}Vfc(){return h.a.instance.hR(c.AFrameworkApplication.Nj)}dispose(){h.a.instance.WNd(this.xcf);h.a.instance.VNd(this.acf);const la=this.$.ea;la&&(la.pk(this.Wc),la.Yvc(this.Bza));k.a.Ja(this.Ra);this.documentVisibilityObserver=this.$=null}Ehg(){return this.Vfc()?0:(c.AFrameworkApplication.Nj-(new Date).getTime())/6E4}Jng(la,ua){if(0<ua&&!this.Vfc()){const eb=c.AFrameworkApplication.fa.Ad("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.iY),
Eb=(ua-la.getTime())/6E4;e.ULS.shipAssertTag(537170713,0,0<=Eb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${ua}] creationTime [${la.getTime()}] tokenLifetimeInMin [${Eb}]`);Eb<this.eNi?(e.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.p$f}] tokenLifetimeInMin [${Eb}]`),c.AFrameworkApplication.iY=this.p$f):
c.AFrameworkApplication.iY!==eb&&(e.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${eb}] tokenLifetimeInMin [${Eb}]`),c.AFrameworkApplication.iY=eb)}}zeh(la){return!this.context||this.context.eKb||this.context.d8c!==la?(la=new D(H.a.create().toString(),la),this.context&&!this.context.JDc&&e.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${la.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.eKb}] `),
this.LS=la,!0):!1}htj(la){la&&this.kH&&!this.fca&&this.$.ea.He.xr&&!this.E5&&(this.kH=!1)}ycf(la){this.htj(la);if(!(this.Vmb||this.Ofb&&!la||this.kH)&&this.Yeb){this.Vmb=!0;var ua=this.context?this.context.creationTime:null,eb=this.zeh(la);this.Pyd=!0;var Eb=this.$.ea,Wb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Wb.newContextCreated=eb;Wb.IsUserActive=Eb.He.xr;Wb.IsSessionActive=Eb.Yb;Wb.ContainsChangesWorkbookOperations=this.$.userOperationManager.GIa();Wb.isSessionExpired=
la;Wb.stopRefreshRetriesUntilTokenExpired=this.Ofb;Wb.FailedToRefreshExpiredToken=this.kH;Wb.numOfFailuresWhileUserIsActive=da.a.g6;Wb.numOfFailuresWhileUserIsInActive=da.a.h6;Wb.numOfFailuresWhileOffline=da.a.gza;Wb.RefreshAccessTokenCorrelationID=this.context.correlationID;eb&&ua&&(Wb.TimeInMinFromPreviosContextCreation=Math.round(W.b(P.a.Ya,ua)/60));ua=G.a.Ec(Wb);e.ULS.sendTraceTag(40416199,0,50,ua);this.ULd.start();this.Nde=Eb.He.xr;this.Gx=new S.a;this.pEi(la);var Ab=this.y_d.Ejj(!la,this.Gx?
this.Gx.token:null);Ab.continueWith(()=>{this.k8g();const Jb=this.y_d.Adj(Ab);this.ULd.stop();const Gb=this.Vfc();if(!Jb||ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Gb){const Nb=Ab.result.errors;Jb&&Gb&&this.$Lg(Nb);this.Rdi(Nb,la)}else this.Ofb=!1,this.Tdi(Ab.result.tokens,la);this.Vmb=!1},8)}}$Lg(la){const ua=[Object(C.a)(new T,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];la.add(Object(C.a)(new L,{Name:"ExpiredTokenAfterSuccessfulRefresh",
Errors:ua}))}pEi(la){la&&(this.$.ea.He.xr?this.deg():(this.$.ea.He.S9(this.jGd),this.lKb=!0))}deg(){this.Ruc=O.AsyncMethodContext.Cq(()=>{this.Djj()},1E3*this.WVf,N.a.ljj,this.Ruc)}k8g(){this.Ruc&&this.Ruc.cancel();this.lKb&&(this.$.ea.He.OAa(this.jGd),this.lKb=!1);this.Gx=null}Djj(){e.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.WVf}]`);this.Gx.cancel()}Rdi(la,ua){this.Ofb=!0;ua&&(this.kH||(this.Ynb=this.kH=
!0),this.y_d.uCb(la)&&(this.qee=!0));const eb=!ua||this.Yeb&&!da.a.xAc?40380379:39982555;ua=this.sJe(ua);ua.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ua.FailedToRefreshExpiredToken=this.kH;ua.LastErrorIsPermanent=this.E5;if(0<la.count){var Eb=la.ma(0);ua.errorName=Eb.Name;0<Eb.Errors.length&&(ua.ErrorId=Eb.Errors[0].Id,Eb=Eb.Errors[0].Details,ua.ErrorDetails=this.xsh(Eb.toString())?"PiiScrubbed":Eb)}ua=G.a.Ec(ua);e.ULS.sendTraceTag(eb,0,15,ua);this.Ra.raiseEvent("TokenRefreshed",
new fa(null,la))}xsh(la){return R.a.contains(la,"makes the internet safe for businesses",!0)}sJe(la){const ua={},eb=this.$.ea;ua.Name="";ua.IsUserActive=eb.He.xr;ua.IsSessionActive=eb.Yb;ua.GotDeploymentOrTimedOutError=eb.IZ;ua.TimeInSecFromLastStatefulSuccessfulRequest=eb.hX;ua.TimeFromLastUserActivityInMs=eb.He.mgb;ua.calledFromSessionExpiredFlow=la;ua.RefreshTokenDurationInMS=this.ULd.Fc;ua.numOfFailuresWhileUserIsActive=da.a.g6;ua.numOfFailuresWhileUserIsInActive=da.a.h6;ua.numOfFailuresWhileOffline=
da.a.gza;ua.RefreshAccessTokenCorrelationID=this.context.correlationID;ua.accessTokenTTL=c.AFrameworkApplication.Nj;ua.ContainsChangesWorkbookOperations=this.$.userOperationManager.GIa();ua.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.oi.toString():"Unknown";ua.TimeFromFirstOpenInHr=Math.floor(W.b(P.a.Ya,J.toUtc(eb.VNf))/3600);return ua}Tdi(la,ua){this.kH=!1;this.F7j();this.Jng(new Date,c.AFrameworkApplication.Nj);const eb=this.$.ea,Eb=!ua&&eb.He.xr,Wb=!this.$.isEditMode&&
eb.Acb;ua=this.sJe(ua);ua.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ua.shouldTriggerSilentReloadAfterExpiring=Eb;ua.WopiTokenTaskItemPriority=c.AFrameworkApplication.e4d;ua.isDirtyViewSession=Wb;ua=G.a.Ec(ua);e.ULS.sendTraceTag(39982556,0,15,ua);this.Ra.raiseEvent("TokenRefreshed",new fa(la,null));Wb?eb.He.xr&&(e.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
eb.Yed()):eb.He.xr?Eb&&(la=A.a(this.$).kd.activityState,la[da.a.Igb]=!0,la[Y.a.mY]=!0,la[U.a.Rr]=this.$.isEditMode,m.a(this.$).Br(new u.a(t.a.goa,2,null))):eb.Yb&&E.j(this.$.pa.va,!0,!1,!1,null,null,null,null,null)}F7j(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=I.a.xT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.vP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=I.a.xT(this.$.ea.workbookContext.WorkbookUri,
c.AFrameworkApplication.jY,c.AFrameworkApplication.Nj.toString()),this.$.ea.Yrc()):e.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=c.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=c.AFrameworkApplication.Nj;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=
I.a.xT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.vP,c.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=I.a.xT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.jY,c.AFrameworkApplication.Nj.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=I.a.xT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.vP,c.AFrameworkApplication.accessToken),
this.$.ya.EmbedConfiguratorUrl=I.a.xT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.jY,c.AFrameworkApplication.Nj.toString()));this.context.eKb=!0}}Object(r.a)(wa,"EwaAccessTokenExpirationRefreshManager",null,[454,455,3]);var oa=a(197),xa=a(167),bb=a(87),Za=a(424);class La{}La.R_b="ActivityDuration";La.error="Error";La.mbd="Errors";La.failed="Failed";La.KLh="FirstActivity";La.initialized="Initialized";La.CCi="LastActivity";La.M1f="RetryOverride";La.Fsj="RequestGroups";La.requests="Requests";
La.w1f="Responses";La.Nyc="SessionDuration";La.status="Status";La.success="Success";La.successful="Successful";La.tokens="Tokens";Object(r.a)(La,"SessionExpirationStrings",null,[]);var va=a(112);class Ba{constructor(la){this.Ro={};this.zX={};this.$Eg={};this.auf=15;this.Ide=!1;this.HGg=new Date;this.iWb=new Date;this.pe=la;this.AZb=new va.a(2,2,6E4*this.auf,Object(f.a)(this,this.Kqg,"writeMeasures"),135,"SL",!1);this.pe.ig(this.AZb);this.Vli()}Kqg(){e.ULS.sendTraceTag(41964821,217,50,e.ULS.Ec({["Aggregate"]:this.zX,
["Current"]:this.Ro}))}Vli(){this.zX[La.Fsj]=0;this.zX[La.requests]=0;this.zX[La.w1f]=0;this.zX[La.status]=La.initialized;this.zX[La.KLh]=new Date;this.zX[La.Nyc]=0;this.zX[La.R_b]=0;this.zX[La.Nyc]=0;this.Ro[La.Nyc]=0;this.zX[La.R_b]=0;this.Ro[La.R_b]=0}Uod(la,ua){var eb=la[ua];eb=eb?eb:0;eb++;la[ua]=eb;this.mTd(la)}mTd(la){const ua=new Date;la[La.R_b]=+ua-+this.iWb;this.iWb=ua;la[La.Nyc]=+this.iWb-+this.HGg;la[La.CCi]=this.iWb}F0(la,ua){this.Ro[la]=ua;this.mTd(this.Ro)}KSd(la,ua){this.Ro[la]=ua;
this.mTd(this.Ro)}incrementCounter(la){this.Uod(this.Ro,la);this.Uod(this.zX,la);this.Uod(this.$Eg,la)}flush(){this.Ide||(this.zX[La.status]=this.Ro[La.status],this.Kqg(this.AZb),this.pe.Mna(this.AZb,6E4*this.auf))}stop(){e.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.Ide=!0;this.pe.$o(this.AZb)}}Object(r.a)(Ba,"SessionLogger",null,[472]);var Ea=a(102),pa=a(655),$a=a(31),cb=a(381),ib=a(172),ta=a(962),Ya=a(199),Da=a(144);class ba{constructor(la,ua,
eb,Eb=null,Wb=!1,Ab=null,Jb=!1,Gb=!1){this.s9=0;this.h2=this.Vi=null;this.NZb=new oa.a;this.EG=new oa.a;this.Hk=null;this.rXa=!1;this.$nb=this.aob=null;this.pe=la;this.Kie=ua;this.Kie.execute(Nb=>{Nb.Il(ib.a.aod,Object(f.a)(this,this.tZi,"onHostResponseReceived"))});this.MG=eb;this.nne=new ta.a("WebServiceCall","TokenRefresh");this.uk=Eb||new Ba(la);this.CGg=Wb;this.mT=Ab?Ab:pa.SessionStatusManager.instance;this.s$d=Jb;this.DUb=Gb}tZi(la){if(la.MessageId!==ib.a.aod)Da.a(39408099,306,15,"Unexpected message.");
else{var ua=new oa.a,eb=new oa.a;this.uk.incrementCounter(La.w1f);var Eb=la.Values[cb.a.b6f];if(!Eb||0>=Eb.length)Da.a(40122317,306,15,"Found no tokens in the dictionary"),Eb=la.Values;Da.a(40122318,306,100,"The Tokens array contains {0} tokens",Eb.length);this.uk.F0("Correlation",la.CorrelationId);var Wb="";for(let Gb=0;Gb<Eb.length;Gb++){this.uk.KSd(La.tokens,Eb.length);var Ab=Eb[Gb],Jb=Ab;if(!Jb||!Jb.Name)continue;this.uk.incrementCounter(Jb.Name);const Nb=Ab;if(Nb&&Nb.Value)Da.a(39408128,306,
100,"Received token with name: {0}",Nb.Name),ua.add(Nb),this.NZb.add(Nb),this.DUb||this.uk.F0(La.status,La.success),this.s$d&&this.mT&&this.mT.Gtj();else if(Ab=this.H6h(Ab),Da.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Jb.Name,JSON.stringify(Ab),this.h2),eb.add(Ab),this.DUb||(this.EG.add(Ab),Wb=JSON.stringify(Ab),this.uk.F0(La.error,JSON.stringify(Ab)),this.uk.F0(La.status,La.failed)),this.s$d)for(const Ja of Ab.Errors)Jb=this.jYh(Ja),this.mT&&this.mT.qOg(Jb)}this.DUb?
(0<eb.count?this.$nb?this.$nb(new fa(ua,eb)):Da.a(512267295,306,15,"Received errors but the promise has completed"):this.aob?this.aob(new fa(ua,eb)):Da.a(512267294,306,15,"Received valid tokens but the promise has completed"),Da.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ua.count,eb.count,la.CorrelationId,this.h2)):(0<eb.count&&""!==Wb?(Eb=Object.assign(new Ya.a,{extendedProperties:new Map}),Eb.extendedProperties.set("Errors",Wb),Eb.extendedProperties.set("RetryCount",
this.s9.toString()),Eb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Eb.extendedProperties.set("IsTokenExpiring",this.rXa.toString()),Ea.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Eb)):Ea.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Da.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ua.count,eb.count,la.CorrelationId,this.h2),0<eb.count&&!this.uCb(eb)?(la=this.MG.L8e(eb),
la!==this.MG.Ldb&&(this.uk.KSd(La.M1f,la),this.pe.Mna(this.Vi,la))):(this.uk.flush(),this.Vi&&(Da.a(39408131,306,100,"Deleting task {0} from task manager",this.Vi.name),this.pe.$o(this.Vi)),this.Hk&&!this.Hk.task.isCompleted?this.Hk.setResult(new fa(ua,eb)):Da.a(512267293,306,15,"Received results but the task has completed")))}}H6h(la){if(!la)return null;const ua=Object.assign(new L,{Name:la.Name,Errors:[]});for(const eb of la.Errors)la=new T,la.Id=eb.Id,la.Details=$a.a.hkd(eb.Details,500),ua.Errors.push(la);
return ua}requestTokensOnce(){this.D0f()}D0f(){c.AFrameworkApplication.yya("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.s9>=this.MG.wxf?(Da.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.h2),this.xJe(this.Hk,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Ea.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.m5f())}m5f(){const la={};la[cb.a.b6f]=this.MG.tokens;
const ua=H.a.create().toString();Da.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.MG.tokens),this.s9+1,ua,this.h2);this.Kie.execute(eb=>{eb.uj(ib.a.wve,la,ua)});this.s9++;this.uk.incrementCounter(La.requests)}xJe(la,ua,eb){const Eb=new oa.a;for(let Wb=0;Wb<this.MG.tokens.length;Wb++){const Ab=Object.assign(new L,{Name:this.MG.tokens[Wb],Errors:[Object.assign(new T,{Id:ua,Details:eb})]});Eb.add(Ab);this.EG.add(Ab)}this.pe.$o(this.Vi);this.uk.F0(La.mbd,
JSON.stringify(this.EG));this.uk.F0(La.status,La.failed);la&&!la.task.isCompleted&&la.setResult(new fa(new oa.a,this.EG))}Ejj(la,ua=null){this.nne.start();this.rXa=la;this.h2=H.a.create().toString();Da.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.h2,this.rXa);this.s9=0;this.EG.clear();this.NZb.clear();const eb=new xa.a;this.Hk=eb;ua&&ua.R(()=>{const Eb=!!eb&&!eb.task.isCompleted;Da.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",
this.h2,this.rXa,Eb);Eb&&this.xJe(eb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.DUb?this.E0f(this.MG.wxf).then(Eb=>{this.Hk&&!this.Hk.task.isCompleted&&this.Hk.setResult(Eb);this.$nb=this.aob=null;this.uk.F0(La.mbd,JSON.stringify(this.EG));this.uk.F0(La.status,La.success);this.uk.flush()}).catch(Eb=>{this.Hk&&!this.Hk.task.isCompleted&&this.Hk.setResult(Object(bb.a)(452,Eb));this.$nb=this.aob=null;this.uk.F0(La.mbd,JSON.stringify(this.EG));this.uk.F0(La.status,La.failed);
this.uk.flush()}):(this.Vi=new va.a(this.MG.priority,2,this.MG.Ldb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,ib.a.wve,!0),this.CGg&&this.D0f(),this.pe.ig(this.Vi));return this.Hk.task}E0f(la){const ua=this,eb=new Promise((Gb,Nb)=>{ua.aob=Gb;ua.$nb=Nb;Ea.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);ua.m5f()}),Eb=this,Wb=new Promise((Gb,Nb)=>{window.setTimeout(()=>{Nb(Eb.CJe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},
Eb.MG.Ldb)});let Ab=la;const Jb=this;return new Promise((Gb,Nb)=>{Ab--;Promise.race([eb,Wb]).then(Ja=>{Ea.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Gb(Ja)}).catch(Ja=>{var ab=Jb.MG.Ldb;if(Object(Za.a)(452,Ja)&&(Ja=Object(bb.a)(452,Ja),0<Ja.errors.count)){Jb.KGi(Ja.errors);Jb.ir(Ja.errors);if(Jb.uCb(Ja.errors)){Nb(Ja);return}const wb=Jb.MG.L8e(Ja.errors);wb!==Jb.MG.Ldb?(Jb.uk.KSd(La.M1f,wb),ab=wb):Jb.bAi(Ja.errors)&&(ab=0)}Ab?window.setTimeout(()=>{Jb.E0f(Ab).then(Gb).catch(Nb)},ab):
(ab=Jb.CJe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Jb.ir(ab.errors),Nb(ab),Da.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Jb.h2))})})}ir(la){for(let ua of la)this.EG.add(ua)}bAi(la){if(!la.count)return!1;la=la.ma(la.count-1);return la.Errors.length?"TIMEOUT"==la.Errors[0].Id:!1}CJe(la,ua){const eb=new oa.a;for(let Eb=0;Eb<this.MG.tokens.length;Eb++){const Wb=this.sgh(this.MG.tokens[Eb],la,ua);
eb.add(Wb)}return new fa(new oa.a,eb)}sgh(la,ua,eb){return Object.assign(new L,{Name:la,Errors:[Object.assign(new T,{Id:ua,Details:eb})]})}KGi(la){if(la.count){la=la.ma(la.count-1);la=JSON.stringify(la);var ua=Object.assign(new Ya.a,{extendedProperties:new Map});ua.extendedProperties.set("Errors",la);ua.extendedProperties.set("RetryCount",this.s9.toString());ua.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());ua.extendedProperties.set("IsTokenExpiring",this.rXa.toString());
Ea.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ua);this.uk.F0(La.error,la);this.uk.F0(La.status,La.failed)}}Adj(la){this.nne.stop();const ua=this.kfi(la.result.errors);e.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!ua,this.h2,this.rXa,this.s9,this.EG.count,0<la.result.errors.count?la.result.errors.ma(0).Name:
"",0<la.result.errors.count&&0<la.result.errors.ma(0).Errors.length?la.result.errors.ma(0).Errors[0].Id:"",0<la.result.errors.count&&0<la.result.errors.ma(0).Errors.length?la.result.errors.ma(0).Errors[0].Details:"");return ua?!1:this.zdj(la.result.tokens)}uCb(la){return this.MG.uCb(la)}zdj(la){for(let ua=0;ua<la.count;ua++){const eb=la.ma(ua);if(eb.Name===cb.a.accessToken){const Eb=(new Date).getTime();eb.Expiry>c.AFrameworkApplication.Nj?(e.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",
{["AccessTokenTtl"]:eb.Expiry,["NowGetTime"]:Eb,["BootTime"]:c.AFrameworkApplication.Fha},"PreviousAccessTokenTtl",c.AFrameworkApplication.Nj),c.AFrameworkApplication.accessToken=eb.Value,c.AFrameworkApplication.Nj=Math.floor(eb.Expiry),c.AFrameworkApplication.d4d=Eb,c.AFrameworkApplication.iZa=Math.floor(eb.Expiry)):e.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:eb.Expiry,["NowGetTime"]:Eb,["BootTime"]:c.AFrameworkApplication.Fha},
"PreviousAccessTokenTtl",c.AFrameworkApplication.Nj)}}return!0}kfi(la){let ua=!1;for(let eb=0;eb<la.count;eb++){ua=!0;const Eb=la.ma(eb);e.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Eb.Name,JSON.stringify(Eb.Errors),this.h2)}return ua}jYh(la){let ua=d.a.Myc;la=parseInt(la.Id);if(isNaN(la))ua=d.a.Vak;else{switch(la){case 401:ua=d.a.Yak;break;case 403:ua=d.a.Tak;break;case 500:ua=d.a.Uak;break;case 503:ua=d.a.Xak}ua===d.a.Myc&&(ua=500<la?d.a.Wak:d.a.Sak)}return ua}}
Object(r.a)(ba,"TokenRefreshManager",null,[453]);class ya{constructor(){this.Ldb=c.AFrameworkApplication.abk;this.wxf=c.AFrameworkApplication.Zak;this.tokens=c.AFrameworkApplication.Dai();this.priority=c.AFrameworkApplication.e4d;this.Tje=this.UFj();this.CWc=c.AFrameworkApplication.Cai()}uCb(la){la=JSON.stringify(la);if(this.CWc&&0<this.CWc.length)for(const ua of this.CWc)if(0<ua.length&&0<=la.indexOf(ua))return!0;return!1}L8e(la){try{if(la)for(let ua of la)if(ua.Errors)for(const eb of ua.Errors)if(eb.Id in
this.Tje)return Number.parseInvariant(this.Tje[eb.Id].toString())}catch(ua){e.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",ua.toString())}return this.Ldb}UFj(){const la={};try{if(!c.AFrameworkApplication.bfc()||0>=c.AFrameworkApplication.bfc().length||""===c.AFrameworkApplication.bfc()[0])return la;for(const ua of c.AFrameworkApplication.bfc())0<ua.length&&(la[ua]=c.AFrameworkApplication.$ak)}catch(ua){e.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
ua.toString())}return la}}Object(r.a)(ya,"TokenRefreshPolicy",null,[450]);class V extends b.a{constructor(la){super();this.$=la;this.Gb()}create(){c.AFrameworkApplication.pN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.qb(this.xgh()):this.qb(this.$.da.Ba(38)||this.$.da.Ha(38,new z(this.$)))}xgh(){var la=this.$.da.Ba(38);if(la)return la;la=new ba(c.AFrameworkApplication.ti,c.AFrameworkApplication.JQ(),
new ya);return this.$.da.Ha(38,new wa(this.$,la))}static la(la){la.da.Ha(39,new V(la))}}Object(r.a)(V,"AccessTokenExpirationManagerFactory",b.a,[]);var Z=a(9);a.d(B,"a",function(){return ja});const ja=()=>{Z.a.Fa(V.la)}},1237:function(r,B,a){r=a(0);var c=a(88),b=a(156);class e extends b.a{constructor(A){super(!1,!1,!0);this.wSb=A}start(){const A={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.wSb.hod}};this.initializeAndShow("",Object(c.a)(this,this.Iuj,
"resultHandler"),A)}Iuj(A,z){1===A&&(this.wSb.hod=z.tooltipPersistenceEnabled)}}Object(r.a)(e,"AccessibilitySettingsDialog",b.a,[]);var f=a(111),d=a(25);class h{constructor(A,z){this.La=A;this.wSb=z}Hg(){this.La.Qb(d.a.NMj,f.a.frame,Object(c.a)(this,this.OMj,"showAccessibilitySettingsDialogHandler"))}OMj(){(new e(this.wSb)).start();return 32}}Object(r.a)(h,"AccessibilitySettingsDialogActor",null,[392]);var l=a(167),k=a(4);const w=A=>{const z=new l.a;k.AFrameworkApplication.Hd.Mm(n(A),1,null,null,
!0,2,C=>{200===C.data.httpStatus?z.setResult("true"===C.data.me.toLowerCase()):z.setResult(!1)},()=>{z.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return z.task},n=A=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",k.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",A,k.AFrameworkApplication.xi);var x=a(140);class m{constructor(){this.aXa=null}get hod(){return!!this.aXa}set hod(A){A!==this.aXa&&(this.aXa=A,x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A),
this.aof()&&k.AFrameworkApplication.Hd.Mm(n("saveHoverableRibbonTooltipIsEnabled"),2,A.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}WEi(){const A=new l.a;if(this.aXa)A.setResult(this.aXa);else if(this.aof()){const z=w("getHoverableRibbonTooltipIsEnabled");z.continueWith(()=>{this.aXa=z.result;x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(z.result);A.setResult(z.result)},8)}else A.setResult(!1)}aof(){const A=k.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),
z=k.AFrameworkApplication.fa.qa("IsAnonymousUser");return A&&!z}}Object(r.a)(m,"AccessibilitySettingsInfo",null,[391]);var u=a(257),t=a(144);class y{constructor(){this.$a=null}get name(){return"Common.App.AccessibilitySettings"}Kh(A){this.$a=A;this.$a.register(m,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Bc(()=>new m).tc();this.$a.register(h,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Bc(()=>
new h(k.AFrameworkApplication.rb,this.$a.og("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).tc()}init(){const A=this.$a.og("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),z=this.$a.og("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");A&&z?(z.Hg(),A.WEi()):t.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){u.a.instance.si(new y)}}Object(r.a)(y,
"AccessibilitySettingsPackage",null,[4,5]);a.d(B,"a",function(){return v});const v=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");y.main()}},1238:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(15),f=a(91),d=a(27),h=a(424),l=a(481),k=a(527),w=a(173),n=a(230),x=a(24),m=a(71),u=a(44),t=a(182),y=a(217),v=a(49),A=a(45),z=a(12),C=a(77),H=a(136),I=a(1),S=a(11),P=a(21),D=a(350),G=a(243),E=a(13),O=a(166),N=a(99),J=a(5),W=a(258),ea=a(73),R=a(46),Y=a(35);class U extends N.a{constructor(ib,
ta,Ya,Da){super(ib);this.lgg=[6];this.hgg=[26];this.zq=null;this.jCb=this.mlc=!1;this.ps=this.wba=null;this.onPointerDown=ba=>{if(1!==this.$.Ia.uH())return!0;ba=Y.a(this.$).ve(ba);if(this.dB)return!0;var ya=R.a(this.$).usd||R.a(this.$).Tp();if(this.pud||ya)return this.ydb(),!0;this.ps=this.cn;this.KMd();this.Ind();ya=2===ba.wb&&ba.Zn===Sys.UI.MouseButton.leftButton;const V=3===ba.wb;if(ya||V)ba=this.ha.Zp(ba.clientPoint,ba.Ob,5,void 0,void 0,!0),ba||(ba=this.ps),this.jCb=ya,this.mlc=V,this.ps=this.Q$e(ba),
this.Ind(),ya?this.Okj():V&&this.Elj(),W.b(this.$,!0);return!0};this.aj=ba=>{ba=Y.a(this.$).ve(ba);if(!this.dB)return!1;let ya=this.jCb?this.ha.Zp(ba.clientPoint,ba.Ob,5,void 0,void 0,!0):this.ha.Zp(ba.clientPoint,ba.Ob,5,!0,!1,!0);ya||(ya=this.ha.dqb(ba.clientPoint,ba.Ob,5));ya&&(ba=this.Q$e(this.Jpb(ya)),this.k3b(ba.bottomRight),this.ps.equals(ba)||(this.ps=ba,this.zKb(!1),this.KMd(!1),this.Ind(!1),this.ghi(),this.Eb.update(!1)),this.G4j(this.ps));return!0};this.fh=ba=>{Y.a(this.$).ve(ba);if(!this.dB)return!1;
this.resizeTable();this.ydb();return!0};this.UHb=ba=>{Y.a(this.$).ve(ba);if(!this.dB)return e.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.ydb();return!0};this.ada=ba=>{Y.a(this.$).ve(ba);this.ydb();return!0};this.KCf=()=>{this.dB&&this.ydb()};this.gridView=ta;this.$=ta.$;this.tableManager=Da;this.ha=ta.ha;this.Eb=ta.Eb;this.parentElement=ib;this.U1g();d.a.lp||d.a.Wba||G.a.instance.ta(E.a.pointerDown,
this.wba,this.onPointerDown);this.cn=Ya;this.fPc=this.pud=!1;this.tableManager.aPg(this.KCf)}get dB(){return this.jCb||this.mlc}get Zof(){return this.fPc}dispose(){this.ydb();this.tableManager.Mnj(this.KCf);this.Zof||d.a.lp||d.a.Wba||G.a.instance.Aa(E.a.pointerDown,this.wba,this.onPointerDown);if(this.dB){W.b(this.$,!1);try{this.Rv()}catch(ib){e.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ib}`)}}this.parentElement&&this.parentElement.contains(this.wba)&&
this.parentElement.removeChild(this.wba);this.wba=this.parentElement=null;super.dispose()}Q$e(ib){const ta=ib.bottom-this.cn.topLeft.bottom-1;return 0<=ib.right-this.cn.topLeft.right+1&&0<=ta&&ib.bottom>=this.cn.top&&ib.right>=this.cn.left?new x.Range(this.cn.top,this.cn.left,ib.bottom,ib.right,!1,!1):this.ps}Ind(ib=!0){this.qzc([this.ps],6,ib);this.Eb.$q(this.lgg)}zKb(ib=!0){this.Eb.Tj(this.lgg);this.qzc([null],6,ib)}KMd(ib=!0){this.Eb.Tj(this.hgg);this.qzc([null],26,ib)}ghi(){const ib=this.PVj();
0<ib.length&&(this.qzc(ib,26,!1),this.Eb.$q(this.hgg))}PVj(){const ib=[];this.cn.contains(this.ps)&&(this.cn.right!==this.ps.right&&ib.push(new x.Range(this.cn.top,this.ps.right+1,this.ps.bottom,this.cn.right,!1,!1)),this.cn.bottom!==this.ps.bottom&&ib.push(new x.Range(this.ps.bottom+1,this.cn.left,this.cn.bottom,this.cn.right,!1,!1)));return ib}resizeTable(){if(!this.ps.equals(this.cn)){const ib=new x.Range(this.cn.top,this.cn.left,this.ps.bottom,this.ps.right,!1,!1);this.O_j(ib);this.pud=!0}}onKeyDown(ib){Y.a(this.$).ve(ib);
return!0}gab(){this.Zof&&(d.a.lp||d.a.Wba||(G.a.instance.ta(E.a.pointerDown,this.wba,this.onPointerDown),this.wba.classList.remove("ewr-table-resize-default-cursor"),this.fPc=this.wba.disabled=!1),this.fPc=!1)}U1g(){const ib=document.createElement("div");ib.className="ewr-table-resize-handle";const ta=document.createElement("div");ta.className="ewr-table-resize-fillhandle-higher";const Ya=document.createElement("div");Ya.className="ewr-table-resize-fillhandle-broader";ib.appendChild(ta);ib.appendChild(Ya);
this.wba=ib;this.parentElement.appendChild(this.wba)}k3b(ib){let ta=60;const Ya=this.ps.contains(ib);let Da=ib.top,ba=ib.bottom,ya=ib.left,V=ib.right,Z=null;if(Ya){if(this.gridView.gN(this.cn.topLeft)&&!this.cn.RBa)return;ib.bottom<this.ps.bottom?(Da=Math.max(1,ba-2,this.cn.top),ta=16):(ya=Math.max(1,V-2,this.cn.left),ta=4);ba=Da;V=ya;Z=new x.Range(Da,ya,Da,ya,!1,!1)}else ib.right>=this.cn.right?(V+=2,ta=8):ib.bottom>=this.cn.bottom&&(ba+=2,ta=32),Da=ba,ya=V,Z=new x.Range(ba,V,ba,V,!1,!1),ta=16;this.gridView.gN(Z)||
(this.zq?this.zq.Wn||(this.zq=v.a.instance.create(()=>{this.gridView.yv(Z,ta,"TableResizeBehavior.BringRangeIntoView")},40,A.a.jgg)):this.zq=v.a.instance.create(()=>{this.gridView.yv(Z,ta,"TableResizeBehavior.BringRangeIntoView")},40,A.a.jgg))}Jpb(ib){let ta=ib;if(this.gridView.jb.w4){if(!this.gridView.Jb(ib.topLeft)){const Ya=this.gridView.Qj("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.xQ,this.ps.top!==ib.top?1:2);try{Ya.Lk=this.ps.top<ib.top||this.ps.left<ib.left,Ya.Iv(ib.topLeft),
ta=Ya.$$cu().range}finally{Ya&&Ya.dispose()}}ta.right=ta.left+ib.width-1;ta.bottom=ta.top+ib.height-1}return ta}qzc(ib,ta,Ya=!0){const Da=[];for(const ba of ib)Da.push(new D.a(ba,m.d(this.$.na)));this.Eb.CB(Da,[ta],!0,void 0,Ya)}Okj(){G.a.instance.ta(E.a.mk,document.documentElement,this.aj);for(const ib of this.gridView.Cn)G.a.instance.ta(E.a.mk,ib.domElement,this.aj);G.a.instance.ta(E.a.Of,document.documentElement,this.fh);this.lOe()}Elj(){O.a.instance.ta(E.a.mg,document.documentElement,this.aj);
for(const ib of this.gridView.Cn)O.a.instance.ta(E.a.mg,ib.domElement,this.aj);O.a.instance.ta(E.a.Ae,document.documentElement,this.UHb);this.lOe()}Rv(){this.jCb&&this.P2j();this.mlc&&this.b3j()}P2j(){G.a.instance.Aa(E.a.mk,document.documentElement,this.aj);for(const ib of this.gridView.Cn)G.a.instance.Aa(E.a.mk,ib.domElement,this.aj);G.a.instance.Aa(E.a.Of,document.documentElement,this.fh);this.UVf()}b3j(){O.a.instance.Aa(E.a.mg,document.documentElement,this.aj);for(const ib of this.gridView.Cn)O.a.instance.Aa(E.a.mg,
ib.domElement,this.aj);O.a.instance.Aa(E.a.Ae,document.documentElement,this.UHb);this.UVf()}lOe(){this.gridView.oc.f$b(!0)}UVf(){this.gridView.oc.f$b(!1)}O_j(ib){this.$.Yc(-1400250766,ea.a.zb,30,{["ResizeTableRange"]:ib,["OriginalTableRange"]:this.cn})}G4j(ib){if(!this.cn.contains(ib)){ib=this.OVj();for(const ta of ib)if(this.tableManager.Oud(ta)){this.gridView.Ng.Ap(J.a.YPi);return}}this.gridView.rtl?this.gridView.Ng.Ap(J.a.gPi):this.gridView.Ng.Ap(J.a.pRi)}ydb(){if(this.dB){W.b(this.$,!1);try{this.Rv()}catch(ib){e.ULS.sendTraceTag(537151232,
0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ib}`)}}this.zq&&(this.zq.cancel(),this.zq.dispose());this.mlc=this.jCb=!1;this.zKb();this.KMd();W.b(this.$,!1);this.gridView.Ng.Ap(J.a.gV)}OVj(){const ib=[];this.cn.right!==this.ps.right&&ib.push(new x.Range(this.cn.top,this.cn.right+1,this.ps.bottom,this.ps.right,!1,!1));this.cn.bottom!==this.ps.bottom&&ib.push(new x.Range(this.cn.bottom+1,this.cn.left,this.ps.bottom,this.cn.right,!1,!1));return ib}static createInstance(ib,
ta,Ya,Da){if(!ta)return null;const ba=ib.Eb;ba.CB(Ya,[27],!0);ba.$q(U.GVj);Ya=ba.WC(27,ib.jb.Li(ta.bottomRight),U.AXh(ta,Ya)).kg;return new U(Ya,ib,ta,Da)}static AXh(ib,ta){var Ya;for(let Da=0;Da<ta.length;Da++)if((null===(Ya=ta[Da])||void 0===Ya?0:Ya.range)&&ta[Da].range.equals(ib))return Da;return 0}}U.GVj=[27];Object(r.a)(U,"TableResizeBehavior",N.a,[]);var da=a(7);N=a(242);class T{}T.TCh="ewa-ttrd-buttonarea";Object(r.a)(T,"CssClassNames",null,[]);var ka=a(51),L=a(132),fa=a(96),wa=a(22),oa=a(14),
xa=a(263),bb=a(133),Za=a(273),La=a(153),va=a(54);class Ba extends N.a{constructor(ib){super(document.createElement("div"));this.gXc=this.Ard=this.oOf=this.LQ=!1;this.JMb=null;this.Gg=()=>{y.c(this.$,this.gridView.ha.ra.activeCell)?(this.MMa=!0,this.qtb(!1)):(this.$Z=this.MMa=!1,this.plg())};this.Ht=()=>{this.MMa?this.qtb(!0):this.$Z=!1};this.OCf=()=>{this.gXc=!0;this.MMa&&(this.$Z=!1)};this.onContentReady=()=>{this.$.isEditMode?y.c(this.$,this.gridView.ha.ra.activeCell)&&(this.MMa=!0,this.qtb(!1)):
this.$Z=!1};this.mza=()=>{this.gXc=!1;this.MMa?this.qtb(!1):this.$Z=!1};this.rf=(ta,Ya)=>{this.MMa&&(ta=this.gridView.fbb(Ya.dd.block.he.BlockCachePosition.PaneType).NB(Ya.dd.hash))&&(ta.aOd(this.Gdf),ta.nZc(this.Gdf))};this.Gdf=()=>{this.c_f()};this.$=ib;this.gridView=P.h(this.$);this.parentElement=this.domElement;this.parentElement.className=T.TCh;this.RLa=this.gridView.zj;this.oed=I.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.MMa=!0;this.Dli();this.oed&&
this.vji();this.nXg();this.qtb(!1);e.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get $Z(){return this.Ard}set $Z(ib){this.Ard!==ib&&(this.Ard=this.isVisible=ib)}get fDb(){return!!(this.$.Bd&16)}get Xui(){const ib=this.gridView.ha.ra.activeCell;return ib.right===ib.maxColumns}get Aob(){const ib=this.gridView.Jb(null);return ib&&this.gridView.Yba(ib.range)?this.ewa(ib):(ib&&e.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),
null)}dispose(){this.$&&this.jph();this.$=this.gridView=this.parentElement=this.RLa=null;super.dispose()}sVh(ib){const ta=this.H9h(this.gridView.Jb(null).range);return ta?this.oed?`=${this.e$e()}(${ib}${this.$.listSeparator}${ta})`:`=SUBTOTAL(${ib},${ta})`:null}e$e(){var ib,ta,Ya;return null!==(Ya=null===(ta=null===(ib=this.calcManager)||void 0===ib?void 0:ib.localeInfo)||void 0===ta?void 0:ta.getWorksheetFuncName(344))&&void 0!==Ya?Ya:"SUBTOTAL"}H9h(ib){var ta=P.h(this.$).tb.uh(ib);if(!ta)return null;
ta=t.a(ta,!1);ta.right=ta.left=ib.left;return ta.toString()}Dli(){Ba.tJ={};Ba.tJ["100"]=oa.a.instance.ga(1105);Ba.tJ["101"]=oa.a.instance.ga(1108);Ba.tJ["102"]=oa.a.instance.ga(1107);Ba.tJ["103"]=oa.a.instance.ga(1112);Ba.tJ["104"]=oa.a.instance.ga(1109);Ba.tJ["105"]=oa.a.instance.ga(1110);Ba.tJ["109"]=oa.a.instance.ga(1106);Ba.tJ["107"]=oa.a.instance.ga(1113);Ba.tJ["110"]=oa.a.instance.ga(1115);Ba.tJ["111"]=oa.a.instance.ga(1166)}vji(){(I.EwaSettings.OH()?ib=>La.a.resolve(va.f).then(ta=>setTimeout(()=>
ib(ta),0)):ib=>this.$.da.hb(266,ib))(ib=>{this.calcManager=ib})}l8i(){var ib=this.gridView.Jb(null);if(ib&&(ib=ib.WA?ib.formulaBarText:null))if(this.oed){const ta="="+this.e$e()+"(",Ya=ta.length;if(ib.toUpperCase().startsWith(ta)){if(ib=ib.substring(Ya,Ya+3),ib in Ba.tJ)return ib}else return"111"}else if("=SUBTOTAL("===ib.substring(0,10)){if(ib=ib.substring(10,13),ib in Ba.tJ)return ib}else return"111";return"100"}nXg(){this.gridView.Ca.Us(this.rf);this.gridView.ha.vA(this.Gg);this.gridView.ev(this.onContentReady);
this.gridView.oc.gl(this.OCf);this.gridView.oc.rm(this.mza)}jph(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.TF(this.Gg),this.gridView.Ca.Dr(this.rf)),this.gridView.ty(this.onContentReady),this.gridView.oc&&(this.gridView.oc.Zk(this.OCf),this.gridView.oc.dm(this.mza)),this.plg())}qtb(ib){this.R4j(ib);this.fDb&&(this.mUj(),this.Aob?(this.oOf||this.yXg(),this.gXc?this.$Z=!1:(this.$Z=!0,this.c_f())):(e.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.$Z=!1))}c_f(){appChrome.renderTableTotalRowOptions(this.parentElement,Ba.tJ,Ba.tJ[this.l8i()].toString(),Math.round(Y.a(this.$).Jh(17)),ib=>{e.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${ib}`);let ta={["SelectedOption"]:Ba.tJ[ib],["FunctionKeyCode"]:ib,["Location"]:"canvas"};bb.b(this.$).qd(L.a.TVj,ta,null,!0);if("111"===ib)return this.Woi(),!0;if("100"!==ib){this.JMb=this.sVh(ib);if(!this.JMb)return e.ULS.sendTraceTag(537151197,0,50,
"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.ySa(this.JMb)}else this.ySa("");z.DOMElementExtensions.setFocus(this.gridView.Xb.textBox.domElement);return!0})}Woi(){e.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const ib=new fa.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ia.Hb(ib)}ewa(ib){if(!ib)return null;var ta=this.gridView.oc.textBox.domElement;var Ya=0<z.DOMElementExtensions.getHeight(ta)&&
0<z.DOMElementExtensions.getWidth(ta)&&0<=ta.offsetTop&&0<=ta.offsetLeft;if(Ya)ta=z.DOMElementExtensions.ewa(ta,this.gridView.zj);else{ta=this.gridView.getCellBounds(ib.cell);var Da=z.DOMElementExtensions.getBoundingClientRect(this.gridView.zj);ta=new Sys.UI.Bounds(ta.x-Da.x,ta.y-Da.y,ta.width,ta.height)}if(ta)if(Ya)2<ta.height&&2<ta.height&&(ta.x+=1,ta.y+=1,ta.height-=2,ta.width-=2);else if(Ya=P.h(this.$).$J(ib.cell))Ya=Ya.width,Da=wa.a.equals(xa.a.Dxb(ib.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&
Da&&(ta.x=ta.x+ta.width-Ya),ib.bca&&this.gridView.rtl===Da&&(ta.width=Ya);else return null;return ta}R4j(ib){var ta=this.Aob;if(ta){var Ya=17>=ta.height?ta.y:ta.y+ta.height-17-2;ta=this.Xui?this.gridView.rtl?ta.x:ta.x+ta.width-(17<ta.height?17:ta.height):this.gridView.rtl?ta.x-(17<ta.height?17:ta.height):ta.x+ta.width;var Da=Y.a(this.$).ska(new Sys.UI.Point(ta,Ya));this.parentElement.style.top=S.HelperMethods.zc(Da.y);this.parentElement.style.left=S.HelperMethods.zc(Da.x);Y.a(this.$).kFj(this.parentElement);
ib&&(this.$Z=this.gridView.xlc(new ka.a(ta,Ya)))}else this.$Z=!1}yXg(){this.RLa.insertBefore(this.parentElement,this.RLa.firstChild);this.oOf=!0}mUj(){this.LQ||(this.gridView.view.Vs(this.Ht),this.LQ=!0)}plg(){this.LQ&&this.gridView.view&&(this.gridView.view.Xq(this.Ht),this.LQ=!1)}ySa(ib){const ta=this.gridView.Xb,Ya=this.gridView.Jb(null);Ya&&(ib=Object(da.a)(new Za.a,{Text:ib}),this.gridView.setCell(ib,Ya.range,0,127,null),ta.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}Ba.SVj="TableTotalRowDropDownIconButtonId";
Ba.tJ=null;Object(r.a)(Ba,"TableTotalRowOptions",N.a,[3]);class Ea extends l.a{constructor(ib){super(P.h(ib));this.Hrb=this.S0=this.RCc=this.Frb=null;this.pve=!1;this.dee=null;this.WTb=0;this.S7b=null;this.z2b=()=>{const ta={},Ya=this.Ujd();for(let ba in Ya){const ya=Ya[ba];if(!ya)continue;const V=this.K8h(ya);if(V){if(V in this.DGa){var Da=this.DGa[V];if(Da.dB){Da.cn.equals(ya)||(Da.cn=ya);delete this.DGa[V];ta[V]=Da;continue}}(Da=U.createInstance(P.h(this.$),ya,this.lSh(),this))?ta[V]=Da:e.ULS.sendTraceTag(537151239,
0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${ya.ZC(!1)}`)}}this.P4b(null,null);this.ASb=ta};this.P4b=()=>{const ta=this.DGa;for(let ba in ta){var Ya=ba,Da=ta[ba];Da&&(Da.dispose(),delete this.DGa[Ya])}this.ASb={}};this.dUf=()=>{this.P4b(null,null);this.z2b(null,null)};this.onFocus=()=>{this.dee=P.h(this.$).ha.ra.activeCell};this.l6=()=>{this.$.isEditMode&&this.Gg(null,null)};this.Gg=()=>{!this.pve&&y.c(this.$,this.gridView.ha.ra.activeCell)&&this.gFi()};this.VV=
()=>{this.HAb(1);this.$.ea.Zm(this.VV)};this.aJb=()=>{this.pve=!0;this.RCc=new Ba(this.$)};this.$=ib;this.gridView=P.h(this.$);this.$.da.Ha(66,this);this.ASb={};this.z2b(null,null);this.$.ua&&this.$.ua.Yf(this.dUf);this.YYc(this.z2b);this.$.ea.x2(this.l6);this.gridView.ha.vA(this.Gg);this.$.isEditMode&&this.Gg(null,null)}YYc(ib){this.addHandler(l.a.mcb,ib)}PNd(ib){this.removeHandler(l.a.mcb,ib)}aPg(ib){this.addHandler("tce",ib)}Mnj(ib){this.removeHandler("tce",ib)}get DGa(){return this.ASb}get gwd(){return this.dee}get lJa(){return this.WTb}get Xi(){const ib=
P.h(this.$);return ib.tb.uh(ib.ha.ra.activeCell,!1)}get qJd(){return this.gwd?P.h(this.$).tb.uh(this.gwd,!1):null}Oud(ib){return!!this.J7e(ib)}Qp(ib){return this.c5h(this.q8e(ib))}kxb(ib){return this.q8e(ib)}Blj(ib){ib?(this.Hrb?this.Hrb!==ib&&(f.a.Ja(this.S0),this.S0=null,this.Hrb=ib):this.Hrb=ib,this.S0||(this.S0=H.a.instance.qe(this.Hrb)),this.S0.Mi("focusin")||this.S0.la("focusin",this.onFocus)):e.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}jlf(ib,
ta){return ib?ib.Kka&&ib.top===ta.top:(e.ULS.shipAssertTag(537151244,0,!!ib,"autofilterRange can't be null"),!1)}qka(ib){ib=this.Frb?u.J(ib,this.Frb):this.view.getRangeInformation(ib);return 0<ib.length&&Object(h.a)(n.PivotTableRange,ib[0])?ib[0]:null}rri(ib,ta){return ib?!ib.Uic&&!!ib.ME&&ib.ME.vd(ta):(e.ULS.shipAssertTag(537151243,0,!!ib,"Pivot table can't be null"),!1)}Uxi(ib,ta){return ib?!ib.Uic&&!!ib.zB&&ib.zB.vd(ta):(e.ULS.shipAssertTag(537151242,0,!!ib,"Pivot table can't be null"),!1)}t0b(ib){super.t0b(ib);
if((ib=S.HelperMethods.U7e(ib))&&0<ib.length){this.Frb=Array(ib.length);for(let ta=0;ta<ib.length;ta++)this.Frb[ta]=w.a.wQ(ib[ta])}}sKb(){super.sKb();this.Frb=null}Udh(ib,ta){return this.DIe(ib,ta).returnValue}DIe(ib,ta){var Ya=!1;if(!ib||!ta)return{returnValue:!1,zY:Ya};ib=ib.clone();ib.right+=1;ib.left=ib.right;return!ib.wz||ib.top<ta.jb.Yi&&(Ya=ib.clone(),Ya.bottom>=ta.jb.Yi&&(Ya.bottom=ta.jb.Yi-1),!({zY:Ya}=this.CIe(Ya,ta)).returnValue)||ib.bottom>=ta.jb.Yi&&(Ya=ib.clone(),Ya.top<=ta.jb.Yi&&(Ya.top=
ta.jb.Yi),!({zY:Ya}=this.CIe(Ya,ta)).returnValue)?{returnValue:!1,zY:Ya}:{returnValue:!0,zY:Ya}}kgg(ib){(ib=this.Qp(ib.topLeft))&&ib.toString()in this.DGa&&(this.DGa[ib.toString()].pud=!1)}ifj(){this.raiseEvent("tce")}Wh(ib,ta){if(!this.RCc)return!1;switch(ta){case -569786022:case 541421805:if(this.RCc.$Z){const Ya=document.getElementById(Ba.SVj);Ya&&v.a.instance.create(()=>{z.DOMElementExtensions.Qhc(Ya,null)},0,A.a.KVj,!0,!0)}return!0;default:return!1}}dispose(){this.P4b(null,null);this.PNd(this.z2b);
this.$.ua.yg(this.dUf);this.$.$k(this.P4b);this.ASb=null;this.$.ea&&this.$.ea.Z6(this.l6);this.gridView.ha.TF(this.Gg);this.RCc=null;this.S0&&(f.a.Ja(this.S0),this.S0=null);super.dispose()}Fei(ib,ta,Ya,Da){const ba=this.gridView.tb.uh(new x.Range(ta,Ya,ta,Ya,!1,!1));if(this.S7b=ba){var ya=ba.usedRange,V=ib.ctrlKey||d.a.isMac&&C.b(ib),Z=!ib.shiftKey&&V;ib=ib.shiftKey&&!V;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(P.h(this.$).ha.selectionType=3);switch(Da){case 0:this.WTb=
0;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ta=this.$7c(ib,ya.top,Ya,ya.bottom,Ya),this.PTd(ta,Z,ib)):this.QTd(ya.top,Ya,ya.bottom,Ya,t.d(ba),t.g(ba),Z);break;case 1:this.WTb=1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ta=this.$7c(ib,ta,ya.left,ta,ya.right),this.PTd(ta,Z,ib)):this.QTd(ta,ya.left,ta,ya.right,!1,!1,Z);break;case 2:this.WTb=2;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(ta=this.$7c(ib,ya.top,ya.left,ya.bottom,ya.right),this.PTd(ta,Z,ib)):this.QTd(ya.top,ya.left,ya.bottom,ya.right,t.d(ba),t.g(ba),Z);break;default:e.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${Da.toString()}`);return}I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(P.h(this.$).ha.selectionType=3);e.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else e.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}VJj(ib){const ta=this.S7b.usedRange;return this.ynf(ib)||1!==this.lJa&&this.ynf(new x.Range(ta.top,ib.left,ta.bottom,ib.right,!1,!1))?!0:!1}JKd(ib){return ib.Autofilters}CIe(ib,ta){let Ya;Ya=!1;const Da=ta.jb.Li(ib),ba=ta.Vf(Da).pi;if(!ba)return e.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${Da}`),{returnValue:!1,zY:Ya};if(!ba.xe(ib))return{returnValue:!0,
zY:Ya};ib=ta.Qj("TableManager.CouldExpandImpl",ib,2);try{for(;ib.$$mn();){if(ib.$$cu().text||ib.Qm.idf)return Ya=!0,{returnValue:!1,zY:Ya};if(ib.$$cu().NH)return{returnValue:!1,zY:Ya}}}finally{ib&&ib.dispose()}return{returnValue:!0,zY:Ya}}c5h(ib){if(!ib)return null;const ta=new k.AutofilterRange(ib.top,ib.left,ib.bottom,ib.right,null,null,null,ib.id,ib.Kka);ta.RBa=ib.RBa;const Ya=this.gridView.tb.uh(ib,!0);if(!Ya)return null;for(let Da=0,ba=this.rangeList.length;Da<ba;Da++){const ya=this.rangeList[Da],
V=this.gridView.tb.uh(ya,!0);V&&V.name===Ya.name&&ya!==ib&&this.Wwi(ya)&&(ta.union(ya),ya.RBa&&(ta.RBa=!0))}return ta}Wwi(ib){return!!P.h(this.$).tb.uh(ib)}lSh(){const ib=[];for(const ta of this.rangeList){const Ya=new D.a(this.Qp(ta.topLeft),m.d(this.$.na));ib.push(Ya)}return ib}Ujd(){const ib={};for(const ta of this.rangeList){if(!ta)continue;const Ya=this.Qp(ta.topLeft);Ya&&(ib[Ya.toString()]=this.Qp(ta.topLeft))}return ib}gFi(){this.$.ea.Kf?this.HAb(0):this.$.ea.Zj(this.VV)}HAb(ib){this.$.jz(ta=>
{ta.eba(ib).then(this.aJb)})}K8h(ib){const ta=this.gridView.tb.uh(ib);return ta?ta.name:ib.toString()}QTd(ib,ta,Ya,Da,ba,ya,V){const Z=ib+(ba?1:0),ja=Ya-(ya?1:0),la=this.gridView.inRangePicker||this.gridView.ei;let ua=!1;const eb=new x.Range(Z,ta,ja,Da,!1,!1);if(ba||ya){ba=la?D.a.Itb(this.gridView.ha.rangePicker.RK):this.gridView.ha.ra.selectedRanges;for(const Eb of ba){ua=this.Psb(Eb,Z,ta,ja,Da);ba=this.Psb(Eb,ib,ta,Ya,Da);if(la&&ua)break;if(!la&&(ua||ba)){this.gridView.ha.updateSelection(Eb,Eb.topLeft,
0,1);if(V&&ba)return;break}}}ua&&(eb.top=ib,eb.bottom=Ya);ib=eb.topLeft;V?this.gridView.ha.updateSelection(eb,ib,0,1):la?this.gridView.ha.JD([eb],0,ib,0):this.gridView.ha.updateSelection(eb,ib,0,3)}PTd(ib,ta,Ya){ib&&(Ya=Ya?P.h(this.$).ha.ra.activeCell:ib.topLeft,ta?this.gridView.ha.updateSelection(ib,Ya,0,1):this.gridView.ha.JD([ib],0,Ya,0))}$7c(ib,ta,Ya,Da,ba){const ya=t.d(this.S7b),V=t.g(this.S7b),Z=ta+(1!==this.lJa&&ya?1:0),ja=Da-(1!==this.lJa&&V?1:0),la=this.gridView.inRangePicker||this.gridView.ei;
if(ib){var ua=I.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&la&&!D.a.Itb(this.gridView.ha.rangePicker.RK).length?new x.Range(Z,Ya,ja,ba,!1,!1):la?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.ra.activeCell;ua=new x.Range(ua.top<Z?ua.top:Z,ua.left<Ya?ua.left:Ya,ua.bottom>ja?ua.bottom:ja,ua.right>ba?ua.right:ba,!1,!1)}else ua=new x.Range(Z,Ya,ja,ba,!1,!1);if(1!==this.lJa&&(ya||V)&&(!ib||ib&&this.Psb(ua,Z,Ya,ja,ba))){ib=la?D.a.Itb(this.gridView.ha.rangePicker.RK):
this.gridView.ha.ra.selectedRanges;for(const eb of ib)if(this.Psb(eb,Z,Ya,ja,ba)){ua.top=ta;ua.bottom=Da;break}}return ua}ynf(ib){const ta=this.gridView.inRangePicker||this.gridView.ei?D.a.Itb(this.gridView.ha.rangePicker.RK):this.gridView.ha.ra.selectedRanges;for(const Ya of ta)if(this.Psb(Ya,ib.top,ib.left,ib.bottom,ib.right))return!0;return!1}Psb(ib,ta,Ya,Da,ba){return!!ib&&ib.top===ta&&ib.bottom===Da&&ib.left===Ya&&ib.right===ba}}Object(r.a)(Ea,"TableManager",l.a,[379,3]);class pa extends b.a{constructor(ib){super();
this.tableManager=null;this.$=ib;this.Gb()}create(){this.qb(this.tableManager||(this.tableManager=new Ea(this.$)))}}Object(r.a)(pa,"TableManagerFactory",b.a,[]);var $a=a(1254);a.d(B,"a",function(){return cb});const cb=()=>{c.a.Fa(ib=>{ib.da.Ha(134,new pa(ib));ib.da.Ha(330,new $a.a(ib))})}},1254:function(r,B,a){r=a(0);var c=a(228),b=a(50),e=a(38),f=a(7),d=a(15),h=a(115),l=a(847),k=a(1498),w=a(744),n=a(1345),x=a(39),m=a(5),u=a(171),t=a(73),y=a(63),v=a(182),A=a(49),z=a(45),C=a(116);a(28);var H=a(201),
I=a(29),S=a(255),P=a(1),D=a(22),G=a(14);a(31);class E{}Object(r.a)(E,"TableStyleElement",null,[]);var O=a(767),N=a(215),J=a(95),W=a(533);class ea{static gvf(ka,L){return ea.ngg[ka.Type]-ea.ngg[L.Type]}static m5a(ka,L){try{return appChrome.buildTableStyleGalleryIconNew(ea.dCa,ea.Xoa,ka,L)}catch(fa){return null}}static apf(ka){return ka&&t.a.Pc in ka&&(ka=ka[t.a.Pc])?D.a.fG(ka,m.a.mJb):!1}static Rta(ka){const L=[];let fa=0;for(const wa of ka){L[fa]={};L[fa].backgroundColor="white";L[fa].color="black";
for(let oa in wa)switch(ka=wa[oa],oa){case "background-color":L[fa].backgroundColor=ka;break;case "color":L[fa].color=ka;break;case "font-size":L[fa].fontSize=ka;break;case "border-bottom":L[fa].borderBottom=ka;break;case "border-right":L[fa].borderRight=ka;break;case "border-left":L[fa].borderLeft=ka;break;case "border-top":L[fa].borderTop=ka}fa++}return L}static s6b(ka,L){const fa=[];if(null===ka||void 0===ka?0:ka.TableStyleElementsList){var wa=0===ka.Category;for(let oa=0;oa<ea.Xoa;oa++)fa.push(...ea.pWh(ka,
L,wa,oa))}else{if(ea.w9c)return ea.w9c;ka={color:"black","background-color":"white"};for(L=0;L<ea.Xoa;L++)for(wa=0;wa<ea.dCa;wa++)fa.push(ka);ea.w9c=fa}return fa}static L8h(ka,L){if(!ka.TableStyleElementsList)return"";let fa="";for(const wa of ka.TableStyleElementsList)if(wa.BackgroundColor&&"#000000"!==wa.BackgroundColor)switch(wa.Type){case 0:fa=wa.BackgroundColor;break;case 5:case 7:if(L.gia||L.YR)fa=wa.BackgroundColor;break;case 3:case 4:if(L.firstCol||L.lastCol)fa=wa.BackgroundColor;break;case 2:L.totalRow&&
(fa=wa.BackgroundColor);break;case 1:L.headerRow&&(fa=wa.BackgroundColor)}return fa}static s5b(ka){ka=new N.a(parseInt(String("0x"+ka.substr(1,2)),16),parseInt(String("0x"+ka.substr(3,2)),16),parseInt(String("0x"+ka.substr(5,2)),16));return O.a.xLa(ka)}static k$e(ka,L){if(!ka||!L)return"";L=(L=ea.L8h(ka,L))?ea.s5b(L)+", ":G.a.instance.ga(2070)+", ";switch(ka.Index){case 0:return L+G.a.instance.ga(2004);case 1:return L+G.a.instance.ga(2005);case 2:return L+G.a.instance.ga(2006);case 3:return L+G.a.instance.ga(2007);
case 4:return L+G.a.instance.ga(2008);case 5:return L+G.a.instance.ga(2009);case 6:return L+G.a.instance.ga(2010);case 7:return L+G.a.instance.ga(2011);case 8:return L+G.a.instance.ga(2012);case 9:return L+G.a.instance.ga(2013);case 10:return L+G.a.instance.ga(2014);case 11:return L+G.a.instance.ga(2015);case 12:return L+G.a.instance.ga(2016);case 13:return L+G.a.instance.ga(2017);case 14:return L+G.a.instance.ga(2018);case 15:return L+G.a.instance.ga(2019);case 16:return L+G.a.instance.ga(2020);
case 17:return L+G.a.instance.ga(2021);case 18:return L+G.a.instance.ga(2022);case 19:return L+G.a.instance.ga(2023);case 20:return L+G.a.instance.ga(2024);case 21:return L+G.a.instance.ga(2025);case 22:return L+G.a.instance.ga(2026);case 23:return L+G.a.instance.ga(2027);case 24:return L+G.a.instance.ga(2028);case 25:return L+G.a.instance.ga(2029);case 26:return L+G.a.instance.ga(2030);case 27:return L+G.a.instance.ga(2031);case 28:return L+G.a.instance.ga(2032);case 29:return L+G.a.instance.ga(2033);
case 30:return L+G.a.instance.ga(2034);case 31:return L+G.a.instance.ga(2035);case 32:return L+G.a.instance.ga(2036);case 33:return L+G.a.instance.ga(2037);case 34:return L+G.a.instance.ga(2038);case 35:return L+G.a.instance.ga(2039);case 36:return L+G.a.instance.ga(2040);case 37:return L+G.a.instance.ga(2041);case 38:return L+G.a.instance.ga(2042);case 39:return L+G.a.instance.ga(2043);case 40:return L+G.a.instance.ga(2044);case 41:return L+G.a.instance.ga(2045);case 42:return L+G.a.instance.ga(2046);
case 43:return L+G.a.instance.ga(2047);case 44:return L+G.a.instance.ga(2048);case 45:return L+G.a.instance.ga(2049);case 46:return L+G.a.instance.ga(2050);case 47:return L+G.a.instance.ga(2051);case 48:return L+G.a.instance.ga(2052);case 49:return L+G.a.instance.ga(2053);case 50:return L+G.a.instance.ga(2054);case 51:return L+G.a.instance.ga(2055);case 52:return L+G.a.instance.ga(2056);case 53:return L+G.a.instance.ga(2057);case 54:return L+G.a.instance.ga(2058);case 55:return L+G.a.instance.ga(2059);
case 56:return L+G.a.instance.ga(2060);case 57:return L+G.a.instance.ga(2061);case 58:return L+G.a.instance.ga(2062);case 59:return L+G.a.instance.ga(2063);default:return ka.Name?ka.Name:""}}static A2h(ka){return(ka+1)%ea.aii}static Qyb(ka,L,fa=""){return ka||!fa?`${ea.yff}, ${ka.Index.toString()}, -version, ${L.toString()}`:`${ea.yff}, ${fa}, -version, ${L.toString()}`}static pWh(ka,L,fa,wa){const oa=[];for(let xa=0;xa<ea.dCa;xa++)oa.push(ea.ehd(ka,L,fa,wa,xa));return oa}static ehd(ka,L,fa,wa,oa){ka=
ka.TableStyleElementsList;let xa=new E;const bb={};if(!ka)return bb;for(var Za of ka)if(0===Za.Type){xa=Za;break}Za=!!xa.BackgroundColor;let La="";!fa&&xa.TableStyleBorderFromatList&&0<xa.TableStyleBorderFromatList.length&&(La=xa.TableStyleBorderFromatList[0].Color);bb["background-color"]=Za?xa.BackgroundColor:"#FFFFFF";xa.FontColor||(xa.FontColor="#000000");bb.color=xa.FontColor;ea.wDe(wa,oa,bb,xa,La,fa,Za);for(const va of ka)va&&0!==va.Type&&(2!==va.Type||Za||(va.BackgroundColor=xa.BackgroundColor),
ea.Fud(va,wa,oa,L)&&(va.BackgroundColor&&(bb["background-color"]=va.BackgroundColor),bb.color=va.FontColor||xa.FontColor,ea.wDe(wa,oa,bb,va,La,fa,Za)));return bb}static $U(ka,L,fa,wa,oa,xa){fa&&(fa.Color&&!fa.Style&&(fa.Style=1),fa.Style&&!fa.Color&&(fa.Color=oa?"#000000":wa?wa:xa?"#FFFFFF":"#000000"),L[ea.borders[ka]]="1px "+ea.p_[fa.Style]+" "+fa.Color)}static Fud(ka,L,fa,wa){return-1===ka.Type?!1:ea.Hud(ka,L,fa,wa)||ea.lzi(ka,L,fa,wa)||ea.Iud(ka,L,fa,wa)}static lzi(ka,L,fa,wa){return!L&&wa.headerRow||
L===ea.Xoa-1&&wa.totalRow?!1:1===L%2&&5===ka.Type&&wa.YR&&wa.headerRow||1<L&&!!((L-1)%(ka.BandSize+1))&&6===ka.Type&&wa.YR&&wa.headerRow||!(L%2)&&5===ka.Type&&wa.YR&&!wa.headerRow||!!(L%(ka.BandSize+1))&&6===ka.Type&&wa.YR&&!wa.headerRow||!(fa%2)&&7===ka.Type&&wa.gia||!!(fa%(ka.BandSize+1))&&8===ka.Type&&wa.gia}static Iud(ka,L,fa,wa){return L===ea.Xoa-1&&2===ka.Type&&wa.totalRow||fa===ea.dCa-1&&L===ea.Xoa-1&&12===ka.Type&&wa.totalRow&&wa.lastCol||!fa&&L===ea.Xoa-1&&11===ka.Type&&wa.totalRow&&wa.firstCol||
fa===ea.dCa-1&&4===ka.Type&&wa.lastCol}static Hud(ka,L,fa,wa){return!L&&1===ka.Type&&wa.headerRow||!fa&&3===ka.Type&&wa.firstCol||!fa&&!L&&9===ka.Type&&wa.headerRow&&wa.firstCol||fa===ea.dCa-1&&!L&&10===ka.Type&&wa.headerRow&&wa.lastCol}static wDe(ka,L,fa,wa,oa,xa,bb){if(wa.TableStyleBorderFromatList)for(const Za of wa.TableStyleBorderFromatList)if(Za.Style)switch(Za.Position){case 0:ka&&12!==wa.Type&&11!==wa.Type&&2!==wa.Type&&5!==wa.Type&&6!==wa.Type||ea.$U(0,fa,Za,oa,xa,bb);break;case 1:ka!==ea.Xoa-
1&&1!==wa.Type&&10!==wa.Type&&9!==wa.Type&&5!==wa.Type&&6!==wa.Type||ea.$U(1,fa,Za,oa,xa,bb);break;case 2:L&&12!==wa.Type&&10!==wa.Type&&7!==wa.Type&&8!==wa.Type&&4!==wa.Type||ea.$U(2,fa,Za,oa,xa,bb);break;case 3:L!==ea.dCa-1&&9!==wa.Type&&11!==wa.Type&&3!==wa.Type&&7!==wa.Type&&8!==wa.Type||ea.$U(3,fa,Za,oa,xa,bb);break;case 5:L!==ea.dCa-1&&3!==wa.Type&&4!==wa.Type&&7!==wa.Type&&8!==wa.Type&&ea.$U(3,fa,Za,oa,xa,bb);break;case 6:ka!==ea.Xoa-1&&2!==wa.Type&&1!==wa.Type&&5!==wa.Type&&6!==wa.Type&&ea.$U(1,
fa,Za,oa,xa,bb)}}static O8h(){const ka=Array(12);ka[0]=0;ka[7]=1;ka[8]=2;ka[5]=3;ka[6]=4;ka[4]=5;ka[3]=6;ka[1]=7;ka[2]=8;ka[9]=9;ka[10]=10;ka[11]=11;ka[12]=13;return ka}}ea.Xoa=5;ea.dCa=5;ea.aii=5;ea.yff="TableStyleIcon";ea.p_=[null,J.a.solid,J.a.dashed,J.a.dotted,J.a.dashed,J.a.dotted,J.a.dashed,J.a.double];ea.borders=[W.a.borderTop,W.a.borderBottom,W.a.borderLeft,W.a.borderRight];ea.ngg=ea.O8h();ea.w9c=null;Object(r.a)(ea,"TableStyleHelper",null,[]);class R{constructor(ka,L,fa,wa,oa,xa){this.headerRow=
ka;this.totalRow=L;this.firstCol=fa;this.lastCol=wa;this.YR=oa;this.gia=xa}equals(ka){return ka?this.headerRow===ka.headerRow&&this.totalRow===ka.totalRow&&this.firstCol===ka.firstCol&&this.lastCol===ka.lastCol&&this.gia===ka.gia&&this.YR===ka.YR:!1}}Object(r.a)(R,"TableStyleOptions",null,[]);var Y=a(809);class U extends x.a{constructor(ka,L,fa){super();this.qcj={["height"]:"100%"};this.jKb={};this.bJa=this.Nkd=0;this.lastSyncTime=new Date;this.jea=-1;this.PN=null;this.kna={};this.oL=null;this.LI=
{};this.eUa={};this.Puc=null;this.ZCb=this.M7a=this.isInitialized=this.qnf=!1;this.Xxc=null;this.mCc=this.lPb=this.u0e=!1;this.YYi=(wa,oa,xa)=>{let bb=!1;if(S.a(wa))-315732528!==wa.Errors[0].MessageId&&(d.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${I.a.qc(wa.Errors)}`),this.gGf(null,oa,xa));else if(d.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(wa=wa.Result)&&wa.TableStyleItems.length){xa=
60<wa.TableStyleItems.length;var Za=!1,La=!1;if(this.oL)for(var va=0;60>va;++va){const Ba=wa.TableStyleItems[va],Ea=this.oL.TableStyleItems[va];if(Ba.HasStyleViolations!==Ea.HasStyleViolations){bb=La=!0;break}for(let pa=0;9>pa&&!(pa>=Ba.TableStyleElementsList.length);pa++)if(!D.a.equals(Ba.TableStyleElementsList[pa].BackgroundColor,Ea.TableStyleElementsList[pa].BackgroundColor,!1)){bb=Za=!0;break}}else{this.bJa=0;for(va of wa.TableStyleItems)va.TableStyleElementsList&&va.TableStyleElementsList.sort(ea.gvf),
this.LI[va.Name]=va}if(Za||La)for(Za=0;60>Za;++Za)La=wa.TableStyleItems[Za],this.LI[La.Name]=La;if(xa&&this.oL)for(d.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${wa.TableStyleItems.length-60}`),bb=!0,xa=60;xa<wa.TableStyleItems.length;++xa)Za=wa.TableStyleItems[xa],Za.Name in this.LI||Za.TableStyleElementsList&&Za.TableStyleElementsList.sort(ea.gvf),this.LI[Za.Name]=Za;if(Y.a(this.LI).length!==wa.TableStyleItems.length)for(bb=!0,Za=xa=
60;Za<this.oL.TableStyleItems.length;)xa>=wa.TableStyleItems.length?delete this.LI[this.oL.TableStyleItems[Za].Name]:xa>=wa.TableStyleItems.length||!D.a.equals(wa.TableStyleItems[xa].Name,this.oL.TableStyleItems[Za].Name,!1)?delete this.LI[this.oL.TableStyleItems[Za].Name]:++xa,++Za;this.oL=wa;this.oWf(bb);bb&&this.D1c();oa&&("accessibility"===oa?(this.lPb=!1,this.mCc=!0):this.mCc=!1);this.qnf||(this.Czi()&&this.$.tf(),this.qnf=!0);this.Nkd=0;this.ZCb||this.u0e?this.mCc&&this.raiseEvent("RefreshTableStyleGallery"):
(this.raiseEvent("RefreshTableStyleGallery"),this.u0e=!0)}};this.gGf=()=>{d.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.Nkd++;5>this.Nkd&&A.a.instance.create(()=>{this.L5a("getTableStylesFailed")},1E3,z.a.mgg,!0,!0)};this.JLf=()=>{this.ZCb&&(this.ZCb=!1,this.Xxc&&this.Xxc(),A.a.instance.create(()=>{this.L5a("galleryMenuClosed")},1E3,z.a.mgg,!0,!0))};this.$=ka;this.Xa=L;this.tableManager=fa;this.$.da.Ha(329,this);this.Z1c=this.Gxb();this.$.Ia.OZa(this.JLf)}Gei(ka){const L=
this.tableManager.Xi;if(!L)return!1;ka=ka[t.a.Pc];if(!ka)return!1;switch(Number.parseInvariant(ka)){case 0:return v.d(L);case 1:return v.c(L);case 2:return v.g(L);case 3:return v.e(L);case 4:return v.f(L);case 5:return v.b(L);case 6:return L.hasAutoFilter}return!1}QPf(ka,L){if(h.a.isEmpty(this.LI))return!0;if("PopulateTableMoreStylesMenu"!==ka&&"PopulateTableAccessibleStylesMenu"!==ka)return!1;if("PopulateTableAccessibleStylesMenu"===ka&&!this.mCc)return this.lPb||(this.lPb=!0,this.L5a("accessibilityTab")),
!0;this.ZCb=!0;const fa=this.Xa.Bq("TableStylesMenu"),wa=this.Xa.HC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),oa=this.Xa.HC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),xa=this.Xa.HC("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),bb=this.Xa.HC("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let Za=-123538519,La;if(L.MenuId)if(D.a.contains(L.MenuId,"FormatAsTable",!0))Za=753331043,this.M7a=!0;else{La=G.a.instance.ga(2003);var va=ea.Qyb(null,
1,"-1");P.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?bb.hu("-1",Za,"QueryTableStyle",0,"-1",va,void 0,void 0,La):bb.hu("-1",Za,"QueryTableStyle",0,"-1",void 0,void 0,void 0,La);this.M7a=!1}va=0;const Ba=this.LI;for(let Ea in Ba){const pa=Ba[Ea];if("PopulateTableAccessibleStylesMenu"===ka&&pa.HasStyleViolations)continue;let $a;La=ea.k$e(pa,this.Gxb());$a=ea.Qyb(pa,this.bJa);if(pa)switch(pa.Category){case 0:wa.hu(pa.Index.toString(),Za,"QueryTableStyle",0,
pa.Index.toString(),$a,void 0,void 0,La);va++;break;case 3:oa.hu(pa.Index.toString(),Za,"QueryTableStyle",0,pa.Index.toString(),$a,void 0,void 0,La);break;case 2:xa.hu(pa.Index.toString(),Za,"QueryTableStyle",0,pa.Index.toString(),$a,void 0,void 0,La);break;case 1:bb.hu(pa.Index.toString(),Za,"QueryTableStyle",0,pa.Index.toString(),$a,void 0,void 0,La)}}0<va&&this.w2(fa,wa,1971);this.w2(fa,bb,1972);this.w2(fa,xa,1973);this.w2(fa,oa,1974);L.MenuItems=fa.AE();this.isInitialized||(this.isInitialized=
!0);return!0}vmd(ka){ka[l.a.On]=!1;let L=ka[t.a.Pc];if(L&&!h.a.isEmpty(this.LI)){D.a.contains(ka.ParentMenuId,"FormatAsTable",!0)?this.M7a=!0:this.M7a=!1;this.M7a||this.amg();ea.apf(ka)&&(L=this.dyb(L).toString());var fa=this.Gxb();ka[l.a.Alt]="-1"===L?G.a.instance.ga(2003):ea.k$e(this.Mkd(L),fa);if(L in this.eUa&&fa.equals(this.Z1c))this.TPf(ka,L,fa,!0);else{if(!this.Puc||this.Puc&&!this.Puc.Wn)this.kna={},this.Puc=A.a.instance.create(()=>{this.oWf();this.Z1c=this.Gxb()},0,z.a.RVj,!0,!0);this.mId(fa,
ka,L)}}}getTableStyleIndexFromName(ka){if(!ka||h.a.isEmpty(this.LI))return-1;if(ka in this.LI)return this.LI[ka].Index;this.L5a("getTableStyleIndexFromName");return-1}Pud(){return!!this.oL}dyb(ka){this.PN||this.D1c();return ka in this.PN?this.PN[ka]:-1}L5a(ka){if(this.$.isEditMode){var L=new Date;if(30<C.getElapsedSeconds(this.lastSyncTime,L)||h.a.isEmpty(this.LI)||this.lPb){let fa=this.$.pa.va.$b();this.lastSyncTime=L;ka=this.lPb&&"accessibilityTab"===ka||"galleryMenuClosed"===ka;y.m(this.$.pa.va,
ka,this.YYi,this.gGf,null,ka?"accessibility":"normal",fa)}}}dispose(){this.PN=this.eUa=this.oL=this.LI=null;this.$.Ia.TKb(this.JLf);super.dispose()}GRg(ka){this.addHandler("RefreshTableStyleGallery",ka)}Ppj(ka){this.removeHandler("RefreshTableStyleGallery",ka)}D1c(){const ka={};this.tableManager.Xi&&(this.jea=this.getTableStyleIndexFromName(this.tableManager.Xi.QCc));for(let L=1;7>=L;L++)ka["preview"+L]=this.C1h(L);this.PN=ka}C1h(ka){var L=this.oL.TableStyleItems.length;L=4>=this.jea?this.jea+ka-
1:4<this.jea&&this.jea<L-4?4===ka?this.jea:Math.floor(this.jea+ka-4):this.jea+ka-1;-1===L||L.toString()in this.eUa||(L=ka-3);return L}amg(){if(this.tableManager.Xi){let ka=!1;const L=this.getTableStyleIndexFromName(this.tableManager.Xi.QCc);if(L!==this.jea){if(this.PN){const fa=this.PN;for(let wa in fa)fa[wa]===L&&(ka=!0)}this.jea=L;ka||h.a.isEmpty(this.eUa)||this.D1c()}}}w2(ka,L,fa){const wa=this.Xa.Jc();wa.Kp="Thin";wa.title=G.a.instance.ga(fa);wa.buttons.push(L);ka.uc.push(wa)}Gxb(){const ka=this.tableManager.Xi;
return this.M7a||!ka?new R(!0,!1,!1,!1,!0,!1):new R(v.d(ka),v.g(ka),v.c(ka),v.e(ka),v.f(ka),v.b(ka))}oWf(ka=!1){const L={},fa={},wa=this.Gxb();if(!h.a.isEmpty(this.LI)&&(this.tableManager.Xi&&this.amg(),!wa.equals(this.Z1c)||ka||h.a.isEmpty(this.eUa))){this.bJa=ea.A2h(this.bJa);ka=this.LI;for(var oa in ka){const xa=ka[oa],bb=ea.Qyb(xa,this.bJa);L[xa.Index.toString()]=ea.m5a(ea.Rta(ea.s6b(xa,wa)),bb);fa[bb]=L[xa.Index.toString()];this.HAa(fa)}oa=ea.Qyb(null,this.bJa,"-1");L["-1"]=ea.m5a(ea.Rta(ea.s6b(null,
wa)),oa);fa[oa]=L["-1"];this.HAa(fa);H.c(this.eUa,L,!1)}}Czi(){const ka=u.a(this.$);return ka?ka.yp.Vz===m.a.RJb:!1}mId(ka,L,fa){Number.parseInvariant(fa);"-1"===fa&&D.a.contains(L.ParentMenuId,"FormatAsTable",!0)||this.TPf(L,fa,ka,!1)}TPf(ka,L,fa,wa){const oa=ea.Qyb(null,this.bJa,L);ea.apf(ka)?(oa in this.kna?fa=this.kna[oa]:(fa=ea.Rta(ea.s6b(this.Mkd(L),fa)),this.kna[oa]=fa),ka[l.a.GalleryButtonProps]=Object(f.a)(new k.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:oa,Alt:ka[l.a.Alt],
MenuItemId:L,TableCellStyles:fa,TableStyles:this.qcj})):(ka[w.a.Icon]=oa,ka[l.a.GalleryButtonProps]=Object(f.a)(new n.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:oa,Alt:ka[l.a.Alt],MenuItemId:L}),wa||(wa=[],this.Mkd(L),"-1"===L||D.a.contains(ka.ParentMenuId,"FormatAsTable",!0)||(wa=ea.s6b(this.oL.TableStyleItems[Number.parseInvariant(L)],fa)),this.eUa[L]=ea.m5a(ea.Rta(wa),oa)))}HAa(ka){if(this.ZCb)this.Xxc=()=>{this.HAa(ka)};else{this.Xxc=null;var L=[];for(let wa in ka){var fa=wa;fa in
this.jKb?L.push(fa):this.jKb[fa]=!0}try{0<L.length&&appChrome.api.unregisterIcons(L),h.a.isEmpty(ka)||appChrome.api.registerIconProvider(()=>ka)}catch(wa){}}}Mkd(ka){ka=Number.parseInvariant(ka);if(-1===ka||!this.oL)return null;if(60<ka)for(let L=60;L<this.oL.TableStyleItems.length;++L){const fa=this.oL.TableStyleItems[L];if(fa.Index===ka)return fa}return this.oL.TableStyleItems[ka]}}Object(r.a)(U,"TableStyleManager",x.a,[260,3]);var da=a(58);a.d(B,"a",function(){return T});class T extends c.a{constructor(ka){super();
this.tableStyleManager=null;this.$=ka;this.Gb()}create(){const ka=b.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Na),L=b.GetServiceTaskFactory.Pa(this.$.da,66,134,this.Na);e.TaskExtensions.za(da.Task.uG(ka,L),()=>{this.qb(this.tableStyleManager||(this.tableStyleManager=new U(this.$,ka.result,L.result)))},this.$.ka,8)}}Object(r.a)(T,"TableStyleManagerFactory",c.a,[])},1266:function(r,B,a){r=a(0);var c=a(228),b=a(15),e=a(172),f=a(256),d=a(381),h=a(4),l=a(658),k=a(92),w=a(99),n=a(269),x=a(171),
m=a(81),u=a(428),t=a(50),y=a(38),v=a(96),A=a(77),z=a(1),C=a(580),H=a(21),I=a(33);class S extends w.a{constructor(W,ea){super(W);this.aT=[];this.Zde=null;this.LLb=R=>{let Y="forward";R.Values[d.a.direction]?Y=R.Values[d.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");R=0;let U=!0;"backward"===Y?(R=this.cwd.length-1,U=!1):"forward"===Y?(R=0,U=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${Y}`);this.Gyf(U,R,
!1)};this.gHf=()=>{this.aT=[]};this.EPa=R=>{-411645385===this.$.shortcutKeyManager.tt(R,!0)&&this.Slf()&&(this.$.Ia.Hb(new v.a(-411645385,1,this.$.xc,6,null),{["event"]:R},R),R.stopPropagation())};this.r_i=R=>{this.Oma(R)};this.mb=ea;this.Ns=H.h(this.mb);this.Gc.la("keydown",this.r_i);this.Gc.la("keyup",this.EPa);n.a(ea).SRg(this.gHf);m.a(ea.ya,27)&&y.TaskExtensions.za(t.GetServiceTaskFactory.Pa(ea.da,21,137,1),R=>{R=R.result;R.lo(e.a.Qef);R.Il(e.a.Qef,this.LLb)},ea.ka)}get $(){return this.mb}get cwd(){this.aT.length||
(this.aT=this.i6e());return this.aT}get Sla(){return this.Zde}set Sla(W){this.Zde=W;this.aT=this.i6e()}dispose(){this.$&&n.a(this.$).cqj(this.gHf);this.mb=null;this.aT.length=0;super.dispose()}adj(W){this.Oma(W)}Gyf(W,ea,R=!0,Y=null){var U=this.eVj(W,ea,R,Y);if(!U){R=ea;var da=W?1:-1,T=this.cwd;do{U=!1;if(m.a(this.$.ya,27)){if(R+=da,R>=T.length||0>R)U=!0}else R=(R+da+T.length)%T.length;if(U){this.pJi(W,ea,Y);break}else if(U=this.Xfg(W,ea,R,!1,Y))break}while(R!==ea)}}eVj(W,ea,R=!0,Y=null){let U=null;
0<=ea&&(U=this.aT[ea]);return(null===U||void 0===U?0:U.If)&&U.eg(W,R)?(Y&&A.g(Y),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${U.ee} into a sub region`),U.Bj(),!0):!1}Xfg(W,ea,R,Y,U=null){R=this.aT[R];if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const da=n.a(this.mb).zw(f.a.ova),T=n.a(this.mb).zw(f.a.Yyb),ka=this.Ns.ha.Sa.Z4;if(R===T&&ka||R===da&&!Y&&!ka)return!1}if((null===R||void 0===R?0:R.If)&&R.eg(W,!1)){U&&A.g(U);R.Bj();if(W=
this.aT[ea])W.ik(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${W.ee} to ${R.ee}`);return!0}return!1}pJi(W,ea,R=null){R&&A.g(R);if(ea=this.aT[ea])ea.ik(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${ea.ee}`);y.TaskExtensions.za(t.GetServiceTaskFactory.Pa(this.$.da,21,137,0),Y=>{Y.result.uj(e.a.pob,{[d.a.direction]:W?"forward":"backward"})},this.$.ka)}Oma(W){var ea=this.$.isEditMode?x.a(this.$):null;if(!this.$.pb.Ixa||S.wui(ea))if(117===W.keyCode&&(W.ctrlKey||A.b(W))){ea=
this.d9e(W.target);var R=!W.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${ea}`);if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var Y=n.a(this.mb).zw(f.a.QLb);Y=this.aT.indexOf(Y);h.AFrameworkApplication.sa.Qa.Ew&&this.$.f_&&-1!==Y&&ea===Y&&l.ShyRibbon.yJ(this.$.tfb,0)}else h.AFrameworkApplication.sa.Qa.Ew&&this.$.f_&&1===ea&&l.ShyRibbon.yJ(this.$.tfb,0);this.Gyf(R,ea,!0,W)}else 117!==
W.keyCode||S.DYe?-411645385===this.$.shortcutKeyManager.tt(W)?this.Slf()&&(this.$.Ia.Hb(new v.a(-411645385,1,this.$.xc,6,null),{["event"]:W},W),W.stopPropagation()):1588554917===this.$.shortcutKeyManager.tt(W)?0===this.mode?(C.a(this.$)||this.$.Ia.Hb(new v.a(1588554917,1,this.$.xc,6,null),{["event"]:W},W),W.preventDefault(),W.stopPropagation()):3===this.mode&&(W.preventDefault(),W.stopPropagation()):z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.tt(W)?
(ea=this.d9e(W.target),Y=n.a(this.mb).zw(f.a.QLb),R=n.a(this.mb).zw(f.a.ova),Y=this.aT.indexOf(Y),R=this.aT.indexOf(R),h.AFrameworkApplication.sa.Qa.Ew&&this.$.f_&&-1!==Y&&ea===Y&&1===this.$.tfb&&l.ShyRibbon.yJ(1,0),-1!==R&&ea!==R&&this.Xfg(!0,ea,R,!0,W)):this.yci(W):(W=u.a.nJ.notificationBar.eaa(k.a.vYh(),!1),I.a.ACb()?W.image=3:W.image=0,u.a.nJ.notificationBar.rE(W),S.DYe=!0)}d9e(W){const ea=this.cwd;for(let R=0,Y=ea.length;R<Y;++R){const U=ea[R];if(U&&U.Bh(W))return R}return-1}i6e(){const W=[];
for(let ea=0,R=this.Sla.length;ea<R;ea++){const Y=n.a(this.$).zw(this.Sla[ea]);Y&&W.push(Y)}return W}Slf(){return 0===this.mode||4===this.mode}static wui(W){return W?W.inKeytipMode:!1}}S.DYe=!1;Object(r.a)(S,"AccessibilityManager",w.a,[411,3]);var P=a(160),D=a(22),G=a(14);class E extends S{constructor(W){super(document.documentElement,W);this.ZB=0;this.LYg=[f.a.rIe,f.a.ECd,f.a.dgc,f.a.C_d,f.a.QLb,f.a.F1c,f.a.gfd,f.a.Qaf,f.a.P0c,f.a.WCc,f.a.tQj,f.a.Yyb,f.a.O2c,f.a.ova,f.a.OUd,f.a.U2c,f.a.seg,f.a.Jsf,
f.a.j1c];this.D$j=[f.a.dgc,f.a.tpg,f.a.spg,f.a.upg];this.Ccj=[f.a.dgc,f.a.tRf,f.a.uRf,f.a.xRf];this.S5g=[f.a.E0e,f.a.Paf,f.a.efd,f.a.cfd];this.fcj=[f.a.rIe,f.a.ECd,f.a.F1c,f.a.gfd,f.a.P0c,f.a.WCc,f.a.Yyb,f.a.O2c,f.a.ova,f.a.OUd,f.a.RQf,f.a.U2c,f.a.j1c];this.rcj=[f.a.Yyb,f.a.J0e];const ea=G.a.instance.Ua(253);this.ODj=this.$.shortcutKeyManager.Zxb(ea);this.mode=0;W.da.Ha(15,this);y.TaskExtensions.za(t.GetServiceTaskFactory.Pa(W.da,21,137,1),R=>{R=R.result;R.lo(e.a.pob);R.Il(e.a.pob,this.LLb)},W.ka)}get mode(){return this.ZB}set mode(W){this.ZB=
W;switch(W){case 0:this.Sla=this.LYg;break;case 2:this.Sla=this.D$j;break;case 3:this.Sla=this.Ccj;break;case 4:this.Sla=this.S5g;break;case 5:this.Sla=this.fcj;break;case 6:this.Sla=this.rcj;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Oma(W){this.$.Bd&65536&&super.Oma(W)}yci(W){if(D.a.equals(this.ODj,this.$.shortcutKeyManager.qid(W),!1)){const ea=P.b(this.$);if(null===ea||void 0===ea?0:ea.If)A.g(W),ea.eg(!0,!1)}}}Object(r.a)(E,"EwaAccessibilityManager",
S,[]);class O extends c.a{constructor(W){super();this.$=W;this.Gb()}create(){this.qb(this.$.da.Ba(15)||new E(this.$))}static la(W){W.da.Ha(157,new O(W))}}Object(r.a)(O,"AccessibilityManagerFactory",c.a,[]);var N=a(9);a.d(B,"a",function(){return J});const J=()=>{N.a.Fa(O.la)}},1267:function(r,B,a){var c=a(9),b=a(155);r=a(0);var e=a(15),f=a(228),d=a(38),h=a(52),l=a(1),k=a(296),w=a(219);class n{}n.YUe="ewa-svg-icon";Object(r.a)(n,"CssClassNames",null,[]);var x=a(50),m=a(12),u=a(322),t=a(108),y=a(153),
v=a(54);class A{constructor(H,I){this.htmlSanitizationHelper=null;this.Uf=()=>{this.Osf();this.$.ea.Zm(this.Uf)};this.$=H;this.Wfg={};this.cZd={};this.htmlSanitizationHelper=I;(I=this.S5e("excelInitialAppSprite"))?(this.Bre(I),this.$.ea.Kf?this.Osf():H.ea.Zj(this.Uf),this.$.da.Ha(388,this)):e.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.cZd=null;this.$.ea.Zm(this.Uf)}uka(H,I,S=null,P=null){let D;(D=this.cZd[H])||(this.cZd[H]=D=this.M8i(this.Wfg[H]));
if(!D)return e.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${H} was not found in loaded SVG sprites.`),null;const G=D.cloneNode(!0);if(!G.style){const E=u.b(D),O=u.b(G),N={};N.iconId=H;N.isOriginalNodeStyleNull=void 0===D.style||null===D.style;N.isOriginalNodeCurrentStyleNull=void 0===D.currentStyle||null===D.currentStyle;N.isClonedNodeCurrentStyleNull=void 0===G.currentStyle||null===G.currentStyle;N.originalNode=E.substring(0,E.indexOf(">")+1);N.clonedNode=O.substring(0,O.indexOf(">")+
1);e.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(N)}`)}G.setAttribute("style",`height: ${I}px; width: ${I}px;`);P&&(H=document.createElement("title"),l.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&l.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")?this.htmlSanitizationHelper.jh(H,P):H.innerHTML=P,G.insertBefore(H,G.childNodes[0]));if(S)for(const E of S)Sys.UI.DomElement.addCssClass(G,
E);return G}Lba(H,I,S,P,D=0,G=0,E=null,O=null){D&&G||(G=m.DOMElementExtensions.getBoundingClientRect(P),D=G.height,G=G.width);if(E=this.uka(H,I,E,O))P.appendChild(E),(P=m.DOMElementExtensions.xZ(E,"style",null))?E.setAttribute("style",P+` margin: ${(D-I)/2}px ${(G-S)/2}px;`):e.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${H}`);return E}Osf(){l.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?
void y.a.resolve(v.l,{Wb:0}).then(H=>H("excel-uiSlice20-sprite")).then(()=>this.Are()):d.TaskExtensions.za(x.GetServiceTaskFactory.Pa(this.$.da,283,284,0),H=>{H=t.c(H.result.Ll.loadScript("excel-uiSlice20-sprite"));d.TaskExtensions.za(H,()=>{this.Are()},this.$.ka,3)},this.$.da.ka,3)}Are(){const H=this.S5e("excelUiSlice20Sprite");H?this.Bre(H):e.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}Bre(H){for(const I of H)I.type===w.a.$Yd&&(this.Wfg[I.id]=I)}M8i(H){if(!H)return null;
const I=H.viewBox;H=H.children;const S=document.createElementNS(k.a.dZd,w.a.$Yd);Sys.UI.DomElement.addCssClass(S,n.YUe);S.setAttribute("focusable","false");S.setAttribute("viewBox",I);this.XNg(S,H);return S}XNg(H,I){for(const P of I){const D=document.createElementNS(k.a.dZd,P.type);for(let G in P){I=G;var S=P[G];"className"===I?D.setAttribute("class",S):D.setAttribute(I,S)}H.appendChild(D)}}S5e(H){return(H=window[H])?H.icons:null}}Object(r.a)(A,"SvgIconProvider",null,[432,3]);class z extends f.a{constructor(H){super();
this.$=H;this.Gb()}create(){const H=this.OEi();if(l.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&l.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")){const I=l.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(t.c)(y.a.resolve(v.w,{Wb:0})):x.GetServiceTaskFactory.Pa(this.$.da,498,499,0);d.TaskExtensions.za(d.TaskExtensions.Md([H,I],this.$.ka),()=>{window.excelInitialAppSprite?this.qb(this.$.da.Ba(388)||
new A(this.$,I.result)):e.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}else d.TaskExtensions.za(H,()=>{window.excelInitialAppSprite?this.qb(this.$.da.Ba(388)||new A(this.$,null)):e.ULS.sendTraceTag(509694111,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}OEi(){if(l.EwaSettings.isChangeGateEnabled("OfficeVSO:7521802_OnboardWdAppChromeVersion")){let H;H=l.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?
y.a.resolve(v.l,{Wb:this.Na}).then(I=>Object(b.a)(this,void 0,void 0,function*(){return I("excel-app-intl")})):x.GetServiceTaskFactory.Pa(this.$.da,283,284,this.Na).result.Ll.loadScript("excel-app-intl");return Object(t.c)(H)}return h.a.pR([130],4,this.Na,void 0,void 0,void 0,387)}static la(H){H.da.Ha(387,new z(H))}}Object(r.a)(z,"SvgIconProviderFactory",f.a,[]);a.d(B,"a",function(){return C});const C=()=>{c.a.Fa(z.la)}},1291:function(r,B,a){r={};a.r(r);a.d(r,"SparklineManager",function(){return n});
var c=a(9),b=a(70),e=a(0),f=a(228),d=a(155),h=a(481),l=a(21),k=a(153),w=a(54);let n=class extends h.a{constructor(u){super(Object(l.h)(u));Object(b.b)("OfficeVSO:7624512_MigrateSparklineManagerService")||u.da.Ha(240,this)}O7h(u){for(const t of this.rangeList)if(u.range.contains(t))return t;return null}JKd(u){return u.GridBlockModel&&(u=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(u.GridBlockModel))?u.getSparklineRanges():null}};n=Object(d.b)([Object(k.d)(w.Q),Object(d.c)(0,Object(w.o)())],
n);Object(e.a)(n,"SparklineManager",h.a,[364]);class x extends f.a{constructor(u){super();this.sparklineManager=null;this.$=u;this.Gb()}create(){this.qb(this.sparklineManager||(this.sparklineManager=new n(this.$)))}static la(u){u.da.Ha(239,new x(u))}}Object(e.a)(x,"SparklineManagerFactory",f.a,[]);a.d(B,"a",function(){return m});const m=()=>{c.a.Fa(u=>{Object(b.b)("OfficeVSO:7624512_MigrateSparklineManagerService")||x.la(u)})};String(r);window.___1678693025795_closurehack=r},1311:function(r,B,a){r=
a(0);var c=a(154),b=a(609);class e extends b.a{constructor(){super()}dispose(){c.WacAirSpace.wqd()&&c.WacAirSpace.CDc()}animate(h,l,k,w,n){l&&c.WacAirSpace.fL(h.element,l);c.WacAirSpace.animate(h,w,n);k&&c.WacAirSpace.imj(h.element,k)}}Object(r.a)(e,"AnimationManager",b.a,[3]);var f=a(105);a.d(B,"a",function(){return d});const d=()=>{f.a.Tl.Ha(141,new e)}},1489:function(r,B,a){a.r(B);r={};a.r(r);a.d(r,"NewAndOpenCoreManager",function(){return G});B=a(1237);var c=a(1198),b=a(1157),e=a(1158),f=a(1159),
d=a(1161);a(1160);var h=a(1266),l=a(1311),k=a(9),w=a(70),n=a(0),x=a(228),m=a(155),u=a(197),t=a(558),y=a(15),v=a(832),A=a(524),z=a(86),C=a(4),H=a(84),I=a(932),S=a(153),P=a(54),D;let G=D=class extends H.a{constructor(N){super();this.dxd=null;this.$=N;y.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}Puj(){const N=new u.a,J=A.a.gq(z.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>")),W=new t.a(()=>J.result);this.dxd=new t.a(()=>new v.a(W.value,null));if(!this.dxd)return N;var ea=
this.dxd.value.HZ("NewAndOpenCoreManager",!1);if(!ea||3!==ea.state||!ea.mBd)return ea?y.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${ea.state}, mruResult MruDocuments is null: ${!ea.mBd}`):y.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;ea=ea.mBd;const R=["xlsx","xlsb","xlsm"];for(let U=0;U<ea.length;U++){var Y=ea[U];if(0>Array.indexOf(R,Y.extension))continue;const da=`${Y.title}.${Y.extension}`,
T=I.b(Y,C.AFrameworkApplication.isRtl);Y=Y.url;da&&T&&Y?N.add({[D.fileName]:da,[D.friendlyPath]:T,[D.section]:"mru",[D.absoluteUrl]:Y}):Y||y.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return N}dispose(){super.dispose()}};G.fileName="FileName";G.friendlyPath="FriendlyPath";G.section="Section";G.absoluteUrl="AbsoluteUrl";G=D=Object(m.b)([Object(S.d)(P.B),Object(m.c)(0,Object(P.o)())],G);Object(n.a)(G,"NewAndOpenCoreManager",H.a,[403,3]);class E extends x.a{constructor(N){super();
this.$=N;this.Gb()}create(){this.qb(this.$.da.Ba(451)||this.$.da.Ha(451,new G(this.$)))}static la(N){N.da.Ha(164,new E(N))}}Object(n.a)(E,"NewAndOpenCoreFactory",x.a,[]);n=a(1191);x=a(1291);m=a(1267);H=a(1238);S=a(1195);P=a(1184);var O=a(1203);a=a(1177);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");
Type.registerNamespace("_Ewa");Object(B.a)();Type.registerNamespace("Common.App.AltTextDialog");Object(c.a)();Object(b.a)();Object(e.a)();Object(f.a)();Object(h.a)();Object(w.b)("OfficeVSO:7624895_MigrateNewAndOpenCoreManagerToNewServiceInfra")||k.a.Fa(E.la);Object(l.a)();Object(n.a)();Object(x.a)();Object(m.a)();Object(d.a)();Object(H.a)();Object(S.a)();Object(P.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(O.a)();Object(a.a)();String(r);window.___1678693106650_closurehack=r}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/01a75f07b447707e85377eb7d6931b8f/EwaDSEsNext.acc.js.map