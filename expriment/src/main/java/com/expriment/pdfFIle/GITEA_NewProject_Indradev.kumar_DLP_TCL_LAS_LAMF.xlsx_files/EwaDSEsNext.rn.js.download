'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1179:function(r,B,a){r=a(0);var c=a(88),b=a(558),e=a(15),f=a(141);class d{constructor(Z,ja,la){this.oWd=this.pWd=this.qWd=!1;this.DWd=!Z&&!ja;this.EWd=!Z&&!la;this.DWd||this.EWd||(this.qWd=!Z,this.pWd=!ja,this.oWd=!la)}}Object(r.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends f.StandardDialog{constructor(Z,ja,la,ua,eb){super();this.NZd=[];this.N1=new d(Z,ja,la);this.nsa=ua;this.dra=eb;this.we="RenameDisabledDialog";
this.Rb=0;this.wc(1,CommonUIStrings.l_DialogClose);this.ZGj();this.Mqj()}ZGj(){this.N1.DWd?this.GOb(this.nsa?this.dra?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.N1.EWd?this.GOb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.AMg();this.ysa(this.NZd)}GOb(Z){Array.add(this.NZd,Z)}AMg(){const Z=[];this.N1.qWd||Array.add(Z,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.N1.pWd||Array.add(Z,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.N1.oWd||Array.add(Z,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Z.length&&Array.add(this.NZd,Z)}}Object(r.a)(h,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class l extends h{constructor(Z,ja,la,ua,eb){super(Z,ja,la,ua,eb)}Mqj(){this.zFb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(r.a)(l,"ReactRenameDisabledDialog",h,[]);var k=a(156);class w{static get qg(){return k.a.Iq(w.Ql,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}w.Ql="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(r.a)(w,"RenameDisabledDialogHtml",null,[]);class n extends k.a{constructor(Z,ja,la,ua,eb){super();this.N1=new d(Z,ja,la);this.nsa=ua;this.dra=eb;this.we="RenameDisabledDialog";this.Rb=0;this.wc(1,CommonUIStrings.l_DialogClose);this.qg=w.qg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.VW("RenameRow")}kab(){if(this.N1.DWd){let Z;Z=this.nsa?this.dra?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;
n.GOb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Z)}else this.N1.EWd?n.GOb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Zgi()}Zgi(){this.N1.qWd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.N1.pWd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.N1.oWd&&
(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static GOb(Z,ja,la){Z.style.display="none";ja.innerText=la}}Object(r.a)(n,"RenameDisabledDialog",k.a,[]);var x=a(4),m=a(31),u=a(111),t=a(25);class y{constructor(Z,ja){this.jFa=0;this.La=Z;this.H8=ja}initialize(Z){if(!this.La||!this.H8)return!1;this.jFa=Z;this.Hg();return!0}Hg(){this.La.Qb(t.a.lia,u.a.frame,Object(c.a)(this,this.lia,"commitNewDocumentTitle"))}lia(Z,ja,la,ua,eb){if(1===la)return this.La.processAction(t.a.renameFile,
1);Z=m.a.Pp(this.H8.ln);eb=(0,eb.getNewDocumentTitle)();eb.length>this.jFa&&(eb=eb.substr(0,this.jFa));if(32!==this.La.$d(t.a.renameFile,2,eb))return this.mX(Z),8;this.mX(eb);return 32}mX(Z){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Z))}static Pid(){return new y(x.AFrameworkApplication.rb,x.AFrameworkApplication.um)}}Object(r.a)(y,"ReactRenameUIHandler",null,[602]);var v=a(94),A=a(526),z=a(560),C=a(13),H=a(113),I=a(243),S=a(92),P=a(41),D=a(27),G=a(86);class E{constructor(Z,ja,la,
ua,eb,Eb,Wb,Ab,Jb,Gb,Nb,Ja){this._initialized=!1;this._element=null;this.jFa=0;this.eUc=this.ANc=!1;this.La=Z;this.UIc=ja;this.fe=la;this.oA=ua;this.H8=eb;this.Fke=Eb;this.BYb=Wb;this.NJc=Ab;this.V8=Jb;this.hde=Gb;this.lXa=Nb;this.vOc=Ja}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Z,ja,la){if(!(this.La&&this.H8&&this.Fke&&this.BYb&&this.NJc&&ja)||0>=Z)return!1;this._element=ja;this._element.title=la;this._element.setAttribute(S.a.Jd,S.a.Ws);this._element.setAttribute("Unselectable",
"on");this.jFa=Z;this.Nt();return this._initialized=!0}Nt(){this.UIc&&(this.UIc.ta(C.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.UIc.ta(C.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.fe.ta(C.a.Vb,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.oA.ta(C.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.oA.ta(C.a.Of,this._element,Object(c.a)(this,this.fh,"onPointerUp"))}onBlur(){this.isActive&&!this.ANc&&
(this.hde||this.NJc(this._element),this.EGe(),this.e9c(!1));return this.ANc=!1}onPaste(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Z){return this.isActive?this.s_i(Z):this.t_i(Z)}s_i(Z){let ja=!1;switch(Z.Ea.keyCode){case Sys.UI.Key.enter:this.EGe();this.e9c(this.lXa||this.vOc);ja=!0;break;case Sys.UI.Key.tab:this.hde&&this.NJc(this._element);break;case Sys.UI.Key.esc:this.QPd(),this.e9c(this.lXa||this.vOc),ja=!0}return ja}t_i(Z){let ja=!1;
switch(Z.Ea.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.mjg(this.vOc),this.isActive&&this.BYb(this._element),ja=!0}return ja}onPointerDown(){this.isActive||(this.mjg(!1),this.isActive&&(this._element.focus(),this.BYb(this._element),this.eUc=!0));return!1}fh(){return this.eUc?(this.BYb(this._element),this.eUc=!1,!0):!1}t8a(){return 32===this.La.processAction(t.a.renameFile,1)}EGe(){const Z=m.a.Pp(this.H8.ln);let ja=this._element.innerText.trim();ja.length>this.jFa&&(ja=ja.substr(0,this.jFa));
ja!==Z&&""!==ja?32!==this.La.$d(t.a.renameFile,2,ja)?this.QPd():this.mX(ja):this.QPd()}QPd(){this.mX(m.a.Pp(this.H8.ln))}mX(Z){this._initialized&&(this._element.innerText=Z,this.Fke())}mjg(Z){this.t8a()?this.isActive||(Z&&(this.ANc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(S.a.Jd,S.a.L_c),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,v.CuiHelper.sQe),this.V8&&
this.V8.execute(ja=>{ja.ITf(!0)}),Z&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(t.a.qfb,2)}e9c(Z){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(S.a.Jd,S.a.Ws);Sys.UI.DomElement.removeCssClass(this._element,v.CuiHelper.sQe);this.V8&&this.V8.execute(ja=>{ja.ITf(!1)});Z&&(this._element.blur(),this._element.focus())}static Tz(){A.a.Tz(x.AFrameworkApplication.isRtl)}static Pid(){return new E(x.AFrameworkApplication.rb,
z.a.instance,H.KeyInputManager.instance,I.a.instance,x.AFrameworkApplication.um,E.Tz,P.a.ezj,P.a.F8g,G.a.instance.Tb("Common.App.Header.HeaderEventSource"),D.a.Ala,D.a.Pg,D.a.Ff)}}Object(r.a)(E,"RenameUIHandler",null,[602]);class O{static get instance(){return x.AFrameworkApplication.sa.Qa.Bu?O.Ma||(O.Ma=y.Pid()):O.Ma||(O.Ma=E.Pid())}}O.Ma=null;Object(r.a)(O,"RenameUIHandlerFactory",null,[]);var N=a(102),J=a(143);class W{constructor(){this.uPi=this.qPi=this.Vlh=null}}Object(r.a)(W,"RenameMruEntryProperties",
null,[]);var ea=a(381),R=a(172),Y=a(657),U;(function(Z){Z[Z.unknown=-1]="unknown";Z[Z.success=0]="success";Z[Z.renameInvalidFileName=1]="renameInvalidFileName";Z[Z.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Z[Z.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Z[Z.permissionDenied=4]="permissionDenied";Z[Z.serverCommunicationFailure=5]="serverCommunicationFailure";Z[Z.fileNameTooLong=6]="fileNameTooLong"})(U||(U={}));Object(r.b)("CommonOperationResult",U);class da{constructor(Z,
ja,la,ua,eb,Eb,Wb,Ab,Jb,Gb,Nb,Ja){this.ude=Z;this.La=ja;this.XJc=la;this.Wv=ua;this.dFa=eb;this.lJg=Eb;this.nsa=Wb;this.Jne=Ab;this.LFg=Jb;this.dra=Gb;this.fb=Nb;this.KFg=Ja}Hg(){x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.Bu||this.Uh.Qb(t.a.LAb,u.a.frame,Object(c.a)(this,this.LAb,"initializeRenameUIHandler"));this.Uh.Qb(t.a.qfb,u.a.frame,Object(c.a)(this,this.qfb,"showRenameDisabledDialog"));this.Uh.Qb(t.a.renameFile,u.a.frame,Object(c.a)(this,this.renameFile,"renameFile"));this.Uh.Je(t.a.fileNameUpdate,
u.a.frame,Object(c.a)(this,this.vjj,"refreshFilename"),64);this.Uh.Je(t.a.Foc,u.a.frame,Object(c.a)(this,this.Foc,"moveToFolderCompleteByHost"),64);this.Uh.Qb(t.a.ePa,u.a.frame,Object(c.a)(this,this.ePa,"moveToFolder"));(x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||x.AFrameworkApplication.sa&&(x.AFrameworkApplication.fa.qa("PostMessageEmbedded")||x.AFrameworkApplication.fa.qa("IsJsApi"))&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&x.AFrameworkApplication.JQ().execute(Z=>{Z.lo(R.a.Jyf);Z.Il(R.a.Jyf,da.jij);Z.lo(R.a.Edd);Z.Il(R.a.Edd,da.hij)})}t8a(){return 0===this.KFg.A8e()?32:8}u8j(){return this.$y?this.nsa?this.$y.nPe:this.$y.gxb:!0}LAb(){return O.instance.initialize(x.AFrameworkApplication.abc,x.AFrameworkApplication.R2a,x.AFrameworkApplication.gOd||CommonUIStrings.l_RenameFileTooltip)?32:8}qfb(){const Z=this.u8j(),ja=this.lJg();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.dFa,ja,Z,this.nsa);x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.Fv&&x.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new l(this.dFa,!ja,!Z,this.nsa,this.dra()):new n(this.dFa,!ja,!Z,this.nsa,this.dra());return 32}renameFile(Z,ja,la,ua,eb){if(1===la)return this.t8a();if(!x.AFrameworkApplication.uac)return 8;if(8===this.t8a())return this.Uh.processAction(t.a.qfb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");x.AFrameworkApplication.uac(eb,Object(c.a)(this,
this.FHb,"onRenameFileSuccess"),Object(c.a)(this,this.$1i,"onRenameFileFailure"));return 32}FHb(Z,ja){Z?0!==Z.OperationResult?this.Ebf(Z.OperationResult):(this.sAj(ja,Z.NewName),this.M3j(Z,Object(c.a)(x.AFrameworkApplication.sa.Qa,x.AFrameworkApplication.sa.Qa.Umg,"updateOpenInClientDocumentUrl")),x.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&x.AFrameworkApplication.sa.updateCommandUI(),this.LFg.wlg()):this.Ebf(5)}sAj(Z,ja){const la={};la[ea.a.KJh]=ja;Z.uj(R.a.Edd,la)}M3j(Z,
ja){this.$3j(Z);x.AFrameworkApplication.U8b=Z.DirectInvokeDavUrl;ja=ja(Z.EditDocInClientUrl);const la=new W;la.uPi=this.Wv.ln;la.Vlh=ja;la.qPi=Z.EditDocInClientUrl;this.Uh.$d(t.a.renameMostRecentlyUsedFileEntry,2,la)}Ebf(Z){switch(Z){case 1:Z=new f.StandardDialog,Z.Rb=0,Z.jS(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.D1f()}}$3j(Z){this.Wv.ln=da.aVg(this.Wv.ln,Z.NewName);Z.BreadcrumbFolderName&&(this.Wv.breadcrumbFolderName=Z.BreadcrumbFolderName);
Z.BreadcrumbFolderUrl&&(this.Wv.breadcrumbFolderUrl=Z.BreadcrumbFolderUrl);this.Jne(Z.NewName)}$1i(Z){const ja=new f.StandardDialog;ja.Rb=0;switch(Z){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ja.Eoa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ja.Eoa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Z}),ja.Eoa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}x.AFrameworkApplication.JQ().execute(la=>{la.uj(R.a.JJh,{["FailureMessage"]:U[Z]})});this.D1f()}vjj(Z,ja,la){if(1===la)return this.t8a();if(!x.AFrameworkApplication.kKa)return 8;x.AFrameworkApplication.kKa(Object(c.a)(this,this.qrc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.prc,"onRefreshFilenameFailure"),
!1);return 32}ePa(Z,ja,la,ua,eb){if(1===la)return x.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===la){const Eb={};Z=x.AFrameworkApplication.eca;ja=x.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");Z=(!Z||Z&&ja)&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Eb[ea.a.JUj]=Z;eb&&eb.MoveButtonClickedTime&&(Eb[ea.a.RNi]=eb.MoveButtonClickedTime.getTime());x.AFrameworkApplication.JQ().execute(Wb=>{Wb.uj(R.a.ePa,
Eb)});if(eb&&eb.MoveButtonClickedTime){if(Z=J.a.Wr())eb=(new Date).getTime()-eb.MoveButtonClickedTime.getTime(),Z.set("MovePostDuration",eb.toString());N.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Z)}return 32}return 8}Foc(Z,ja,la,ua,eb){if(1===la)return x.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.t8a():8;if(2===la){if(!x.AFrameworkApplication.v5f)return N.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!eb)return N.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(eb[ea.a.Nri])if(eb[ea.a.Vng])if(Z=eb[ea.a.Vng].toLowerCase(),ja=x.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),la=x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ja&&x.AFrameworkApplication.eca&&la){const Eb={};Eb[ea.a.UQa]="1";Eb[ea.a.documentUrl]=Z;Eb[ea.a.reason]=Y.a.saveAs;N.Health.instance.recordKpiSuccess("MoveToFolder",null);
x.AFrameworkApplication.JQ().execute(Wb=>{Wb.uj(R.a.fZ,Eb)})}else if(!x.AFrameworkApplication.eca&&la)N.Health.instance.recordKpiSuccess("MoveToFolder",null),P.a.nf(Z,P.a.qX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return N.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else N.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else x.AFrameworkApplication.kKa(Object(c.a)(this,this.qrc,"onRefreshFilenameSuccess"),Object(c.a)(this,
this.prc,"onRefreshFilenameFailure"),!1),x.AFrameworkApplication.v5f(),N.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}DMj(Z,ja){return Z&&ja?Z!==this.Wv.breadcrumbFolderName||ja!==this.Wv.breadcrumbFolderUrl:!1}qrc(Z,ja){Z&&(Z.NewName!==m.a.Pp(this.Wv.ln)||this.DMj(Z.BreadcrumbFolderName,Z.BreadcrumbFolderUrl))&&this.FHb(Z,ja)}prc(){}D1f(){this.Jne(m.a.Pp(this.Wv.ln))}get Uh(){return this.La.value}get $y(){return this.XJc.value}static get instance(){return da.Ma||(da.Ma=da.hxb())}static hxb(){return new da(x.AFrameworkApplication.u8a,
new b.a(()=>x.AFrameworkApplication.rb),new b.a(()=>x.AFrameworkApplication.$y),x.AFrameworkApplication.um,x.AFrameworkApplication.limitedEdit,()=>x.AFrameworkApplication.userCanRename,x.AFrameworkApplication.gwc,Object(c.a)(O.instance,O.instance.mX,"updateTitle"),G.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.fa,G.a.instance.resolve("Common.IRenameProps"))}static aVg(Z,ja){Z=m.a.k4(Z);return ja+Z}static jij(Z){const ja=
Z.Values[ea.a.Fvi];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ja);ja?x.AFrameworkApplication.rb.$d(t.a.Foc,2,Z.Values):N.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static hij(Z){x.AFrameworkApplication.rb.$d(t.a.renameFile,2,Z.Values.NewName)}}da.Ma=null;Object(r.a)(da,"RenameActor",null,[]);a(576);class T{}Object(r.a)(T,"ActivityEventName",null,[]);class ka{}ka.compatMode="CompatMode";ka.noSelection="NoSelection";
Object(r.a)(ka,"ActivityEventReason",null,[]);var L=a(655);class fa{constructor(Z,ja){this.La=Z;this.qWa=ja}Hg(){this.La.Qb(t.a.hcg,u.a.frame,Object(c.a)(this,this.hPj,"showRenameDialogAction"))}hPj(Z,ja,la){Z=32;if(1===la)return L.SessionStatusManager.instance.h6a||x.AFrameworkApplication.h5?8:32;2===la&&(32!==this.La.processAction(t.a.renameFile,1)?(this.La.processAction(t.a.qfb,2),Z=8):32===this.La.processAction(t.a.FOb,1)?this.La.processAction(t.a.FOb,2):this.qWa.value.create().LAc());return Z}}
Object(r.a)(fa,"RenameDialogActor",null,[586]);class wa{constructor(Z,ja,la){this.dialog=null;this.La=Z;this.Wv=ja;this.Qqa=la}D5h(){const Z={};Z.nameInputProps={["type"]:"AppInputProps",["id"]:wa.Q2a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:m.a.Pp(this.Wv.ln),["maxLength"]:this.Qqa};return Z}LAc(){const Z={["id"]:"RenameDialog",["bodyControls"]:this.D5h()};this.dialog=new k.a(!1,!1,!0);this.dialog.Rb=1;this.dialog.we="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,
Object(c.a)(this,this.eOd,"renameDialogHandler"),Z)}eOd(Z,ja){ja&&1===Z&&ja[wa.Q2a]&&(Z=m.a.Pp(this.Wv.ln),ja=(ja[wa.Q2a]||"").trim(),ja!==Z&&""!==ja&&this.La.$d(t.a.renameFile,2,ja))}}wa.Q2a="txtDocumentName";Object(r.a)(wa,"ReactRenameDialog",null,[601]);class oa{static get qg(){return k.a.Iq(oa.Ql,CommonUIStrings.l_RenameDialogLabel)}}oa.Ql="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(r.a)(oa,"RenameDialogHtml",null,[]);class xa extends k.a{constructor(Z,ja,la){super();this.La=Z;this.Wv=ja;this.Qqa=la;this.we="RenameDialog";this.qg=oa.qg}LAc(){var Z={["txtDocumentName"]:m.a.Pp(this.Wv.ln)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.eOd,"renameDialogHandler"),Z);Z=document.getElementById(xa.Q2a);0<this.Qqa&&(Z.maxLength=this.Qqa);Z.focus()}eOd(Z,ja){1===Z&&(Z=m.a.Pp(this.Wv.ln),ja=(ja[xa.Q2a]||"").trim(),ja!==Z&&""!==ja&&this.La.$d(t.a.renameFile,
2,ja))}}xa.Q2a="txtDocumentName";Object(r.a)(xa,"RenameDialog",k.a,[601]);class bb{constructor(Z){this.H8=null;this.Qqa=0;this.La=Z;this._initialized=!1}initialize(Z,ja){this.H8=Z;this.Qqa=ja;this._initialized=!0}create(){return this._initialized?x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.Fv&&x.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new wa(this.La,this.H8,this.Qqa):new xa(this.La,this.H8,this.Qqa):null}}Object(r.a)(bb,"RenameDialogFactory",null,[587]);var Za=a(270),
La=a(150),va=a(140),Ba=a(112),Ea=a(107);class pa{constructor(Z,ja){this.La=Z;this.fc=ja}Hg(){this.La.Qb(t.a.FOb,u.a.frame,Object(c.a)(this,this.iPj,"showRenameFlyoutAction"))}H4g(){return va.d("setDocumentTitleFlyoutOpened")&&x.AFrameworkApplication.sa.Qa.Bu}iPj(Z,ja,la){if(1===la)return this.H4g()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}KNg(){pa.Myi&&x.AFrameworkApplication.f8a&&Ea.a.instance.ig(new Ba.a(5,1,5E3,()=>{32===this.La.processAction(t.a.FOb,
1)&&this.fc&&this.fc.di.name===Za.AFrame.Aaa&&(La.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(t.a.FOb,2))}))}static get Myi(){pa.ZVb&&null!=pa.ZVb||(x.AFrameworkApplication.yya("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),pa.ZVb=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return pa.ZVb}}pa.ZVb=null;Object(r.a)(pa,"RenameFlyoutActor",null,
[584]);class $a{constructor(Z,ja,la,ua,eb){this.XJc=eb;this.vde=la;this.ude=ua;this.pJg=Z;this.dra=ja}get $y(){return this.XJc.value}A8e(){if(!this.ude())return 5;if(this.dra())return 1;if(this.$y){if(this.vde&&!this.$y.nPe)return 3;if(!this.vde&&!this.$y.gxb)return 4}return this.pJg()?0:2}}Object(r.a)($a,"RenameProps",null,[585]);a(197);var cb=a(103);class ib{constructor(Z,ja,la,ua,eb,Eb){this.ox=!1;this.RPc=new cb.a;this.xWa=ja;this.FL=la;this.uxg=ua;this.fb=eb;this.pme=Eb}enable(){this.ox||(this.wlg(),
this.bYd(),this.ox=!0)}generateKey(Z,ja,la){return String.format("{0}/{1}/{2}",la,Z,ja)}z0h(){const Z=m.a.Pp(this.xWa().ln);return this.generateKey(this.xWa().breadcrumbFolderName,this.xWa().breadcrumbFolderUrl,Z)}A0h(Z,ja,la){return Z&&ja?this.generateKey(Z,ja,la):la}iqh(Z,ja,la){return Z&&Z!==this.xWa().breadcrumbFolderName||ja&&ja!==this.xWa().breadcrumbFolderUrl?!0:la!==m.a.Pp(this.xWa().ln)}wlg(){const Z=this.z0h();this.RPc.ia(Z,new Date)}KHd(Z){this.cLj(Z)&&this.Soe(Z)}cLj(Z){const ja=this.uxg();
return ja?this.pme&&this.pme.cCb||!ja.Gkf||!x.AFrameworkApplication.kKa?(this.Jeg(Z),this.ox=!1):!0:!1}wLf(Z,ja,la,ua){const eb=this.iqh(Z,ja,la);Z=this.A0h(Z,ja,la);ja=this.RPc.Ic(Z).returnValue;eb&&!ja&&(this.Fbf(ua),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.qyd));eb||this.RPc.ia(Z,this.FL())}}Object(r.a)(ib,"ARenamedFileChecker",null,[522]);class ta extends ib{constructor(Z,ja,la,ua,eb,Eb,Wb,Ab){super(Z,ja,la,ua,eb,Eb);this.yje=eb;this.JFg=Wb;this.hBg=Ab}get qyd(){return"RenamedFileCheckerUsingSettingsRefresh"}bYd(){this.yje.TYc(Object(c.a)(this,
this.qcf,"handleSettingsRefresh"))}qcf(Z,ja){ja&&ja.dGb&&ja.XRi&&(ja.D8a("BreadcrumbDocName")||ja.D8a("BreadcrumbFolderName")||ja.D8a("BreadcrumbFolderUrl")||ja.D8a("DirectInvokeDAVUrl")||ja.D8a("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.qyd),this.KHd(ja))}Jeg(){this.yje.qZf(Object(c.a)(this,this.qcf,"handleSettingsRefresh"))}Soe(Z){if(Z&&Z.dGb){const ja=Z.dGb;this.wLf(ja.Wa("BreadcrumbFolderName"),ja.Wa("BreadcrumbFolderUrl"),ja.Wa("BreadcrumbDocName"),
Z)}}Fbf(Z){const ja={OperationResult:0,classId:1};Z=Z.dGb;ja.BreadcrumbFolderName=Z.Wa("BreadcrumbFolderName");ja.BreadcrumbFolderUrl=Z.Wa("BreadcrumbFolderUrl");ja.DirectInvokeDavUrl=Z.Wa("DirectInvokeDAVUrl");ja.EditDocInClientUrl=Z.Wa("EditDocInClientUrl");Z=Z.Wa("BreadcrumbDocName");ja.NewName=x.AFrameworkApplication.Aua?Z:m.a.Pp(Z);this.hBg.execute(la=>{this.$oi(ja,la)})}$oi(Z,ja){this.JFg().FHb(Z,ja)}}Object(r.a)(ta,"RenamedFileCheckerUsingSettingsRefresh",ib,[]);class Ya extends ib{constructor(Z,
ja,la,ua,eb,Eb,Wb,Ab,Jb,Gb){super(Z,la,ua,eb,Eb,Jb);this.Xmb=this.f_b=null;this.TEg=ja;this.La=Wb;this.pe=Ab;Gb&&Gb.execute(Nb=>{this.Llj(Nb)})}get qyd(){return"RenamedFileCheckerUsingTask"}Llj(Z){this.f_b=Z;this.f_b.hte(Object(c.a)(this,this.jzb,"handleVisibilityChange"))}jzb(Z,ja){!this.ox||0!==ja.newState&&1!==ja.newState||this.Xmb||(this.bYd(),this.KHd(this.Xmb))}bYd(){this.Xmb=new Ba.a(3,2,this.TEg(),Object(c.a)(this,this.KHd,"performRenameFileCheckTick"),89);this.pe.ig(this.Xmb)}Jeg(Z){this.pe.$o(Z)}Soe(Z){this.f_b&&
2===this.f_b.edk?this.Nmj(Z):x.AFrameworkApplication.kKa(Object(c.a)(this,this.qrc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.prc,"onRefreshFilenameFailure"),!0)}Nmj(Z){this.pe.$o(Z);this.Xmb=null}qrc(Z){Z&&this.wLf(Z.BreadcrumbFolderName,Z.BreadcrumbFolderUrl,Z.NewName,null)}Fbf(){this.La.processAction(t.a.fileNameUpdate,2)}prc(){}}Object(r.a)(Ya,"RenamedFileCheckerUsingTask",ib,[]);var Da=a(100);class ba{constructor(){this.fb=this.$a=null}get name(){return"Common.App.RenameFile"}Kh(Z){this.$a=
Z;this.fb=x.AFrameworkApplication.fa;this.$a.register(fa,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Bc(()=>new fa(x.AFrameworkApplication.rb,this.$a.KPd("Common.App.Rename.IRenameDialogFactory"))).tc();this.$a.register(bb,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Bc(()=>new bb(x.AFrameworkApplication.rb)).tc();this.$a.register(522,"Common.App.Rename.IRenamedFileChecker").Bc(()=>this.Gjh()).tc();this.$a.register(pa,
"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Bc(()=>new pa(x.AFrameworkApplication.rb,Da.FocusManager.instance())).tc()}Gjh(){if(this.fb.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Z=this.$a.og("Common.IRefreshableAppSettings");if(Z&&Z.Jnf)return new ta(()=>Z.Ad("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>x.AFrameworkApplication.um,()=>new Date,()=>x.AFrameworkApplication.$y,Z,this.$a.og("Common.ISessionStatus"),()=>da.instance,this.$a.Tb("Postmessage.IHostPostmessenger"))}return new Ya(()=>
this.fb.Ad("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.fb.Ad("RenamedFileCheckerPingIntervalInMs",12E4),()=>x.AFrameworkApplication.um,()=>new Date,()=>x.AFrameworkApplication.$y,x.AFrameworkApplication.fa,x.AFrameworkApplication.rb,x.AFrameworkApplication.ti,this.$a.og("Common.ISessionStatus"),this.$a.Tb("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.fb.zu(Object(c.a)(this,this.mB,"onFullAppSettingsReady"))}mB(){const Z=x.AFrameworkApplication.sa.Qa.Bu;x.AFrameworkApplication.u8a()&&
O.instance.initialize(x.AFrameworkApplication.abc,Z?null:x.AFrameworkApplication.R2a,Z?null:x.AFrameworkApplication.gOd||CommonUIStrings.l_RenameFileTooltip)&&(this.$a.register($a,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Bc(()=>new $a(()=>x.AFrameworkApplication.userCanRename,()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.gwc,x.AFrameworkApplication.u8a,new b.a(()=>x.AFrameworkApplication.$y))).tc(),da.instance.Hg(),this.fb.qa("RenameDialogIsEnabled")&&
(this.$a.resolve("Common.App.Rename.RenameDialogFactory").initialize(x.AFrameworkApplication.um,x.AFrameworkApplication.abc),this.$a.resolve("Common.App.Rename.IRenameDialogActor").Hg()),this.$a.resolve("Common.App.Rename.IRenameFlyoutActor").Hg(),x.AFrameworkApplication.gwc&&this.$a.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.$a.resolve("Common.App.Rename.IRenameFlyoutActor").KNg())}dispose(){}}Object(r.a)(ba,"PackageManager",null,[4,5]);var ya=a(257);a.d(B,"a",function(){return V});
const V=()=>{Type.registerNamespace("Common.App.Rename");ya.a.instance.si(new ba,7)}},1485:function(r,B,a){a.r(B);r={};a.r(r);a.d(r,"RenameFileDialogCommandHandler",function(){return da});B=a(1179);var c=a(9),b=a(0),e=a(714),f=a(50),d=a(38),h=a(4),l=a(60),k=a(196),w=a(25),n=a(58);class x{constructor(ka){this.renameFileManager=ka}executeCommand(ka,L,fa){switch(L.command){case w.a.lia:return l.a.rg.Bu?2!==h.AFrameworkApplication.rb.$d(w.a.lia,2,fa)?n.Task.Ta(!0):k.a(L.command):k.a(L.command);case 1897077126:return this.renameFileManager.renameFile(fa,
L),n.Task.Ta(!0);default:return k.a(L.command)}}Ac(ka,L,fa,wa){switch(L.command){case w.a.lia:return l.a.rg.Bu;case 1897077126:return!!wa&&2===wa.jw}return!1}Rc(){return!1}Mc(){return!1}dispose(){this.renameFileManager=null}}Object(b.a)(x,"RenameFileCommandHandler",null,[222,3]);class m extends e.a{constructor(ka){super(ka)}ld(){const ka=f.GetServiceTaskFactory.create(this.$.da,119,this.ka,this.Na);d.TaskExtensions.za(ka,()=>{this.fd([new x(ka.result)])},this.ka,3)}static la(ka){e.a.Rd(118,new m(ka))}}
Object(b.a)(m,"RenameFileCommandHandlerFactory",e.a,[]);var u=a(91),t=a(228),y=a(232),v=a(15),A=a(31),z=a(84),C=a(387),H=a(73),I=a(379),S=a(198),P=a(96),D=a(255),G=a(1),E=a(22),O=a(290);class N{constructor(ka){this.$=ka}get Gkf(){return this.$.workbookContext.FileCoauthorable}get cCb(){return!1}get gxb(){return this.$.ea.amIAlone}get nPe(){if(this.gxb)return!0;for(const ka of this.$.ea.Do)if(!ka.SupportsRename)return!1;return!0}}Object(b.a)(N,"EwaCoauthManager",null,[793]);var J=a(63),W=a(74);class ea extends z.a{constructor(ka,
L){super();this.Ida=this.fOd=this.MZf=this.l9c=null;this.Hka=()=>{var fa=this.$.ea.Tm;if(fa&&fa.WorkbookFileName){var wa=A.a.Pp(fa.WorkbookFileName),oa=!!E.a.compare(this.$.workbookContext.WorkbookFileName,fa.WorkbookFileName,!1),xa=G.EwaSettings.xa(465)&&!!fa.BreadcrumbFolderUrl&&!!E.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,fa.BreadcrumbFolderUrl,!1);if(oa||xa)this.Ida={},this.Ida.NewFileName=wa,this.Ida.EditDocInClientUrl=fa.EditDocInClientUrl,this.Ida.DirectInvokeDAVUrl=
fa.DirectInvokeDAVUrl,this.Ida.DownloadACopyUrl=fa.DownloadACopyUrl,G.EwaSettings.xa(465)&&fa.BreadcrumbFolderUrl&&(this.Ida.BreadcrumbFolderName=fa.BreadcrumbFolderName,this.Ida.BreadcrumbFolderUrl=fa.BreadcrumbFolderUrl),fa=h.AFrameworkApplication.rb.$d(w.a.fileNameUpdate,2,wa),this.Ida=null,v.ULS.shipAssertTag(537154064,0,32===fa,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.rWi=(fa,wa,oa)=>{this.MZf=wa;this.fOd=oa;this.$.Ia.Hb(new P.a(1897077126,H.a.zb,
2,3,null),{["newFileName"]:fa})};this.qWi=fa=>{this.Ida&&fa(this.B8e(this.Ida),this.ns)};this.FHb=fa=>{D.a(fa)||!fa.Result?(fa=ea.KQh(fa),W.a(this.$).kd.WL([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.fOd(fa)):this.MZf(this.B8e(fa.Result),this.ns)};this.Z1i=()=>{this.fOd(5)};this.$=ka;this.ns=L;this.$.ea.ju(this.Hka)}initialize(){h.AFrameworkApplication.uac=this.rWi;h.AFrameworkApplication.kKa=this.qWi;this.l9c=h.AFrameworkApplication.$y;h.AFrameworkApplication.$y=new N(this.$)}dispose(){h.AFrameworkApplication.uac=
null;h.AFrameworkApplication.kKa=null;this.$.ea.Lv(this.Hka);h.AFrameworkApplication.$y=this.l9c;this.$=this.l9c=null;super.dispose()}renameFile(ka,L){const fa=ka.newFileName;if(fa&&(ka=A.a.Pp(this.$.workbookContext.WorkbookFileName),!G.EwaSettings.isChangeGateEnabled("OfficeVSO:7439298_CompareNewFileNameForRenameOperation")||E.a.compare(ka,fa,!1))){const wa=this.$.pa.va.$b();I.a(this.$.userOperationManager,(oa,xa,bb)=>{var Za=this.$.pa.va;oa=O.b(oa,this.FHb);xa=O.a(xa,this.Z1i);const La=Za.Oa(9,
wa);La.newFileName=fa;return J.g(Za,"RenameFile",La,oa,xa,bb,null,0)},oa=>new S.a(134,0,oa),L)}}xri(){return 32===h.AFrameworkApplication.rb.processAction(w.a.lia,1)}B8e(ka){var L=this.$.workbookContext;h.AFrameworkApplication.hZ=ka.DownloadACopyUrl;const fa=G.EwaSettings.xa(465)&&!!ka.BreadcrumbFolderUrl;fa&&(h.AFrameworkApplication.um.breadcrumbFolderName=ka.BreadcrumbFolderName,h.AFrameworkApplication.um.breadcrumbFolderUrl=ka.BreadcrumbFolderUrl,L.FullDocumentInfo.BreadcrumbFolderUrl=ka.BreadcrumbFolderUrl,
L.FullDocumentInfo.BreadcrumbFolderName=ka.BreadcrumbFolderName);L.FullDocumentInfo.BreadcrumbDocName=ka.NewFileName;C.d(L,ka.NewFileName);L={};L.NewName=ka.NewFileName;L.DirectInvokeDavUrl=ka.DirectInvokeDAVUrl;L.EditDocInClientUrl=ka.EditDocInClientUrl;fa&&(L.BreadcrumbFolderName=ka.BreadcrumbFolderName,L.BreadcrumbFolderUrl=ka.BreadcrumbFolderUrl);L.OperationResult=0;return L}static KQh(ka){switch(ka.Errors[0].MessageId){case -414480287:ka=2;break;case 650565124:ka=1;break;case 1636785843:ka=6;
break;case -782844485:ka=4;break;default:ka=5}return ka}}Object(b.a)(ea,"RenameFileManager",z.a,[754,3]);var R=a(53);class Y extends t.a{constructor(ka){super();this.UY=this.renameFileManager=null;this.$=ka;this.Gb()}create(){if(!this.UY){const ka=y.a.b2a(R.b(),this.ka,"Task","IRenameFileManager");this.UY=ka.task;const L=f.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Na),fa=f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);d.TaskExtensions.za(d.TaskExtensions.Md([fa,L],this.ka),
()=>{const wa=new ea(this.$,L.result);this.$.da.Ha(120,wa);ka.setResult(wa)},this.ka,3)}this.UY.continueWith(ka=>{this.qb(ka.result)})}dispose(){u.a.Ja(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static la(ka){ka.da.Ha(119,new Y(ka))}}Object(b.a)(Y,"RenameFileManagerServiceFactory",t.a,[]);var U=a(70);t=a(155);z=a(153);a=a(54);let da=class{constructor(ka=h.AFrameworkApplication.rb){this.Uh=ka}Mc(){return!1}executeCommand(ka,L,fa){return 2!==this.Uh.$d(w.a.hcg,2,fa)?
n.Task.Ta(!0):k.a(L.command)}Ac(ka,L){return 1204860550===L.command}Rc(){return!1}};da=Object(t.b)([Object(z.d)(a.H)],da);Object(b.a)(da,"RenameFileDialogCommandHandler",null,[222]);class T extends e.a{constructor(ka){super(ka)}ld(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na),()=>{this.fd([new da(h.AFrameworkApplication.rb)])},this.ka,3)}static la(ka){e.a.Rd(131,new T(ka))}}Object(b.a)(T,"RenameFileDialogCommandHandlerFactory",e.a,[]);String(r);window.___1678693023746_closurehack=
r;Type.registerNamespace("_Ewa");Object(B.a)();(()=>{c.a.Fa(ka=>{Y.la(ka);m.la(ka)})})();(()=>{c.a.Fa(ka=>{Object(U.b)("OfficeVSO:7624952_NewRenameFileDialogCommandHandlerService")||T.la(ka)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/fca446f2ad5350b606ad005afb9d32c4/EwaDSEsNext.rn.js.map