'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1081:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1082:function(r,B,a){a.d(B,"a",function(){return h});r=a(0);var c=a(15),b=a(88);B=a(156);var e=a(4),f=a(47),d=a(31);class h extends B.a{constructor(l,k,w,n,x,m,u=null){super();this.ZI=null;this.La=k;this.yX=n;this.Rga=m;this.fb=l;this.Ls=x;this.ff=w;this.Wjb=this.fb.qa("SaveToHostWithExtraCharsInFileName");this.Ih=u;this.wc(1,CommonUIStrings.l_SaveButtonLabel)}get sa(){return this.ff}pOe(l,k){this.gL(1,!!l&&l!==k);this.ZI=document.getElementById(h.cZe);f.a.addHandler(this.ZI,"change",Object(b.a)(this,
this.pqc,"onFileNameChange"));f.a.addHandler(this.ZI,"input",Object(b.a)(this,this.pqc,"onFileNameChange"));this.ZI.focus()}$ac(l){return this.Wjb?(new RegExp("["+this.C$b('\\/:*?"<>|')+"]")).test(l):(new RegExp("["+this.C$b('\\/:*?"<>|#{}%~&')+"]")).test(l)}C$b(l){return l.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}amd(){const l=d.a.Pp(e.AFrameworkApplication.um.ln);this.gL(1,!!this.ZI&&""!==this.ZI.value&&this.ZI.value!==l)}pqc(){this.ZI&&window.setTimeout(()=>{this.amd()},0)}Zac(l,k){if(1!==
l)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{l=k[h.cZe];k=h.ONf in k?k[h.ONf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",d.a.Juc(l),k);const w=d.a.k4(e.AFrameworkApplication.fileName);(l=l?l.trim():null)&&""!==l&&""!==w||1===this.sa.state?this.$ac(l)?this.Ls.create().displayError(1,l,k):this.Rga.Poa(l+w,k,this.Ih):this.Ls.create().displayError(2,l,k)}}dispose(){this.ZI&&
(f.a.removeHandler(this.ZI,"change",Object(b.a)(this,this.pqc,"onFileNameChange")),f.a.removeHandler(this.ZI,"input",Object(b.a)(this,this.pqc,"onFileNameChange")),this.ZI=null);super.dispose()}}h.cZe="txtFileName";h.ONf="chkOverwrite";Object(r.a)(h,"FileNameDialogBase",B.a,[])},1083:function(r,B,a){a.d(B,"a",function(){return n});r=a(0);var c=a(15),b=a(167),e=a(88),f=a(4),d=a(655),h=a(857),l=a(383),k=a(111),w=a(25);class n{constructor(x,m,u,t){this.nYb=null;this.uGg=x;this.fb=u;this.Ahe=m;this.efe=
new b.a;this.Ah=t}T8a(){return this.fb.qa("SaveToCloudStorageUIIsEnabled")}S1e(){return w.a.saveToCloudStorage}P3b(){l.a.cMd(Object(e.a)(this,this.P3f,"saveToCloudActionDispatcher"));l.a.Gad([new h.a(w.a.saveToCloudStorage,k.a.frame,0)],this.Ahe.u5a())}Hg(){const x=this.Ahe.u5a();x?(x.P9(()=>{this.efe.setResult(!0)}),this.P3b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}IVf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}P3f(x,
m,u,t,y){return m.contextId!==k.a.frame||x!==this.S1e()?2:this.T8a()?1===u?d.SessionStatusManager.instance.h6a||f.AFrameworkApplication.h5?8:32:2===u?(this.IVf(),y&&y.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ah&&(this.nYb=this.Ah.Kc("DialogShown","SaveToOneDriveReponseTime")),this.efe.task.continueWith(()=>{this.nYb&&(this.nYb.stop(),this.nYb=null);this.uGg.start(y)}),32):8:8}}Object(r.a)(n,"SaveToCloudStorageActor",null,[393])},
1084:function(r,B,a){a.d(B,"a",function(){return x});r=a(0);var c=a(15),b=a(88),e=a(1085),f=a(4),d=a(40),h=a(41),l=a(244),k=a(381),w=a(172),n=a(782);class x{constructor(m,u,t,y,v){this.P8=this.Km=this.PDa=null;this.xEa=!1;this.Ih=this.Qga=null;this.dWc=m;this.Kmb=u;this.Ls=t;this.ff=y;this.Ah=v}KOb(){this.ff&&1===this.ff.state||(this.Km=this.Kmb(),this.Km.message=CommonUIStrings.l_CommentProgressTooltip,this.Km.Rb=5,this.Km.yt=!1,this.Km.PBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}EJa(){this.Km&&
(this.Km.close(),this.Km=null)}iS(){1!==f.AFrameworkApplication.sa.state&&this.Ls().displayError(e.a.default)}aRa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");h.a.nf(this.P8,h.a.qX(3),void 0,"UploadToCloudManager.RedirectToFolder")}$Qa(m){let u=!1,t=!1;f.AFrameworkApplication.fa&&(u=f.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),t=f.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,f.AFrameworkApplication.sa&&f.AFrameworkApplication.sa.Qa&&
1===f.AFrameworkApplication.sa.Qa.ri?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",m,u);if(u&&t){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const y={};y[k.a.UQa]="1";y[k.a.documentUrl]=m;f.AFrameworkApplication.JQ().execute(v=>{v.uj(w.a.fZ,y)})}else h.a.nf(m,h.a.qX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}Poa(m,u,t=null,y=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ah&&(this.Qga=
this.Ah.Kc("DialogShown","SaveToOneDriveUploadTime"));this.KOb();this.P8=u;this.PDa=this.dWc.create(m,t,y);this.Ih=y;this.oQ()}oQ(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.PDa.execute(Object(b.a)(this,this.M2i,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.L2i,"onSaveToCloudUploadFailed"))}M2i(m){this.EJa();this.xEa=!1;if(m&&m.data&&m.data.me){var u;if(({ot:u}=d.d(m.data.me)).returnValue)if(m=u,m.StatusCode!==l.a.ZO&&m.StatusCode!==l.a.Otb)c.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.iS();else{c.ULS.sendTraceTag(6590603,216,f.AFrameworkApplication.sa&&f.AFrameworkApplication.sa.Qa&&1===f.AFrameworkApplication.sa.Qa.ri?15:50,"UploadToCloudManager upload success.");try{m.NewDocumentUrl&&""!==m.NewDocumentUrl?this.$Qa(m.NewDocumentUrl):this.aRa()}catch(t){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",t.toString())}this.LIb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
{["ResponseData"]:n.a.Ngb(m.data.me)}),this.iS()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.iS()}L2i(m){5!==m.data.status&&12!==m.data.status||this.xEa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",m.data.status),this.EJa(),this.iS(),this.LIb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.xEa=!0,this.oQ())}LIb(){this.Qga&&(this.Qga.stop(),this.Qga=null)}}Object(r.a)(x,
"UploadToCloudManager",null,[384])},1085:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{}c.default=0;Object(r.a)(c,"SaveToCloudErrorCodes",null,[])},1086:function(r,B,a){a.d(B,"a",function(){return h});r=a(0);var c=a(15),b=a(88),e=a(1085),f=a(4),d=a(86);class h{constructor(l,k,w,n,x,m){this.Ih=null;this.lHg=l;this.d2=k;this.fob=w;this.fb=n;this.QSb=x;this.Ls=m}start(l){this.Ih=l;if("SharePointOnlineConsumer"===this.fb.Wa("FileSource")){const k=d.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");
if(k){k.start(null,l);return}}this.d2.QMa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.f4g()):(c.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.lHg.create().hQ()}vj(){this.Ls().displayError(e.a.default)}f4g(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let l={["client_id"]:this.fb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.QSb||
2===this.QSb)l={["client_id"]:this.fb.appSettings.UploadToSkyDriveClientId};WL.init(l);c.ULS.sendTraceTag(6590562,216,f.AFrameworkApplication.sa&&f.AFrameworkApplication.sa.Qa&&1===f.AFrameworkApplication.sa.Qa.ri?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.r6,"onFailure"))}catch(l){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",
l,l.stack),this.vj()}}onSuccess(l){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");l&&l.data&&l.data.folders&&this.fob.Poa(l.data.folders[0].id,l.data.folders[0].urls.viewInBrowser,null,this.Ih)}r6(l){if(l&&l.error){if("user_canceled"===l.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",l.error.code,
l.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.vj()}}Object(r.a)(h,"SaveToCloudManager",null,[390])},1087:function(r,B,a){a.d(B,"a",function(){return f});r=a(0);var c=a(15),b=a(41),e=a(82);a=a(727);class f extends a.a{constructor(d,h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.Fya;this.Gwa=!0}get linkText(){return f.iwf}Pma(d){super.Pma(d);b.a.openWindow(4,
e.a.wH(f.hwf))}pD(d){super.pD(d);f.mzd&&f.mzd(null)}static initialize(d,h,l,k){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.Fya=d;f.iwf=h;f.hwf=l;f.mzd=k}}f.Fya=null;f.iwf=null;f.hwf=null;f.mzd=null;Object(r.a)(f,"WacGdprNoticeBusinessBarEntry",a.a,[])},1088:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{}c.Gxh="ewa-bb";c.Hxh="ewa-bb-entry";c.Ixh="ewa-bb-react";c.$Se="ewa-bb-entry-body";c.fTe="ewa-bb-icon";c.bTe="ewa-bb-entry-icon";c.eTe=
"ewa-bb-entry-title";c.dTe="ewa-bb-entry-message";c.J$b="ewa-bb-entry-button";c.cTe="ewa-bb-entry-link";c.aTe="ewa-bb-entry-close";c.K$b="ewa-bb-entry-button-holder";c.ZSe="ewa-bb-content";Object(r.a)(c,"CssClassNames",null,[])},1089:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);a=a(727);class c extends a.a{constructor(b,e){super(b,e);this.hs=!0;this.title=c.Upa;this.message=c.Spa}get actionButton(){return c.Rpa}Xm(b){super.Xm(b);(b=c.Tpa)&&b(null)}static initialize(b,e,f,d){c.Upa=b;c.Spa=
e;c.Rpa=f;c.Tpa=d}}c.Upa=null;c.Spa=null;c.Rpa=null;c.Tpa=null;Object(r.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1090:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);a=a(727);class c extends a.a{constructor(b,e){super(b,e);this.hs=!0;this.title=c.Upa;this.message=c.Spa}get actionButton(){return c.Rpa}Xm(b){super.Xm(b);(b=c.Tpa)&&b(null)}static initialize(b,e,f,d){c.Upa=b;c.Spa=e;c.Rpa=f;c.Tpa=d}}c.Upa=null;c.Spa=null;c.Rpa=null;c.Tpa=null;Object(r.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",
a.a,[])},1091:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);a=a(727);class c extends a.a{constructor(b,e){super(b,e);this.hs=!0;this.title=c.Upa;this.message=c.Spa}get actionButton(){return c.Rpa}Xm(b){super.Xm(b);(b=c.Tpa)&&b(null)}static initialize(b,e,f,d){c.Upa=b;c.Spa=e;c.Rpa=f;c.Tpa=d}}c.Upa=null;c.Spa=null;c.Rpa=null;c.Tpa=null;Object(r.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1092:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);a=a(727);class c extends a.a{constructor(b,
e){super(b,e);this.hs=!0;this.title=c.jFb;this.message=c.Fya}get actionButton(){return c.Y9a}Xm(b){super.Xm(b);c.Hya&&c.Hya(null)}static initialize(b,e,f,d){c.jFb=b;c.Fya=e;c.Y9a=f;c.Hya=d}}c.jFb=null;c.Fya=null;c.Y9a=null;c.Hya=null;Object(r.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1093:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);a=a(727);class c extends a.a{constructor(b,e){super(b,e);c.Y9a&&c.Hya&&(this.hs=!0);this.title=c.jFb;this.message=c.Fya}get actionButton(){return c.Y9a}Xm(b){super.Xm(b);
c.Hya&&c.Hya(null)}static initialize(b,e,f,d){c.jFb=b;c.Fya=e;c.Y9a=f;c.Hya=d}}c.jFb=null;c.Fya=null;c.Y9a=null;c.Hya=null;Object(r.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1095:function(r,B,a){a.d(B,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.Vhb=function(){function b(){return k()&&(v()||3<=(u()?A("version/"):0))}function e(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}
function d(){Ja||(Ja=!0,ab=h("Windows Phone"))}function h(pb){pb=(new RegExp(pb+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var kb=-1;return null!=pb&&2<=pb.length&&(kb=parseFloat(pb[1]),isNaN(kb)&&(kb=-1)),kb}function l(){return"function"==typeof navigator.msLaunchUri&&!f()&&!y()&&!w()}function k(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function w(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function n(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||
0<=window.navigator.userAgent.indexOf("Trident/")}function x(){return n()?8==window.document.documentMode:!1}function m(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function u(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function t(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function y(){var pb=window.navigator.userAgent.toLowerCase();return 0<=pb.indexOf("android")&&0<=pb.indexOf("chrome")}function v(){return 3<=(m()?A("firefox/"):0)}function A(pb){var kb=
window.navigator.userAgent.toLowerCase(),Cb=kb.indexOf(pb),ob,qa;return 0<=Cb?(ob=Cb+pb.length,qa=kb.length,parseInt(kb.substring(ob,qa))):0}function z(pb,kb,Cb,ob,qa){if(ob&&null!=kb)kb();else if(l())navigator.msLaunchUri(pb,kb,Cb);else if(!(t()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&k())||w())H(pb,kb,Cb);else if(t()&&qa)a:{try{window.open(pb,"_self")}catch(ma){null!=Cb&&Cb();break a}null!=kb&&kb()}else C(pb,kb,
Cb)}function C(pb,kb,Cb){var ob=document.getElementById("OICLinkTag"),qa;null==ob&&(ob=document.createElement("a"),ob.id="OICLinkTag",ob.style.visibility="hidden",ob.href="",ob.target=0==(Jb.Options&xb.SupportsTopTargetNavigation)||Jb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(ob),null!=ob.addEventListener&&ob.addEventListener("click",function(ma){null!=ma.stopPropagation&&ma.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(qa=function(ma){var Ga=document.createEvent("MouseEvent");
return Ga.initMouseEvent(ma,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Ga},qa.prototype=Event.prototype,window.MouseEvent=qa),ob.href=pb,ob.dispatchEvent(new MouseEvent("click"))}catch(ma){null!=Cb&&Cb();return}null!=kb&&kb()}function H(pb,kb,Cb){var ob=document.getElementById("OICFrame");null==ob&&(ob=document.createElement("iframe"),ob.className="ObjectInDialog",ob.style.visibility="hidden",ob.src="about:blank",document.body.appendChild(ob),ob.id="OICFrame");try{ob.contentWindow.location.href=pb}catch(qa){null!=
Cb&&Cb();return}null!=kb&&kb()}function I(pb){return 0!=(pb.Options&xb.SkipProtocolHandler)||x()}function S(pb){return pb===wb.ReadOnly||pb===wb.ReadWrite}function P(pb,kb,Cb,ob){var qa,ma;try{if(qa=new ActiveXObject(bb),qa)return ma=qa.ViewDocument3(window.self,pb,kb,ob),ma?(L(za.O14ActiveX),rb.None):rb.Failed}catch(Ga){}if(xb.O14Only===(Cb&xb.O14Only))return Jb.DescriptiveUnattemptedEnums?rb.O14AttemptFailure:rb.Unattempted;try{if(qa=new ActiveXObject(Za),qa)return ma=qa.ViewDocument3(window.self,
pb,kb,ob),ma?(L(za.O12ActiveX),rb.None):rb.Failed}catch(Ga){}if(xb.O12UpOnly===(Cb&xb.O12UpOnly))return Jb.DescriptiveUnattemptedEnums?rb.O12UpOnlyFail:rb.Unattempted;try{if(qa=new ActiveXObject(La),qa)return ma=S(kb)?qa.ViewDocument2(window.self,pb,ob):qa.EditDocument2(window.self,pb,ob),ma?(L(za.O11ActiveX),rb.None):rb.Failed}catch(Ga){}return Jb.DescriptiveUnattemptedEnums?rb.ActiveXUnattempted:rb.Unattempted}function D(pb,kb,Cb,ob,qa){var ma,Ga,vb;pb==Aa.Visio&&Cb==wb.ReadWrite&&(Cb=wb.WriteOnly);
pb=qa;(ob=ob||f()&&!(d(),8<=ab))||(ma="",ma+=S(Cb)?Ya+Da:ba,ma+=ya,pb+=E(ma));pb+=E(kb);Jb.NewTelemetryDataIsEnabled&&(Ga=Jb.SessionOrigin?"|or|"+Jb.SessionOrigin:"",Ga+=Jb.ClickTime?"|ct|"+Jb.ClickTime:"",Ga+=Jb.CorrelationId?"|cid|"+Jb.CorrelationId:"",pb+=E(Ga),Jb.CorrelationIdForWinClient&&(pb+=E(Jb.CorrelationIdForWinClient)));kb=window.location.href;Cb=Z;ob=kb.toLowerCase().indexOf("&"+Cb+"=");var Ka;Cb=-1==ob?void 0:(vb=ob+(Cb.length+2),Ka=kb.indexOf("&",vb),-1==Ka)?kb.substr(vb):kb.substring(vb,
Ka);if(null!=Cb&&"undefined"!=typeof Cb){vb="";try{vb=decodeURIComponent(Cb)}catch(Pa){}0<vb.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(vb)&&(pb+=V,pb+=vb)}return pb}function G(pb,kb,Cb,ob,qa,ma){var Ga=da(pb),vb;return null==Ga?(fa(Jb.DescriptiveUnattemptedEnums?rb.ProtocolHandlerIsNull:rb.Unattempted,Jb.Application),!1):(vb=D(pb,kb,Cb,ob,Ga),z(vb,O,N,qa,ma),!0)}function E(pb){if(k()&&t()){var kb="";try{kb=decodeURI(pb)}catch(Cb){}if(kb==pb)return encodeURI(pb)}return pb}
function O(){L(za.ProtocolHandler)}function N(){Jb.Options|=xb.SkipProtocolHandler;ka(Jb,eb,Eb)}function J(){null!=Wb&&Wb(za.RoamingProtocolHandler)}function W(){null!=Ab&&Ab(rb.ControlNeeded)}function ea(){var pb=document.getElementById(cb),kb;if(null==pb){if(kb=va,k()&&3<=(u()?A("version/"):0)&&R(Ba,!0)&&(kb=Ba),!R(kb,!0))if(k()&&R($a,!0))kb=$a;else return null;pb=document.createElement("object");pb.id=cb;pb.type=kb;pb.style.width="0px";pb.style.height="0px";pb.style.setProperty("visibility","hidden",
"");document.body.appendChild(pb);pb=document.getElementById(cb)}return pb}function R(pb,kb){var Cb=window.navigator.mimeTypes,ob;return null==Cb?!1:(ob=Cb[pb],ob)?kb&&!ob.enabledPlugin?!1:!0:!1}function Y(pb){try{if(null!=new ActiveXObject(pb))return!0}catch(kb){}return!1}function U(pb){switch(pb){case Aa.OneNote:return ta;default:return""}}function da(pb){if(pb!=Aa.OneNote&&f()&&!(d(),8<=ab))return"office:";switch(pb){case Aa.Excel:return"ms-excel:";case Aa.OneNote:return"onenote:";case Aa.PowerPoint:return"ms-powerpoint:";
case Aa.Visio:return"ms-visio:";case Aa.Word:return"ms-word:";case Aa.Project:return"ms-project:";case Aa.Publisher:return"ms-publisher:";case Aa.Infopath:return"ms-infopath:";case Aa.Access:return"ms-access:";default:return""}}function T(pb){switch(pb){case Aa.Excel:return"root\\office15\\excel.exe";case Aa.PowerPoint:return"root\\office15\\powerpnt.exe";case Aa.Visio:return"root\\office15\\visio.exe";case Aa.Word:return"root\\office15\\winword.exe";case Aa.Project:return"root\\office15\\winproj.exe";
case Aa.Publisher:return"root\\office15\\mspub.exe";case Aa.Infopath:return"root\\office15\\infopath.exe";case Aa.Access:return"root\\office15\\msaccess.exe";default:return null}}function ka(pb,kb,Cb){if(Jb=pb,eb=kb,Eb=Cb,pb.DocumentUrl){var ob=Cb=kb=pb.DocumentUrl;try{ob=decodeURIComponent(pb.DocumentUrl)}catch(Pa){}try{Cb=encodeURI(pb.DocumentUrl)}catch(Pa){}Jb.NewTelemetryDataIsEnabled||(kb=kb+""+pb.CorrelationIdForWinClient,ob+=pb.CorrelationIdForWinClient,Cb+=pb.CorrelationIdForWinClient);pb.Mode===
wb.ReadWrite&&xb.CheckoutRequired===(pb.Options&xb.CheckoutRequired)&&(pb.Mode=wb.ForceCheckout);xb.HostIsEditOnly===(pb.Options&xb.HostIsEditOnly)&&(pb.Mode=wb.WriteOnly);if(I(pb)?0:k()&&(pb.Application==Aa.OneNote||R(Ea,!1)||R(pa,!1))||l()||y()||!(b()||v()||"ActiveXObject"in window&&!f()||t())||15<=wa())G(pb.Application,pb.EncodeUrl?Cb:kb,pb.Mode,pb.Application==Aa.OneNote,pb.SilentExternalHandler,pb.NavigateUsingWindowOpen);else{var qa;if(qa=x())a:{var ma=pb.EncodeUrl?kb:ob,Ga=pb.Mode,vb=U(pb.Application);
try{qa=(new ActiveXObject(xa)).ViewDocument3(window.self,ma,Ga,vb);break a}catch(Pa){}qa=!1}if(qa)L(za.O15ActiveX);else{if(b()||v()){var Ka=pb.EncodeUrl?kb:ob;ob=pb.Mode;qa=U(pb.Application);ma=ea();if(null==ma)Ka=Jb.DescriptiveUnattemptedEnums?rb.PluginIsNull:rb.Unattempted;else{Ga=!1;try{Ga=ma.ViewDocument3(window.self,Ka,ob,qa)}catch(Pa){}if(!Ga)try{Ga=S(ob)?ma.ViewDocument2(window.self,Ka,qa):ma.EditDocument2(window.self,Ka,qa)}catch(Pa){}Ka=Ga?(L(za.NpapiPlugin),rb.None):rb.Failed}}else{try{Ka=
new ActiveXObject(ib),null!=Ka&&Ka.SaveSSOCreds()}catch(Pa){}Ka=P(pb.EncodeUrl?kb:ob,pb.Mode,pb.Options,U(pb.Application))}if(Ka!=rb.None){if(ob=pb.CouldUseRoamingApps)Gb||(Gb=!0,Nb=h("Windows NT")),ob=6.1<=Nb&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(n()||v()||t());if(ob&&pb.Application!=Aa.OneNote){if(!c.Vhb.qck()){fa(rb.ControlNeeded,Jb.Application);return}if(pb.RoamingAppsLauncher){"undefined"==typeof pb.RoamingAppsLauncher||null==pb.RoamingAppsLauncher?fa(Jb.DescriptiveUnattemptedEnums?
rb.RoamingLauncherIsNull:rb.Unattempted,Jb.Application):"undefined"==typeof pb.RoamingBitsUrl||null==pb.RoamingBitsUrl?c.Vhb.Bck(pb.DocumentUrl,pb.RoamingAppsLauncher,pb.Application,pb.ApplicationParameters,eb,Eb):c.Vhb.dtg(pb.DocumentUrl,pb.RoamingAppsLauncher,pb.RoamingApplicationExe,pb.ApplicationParameters,pb.RoamingPlatform,pb.RoamingBitsUrl,eb,Eb);return}if(!pb.ContinueIfLauncherIsNull){fa(rb.LauncherNeeded,Jb.Application);return}}xb.NoProtocolHandlerFallback==(pb.Options&xb.NoProtocolHandlerFallback)||
I(pb)||n()||k()&&!(Jb.DescriptiveUnattemptedEnums?Ka>=rb.O14Unattempted&&Ka<=rb.DocumentUrlIsNull:Ka==rb.Unattempted)?fa(Ka,Jb.Application):G(pb.Application,pb.EncodeUrl?Cb:kb,pb.Mode,pb.Application==Aa.OneNote,pb.SilentExternalHandler,pb.NavigateUsingWindowOpen)}}}}else fa(Jb.DescriptiveUnattemptedEnums?rb.DocumentUrlIsNull:rb.Unattempted,Jb.Application)}function L(pb){null!=eb&&eb(pb)}function fa(pb,kb){"undefined"==typeof kb&&(kb=null);null!=Eb&&Eb(pb,kb)}function wa(){var pb=0;if(b()||v()||t()){var kb=
ea();try{null!=kb&&(pb=kb.GetOfficeVersion())}catch(Cb){}}else Y(xa)?pb=15:Y(bb)?pb=14:Y(Za)?pb=12:Y(La)&&(pb=11);return pb}function oa(){return k()&&(R(va,!0)||R(Ba,!0))}var xa="SharePoint.OpenDocuments.5",bb="SharePoint.OpenDocuments.4",Za="SharePoint.OpenDocuments.3",La="SharePoint.OpenDocuments.2",va="application/x-sharepoint",Ba="application/x-sharepoint-webkit",Ea="application/x-sharepoint-protocolhandler",pa="application/x-sharepoint-webkit-protocolhandler",$a="application/officelive",cb="npSharePointPlugin",
ib="IDBHO.IDBHOCtrl",ta="OneNote.Notebook",Ya="ofv|",Da="ofc|",ba="ofe|",ya="u|",V="|f|",Z="wdlor",ja="",la="",ua="",eb,Eb,Wb,Ab,Jb,Gb,Nb,Ja,ab,wb={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},xb={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},rb={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,
PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},za={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Aa={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:wb,OpenDocumentOptions:xb,OpenDocumentFailureType:rb,OpenDocumentControl:za,
OfficeApplication:Aa,EditDocumentInClient:ka,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Aa.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=
this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:wa,IsO14MacPluginInstalled:oa,OfferOfficeInDialog:function(){return e()&&11>=wa()},OfferOfficeNoIntrusive:function(){return e()&&15>wa()},OfferMacOffice:function(){return k()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!oa()},InstallRoamingControl:function(){m()?window.InstallTrigger.install({Office:{URL:la}}):H(ua,null,null)},CanUseRoamingControl:function(){var pb,kb,Cb;if(l())return!0;
if(t())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(m())return pb=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(pb),kb=document.createEvent("Events"),kb.initEvent("RoamingOfficeInstalled",!0,!1),pb.dispatchEvent(kb),!!pb.getAttribute("installed");if(n())try{return Cb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Cb.HrExists()}catch(ob){}return!1},InitUrls:function(pb,
kb,Cb){ja=pb;la=Cb;ua=kb},LaunchRoamingApps:function(pb,kb,Cb,ob,qa,ma){c.Vhb.dtg(pb,kb,T(Cb),ob,"x86",ja,qa,ma)},LaunchRoamingApps2:function(pb,kb,Cb,ob,qa,ma,Ga,vb){var Ka="",Pa;if(null!=ob&&(Ka+=" "+ob),null!=pb&&(Ka+=' "'+pb+'"'),l()||t())Wb=Ga,Ab=vb,Ga='office: "'+(ma+'" "')+(Cb+'" "ROAMING"'),Ga+=' "'+kb+'"',Ga+=' "'+qa+'"',Ga+=" "+Ka,z(Ga,J,W,!1,!1);else if(m())pb=document.createElement("RoamingExtensionElement"),pb.setAttribute("cabUrl",ma),pb.setAttribute("app",Cb),pb.setAttribute("licensingEntitlements",
kb),pb.setAttribute("platform",qa),pb.setAttribute("args",Ka),document.documentElement.appendChild(pb),kb=document.createEvent("Events"),kb.initEvent("RoamingOfficeLaunch",!0,!1),pb.dispatchEvent(kb),null!=Ga&&Ga(za.RoamingFFExtension);else if(n()){if(Pa=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Pa)try{Pa.HrConfigureSingle(ma,Cb,kb,qa,Ka),null!=Ga&&Ga(za.RoamingActiveX)}catch(fb){}}else null!=vb&&vb(rb.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:C,
OpenDocumentWithProtocolHandler:G,OpenDocumentWithProtocolHandlerNoCallBack:function(pb,kb,Cb,ob){var qa=da(pb),ma;return null==qa?(fa(Jb.DescriptiveUnattemptedEnums?rb.ProtocolHandlerNoCallbackIsNull:rb.Unattempted,Jb.Application),!1):(ma=D(pb,kb,Cb,ob,qa),z(ma,null,null,!1,!1),!0)}}}();c.ClientUtils=c.Vhb},1096:function(r,B,a){a.d(B,"a",function(){return b});r=a(0);var c=a(41);class b{constructor(e,f){this._url=e;this.uEg=f}Mxe(){}p$c(){this.uEg?c.a.downloadFile(this._url):c.a.nf(this._url,"_blank",
void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(r.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,[170,3])},1097:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1098:function(r,B,a){a.d(B,"a",function(){return d});r=a(0);var c=a(1229),b=a(4),e=a(56),f=a(86);class d{constructor(h,l,k,w,n,x){this.XX=h;this.YX=l;this.sNc=k;this.$D=w;this.iUb=n;this.OVa=x}get Cbg(){return!this.YX&&!this.sNc}get YAf(){return 2===this.OVa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get zSe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get tff(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Mwa(){return CommonUIStrings.l_OICErrorHelpLink}get Xdf(){return"OICFailure"}get icon(){return 3}get t_b(){return 2===
this.OVa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get ll(){return CommonUIStrings.l_DefaultDialogTitle}nhj(h){this.vBf(h)}$Di(h){this.vBf(h)}vBf(h){let l=10;1===h?(f.a.instance.resolve("Common.IOfficeTrialExperience").wmc(this.OVa),l=3):2===h&&((!this.sNc||this.sNc(this.$D))&&this.YX&&c.a.instance.uih(this.YX,this.XX,this.$D),l=5);(0===h||1===h)&&this.XX&&this.XX(this.$D);b.AFrameworkApplication.xwc(e.a.jNf,this.iUb,l);this.dispose()}dispose(){this.$D=
this.YX=this.XX=null}}Object(r.a)(d,"AOICErrorDialogWithTrial",null,[3])},1099:function(r,B,a){a.d(B,"a",function(){return d});r=a(0);var c=a(1394),b=a(4),e=a(40),f=a(82);class d{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}cSd(){return e.c([this.gba(),this])}execute(h,l,k){let w="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=f.a.fl(w,"wdEnableRoaming","1"));b.AFrameworkApplication.Hd.Mm(w,2,this.cSd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.Ayb(),h,l,k,void 0,void 0,void 0,void 0,"6")}}Object(r.a)(d,"ARoamingAppsRequest",null,[])},1100:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1101:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1102:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1108:function(r,B,a){a.d(B,"a",function(){return b});r=a(0);var c=a(15);class b{constructor(e){this.isEnabled=Boolean.parse(e.DirectPrintIsEnabled||"false");Boolean.parse(e.DirectPrintProbeIsEnabled||"false");this.Kui=Boolean.parse(e.DirectPrintEnabledForInternetExplorer||"false");this.ZTa=(e.DirectPrintSupportedMimeTypes||
"").split(b.U9c);this.$Ta=(e.DirectPrintSupportedPlugins||"").split(b.U9c);this.Gii=(e.DirectPrintImmersivePreviewPlugins||"").split(b.U9c);this.nkf=Boolean.parse(e.DirectPrintEnabledForEdge||"false");this.eri=Boolean.parse(e.ChromePrintLayoutFixIsEnabled||"false");this.M7g=parseInt(e.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.PAd=14;this.nyf=14394;if(e=e.DirectPrintMinimalSupportedEdgeVersion){const f=e.split(".");2===f.length?(this.PAd=parseInt(f[0]),this.nyf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",e)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.U9c=",";Object(r.a)(b,"DirectPrintBrsSettings",null,[])},1178:function(r,B,a){var c=a(9),b=a(0),e=a(15),f=a(4),d=a(1377),h=a(714),l=a(50),k=a(38),w=a(1),n=a(928),x=a(71),m=a(44),u=a(196),t=a(21),y=a(380),v=a(580);class A{constructor(mb,Ob){this.vJd=0;this.Fbe=!1;this.eA=mb;this.ignorePrintArea=
Ob}get eA(){return this.vJd}set eA(mb){0<=mb&&2>=mb?this.vJd=mb:(e.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.vJd=1)}get ignorePrintArea(){return this.Fbe}set ignorePrintArea(mb){mb||!mb?this.Fbe=mb:e.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(A,"PdfPrintDialogBrowserSessionState",null,[]);var z=a(7),C=a(141),H=a(178),I=a(102),S=a(1431);class P{constructor(mb,Ob){this.multiRange=null;this.addToPrintArea=
!1;this.multiRange=mb;this.addToPrintArea=Ob}}Object(b.a)(P,"MacroRecorderPrintAreaSetPayload",null,[123]);var D=a(379),G=a(198),E=a(11),O=a(14),N=a(290),J=a(68);class W{constructor(mb){this.sharedSheetCell=null;this.sharedSheetCell=mb}}Object(b.a)(W,"MacroRecorderPageBreakInsertedPayload",null,[123]);class ea{constructor(mb){this.sharedSheetCell=null;this.sharedSheetCell=mb}}Object(b.a)(ea,"MacroRecorderPageBreakRemovedPayload",null,[123]);class R{constructor(mb){this.sheetName=null;this.sheetName=
mb}getSheetName(){return this.sheetName}}Object(b.a)(R,"MacroRecorderPageBreaksAllResetPayload",null,[123]);class Y{constructor(mb){this.sheetName=null;this.sheetName=mb}getSheetName(){return this.sheetName}}Object(b.a)(Y,"MacroRecorderPrintAreaClearedPayload",null,[123]);var U=a(63);const da=(mb,Ob,Ta,sb,zb,db,jb,Ub=null)=>{Ub=mb.Oa(9,Ub);Ub.sheetName=Ob;Ub.printSettings=Ta;return U.g(mb,"SetSheetPrintSettings",Ub,sb,zb,db,jb,0)},T=(mb,Ob,Ta,sb,zb,db,jb=null)=>{jb=mb.Oa(1,jb);jb.ConvertInParameters=
Ob;return U.g(mb,"ConvertWorkbookToPrintPdf",jb,Ta,sb,zb,db,4)},ka=(mb,Ob,Ta,sb,zb,db,jb,Ub=null)=>{Ub=mb.Oa(1,Ub);Ub.sheetName=Ob;Ub.printOptions=Ta;return U.g(mb,"SetPrintOptions",Ub,sb,zb,db,jb,0)},L=(mb,Ob,Ta,sb,zb,db,jb,Ub=null)=>{Ub=mb.Oa(1,Ub);Ub.sheetName=Ob;Ub.locale=Ta;return U.g(mb,"GetPrintSettings",Ub,sb,zb,db,jb,4)},fa=(mb,Ob,Ta,sb,zb,db,jb,Ub=null)=>{Ub=mb.Oa(1,Ub);Ub.selectedRanges=Ob;Ub.addToPrintArea=Ta;return U.g(mb,"SetPrintArea",Ub,sb,zb,db,jb,0)},wa=(mb,Ob,Ta,sb,zb,db,jb=null)=>
{jb=mb.Oa(1,jb);jb.sheetName=Ob;return U.g(mb,"ClearPrintArea",jb,Ta,sb,zb,db,0)},oa=(mb,Ob,Ta,sb,zb,db,jb=null)=>{jb=mb.Oa(9,jb);jb.sheetCell=Ob;return U.g(mb,"InsertPageBreak",jb,Ta,sb,zb,db,0)},xa=(mb,Ob,Ta,sb,zb,db,jb=null)=>{jb=mb.Oa(9,jb);jb.sheetCell=Ob;return U.g(mb,"RemovePageBreak",jb,Ta,sb,zb,db,0)},bb=(mb,Ob,Ta,sb,zb,db,jb=null)=>{jb=mb.Oa(9,jb);jb.sheetName=Ob;return U.g(mb,"ResetAllPageBreaks",jb,Ta,sb,zb,db,0)};var Za=a(134),La=a(118),va=a(53),Ba=a(199);class Ea{constructor(){this.Col=
this.Row=null}}Object(b.a)(Ea,"PageBreaksInformation",null,[]);class pa{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(pa,"RowColBreak",null,[]);class $a{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)($a,"SharedRange",null,[]);var cb=a(187),ib=a(58);class ta{constructor(mb){this.ribbonCommandInfo=this.dIb=null;this.r_j=(Ob,Ta,sb)=>{Ta=!!Ob&&!!Ob.RequestTelemetryData;t.h(this.$).Dh&&t.h(this.$).Dh.kma(this.SLa.ma(this.ribbonCommandInfo.command),
Ob.StateId,Ta?Ob.RequestTelemetryData.EcsOperationDuration:0,Ta?Ob.RequestTelemetryData.EcsRequestDuration:0,Ta?Ob.RequestTelemetryData.WfeRequestDuration:0);E.HelperMethods.b_&&this.O6g(sb)};this.$=mb;this.SLa=new cb.a;this.ywa=new cb.a;this.ywa.add(78661008,12);this.ywa.add(275604654,13);this.ywa.add(-13332329,14);this.ywa.add(-837651977,9);this.ywa.add(-1778266776,10);this.ywa.add(845325699,11)}executeCommand(mb,Ob,Ta,sb,zb=null,db=null,jb=null){this.ribbonCommandInfo=Ob;this.kSj(Ob.command);mb=
N.b(zb,this.r_j);e.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${Ob.command} command execution started`);switch(Ob.command){case 78661008:return this.pcf(Ob,mb,db,jb,!1);case 275604654:return this.pcf(Ob,mb,db,jb,!0);case -13332329:return this.mbf(Ob,mb,db,jb);case -837651977:return this.Vci(Ob,mb,db,jb);case -1778266776:return this.Wdi(Ob,mb,db,jb);case 845325699:return this.kcf(Ob,mb,db,jb)}return u.a(Ob.command)}Ac(mb,Ob){switch(Ob.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===
mb;case 845325699:case -13332329:return!0}return!1}F8f(mb,Ob,Ta){const sb=t.h(this.$);var zb=sb.Ca;const db=m.r(sb.ha.ra.selectedRanges,this.$);if((zb=zb.iz())&&zb.length){for(const jb of zb){zb=jb;const Ub=zb.wf;if(!Ub)continue;const xd=m.j(zb.Be),ne=[];for(const fe of db.Ranges){if(fe.FirstRow>xd.LastRow+1||fe.LastRow<xd.FirstRow||fe.FirstColumn>xd.LastColumn+1||fe.LastColumn<xd.FirstColumn)continue;const Bd=this.s4h(xd,fe,Ub),Ue=this.r4h(xd,fe,Ub);ne.push(Object(z.a)(new $a,{FirstRow:Bd.FirstRow,
FirstColumn:Ue.FirstColumn,LastRow:Bd.LastRow,LastColumn:Ue.LastColumn}))}0<ne.length&&!Ta?Ub.setPrintArea(ne):0<ne.length&&Ta?Ub.addToPrintArea(ne):!Ta&&Ub.hasPrintArea()&&Ub.clearPrintArea();!Ub.isDirty()&&Ub.hasPageLayout()&&Ub.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+zb.gd,4)}this.BQb(sb,mb,Ob)}}C8g(mb,Ob){const Ta=t.h(this.$);var sb=t.h(this.$).Ca.iz();if(sb&&sb.length){for(const zb of sb){sb=zb;const db=sb.wf;db&&(db.clearPrintArea(),!db.isDirty()&&db.hasPageLayout()&&
db.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+sb.gd,4))}this.BQb(Ta,mb,Ob)}}tni(mb,Ob){const Ta=t.h(this.$);var sb=Ta.Ca;const zb=m.o(Ta.ha.ra.activeCell,this.$);if(zb){var db=sb.iz();if(db&&db.length){sb=null;for(var jb of db){let Ub=jb,xd=Ub.wf;if(!xd)continue;let ne=m.j(Ub.Be);if(!(zb.FirstRow>ne.LastRow||zb.FirstRow<ne.FirstRow||zb.FirstColumn>ne.LastColumn||zb.FirstColumn<ne.FirstColumn)&&(sb=this.Gih(xd,ne,zb),xd.insertPageBreak(sb),!xd.isDirty()&&xd.hasPageLayout()&&
xd.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Ub.gd,4),sb))break}if(!sb)for(const Ub of db)if(sb=Ub,jb=sb.wf)sb=m.j(sb.Be),sb=this.zKe(jb,sb,zb),jb.insertPageBreak(sb);this.BQb(Ta,mb,Ob)}}}fnj(mb,Ob){const Ta=t.h(this.$);var sb=Ta.Ca;const zb=m.o(Ta.ha.ra.activeCell,this.$);if(zb&&(sb=sb.iz())&&sb.length){for(const jb of sb){sb=jb;const Ub=sb.wf;if(Ub){var db=m.j(sb.Be);(db=this.zKe(Ub,db,zb))&&Ub.removePageBreak(db);!Ub.isDirty()&&Ub.hasPageLayout()&&Ub.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+
sb.gd,4)}}this.BQb(Ta,mb,Ob)}}Wsj(mb,Ob){const Ta=t.h(this.$);var sb=Ta.Ca.iz();if(sb&&sb.length){for(const zb of sb){sb=zb;const db=sb.wf;db&&(db.resetAllPageBreak(),!db.isDirty()&&db.hasPageLayout()&&db.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+sb.gd,4))}this.BQb(Ta,mb,Ob)}}pcf(mb,Ob,Ta,sb,zb){if(!zb){var db=this.$.Bb.getItemByName("PRINT_AREA");if(db&&(e.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${db.type}`),
2===db.type))return this.Xoi(),ib.Task.Ta(!0)}db=t.h(this.$).ha.ra;const jb=m.r(db.selectedRanges,this.$);if(1===jb.Ranges.length&&!zb){if(db.aca())return this.mei(mb,jb,Ob,Ta,sb,zb),ib.Task.Ta(!0);if(m.S(jb.Ranges[0]))return this.$.ua.na.hasPrintArea?this.mbf(mb,Ob,Ta,sb):ib.Task.Ta(!0)}this.F8f(mb.command,sb,zb);return this.pif(mb,Ob,Ta,jb,zb)}mbf(mb,Ob,Ta,sb){this.C8g(mb.command,sb);return this.Joi(mb,Ob,Ta)}Vci(mb,Ob,Ta,sb){this.tni(mb.command,sb);return this.Uoi(mb,Ob,Ta)}Wdi(mb,Ob,Ta,sb){const zb=
m.r(t.h(this.$).ha.ra.selectedRanges,this.$);if(m.S(zb.Ranges[0]))return this.kcf(mb,Ob,Ta,sb);this.fnj(mb.command,sb);return this.Zoi(mb,Ob,Ta)}kcf(mb,Ob,Ta,sb){this.Wsj(mb.command,sb);return this.cpi(mb,Ob,Ta)}pif(mb,Ob,Ta,sb,zb){const db=this.$.pa.va,jb=()=>new P(sb,zb);return D.a(this.$.userOperationManager,(Ub,xd,ne)=>fa(db,sb,zb,N.b(Ub,Ob),N.a(xd,Ta),ne,null),Ub=>new G.a(241,0,Ub,64,jb),mb)}Joi(mb,Ob,Ta){const sb=this.$.ua.na.name,zb=this.$.pa.va,db=()=>new Y(sb);return D.a(this.$.userOperationManager,
(jb,Ub,xd)=>wa(zb,sb,N.b(jb,Ob),N.a(Ub,Ta),xd,null),jb=>new G.a(243,0,jb,64,db),mb)}Uoi(mb,Ob,Ta){const sb=t.h(this.$),zb=m.o(sb.ha.ra.activeCell,this.$),db=()=>new W(zb);return D.a(this.$.userOperationManager,(jb,Ub,xd)=>oa(this.$.pa.va,zb,N.b(jb,Ob),N.a(Ub,Ta),xd,null),jb=>new G.a(244,0,jb,64,db),mb)}Zoi(mb,Ob,Ta){const sb=t.h(this.$),zb=m.o(sb.ha.ra.activeCell,this.$),db=()=>new ea(zb);return D.a(this.$.userOperationManager,(jb,Ub,xd)=>xa(this.$.pa.va,zb,N.b(jb,Ob),N.a(Ub,Ta),xd,null),jb=>new G.a(245,
0,jb,64,db),mb)}cpi(mb,Ob,Ta){const sb=this.$.ua.na.name,zb=()=>new R(sb);return D.a(this.$.userOperationManager,(db,jb,Ub)=>bb(this.$.pa.va,sb,N.b(db,Ob),N.a(jb,Ta),Ub,null),db=>new G.a(246,0,db,64,zb),mb)}s4h(mb,Ob,Ta){if(!mb||!Ob||!Ta)return null;const sb=new $a;sb.FirstRow=Ob.FirstRow===mb.LastRow+1?Ta.getRowIndex(mb.LastRow+1)+1:Ob.FirstRow<mb.FirstRow?0:Ta.getRowIndex(Ob.FirstRow+1);sb.LastRow=Ob.FirstRow===mb.LastRow+1||Ob.LastRow>mb.LastRow?Ta.getRowIndex(mb.LastRow+1)+1:Ta.getRowIndex(Ob.LastRow+
1);return sb}r4h(mb,Ob,Ta){if(!mb||!Ob||!Ta)return null;const sb=new $a;sb.FirstColumn=Ob.FirstColumn===mb.LastColumn+1?Ta.getColumnIndex(mb.LastColumn+1)+1:Ob.FirstColumn<mb.FirstColumn?0:Ta.getColumnIndex(Ob.FirstColumn+1);sb.LastColumn=Ob.FirstColumn===mb.LastColumn+1||Ob.LastColumn>mb.LastColumn?Ta.getColumnIndex(mb.LastColumn+1)+1:Ta.getColumnIndex(Ob.LastColumn+1);return sb}Gih(mb,Ob,Ta){if(!Ob||!Ta||!mb)return null;const sb=mb.getPrintArea();if(!sb||!sb.length)return null;const zb=mb.getRowIndex(Ta.FirstRow+
1),db=mb.getColumnIndex(Ta.FirstColumn+1);let jb=null,Ub=null;for(const xd of sb)if(zb>=xd.FirstRow&&zb<=xd.LastRow&&db>=xd.FirstColumn&&db<=xd.LastColumn){if(Ta.FirstRow===xd.FirstRow&&Ta.FirstColumn===xd.FirstColumn)return new Ea;zb>xd.FirstRow&&(jb=Object(z.a)(new pa,{Index:zb-1,Min:xd.FirstColumn-1,Max:Math.min(xd.LastColumn,mb.getColumnIndex(Ob.LastColumn+1))}));db>xd.FirstColumn&&(Ub=Object(z.a)(new pa,{Index:db-1,Min:xd.FirstRow-1,Max:Math.min(xd.LastRow,mb.getRowIndex(Ob.LastRow+1))}));break}return jb||
Ub?Object(z.a)(new Ea,{Row:jb?[jb]:null,Col:Ub?[Ub]:null}):null}Zjh(mb,Ob,Ta){if(!Ob||!Ta||!mb)return null;let sb=null;Ta.FirstRow>Ob.FirstRow&&Ta.FirstRow<=Ob.LastRow?sb=Object(z.a)(new pa,{Index:mb.getRowIndex(Ta.FirstRow+1)-1,Min:-1,Max:-1}):Ta.FirstRow===Ob.LastRow+1&&(sb=Object(z.a)(new pa,{Index:mb.getRowIndex(Ob.LastRow+1),Min:-1,Max:-1}));return sb}tfh(mb,Ob,Ta){if(!Ob||!Ta||!mb)return null;let sb=null;Ta.FirstColumn>Ob.FirstColumn&&Ta.FirstColumn<=Ob.LastColumn?sb=Object(z.a)(new pa,{Index:mb.getColumnIndex(Ta.FirstColumn+
1)-1,Min:-1,Max:-1}):Ta.FirstColumn===Ob.LastColumn+1&&(sb=Object(z.a)(new pa,{Index:mb.getColumnIndex(Ob.LastColumn+1),Min:-1,Max:-1}));return sb}zKe(mb,Ob,Ta){if(!Ta||!mb||!Ob)return null;const sb=this.Zjh(mb,Ob,Ta);mb=this.tfh(mb,Ob,Ta);return sb||mb?Object(z.a)(new Ea,{Row:sb?[sb]:null,Col:mb?[mb]:null}):null}Xoi(){const mb=new C.StandardDialog;mb.Rb=0;mb.wc(1,O.a.instance.ga(4));mb.Zl(O.a.instance.ga(569),O.a.instance.ga(570),1,null)}kSj(mb){if(this.ywa.kb(mb)&&(E.HelperMethods.b_&&(this.dIb=
this.$.Mb.Kc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.SLa.kb(mb)&&this.SLa.remove(mb),this.SLa.add(mb,H.a.create().toString()),t.h(this.$).Dh)){const Ob=va.b()?va.b().Ij(mb):"";t.h(this.$).Dh.M0(this.ywa.ma(mb),this.SLa.ma(mb),Ob)}}O6g(mb){if(this.dIb&&mb){const Ob=this.dIb.Fc;this.dIb.stop();this.dIb=null;switch(mb){case "SetPrintArea":this.bsb(Ob,1700,mb);break;case "ClearPrintArea":this.bsb(Ob,1500,mb);break;case "InsertPageBreak":this.bsb(Ob,1500,mb);break;case "RemovePageBreak":this.bsb(Ob,
1600,mb);break;case "ResetAllPageBreaks":this.bsb(Ob,1700,mb)}}}bsb(mb,Ob,Ta){mb>Ob&&(Ob=Object(z.a)(new Ba.a,{extendedProperties:new Map}),Ob.extendedProperties.set("OperationName",Ta),Ob.extendedProperties.set("OperationExecutionTime",mb.toString()),I.Health.instance.recordQosError(Za.a.WQj,[La.a.RQj],!1,!0,!0,!1,Ob))}mei(mb,Ob,Ta,sb,zb,db){const jb=new C.StandardDialog,Ub=new S.a(O.a.instance.ga(567),O.a.instance.ga(568),O.a.instance.ga(6),O.a.instance.ga(5));jb.Rb=1;jb.wc(1,Ub.confirmButton);
jb.wc(0,Ub.cancelButton);jb.Zl(Ub.title,Ub.body,3,xd=>{1===xd&&(this.F8f(mb.command,zb,db),this.pif(mb,Ta,sb,Ob,db))})}BQb(mb,Ob,Ta){Ta();this.SLa.kb(Ob)&&mb.Dh.lS(this.SLa.ma(Ob),J.BasicTelemetryCalculator.WQ)}}Object(b.a)(ta,"PrintAreaBreakManager",null,[451]);var Ya=a(392),Da=a(91),ba=a(27);class ya{constructor(){this.margin=this.r0=this.kda=this.orientation=this.eA=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.X2a=!1;this.NoColor=null}equals(mb){return mb?this.orientation===mb.orientation&&
this.kda===mb.kda&&this.r0===mb.r0&&this.margin===mb.margin&&this.sheetPrintOptions===mb.sheetPrintOptions&&this.X2a===mb.X2a&&this.NoColor===mb.NoColor:!1}static vIe(mb,Ob){mb&&Ob&&(Ob.eA=mb.eA,Ob.orientation=mb.orientation,Ob.kda=mb.kda,Ob.r0=mb.r0,Ob.margin=mb.margin,Ob.ignorePrintArea=mb.ignorePrintArea,Ob.sheetPrintOptions=mb.sheetPrintOptions,Ob.X2a=mb.X2a,Ob.NoColor=mb.NoColor)}}Object(b.a)(ya,"PrintSettingsContainer",null,[]);var V=a(8),Z=a(59),ja=a(307),la=a(995),ua=a(214),eb=a(117),Eb=a(164),
Wb=a(352),Ab=a(39),Jb=a(29),Gb=a(22),Nb=a(859),Ja=a(798),ab=a(197),wb=a(653),xb=a(559);class rb{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(rb,"PrintSettingMarginOption",null,[]);class za{constructor(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(za,"PrintSettingMarginValue",null,[]);class Aa{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(Aa,"PrintSettingOption",null,[]);class pb{constructor(mb){this.TPi=
[.75,.75,.7,.7,.3,.3];this.MOi=[.75,.75,.25,.25,.3,.3];this.Nak=[1,1,1,1,.5,.5];this.Gfe=this.Gke=this.aie=this.Jhe=this.toe=this.O6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Fm=mb;this.dmi();this.jmi()}get whatToPrintOptions(){return this.toe}get orientationOptions(){return this.Jhe}get paperSizeOptions(){return this.aie}get scalingOptions(){return this.Gke}get marginDetailedOptions(){return this.Gfe}dispose(){}zyb(mb){if(!mb)return null;const Ob=new za;Ob.left=mb.Left;
Ob.right=mb.Right;Ob.top=mb.Top;Ob.bottom=mb.Bottom;Ob.header=mb.Header;Ob.footer=mb.Footer;return Ob}E7c(mb){e.ULS.shipAssertTag(537154186,0,6===mb.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const Ob={};Ob.Top=mb[0];Ob.Bottom=mb[1];Ob.Left=mb[2];Ob.Right=mb[3];Ob.Header=mb[4];Ob.Footer=mb[5];return Ob}jmi(){this.toe=[Object(z.a)(new Aa,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1230)}),Object(z.a)(new Aa,{printSettingOptionKey:2,
printSettingOptionText:this.Fm.ga(1223)}),Object(z.a)(new Aa,{printSettingOptionKey:0,printSettingOptionText:this.Fm.ga(1222)})];this.Jhe=[Object(z.a)(new Aa,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1233)}),Object(z.a)(new Aa,{printSettingOptionKey:2,printSettingOptionText:this.Fm.ga(1232)})];this.aie=[Object(z.a)(new Aa,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1235)}),Object(z.a)(new Aa,{printSettingOptionKey:5,printSettingOptionText:this.Fm.ga(1236)}),Object(z.a)(new Aa,
{printSettingOptionKey:6,printSettingOptionText:this.Fm.ga(1243)}),Object(z.a)(new Aa,{printSettingOptionKey:7,printSettingOptionText:this.Fm.ga(1237)}),Object(z.a)(new Aa,{printSettingOptionKey:8,printSettingOptionText:this.Fm.ga(1238)}),Object(z.a)(new Aa,{printSettingOptionKey:9,printSettingOptionText:this.Fm.ga(1239)}),Object(z.a)(new Aa,{printSettingOptionKey:11,printSettingOptionText:this.Fm.ga(1240)}),Object(z.a)(new Aa,{printSettingOptionKey:12,printSettingOptionText:this.Fm.ga(1241)}),Object(z.a)(new Aa,
{printSettingOptionKey:13,printSettingOptionText:this.Fm.ga(1242)}),Object(z.a)(new Aa,{printSettingOptionKey:3,printSettingOptionText:this.Fm.ga(1234)})];this.Gke=[Object(z.a)(new Aa,{printSettingOptionKey:0,printSettingOptionText:this.Fm.ga(1251)}),Object(z.a)(new Aa,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1252)}),Object(z.a)(new Aa,{printSettingOptionKey:2,printSettingOptionText:this.Fm.ga(1253)}),Object(z.a)(new Aa,{printSettingOptionKey:3,printSettingOptionText:this.Fm.ga(1254)})];
this.Gfe=[Object(z.a)(new rb,{printSettingOption:Object(z.a)(new Aa,{printSettingOptionKey:0,printSettingOptionText:this.Fm.ga(1257)}),marginValue:this.zyb(this.normal)}),Object(z.a)(new rb,{printSettingOption:Object(z.a)(new Aa,{printSettingOptionKey:1,printSettingOptionText:this.Fm.ga(1258)}),marginValue:this.zyb(this.wide)}),Object(z.a)(new rb,{printSettingOption:Object(z.a)(new Aa,{printSettingOptionKey:2,printSettingOptionText:this.Fm.ga(1259)}),marginValue:this.zyb(this.narrow)}),Object(z.a)(new rb,
{printSettingOption:Object(z.a)(new Aa,{printSettingOptionKey:3,printSettingOptionText:this.Fm.ga(1260)}),marginValue:this.zyb(this.O6)})]}dmi(){this.normal=this.E7c(this.TPi);this.narrow=this.E7c(this.MOi);this.wide=this.E7c(this.Nak)}}pb.Wnh=1;pb.Hnh=1;pb.t9c=9;pb.Mnh=2;pb.Fnh=0;pb.ynh=!1;pb.tnh=!1;pb.pJa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(pb,"PrintSettingsManagerBase",null,[3]);var kb=a(128),Cb=a(255);class ob{constructor(mb,Ob){this.sheetPrintOptions=
this.sheetName=null;this.sheetName=mb;this.sheetPrintOptions=Ob}getSheetName(){return this.sheetName}}Object(b.a)(ob,"MacroRecorderSheetPrintOptionsSavedPayload",null,[123]);class qa{constructor(mb,Ob){this.printSettings=this.sheetName=null;this.sheetName=mb;this.printSettings=Ob}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(qa,"MacroRecorderSheetPrintSettingsSavedPayload",null,[123]);class ma extends pb{constructor(mb,Ob,Ta,sb,zb){super(zb);this.cdg=
this.Ld=!1;this.CFd=db=>{this.PF.CFd(db)};this.MFd=db=>{this.PF.MFd(db)};this.K2i=()=>{e.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};this.J2i=db=>{db=eb.a.Ue(db.data);e.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${Jb.a.qc(db)}.`)};this.Fz=(db,jb)=>{2===jb.Uq?this.Jv.clear():1===jb.Uq&&this.Jv&&this.Jv.contains(jb.Gf)&&(e.ULS.sendTraceTag(537154188,
0,50,`PrintSettingsManager.OnQueueChanged: web method ${kb.a(jb.Gf.operation.operationName)} returned, it took ${jb.Gf.dequeueUtcTime.getTime()-jb.Gf.enqueueUtcTime.getTime()} milliseconds to complete.`),this.Jv.remove(jb.Gf))};this.PF=mb;this.lbb=Ta;this.$=Ob;this.sheetName=sb;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.ya.UICultureTag;this.Z7i=this.Zch();this.$.userOperationManager.jr(this.Fz);this.Jv=new ab.a}Ooi(mb){this.Poi(Ob=>{mb&&(Ob=this.y4h(Ob),mb(Ob))})}OQd(mb,
Ob){if(mb){var Ta=new A(mb.eA,mb.ignorePrintArea);this.gxj(Ta);!Ob||this.cdg?e.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${Ob?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(Ob=this.A4h(mb.r0),Ob.IsLandscape=2===mb.orientation,Ob.PaperSize=mb.kda,Ob.NoColor=mb.NoColor,Ob.PageMargin=this.Mjd(mb.margin),Ob.SheetPrintOptions=pb.pJa,Ob.SheetPrintOptions.PrintGrid=mb.sheetPrintOptions.PrintGrid,Ob.SheetPrintOptions.HorizontalCenter=
mb.sheetPrintOptions.HorizontalCenter,Ob.SheetPrintOptions.VerticalCenter=mb.sheetPrintOptions.VerticalCenter,Ob.SheetPrintOptions.PrintHeaders=mb.sheetPrintOptions.PrintHeaders,this.fxj(Ob))}else e.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}Mjd(mb){let Ob={};0===mb?Ob=this.normal:1===mb?Ob=this.wide:2===mb?Ob=this.narrow:3===mb&&(Ob=this.O6);return Ob}hpi(mb){if(mb){e.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");
var Ob=this.$.pa.va,Ta=this.$.pa.va.$b(),sb=new G.a(598,0,(zb,db,jb)=>ka(Ob,this.$.ua.na.name,mb,N.b(this.CFd,zb),N.a(this.MFd,db),jb,Ta),64,()=>new ob(this.$.ua.na.name,mb));this.$.userOperationManager.Oc(sb,null)}else e.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.Ld||(this.Ld=!0,this.$.userOperationManager.ao(this.Fz),this.hY())}gxj(mb){this.lbb.eA=mb.eA;this.lbb.ignorePrintArea=mb.ignorePrintArea}Poi(mb){const Ob=
db=>{Cb.a(db)?e.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${Jb.a.qc(db.Errors)}.`):(e.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),mb(db.Result))},Ta=db=>{db=eb.a.Ue(db.data);e.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${Jb.a.qc(db)}.`);mb(null)},sb=this.$.pa.va.$b();
var zb=new G.a(247,0,(db,jb,Ub)=>L(this.$.pa.va,this.sheetName,this.locale,N.b(db,Ob),N.a(jb,Ta),Ub,sb),80);zb=this.$.userOperationManager.Oc(zb,null);this.Jv.add(zb)}fxj(mb){e.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const Ob=this.$.pa.va.$b();this.$.userOperationManager.Oc(new G.a(226,0,(Ta,sb,zb)=>da(this.$.pa.va,this.sheetName,mb,N.b(Ta,this.K2i),N.a(sb,this.J2i),zb,Ob),void 0,()=>new qa(this.sheetName,
mb)),null)}Kwi(mb){return this.Qjf(mb)||!this.gnf(mb.PaperSize)}bMh(mb){this.Qjf(mb)&&(e.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),mb.ScalingWidth=ma.Onh,mb.ScalingHeight=ma.Nnh,mb.ScalingPercent=ma.MMe,mb.FitToPage=ma.unh);this.gnf(mb.PaperSize)||(e.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${mb.PaperSize.toString()} present in file which is unsupported by XLO.`),
mb.PaperSize=ma.t9c);return mb}v4h(mb){if(mb.FitToPage){if(1===mb.ScalingWidth&&1===mb.ScalingHeight)return 1;if(!mb.ScalingWidth&&1===mb.ScalingHeight)return 3}else return 0;return 2}u4h(mb){return this.gtd(mb,this.normal)?0:this.gtd(mb,this.wide)?1:this.gtd(mb,this.narrow)?2:3}gtd(mb,Ob){return mb.Left===Ob.Left&&mb.Right===Ob.Right&&mb.Top===Ob.Top&&mb.Bottom===Ob.Bottom&&mb.Header===Ob.Header&&mb.Footer===Ob.Footer}A4h(mb){const Ob={};Ob.ScalingPercent=ma.MMe;Ob.FitToPage=0!==mb;2===mb?(Ob.ScalingWidth=
1,Ob.ScalingHeight=0):3===mb?(Ob.ScalingWidth=0,Ob.ScalingHeight=1):1===mb&&(Ob.ScalingWidth=1,Ob.ScalingHeight=1);return Ob}gnf(mb){return this.Z7i.contains(mb.toString())}Qjf(mb){return 100!==mb.ScalingPercent||mb.FitToPage&&(1<mb.ScalingWidth||1<mb.ScalingHeight)}Zch(){const mb=new wb.a(xb.a.li());for(let Ob=0;Ob<this.paperSizeOptions.length;Ob++)mb.add(this.paperSizeOptions[Ob].printSettingOptionKey.toString());return mb}y4h(mb){let Ob=null;if(mb){const Ta=this.lbb.eA,sb=this.lbb.ignorePrintArea;
this.Kwi(mb)&&(this.cdg=!0,mb=this.bMh(mb));Ob=new ya;Ob.eA=Ta;Ob.ignorePrintArea=sb;Ob.orientation=mb.IsLandscape?2:1;Ob.kda=mb.PaperSize;Ob.r0=this.v4h(mb);Ob.sheetPrintOptions=pb.pJa;Ob.sheetPrintOptions.PrintGrid=mb.SheetPrintOptions.PrintGrid;Ob.X2a=mb.Draft;Ob.NoColor=mb.NoColor;Ob.sheetPrintOptions.HorizontalCenter=mb.SheetPrintOptions.HorizontalCenter;Ob.sheetPrintOptions.VerticalCenter=mb.SheetPrintOptions.VerticalCenter;Ob.sheetPrintOptions.PrintHeaders=mb.SheetPrintOptions.PrintHeaders;
Ob.margin=this.u4h(mb.PageMargin);e.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${Ob.margin}`);3===Ob.margin&&(this.O6={},this.O6.Left=mb.PageMargin.Left,this.O6.Right=mb.PageMargin.Right,this.O6.Top=mb.PageMargin.Top,this.O6.Bottom=mb.PageMargin.Bottom,this.O6.Header=mb.PageMargin.Header,this.O6.Footer=mb.PageMargin.Footer)}return Ob}hY(){if(this.Jv){for(let mb of this.Jv)this.$&&this.$.userOperationManager&&(mb.operation&&e.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${kb.a(mb.operation.operationName)}.`),
this.$.userOperationManager.rua(mb)),this.Jv.remove(mb);this.Jv=null}}}ma.Onh=1;ma.Nnh=0;ma.MMe=100;ma.t9c=9;ma.unh=!0;Object(b.a)(ma,"PrintSettingsManager",pb,[]);var Ga=a(74);class vb{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(vb,"PrintSettingsTaskPaneCallbacks",null,[]);class Ka{constructor(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(Ka,"SelectedPrintSettings",null,[]);class Pa{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}}Object(b.a)(Pa,"PrintOperationCallbacks",null,[]);class fb{constructor(){this.onBackToSheet=null}}Object(b.a)(fb,"PrintPreviewPaneCallbacks",
null,[]);class Wa{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(b.a)(Wa,"PrintPreviewPaneProps",null,[]);class Ma{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(Ma,"UniversalPrintAppSettings",
null,[]);var lb=a(428),Na=a(33);class X{constructor(mb,Ob,Ta,sb){this.activeCell=this.selectedRange=this.lg=this.graphServiceEndpoint=null;this.vJb=0;this.yda=this.Kv=null;this.DH=new ya;this.Jk=new ya;this.oca=0;this.o9a=null;this.xPb=!1;this.x4a=this.tIb=null;this.Btd=!1;this.j8a=this.sCb=!0;this.ana=this.Qza=this.v9a=null;this.rBb=!1;this.l9a=null;this.x7a=this.TOc=!1;this.EWi=zb=>{if(!(zb&&zb.data&&zb.data.me&&zb.data.responseHeaders&&zb.data.me.length)){var db=zb?zb.data?zb.data.me?zb.data.responseHeaders?
zb.data.me.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.lg&&(zb=this.$Ra(O.a.instance.ga(1211)),this.OBa(zb,0));e.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${db}`);this.JOd&&(zb=Object(z.a)(new Ba.a,{extendedProperties:new Map}),zb.extendedProperties.set("InvalidParameterName",
db),I.Health.instance.recordQosError(Za.a.qRf,[La.a.rRf],!1,!0,!0,!1,zb))}else if(0<this.oca&&zb.data.id===this.oca){if(zb.data.responseHeaders["Content-Type"]&&(Gb.a.contains(zb.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Gb.a.contains(zb.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){e.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var jb=null;Gb.a.contains(zb.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0)&&(jb=this.ffh(zb));db={};this.SDf(jb);zb.data.responseHeaders["Total-Pdf-PageCount"]?(jb=parseInt(zb.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),this.rBb||(this.yJd>=jb?this.ana=jb:this.rBb=!0),this.j8a&&this.lg&&this.lg.setPageRangeSettings(jb,this.yJd,this.rBb,this.Qza,this.ana)):e.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else db=Z.a.Yh(zb.data.me),Jb.a.i$(db.Errors)||Ga.a(this.$).kd.WL(db.Errors[0].MessageId),
this.Tij(db.Errors),this.lg&&(jb=this.$Ra(db.Errors[0].Description),-1831476778===db.Errors[0].MessageId?(e.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.OBa(jb,0,O.a.instance.ga(1214))):this.OBa(jb,0)),297284985===db.Errors[0].MessageId?e.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${db.Errors[0].MessageId}`):e.ULS.sendTraceTag(593266763,0,15,
`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${db.Errors[0].MessageId}`);zb=zb.data.state;zb.FUe(db,zb.userContext,zb.methodName)}};this.DWi=zb=>{if(0<this.oca&&zb.data.id===this.oca){var db=eb.a.Ue(zb.data);this.lg&&this.OBa(this.$Ra(db[0].Description),1);e.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${Jb.a.qc(db)}]`);db=zb.data.state;db.lja(zb,db.userContext,db.methodName);this.$.userOperationManager.Tla.operation.zBa(()=>
this.xPb)}};this.dVi=zb=>{zb.Errors&&0<zb.Errors.length&&this.lg?(Jb.a.i$(zb.Errors)||Ga.a(this.$).kd.WL(zb.Errors[0].MessageId),this.OBa(this.$Ra(zb.Errors[0].Description),0),e.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${zb.Errors[0].MessageId}`)):(e.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.SDf(null))};this.cVi=zb=>{zb=eb.a.Ue(zb.data);this.lg&&this.OBa(this.$Ra(zb[0].Description),
1);e.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${Jb.a.qc(zb)}]`);this.$.userOperationManager.Tla.operation.zBa(()=>this.xPb)};this.uIf=(zb,db)=>{if(db)switch(db.Acj){case 1:if(this.Jk&&this.x4a)switch(zb=this.x4a.Fc,this.x4a.stop(),this.x4a=null,this.Jk.eA){case 1:this.r3c(zb,4800,"ActiveSheet");break;case 0:this.r3c(zb,6100,"CurrentSelection");break;case 2:this.r3c(zb,7500,"EntireWorkbook")}break;case 0:this.tIb&&(zb=this.tIb.Fc,this.tIb.stop(),
2400<zb&&(db=Object(z.a)(new Ba.a,{extendedProperties:new Map}),db.extendedProperties.set("PaneLoadTime",zb.toString()),I.Health.instance.recordQosError(Za.a.VQj,[La.a.kdg],!1,!0,!0,!1,db)),this.Kv.Ooi(jb=>{this.VOj(jb)}))}};this.Fz=(zb,db)=>{(1===db.Uq&&this.v9a===db.Gf||2===db.Uq)&&this.xPd()};this.$=mb;this.V8b=Ob;this.c3=Ta;this.wGb=sb;this.JOd=E.HelperMethods.b_;this.Ra=new Ab.a;this.yJd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.IMj();this.Mli();this.qqi=this.S6g();this.kAi=
w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebUniversalPrintFloodgateSurvey",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1);if(this.isUniversalPrintEnabled=!!sb&&sb.j7a()&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.ke.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint;this.isExportPdfMode=!1}get Jwi(){return this.TOc}zRg(mb){this.Ra.addHandler("ppocek",
mb)}Lpj(mb){this.Ra.removeHandler("ppocek",mb)}UOj(mb,Ob,Ta){this.rtj();this.$.userOperationManager.jr(this.Fz);this.yda=mb;this.Ra.raiseEvent("ppocek");this.isExportPdfMode=Ta;this.yda.SelectedRanges&&this.yda.SelectedRanges.Ranges&&0<this.yda.SelectedRanges.Ranges.length&&this.yda.SelectedRanges.Ranges[0]&&(this.selectedRange=m.C(this.yda.SelectedRanges.Ranges[0]).toString());e.ULS.shipAssertTag(537154268,0,!this.Kv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");
this.Kv=new ma(this,this.$,Ob,this.$.ua.na.name,O.a.instance);e.ULS.shipAssertTag(537154267,0,!this.lg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.lg=new Ja.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.lg.wrh();this.lg.WOj(this.isExportPdfMode);this.lg.UQg(this.uIf)}x1h(){this.Kv.O6&&4<=this.Kv.marginDetailedOptions.length&&(this.Kv.marginDetailedOptions[3].marginValue=this.Kv.zyb(this.Kv.O6));return this.Kv.marginDetailedOptions}D$f(){return!!this.yda&&
!!this.yda.ObjectId||!t.h(this.$).ha.ra.eh}B4h(){const mb=Object(z.a)(new Ka,{selectedWhatToPrint:pb.Wnh,selectedOrientation:pb.Hnh,selectedPaperSize:pb.t9c,selectedScaling:pb.Mnh,selectedMargin:pb.Fnh,selectedIgnorePrintArea:pb.ynh,selectedPrintGridlines:pb.pJa.PrintGrid,selectedDraft:pb.tnh,selectedHorizontalCenter:pb.pJa.HorizontalCenter,selectedVerticalCenter:pb.pJa.VerticalCenter,selectedRowAndColumnHeadings:pb.pJa.PrintHeaders});this.DH?(mb.selectedWhatToPrint=this.DH.eA,mb.selectedOrientation=
this.DH.orientation,mb.selectedPaperSize=this.DH.kda,mb.selectedScaling=this.DH.r0,mb.selectedMargin=this.DH.margin,mb.selectedIgnorePrintArea=this.DH.ignorePrintArea,mb.selectedPrintGridlines=this.DH.sheetPrintOptions.PrintGrid,mb.selectedDraft=this.DH.X2a,mb.selectedColor=this.DH.NoColor?0:1,mb.selectedHorizontalCenter=this.DH.sheetPrintOptions.HorizontalCenter,mb.selectedVerticalCenter=this.DH.sheetPrintOptions.VerticalCenter,mb.selectedRowAndColumnHeadings=this.DH.sheetPrintOptions.PrintHeaders):
e.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return mb}w4h(){return Object(z.a)(new fb,{onBackToSheet:()=>{this.Hma()}})}x4h(){return Object(z.a)(new Wa,{backActionButtonText:O.a.instance.ga(1210),printPreviewPaneCallbacks:this.w4h(),logger:new Ya.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,printOperationCallbacks:Object(z.a)(new Pa,{onClosePreviewer:()=>{this.Hma()},getGraphServiceAuthorizationToken:this.Fcc(),
onLocalPrint:()=>{this.fJf()},onNotifyPrintJobStatus:(mb,Ob)=>{this.onNotifyPrintJobStatus(mb,Ob)}}),universalPrintAppSettings:Object(z.a)(new Ma,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.xqi()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})}z4h(){return Object(z.a)(new vb,{onSettingChange:mb=>{this.x1i(mb)},onPrint:()=>{this.fJf()}})}x1i(mb){this.vJb++;mb?(this.lg&&this.lg.LPj(),this.Jk.eA=mb.selectedWhatToPrint,
this.Jk.r0=mb.selectedScaling,this.Jk.orientation=mb.selectedOrientation,this.Jk.kda=mb.selectedPaperSize,this.Jk.margin=mb.selectedMargin,this.Jk.NoColor=!mb.selectedColor,this.Jk.ignorePrintArea=mb.selectedIgnorePrintArea,this.pFj(mb.selectedPageStart,mb.selectedPageEnd),this.Kv&&this.Efi(this.Jk,mb)?(this.Jk.sheetPrintOptions=pb.pJa,this.Jk.sheetPrintOptions.PrintGrid=mb.selectedPrintGridlines,this.Jk.sheetPrintOptions.HorizontalCenter=mb.selectedHorizontalCenter,this.Jk.sheetPrintOptions.VerticalCenter=
mb.selectedVerticalCenter,this.Jk.sheetPrintOptions.PrintHeaders=mb.selectedRowAndColumnHeadings,this.Kv.hpi(this.Jk.sheetPrintOptions)):this.iqd()):e.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}Hma(){this.x7a&&(this.xPb=!0);e.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.vJb} times before clicking on backToWorkbook icon`);this.eJf();this.hEe()}fJf(){e.ULS.sendTraceTag(591196512,
0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.vJb} times before clicking on print button.`);e.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Jk.margin}, Initial margin value : ${this.DH.margin}`);if(this.useMSPdfViewer)this.sRf();else if(this.j8a)try{this.lg.printPdf(),this.x4c()}catch(mb){e.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.sRf()}else this.V8b.TOj(this.X6b(!0)),
this.x4c()}sRf(){const mb=this.X6b(!0);this.x4c();E.HelperMethods.nf(mb,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){Da.a.Ja(this.Ra)}iqd(){if(this.$.s7a)this.Loi();else{this.hY();this.T1f();var mb=null;this.Cli();e.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.v9a=this.$.userOperationManager.Oc(new G.a(223,0,(Ob,Ta,sb)=>{Ob=new ja.a(Ob,null,Ta,sb,null,!0,!1,"GetFileCopyFileHandler","");Ob.correlationID=
H.a.create().toString();mb=Ob;this.oca=this.c3.eha(this.X6b(this.j8a?!1:!0,this.qqi?"Base64":"Pdf"),1,null,null,X.AJh,!1,2,this.EWi,this.DWi,mb,void 0,void 0,void 0,12E4);Ob.requestId=this.oca;e.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.oca}.`);return ib.Task.Ta(!0)},80),null)}}x4c(){this.eJf();this.hEe()}CFd(mb){Jb.a.wq(mb.Errors)?this.lg.showErrorMessageForPrintOptions(O.a.instance.ga(1261)):(e.ULS.sendTraceTag(537154263,
0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.iqd(),this.lg&&this.lg.hideErrorMessageForPrintOptions())}MFd(mb){this.lg&&this.lg.showErrorMessageForPrintOptions(O.a.instance.ga(1261));mb=eb.a.Ue(mb.data);e.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${Jb.a.qc(mb)}.`)}Loi(){e.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");
this.hY();const mb=this.$.pa.va.$b();this.v9a=this.$.userOperationManager.Oc(new G.a(133,0,(Ob,Ta,sb)=>{const zb={};zb.WhatToPrint=this.Jk.eA;zb.UseNamedAction=this.V8b.Qag();zb.SelectedSheetName=this.$.ua.na.name;zb.ActiveCell=this.activeCell;zb.SelectedRanges=[this.selectedRange];zb.IsPdfDocumentRequired=!1;zb.Orientation=this.Jk.orientation;zb.PaperSize=this.Jk.kda;zb.Scaling=this.Jk.r0;zb.RichValuesEnabled=!0;zb.IgnorePrintArea=this.Jk.ignorePrintArea;zb.Preview=!0;zb.NoColor=this.Jk.NoColor;
this.w$f()&&(zb.PaginationStartPage=this.Qza,zb.PaginationEndPage=this.ana,zb.OutputTotalPdfPageCount=!0);const db=this.Kv.Mjd(this.Jk.margin);db&&(zb.PageMargin={},zb.PageMargin.Top=db.Top,zb.PageMargin.Bottom=db.Bottom,zb.PageMargin.Left=db.Left,zb.PageMargin.Right=db.Right,zb.PageMargin.Header=db.Header,zb.PageMargin.Footer=db.Footer);return this.o9a=T(this.$.pa.va,zb,N.b(this.dVi,Ob),N.a(this.cVi,Ta),sb,mb)},80),null)}hEe(){this.$.userOperationManager.ao(this.Fz);this.hY();this.T1f();e.ULS.shipAssertTag(537154261,
0,!!this.lg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.isExportPdfMode=!1;this.lg&&(this.lg.ppj(this.uIf),this.lg.Frh(),this.lg=null);this.yda=null;this.Kv&&(this.Kv.dispose(),this.Kv=null);this.x4a=this.tIb=null;this.TOc=!1;this.Ra&&this.Ra.raiseEvent("ppocek")}wKj(){return this.$.isEditMode&&!!this.DH&&!!this.Jk&&2!==this.Jk.eA&&this.Ffi()}OQd(){e.ULS.shipAssertTag(537154260,0,!!this.Kv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");
this.Kv&&this.Kv.OQd(this.Jk,this.wKj())}X6b(mb,Ob="Pdf"){const Ta=new Sys.StringBuilder;Ta.append(la.a(this.$,Ob,!0));ua.a.Qk(Ta,V.a.PSf,""+this.Jk.eA);mb&&this.V8b.Qag()&&ua.a.Qk(Ta,V.a.i8j,"1");ua.a.Qk(Ta,V.a.Iej,this.$.ua.na.name);0===this.Jk.eA&&(ua.a.Qk(Ta,V.a.Hej,this.selectedRange),ua.a.Qk(Ta,V.a.zej,this.activeCell));ua.a.Qk(Ta,V.a.Cej,""+this.Jk.orientation);ua.a.Qk(Ta,V.a.Dej,""+this.Jk.kda);ua.a.Qk(Ta,V.a.Gej,""+this.Jk.r0);ua.a.Qk(Ta,V.a.Fej,"1");ua.a.Qk(Ta,V.a.yej,this.Jk.ignorePrintArea?
"1":"0");ua.a.Qk(Ta,V.a.Eej,"1");this.lVg(Ta);ua.a.Qk(Ta,V.a.Bej,this.Jk.NoColor?"1":"0");this.kVg(Ta);Gb.a.equals(Ob,"Pdf",!0)&&(Ta.append("&#toolbar=0"),Ta.append("&zoom=100"));mb=Ta.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");e.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${mb}`);return mb}pFj(mb,Ob){mb||Ob?(this.rBb=!0,this.Qza=mb,this.ana=Ob):this.a1f()}lVg(mb){this.w$f()&&(ua.a.Qk(mb,V.a.Kej,""+this.Qza),ua.a.Qk(mb,V.a.Jej,""+this.ana),
ua.a.Qk(mb,V.a.Lej,"1"),e.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.Qza} to ${this.ana}`))}w$f(){return null!=this.Qza&&0<this.Qza&&null!=this.ana&&0<this.ana}kVg(mb){if(this.Kv&&this.Jk){const Ob=this.Kv.Mjd(this.Jk.margin);Ob&&ua.a.Qk(mb,V.a.Aej,""+Ob.Top+" "+Ob.Bottom+" "+Ob.Left+" "+Ob.Right+" "+Ob.Header+" "+Ob.Footer)}}SDf(mb){this.lg&&(e.ULS.shipAssertTag(537154255,0,!!this.$.ua.na,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.ua.na&&(this.j8a?(mb||(mb=this.X6b(!1)),this.lg.eFi(mb)):this.OOj()))}Ffi(){return!this.DH.equals(this.Jk)}eJf(){!this.xPb&&0<this.vJb&&(this.Btd?this.OQd():e.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));e.ULS.shipAssertTag(537154250,0,!!this.lg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.lg&&this.lg.Qgi()}vj(){e.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");
if(this.lg){var mb=this.$Ra(O.a.instance.ga(1));this.OBa(mb,1)}else mb=Jb.a.hd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),w.EwaSettings.jy()?new Wb.a(this.$,mb):(new Eb.ErrorDialog(this.$,mb)).fg()}VOj(mb){mb?(0===mb.eA&&this.D$f()&&(e.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.yda.ObjectId?"floatingObject":"discontinuousRange"}.`),mb.eA=1),ya.vIe(mb,this.DH),ya.vIe(mb,this.Jk),e.ULS.shipAssertTag(537154248,
0,!!this.lg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.lg&&(this.Btd=!0,this.lg.XOj(),this.iqd())):(e.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.vj())}r3c(mb,Ob,Ta){mb>Ob&&(Ob=Object(z.a)(new Ba.a,{extendedProperties:new Map}),Ob.extendedProperties.set("WtpSelectedValue",Ta),Ob.extendedProperties.set("FullyRenderedPdfLoadTime",mb.toString()),I.Health.instance.recordQosError(Za.a.UQj,
[La.a.kdg],!1,!0,!0,!1,Ob))}hY(){this.v9a&&(0<this.oca||this.o9a)&&(e.ULS.sendTraceTag(537154246,0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.oca}.`),this.$.userOperationManager.rua(this.v9a),this.o9a?eb.a.Wt(this.o9a.Xs):this.c3.Wt(this.oca),this.xPd())}xPd(){this.o9a=this.v9a=null}Cli(){this.JOd&&this.Jk&&(this.x4a=this.$.Mb.Kc("UserAction",(1===this.Jk.eA?"ActiveSheet":0===this.Jk.eA?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}a1f(){this.rBb=
!1;this.Qza=1;this.ana=this.yJd}$Ra(mb){if(mb)return mb.replace("&#39;","'");e.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return mb}OOj(){e.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.sCb)e.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{let mb=this.$Ra(O.a.instance.ga(1216));this.OBa(mb,3)}}OBa(mb,Ob,Ta=
null){this.lg.Xz(mb,Ob,Ta)}Mli(){this.j8a=this.sCb=!0;e.ULS.sendTraceTag(557061534,0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.sCb}, isPdfPreviewSupportedInPreviewer: ${this.j8a}`)}rtj(){this.l9a=null;this.xPd();this.a1f();this.tIb=this.$.Mb.Kc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.na.activeCell.toString();this.vJb=0;this.Btd=this.x7a=this.xPb=!1;this.TOc=!0}IMj(){const mb=this.Kzi()||this.Zzi();e.ULS.sendTraceTag(537154242,
0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${mb}`);return mb}S6g(){let mb=15;ba.a.MH&&ba.a.evb&&(mb=parseFloat(ba.a.evb));return 14<mb&&this.sCb}Kzi(){var mb;const Ob="teams"===(null===(mb=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.Z7])||void 0===mb?void 0:mb.toLowerCase());e.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${ba.a.cB} isTeamsUIHost: ${Ob} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);return ba.a.cB||Ob}Zzi(){return!this.$.ke.get(111)}T1f(){this.l9a&&
(URL.revokeObjectURL(this.l9a),this.l9a=null)}ffh(mb){var Ob=mb.data.me;mb=this.$.Mb.Kc("UserAction","PrintPreviewBlobFileCreation");var Ta=window.self.atob(Ob);Ob=new Uint8Array(Ob.length);for(let sb=0;sb<Ta.length;sb++)Ob[sb]=Ta.charCodeAt(sb)&255;Ta=new Blob([Ob],{type:"application/pdf"});this.l9a=URL.createObjectURL(Ta);e.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${mb.Fc} ms. Blob size: ${Ta.size}`);mb.stop();return this.l9a+
"#toolbar=0&zoom=100"}Tij(mb){if(this.JOd&&Jb.a.lh(mb,X.l9i)){const Ob=Object(z.a)(new Ba.a,{extendedProperties:new Map});Ob.extendedProperties.set("ErrorMessageIdName",mb[0].MessageIdName);I.Health.instance.recordQosError(Za.a.qRf,[La.a.rRf],!1,!0,!0,!1,Ob)}}Efi(mb,Ob){return mb.sheetPrintOptions.PrintGrid!==Ob.selectedPrintGridlines||mb.sheetPrintOptions.HorizontalCenter!==Ob.selectedHorizontalCenter||mb.sheetPrintOptions.VerticalCenter!==Ob.selectedVerticalCenter||mb.sheetPrintOptions.PrintHeaders!==
Ob.selectedRowAndColumnHeadings}S_j(){this.kAi&&this.$.Yc(1936706533,-1,0,null)}xqi(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier}getToken(){e.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.wGb.tL("Print",this.graphServiceEndpoint).then(mb=>mb?(mb.IsSuccess?e.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
e.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${mb.ErrorCode}, Error message : ${mb.ErrorMessage}`),mb):Object(z.a)(new Nb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(mb=>{let Ob=new Nb.a;Object.getType(mb)===Object.getType(Ob)?Ob=mb:(Ob.ErrorMessage=mb.toString(),Ob.ErrorCode="exception");return Promise.resolve(Ob)})}Fcc(){return()=>{const mb=Promise.resolve("");try{if(this.wGb&&this.wGb.j7a())return this.getToken().then(Ob=>
Ob.IsSuccess?Promise.resolve(Ob.Token):mb,()=>mb)}catch(Ob){e.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return mb}}onNotifyPrintJobStatus(mb,Ob){mb=lb.a.nJ.notificationBar.eaa(mb,!1);"pending"==Ob&&(mb.displayTimeoutSeconds=3,this.S_j());if(Na.a.ACb())switch(Ob){case "failure":mb.image=1;break;case "success":mb.image=3;break;default:mb.image=0}else mb.image=0;lb.a.nJ.notificationBar.rE(mb)}}X.l9i=[-953554093,1773721536,-1104435974,
-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];X.AJh=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(X,"PrintPreviewManager",null,[448,3,449]);class F{constructor(mb,Ob,Ta){this.ignorePrintArea=!1;this.k_j=()=>{const sb=t.h(this.$).Ca;this.yUc=!0;sb.OCd()};this.b1i=()=>{this.jmd()};this.a1i=(sb,zb,db)=>{e.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${db} failed to execute`);
this.jmd()};this.$=mb;this.ea=mb.ea;this.V8b=Ob;this.lbb=new A(1,this.ignorePrintArea);this.PF=Ob=new X(mb,Ob,f.AFrameworkApplication.Hd,Ta);this.$.da.Ha(418,Ob);this.pRf=new ta(mb);this.$.da.Ha(384,this);this.yUc=!1}get G$f(){return this.yUc}Mc(){return!1}executeCommand(mb,Ob,Ta,sb){const zb=Ob.command;return 1588554917===zb||1531172830===zb||-2050819419===zb?(Ob.BBb=!0,y.a(this.$)&&this.$.da.Ba(423).$Ac(!1),this.gsh(Ob)?ib.Task.Ta(!0):u.a(zb)):this.pRf.executeCommand(mb,Ob,Ta,sb,this.b1i,this.a1i,
this.k_j)}Ac(mb,Ob){switch(Ob.command){case 1588554917:return e.ULS.shipAssertTag(537154305,0,this.$.nla,"Command execute requested for Print operation when data duplication is disallowed."),!0;case 1531172830:return w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1);case -2050819419:return w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1);default:return this.pRf.Ac(mb,Ob)}}Rc(){return!1}gsh(mb){return this.$.ea.Yb?this.hsh(mb):!1}hsh(mb){e.ULS.sendTraceTag(21099871,
0,50,"PrintCommandHandler:DoPrintHtml");const Ob=this.$.Mb.Kc("UserAction","DoPrintHtml");var Ta=this.$;Ta=this.t4h(Ta,this.ea.isNamedObjectViewMode?Ta.Bb.na.sheetName:Ta.ua.na.name);if(v.a(this.$))e.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened.");else{const sb=1531172830===mb.command||-2050819419===mb.command;this.PF.UOj(Ta,this.lbb,sb);e.ULS.sendTraceTag(591196515,0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${sb} Command: ${n.a[mb.command]}`)}Ob.stop();
this.jmd();return!0}t4h(mb,Ob){const Ta={};Ta.SessionId=this.ea.sessionId;Ta.UsedRangeTooBig=!1;var sb=t.h(mb),zb=sb.ha;const db=zb.Oe;if(x.e(mb.na))Ta.Type=0,Ta.ObjectId=mb.na.name,Ta.UseSelection=!1;else if(x.g(mb.na))Ta.Type=1,Ta.ObjectId=mb.na.imageId,Ta.UseSelection=!0;else if(2===db||4===db||64===db)sb=zb.Sa.jc.floatingObject,Ta.Type=1,Ta.SheetName=Ob,Ta.ObjectId=sb.id,Ta.UseSelection=!0;else if(db&470)Ta.ObjectId=zb.Sa.jc.floatingObject.id,Ta.SheetName=Ob;else if(x.i(mb.na)){Ta.Type=2;Ta.SheetName=
Ob;if(zb.ra.eh)if(zb=zb.ra.xd,Ta.SelectedRanges=m.q(zb,mb),20<zb.hw)Ta.UseSelection=!0;else{Ob=0;sb=sb.Qj("PrintCommandHandler.DoPrintHtml",zb);try{for(sb.$$rst();sb.$$mn()&&2>Ob;)sb.$$cu().text&&Ob++;Ta.UseSelection=2<=Ob}finally{sb&&sb.dispose()}}else Ta.UseSelection=!1,Ta.SelectedRanges=m.q(zb.ra.activeRange,mb);this.ea.isNamedObjectViewMode&&(Ta.UsedRange=m.v(mb.na.usedRange,mb))}Ta.Title=mb.workbookContext.WorkbookFileName;return Ta}jmd(){t.h(this.$);if(!this.G$f){this.yUc=!0;const mb=this.$.Mb.Kc("UserAction",
"HandlePageLayoutRendering");this.B_j();e.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${mb.Fc} ms.`);mb.stop()}}B_j(){const mb=t.h(this.$).Ca,Ob=mb.iz();let Ta=!1,sb=0;for(let zb=0;zb<Ob.length;zb++){const db=Ob[zb],jb=db.wf;jb&&jb.hasPageLayout()&&(Ta=!0,jb.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+db.gd,4),sb++)}Ta&&(e.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${Ob.length}, number of blocks that require re-rendering is ${sb}`),
mb.OCd())}}Object(b.a)(F,"PrintCommandHandler",null,[222,433]);var na=a(1108),hb=a(1320),Ib=a(1321),vc=a(108),nc=a(153),Pb=a(54),oc=a(70);class Ic extends h.a{constructor(mb){super(mb)}ld(){var mb=f.AFrameworkApplication.fa.appSettings,Ob=this.$.ya.DirectPrintSetting;mb.DirectPrintIsEnabled=Ob.DirectPrintIsEnabled.toString();mb.DirectPrintProbeIsEnabled=Ob.DirectPrintProbeIsEnabled.toString();mb.DirectPrintEnabledForInternetExplorer=Ob.DirectPrintEnabledForInternetExplorer.toString();mb.DirectPrintSupportedMimeTypes=
Ob.DirectPrintSupportedMimeTypes;mb.DirectPrintSupportedPlugins=Ob.DirectPrintSupportedPlugins;mb.DirectPrintImmersivePreviewPlugins=Ob.DirectPrintImmersivePreviewPlugins;mb.DirectPrintMinimalSupportedEdgeVersion=Ob.DirectPrintMinimalSupportedEdgeVersion;mb.DirectPrintEnabledForEdge=Ob.DirectPrintEnabledForEdge.toString();mb=new na.a(mb);let Ta=null;Ob=null;try{Ob=window.navigator.mimeTypes}catch(zb){e.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let sb=null;try{sb=
window.navigator.plugins}catch(zb){e.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Ta=new Ib.a(mb,Ob,sb,Ib.a.okf,Ib.a.Tof,new hb.a(f.AFrameworkApplication.sa.fX),f.AFrameworkApplication.sa.SD,Ib.a.Uof,(zb,db)=>new d.a(zb,!1,db),!1);if(w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.ke.get(116)){const zb=Object(oc.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")?Object(vc.c)(nc.a.resolve(Pb.D,{Wb:this.Na})):
l.GetServiceTaskFactory.Pa(this.$.da,349,350,this.Na);k.TaskExtensions.za(zb,()=>{const db=new F(this.$,Ta,zb.result);this.fd([db])},this.$.ka)}else this.fd([new F(this.$,Ta,null)])}static la(mb){h.a.Rd(73,new Ic(mb))}}Object(b.a)(Ic,"PrintCommandHandlerFactory",h.a,[]);a.d(B,"a",function(){return ec});const ec=()=>{c.a.Fa(Ic.la)}},1181:function(r,B,a){var c=a(9),b=a(0),e=a(228),f=a(50),d=a(38),h=a(15),l=a(91),k=a(87),w=a(248),n=a(631),x=a(214),m=a(117),u=a(36),t=a(41),y=a(242),v=a(46),A=a(6),z=a(37),
C=a(74),H=a(599);class I extends y.a{constructor(mb,Ob){super(mb);this.c8j=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.gHb=()=>{const Ta=this.pYh();if(Ta){this.$.oI(!0);if(-2028960985!==this.command&&1461300262!==this.command){const sb=C.a(this.$).kd.activityState;sb[z.a.wZa]=A.a.download;sb[H.a.uXc]=this.command}v.a(this.$).St(Ta.Errors)}};this.iframe=mb;this.$=Ob;this.Gc.la("load",this.gHb)}get lii(){return"loading"!=this.iframe.contentDocument.readyState&&
"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(mb,Ob){const Ta={};(mb=this.CIh(mb,Ta))&&t.a.qtc("dlfr",mb,Ta);this.command=Ob}CIh(mb,Ob){var Ta=mb.split("?");if(2!==Ta.length)return mb=null,h.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),mb;Ta=Ta[1].split("&");for(const zb of Ta){var sb=zb.split("=",2);if(2!==sb.length){mb=null;h.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");
break}Ta=sb[0];this.c8j.includes(Ta)&&(sb=decodeURIComponent(sb[1]),Ob[Ta]=sb,mb=x.a.IKb(mb,Ta))}return mb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}pYh(){try{return this.iframe.contentWindow.ewaResult}catch(mb){if(!this.$.ea.ic.isDivSyndicated){const Ob=window.document.referrer.match(RegExp("://(.[^/]+)/"));h.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<Ob.length?Ob[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.s7a}`);
throw mb;}return null}}static Pxe(mb){let Ob=document.createElement("iframe");Ob.id="ewaFileLoader";Ob.style.cssText="height:0;width:0;display:none";Ob.src="about:blank";Ob.setAttribute("name","dlfr");Ob=mb.domElement.appendChild(Ob);return new I(Ob,mb)}}Object(b.a)(I,"FileLoader",y.a,[]);var S=a(152),P=a(58);class D{constructor(mb,Ob){this.Wc=()=>{u.a.ng(C.a(this.$).kd.activityState,S.a.nDd)||this.jva.reset()};this.$=Ob;this.xnc=mb;this.ea=Ob.ea;this.ea.Oj(this.Wc);this.jva=I.Pxe(this.$)}Nsh(){const mb=
this.m2g(this.$),Ob=this.$.userOperationManager.operationCount;0<Ob&&h.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${Ob}`);this.$.userOperationManager.c4("DownloadACopyOperation.DownloadForkedFile");this.xnc&&h.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.jva.downloadFile(mb,-21742208);d.TaskExtensions.za(P.Task.delay(1),()=>{this.Iff()},this.jva.ka,3)}dispose(){this.ea&&this.ea.pk(this.Wc);this.$=this.ea=null}Iff(mb=null){mb||(mb=
this.$.Mb.Kc("LoadResource","DownloadACopyOperation"));!this.jva.lii&&mb.Fc<D.gxf?window.setTimeout(()=>{this.Iff(mb)},D.Osh):(mb.Fc>=D.gxf&&h.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),C.a(this.$).kd.pM())}m2g(mb){const Ob=new Sys.StringBuilder,Ta=mb.workbookContext,sb=mb.ya;Ob.append(mb.boa);Ob.append(sb.FileHandlerRelativeUri);Ob.append("?id=");Ob.append(encodeURIComponent(x.a.IKb(Ta.WorkbookUri,"sc")));mb.ea.Yb&&(Ob.append("&sessionId="),Ob.append(encodeURIComponent(mb.ea.sessionId)));
Ob.append("&workbookType=FullForkedWorkbook");Ob.append("&dataloss=");Ob.append(this.xnc?"true":"false");m.a.Ypb(Ob,sb);return Ob.toString()}}D.gxf=1E5;D.Osh=100;Object(b.a)(D,"DownloadACopyOperation",null,[3]);class G extends w.a{constructor(mb,Ob,Ta=!1){super(mb,Ob);this.$Eb=null;this.DFd=sb=>{this.unsubscribe(zb=>{sb.remove_disposing(zb)});this.qh(A.a.Pj);this.qp()};this.xnc=Ta}execute(mb){const Ob=Object(k.a)(9,mb.Ke);if(!Ob.nla)return h.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),
this.lqd(mb),this.qh(A.a.idle),1;this.$Eb||(this.$Eb=new D(this.xnc,Ob));this.$Eb.Nsh();h.ULS.shipAssertTag(537154817,0,3!==C.a(Ob).Vh.vu,"The current activity should not be closed.");return 1}lqd(mb){const Ob=Object(k.a)(9,mb.Ke),Ta=new n.a(Ob);this.subscribe(mb,this.DFd,sb=>{Ta.add_disposing(sb)});h.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Ta.initialize();Ta.fg()}dispose(){l.a.Ja(this.$Eb);this.$Eb=null;super.dispose()}}
Object(b.a)(G,"DownloadAForkedCopyActivity",w.a,[]);class E extends e.a{constructor(mb){super();this.$=mb;this.Gb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na),()=>{this.qb(new G(A.a.W2a,A.a.Pj,!0))},this.ka)}}Object(b.a)(E,"DownloadACopyPreDatalossActivityFactory",e.a,[]);class O extends e.a{constructor(mb){super();this.$=mb;this.Gb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na),()=>{this.qb(new G(A.a.unmergeableDownloadCopy,
A.a.spa))},this.ka)}}Object(b.a)(O,"DownloadAForkedCopyActivityFactory",e.a,[]);var N=a(88),J=a(4),W=a(82),ea=a(27),R=a(111),Y=a(25);class U{constructor(mb,Ob,Ta){this.La=mb;this.kCg=Ob;this.P1=Ta}Hg(){this.La.Qb(Y.a.tryMacOffice,R.a.frame,Object(N.a)(this,this.e5i,"onTryMacOffice"));this.La.Qb(Y.a.Qjg,R.a.frame,Object(N.a)(this,this.hMf,"onTryMacOfficeFromViewer"));this.La.Qb(Y.a.Pjg,R.a.frame,Object(N.a)(this,this.hMf,"onTryMacOfficeFromViewer"))}e5i(mb,Ob,Ta,sb,zb){if(1===Ta)return 32;zb?(mb=zb.SourceControlId,
"btnjTryMacOfficeForWordEditor"===mb?t.a.nf(W.a.BZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===mb&&t.a.nf(W.a.BZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.dsf();return 32}hMf(mb,Ob,Ta){if(1===Ta)return 32;switch(mb){case Y.a.Qjg:t.a.nf(W.a.BZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Y.a.Pjg:t.a.nf(W.a.BZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}dsf(){t.a.nf(U.bKi,"_blank",
void 0,"LaunchMacTrialWindow")}get vAc(){return this.kCg&&ea.a.isMac&&!ea.a.Cwi&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get XKj(){return this.vAc}static get bKi(){return W.a.wH("522401")}}Object(b.a)(U,"MacOfficeOffer",null,[500]);var da=a(86);class T{constructor(mb,Ob,Ta){this.La=mb;this.oCg=Ob;this.DIc=null;(this.XZb=J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&da.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(sb=>
{this.DIc=sb});this.P1=Ta}Hg(){this.La.Qb(Y.a.tryOffice,R.a.frame,Object(N.a)(this,this.f5i,"onTryOffice"));this.La.Qb(Y.a.tryOfficeThroughTellMe,R.a.frame,Object(N.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Qb(Y.a.Tjg,R.a.frame,Object(N.a)(this,this.Ujg,"tryOfficeThroughViewer"));this.La.Qb(Y.a.Sjg,R.a.frame,Object(N.a)(this,this.Ujg,"tryOfficeThroughViewer"))}f5i(mb,Ob,Ta,sb,zb){if(this.XZb&&1===Ta)return this.isFreemiumUpsellEnabled&&this.fOb?32:8;2===Ta&&(zb?(mb=zb.SourceControlId,
"btnjTryOfficeForWordEditor"===mb?t.a.nf(W.a.BZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===mb?t.a.nf(W.a.BZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.wmc()):this.wmc());return 32}tryOfficeThroughTellMe(mb,Ob,Ta,sb,zb){if(this.XZb&&1===Ta)return this.isFreemiumUpsellEnabled&&this.fOb?32:8;2===Ta&&(zb?(mb=zb.SourceControlId,t.a.nf(W.a.wH("862405")+this.y3h(mb),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):t.a.nf(W.a.wH("522402"),
"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}Ujg(mb,Ob,Ta){if(this.XZb&&1===Ta)return this.isFreemiumUpsellEnabled&&this.fOb?32:8;if(2===Ta)switch(mb){case Y.a.Tjg:t.a.nf(W.a.BZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Y.a.Sjg:t.a.nf(W.a.BZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get XAf(){return this.fOb}get ARi(){return this.fOb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get fOb(){return this.oCg&&!ea.a.isMac}get isFreemiumUpsellEnabled(){let mb=
!1;this.DIc&&(mb=this.DIc.isFreemiumUpsellEnabled());return mb}wmc(mb=null){let Ob=0;mb&&(Ob=mb);t.a.nf(T.d1h(Ob),"_blank",void 0,"LaunchOfficeOffer")}y3h(mb){let Ob=0;switch(mb){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":Ob=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":Ob=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":Ob=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":Ob=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":Ob=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":Ob=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":Ob=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":Ob=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":Ob=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":Ob=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":Ob=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":Ob=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":Ob=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":Ob=19;
break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":Ob=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":Ob=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":Ob=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":Ob=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":Ob=29}return 0===Ob?"":String.format("&pc={0:D}",Ob)}static d1h(mb){if(ea.a.Pg)switch(mb){case 1:return W.a.wH("393806");case 2:return W.a.wH("393810");case 3:return W.a.wH("393809");case 5:return W.a.wH("393805")}else if(ea.a.jp)switch(mb){case 1:return W.a.wH("521979");
case 3:return W.a.wH("521980");case 5:return W.a.wH("521978");case 2:return W.a.wH("522490")}else{if(2===mb)return W.a.wH("517778");if(1===mb)return W.a.BZ(30)}return W.a.wH("522402")}}Object(b.a)(T,"OfficeTrialExperience",null,[499]);class ka{Kh(mb){mb.register(T,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").tc().Bc(()=>new T(J.AFrameworkApplication.rb,J.AFrameworkApplication.nCb,J.AFrameworkApplication.lcid));mb.register(U,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").tc().Bc(()=>
new U(J.AFrameworkApplication.rb,J.AFrameworkApplication.Ljc,J.AFrameworkApplication.lcid))}}Object(b.a)(ka,"OpenInClientConfiguration",null,[5]);var L=a(558),fa=a(1394),wa=a(39),oa=a(1229),xa=a(156),bb=a(163),Za=a(229),La=a(13),va=a(90),Ba=a(113),Ea=a(92);const pa=mb=>{for(let Ob=0;Ob<mb.children.length;Ob++){const Ta=mb.children[Ob];Ta.style.position="relative";Ta.style.top=(Ta.parentNode.offsetHeight-Ta.offsetHeight)/2+"px"}},$a=mb=>mb.Ea.keyCode===va.a.Sh||mb.Ea.keyCode===va.a.cfa?(mb.Ob.click(),
!0):!1,cb=(mb,Ob,Ta,sb,zb,db,jb)=>{const Ub=document.createElement("a");Ub.className="ProtocolLaunchingDialogButtonAnchor";Ub.className+=" OICDialog";Ub.id=mb;Ub.setAttribute(Ea.a.Jd,Ea.a.Ws);Ub.style.padding="0";Ub.style.margin="0";sb&&ib(zb,Ob,Ta,sb,Ub);mb=document.createElement("span");mb.className="ProtocolLaunchingDialogButtonLabel";mb.innerText=zb;Ub.appendChild(mb);Ub.tabIndex=0;db&&Za.a.instance.ta(La.a.click,Ub,db);jb&&Ba.KeyInputManager.instance.ta(La.a.Qd,Ub,jb);return Ub},ib=(mb,Ob,Ta,
sb,zb)=>{var db=document.createElement("img");db.alt=mb;db.className=bb.getImageClassWithCluster(Ta,sb);db.src=Ob;db.setAttribute(Ea.a.Jd,Ea.a.yq);mb=document.createElement("span");mb.className="ProtocolLaunchingDialogImg32Container";mb.appendChild(db);db=document.createElement("span");db.className="ProtocolLaunchingDialogIconContainer";db.appendChild(mb);zb.appendChild(db)};class ta{static get qg(){return xa.a.Iq(ta.Ql,CommonUIStrings.l_OICLaunchDialogTitle)}}ta.Ql="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(ta,"OICLaunchDialogHtml",null,[]);class Ya extends xa.a{constructor(mb){super();this.TVa=this.LDa=null;this.Fqa=!1;this.oq=mb;this.qg=ta.qg;this.Rb=5;this.we="OICLaunchDialog";this.showDialog("",Object(N.a)(this,this.TRi,"oicLaunchDialogResultHandler"));this.Z7f();this.VW("ProtocolLaunchingDialogTitle");4!==J.AFrameworkApplication.sa.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.DI(this.LDa);h.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}kab(){this.LDa=cb("BtnRichClient",this.oq.Nub,this.oq.oAb,this.oq.Hod,CommonUIStrings.l_OICLaunchRichClient,Object(N.a)(this,this.YJf,"onRichClientButtonClick"),$a);document.getElementById("OICLaunchRichClient").appendChild(this.LDa);pa(this.LDa);this.TVa=cb("BtnReturn",this.oq.Nub,this.oq.oAb,this.oq.Uff,CommonUIStrings.l_OICReturnToOnlineClient,Object(N.a)(this,this.VJf,"onReturnButtonClick"),
$a);document.getElementById("OICReturnToApp").appendChild(this.TVa);pa(this.TVa)}VJf(){this.hide();this.oq.Idb();return!0}YJf(){h.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();J.AFrameworkApplication.rb.processAction(Y.a.LRa,2);return!0}TRi(){this.oq.Idb()}dispose(){this.Fqa||(this.LDa&&(Za.a.instance.Aa(La.a.click,this.LDa,Object(N.a)(this,this.YJf,"onRichClientButtonClick")),Ba.KeyInputManager.instance.Aa(La.a.Qd,this.LDa,$a)),this.TVa&&(Za.a.instance.Aa(La.a.click,
this.TVa,Object(N.a)(this,this.VJf,"onReturnButtonClick")),Ba.KeyInputManager.instance.Aa(La.a.Qd,this.TVa,$a)),super.dispose(),this.Fqa=!0)}}Object(b.a)(Ya,"OICLaunchDialog",xa.a,[]);class Da{static get qg(){return xa.a.Iq(Da.Ql,CommonUIStrings.l_OICDialogTitle)}}Da.Ql="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(Da,"ProtocolLaunchingDialogV2Html",null,[]);a(426);var ba=a(112);class ya extends xa.a{constructor(mb){super();this.SVa=this.pfa=null;this.Fqa=!1;this.kqa=null;this.oq=mb;this.qg=Da.qg;this.Rb=5;this.we="ProtocolLaunchingDialog";this.IKc="OICRetryDialog";J.AFrameworkApplication.ti.m6a&&J.AFrameworkApplication.ti.Ywc();J.AFrameworkApplication.ti.ig(new ba.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(N.a)(this,this.aKd,"protocolLaunchingDialogResultHandler"));
this.Z7f();this.VW("Issues");this.$_e();h.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}kab(){const mb=document.getElementById("Issues");if(mb){ib("",this.oq.Nub,this.oq.oAb,this.oq.Hod,mb);const Ob=document.createElement("span");Ob.className="WACDialogSectionTitle";Ob.innerText=5===this.oq.cNf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;mb.appendChild(Ob);pa(mb);mb.style.display="none"}J.AFrameworkApplication.sa.Qa.Ald?
(this.SVa=cb("GiveFeedback",this.oq.Nub,this.oq.oAb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(N.a)(this,this.wqc,"onGiveFeedbackClick"),Object(N.a)(this,this.kGf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.SVa),pa(this.SVa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===J.AFrameworkApplication.sa.Qa.editMode||J.AFrameworkApplication.yqh?document.getElementById("ButtonEdit").style.display="none":
(this.pfa=cb("Edit",this.oq.Nub,this.oq.oAb,"",2===J.AFrameworkApplication.sa.Qa.ri?4===J.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===J.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(N.a)(this,this.GEf,"onEditClick"),Object(N.a)(this,this.KEf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.pfa),pa(this.pfa));0===
J.AFrameworkApplication.sa.Qa.editMode&&!J.AFrameworkApplication.nCb&&mb&&(mb.style.display="none")}b0e(){return this.kqa?(this.DI(this.kqa),!0):!1}$_e(){return this.pfa?(this.DI(this.pfa),!0):!1}KEf(mb){return this.MDd(mb,0)}kGf(mb){return this.MDd(mb,2)}UJf(mb){return this.MDd(mb,1)}MDd(mb,Ob){let Ta=!1;if(mb.Ea.keyCode===va.a.Sh||mb.Ea.keyCode===va.a.cfa)mb.Ob.click(),Ta=!0;else if(mb.Ea.keyCode===Sys.UI.Key.down||mb.Ea.keyCode===Sys.UI.Key.up)switch(Ob){case 1:Ta=this.$_e();break;case 0:Ta=this.b0e()}return Ta}GEf(){this.hide();
4===J.AFrameworkApplication.sa.Qa.editMode?(h.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.oq.Idb()):(h.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.oq.Yld());return!0}wqc(){h.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.oq.Obf();return!0}wrc(){h.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";J.AFrameworkApplication.rb.processAction(Y.a.LRa,2);return!0}aKd(){this.oq.Idb()}switchToBackupMode(){var mb=
document.getElementById("ProtocolLaunchingDialogTitle");if(mb){mb.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(mb=document.getElementById("Issues"))mb.style.display="block";(mb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!mb.children.length&&(this.kqa=cb("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(N.a)(this,this.wrc,"onRetryOICClick"),Object(N.a)(this,this.UJf,"onRetryOICKeyUp")),mb.appendChild(this.kqa),pa(this.kqa),this.pfa||this.b0e())}}dispose(){this.Fqa||(this.pfa&&
(Za.a.instance.Aa(La.a.click,this.pfa,Object(N.a)(this,this.GEf,"onEditClick")),Ba.KeyInputManager.instance.Aa(La.a.Qd,this.pfa,Object(N.a)(this,this.KEf,"onEditKeyUp"))),this.SVa&&(Za.a.instance.Aa(La.a.click,this.SVa,Object(N.a)(this,this.wqc,"onGiveFeedbackClick")),Ba.KeyInputManager.instance.Aa(La.a.Qd,this.SVa,Object(N.a)(this,this.kGf,"onGiveFeedbackKeyUp"))),this.kqa&&(Za.a.instance.Aa(La.a.click,this.kqa,Object(N.a)(this,this.wrc,"onRetryOICClick")),Ba.KeyInputManager.instance.Aa(La.a.Qd,
this.kqa,Object(N.a)(this,this.UJf,"onRetryOICKeyUp"))),super.dispose(),this.Fqa=!0)}}Object(b.a)(ya,"ProtocolLaunchingDialog",xa.a,[]);var V=a(141),Z=a(432);class ja extends V.StandardDialog{constructor(mb){super();this.oq=mb;this.we="ProtocolLaunchingDialog";J.AFrameworkApplication.ti.m6a&&J.AFrameworkApplication.ti.Ywc();J.AFrameworkApplication.sa.Qa.Ald&&this.Aqe(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(N.a)(this,this.wqc,"onGiveFeedbackClick"));ja.Mcf?(this.Rb=12,this.wc(1,
CommonUIStrings.l_CloseFile),this.wc(2,CommonUIStrings.l_OICDialogContinueHere),this.wc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Rb=4,this.wc(1,CommonUIStrings.l_OICDialogContinueHere),this.wc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.zFb(CommonUIStrings.l_OICDialog2ndTitle,5===this.oq.cNf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(N.a)(this,this.aKd,"protocolLaunchingDialogResultHandler"),null)}wqc(mb){h.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.cFf(mb)}wrc(){h.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");J.AFrameworkApplication.rb.processAction(Y.a.LRa,2)}aKd(mb){ja.Mcf?3===mb?this.L1f():2===mb||0===mb?this.continueEditing():1===mb&&this.t9g():2===mb?this.L1f():(1===mb||0===mb)&&this.continueEditing()}t9g(){h.ULS.sendTraceTag(577783557,211,50,"Closing the document");J.AFrameworkApplication.rb.$d(Y.a.close,2,Z.a)}L1f(){h.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(N.a)(this,
this.wrc,"onRetryOICClick"),0)}continueEditing(){4===J.AFrameworkApplication.sa.Qa.editMode||J.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===J.AFrameworkApplication.sa.mode?(h.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.oq.Idb()):(h.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.oq.Yld())}static get Mcf(){return J.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===J.AFrameworkApplication.rb.processAction(Y.a.close,
1)}}Object(b.a)(ja,"StandardProtocolLaunchingDialog",V.StandardDialog,[]);var la=a(1274);class ua{}Object(b.a)(ua,"EditDocumentInClientParams",null,[]);class eb{static $$c(mb,Ob,Ta,sb,zb,db,jb=!1,Ub=!1,xd="",ne=!1,fe=!1,Bd=!1,Ue="",mc="",Fc="",bd=!1,de=""){const Md=new ua;Md.DocumentUrl=mb;Md.DocumentExtension=de;Md.Mode=Ob;Md.Options=Ta;Md.Application=sb;Md.SilentExternalHandler=jb;Md.EncodeUrl=Ub;Md.CorrelationIdForWinClient=xd;Md.NavigateUsingWindowOpen=ne;Md.DescriptiveUnattemptedEnums=fe;Md.NoBrowserModalDialogs=
Bd;Md.SessionOrigin=Ue;Md.CorrelationId=mc;Md.ClickTime=Fc;Md.NewTelemetryDataIsEnabled=bd;MSOJS.ClientUtils.EditDocumentInClient(Md,zb,db)}}Object(b.a)(eb,"ClientUtils",null,[]);var Eb=a(102),Wb=a(150),Ab=a(475),Jb=a(178),Gb=a(842),Nb=a(381),Ja=a(172),ab=a(72),wb=a(199);class xb{constructor(mb){this.kga=this.W9d=this.$Va=null;this.mkb=!1;this.hLc=this.yQc=this.khe=null;this.tTb=this.bE=this.MYb="";this.application=this.ZB=0;this.YUj=this.WYd=!1;this.h8j=mb&&J.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");
J.AFrameworkApplication.rb.h4(Y.a.LRa)||J.AFrameworkApplication.rb.Qb(Y.a.LRa,R.a.frame,Object(N.a)(this,this.Wuj,"retryOpenInClientAction"));this.Ocg=!!J.AFrameworkApplication.fa&&J.AFrameworkApplication.fa.qa("SilentExternalHandler")}get cNf(){return this.ZB}Hzc(mb,Ob="",Ta=""){this.bE=Ta||Jb.a.create().toString();this.MYb=Ob||Ab.a.j7e();this.tTb=mb}Wuj(mb,Ob,Ta){return Ob.contextId!==R.a.frame?2:1===Ta?32:this.LRa()}get options(){let mb=0;J.AFrameworkApplication.Tsj&&(mb|=1);J.AFrameworkApplication.openInClientEditOnly&&
(mb|=4);this.UUj()&&(mb|=64);return mb}UUj(){return!(2===this.application&&J.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))}get Nub(){return J.AFrameworkApplication.ZA}get oAb(){return J.AFrameworkApplication.K6a}get Uff(){return""}get Hod(){return""}get Sfg(){return J.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}get nDc(){return this.khe||(this.khe=da.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.WYd||this.xHh()}Idb(){this.YUj||this.PHh()}kVf(mb){this.h8j&&
ea.a.Pg?new Ya(this):this.I5b(mb)}I5b(mb){const Ob=({BCa:mb}=this.aDi(mb)).returnValue;h.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===Ob,mb);return Ob}Aha(mb,Ob,Ta,sb,zb,db){this.$Va=mb;this.hLc="";this.W9d=Ob;this.kga=db;this.application=Ta;this.ZB=sb;J.AFrameworkApplication.downloadCopyOnOpenInClient?this.$rf():J.AFrameworkApplication.limitedEdit&&!J.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?J.AFrameworkApplication.icg():this.SYg(zb)}get SRi(){return!!J.AFrameworkApplication.fa&&
J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}LRa(){this.SRi&&this.$Fi();return this.I5b(this.mkb)}C5f(){const mb=new Gb.a(Ja.a.openInClient);mb.Values["ui-language"]=J.AFrameworkApplication.lcid.toString();mb.Values[la.a.r8c]=J.AFrameworkApplication.userSessionId;return this.kga.value.send(mb)?32:8}$Fi(){Eb.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new wb.a,{inStaging:!0}))}EAj(mb){const Ob=
new Gb.a(Ja.a.dak);Ob.Values["ui-language"]=J.AFrameworkApplication.lcid.toString();Ob.Values[la.a.r8c]=J.AFrameworkApplication.userSessionId;Ob.Values[Nb.a.cak]=mb;this.kga.value.send(Ob)}aDi(mb){this.mkb=mb;this.EAj(5===this.ZB?xb.B6i:xb.D6i);return 5===this.ZB?this.$Ci():this.eDi()}$Ci(){this.hsf();return{returnValue:32,BCa:"HostEditUrl,"}}eDi(){let mb;var Ob=mb="";J.AFrameworkApplication.tre&&(Ob="|f|"+J.AFrameworkApplication.userSessionId);const Ta=J.AFrameworkApplication.fa.qa("IsAssignmentMode")&&
J.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||J.AFrameworkApplication.isUnifiedHostMode||ea.a.Xxa,sb=J.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),zb=J.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(J.AFrameworkApplication.rb.Xoc){var db=J.AFrameworkApplication.rb.fV(3588168074);db&&this.Hzc(db.epochClickTime,db.sessionOrigin,db.correlationId);this.muf()}if(J.AFrameworkApplication.oQf){mb+="NewOrder,";db=8;this.kga&&this.kga.value&&
this.kga.value.isEnabled()&&J.AFrameworkApplication.A2d&&(mb+="Post,",db=this.C5f());if(32===db)return{returnValue:db,BCa:mb};h.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return J.AFrameworkApplication.um.Nab?(h.ULS.shipAssertTag(5566816,211,!!J.AFrameworkApplication.um.Nab),mb+="HostUrl,",{returnValue:J.AFrameworkApplication.sa.z$a(J.AFrameworkApplication.um.Nab),BCa:mb}):this.$Va?(h.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
J.AFrameworkApplication.userSessionId),mb+="DocUrl,",eb.$$c(this.$Va,this.ZB,this.options,this.application,Object(N.a)(this,this.JEf,"onEditInClientSuccess"),Object(N.a)(this,this.IEf,"onEditInClientFailure"),this.Ocg,J.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Ob,Ta,sb,zb,this.MYb,this.bE,this.tTb,J.AFrameworkApplication.rb.Xoc,this.hLc),{returnValue:32,BCa:mb}):{returnValue:8,BCa:mb}}mb+="OldOrder,";if(!this.$Va&&J.AFrameworkApplication.um.Nab)return this.kga&&this.kga.value&&this.kga.value.isEnabled()&&
J.AFrameworkApplication.A2d?(mb+="Post,",Ob=this.C5f()):(h.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Ob=8),32!==Ob?(h.ULS.shipAssertTag(22595484,211,!!J.AFrameworkApplication.um.Nab),mb+="HostUrl,",{returnValue:J.AFrameworkApplication.sa.z$a(J.AFrameworkApplication.um.Nab),BCa:mb}):{returnValue:Ob,BCa:mb};h.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",J.AFrameworkApplication.userSessionId);mb+="DocUrl,";eb.$$c(this.$Va,
this.ZB,this.options,this.application,Object(N.a)(this,this.JEf,"onEditInClientSuccess"),Object(N.a)(this,this.IEf,"onEditInClientFailure"),this.Ocg,J.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Ob,Ta,sb,zb,this.MYb,this.bE,this.tTb,J.AFrameworkApplication.rb.Xoc,this.hLc);return{returnValue:32,BCa:mb}}B_f(mb){J.AFrameworkApplication.Kn.setDw(8981,mb)}JEf(mb){this.B_f(mb);h.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===mb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.Sfg||
this.hsf(),this.muf()):this.WYd||this.closeApplication()}IEf(mb,Ob=0){h.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",mb,Ob);if(5===mb)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const Ta=!!this.W9d&&!this.mkb;let sb=0;1===mb&&(sb=2);6<=mb&&13>=mb&&(sb=1,1===Ob&&(this.WYd=!0));this.nDc.ARi?(h.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",sb),oa.a.instance.vih(this.mkb?Object(N.a)(this,
this.tBf,"oicErrorDialogHandlerCloseForced"):Object(N.a)(this,this.uBf,"oicErrorDialogHandlerNoCloseForced"),Ta?Object(N.a)(this,this.oHf,"onLaunchDownload"):null,this.dOe(!1)?Object(N.a)(this,this.Thi,"iHaveOfficeButtonHandler"):null,sb,Ob)):(h.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",sb),oa.a.instance.tih(this.mkb?Object(N.a)(this,this.tBf,"oicErrorDialogHandlerCloseForced"):Object(N.a)(this,this.uBf,"oicErrorDialogHandlerNoCloseForced"),Ta?Object(N.a)(this,this.oHf,
"onLaunchDownload"):null,sb))}}muf(){try{const mb=[Object.assign(new ab.a,{name:"CorrelationId",string:this.bE}),Object.assign(new ab.a,{name:"SessionOrigin",string:this.MYb}),Object.assign(new ab.a,{name:"ClickTime",string:this.tTb}),Object.assign(new ab.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Wb.a("OpenInClientCompleted",!0,0,mb)}catch(mb){h.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+mb.toString())}}hsf(){J.AFrameworkApplication.sa&&J.AFrameworkApplication.sa.Qa.Fv&&
J.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new ja(this):new ya(this)}tBf(){this.closeApplication()}uBf(){this.Idb()}oHf(){this.$rf()}Thi(){return this.dOe(!0)}dOe(mb){const Ob=(ea.a.Plf||ea.a.MH)&&!!J.AFrameworkApplication.U8b;Ob&&mb&&(t.a.nf(J.AFrameworkApplication.U8b,"_blank",void 0,"OpenInClient"),this.closeApplication());return Ob}}xb.D6i="OpenInDesktop";xb.B6i="OpenInBrowser";Object(b.a)(xb,"AOpenInClientOperation",null,[]);var rb=a(5),za=a(209),Aa=a(73),pb=a(60),kb=a(332),
Cb=a(49),ob=a(45),qa=a(200),ma=a(96),Ga=a(29),vb=a(1),Ka=a(11),Pa=a(21),fb=a(479),Wa=a(259),Ma=a(262),lb=a(161),Na=a(598);class X extends xb{constructor(mb,Ob,Ta){super(!0);this.Ra=new wa.a;this.A$c=this.o0e=!1;this.J5b=this.Om=this.yFe=null;this.Wc=()=>{u.a.ng(C.a(this.$).kd.activityState,S.a.nDd)||this.jva.reset()};this.cWi=sb=>{this.B_f(sb)};this.bWi=()=>{this.ENj()};this.$=mb;this.ea=mb.ea;this.dK=Ob;this.businessBar=Ta;this.ea.Oj(this.Wc);this.jva=I.Pxe(this.$);this.jbh();mb.da.Ha(55,this);this.Ega=
da.a.instance.Tb("Common.ISystemInitiatedFeedback")}get Uff(){return"EditInExcelWebApp_32x32x32"}get ka(){this.Om=this.Om||new qa.a;return this.Om.token}get Hod(){return"excel32"}get Sfg(){return this.ea.ic.inWebPart}Bah(){this.kVf(this.o0e)}Ach(){const mb=this.$;d.TaskExtensions.za(this.dK.value,Ob=>{this.Aha(mb.workbookContext.ClientUrl,J.AFrameworkApplication.hZ,1,mb.isEditMode?2:0,!0,new L.a(()=>Ob.result))},this.ka,3)}Yld(){0!==pb.a.rg.editMode&&(this.$.pb.Gw=!1)}Obf(){const mb={};mb[rb.a.Qac]=
!1;mb[rb.a.VJ]="OpenInExcel";this.$.Yc(802602464,Aa.a.zb,8,mb)}V5c(){if(this.ea.Yb){var mb=this.$;mb.isEditMode&&d.TaskExtensions.za(this.dK.value,Ob=>{this.Aha(mb.workbookContext.ClientUrl,J.AFrameworkApplication.hZ,1,2,!1,new L.a(()=>Ob.result))},this.ka,3)}}RHe(){this.ea.Yb&&d.TaskExtensions.za(this.dK.value,mb=>{this.Aha(this.$.workbookContext.ClientUrl,J.AFrameworkApplication.hZ,1,this.$.isEditMode?2:0,!1,new L.a(()=>mb.result))},this.ka,3)}Hzc(mb){super.Hzc(mb)}openInExcelClient(){this.ea.Yb&&
(this.$.isEditMode||d.TaskExtensions.za(this.dK.value,mb=>{this.Aha(this.$.workbookContext.ClientUrl,J.AFrameworkApplication.hZ,1,0,!1,new L.a(()=>mb.result))},this.ka,3))}openInBrowser(){this.ea.Yb&&d.TaskExtensions.za(this.dK.value,mb=>{this.Aha(this.$.workbookContext.ClientUrl,J.AFrameworkApplication.hZ,1,5,!1,new L.a(()=>mb.result))},this.ka,3)}downloadFile(mb){const Ob=this.sAe(mb);this.jva.downloadFile(Ob,mb);this.CGi()}CGi(){J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1)&&null!=this.Ega&&this.Ega.execute(mb=>mb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}$Mf(mb,Ob=0){if(this.ea.Yb){var Ta=this.$;C.a(Ta).SMa?this.aNf(mb,Ta):0<Ob?this.NSj(mb,Ta,Ob):this.Xag(Ta)}}Aha(mb,Ob,Ta,sb,zb,db){this.$.pb.Gw=!this.$.ic.inWebPart;this.o0e=zb;this.J5b=null;this.A$c=!1;this.XYg(mb,Ob,sb,zb,db)}I5b(mb){const Ob=this.$.ic;h.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${Ob.inEmbedView}, InWebPart:${Ob.inWebPart}, DivSyndicated:${Ob.isDivSyndicated}, Mode:${this.$.isEditMode?
za.a.edit:za.a.view}`);return X.Bmf()?(this.j5b(),eb.$$c(this.$Va,this.ZB,this.options,1,this.cWi,this.bWi,!1,J.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),32):super.I5b(mb)}xHh(){this.J0f();const mb=this.$;if(!this.ea.ic.inWebPart&&this.ea.Yb&&!mb.isEditMode){const Ob=new ma.a(2145659238,Aa.a.zb,this.$.xc,0,null);this.yFe=Cb.a.instance.create(()=>{mb.Ia.Hb(Ob)},0,ob.a.E6i)}}dispose(){this.ea&&this.ea.pk(this.Wc);l.a.sc([this.Ra,this.yFe,this.Om]);this.$=this.ea=null}PHh(){this.J0f()}$rf(){Cb.a.instance.create(()=>
{this.$.Ia.Hb(new ma.a(-2028960985,Aa.a.zb,0,30,null))},0,ob.a.F6i,!0,!0)}SYg(mb){const Ob=this.$,Ta=C.a(this.$).kd.activityState;Ta[fb.a.Bpe]=!0;Ob.isEditMode&&this.ea.Yb?(this.j5b(),v.a(Ob).Br(new Wa.a(A.a.tw,5,()=>{Ob.oI(!1);Ta[Ma.a.Fp]=A.a.l5b;Ta[fb.a.PKg]=mb;Ta[S.a.ked]=!0;Ob.isEditMode&&(Ta[S.a.vT]=1,Ta[S.a.mY]=!0,Ta[lb.a.a0b]=!0,Ta[lb.a.AXc]=!0);Ta[fb.a.Epe]=1455037301}))):this.kVf(mb)}Ldg(){const mb=J.AFrameworkApplication.hZ;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.z$a(mb,
!0)){const Ob=this.$.ea.ic;h.ULS.sendTraceTag(537154773,0,50,`Url:[${mb}] IsEmbedded:[${Ob.inEmbedView}] InWebPart:[${Ob.inWebPart}] DivSyndicated:[${Ob.isDivSyndicated}], Mode:[${this.$.isEditMode?za.a.edit:za.a.view}]`)}}else this.jva.downloadFile(mb,-2028960985);this.A$c=!0;this.j5b()}yDi(){this.nDc.XAf&&this.nDc.wmc(1)}zDi(){this.nDc.XAf&&Ka.HelperMethods.nf(W.a.BZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}GDi(){Ka.HelperMethods.nf(W.a.BZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}HDi(){Ka.HelperMethods.nf(W.a.BZ(34),
"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}sAe(mb){const Ob=new Sys.StringBuilder,Ta=this.$.workbookContext,sb=this.$.ya;Ob.append(this.$.boa);Ob.append(sb.FileHandlerRelativeUri);Ob.append("?id=");Ob.append(encodeURIComponent(x.a.IKb(Ta.WorkbookUri,"sc")));this.$.ea.Yb&&(Ob.append("&sessionId="),Ob.append(encodeURIComponent(this.$.ea.sessionId)));switch(mb){case -974518828:Ob.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:Ob.append("&workbookType=FullWorkbook");
break;case -1059172980:Ob.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:Ob.clear()}mb=!(vb.EwaSettings.isChangeGateEnabled("OfficeVSO:7396073_ShortenUrlToPreventOdsFailure")&&-1059172980===mb);m.a.Ypb(Ob,sb,mb);return Ob.toString()}jbh(){fa.a.instance.z7g();const mb=this.$.ya;MSOJS.ClientUtils.InitUrls(mb.RoamingAppsX86RootUrl,mb.RoamingAppsControlInstallerUrl,mb.RoamingAppsFirefoxExtensionUrl)}J0f(){const mb=this.$;this.ea.Yb||kb.a.fKd(mb,C.a(mb).kd);this.j5b();this.J5b&&
this.J5b(this,this.A$c);mb.frame.Ut.tm(this.$.frame.iba());mb.frame.fX.tm(this.$.frame.iba());mb.pb.Gw=!1;Pa.h(mb).focus()}XYg(mb,Ob,Ta,sb,zb){const db=this.$;J.AFrameworkApplication.sa&&!X.Bmf()&&(db.frame.Ut.un(db.frame.iba()),db.frame.fX.un(db.frame.iba()));super.Aha(mb,Ob,1,Ta,sb,zb)}j5b(){const mb=this.$;C.a(mb).Vh.activityName===A.a.openInExcelClient&&C.a(mb).kd.pM()}ENj(){const mb=Ga.a.hd(1,0,681,682,0,1341525452,"OpenInExcelActiveXError");v.a(this.$).St([mb])}NSj(mb,Ob,Ta){let sb=null;const zb=
window.setTimeout(()=>{C.a(Ob).Ivc(sb);this.Xag(Ob)},Ta);sb=()=>{C.a(Ob).SMa&&(C.a(Ob).Ivc(sb),window.clearTimeout(zb),this.aNf(mb,Ob))};C.a(Ob).BYc(sb)}Xag(mb){const Ob=Ga.a.hd(1,1,0,696,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");v.a(mb).St([Ob])}aNf(mb,Ob){v.a(Ob).Br(new Wa.a(A.a.tw,5,()=>{Ob.oI(!1);const Ta=C.a(Ob).kd,sb=Ta.activityState;sb[Ma.a.Fp]=A.a.CPe;sb[Na.a.c0b]=Ob.ea.ic.hasUnsupportedFeaturesForEdit;sb[H.a.uXc]=mb;Ta.ir(Ga.a.W3(this.businessBar.mad,[1437034227]))}))}static Bmf(){return 1<
pb.a.getRegisteredEwaInstances().length}}Object(b.a)(X,"OpenInExcelOperation",xb,[409,3]);var F=a(70),na=a(108),hb=a(153),Ib=a(54);class vc extends e.a{constructor(mb){super();this.$=mb;this.Gb();vc.hbh()}create(){if(this.$.da.Ba(55))this.qb(this.$.da.Ba(55));else{var mb=f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na),Ob=Object(F.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(na.c)(hb.a.resolve(Ib.e,{Wb:this.Na})):f.GetServiceTaskFactory.Pa(this.$.da,5,4,this.Na);d.TaskExtensions.za(P.Task.uG(mb,
Ob),()=>{this.qb(new X(this.$,new L.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Na)),Ob.result))},this.ka,3)}}static hbh(){vc.wBf||(vc.wBf=!0,(new ka).Kh(da.a.instance),da.a.instance.resolve("Common.IOfficeTrialExperience").Hg(),da.a.instance.resolve("Common.IMacOfficeOffer").Hg())}}vc.wBf=!1;Object(b.a)(vc,"OpenInClientFactory",e.a,[]);var nc=a(122),Pb=a(396);class oc extends nc.a{constructor(mb,Ob){super(mb,Ob)}execute(mb){const Ob=Object(k.a)(9,mb.Ke);d.TaskExtensions.za(f.GetServiceTaskFactory.create(Ob.da,
56,Ob.ka,0),Ta=>{Ob.downloadCopyOnOpenInClient?(mb.activityState[Pb.a.Cpe]=!0,Ta.result.Ldg()):Ta.result.Ach()},Ob.ka,3);return 1}}Object(b.a)(oc,"OpenInExcelClientActivity",nc.a,[]);class Ic extends e.a{constructor(mb){super();this.$=mb;mb.da.Ha(56,new vc(mb));this.Gb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na),()=>{this.qb(new oc(A.a.openInExcelClient,A.a.idle))},this.ka)}}Object(b.a)(Ic,"OpenInExcelClientActivityFactory",e.a,[]);a.d(B,"a",function(){return ec});
const ec=()=>{c.a.Fa(mb=>{mb.da.Ha(57,new Ic(mb));mb.da.Ha(60,new O(mb));mb.da.Ha(63,new E(mb))})}},1182:function(r,B,a){a.r(B);r=a(0);var c=a(15),b=a(90),e=a(4),f=a(113),d=a(13),h=a(91),l=a(56),k=a(31),w=a(27),n=a(12),x=a(242),m=a(1088),u=a(5),t=a(269),y=a(1089),v=a(727),A=a(966),z=a(96);class C extends v.a{constructor(Jb,Gb,Nb){super(Jb,Gb);this.hs=!0;this.command=Nb}Xm(Jb){super.Xm(Jb);this.businessBar.$.Ia.Hb(new z.a(this.command,Jb,this.businessBar.$.xc,10,null))}}Object(r.a)(C,"CommandActionBusinessBarEntry",
v.a,[]);class H extends C{constructor(Jb,Gb,Nb){super(Jb,Gb,Nb)}pD(Jb){super.pD(Jb)}}Object(r.a)(H,"EditAttemptReadOnlyBusinessBarEntry",C,[]);var I=a(46);class S extends v.a{constructor(Jb,Gb,Nb,Ja){super(Jb,Gb);this.error=Nb;this.options=Ja;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.hs=!(Ja&4)}Xm(Jb){super.Xm(Jb);this.error.Appearance&=-33;I.a(this.businessBar.$).St([this.error])}}Object(r.a)(S,"ErrorBusinessBarEntry",
v.a,[]);class P extends S{constructor(Jb,Gb,Nb,Ja,ab){super(Jb,Gb,Nb,Ja);this.command=ab;this.lV=!0}UV(Jb){super.UV(Jb);this.businessBar.$.Ia.Hb(new z.a(this.command,Jb,this.businessBar.$.xc,10,null))}}Object(r.a)(P,"ErrorAndCommandBusinessBarEntry",S,[]);var D=a(14);class G{constructor(Jb,Gb,Nb,Ja,ab,wb,xb,rb,za,Aa){this.cJ=this.p8=this.aP=0;this.Uwg=Jb;this.fYj=Gb;this.dJ=Nb;this.jBg=xb;this.zkb=k.a.mu(za);this.nzg=za;this.e7d=rb;this.kBg=Aa;0!==Ja&&(this.aP=Ja);0!==ab&&(this.p8=ab);0!==wb&&(this.cJ=
wb)}get title(){return G.ga(this.fYj)}get message(){return G.ga(this.dJ)}get messageId(){return this.dJ}get iconName(){return this.kBg}get v0a(){return this.Uwg}get actionButton(){return G.ga(this.aP)}get Qsa(){return G.ga(this.p8)}get link(){return G.ga(this.cJ)}get jk(){return this.jBg}get businessBarType(){return this.e7d}get hash(){return this.zkb}get alt(){const {BusinessBarControl:Jb}=a(1182);switch(this.jk){case Jb.bja:return G.ga(26);case Jb.cA:return G.ga(25);case Jb.Ai:return G.ga(24);default:return G.ga(0)}}get YJa(){return this.nzg}set businessBarType(Jb){this.e7d=
Jb}static ga(Jb){return D.a.instance.ga(Jb)}}Object(r.a)(G,"EwaBusinessBarEntry",null,[]);class E extends G{constructor(Jb,Gb,Nb,Ja,ab,wb,xb,rb){super(Jb,0,Gb,Nb,Ja,ab,wb,xb,rb)}get title(){return""}}Object(r.a)(E,"EwaNoTitleBusinessBarEntry",G,[]);var O=a(77);class N extends v.a{constructor(Jb,Gb){super(Jb,Gb);this.lV=this.hs=!0}Xm(Jb){super.Xm(Jb);this.set_visible(!1);this.businessBar.$.sI();this.businessBar.$.Ia.Hb(new z.a(1038998010,Jb,this.businessBar.$.xc,10,null))}UV(Jb){super.UV(Jb);this.businessBar.$.Ia.Hb(new z.a(-722953877,
Jb,this.businessBar.$.xc,10,null))}pD(Jb){this.businessBar.removeEntry(55);O.g(Jb)}}Object(r.a)(N,"ExternalLinksEnableContentBusinessBarEntry",v.a,[]);class J extends v.a{constructor(Jb,Gb){super(Jb,Gb);this.hs=!0;this.lV=!1}Xm(Jb){super.Xm(Jb);this.businessBar.$.Ia.Hb(new z.a(-722953877,Jb,this.businessBar.$.xc,10,null))}pD(Jb){this.businessBar.removeEntry(5);O.g(Jb)}}Object(r.a)(J,"ExternalLinksShowErrorBusinessBarEntry",v.a,[]);var W=a(11);class ea extends v.a{constructor(Jb,Gb,Nb){super(Jb,Gb);
this.Ozb=Nb;this.hs=!0}Xm(Jb){super.Xm(Jb);W.HelperMethods.bW(this.businessBar.$.pG,this.Ozb,this.businessBar.$.wS)}}Object(r.a)(ea,"HelpButtonBusinessBarEntry",v.a,[]);class R extends v.a{constructor(Jb,Gb,Nb){super(Jb,Gb);this.Ozb=Nb;this.Gwa=!0}Pma(Jb){super.Pma(Jb);W.HelperMethods.bW(this.businessBar.$.pG,this.Ozb,this.businessBar.$.wS)}}Object(r.a)(R,"HelpTextBusinessBarEntry",v.a,[]);var Y=a(73);class U extends v.a{constructor(Jb,Gb,Nb,Ja){super(Jb,Gb);this.Ozb=Nb;this.command=Ja;this.Gwa=!0;
this.hs=1461300262!==Ja}Xm(Jb){super.Xm(Jb);this.businessBar.$.Ia.Hb(new z.a(this.command,Jb,this.businessBar.$.xc,10,null))}Pma(Jb){super.Pma(Jb);const Gb=new z.a(-859308420,Jb,this.businessBar.$.xc,12,null);this.businessBar.$.Ia.Hb(Gb,{[Y.a.Sf]:"HelpID="+this.Ozb,["InputMethod"]:Jb,[Y.a.Pc]:u.a.mV,[u.a.Zoa]:!0})}}Object(r.a)(U,"HelpTextTaskPaneAndCommandBusinessBarEntry",v.a,[]);class da extends v.a{constructor(Jb,Gb){super(Jb,Gb);this.lV=this.hs=!0}Xm(Jb){super.Xm(Jb);this.set_visible(!1);this.businessBar.$.sI();
this.businessBar.$.Ia.Hb(new z.a(-1081442996,Jb,this.businessBar.$.xc,10,null))}UV(Jb){super.UV(Jb);this.businessBar.$.Ia.Hb(new z.a(1702917262,Jb,this.businessBar.$.xc,10,null))}pD(Jb){this.businessBar.removeEntry(59);O.g(Jb)}}Object(r.a)(da,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",v.a,[]);var T=a(1091);class ka extends v.a{constructor(Jb,Gb){super(Jb,Gb);(this.policyManager=Jb.$.da.Ba(274))?(this.message=this.policyManager.ftc,this.title=this.policyManager.title,this.Gwa=!0):c.ULS.sendTraceTag(537170202,
306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Pma(Jb){super.Pma(Jb);(Jb=this.policyManager.J_i)&&Jb(null)}}Object(r.a)(ka,"PolicyBusinessBarEntry",v.a,[]);var L=a(1090),fa=a(1093),wa=a(1092);a(426);var oa=a(150),xa=a(25);class bb extends v.a{constructor(Jb,Gb){super(Jb,Gb);this.hs=!0;this.title=""}Xm(Jb){super.Xm(Jb);oa.c(xa.a.oPi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ",
"_blank")}}Object(r.a)(bb,"UnsupportedBrowserBusinessBarEntry",v.a,[]);var Za=a(1087),La=a(1319);class va extends v.a{constructor(Jb,Gb){super(Jb,Gb);this.jDa=La.a.o7b();this.hs=!0;this.lV=this.jDa.o8j;this.title=this.jDa.title;this.message=this.jDa.message}get actionButton(){return this.jDa.IAe}get Qsa(){return this.jDa.KAe}Xm(Jb){super.Xm(Jb);this.jDa.ECf(null)}UV(Jb){super.UV(Jb);this.jDa.HCf(null)}pD(Jb){super.pD(Jb);this.jDa.wOe(null)}}Object(r.a)(va,"WildFireMobileAppBusinessBarEntry",v.a,[]);
var Ba=a(256),Ea=a(22),pa=a(193),$a=a(170),cb=a(43),ib=a(7),ta=a(178),Ya=a(1094),Da=a(72),ba=a(132);class ya extends v.a{constructor(Jb,Gb,Nb,Ja){super(Jb,Gb);this.officeScriptsCommandManager=Nb.da.Ba(519);c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=ta.a.create();this.$=Nb;this.title=D.a.instance.ga(2282);this.message="";this.lYd=D.a.instance.ga(2278);this.Dpg=D.a.instance.ga(2279);this.Bpg=D.a.instance.ga(2280);this.yHe=D.a.instance.ga(2281);this.update(Ja)}update(Jb){this.scriptLink=
Jb.scriptLink;this.runStatus=Jb.runStatus;this.buttonText=Jb.buttonText||"";this.bGi(Jb.clickId);this.atj();"preparing"===this.runStatus?(this.hoa(0),this.message=String.format(D.a.instance.nb(208),this.buttonText),this.hs=!0,this.tsa=this.lYd,this.ysb=this.Vga=this.Fab):"running"===this.runStatus?(this.hoa(0),this.message=String.format(D.a.instance.nb(207),this.buttonText),this.hs=!0,this.tsa=this.lYd,this.ysb=this.Vga=this.Fab):"succeeded"===this.runStatus?(this.hoa(0),this.message=String.format(D.a.instance.nb(210),
this.buttonText),"true"===Jb.hasLogs?(this.hs=!0,this.tsa=this.Bpg,this.Vga=this.wMf,this.lV=!0,this.PZc=this.Dpg,this.QZc=this.xMf):(this.hs=!0,this.tsa=this.Dpg,this.Vga=this.xMf)):"runFailed"===this.runStatus?(this.hoa(1),this.message=String.format(D.a.instance.nb(209),this.buttonText),this.D6a=Ab.bja,"true"===Jb.hasLogs?(this.hs=!0,this.tsa=this.Bpg,this.Vga=this.wMf,"false"===Jb.isOwner&&(this.lV=!0,this.PZc=this.yHe,this.QZc=this.KDf)):"false"===Jb.isOwner&&(this.hs=!0,this.tsa=this.yHe,this.Vga=
this.KDf)):"fetchFailed"===this.runStatus?(this.hoa(1),this.D6a=Ab.bja,this.message=D.a.instance.ga(2284)):"canceled"===this.runStatus?(this.hoa(0),this.D6a=Ab.cA,this.message=String.format(D.a.instance.nb(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.hoa(5),this.D6a=Ab.cA,this.message=String.format(D.a.instance.nb(211),this.buttonText),this.hs=!0,this.tsa=this.lYd,this.ysb=this.Vga=this.Fab):"initializing"===this.runStatus&&(this.hoa(0),this.D6a=Ab.Ai,this.message=D.a.instance.ga(2283))}get jk(){return this.D6a}get actionButton(){return this.tsa}get Qsa(){return this.PZc}Xm(Jb){super.Xm(Jb);
this.Vga&&this.Vga()}UV(Jb){super.UV(Jb);this.Qsa&&this.QZc()}pD(Jb){super.pD(Jb);this.ysb&&this.ysb()}atj(){this.message="";this.D6a=Ab.Ai;this.hs=!1;this.tsa="";this.Vga=void 0;this.lV=!1;this.PZc="";this.QZc=void 0;this.hideCloseButton=!1;this.ysb=void 0}Fab(){const Jb=ta.a.create().toString();this.officeScriptsCommandManager.Mbi(Jb);this.Xmc(-2186799,Jb)}wMf(){const Jb=ta.a.create().toString();this.officeScriptsCommandManager.Lbi(Jb);this.Xmc(1036446140,Jb)}xMf(){const Jb=ta.a.create();if(this.scriptLink){const Gb=
new Ya.b(this.scriptLink);this.officeScriptsCommandManager.rcf(this.id.toString(),JSON.stringify(Gb),Jb)}this.Xmc(-585097204,Jb.toString())}KDf(){const Jb=ta.a.create().toString();this.officeScriptsCommandManager.Kbi(Jb);this.Xmc(-639858579,Jb)}bGi(Jb){const Gb=[];Gb.push(Object(ib.a)(new Da.a,{name:"id",string:this.id.toString()}));Gb.push(Object(ib.a)(new Da.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Gb.push(Object(ib.a)(new Da.a,{name:"runStatus",string:this.runStatus}));Gb.push(Object(ib.a)(new Da.a,
{name:"clickId",string:Jb}));Gb.push(Object(ib.a)(new Da.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));oa.a(ba.a.FRi,void 0,void 0,Gb)}Xmc(Jb,Gb){const Nb=[];Nb.push(Object(ib.a)(new Da.a,{name:"id",string:this.id.toString()}));Nb.push(Object(ib.a)(new Da.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Nb.push(Object(ib.a)(new Da.a,{name:"runStatus",string:this.runStatus}));Nb.push(Object(ib.a)(new Da.a,{name:"clickId",string:Gb}));oa.d(Jb,void 0,void 0,void 0,void 0,void 0,
Nb)}}Object(r.a)(ya,"OfficeScriptsRunStatusBusinessBarEntry",v.a,[]);var V=a(49),Z=a(1);class ja extends C{constructor(Jb,Gb,Nb,Ja,ab,wb){super(Jb,Gb,Nb);V.a.instance.create(()=>{this.showCallout(Gb,Ja)},ab,wb,!0,!0)}showCallout(Jb,Gb){if(this.businessBar&&this.businessBar.qla(Jb.v0a)&&this.Bue()){Jb=new z.a(-847286761,0,this.businessBar.$.xc,0,null);var Nb={};Nb.CalloutName=Gb;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Nb.Target=this.ZJ():Nb.Target=
Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.aP.domElement;this.businessBar.$.Ia.Hb(Jb,Nb)}}Bue(){return!0}}Object(r.a)(ja,"CalloutBusinessBarEntry",C,[]);class la extends ja{constructor(Jb,Gb,Nb,Ja,ab,wb){super(Jb,Gb,Nb,Ja,ab,wb)}Bue(){if(!Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const Jb=
this.businessBar.$.da.Ba(465);return Jb&&Jb.Rxc?!1:!0}}Object(r.a)(la,"OptimizeWorkbookCalloutBusinessBarEntry",ja,[]);var ua=a(18);class eb extends v.a{constructor(Jb,Gb,Nb){super(Jb,Gb);this.update(Nb)}update(Jb){this.title=Jb.title?Jb.title:"";this.message=Jb.message?Jb.message:"";this.hoa(this.ndh(Jb.businessBarType));this.hideCloseButton=!!Jb.hideCloseButton}ndh(Jb){switch(Jb){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;
default:return 0}}}Object(r.a)(eb,"MsFormsDataSyncStatusBusinessBarEntry",v.a,[]);class Eb extends v.a{constructor(Jb,Gb,Nb,Ja){super(Jb,Gb);this.lV=this.hs=!0;this.wcj=Nb;this.hUg=Ja}Xm(Jb){super.Xm(Jb);this.businessBar.$.Ia.Hb(new z.a(this.wcj,Jb,this.businessBar.$.xc,10,null))}UV(Jb){super.Xm(Jb);this.businessBar.$.Ia.Hb(new z.a(this.hUg,Jb,this.businessBar.$.xc,10,null))}}Object(r.a)(Eb,"DualCommandActionsBusinessBarEntry",v.a,[]);class Wb extends v.a{constructor(Jb,Gb,Nb,Ja){super(Jb,Gb);this.host=
Nb.ya.HostName;this.vhi="OneDriveWOPI"===this.host||"Open From URL"===this.host;"Open From URL"===this.host?appChrome.renderSaveACopyToOneDriveCallout(Ja):(this.jyi=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDrive",!1)||Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveB",!1)||Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveC",!1))&&this.vhi&&appChrome.renderSaveACopyToOneDriveCallout(Ja)}}
Object(r.a)(Wb,"EditAttemptReadOnlyNoEditPermissionsBusinessBarEntry",v.a,[]);a.d(B,"BusinessBarControl",function(){return Ab});class Ab extends x.a{constructor(Jb,Gb){super(Gb);this.h0e=n.DOMElementExtensions.Hq+",div";this.mU=Array(70);this.Jm=!1;this.YV=Nb=>{if(Nb.Ea.keyCode===b.a.Fy){var Ja=this.mc.querySelectorAll(this.h0e);const ab=n.DOMElementExtensions.Dl(Ja);Ja=n.DOMElementExtensions.UA(Ja);return n.DOMElementExtensions.xBa(Nb.Ea,ab,Ja)}return!1};this.mb=Jb;this.set_visible(!1);this.addCssClass(m.a.Gxh);
Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&e.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&this.addCssClass(m.a.Ixh);f.KeyInputManager.instance.ta(d.a.Vb,this.mc,this.YV);t.a(Jb).fi(this)}get ee(){return Ba.a.F1c}get mc(){return this.domElement}get If(){return this.get_visible()}get $(){return this.mb}eg(Jb,Gb){Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?Gb||n.DOMElementExtensions.setFocus(n.DOMElementExtensions.Dl(this.mc.querySelectorAll(this.h0e))):
Gb||n.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Gb}Bh(Jb){return n.DOMElementExtensions.Df(this.mc,Jb)}Bj(){}ik(){}dispose(){this.Jm||(f.KeyInputManager.instance.Aa(d.a.Vb,this.mc,this.YV),h.a.sc(this.mU),this.mU=Array(70),this.mb=null,super.dispose(),this.Jm=!0)}qla(Jb){if(!this.get_visible())return!1;Jb=this.mU[Jb];return!!Jb&&Jb.isVisible}zgd(Jb){return this.qla(Jb)?this.mU[Jb].ZJ():null}bH(Jb){return!!this.mU[Jb]}WQb(Jb,Gb){if(Jb=this.mU[Jb])Jb.update(Gb),Jb.a4j()}rE(Jb,
Gb,Nb=null,Ja=null){let ab=!1;if(this.bH(Jb))Nb=this.mU[Jb].get_visible();else{this.set_visible(!0);const wb=Ab.qaf()[Jb];this.mU[Jb]=this.eaa(Jb,Gb,Nb,Ja);Nb=!1;ab=!0;Ja="";let xb=0;Gb&&(Ja=Gb.MessageIdName,xb=Gb.MessageId);const rb=wb.YJa,za=cb.PageLoadTrackingInfo.instance.kwa(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Jb}, time from app interactive: ${za}`);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===
wb.businessBarType||$a.a(this.$).AOd(wb.hash,Ja,xb,l.a.sEc,!0,1,Gb,rb)}Nb||!A.BusinessBarManager.Wec().includes(Jb)&&!ab||(this.mU[Jb].set_visible(!0),this.$.sI())}removeEntry(Jb){return this.Emj(Jb)}DMd(){h.a.sc(this.mU);this.mU=Array(70);this.set_visible(!1)}Emj(Jb){if(!this.bH(Jb))return!1;h.a.Ja(this.mU[Jb]);this.mU[Jb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.sI();return!0}eaa(Jb,Gb,Nb=null,Ja=null){const ab=Ab.qaf()[Jb],wb=!!(this.$.Bd&64);switch(Jb){case 23:Jb=new Wb(this,
ab,this.mb,this.mc);break;case 2:case 4:case 25:case 26:case 36:case 35:Jb=new v.a(this,ab);break;case 12:case 29:case 30:case 31:case 32:case 57:Jb=wb?new C(this,ab,-8805455):new v.a(this,ab);break;case 34:Jb=wb?new Eb(this,ab,-8805455,-104572626):new v.a(this,ab);break;case 22:Jb=new H(this,ab,-8805455);break;case 46:case 45:Jb=wb?new P(this,ab,Gb,0,-8805455):new S(this,ab,Gb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Jb=new S(this,ab,Gb,0);break;case 19:Jb=new v.a(this,ab);break;
case 47:Jb=new S(this,ab,Gb,0);break;case 6:case 14:Jb=new ea(this,ab,Gb.HelpTopicId);break;case 67:case 65:Jb=new R(this,ab,Gb.HelpTopicId);break;case 37:Jb=new R(this,ab,u.a.Amh);break;case 38:Jb=new v.a(this,ab);break;case 68:Jb=new H(this,ab,924877417);break;case 16:Jb=new v.a(this,ab);Jb.title=k.a.Og(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Jb.message=k.a.Og(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Jb=new C(this,ab,-1762562205);Jb.hideCloseButton=
!0;break;case 20:Jb=new va(this,ab);break;case 21:case 56:Jb=new v.a(this,ab);break;case 28:Jb=new v.a(this,ab);break;case 24:Jb=new bb(this,ab);break;case 27:Jb=new ka(this,ab);break;case 39:Jb=new Za.a(this,ab);break;case 40:Jb=new y.a(this,ab);break;case 41:Jb=new L.a(this,ab);break;case 42:Jb=new T.a(this,ab);break;case 48:Jb=new v.a(this,ab);break;case 49:Jb=new v.a(this,ab);break;case 50:Jb=new v.a(this,ab);break;case 51:Jb=new v.a(this,ab);break;case 52:Jb=new v.a(this,ab);break;case 53:Jb=
new wa.a(this,ab);break;case 54:Jb=new fa.a(this,ab);break;case 55:Jb=new N(this,ab);break;case 5:Jb=new J(this,ab);break;case 58:Jb=new C(this,ab,-1753056834);Gb?(Gb=Gb.Directive,Ea.a.Pq(Gb)||"&nbsp;"===Gb||(Jb.message=Gb)):Nb&&(Jb.message=Nb);break;case 59:Jb=new da(this,ab);break;case 60:Jb=new v.a(this,ab);break;case 63:Jb=new R(this,ab,u.a.NQi);break;case 61:Jb=new U(this,ab,u.a.IYg,-8805455);break;case 66:Jb=new U(this,ab,u.a.Shj,1461300262);break;case 62:Jb=new la(this,ab,515196233,13,3E5,
"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");Jb.message=Nb;break;case 64:Jb=new ya(this,ab,this.$,Ja);break;case 69:Jb=new eb(this,ab,Ja);break;default:Jb=new S(this,ab,Gb,7)}Jb.M6c();return Jb}static qaf(){let Jb;Jb=pa.a.Bxa()?261:260;return Ab.xAe||(Ab.xAe=[new G(0,276,277,278,0,0,Ab.bja,1,"BB_UnableToRefreshLock"),new G(1,276,277,278,0,0,Ab.bja,1,"BB_UnableToRefreshLockExpected"),new G(2,268,269,0,0,0,Ab.cA,5,"BB_WorkbookAlmostTooLarge"),new G(3,270,271,272,0,0,Ab.bja,1,"BB_WorkbookTooLarge"),
new G(4,259,Jb,0,0,0,Ab.cA,5,"BB_ExternalWorkbookLinksDisabled"),new G(5,263,262,264,0,0,Ab.bja,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new G(6,265,266,267,0,0,Ab.Ai,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new G(7,251,252,253,0,0,Ab.Ai,5,"BB_UnsupportedFeatures"),new G(8,0,0,0,0,0,Ab.Ai,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new G(9,0,0,0,0,0,Ab.Ai,0,"BB_CollabDataStringsLocaleMismatch"),new G(10,0,0,0,0,0,Ab.Ai,0,"BB_CollabDataLocaleMismatch"),new G(11,279,280,
281,0,0,Ab.bja,1,"BB_LastGenericStatusError"),new G(12,282,283,284,0,0,Ab.cA,5,"BB_ScratchPadWarning"),new G(13,285,286,287,0,0,Ab.bja,1,"BB_AuthenticationLost"),new G(14,288,289,290,0,0,Ab.cA,5,"BB_OdfCompatibilityIssues"),new G(15,0,575,0,0,0,Ab.cA,5,"BB_PivotChartInteractivityMissingWarning"),new G(16,0,0,0,0,0,Ab.Ai,2,"BB_WorkbookIsIrmProtected"),new G(17,0,0,0,0,0,Ab.Ai,0,"BB_BIFeatureNotAvailable"),new G(18,291,292,287,0,0,Ab.cA,5,"BB_AnonymousCreateMode"),new G(19,254,255,0,0,0,Ab.cA,5,"BB_UnsupportedInteractiveReportEditing"),
new G(20,0,0,0,0,0,Ab.Ai,0,"BB_MobileAppCampaignBizBar"),new G(21,297,298,0,0,0,Ab.Ai,0,"BB_TransientServerCommunicationFailures"),new G(22,1643,1654,1655,0,0,Ab.Ai,5,"BB_EditAttemptInReadOnly"),new G(23,1643,1654,0,0,0,Ab.Ai,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new G(24,0,W.HelperMethods.u3j(),1632,0,0,Ab.Ai,3,"BB_UnsupportedBrowser"),new G(25,300,301,0,0,0,Ab.Ai,2,"BB_ReadOnlyPermissions"),new G(26,302,303,0,0,0,Ab.Ai,2,"BB_DocumentIsIrmProtectedWarning"),new G(27,0,0,0,0,0,Ab.cA,5,"BB_PolicyWarningMessage"),
new G(28,1285,299,0,0,0,Ab.Ai,0,"BB_WorkingOnIt"),new G(29,1643,1641,1642,0,0,Ab.Ai,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new G(30,1656,1657,1658,0,0,Ab.Ai,5,"BB_WorkbookIsReadOnlyRecommended"),new G(31,1643,1659,1660,0,0,Ab.Ai,5,"BB_WorkbookHasPasswordToModify"),new G(32,1643,1661,1664,0,0,Ab.Ai,3,"BB_LegacySharedWorkbookEditWarning"),new G(33,1651,1662,253,0,0,Ab.Ai,5,"BB_LegacyConnectionsWarning"),new G(34,1643,1960,1961,1962,0,Ab.Ai,0,"BB_TooManyLoadBlockingFloatingObjects"),new G(35,
1652,1653,0,0,0,Ab.Ai,2,"BB_GroupedSlicers"),new G(36,313,314,0,0,0,Ab.cA,5,"BB_ThirdPartyAddinDisabled"),new G(37,1789,1790,0,0,1791,Ab.Ai,5,"BB_FinanceLinkedEntityDisclaimerBar"),new G(38,1818,1819,0,0,0,Ab.cA,5,"BB_WolframDeprecationAlertBar"),new G(39,0,0,0,0,0,Ab.Ai,0,"BB_WacGdprNotice"),new G(40,0,0,0,0,0,Ab.Ai,0,"BB_AutomaticSensitivityLabel"),new G(41,0,0,0,0,0,Ab.Ai,0,"BB_RecommendedSensitivityLabel"),new G(42,0,0,0,0,0,Ab.Ai,0,"BB_MandatorySensitivityLabel"),new G(43,315,316,317,0,0,Ab.Ai,
0,"BB_LocalStorageDisabled"),new G(44,632,633,0,0,0,Ab.Ai,0,"BB_AutoRefreshDisabled"),new G(45,1014,1012,1016,1314,0,Ab.Ai,4,"BB_CorruptedFileRepaired"),new G(46,1015,1013,1016,1314,0,Ab.Ai,5,"CorruptedOdsFileRepaired"),new G(47,273,274,275,0,0,Ab.cA,5,"BB_MinorVersionLimitReached"),new G(48,304,305,0,0,0,Ab.cA,5,"BB_SensitivityApplicationGenericError"),new G(49,306,308,0,0,0,Ab.cA,5,"BB_SensitivityApplicationTooLargeFileError"),new G(50,307,308,0,0,0,Ab.cA,5,"BB_SensitivityApplicationLabelNotSupportedError"),
new G(51,309,310,0,0,0,Ab.cA,5,"BB_SensitivityApplicationLabelDisabledError"),new G(52,311,312,0,0,0,Ab.cA,5,"BB_SensitivityApplicationMandatoryConflictError"),new G(53,0,0,0,0,0,Ab.cA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new G(54,0,0,0,0,0,Ab.cA,5,"BB_SensitivityApplicationSetLabelError"),new G(55,2119,2120,2121,2124,0,Ab.Ai,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16"),new G(56,297,298,0,0,0,Ab.Ai,0,"BB_NetworkDown"),new G(57,318,319,320,0,0,Ab.Ai,
2,"BB_DefaultToViewDueToCogs"),new G(58,1815,1816,1817,0,0,Ab.Ai,1,"BB_RefreshLinkedEntityErrorBar"),new G(59,1792,1793,1794,1795,0,Ab.Ai,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new E(60,250,0,0,0,Ab.Ai,5,"BB_CanvasHealth"),new G(61,1017,1018,1314,0,1019,Ab.Ai,5,"BB_MismatchedFileFormatConverted"),new G(62,2238,0,2240,0,0,Ab.Ai,5,"BB_OptimizeWorkbook"),new G(63,321,322,0,0,323,Ab.Ai,0,"BB_NovModePostDepreciation"),new G(64,0,0,0,0,0,Ab.Ai,0,"BB_OfficeScriptsRunning"),new G(65,2214,2215,0,0,
2217,Ab.Ai,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new G(66,324,325,0,0,326,Ab.Ai,5,"BB_ReadOnlyPivotTable"),new G(67,2214,2216,0,0,2217,Ab.Ai,0,"BB_PowerQueryRefreshHostNotSupported"),new G(68,1057,w.a.ckc?1059:1058,1056,0,0,Ab.Ai,4,"BB_RefreshPageAfterEnablingTheExtension"),new G(69,0,0,0,0,0,Ab.Ai,0,"BB_MsFormsDataSyncStatus")])}}Ab.bja=ua.a.HAh;Ab.cA=ua.a.JAh;Ab.Ai=ua.a.IAh;Ab.xAe=null;Object(r.a)(Ab,"BusinessBarControl",x.a,[63])},1188:function(r,B,a){var c=a(9);r=a(0);var b=a(714),e=
a(50),f=a(38),d=a(15),h=a(1103),l=a(159),k=a(24),w=a(73),n=a(59);class x{constructor(kb){this.options=null;this.options=kb}}Object(r.a)(x,"MacroRecorderRangeCustomSortedPayload",null,[123]);var m=a(982),u=a(983),t=a(44),y=a(379),v=a(198),A=a(291),z=a(151),C=a(29),H=a(255),I=a(1),S=a(196),P=a(22),D=a(290),G=a(21),E=a(819),O=a(767),N=a(272),J=a(215),W=a(14),ea=a(141);class R{constructor(kb){this.ru=Cb=>{switch(Cb){case 0:this.HOa("Cancel");break;case 1:this.HOa("Expand and sort");this.aYe(!0);break;
case 2:this.HOa("Just sort"),this.aYe(!1)}};this.aYe=kb}show(){const kb=new ea.StandardDialog;kb.Rb=11;kb.wc(1,W.a.instance.ga(2126));kb.wc(2,W.a.instance.ga(2127));kb.ecg(W.a.instance.ga(2125),W.a.instance.Ua(658),this.ru)}HOa(kb){d.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${kb}`)}}Object(r.a)(R,"ExpandSortSelectionDialog",null,[]);const Y=(kb,Cb)=>{kb=kb.ColumnInfo;switch(Cb){case 1:return kb.CellColors&&kb.CellColors.length?!0:(d.ULS.sendTraceTag(537151631,0,
10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return kb.TextColors&&kb.TextColors.length?!0:(d.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return kb.Icons&&kb.Icons.length?!0:(d.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),
!1);default:return d.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},U=(kb,Cb,ob,qa)=>{kb=kb.HeaderColumnInfo;return qa||kb?2===Cb&&ob?kb.CellColors&&1!==kb.CellColors.length?(d.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):kb.TextColors&&1!==kb.TextColors.length?(d.ULS.sendTraceTag(537151625,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):kb.Icons&&1!==kb.Icons.length?(d.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:kb?(d.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${ob} == 0.`),
!1):!0:!0};var da=a(197);class T{static isValid(kb){return T.hIh.includes(kb.Position)?!0:(d.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${kb.Position}]`),!1)}}T.hIh=[0,.5,1];Object(r.a)(T,"FillGradientStopExtension",null,[]);class ka{constructor(kb,Cb,ob,qa){new Sys.UI.Point(kb,Cb);new Sys.UI.Point(ob,qa)}}Object(r.a)(ka,"GradientLine",null,[]);class L{static isValid(kb){if(!(kb.Degree.toString()in L.dIh))return d.ULS.shipAssertTag(537159829,0,
!1,`FillGradientExtension.IsValid: unexpected degree value [${kb.Degree}]`),!1;if(!kb.GradientStops)return d.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(kb.GradientStops.length<L.$Mi||kb.GradientStops.length>L.GLi)return d.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${kb.GradientStops.length}]`),!1;for(const Cb of kb.GradientStops)if(!T.isValid(Cb))return!1;return!0}}L.$Mi=2;L.GLi=3;L.dIh={["0"]:new ka(0,
0,1,0),["180"]:new ka(1,0,0,0),["90"]:new ka(0,0,0,1),["270"]:new ka(0,1,0,0),["45"]:new ka(0,0,1,1),["225"]:new ka(1,1,0,0),["135"]:new ka(1,0,0,1),["315"]:new ka(0,1,1,0)};Object(r.a)(L,"FillGradientExtension",null,[]);const fa=kb=>kb.SortRange?4===kb.SortRangeType?(d.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${kb.SortRangeType}`),!1):2===kb.SortRangeType&&kb.SortTopToBottom&&(null==kb.HeaderRowSize||0>kb.HeaderRowSize)?(d.ULS.sendTraceTag(537151621,
0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(d.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),wa=kb=>{if(!kb.SortConditions)return!0;for(const Cb of kb.SortConditions){if(!xa(kb,Cb.RowColOffset))return d.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${Cb.RowColOffset}] is out of bounds. sort range: ${kb.SortRange}`),
!1;if(1===Cb.SortConditionType&&Cb.FillGradient&&!L.isValid(Cb.FillGradient))return d.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},oa=kb=>{if(!kb.SortColumnInfoItems)return d.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var Cb=new da.a;for(var ob of kb.SortColumnInfoItems){if(!xa(kb,ob.ColumnOffset))return d.ULS.sendTraceTag(537151617,
0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${ob.ColumnOffset}] is out of bounds. sort range: ${kb.SortRange}`),!1;if(!ob.Name)return d.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${ob.ColumnOffset}]`),!1;if(ob.CellColors&&!ob.CellColors.length)return d.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${ob.CellColors.length}]`),!1;if(ob.TextColors&&
!ob.TextColors.length)return d.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${ob.TextColors.length}]`),!1;if(ob.Icons&&!ob.Icons.length)return d.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${ob.Icons.length}]`),!1;Cb.add(ob.ColumnOffset)}if(kb.SortConditions)for(const qa of kb.SortConditions)if(!Cb.contains(qa.RowColOffset))return d.ULS.shipAssertTag(537151584,
0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${qa.RowColOffset}]`),!1;if(kb.HeaderColumnInfoItems){if(kb.HeaderColumnInfoItems.length!==kb.SortColumnInfoItems.length)return d.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Cb=0;Cb<kb.HeaderColumnInfoItems.length;++Cb){ob=kb.HeaderColumnInfoItems[Cb];if(ob.ColumnOffset!==kb.SortColumnInfoItems[Cb].ColumnOffset)return d.ULS.shipAssertTag(537151582,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(ob.CellColors&&1<ob.CellColors.length)return d.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(ob.TextColors&&1<ob.TextColors.length)return d.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),
!1;if(ob.Icons&&1<ob.Icons.length)return d.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0},xa=(kb,Cb)=>{const ob=kb.SortRange;kb=kb.SortTopToBottom?ob.LastColumn-ob.FirstColumn:ob.LastRow-ob.FirstRow;return 0<=Cb&&Cb<=kb};var bb=a(389),Za=a(132),La=a(93),va=a(133);class Ba extends bb.a{constructor(kb,Cb){super(kb,Cb);this.yFb=this.Sfd();this.Hr()}get pc(){return"SortMergedCellsErrorDialog"}uO(kb,
Cb){if(1===kb){var ob=t.v(this.yFb,this.$);G.h(this.$).sg(ob,null,null,null,0,"SortErrorDialog.MergeCellRangeSelected")}ob={["DialogButton"]:kb,["Location"]:"dialog"};va.b(this.$).qd(Za.a.qRj,ob,null,!0);super.uO(kb,Cb)}Hr(){super.Hr();const kb=this.nRj();this.Rb=1;this.wc(1,W.a.instance.ga(2245));this.Zl(W.a.instance.ga(2246),La.a.qf(kb),1,this.I7)}nRj(){return String.format(W.a.instance.nb(174),this.yFb.toString())}Sfd(){const kb=this.error.Description.split("_");return new k.Range(Number.parseInvariant(kb[1])+
1,Number.parseInvariant(kb[2])+1,Number.parseInvariant(kb[3])+1,Number.parseInvariant(kb[4])+1,!0,!1)}}Object(r.a)(Ba,"SortMergedCellsErrorDialog",bb.a,[]);var Ea=a(74),pa=a(582),$a=a(618);class cb extends E.a{constructor(kb,Cb,ob,qa){super(kb);this.Nic=this.zVd=!1;this.I6=[];this.Roi=(ma,Ga)=>{const vb=this.Xgh(ma);this.GMa(214,(Ka,Pa,fb)=>A.p(this.$.pa.va,vb,this.W0a(Ka,this.LPh(Ga)),this.$T(Pa),fb,null),16,!0)};this.Qoi=(ma,Ga,vb)=>{ma=A.o(this.$.pa.va,Ga,this.wQh(Ga,vb),this.SYi,null,ma);this.I6.push(ma)};
this.SYi=()=>{d.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.e9b(cb.wtb())};this.P9c=(ma,Ga)=>{if(1===ma){ma=Ga.sortRangeType;const vb={};vb.SortOptions=Ga.sortOptions;vb.ShouldRestoreSelection=this.zVd;vb.SelectedRange=this.selectedRange;vb.OriginalActiveCell=this.gsc;vb.TopCellAddress=this.uCa;vb.ShouldPromptNamedSheetViewTeachingDialog=0===ma||3===ma;cb.Wfj(this.$,vb)}else this.zVd&&this.zpa(this.selectedRange,
this.gsc)};this.lhi=(ma,Ga)=>{this.zVd=!0;this.zpa(ma,Ga)};this.getColorName=ma=>O.a.xLa(J.a.qH(ma));d.ULS.shipAssertTag(529105669,0,!!Cb.ActiveCell);d.ULS.shipAssertTag(529105668,0,!!Cb.SelectedRange);d.ULS.shipAssertTag(529105667,0,t.E(Cb.SelectedRange).contains(t.D(Cb.ActiveCell)));d.ULS.shipAssertTag(529105666,0,P.a.equals(Cb.SelectedRange.SheetName,Cb.ActiveCell.SheetName,!0));this.Tdb=new $a.a(kb,pa.a.hmh,()=>this.Nic,1);this.selectedRange=Cb.SelectedRange;this.gsc=Cb.ActiveCell;this.o4g=Cb.ExpandSelection;
this.namedSheetViewPublic=ob;this.uCa=qa;this.initializeAndShow(W.a.instance.ga(181),this.P9c,this.Yta(Cb))}dispose(){this.Nic||(this.Nic=!0,this.a4b(),this.I6=null,this.Tdb.dispose(),this.Tdb=null);super.dispose()}get pc(){return"CustomSortDialog"}get ha(){return G.h(this.$).ha}LPh(kb){return Cb=>{H.b(Cb,-901005882)?(Ea.a(this.$).kd.WL(-901005882),this.YJd()):H.b(Cb,-569193796)?(Ea.a(this.$).kd.WL(-569193796),this.hide(),new Ba(this.$,Cb.Errors[0])):H.a(Cb)?(d.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),
this.hide()):(Cb=Cb.Result,this.$.Sj(Cb.SortRange),Cb&&fa(Cb)&&wa(Cb)&&oa(Cb)?kb(Cb):this.e9b(cb.wtb()))}}wQh(kb,Cb){return(ob,qa)=>{if(this.Nic)d.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!ob||H.a(ob))d.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${C.a.qc(ob.Errors)}`),this.$.ea.$n(ob.Errors),this.hide();
else{ob=ob.Result;var ma=kb.RangeType,Ga=kb.HeaderRowSize,vb=kb.SortTopToBottom;ob&&Y(ob,kb.ConditionType)&&U(ob,ma,Ga,vb)?(ob.ColumnInfo.ColumnOffset=qa,void 0!==ob.HeaderColumnInfo&&null!==ob.HeaderColumnInfo&&(ob.HeaderColumnInfo.ColumnOffset=qa),Cb(ob,kb.ConditionType,kb.SortTopToBottom)):(d.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.e9b(cb.wtb()))}}}Xgh(kb){const Cb={};Cb.SelectedRange=
this.selectedRange;Cb.ActiveCell=this.gsc;Cb.SortInfoMode=kb;Cb.ExpandSortSelection=this.o4g;Cb.ExpandSortSelectionSupported=!0;return Cb}Yta(kb){const Cb={};Cb[N.a.pt]=this.pc;Cb.fromAutoFilter=kb.FromAutoFilter;Cb.gridRTL=G.h(this.$).rtl;Cb.activeCell=kb.ActiveCell;Cb.selectedRange=kb.SelectedRange;Cb.invokeGetSortInfo=this.Roi;Cb.invokeGetSortConditionColorsOrIcons=this.Qoi;Cb.highlightSortRange=this.lhi;Cb.getColorName=this.getColorName;return Cb}zpa(kb,Cb){kb=t.E(kb);this.ha.ra.xd.equals(kb)||
this.ha.updateSelection(kb,t.D(Cb),0,void 0,void 0,void 0,!0)}YJd(){(new R(kb=>{const Cb={};Cb.ActiveCell=this.gsc;Cb.SelectedRange=this.selectedRange;Cb.ExpandSelection=kb;Cb.FromAutoFilter=!1;this.$.Yc(-207540907,w.a.zb,8,{["SortCommandData"]:Cb})})).show()}a4b(){if(void 0!==this.I6&&null!==this.I6)for(const kb of this.I6)this.$.pa.va.Ogb(kb.Xs)}static Wfj(kb,Cb){kb.Yc(1659552324,w.a.zb,8,{["CustomSortCommandData"]:Cb})}static wtb(){return C.a.hd(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}
Object(r.a)(cb,"CustomSortDialog",E.a,[]);var ib=a(1104);class ta{constructor(kb){this.selection=null;this.selection=kb}getSelection(){return this.selection}}Object(r.a)(ta,"MacroRecorderRangeAutoFilterClearedPayload",null,[123]);class Ya{constructor(kb){this.filterRange=null;this.filterRange=kb}}Object(r.a)(Ya,"MacroRecorderRangeFilterReappliedPayload",null,[123]);var Da=a(63);const ba=(kb,Cb,ob,qa,ma,Ga,vb=null)=>{vb=kb.Oa(41,vb);vb.options=Cb;return Da.g(kb,"Sort",vb,ob,qa,ma,Ga,0)},ya=(kb,Cb,
ob,qa,ma,Ga,vb=null)=>{vb=kb.Oa(41,vb);vb.selectedRange=Cb;return Da.g(kb,"ClearAutoFilter",vb,ob,qa,ma,Ga,0)},V=(kb,Cb,ob,qa,ma,Ga,vb=null)=>{vb=kb.Oa(41,vb);vb.filterRange=Cb;return Da.g(kb,"ReapplyAutoFilter",vb,ob,qa,ma,Ga,0)};var Z=a(787),ja=a(788),la=a(118),ua=a(58),eb=a(1105),Eb=a(206),Wb=a(33),Ab=a(350),Jb=a(71),Gb=a(4);class Nb{constructor(kb,Cb){this.sortOptions=this.ETa=this.selectedRange=null;this.Gjf=!1;this.activeCell=this.Ee=this.ub=this.hc=null;this.onContentReady=()=>{this.AWf(!1);
const ob=this.ha();ob.ra.eh&&ob.ra.xd.equals(this.ETa)&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?ob.updateSelection(this.selectedRange,t.D(this.activeCell),0,void 0,void 0,void 0,!0):ob.updateSelection(this.selectedRange,ob.ra.activeCell,0,void 0,void 0,void 0,!0))};this.EYi=(ob,qa)=>{ob&&!C.a.Zf(ob.Errors)&&this.hc&&(this.hc.Wo=ob.Result,this.hNb(),this.applyPivotSort(qa))};this.DYi=()=>{};this.X4i=(ob,qa)=>{var ma,Ga;if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7586534_SVDetermineFilterToggleState")){if(this.$.ua.na.ZW||
!qa.selection)return}else if(!((null===qa||void 0===qa?0:qa.Yhg)||(null===(ma=this.$.na)||void 0===ma?0:ma.hasAutoFilter))||!qa.selection)return;Gb.AFrameworkApplication.Qq("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control");Wb.a.Esd()&&(ob=Jb.d(this.$.ua.na),this.Zhg(new Ab.a(t.E(qa.selection),ob)))}else((null===qa||void 0===qa?0:qa.Yhg)||(null===(Ga=this.$.na)||void 0===Ga?0:Ga.hasAutoFilter))&&qa.selection&&Wb.a.Esd()&&(ob=Jb.d(this.$.ua.na),
this.Zhg(new Ab.a(t.E(qa.selection),ob)))};this.$=kb;this.Nrf="";this.namedSheetViewPublic=Cb;this.gridView=G.h(this.$);this.$.Mb.vg("LoadResource","LoadDialogControlsStopwatch")}X0(kb){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){var Cb=this.$.da.Ba(465);Cb&&Cb.X0(5,kb)}}Mc(kb,Cb){return!this.Wtd(kb,Cb)}executeCommand(kb,Cb,ob){let qa=null;kb=Cb.command;switch(kb){case -864298118:qa=this.Xrh(Cb,ob);break;case -1010737776:qa=
this.u$c(!0,Cb,ob);break;case 2123420468:qa=this.u$c(!1,Cb,ob);break;case -1089513346:ob=this.b4e(ob);if(!this.VCb([t.E(ob.SortOptions.SelectedRange)]))return f.TaskExtensions.Yj();qa=this.bPe(Cb,ob);break;case -1032691499:case -764711886:case -2016161444:qa=this.aej(Cb,ob);break;case -207540907:case -1677817820:qa=this.gridView.tb.n5(this.ha().ra.activeCell)?this.Odj():this.Ldj(Cb,ob);break;case 1659552324:qa=this.bPe(Cb,this.b4e(ob));break;case 368460465:qa=this.nsh(Cb,ob);break;case 529856798:qa=
this.Srh(Cb);break;case 644342024:qa=this.ish(Cb)}return qa||S.a(kb)}Ac(kb,Cb){if(kb=1===kb)switch(Cb.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:case -1032691499:case -764711886:case -2016161444:break;default:kb=!1}return kb}Rc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}AWf(kb){kb?this.gridView.ev(this.onContentReady):this.gridView.ty(this.onContentReady);
this.Gjf=kb}get ra(){return this.ha().ra}sMj(kb){return!!this.sortOptions&&P.a.equals(this.Nrf,kb.Gia,!0)}Wtd(kb,Cb){const ob=G.h(this.$).ha.ra.selectedRanges;return(new z.a(this.$.ua)).xm(kb,Cb,ob,this.gridView)}u$c(kb,Cb,ob){const qa=new h.a;this.Pgf(qa,ob,kb);return this.VCb([t.E(qa.SelectedRange)])?this.gridView.tb.n5(t.E(qa.SelectedRange))?this.fsh(kb):this.mqd(qa,Cb):f.TaskExtensions.Yj()}Xrh(kb,Cb){d.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");let ob=
null;const qa=this.ha();qa&&(this.sMj(qa)?this.VCb(qa.ra.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,ob=this.mqd(this.sortOptions,kb)):ob=this.u$c(!0,kb,Cb));return ob}VCb(kb){return this.$.isEditMode?this.$.$s(kb,!0,1):this.$.y_c(kb,!0,1)}fsh(kb){this.O3h(kb);return ua.Task.Ta(!0)}V0g(kb){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const Cb=this.gridView.tb.uh(this.ra.xd,!1);if(Cb)return new u.a(Cb.name,this.ra.activeCell.left-
Cb.usedRange.left,kb.IsAscending)}return new m.a(kb)}mqd(kb,Cb){this.gridView.Ng.mM(!1);const ob=()=>this.V0g(kb);return this.Had((qa,ma,Ga)=>ba(this.$.pa.va,kb,D.b(qa,this.xQh(Cb)),ma,Ga,kb),qa=>new v.a(141,0,qa,void 0,ob),Cb,this.iLj(kb))}iLj(kb){if(!this.namedSheetViewPublic)return!1;const Cb=this.ra.xd,ob=t.v(this.ra.xd,this.$),qa=this.gridView.tb.AV(Cb,!0),ma=this.ra.aca()&&this.gridView.tb.Anf(ob),Ga=this.gridView.tb.Xwi(ob);kb=(Cb.v5||Cb.g_)&&!Cb.isSingle&&(null==kb.ExpandSortSelection?!1:
kb.ExpandSortSelection)&&this.gridView.tb.Anf(ob);return qa||ma||Ga||kb}Odj(){return this.$.Yc(-1556797033,w.a.zb,8,null)}Ldj(kb,Cb){kb=8===kb.Ve&&Cb&&void 0!==Cb[Nb.Efb]&&null!==Cb[Nb.Efb]?Cb[Nb.Efb]:19===kb.Ve&&Cb&&void 0!==Cb[w.a.Sf]&&null!==Cb[w.a.Sf]?n.a.Yh(Cb[w.a.Sf]):this.agh();if(!this.VCb([t.E(kb.SelectedRange)]))return f.TaskExtensions.Yj();G.h(this.$).Ng.mM(!1);let ob=null;(Cb=Cb.TopCellAddress)&&(ob=t.o(Cb,this.$));new cb(this.$,kb,this.namedSheetViewPublic,ob);return ua.Task.Ta(!0)}b4e(kb){return kb[Nb.gmh]}bPe(kb,
Cb){const ob=Ga=>{this.ldf(Ga)?this.Ybf(Ga.Errors[0]):(Cb.ShouldRestoreSelection&&this.zpa(Cb.SelectedRange,Cb.OriginalActiveCell),d.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${kb.Ve}`),this.E_j(Cb),this.X0(Ga))},qa=()=>{Cb.ShouldRestoreSelection&&this.zpa(Cb.SelectedRange,Cb.OriginalActiveCell);d.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${kb.Ve}`)},
ma=()=>new x(Cb.SortOptions);return this.Had((Ga,vb,Ka)=>ba(this.$.pa.va,Cb.SortOptions,D.b(Ga,ob),D.a(vb,qa),Ka,this.sortOptions),Ga=>new v.a(187,0,Ga,void 0,ma),null,Cb.ShouldPromptNamedSheetViewTeachingDialog)}zpa(kb,Cb){kb=t.E(kb);G.h(this.$).ha.ra.xd.equals(kb)||G.h(this.$).ha.updateSelection(kb,t.D(Cb),0,void 0,void 0,void 0,!0)}agh(){const kb={};kb.ActiveCell=t.o(this.ra.activeCell,this.$);kb.SelectedRange=t.v(this.ra.xd,this.$);kb.FromAutoFilter=!1;kb.ExpandSelection=null;return kb}nsh(kb,
Cb){const ob=this.hba();if(!ob)return ua.Task.Ta(!1);const qa=this.$.pa.va.$b(),ma=()=>new ib.a(ob);return y.a(this.$.userOperationManager,(Ga,vb,Ka)=>A.B(this.$.pa.va,ob,D.b(Z.a.K5a(la.a.Nqb,ja.a.toggleAutoFilter,Ga),this.X4i),vb,Ka,{selection:ob,Yhg:Cb.On},qa),Ga=>new v.a(516,0,Ga,64,ma),kb)}Srh(kb){const Cb=this.hba();if(!Cb)return ua.Task.Ta(!1);const ob=this.gridView.tb.uh(this.ra.xd,!0);ob&&d.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${ob.type.toString()}`);
const qa=this.$.pa.va.$b(),ma=()=>new ta(Cb);return this.Had((Ga,vb,Ka)=>ya(this.$.pa.va,Cb,Z.a.K5a(la.a.fta,ja.a.clearAutoFilter,Ga),vb,Ka,null,qa),Ga=>new v.a(517,0,Ga,64,ma),kb)}Had(kb,Cb,ob,qa=!0){return this.namedSheetViewPublic&&qa?this.namedSheetViewPublic.lTa().continueWith(ma=>{ma.result&&y.a(this.$.userOperationManager,kb,Cb,ob)}):y.a(this.$.userOperationManager,kb,Cb,ob)}ish(kb){const Cb=this.hba();if(!Cb)return ua.Task.Ta(!1);const ob=this.$.pa.va.$b(),qa=()=>new Ya(Cb);return y.a(this.$.userOperationManager,
(ma,Ga,vb)=>V(this.$.pa.va,Cb,Z.a.K5a(la.a.fta,ja.a.Qgj,ma),Ga,vb,null,ob),ma=>new v.a(518,0,ma,64,qa),kb)}xQh(kb){return(Cb,ob)=>{var qa;H.b(Cb,-901005882)?(Ea.a(this.$).kd.WL(-901005882),this.YJd(ob,kb.command)):this.ldf(Cb)?this.Ybf(Cb.Errors[0]):!H.a(Cb)&&Cb.Result&&(this.sortOptions=ob,this.ETa=t.E(Cb.Result.ActualSortRange),this.Nrf=this.ha().Gia,this.Gjf||(this.selectedRange=this.ra.xd,this.selectedRange.equals(this.ETa)||(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&
(this.activeCell=t.o(this.ra.activeCell,this.$)),this.tPj())),(null===(qa=this.sortOptions)||void 0===qa?0:qa.ActiveCell)&&this.Nag(this.sortOptions)&&(ob=this.sortOptions.ActiveCell,ob=new k.Range(ob.FirstRow+1,ob.FirstColumn+1,ob.FirstRow+1,ob.FirstColumn+1,!0,!1),this.OO(ob),this.j0d(ob)),this.X0(Cb))}}ldf(kb){return H.b(kb,-569193796)}Ybf(kb){Ea.a(this.$).kd.WL(-569193796);new Ba(this.$,kb)}YJd(kb,Cb){(new R(ob=>{const qa={};qa.ActiveCell=kb.ActiveCell;qa.SelectedRange=kb.SelectedRange;qa.ExpandSelection=
ob;this.$.Yc(Cb,w.a.zb,8,{[Nb.Efb]:qa})})).show()}tPj(){const kb=this.ha();if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let Cb=t.D(this.activeCell);this.ETa.xe(Cb)||(Cb=this.ETa.topLeft);kb.updateSelection(this.ETa,Cb,0,void 0,void 0,void 0,!0)}else kb.updateSelection(this.ETa,kb.ra.activeCell,0,void 0,void 0,void 0,!0);this.AWf(!0)}hba(){const kb=this.ha();if(!kb)return d.ULS.shipAssertTag(537151573,0,!!kb,"SelectionManger is null"),null;
this.gridView.Ng.mM(!1);return t.v(kb.ra.xd,this.$)}hNb(){this.hc&&this.hc.Wo&&(this.Ee=this.hc.Wo,this.ub=this.hc.hdc())}O3h(kb){if(this.$.isEditMode&&(this.hc=this.gridView.tb.fp(this.ra.activeCell))){this.activeCell=t.o(this.ra.activeCell,this.$);if(this.hc&&this.hc.Wo){var Cb=this.hc.Wo.CurrentCol;if(this.hc.Wo.CurrentRow===this.activeCell.FirstRow&&Cb===this.activeCell.FirstColumn){this.hNb();this.applyPivotSort(kb);return}}this.$.pa.va.$b();Cb=new v.a(228,0,(ob,qa,ma)=>A.l(this.$.pa.va,this.activeCell,
D.b(ob,this.EYi),D.a(qa,this.DYi),ma,kb),16);this.$.userOperationManager.Oc(Cb,null)}}applyPivotSort(kb){if(this.hc&&this.ub&&this.activeCell&&this.Ee){var Cb=8===this.Ee.CellArea,ob=1===this.Ee.CellArea||2===this.Ee.CellArea;(Cb||ob)&&8!==this.Ee.CellType&&4!==this.Ee.CellType&&(Cb?y.a(this.$.userOperationManager,(qa,ma,Ga)=>A.b(this.$.pa.va,this.activeCell,kb?1:2,this.ub.Caption,qa,ma,Ga,null),qa=>new v.a(1015,0,qa,void 0,null),null):(Cb=1===this.Ee.CellArea?1:2,I.EwaSettings.xa(600)?l.a.naps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.hc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.hc.isOlap?"":this.ub.Caption,Cb,kb):l.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.hc.externalSourceIndex,this.ub.Index.toString(),kb)))}}E_j(kb){this.Nag(kb.SortOptions)&&(kb.TopCellAddress?kb=t.D(kb.TopCellAddress):(kb=kb.OriginalActiveCell,kb=new k.Range(kb.FirstRow+1,kb.FirstColumn+1,kb.FirstRow+1,kb.FirstColumn+1,!0,!1)),this.OO(kb))}OO(kb){Wb.a.Ela(this.$)&&
f.TaskExtensions.za(e.GetServiceTaskFactory.Pa(this.$.da,430,431,1),Cb=>{Cb.result.Qea(kb);d.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ka,3)}j0d(kb){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Pa(this.$.da,476,475,0),Cb=>{Cb.result.j0d(kb,0);d.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.ka,3)}aej(kb,Cb){if(!this.VCb(this.ra.selectedRanges))return f.TaskExtensions.Yj();const ob=new h.a;this.Pgf(ob,Cb);ob.SortConditions=[this.ojh(kb)];ob.OperationType=2;return this.mqd(ob,kb)}ojh(kb){const Cb=this.gridView.Jb(this.ra.activeCell);let ob=new eb.a;ob.IsAscending=!0;switch(kb.command){case -1032691499:Cb.mzb?(kb=Eb.a.cp(Cb.backgroundColor),ob.SortColor=kb.pS(!0)):ob.SortColor=Nb.NoColor;ob.SortConditionType=1;break;case -764711886:ob.SortColor=Cb.I4c===Nb.NoColor?Nb.NoColor:Eb.a.Tye(Cb.I4c);
ob.SortConditionType=2;break;case -2016161444:Cb.szb?(ob.SortIcon=Cb.cell.Olc,ob.SortIconSet=Cb.Plc):(ob.SortIcon=Nb.a5d,ob.SortIconSet=Nb.a5d);ob.SortConditionType=3;break;default:d.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return ob}Zhg(kb){f.TaskExtensions.za(e.GetServiceTaskFactory.Pa(this.$.da,426,427,1),Cb=>{void Cb.result.$Dc(kb,"Filter")},this.$.ka,3)}Pgf(kb,Cb,ob=!0){kb.OperationType=
0;kb.IsAscending=ob;kb.HasHeader=!0;kb.GuessHeader=!0;kb.SortTopToBottom=!0;kb.ExpandSortSelectionSupported=!0;Cb&&Cb[Nb.Efb]?(Cb=Cb[Nb.Efb],kb.ActiveCell=Cb.ActiveCell,kb.SelectedRange=Cb.SelectedRange,kb.ExpandSortSelection=Cb.ExpandSelection):(kb.ActiveCell=t.o(this.ra.activeCell,this.$),kb.SelectedRange=t.v(this.ra.xd,this.$),kb.ExpandSortSelection=null)}Nag(kb){return!kb.SortConditions||kb.SortConditions.some(Cb=>0===Cb.SortConditionType)}}Nb.gmh="CustomSortCommandData";Nb.Efb="SortCommandData";
Nb.a5d=-1;Nb.NoColor=0;Object(r.a)(Nb,"SortCommandHandler",null,[222]);var Ja=a(70),ab=a(108),wb=a(153),xb=a(54);class rb extends b.a{constructor(kb){super(kb)}ld(){const kb=Object(Ja.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Object(ab.c)(wb.a.resolve(xb.z,{Wb:this.Na})):e.GetServiceTaskFactory.Pa(this.$.da,309,310,this.Na);f.TaskExtensions.za(kb,Cb=>{this.fd([new Nb(this.$,Cb.result)])},this.$.ka,3)}static la(kb){b.a.Rd(160,new rb(kb))}}Object(r.a)(rb,"SortCommandHandlerFactory",b.a,
[]);E=a(228);bb=a(155);let za=class{constructor(kb){I.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")||kb.da.Ha(446,this)}YKe(kb,Cb){new Ba(kb,Cb)}};za=Object(bb.b)([Object(wb.d)(xb.P),Object(bb.c)(0,Object(xb.o)())],za);Object(r.a)(za,"SortUtil",null,[268]);class Aa extends E.a{constructor(kb){super();this.$=kb;this.Gb()}create(){let kb=this.$.da.Ba(446);kb||(kb=new za(this.$),this.$.da.Ha(446,kb));this.qb(kb)}static la(kb){kb.da.Ha(447,new Aa(kb))}}Object(r.a)(Aa,
"SortUtilFactory",E.a,[]);a.d(B,"a",function(){return pb});const pb=()=>{c.a.Fa(kb=>{rb.la(kb);I.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")||Aa.la(kb)})}},1193:function(r,B,a){r=a(0);var c=a(558),b=a(15),e=a(141),f=a(56);class d extends e.StandardDialog{constructor(){super();this.Rb=0;this.wc(1,CommonUIStrings.l_DialogClose)}displayError(ba,ya){this.HOe(ba,ya,f.a.Xwj)}HOe(ba,ya,V){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",
V);this.Xz(V,ba,ya,null)}i$c(ba,ya){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Xz(f.a.Zwj,ba,ya,null,!0)}}Object(r.a)(d,"ErrorDialog",e.StandardDialog,[172]);var h=a(88);e=a(1082);var l=a(156);class k{static get qg(){return l.a.Iq(k.Ql,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}k.Ql="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(r.a)(k,"FileNameDialogHtml",null,[]);var w=a(4),n=a(13),x=a(47),m=a(90),u=a(92),t=a(31);class y extends e.a{constructor(ba,ya,V,Z,ja,la,ua,eb){super(ba,ya,V,Z,ja,la,eb);this.Xqa=this.UTc=this.Py=null;this.E2g=CommonUIStrings.l_SaveToAnotherFolder;this.qg=k.qg;this.we="FileNameDialog-SaveToSharePoint";this.jnb=ua;this.wEg=eb}hQ(ba){const ya=t.a.Pp(w.AFrameworkApplication.um.ln),V=w.AFrameworkApplication.breadcrumbFolderName,Z=w.AFrameworkApplication.breadcrumbBrandName,ja={["txtFileName"]:ba||
ya};let la=CommonUIStrings.L_SaveAs;2===w.AFrameworkApplication.sa.Qa.ri&&(la=CommonUIStrings.L_SaveACopy);this.initializeAndShow(la,Object(h.a)(this,this.Zac,"fileNameDialogHandler"),ja);this.pOe(ba,ya);this.wJa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");w.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.Py=document.getElementById("anotherFolder"),ba=document.getElementById("folderLocation"),this.UTc=
u.a.Kve(ba,this.Py,"anotherFolderDescribedBy"),this.Py.className="WACButton WACDialogButtonNormal",ba=!1,V&&V.length?(this.bqe(this.Py,this.UTc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Z,V)),ba=this.rLg(Z,V)):this.bqe(this.Py,this.UTc,CommonUIStrings.l_CurrentOnlineFolder),this.pMg(this.Py),this.tLg(this.Py),ba?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Py,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,50,
"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Py,"SaveToAnotherLocationOne"),x.a.addHandler(this.Py,n.a.click,Object(h.a)(this,this.NFd,"onSaveToAnotherLocationClick")),x.a.addHandler(this.Py,n.a.Vb,Object(h.a)(this,this.fKf,"onSaveToAnotherLocationKeyDown")))}rLg(ba,ya){let V;V=!1;const Z=document.getElementById("currentLocation");Z.innerText="";const ja=this.S6e(Z,ba),la=this.S6e(Z,ya);let ua=255,eb=255;255<ja+la&&(ua=Math.max(238,408-ja),eb=Math.max(170,
408-la),V=!0);this.NNg(Z,ba,eb,ya,ua);return V}S6e(ba,ya){const V=document.createElement("div");V.innerText=ya;V.style.visibility="hidden";ba.appendChild(V);ya=V.clientWidth;ba.removeChild(V);return ya}NNg(ba,ya,V,Z,ja){ya&&(this.$pe(ba,ya,V),this.ENg(ba));Z&&this.$pe(ba,Z,ja)}$pe(ba,ya,V){const Z=document.createElement("div");Z.innerText=ya;Z.title=ya;Z.className="SaveToAnotherFolderBreadcrumb";Z.style.maxWidth=V.toString()+"px";ba.appendChild(Z)}ENg(ba){const ya=document.createElement("span");ya.id=
"FolderSeparator";const V=document.createElementNS("http://www.w3.org/2000/svg","svg");V.setAttribute("class","SeparatorCaret");const Z=document.createElementNS("http://www.w3.org/2000/svg","polygon");Z.setAttribute("points","1 4 1 11 5 7.5");V.appendChild(Z);ya.appendChild(V);ba.appendChild(ya)}bqe(ba,ya,V){V=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,V);ya&&(ya.innerText=V);ba.tabIndex=0;ba.setAttribute(u.a.Jd,u.a.Ws)}tLg(ba){const ya=document.createElement("span");ya.id=
"anotherFolderText";ya.innerText=this.E2g;ya.className="AnotherFolderTextSpan";ba.appendChild(ya)}pMg(ba){const ya=document.createElement("span");ya.className="cui-img-cont-float cui-img-16by16 ";this.Xqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Xqa.setAttribute("class","FolderIconSVG");const V=document.createElementNS("http://www.w3.org/2000/svg","path");V.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.Xqa.appendChild(V);ya.appendChild(this.Xqa);ba.appendChild(ya)}fKf(ba){!ba||ba.keyCode!==m.a.Sh&&ba.keyCode!==m.a.nX||this.NFd(ba)}NFd(){if(this.ZI){const ba=t.a.k4(w.AFrameworkApplication.fileName);let ya=this.ZI.value;this.hide();ya&&""!==ya&&""!==ba||1===this.sa.state?(""!==ba&&(ya+=ba),this.$ac(ya)?this.Ls.create().displayError(1,ya,!1):this.jnb.start(ya,this.wEg)):this.Ls.create().displayError(2,ya,!1)}}w6g(ba){this.Py&&this.Xqa&&(ba?(this.Py.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Py,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Xqa,"DisabledFolderIconSVG")):(this.Py.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Py,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Xqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Py,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Xqa,"DisabledFolderIconSVG"))))}amd(){super.amd();this.w6g(!!this.ZI&&""!==this.ZI.value)}dispose(){this.Py&&(x.a.removeHandler(this.Py,n.a.click,Object(h.a)(this,
this.NFd,"onSaveToAnotherLocationClick")),x.a.removeHandler(this.Py,n.a.Vb,Object(h.a)(this,this.fKf,"onSaveToAnotherLocationKeyDown")),this.Py=null);super.dispose()}}Object(r.a)(y,"FileNameDialog",e.a,[195]);var v=a(702),A=a(559),z=a(197),C=a(832),H=a(932),I=a(102),S=a(143);class P{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(r.a)(P,"SaveAsDialogInput",null,[]);class D{constructor(){this.properties=this.friendlyPath=this.folderName=
null}}Object(r.a)(D,"SaveLocation",null,[]);var G=a(381),E=a(199);class O{constructor(ba,ya,V,Z,ja,la,ua,eb,Eb){this.ZPc=null;this.nA="";this.jnb=ba;this.Ls=ya;this.Ih=Eb;this.Rga=V;this.ff=ja;this.Wv=Z;this.oGa=ua;this.GYa=eb;la&&(this.ZPc=new c.a(()=>new C.a(la.value,null)))}uWh(){const ba=new v.a(A.a.li());ba.ia("type","currentHost");return Object.assign(new D,{folderName:this.Wv.breadcrumbFolderName,friendlyPath:this.Wv.breadcrumbBrandName,properties:ba})}Jyi(ba){return!!ba&&"ClassicMru"===ba.type&&
!!ba.service_info&&!!ba.service_info.service_id&&-1!==ba.service_info.service_id.indexOf("SHAREPOINT")}m7h(){if(!this.ZPc||!this.oGa)return null;var ba=this.ZPc.value.HZ("SaveAsToSharePointDialog",!1);if(!ba||3!==ba.state||!ba.Myf)return null;ba=ba.Myf;const ya=new z.a;let V=0,Z=0;for(var ja=0;ja<ba.length;ja++){var la=ba[ja];if(!this.Jyi(la))continue;V++;if(!la.sharepoint_info)continue;const ua=la.url,eb=la.sharepoint_info.site_url,Eb=la.title;la=H.b(la,w.AFrameworkApplication.isRtl);if(!(ua&&eb&&
Eb&&la))continue;Z++;const Wb=new v.a(A.a.li());Wb.ia("type","SharePoint");Wb.ia("siteUrl",eb);Wb.ia("folderUrl",ua);Z++;ya.add(Object.assign(new D,{folderName:Eb,friendlyPath:la,properties:Wb}))}ja=new Map;ja.set("NumPlaces",ba.length.toString());ja.set("NumSharepointPlaces",V.toString());ja.set("placesWithMetadata",Z.toString());I.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",ja);0<V&&(Z?.5>1*Z/V&&I.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",
!1,!1,null):I.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ya}kXh(){const ba=new z.a;ba.add(this.uWh());const ya=this.m7h();ya&&ba.addRange(ya);return Object.assign(new P,{enableMoreLocations:!w.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.nA,extension:t.a.k4(this.Wv.ln),saveLocations:ba.toArray(),scenario:"SaveToSharePoint"})}kdc(){const ba=Object(h.a)(this,this.kXh,"getDialogInput"),ya={};ya.inputPropsCallback=
ba;return ya}hQ(ba){this.nA=ba;this.nA||(this.nA=String.format(CommonUIStrings.l_SaveACopy_Filename,t.a.Pp(this.Wv.ln)));ba={["id"]:"SaveAsDialog",["bodyControls"]:this.kdc()};let ya=CommonUIStrings.L_SaveAs;2===this.ff.Qa.ri&&(ya=CommonUIStrings.L_SaveACopy);const V=new l.a(!1,!1,!0);V.Rb=1;V.we="SaveAsDialog";V.wc(1,CommonUIStrings.l_SaveButtonLabel);V.initializeAndShow(ya,Object(h.a)(this,this.Twj,"saveAsDialogHandler"),ba)}xOj(ba,ya){ba&&""!==ba&&""!==ya||1===this.ff.state?this.Iyi()?this.nFi(ba,
ya):(""!==ya&&(ba+=ya),this.jnb.start(ba,this.Ih)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Ls.create().displayError(2,ba,!1))}nFi(ba,ya){I.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const V=this.GYa.KJe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.GYa.Phd(V).then(Z=>{if(Z&&0<Z.length){const ja=Z[0][G.a.P9i];Z=Z[0][G.a.hPf];if(""!==ja&&""!==
Z)this.oGa.Poa(Z,ba+ya,ja,this.Ih),I.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.Ls.create().displayError(0,ba,!1);const la=S.a.Wr();la&&(la.set("SiteUrlAvailable",""===ja?"false":"true"),la.set("FolderUrlAvailable",""===Z?"false":"true"));I.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new E.a,{extendedProperties:la}))}}else this.Ls.create().displayError(0,ba,!1),I.Health.instance.recordKpiFailure("SaveACopySFP",
"Picker Data is unavaliable",!1,!1,null)}).catch(Z=>{"Canceled"===Z?((Z=S.a.Wr())&&Z.set("IsCanceled","true"),I.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new E.a,{extendedProperties:Z}))):I.Health.instance.recordKpiFailure("SaveACopySFP",Z,!1,!1,null)})}Iyi(){return this.GYa?this.GYa.sud():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Twj(ba,ya){if(ya&&1===ba){ba=ya.fileName;var V=t.a.k4(this.Wv.ln);ya.moreLocationsSelected&&this.xOj(ba,V);if(ya.locationCallback){var Z=
ya.locationCallback();Z?Z.properties&&"currentHost"===Z.properties.ma("type")?this.Rga.Poa(ba+V,!1,this.Ih):Z.properties&&"SharePoint"===Z.properties.ma("type")?(ya=Z.properties.ma("siteUrl"),Z=Z.properties.ma("folderUrl"),this.oGa.Poa(Z,ba+V,ya,this.Ih)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(r.a)(O,"ReactSaveAsDialog",null,
[195]);class N{constructor(ba,ya,V,Z,ja,la,ua,eb=null,Eb=null,Wb=null){this.La=ya;this.fb=ba;this.yX=Z;this.Rga=la;this.Ls=ja;this.ff=V;this.Dke=ua;this.cDg=eb;this.oGa=Eb;this.GYa=Wb}create(ba){return this.ff&&this.ff.Qa.Fv?new O(this.Dke,this.Ls,this.Rga,w.AFrameworkApplication.um,this.ff,this.cDg,this.oGa,this.GYa,ba):new y(this.fb,this.La,this.ff,this.yX,this.Ls,this.Rga,this.Dke,ba)}}Object(r.a)(N,"FileNameDialogFactory",null,[173]);class J{constructor(ba,ya,V,Z){this.Qo=this.jmb=null;this.ckb=
ba;this.ff=V;this.SEg=Z;this.HEa=new c.a(()=>new C.a(ya.value,Object(h.a)(this,this.jyb,"getMoreInfoEventReceived")))}get RMf(){this.jmb||(this.HEa.value.HZ("Save As",!0),this.Qo&&this.Qo.ER&&this.Qo.ER.length&&(this.jmb=this.$2h(this.Qo.ER)));return this.jmb}start(ba){if(!this.RMf)if(w.AFrameworkApplication.breadcrumbFolderUrl&&w.AFrameworkApplication.breadcrumbFolderUrl.length)this.jmb=w.AFrameworkApplication.breadcrumbFolderUrl;else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.Qo),!1;const ya=this.SEg();ya.QOj();const V=ya.I3h();if(!V)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.ckb.start((Z,ja)=>{ya.hide();ba(Z,ja)},()=>{this.Pca(ya)},V,this.jmb);return!0}Pca(ba){ba.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}$2h(ba){ba=ba.toLowerCase();ba.endsWith("/")||(ba+="/");const ya=ba.indexOf("/documents/");return-1!==ya?ba.substring(0,ya+1)+"_layouts/15/onedrive.aspx":""}jyb(ba){this.Qo||
3!==ba.state||(this.Qo=ba)}}Object(r.a)(J,"OneDriveFilePickerHelper",null,[171]);class W extends l.a{constructor(){super()}QOj(){this.IKc="FilePickerDialog";this.qg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.we="PickerDialog-MsoSp";this.showDialog("",null)}I3h(){return document.getElementById("FilePickerDiv")}LD(){}rna(){}}Object(r.a)(W,"PickerDialog",l.a,[174]);var ea=a(655),R=a(857),Y=a(383),U=a(27),da=a(111),T=a(25);class ka{constructor(ba,ya,V,Z,ja,la,ua){this.fb=ba;this.RLc=
V;this.La=ya;this.jnb=Z;this.ckb=ja;this.JRc=la;this.ixg=ua}Hg(){const ba=this.ckb.u5a();ba?U.a.Exa||this.fb.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Je(T.a.saveToSharePoint,da.a.frame,Object(h.a)(this,this.Q3f,"saveToSharePointActionDispatcher"),64):(ba.K9a.continueWith(ya=>{ya.Lf&&this.ckb.aFd(ya)}),this.P3b()):b.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}P3b(){Y.a.cMd(Object(h.a)(this,this.Q3f,"saveToSharePointActionDispatcher"));
Y.a.Gad([new R.a(T.a.saveToSharePoint,da.a.frame,0)],this.ckb.u5a())}get T8a(){return this.fb.qa("SaveToAnotherFolderBrsIsEnabled")}get YBe(){return this.fb.qa("UserCanWriteRelative")}Q3f(ba,ya,V,Z,ja){return ya.contextId!==da.a.frame||ba!==T.a.saveToSharePoint?2:this.T8a&&(this.JRc.RMf||this.YBe)?1===V?ea.SessionStatusManager.instance.h6a||w.AFrameworkApplication.h5?8:this.ixg()?32:8:2===V?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(ja&&ja.SaveEntryPoint&&
"VersionHistory"===ja.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.YBe?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.RLc.create(ja).hQ(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.jnb.start(null,ja)),32):8:8}}Object(r.a)(ka,"SaveToSharePointActor",null,[]);class L{constructor(ba,ya,V,Z){this.Ih=this.Hge=null;this.oGa=ba;this.Ls=ya;this.JRc=V;this.ff=Z}start(ba,ya){b.ULS.sendTraceTag(25180163,
216,50,"Try launch Picker.");this.Hge=ba;this.Ih=ya;this.JRc.start((V,Z)=>{this.sdj(V,Z)})||this.uWd()}sdj(ba,ya){if(ba)this.onSuccess(ya);else this.r6(ya)}uWd(){1!==this.ff.state&&this.Ls().i$c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(ba){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(ba&&ba.data&&ba.data.value&&ba.data.value.length&&ba.data.value[0].sharePoint){const ya=ba.data.value[0].sharePoint.url;
ba=ba.data.value[0].sharePoint.listUrl;let V=null;if(ya&&(V=ba?this.I7h(ba):this.H7h(ya))){this.oGa.Poa(ya,this.Hge,V,this.Ih);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!ya,!V)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.uWd()}H7h(ba){ba.endsWith("/")||(ba+="/");let ya=0;for(let V=0;V<ba.length;V++)if("/"===ba.charAt(V)&&5===++ya)return ba.substr(0,V);return null}I7h(ba){ba.endsWith("/")&&
(ba=ba.substring(0,ba.length-1));const ya=ba.lastIndexOf("/");return-1!==ya?ba.substring(0,ya):null}r6(ba){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");ba&&ba.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",ba.error.errorCode,ba.error.message):b.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.uWd()}}Object(r.a)(L,"SaveToSharePointManager",null,[489]);var fa=a(82);class wa{constructor(ba,
ya,V,Z,ja,la,ua,eb){this.uGa=ba;this.nA=ya;this.IWa=Z;this.KSc=la;this.P8=V;this.sHg=ja;this.Qfa=ua;this.Ih=eb}execute(ba,ya){if(!w.AFrameworkApplication.ug&&w.AFrameworkApplication.Hd){var V=this.uGa+this.Qfa;V=fa.a.fl(V,"fu",t.a.pf(this.P8));V=fa.a.fl(V,"su",t.a.pf(this.sHg));V=fa.a.fl(V,"fn",t.a.pf(this.nA));V=fa.a.fl(V,"n",t.a.pf((new Date).getTime().toString()));this.Ih&&this.Ih.FileDownloadUrl&&(V=fa.a.fl(V,"furl",t.a.pf(this.Ih.FileDownloadUrl)));V=V+"&"+this.KSc;this.IWa&&this.IWa.length?
V=fa.a.fl(V,"fnn",t.a.pf(this.IWa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");w.AFrameworkApplication.Hd.Mm(V,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,ba,ya,null,void 0,void 0,void 0,void 0,"9")}}}Object(r.a)(wa,"SharePointSaveAsCaller",null,[412]);class oa{constructor(ba){this.vGa=ba.appSettings.SaveAsToHostWebServiceBase;this.nA=ba.appSettings.FileName;this.Qfa=ba.Wa("SharePointSaveAsHandler")||
"sharepointsaveashandler.ashx"}create(ba,ya,V,Z){return new wa(this.vGa,this.nA,ba,ya,V,w.AFrameworkApplication.xi,this.Qfa,Z)}}Object(r.a)(oa,"SharePointUploadCallerFactory",null,[376]);var xa=a(40),bb=a(41),Za=a(244),La=a(704),va=a(172),Ba=a(657),Ea=a(782);class pa{constructor(ba,ya,V,Z,ja){this.Km=this.PDa=null;this.nIc=!1;this.RTc=this.P8=null;this.dWc=ya;this.Kmb=V;this.Ls=Z;this.ff=ja;this.La=ba}Poa(ba,ya,V,Z){this.nIc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.KOb();this.P8=ba;Z&&Z.SaveEntryPoint&&(this.RTc=Z.SaveEntryPoint);this.PDa=this.dWc.create(ba,ya,V,Z);Z&&"true"===Z.SkipSaveToHost?this.oQ():this.oNh()}oNh(){const ba=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.oQ()};32!==this.La.$d(T.a.cSa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.oQ()},ba])&&ba()}oQ(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");
this.PDa.execute(Object(h.a)(this,this.O2i,"onSaveToSharePointUploadFinished"),Object(h.a)(this,this.N2i,"onSaveToSharePointUploadFailed"))}O2i(ba){if(ba&&ba.data&&ba.data.me){var ya;if(({ot:ya}=xa.d(ba.data.me)).returnValue)if(ya.StatusCode!==Za.a.ZO&&ya.StatusCode!==Za.a.Otb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",ba.data.status,ya.StatusCode),ya.StatusCode!==Za.a.t0f&&this.fPe(ba.data.status)||(this.Wda(ya.StatusCode.toString()),
this.CNj(ya.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.QOd();try{ya.NewDocumentUrl?this.$Qa(ya.NewDocumentUrl):this.aRa()}catch(V){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",V.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ea.a.Ngb(ba.data.me)}),this.v9b()||(this.Wda("Failed to deserialize response"),this.IOb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),
this.v9b()||(this.Wda("Unknown"),this.IOb())}N2i(ba){ba&&ba.data?this.fPe(ba.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Wda(La.a[ba.data.status]),this.IOb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.v9b()||(this.Wda("Unknown"),this.IOb()))}v9b(){if(!this.nIc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.nIc=!0,this.oQ(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");
return!1}fPe(ba){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",ba);return this.v9b()}aRa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");bb.a.nf(this.P8,bb.a.qX(3),void 0,"UploadToSharePointManager.RedirectToFolder")}$Qa(ba){let ya=!1,V=!1;w.AFrameworkApplication.fa&&(ya=w.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),V=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
ba,ya);if(ya&&V){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Z={};Z[G.a.UQa]="1";Z[G.a.documentUrl]=ba;Z[G.a.reason]=Ba.a.saveAs;w.AFrameworkApplication.JQ().execute(ja=>{ja.uj(va.a.fZ,Z)})}else bb.a.nf(ba,bb.a.qX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}KOb(){this.ff&&1===this.ff.state||(this.Km=this.Kmb(),this.Km.message=CommonUIStrings.l_CommentProgressTooltip,this.Km.Rb=5,this.Km.yt=!1,this.Km.PBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}EJa(){this.Km&&(this.Km.close(),this.Km=null)}IOb(){this.vj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}BOj(){this.vj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}KNj(){const ba=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.vj(CommonUIStrings.l_SaveAsFileTooLargeTitle,ba,f.a.Uwj)}vj(ba,ya,V=f.a.Ywj){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",ba,ya);
this.EJa();1!==this.ff.state&&this.Ls().HOe(ba,ya,V)}CNj(ba){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",ba);switch(ba){case Za.a.vkg:this.BOj();break;case Za.a.t0f:this.KNj();break;default:this.IOb()}}QOd(){"VersionHistory"===this.RTc&&this.La.processAction(T.a.Gwc,2)}Wda(ba){"VersionHistory"===this.RTc&&this.La.$d(T.a.TOd,2,{["FailureReason"]:ba})}}Object(r.a)(pa,"UploadToSharePointManager",null,[375]);var $a=a(257),cb=a(799),ib=a(524),ta=a(58);class Ya{constructor(){this.bsa=
this.bRc=this.XQc=this.$a=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Kh(ba){this.$a=ba;this.XQc=ib.a.gq(ba.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.bRc=ib.a.gq(ba.Tb("Common.IEventEmitter<Common.IMruResult>"));this.bsa=ib.a.gq(ba.Tb("Common.App.SharedFilePicker.ISharedFilePicker"));ta.Task.WAA.call(null,this.XQc,this.bRc,this.bsa).continueWith(()=>{this.Gjj()})}Gjj(){this.$a.register(oa,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Bc(()=>
new oa(w.AFrameworkApplication.fa)).tc();this.$a.register(pa,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Bc(()=>new pa(w.AFrameworkApplication.rb,this.$a.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new cb.a).create(),()=>new d,w.AFrameworkApplication.sa)).tc();this.$a.register(L,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Bc(()=>
new L(this.$a.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new d,this.$a.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),w.AFrameworkApplication.sa)).tc();this.$a.register(J,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Bc(()=>new J(this.$a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.XQc.result),w.AFrameworkApplication.sa,()=>new W)).tc();
this.$a.register(N,"Common.App.SaveToSharePoint.FileNameDialogFactory").Bc(()=>new N(w.AFrameworkApplication.fa,w.AFrameworkApplication.rb,w.AFrameworkApplication.sa,w.AFrameworkApplication.sa.Qa,this.$a.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.$a.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.$a.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new c.a(()=>this.bRc.result),this.$a.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
this.bsa?this.bsa.result:null)).tc();this.$a.register(ka,"Common.App.SaveToSharePoint.SaveToSharePointActor").Bc(()=>new ka(w.AFrameworkApplication.fa,w.AFrameworkApplication.rb,this.$a.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.$a.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.$a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.$a.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>w.AFrameworkApplication.sa.M4g)).tc();
w.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.$a.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Hg()}static main(){$a.a.instance.si(new Ya)}}Object(r.a)(Ya,"PackageManager",null,[4,5]);a.d(B,"a",function(){return Da});const Da=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");Ya.main()}},1201:function(r,B,a){var c=a(9);r=a(0);var b=a(714),e=a(50),f=a(38),d=a(1),h=a(196);class l{constructor(V,Z){this.$=V;this.presentModeManager=Z}Mc(){return!1}Ac(V,Z){if(!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",
!1))return!1;switch(Z.command){case 642419866:return!0;case 588342182:return this.presentModeManager.vz;default:return!1}}executeCommand(V,Z){V=f.TaskExtensions.Yj();Z=Z.command;switch(Z){case 642419866:this.presentModeManager.$Ac(!this.presentModeManager.vz);this.presentModeManager.ih("TogglePresentMode");break;case 588342182:this.presentModeManager.H8a=!this.presentModeManager.H8a;this.presentModeManager.Xbg(this.presentModeManager.H8a,"TogglePresentModeOverlay");this.presentModeManager.ih("TogglePresentModeOverlay");
break;default:V=h.a(Z)}return V}Rc(){return!1}}Object(r.a)(l,"PresentModeCommandHandler",null,[222]);class k extends b.a{constructor(V){super(V)}ld(){f.TaskExtensions.za(e.GetServiceTaskFactory.Pa(this.$.da,423,424,this.Na),V=>{this.fd([new l(this.$,V.result)])},this.ka,3)}static la(V){b.a.Rd(420,new k(V))}}Object(r.a)(k,"PresentModeCommandHandlerFactory",b.a,[]);var w=a(155),n=a(228),x=a(15),m=a(138),u=a(4),t=a(115),y=a(87);class v{}v.qBh="ewa-presentMode-overlay";v.rBh="ewa-presentMode-panel-container";
v.sBh="ewa-presentMode-rowHdrParent-container";Object(r.a)(v,"CssClassNames",null,[]);var A=a(18),z=a(5),C=a(160),H=a(301),I=a(132),S=a(379),P=a(198);a(60);var D=a(121),G=a(442),E=a(12),O=a(11),N=a(104),J=a(354),W=a(21),ea=a(133),R=a(528),Y=a(113),U=a(13),da=a(269),T=a(256),ka=a(168),L=a(45);class fa{constructor(V){this.Fxe=this.DQa=this.TId=this.UId=this.uda=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.jtc={};this.itc={};this.xQa=null;this.BPf=0;this.onKeyDown=Z=>{Z=Z.Ea;if(9===Z.keyCode){var ja=
this.uda.querySelectorAll(E.DOMElementExtensions.Hq);const la=E.DOMElementExtensions.Dl(ja);ja=E.DOMElementExtensions.UA(ja);E.DOMElementExtensions.xBa(Z,la,ja);return!0}return!1};this.am=()=>{this.$.da.hb(337,Z=>{this.DQa.getPresentModeFloatieControlsMap().then(ja=>{const la={};for(let ua=0;ua<ja.length;ua++)la[ja[ua].controlId]=ja[ua].modelType;ja=Z.b0.N5a(la);0<ja.length&&appChrome.api.dispatch(ja);this.pxj()})})};this.$=V}dispose(){this.$=this.TId=this.UId=this.uda=this.DQa=null}sli(){window.requestAnimationFrame(()=>
{this.uda=document.createElement("div");this.$.nv.insertBefore(this.uda,this.$.nv.lastChild);this.uda.id=this.$.Cb+z.a.Dbc;this.uda.classList.add(v.rBh);this.UId=document.getElementById(this.$.Cb+z.a.a9c);this.TId=[this.$.wC];this.isInitialized=!0});this.DQa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.DQa.initializePresentModeFloatie()}R8h(){const V={};V.PollingCountPerCaller=t.a.toJSON(this.itc);V.PollingDurationPerCaller=t.a.toJSON(this.jtc);return V}tWd(V){this.isInitialized?
V?(this.DQa.showPresentModeFloatie(this.uda,this.UId,this.TId),this.ih("ShowOrHideFloatiePanel"),this.Ikj()):(this.DQa.hidePresentModeFloatie(),this.M2j()):x.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}ih(V){this.BPf=O.HelperMethods.Lb();this.xQa=V;this.Fxe=ka.AsyncMethodContext.Cq(this.am,100,L.a.bcj+V,this.Fxe)}get mc(){return this.uda}get If(){this.DQa.updatePresentModeFloatieShyState(2);return!!this.uda}get ee(){return T.a.RQf}eg(V,
Z){if(Z)return!1;V=E.DOMElementExtensions.Dl(this.uda.querySelectorAll(E.DOMElementExtensions.Hq));if(!V)return x.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;V.focus();return!0}Bh(V){return E.DOMElementExtensions.Df(this.mc,V)}Bj(){}ik(){}Ikj(){da.a(this.$).fi(this);this.$.da.hb(15,V=>{this.ewaAccessibilityManager=V;this.ewaAccessibilityManager.mode=5});Y.KeyInputManager.instance.ta(U.a.Vb,this.mc,this.onKeyDown)}M2j(){da.a(this.$).Nz(this);
W.h(this.$).D0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);Y.KeyInputManager.instance.Aa(U.a.Vb,this.mc,this.onKeyDown)}pxj(){const V=O.HelperMethods.Lb()-this.BPf,Z=this.jtc[this.xQa]?this.jtc[this.xQa]:0;this.jtc[this.xQa]=Z>V?Z:V;this.itc[this.xQa]=this.itc[this.xQa]?this.itc[this.xQa]+1:1}}Object(r.a)(fa,"PresentModeFloatieManager",null,[321,63,3]);var wa=a(7),oa=a(64);class xa{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=
0}}Object(r.a)(xa,"OverlayCavityInfo",null,[]);class bb{constructor(){this.height=this.width=0}}Object(r.a)(bb,"OverlayContainerInfo",null,[]);class Za{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(r.a)(Za,"PresentModeOverlayProps",null,[]);class La{constructor(V){this.C0a=this.VId=null;this.$=V;this.gridView=W.h(this.$)}cmi(){this.VId=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>
{this.C0a=Array(5);let V,Z;for(let ja=1;4>=ja;ja++)V=document.createElement("div"),E.DOMElementExtensions.setVisible(V,!1),V.id=`${"PresentModeOverlay"}-${ja}`,E.DOMElementExtensions.toggleCssClass(V,v.qBh,!0),Z=this.gridView.Vf(ja).domElement,Z.insertBefore(V,Z.firstChild),this.C0a[ja]=V})}Wbg(V){V&&this.s6j();for(let Z=1;4>=Z;Z++)this.fnf(Z)&&E.DOMElementExtensions.setVisible(this.C0a[Z],V);E.DOMElementExtensions.toggleCssClass(this.$.Hp,"ewr-presentMode-overlay",V)}s6j(){const V=this.O3g();let Z;
for(let ja=1;4>=ja;ja++)Z=ja,V[Z]&&this.VId.showOverlayWithCavity(this.C0a[Z],V[Z])}dispose(){this.VId=this.C0a=this.gridView=this.$=null}O3g(){let V;const Z=W.h(this.$).rtl;let ja;const la=Array(5);for(let eb=1;4>=eb;eb++)if(V=eb,this.fnf(eb)){var ua=this.gridView.Vf(eb);ja=this.gridView.ha.Sa.Z4?this.kZh(eb,ua,Z):this.e_h(eb,ua,Z);ua=this.Fih(ua);la[V]=this.ajh(this.C0a[V].id,ua,ja)}return la}fnf(V){return this.gridView.jb.MQ(V)}Fih(V){return Object(wa.a)(new bb,{width:V.Dn.width,height:V.Dn.height})}ajh(V,
Z,ja){return Object(wa.a)(new Za,{containerId:V,overlayContainerInfo:Z,overlayCavityInfos:ja?[ja]:null})}kZh(V,Z,ja){var la=W.h(this.$).ha.Sa.jc;if(!la)return x.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;let ua,eb;if(({bDa:V,rotation:la,translateX:ua,translateY:eb}=la.extension.nZh(V)).returnValue){const Eb=V.x-Z.Dn.x;return Object(wa.a)(new xa,{left:(ja?Z.Dn.width-(Eb+V.width):Eb)-3+1,top:V.y-Z.Dn.y-3+1,
width:V.width+5,height:V.height+5,angle:la,translateX:ua,translateY:eb})}return null}e_h(V,Z,ja){V=this.gridView.Eb.pxb(this.gridView.ha.ra.activeRange,V)||oa.a.L3;if(!V.xe(Z.Dn))return null;const la=V.x-Z.Dn.x;return Object(wa.a)(new xa,{left:ja?Z.Dn.width-(la+V.width)-2:la-3,top:V.y-Z.Dn.y-3,width:V.width+5,height:V.height+5})}}Object(r.a)(La,"PresentModeOverlayRenderer",null,[320,3]);var va=a(63);const Ba=(V,Z,ja,la,ua,eb,Eb=null)=>{Eb=V.Oa(41,Eb);Eb.shouldEnablePresentMode=Z;return va.g(V,"SetPresentMode",
Eb,ja,la,ua,eb,0)};var Ea=a(292);class pa extends Ea.a{constructor(V,Z){super(V);this.ccj=()=>{this.vda.tWd(!0)};this.vda=Z;this.domElement.classList.add("ewr-presentMode-on");V={[pa.pt]:this.pc};this.Rb=0;this.initializeAndShow("",this.ccj,V)}get pc(){return"PresentModeWelcomeDialog"}hide(){super.hide();m.a.Bs(z.a.ccg,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(r.a)(pa,"PresentModeWelcomeDialog",Ea.a,[]);class $a{static get AOh(){return document.webkitFullscreenEnabled?
"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get BOh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(V){V.webkitRequestFullscreen?
V.webkitRequestFullscreen():V.msRequestFullscreen?V.msRequestFullscreen():V.mozRequestFullScreen?V.mozRequestFullScreen():V.requestFullscreen?V.requestFullscreen():x.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():x.ULS.sendTraceTag(7145620,
210,50,"ExitFullscreen got invoked in unknown browser")}static get Jti(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(r.a)($a,"FullscreenUtils",null,[]);class cb{constructor(V){this.mpa=this.S0e=this.kJb=this.J3a=this.Gtc=this.vda=this.FQa=null;this.mud=this.YQb=this.dQd=!1;this.mOb=!0;this.Sic=!1;this.xWd=!0;this.XQb=this.j2a=this.HHe=0;this.syc={};this.qsc={};this.psc={};this.QQf=0;this.H8a=this.pde=
!1;this.qnj=()=>{E.DOMElementExtensions.toggleCssClass(this.$.Hp,"ewr-presentMode-transition",!1);$removeHandler(this.J3a,"transitionend",this.mpa)};this.Ak=()=>{parseInt(this.$.nv.style.right,10)!==this.HHe&&window.requestAnimationFrame(()=>{this.ZEc(0);this.$.qAa(H.a.CZ("PresentModeManager.OnContentAreaResized"))})};this.x6=()=>{var Z=Object(y.a)(N.a,this.$.na);if(Z&&this.vz){this.gridView.vjc=!1;Z=Z.headersVisible;var ja=W.h(this.$).rtl;E.DOMElementExtensions.toggleCssClass(this.$.Hp,"ewr-presentMode-on-headers-off",
!Z);E.DOMElementExtensions.toggleCssClass(this.$.Hp,"ewr-presentMode-on-rtl",ja);(12!==this.j2a&&!Z||32!==this.j2a&&Z&&!ja||0!==this.j2a&&Z&&ja)&&window.requestAnimationFrame(()=>{this.ZEc(2)})}};this.od=()=>{this.nif();this.ih("OnWorkbookOpened");x.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};this.zr=()=>{this.mud=!0;this.Xea("OnSelectionStarted")};this.gh=()=>{this.mud=!1;this.Xea("OnSelectionEnded");this.L3f()};this.Di=()=>
{this.Xea("OnEditStarted")};this.dg=()=>{this.Xea("OnEditEnded")};this.Pw=()=>{if(!this.Sic){const Z=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Xea("OnVisibleAreaChanged",!0,Z)}};this.JGb=()=>{this.Sic=!0};this.Bn=()=>{this.Xea("OnCurrentSelectionModeChanged");this.L3f();this.ih("OnCurrentSelectionModeChanged")};this.Ym=()=>{this.Xea("OnBlockCacheItemEvicted")};this.rf=()=>{this.Xea("OnBlockCacheItemChanged")};this.JF=()=>{this.Sic||this.Xea("OnActiveItemPanesChanged")};
this.rj=()=>{this.Sic=!1;this.vda.ih("ActiveSheetChanged");this.x6()};this.KHb=(Z,ja)=>{if(Z=Object(y.a)(N.a,ja.item))Z.Yrb(16,!0),Z.TZa(this.x6)};this.jXi=()=>{$a.Jti||(this.Gtc&&this.Gtc.Xn&&this.Gtc.hide(),W.h(this.$).eb&&W.h(this.$).No(!0),this.$Ac(!1),x.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};this.kXi=()=>{x.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};
this.$=V;this.gridView=W.h(this.$);this.ayj=V.ya.PresentModeRenderUpdateTimeout;this.initialize(V)}get vz(){return this.pde}$Ac(V){this.vz!==V&&(this.pde=V,this.H8a=this.vz,this.nif(),this.mOb=this.Fag(),window.requestAnimationFrame(()=>{E.DOMElementExtensions.toggleCssClass(this.$.Hp,"ewr-presentMode-transition",!0);$addHandler(this.J3a,"transitionend",this.mpa);this.HOj(!V);this.E7i();E.DOMElementExtensions.toggleCssClass(this.$.Hp,"ewr-presentMode-on",V);this.GOj(V);C.b(this.$).Ubg(this.vz);C.c(this.$).Ubg(this.vz);
this.$.WAa();this.FQa.Wbg(this.mOb);if(this.vz){this.M_a();m.a.get(z.a.ccg)?this.vda.tWd(this.vz):this.Gtc=new pa(this.$,this.vda);var Z=R.a(this.$);Z&&(this.dQd=Z.tad(!1));this.QQf=O.HelperMethods.Lb()}else this.vda.tWd(V),this.dQd&&(Z=R.a(this.$))&&(Z.tad(!0),this.dQd=!1),this.G8b(),this.aIi()}))}Xbg(V,Z){this.xWd=V;this.Xea(Z)}ih(V){this.vda.ih(V)}dispose(){this.G8b();this.FQa&&(this.FQa.dispose(),this.FQa=null);this.gridView=this.$=null}HOj(V){const Z=this.$.da.Ba(25);void 0===Z||null===Z?x.ULS.sendTraceTag(537154324,
0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):V?Z.VAc():Z.lgc()}E7i(){E.DOMElementExtensions.toggleCssClass(document.getElementById(u.AFrameworkApplication.V3a),A.a.uo,this.vz);E.DOMElementExtensions.toggleCssClass(this.$.Hp,"ewr-presentMode-on",this.vz);this.JOj(this.vz);this.gridView.vjc=!this.vz;this.I6j();this.$.da.hb(32,V=>{V.e7j(this.vz)});D.b(this.$,V=>{V.vmg(this.vz)})}JOj(V){if(this.kJb)if(V){if(V=Object(y.a)(N.a,this.$.na))E.DOMElementExtensions.toggleCssClass(this.$.Hp,
"ewr-presentMode-on-headers-off",!V.headersVisible),E.DOMElementExtensions.toggleCssClass(this.$.Hp,"ewr-presentMode-on-rtl",W.h(this.$).rtl);this.ZEc(0)}else this.$.Hp.classList.remove("ewr-presentMode-on-headers-off"),this.$.Hp.classList.remove("ewr-presentMode-on-rtl"),this.ZEc(1)}ZEc(V){var Z=Object(y.a)(N.a,this.$.na);if(Z){var ja=parseInt(this.$.nv.style.right,10);if(1===V||2===V){if(isNaN(ja)||ja<this.j2a)return;ja-=this.j2a}if(0===V||2===V)V=Z.headersVisible,Z=W.h(this.$).rtl,V=V?Z?0:32:12,
ja=isNaN(ja)?V:ja+V,this.j2a=V;this.$.nv.style.right=O.HelperMethods.zc(ja);this.HHe=ja}}I6j(){const V=document.getElementById(this.$.Cb+z.a.g8b).parentNode;E.DOMElementExtensions.toggleCssClass(V,v.sBh,this.vz)}initialize(V){this.FQa=new La(V);this.FQa.cmi();this.vda=new fa(V);this.vda.sli();this.J3a=document.getElementById("MainApp");this.S0e=this.jXi;$addHandler(this.J3a,$a.AOh,this.S0e);$addHandler(this.J3a,$a.BOh,this.kXi);this.kJb||(this.kJb=document.createElement("div"),this.kJb.className=
"ewa-presentMode-right-frame",this.$.wC.appendChild(this.kJb));this.mpa=this.qnj}M_a(){this.gridView.ha.R9(this.zr);this.gridView.ha.C2(this.gh);this.gridView.oc.gl(this.Di);this.gridView.oc.rm(this.dg);this.gridView.uE(this.Bn);this.gridView.view.Vs(this.Pw);this.gridView.wYc(this.JGb);this.gridView.Ca.TG(this.Ym);this.gridView.Ca.Us(this.rf);this.$.ua.Yf(this.rj);this.$.ua.Fsa(this.JF);this.$.ua.iha(this.KHb);this.$.iC(this.Ak);this.$.hl(this.od);const V=Object(y.a)(J.a,this.$.ua);for(const Z of V.items)Z.TZa(this.x6)}G8b(){this.gridView&&
(this.gridView.ha.Tda(this.zr),this.gridView.ha.j0(this.gh),this.gridView.oc.Zk(this.Di),this.gridView.oc.dm(this.dg),this.gridView.VF(this.Bn),this.gridView.view.Xq(this.Pw),this.gridView.mNd(this.JGb),this.gridView.Ca.rI(this.Ym),this.gridView.Ca.Dr(this.rf));if(this.$){this.$.ua.yg(this.rj);this.$.ua.KAa(this.JF);this.$.ua.Gna(this.KHb);this.$.UF(this.Ak);this.$.em(this.od);const V=Object(y.a)(J.a,this.$.ua);for(const Z of V.items)Z.cwc(this.x6)}}Fag(){if(!this.vz||!this.H8a)return!1;if(1===this.gridView.ha.Oe){const V=
this.$.na.activeRange.isSingle,Z=1===this.$.na.selectedRanges.length&&!V,ja=this.gridView.eb,la=this.mud;Z||x.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${V}`);return this.xWd&&Z&&!ja&&!la}return this.xWd}GOj(V){V?$a.requestFullscreen(this.J3a):$a.exitFullscreen()}Xea(V,Z=!1,ja=!1){Z||(this.mOb=this.Fag());x.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${V}, visibility: ${this.mOb}, immediateUpdate: ${ja}`);
if(this.YQb&&ja)x.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.XQb}`),window.cancelAnimationFrame(this.XQb),this.XQb=0;else if(this.YQb){x.ULS.sendTraceTag(543023558,0,50,`PresentModeManager.UpdateLayout: Skipping update layout for ${V}`);return}ja?this.P1d(O.HelperMethods.Lb(),V):(this.XQb=window.requestAnimationFrame(la=>{this.P1d(la,V)}),this.YQb=!0)}P1d(V,Z){var ja=O.HelperMethods.Lb();if(ja-V>this.ayj)this.XQb=window.requestAnimationFrame(ua=>
{this.P1d(ua,Z)}),this.YQb=!1,x.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${ja-V}ms.`);else{this.FQa.Wbg(this.mOb);this.YQb=!1;var la=O.HelperMethods.Lb();V=O.HelperMethods.Lb()-V;ja=la-ja;this.dxj(V,Z);x.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${ja}ms. rafTotalDuration = ${V}ms`)}}nif(){S.a(this.$.userOperationManager,(V,Z,ja)=>Ba(this.$.pa.va,this.vz,V,Z,
ja,null),V=>new P.a(252,0,V),null)}L3f(){let V=G.a(this.gridView.Oe);1!==this.gridView.Oe||this.$.na.activeRange.isSingle||(V="Range");this.syc[V]=this.syc[V]?this.syc[V]+1:1}dxj(V,Z){const ja=this.qsc[Z]?this.qsc[Z]:0;this.qsc[Z]=ja>V?ja:V;this.psc[Z]=this.psc[Z]?this.psc[Z]+1:1}aIi(){const V={};var Z=O.HelperMethods.Lb()-this.QQf;V.PresentModeDuration=Z;V.SelectionCountPerObject=t.a.toJSON(this.syc);V.OverlayCountPerCaller=t.a.toJSON(this.psc);V.OverlayDurationPerCaller=t.a.toJSON(this.qsc);Z=this.vda.R8h();
for(let ja in Z)V[ja]=Z[ja];ea.b(this.$).qd(I.a.acj,V,void 0,!0)}}Object(r.a)(cb,"PresentModeManager",null,[240,3]);var ib=a(108),ta=a(153),Ya=a(54),Da=a(717);class ba extends n.a{constructor(V){super();this.$=V;this.Gb()}create(){if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService"))void(()=>Object(w.a)(this,void 0,void 0,function*(){yield(yield ta.a.resolve(Ya.l,{Wb:this.Na}))("presentMode");this.qb(Object(Da.a)(this.$.da,423,()=>new cb(this.$)))}))();else{var V=
e.GetServiceTaskFactory.Pa(this.$.da,283,284,1);f.TaskExtensions.za(V,()=>{f.TaskExtensions.za(ib.c(V.result.Ll.loadScript("presentMode")),()=>{let Z=this.$.da.Ba(423);Z||(Z=new cb(this.$),this.$.da.Ha(423,Z));this.qb(Z)},this.$.ka,3)},this.$.ka,3)}}static la(V){V.da.Ha(424,new ba(V))}}Object(r.a)(ba,"PresentModeManagerFactory",n.a,[]);a.d(B,"a",function(){return ya});const ya=()=>{c.a.Fa(V=>{ba.la(V);k.la(V)})}},1205:function(r,B,a){var c=a(9);r=a(0);var b=a(558),e=a(714),f=a(50),d=a(38),h=a(15),
l=a(1274),k=a(4),w=a(172),n=a(771),x=a(102),m=a(274),u=a(657),t=a(27),y=a(167),v=a(189),A=a(296),z=a(5),C=a(159),H=a(106),I=a(73),S=a(81),P=a(379),D=a(198),G=a(60),E=a(63),O=a(332),N=a(597),J=a(1372),W=a(426),ea=a(325),R=a(14);class Y extends J.a{constructor(Ka,Pa){super(Ka,void 0,void 0,Pa)}get ZOa(){return R.a.instance.Ua(421)}get Hmc(){return R.a.instance.Ua(422)}get Gmc(){return"DownloadOdsLink"}get mEb(){return"#"}get F9a(){return R.a.instance.Ua(423)}get dyf(){return!0}Mtf(){h.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}Otf(){h.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}Amc(){W.Redirect.showHelp(ea.a.yRi);return!0}}Object(r.a)(Y,"DownloadACopyAsOdsDialog",J.a,[]);class U{constructor(Ka,Pa){this.dialog=null;this.oEf=()=>{this.dialog&&this.dialog.hide()};this.URi=Ka;this.pb=Pa;this.pb.jpb(this.oEf)}Mxe(Ka){this.dialog=Ka}p$c(){this.URi.$Mf(-1059172980)}dispose(){this.pb.NKb(this.oEf)}}
Object(r.a)(U,"DownloadACopyAsOdsDialogDownloadBehavior",null,[170,3]);const da=(Ka,Pa,fb,Wa,Ma,lb,Na=null)=>{Na=Ka.Oa(9,Na);Na.isReadOnlyRecommended=Pa;return E.g(Ka,"SetReadOnlyRecommended",Na,fb,Wa,Ma,lb,0)},T=(Ka,Pa,fb,Wa,Ma,lb,Na=null)=>{Na=Ka.Oa(9,Na);Na.calc_type=Pa;return E.g(Ka,"SetCalculationOptions",Na,fb,Wa,Ma,lb,0)};class ka{constructor(Ka){this.calculationMode=0;this.calculationMode=Ka}}Object(r.a)(ka,"MacroRecorderWorkbookCalculationModeSetPayload",null,[123]);class L{constructor(Ka){this.calculateType=
0;this.calculateType=Ka}}Object(r.a)(L,"MacroRecorderWorkbookRecalculatedPayload",null,[123]);var fa=a(90),wa=a(156),oa=a(188),xa=a(13),bb=a(113),Za=a(1);J=a(272);class La{static get x6i(){return La.w6i}}La.w6i="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(r.a)(La,"OpenInAppDialogCopyHtml",null,[]);var va=a(163);class Ba extends J.a{constructor(Ka){super(Ka);this.$H=null;this.RGb=()=>{h.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.ya.IsMeetingLiveSession)return this.uHc(),!0;t.a.jp?(h.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.Kx&&this.Kx.length||h.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.Kx+
"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.Em+";end","_top")):9<=t.a.qod?(h.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.Ema,"_top"),window.setTimeout(()=>{this.openUrl(this.Em,"_blank")},9E3)):(h.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.Ema,
"_top"),window.setTimeout(()=>{this.openUrl(this.Em,"_blank")},500));return!0};this.EPa=Pa=>Pa.Ea.keyCode===fa.a.Sh||Pa.Ea.keyCode===fa.a.cfa?(h.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Pa.Ob.click(),!0):!1;1===k.AFrameworkApplication.sa.Qa.ri&&(this.Kx=this.$.workbookContext.ClientUrl,this.Ema="ms-excel:ofe|u|"+this.Kx,this.Em=k.AFrameworkApplication.fa.Wa("AppUrl"),t.a.c5?this.Em="itms-apps://"+k.AFrameworkApplication.fa.Wa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":
t.a.jp&&(Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&this.$.ya.IsMeetingLiveSession?(h.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.Em=k.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):t.a.dCb?this.Em=k.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<t.a.VZc.VOa&&(this.Em=k.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get pc(){return"OpenInAppDialogCopy"}openUrl(Ka,
Pa){let fb=document.getElementById("link");fb||(fb=document.createElement("a"),fb.id="link",fb.style.visibility="hidden",fb.href="",document.body.appendChild(fb));fb.target=Pa;fb.href=Ka;fb.click()}uHc(){h.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");d.TaskExtensions.za(f.GetServiceTaskFactory.Pa(this.$.da,21,137,1),Ka=>{let Pa={};Pa.OpenInAppUrl=this.Ema;Pa.StoreUrl=this.Em;Ka.result.uj("UI_OpenInMobileApp",Pa)},this.$.ka)}y6i(){h.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}tg(){this.qg=
wa.a.Iq(La.x6i,R.a.instance.ga(662),R.a.instance.ga(663),k.AFrameworkApplication.ZA,va.getImageClass(k.AFrameworkApplication.fa.Wa("AppIcon")),R.a.instance.ga(664));this.we="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.y6i.bind(this),null);this.DI(this.$H)}xy(Ka){super.xy(Ka);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.$H=document.getElementById("LinkToInstall");oa.a.instance.ta(xa.a.click,this.$H,this.RGb);bb.KeyInputManager.instance.ta(xa.a.Qd,this.$H,
this.EPa)}dispose(){this.$H&&(oa.a.instance.Aa(xa.a.click,this.$H,this.RGb),bb.KeyInputManager.instance.Aa(xa.a.Qd,this.$H,this.EPa),this.$H=null);super.dispose()}}Object(r.a)(Ba,"OpenInAppDialogCopy",J.a,[]);var Ea=a(141),pa=a(381);class $a{constructor(Ka){this.Uhi="itms-apps://";this.Vhi="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.ttg=Pa=>{1==Pa&&this.uHc()};this.$=Ka;this.Kx=k.AFrameworkApplication.sa.Qa.Kx;this.Ema="ms-excel:ofe|u|"+this.Kx;this.Em=k.AFrameworkApplication.fa.Wa("AppUrl");
t.a.c5||t.a.Pg?this.Em=this.Uhi+this.Vhi:t.a.jp&&(k.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(h.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.Em=k.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):t.a.dCb?this.Em=k.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<t.a.VZc.VOa&&(this.Em=k.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")))}uHc(){h.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
d.TaskExtensions.za(f.GetServiceTaskFactory.Pa(this.$.da,21,137,1),Ka=>{let Pa={};Pa[pa.a.fNf]=this.Ema;Pa[pa.a.Em]=this.Em;Ka.result.uj("UI_OpenInMobileApp",Pa)},this.$.ka)}tg(){h.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const Ka=new Ea.StandardDialog;Ka.Rb=0;Ka.wc(1,R.a.instance.ga(668));Ka.Zl(R.a.instance.ga(666),R.a.instance.ga(667),0,this.ttg)}}Object(r.a)($a,"OpenInAppDialogReact",null,[]);J=a(292);class cb extends J.a{constructor(Ka){super(Ka);
this.sessionId=Ka.ya.UserSessionId;this.f1g=Ka.ya.BuildVersion}get pc(){return"WACSessionIdDialog"}NM(){return{[cb.wBj]:R.a.instance.ga(669),[cb.xBj]:this.sessionId,[cb.id]:"WACSessionIdDialog",[cb.z1c]:R.a.instance.ga(670),[cb.buildVersion]:this.f1g}}tg(){const Ka=this.NM();this.Rb=5;this.initializeAndShow(R.a.instance.ga(1026),this.nak.bind(this),Ka)}nak(){h.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}cb.id="id";cb.wBj="sessionIdLabel";cb.xBj="sessionIdValue";cb.z1c=
"buildLabel";cb.buildVersion="buildVersion";Object(r.a)(cb,"WACSessionIdDialog",J.a,[]);var ib=a(28),ta=a(29),Ya=a(364),Da=a(11),ba=a(196),ya=a(290),V=a(21),Z=a(46),ja=a(259),la=a(386),ua=a(298),eb=a(6),Eb=a(152),Wb=a(997),Ab=a(85),Jb=a(37),Gb=a(311),Nb=a(262);class Ja{DQ(Ka,Pa){Ka=ta.a.hd(12,1,671,0,0,0,"Blank");Ka.Description=String.format(R.a.instance.ga(672),Pa);return Ka}wcc(Ka){switch(Ka){case 1:case 2:return 0;default:return 2}}}Object(r.a)(Ja,"ReloadCloseConfirmation",null,[108]);var ab=a(161),
wb=a(598),xb=a(74),rb=a(58),za=a(384),Aa=a(33);class pb extends v.a{constructor(Ka,Pa,fb,Wa){super();this.$=Ka;this.businessBar=Wa;this.openInExcelOperation=Pa;this.dK=fb}get Yb(){return this.$.ea.Yb}get workbookContext(){return this.$.workbookContext}get x9b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return xb.a(this.$)}get ic(){return this.$.ic}Rfi(){var Ka,Pa;return null!==(Pa=null===(Ka=this.$.workbookContext.LoadBlockingFloatingObjectsInfo)||void 0===Ka?void 0:Ka.LoadBlockType)&&
void 0!==Pa?Pa:!1}Mc(){return!1}executeCommand(Ka,Pa,fb,Wa){const Ma=this.x9b,lb=this.$,Na=Pa.command,X=this.openInExcelOperation,F=this.$.Cb,na=fb.SourceControlId;lb.Yk.gre(Na);X.Hzc(Pa.startTime.getTime().toString());Ka=null;switch(Na){case 1455037301:this.$.p5?X.RHe():X.V5c();break;case -2044628748:case 2004484710:this.$.p5?X.RHe():X.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===na?(this.OEb("CellLongPress"),h.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):
(this.OEb("PencilIcon"),h.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:h.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const hb=xb.a(this.$).kd.activityState;Z.a(lb).Br(new ja.a(eb.a.tw,5,()=>{hb[Nb.a.Fp]=eb.a.Pi}));break;case 480922297:Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",!1)&&(new cb(this.$)).tg();
break;case -2028960985:X.Ldg();break;case -1059172980:new Y(X.sAe(Na),new U(X,lb.pb));break;case -1285148982:this.clientWorkflow.kd.activityState[Jb.a.wXc]=!0;this.aEc(!1);break;case -75280711:this.aEc(!1);break;case -455164169:this.aEc(!0);break;case -1388494670:this.$.da.hb(400,Ic=>{Ic.bLi();this.aEc(!1)});break;case 810888577:k.AFrameworkApplication.Nj=(new Date).getTime();h.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${k.AFrameworkApplication.Nj}`);
break;case -1804063550:case -974518828:Pa=0;z.a.sGd in fb&&(Pa=fb[z.a.sGd]);X.$Mf(Na,Pa);break;case -1339961039:Pa=!1;fb&&z.a.RLb in fb&&(Pa=fb[z.a.RLb]);this.reloadWorkbook(!1,Pa);break;case -8805455:const Ib=this.workbookContext;if(Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&this.Rfi()&&Aa.a.Gd(this.$)){const Ic=f.GetServiceTaskFactory.Pa(this.$.da,522,523,0);d.TaskExtensions.za(Ic,()=>{Ic.result.lL()},this.$.ka,3)}else lb.isEditMode||(pb.jFe(lb),
Ka=d.TaskExtensions.za(this.dK.value,Ic=>{Ic=Ic.result;var ec=Ic.isEnabled();ec&&N.a(Ic,w.a.copyAndEdit,G.a.rg.N3e(),this.$.ea.Dg.get(2))?h.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):ec&&k.AFrameworkApplication.aog?(ec={},ec[l.a.rJd]=k.AFrameworkApplication.userSessionId,ec[k.AFrameworkApplication.uNi]=ib.a.Ya.Zb.getTime().toString(),h.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),
Ic.uj(w.a.editMode,ec)):Ma.CopyAndEditUrl?this.Ddh():(this.ic.supportsEditing||Ib.EditUrl)&&this.reloadWorkbookInEditMode()},this.ka,3));break;case -723527778:lb.isEditMode&&(pb.jFe(lb),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const vc=lb.pa.va.$b(),nc=-1355155015===Na?1:0,Pb=()=>new L(nc);Ka=P.a(this.$.userOperationManager,(Ic,ec,mb)=>E.y(lb.pa.va,nc,null,Ic,ec,mb,null,vc),Ic=>new D.a(128,0,Ic,void 0,Pb),Pa);V.h(lb).Ng.mM(!1);break;case -1158102843:Ka=V.h(lb).Ng.recalcSheet(Pa);
V.h(lb).Ng.mM(!1);break;case -988468372:if(Za.EwaSettings.xa(269))if(Wa=parseInt(fb[I.a.Pc],10),0<=Wa&&3>Wa)this.setCalculationMode(Pa,Wa);else return h.ULS.sendTraceTag(537162652,0,10,`SetCalculationMode , unexpected menuItemId: ${fb[I.a.Pc]}`),ba.a(Na);break;case 257398710:C.a.ntw(Ma.ReportAbuseUrl,lb);break;case 1800405051:this.$wj();break;case -48469327:this.saveACopy();break;case 214430355:Pa=!1;fb&&z.a.V$c in fb&&(Pa=fb[z.a.V$c]);if(!this.hLj(Pa,fb))break;k.AFrameworkApplication.h5?this.businessBar.sh(42,
null):this.businessBar.sh(Pa?22:23,null);break;case 1389557314:Ka=d.TaskExtensions.za(this.dK.value,Ic=>{N.a(Ic.result,w.a.SJh,null,this.$.ea.Dg.get(6))||C.a.ntw(Ma.FileVersionUrl,lb)},this.ka,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:na===F+z.a.Dqf?X.zDi():X.yDi();break;case 512141517:na===F+z.a.Cqf?X.HDi():X.GDi();break;case -1224038235:const oc=n.a.On in fb?!fb[n.a.On]:H.j(lb.ea.workbookContext.Options);fb[n.a.Description]=oc?R.a.instance.ga(571):R.a.instance.ga(572);
Ka=P.a(this.$.userOperationManager,(Ic,ec,mb)=>da(this.$.pa.va,!oc,Ic,ec,mb,null),Ic=>new D.a(129,0,Ic),Pa);break;case 1118926154:if(this.$.isEditMode){const Ic=new y.a;this.$.da.hb(53,ec=>{ec?(ec.yp.rDi(this.$.Cb+z.a.Ovd),Ic.setResult(!0)):h.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Ka=Ic.task}break;case -1698025133:X.openInBrowser();break;case 520859864:Ka=d.TaskExtensions.za(f.GetServiceTaskFactory.Pa(this.$.da,393,394,Wa.QM()),
Ic=>{Ic.result||h.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.ka,3);break;default:Ka=ba.a(Na)}return Ka||rb.Task.Ta(!0)}OEb(Ka){if(Da.HelperMethods.b_){const Pa=new Map;Pa.set("EntryPoint",Ka);x.Health.instance.recordKpiUsage(ua.a.v6i,0,la.a.hNi,Pa)}else h.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){k.AFrameworkApplication.isMobileMode&&
(this.$.ya.IsMeetingLiveSession&&Za.EwaSettings.isChangeGateEnabled("OfficeVSO:7492428_OpenInAppExcelReactDialogChangegate")?(h.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new $a(this.$)).tg()):Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(h.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new Ba(this.$)).tg()):
(h.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),k.AFrameworkApplication.showOpenInAppDialog()))}hLj(Ka,Pa){return k.AFrameworkApplication.isMobileMode&&!S.a(this.$.ya,29)?(this.showOpenInAppDialog(),h.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.OEb("CellDoubleTap"),h.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):k.AFrameworkApplication.Vjc&&(Ka&&Ya.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(h.ULS.sendTraceTag(537162645,0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${Ya.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):m.a.any([25,26,30,31,57,32,34],fb=>this.businessBar.qla(fb))?
(h.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):Pa&&z.a.Mdj in Pa&&!Ka?!1:!0}Ac(Ka,Pa){Ka=!1;switch(Pa.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Ka=
!0;break;case 480922297:case 520859864:Ka=Za.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 924877417:Ka=za.a.ysd?!0:!1;break;case -1285148982:case -75280711:case -455164169:Ka=Za.EwaSettings.xa(106);break;case -1388494670:Ka=Za.EwaSettings.xa(106);break;case 810888577:Ka=Za.EwaSettings.xa(243);break;case -1224038235:Ka=this.$.ea.amIAlone;break;case -988468372:Ka=Za.EwaSettings.xa(269);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Ka=
!0,h.ULS.shipAssertTag(537162642,0,this.$.nla,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Ka}Rc(){return!1}$wj(){if(this.Yb){var Ka=this.$;Z.a(Ka).Br(new ja.a(eb.a.tw,5,()=>{Ka.oI(!1,!0);const Pa=this.clientWorkflow.kd.activityState;Pa[Nb.a.Fp]=eb.a.fea;Pa[Eb.a.vT]=2;Pa[Jb.a.Rr]=Ka.isEditMode;Pa[Eb.a.Zga]=!1}))}}saveACopy(){if(this.Yb){var Ka=this.$;Z.a(Ka).Br(new ja.a(eb.a.tw,5,()=>{Ka.oI(!1,!1);const Pa=this.clientWorkflow.kd,fb=Pa.activityState;
fb[Nb.a.Fp]=eb.a.n3f;fb[wb.a.c0b]=this.ic.hasUnsupportedFeaturesForEdit;fb[Eb.a.Zga]=!1;Pa.ir(ta.a.W3(this.businessBar.mad,[-502303485]))}))}}aEc(Ka){Z.a(this.$).Br(new ja.a(eb.a.goa,2,()=>{this.$.oI(!0,!0);var Pa=xb.a(this.$).kd,fb=this.$.isEditMode;fb=ta.a.hd(1,1,0,0,0,fb?-315732528:-2087635043,fb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");fb.ForceVersionUpgrade=Ka;Pa.ir([fb]);Pa=xb.a(this.$).kd.activityState;Pa[Nb.a.Fp]=eb.a.goa;Pa[Jb.a.Rr]=this.$.isEditMode;Pa[Eb.a.Zga]=!1}))}closeWorkbook(){if(this.Yb){var Ka=
this.$;G.a.rg.kAc("2145659238")?d.TaskExtensions.za(this.dK.value,Pa=>{Pa.result.uj(w.a.YYe,{})},this.ka,3):Z.a(Ka).Br(new ja.a(eb.a.tw,5,()=>{Ka.oI(!0,!1);const Pa=this.clientWorkflow.kd.activityState;Pa[Eb.a.mY]=!1;Pa[Eb.a.Zga]=!1;this.ic.inViewerFromWebPart?(O.a.fKd(Ka,this.clientWorkflow.kd),Ka.Yk.Qy("InViewerFromWebPart"),Pa[Nb.a.Fp]=eb.a.A_):(Pa[Nb.a.Fp]=eb.a.Pj,Ka.Bd&32?Pa[Eb.a.vT]=0:(Pa[Eb.a.vT]=1,Pa[Eb.a.S_b]=new Wb.a),Pa[ab.a.Ape]=!0)}))}}Ddh(){const Ka=this.ic.vbaRemovedDuringConversion;
h.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${Ka}`);const Pa=this.$;Ka?Z.a(Pa).Br(new ja.a(eb.a.tw,5,()=>{const fb=ta.a.hd(3,0,0,1265,0,1069271157,"XLSMacroFailure");this.clientWorkflow.kd.ir([fb]);this.clientWorkflow.kd.activityState[Nb.a.Fp]=eb.a.Egb})):k.AFrameworkApplication.hideHeader?Da.HelperMethods.nf(this.x9b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):C.a.ntw(this.x9b.CopyAndEditUrl,Pa)}reloadWorkbookInEditMode(){if(this.Yb)if(G.a.rg.BV&&
G.a.rg.SLd(),k.AFrameworkApplication.Vjc&&!k.AFrameworkApplication.eca)Da.HelperMethods.nf(this.$.mrb(!0),A.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var Ka=this.$,Pa=!1,fb=this.ic.hasUnsupportedFeaturesForEdit,Wa=this.workbookContext.FileWasRepaired;Ya.d(this.workbookContext.WorkbookFileName)?(Pa=!0,h.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${fb}`)):Ya.a(this.workbookContext.WorkbookFileName)&&
(Pa=!0,h.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var Ma=Ka.ke.get(59);Ma=!(Ka.ea.ic.supportsEditing&&Ma);if(Pa&&!fb||Ma&&(Pa||fb)){let lb;lb=Ma?fb?-2066104278:816071846:Za.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&S.a(this.$.ya,25)&&!this.$.NCb?765011943:-213064907;Pa=()=>{const Na=ta.a.r0a([lb]);this.clientWorkflow.kd.ir(Na);this.clientWorkflow.kd.activityState[Nb.a.Fp]=eb.a.Egb}}else Pa=()=>
{Ka.oI(!0,!1);var lb=this.clientWorkflow.kd;const Na=lb.activityState;Na[Eb.a.vT]=1;Na[Gb.a.X_b]=u.a.uoc;Na[Jb.a.Rr]=!0;Na[wb.a.c0b]=this.ic.hasUnsupportedFeaturesForEdit;Na[Eb.a.Zga]=!!this.workbookContext.EditUrl;Na[Ab.a.p2]=this.workbookContext.EditUrl;if(!this.x9b.CopyAndEditUrl){const X=[Za.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&S.a(this.$.ya,25)&&!this.$.NCb?-943219229:1821390342];lb.ir(ta.a.W3(this.businessBar.mad,X))}Wa&&!fb?(Ya.b(this.workbookContext.WorkbookFileName)&&
Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(lb=ta.a.r0a([-425642652]),h.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):lb=ta.a.r0a([108482388]),this.clientWorkflow.kd.ir(lb),Na[Nb.a.Fp]=eb.a.B3f):this.$.ea.ndf?(h.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Na[Nb.a.Fp]=eb.a.BIb):Na[Nb.a.Fp]=this.$.ea.Hjc?eb.a.qEb:eb.a.Egb};Z.a(Ka).Br(new ja.a(eb.a.tw,
5,Pa))}}reloadWorkbookInViewMode(){if(this.Yb){G.a.rg.BV&&G.a.rg.SLd();var Ka=this.$;t.a.Pg&&V.h(Ka).Xb.textBox.blur();Z.a(Ka).Br(new ja.a(eb.a.tw,5,()=>{Ka.oI(!Ka.ea.isNamedObjectViewMode,!1);const Pa=this.clientWorkflow.kd.activityState;Pa[Nb.a.Fp]=eb.a.eia;Pa[Eb.a.vT]=1;Pa[Eb.a.mY]=!0;Pa[Jb.a.Rr]=!1;Pa[Jb.a.Iob]=!0;Pa[Gb.a.X_b]=u.a.uoc}))}}reloadWorkbook(Ka,Pa){if(this.Yb){var fb=this.$;fb.PU&65536&&Z.a(fb).Br(new ja.a(eb.a.tw,5,()=>{fb.oI(Ka,!0);const Wa=this.clientWorkflow.kd.activityState;Wa[Nb.a.Fp]=
eb.a.Zy;Wa[Jb.a.zXc]=this.workbookContext.NovMode;Pa||(Wa[Eb.a.vT]=1,Wa[Eb.a.S_b]=new Ja)}))}}setCalculationMode(Ka,Pa){h.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${Pa} `);const fb=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=Pa;const Wa=()=>new ka(Pa);return P.a(this.$.userOperationManager,(Ma,lb,Na)=>T(this.$.pa.va,Pa,ya.b(Ma,pb.p3i(this.$,fb)),ya.a(lb,pb.o3i(this.$,fb)),Na,null),Ma=>new D.a(197,0,Ma,void 0,Wa),Ka)}static jFe(Ka){Ka.pb&&
0<Ka.pb.DR&&Ka.pb.Kcd(Pa=>{Pa.lv()})}static p3i(Ka,Pa){return fb=>{ta.a.Zf(fb.Errors)&&(Ka.ea.workbookContext.CalcMode=Pa,h.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${Pa}.  Error id names: ${ta.a.qc(fb.Errors)}`))}}static o3i(Ka,Pa){return()=>{Ka.ea.workbookContext.CalcMode=Pa;h.ULS.sendTraceTag(537162627,0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${Pa})`)}}}
Object(r.a)(pb,"FileOperationsCommandHandler",v.a,[222]);var kb=a(165),Cb=a(70),ob=a(108),qa=a(153),ma=a(54);class Ga extends e.a{constructor(Ka){super(Ka)}ld(){const Ka=this.$,Pa=[],fb=f.GetServiceTaskFactory.create(Ka.da,56,this.ka,this.Na);Pa.push(fb);const Wa=Object(Cb.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(ob.c)(qa.a.resolve(ma.e,{Wb:this.Na})):f.GetServiceTaskFactory.Pa(Ka.da,5,4,this.Na);Pa.push(Wa);d.TaskExtensions.za(rb.Task.uG(...Pa),()=>{kb.b(fb)&&this.fd([new pb(Ka,
fb.result,new b.a(()=>f.GetServiceTaskFactory.create(Ka.da,137,this.ka,this.Na)),Wa.result)])},this.ka,0)}static la(Ka){e.a.Rd(94,new Ga(Ka))}}Object(r.a)(Ga,"FileOperationsCommandHandlerFactory",e.a,[]);a.d(B,"a",function(){return vb});const vb=()=>{c.a.Fa(Ga.la)}},1206:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(8),f=a(18),d=a(69),h=a(64),l=a(5),k=a(34);class w{}w.RBh="ewa-resizehdr-row-hidden";w.QBh="ewa-resizehdr-col-hidden";Object(r.a)(w,"CssClassNames",null,[]);var n=a(243),x=a(13),m=
a(166),u=a(642),t=a(27),y=a(229),v=a(4),A=a(274),z=a(15),C=a(73),H=a(132),I=a(44),S=a(24),P=a(52),D=a(12),G=a(77),E=a(1),O=a(99),N=a(11),J=a(14),W=a(260),ea=a(133),R=a(380),Y=a(46),U=a(35);class da{constructor(xb,rb,za,Aa,pb,kb,Cb){this.Jwa=xb;this.GFb=rb;this.pPa=za;this.hnd=Aa;this.Fdb=pb;this.wpf=kb;this.hfi=Cb}}Object(r.a)(da,"HeaderEventCachedInfo",null,[]);class T{constructor(xb){this.N$c=xb}iIe(xb){xb=N.HelperMethods.VHd(xb);return Math.max(0,Math.min(T.Axf,xb))}ZHe(xb){return this.p$i(xb)}e$g(xb){return Math.round(this.N$c*
xb+2*this.v4e()+1)}p$i(xb){return Math.max(0,Math.min(T.exf,(Math.max(0,Math.min(e.a.Unc,xb))-2*this.v4e()-1)/this.N$c))}v4e(){return Math.floor(Math.max((this.N$c+3)/4,2))}Wdc(xb,rb){return rb?xb?T.Axf:e.a.lAd:xb?T.exf:e.a.Unc}}T.Axf=409;T.exf=255;Object(r.a)(T,"ResizeHeadersConverter",null,[]);var ka=a(190);class L extends O.a{constructor(xb,rb){super(rb.domElement);this.RX=this.j1f=!1;this.hi=this.n9a=this.UBa=null;this.iPd=!0;this.Jkc=!1;this.sMb=this.nl=this.offset=0;this.VM=this.UR=this.Q0=
null;this.jgi="headerResizeTooltip";this.oG=this.zyd=null;this.u0c=this.TX=this.XAa=!1;this.BNf=this.Uab=e.a.gxa;this.Qif=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.URb=!1;this.nB=za=>{if(this.grid.qj)return!1;za=U.a(this.grid.$).ve(za);if(3===za.wb&&!this.xpf(za.Ea)||!this.BQf(za,!1))return!1;z.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const Aa=this.eBc();this.Ufd(za.clientPoint,Aa,!0);this.XAa||(n.a.instance.ta(x.a.mk,
this.domElement.ownerDocument.body,this.dab),m.a.instance.ta(x.a.mg,this.domElement.ownerDocument.body,this.dab),this.XAa=!0);this.llf()&&this.RX&&this.Off(za);return!1};this.XGb=za=>{za=U.a(this.grid.$).ve(za);this.llf()&&this.u0c&&this.Off(za);if(!za.Ea.type.includes("touch")&&za.Ea.button!==Sys.UI.MouseButton.leftButton||!this.HCb)return!1;G.g(za.Ea);this.GRe();za=this.grid.qj?this.Uab:e.a.gxa;var Aa=!1;if(this.grid.qj&&this.hi){var pb=za!==this.nl||!this.Qif&&this.TX;E.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&
!pb&&this.URb&&(this.je.removeRowColFromModel(this.hi.nob,this.hi.hXf),Aa=!0,E.EwaSettings.wm()&&(this.je.c8(this.grid.ha.ra.selectedRanges),this.je.an("HeaderResizeBehavior::onDocumentMouseUp")))}else this.hi&&(za=this.TX?this.zhd():this.hi.m4()),pb=za!==this.nl;this.UBa&&pb&&za!==e.a.gxa?(za=this.grid,Aa=this.Zjd(za),pb={},pb.SheetMultiRange=I.r(Aa,za.$),L.ETd(pb,this.isRow,this.nl),E.EwaSettings.rqd()&&this.grid.qj&&(Aa=pb.SheetMultiRange.Ranges[0],z.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.hi?
this.hi.nob:-1}, isResizingHiddenHeader=${this.TX}, headerViewBlockHashCode=${this.je.hashCode},
          rangeFirstRow=${Aa.FirstRow}, rangeFirstColumn=${Aa.FirstColumn}, rangeLastRow=${Aa.LastRow}, rangeLastColumn=${Aa.LastColumn},`)),this.Svh(pb),za.pVj=!0):(!E.EwaSettings.wm()&&Aa&&(E.EwaSettings.isChangeGateEnabled("OfficeVSO:7094259_fixSelectionBugAfterRehideRowCol")&&this.je.c8(this.grid.ha.ra.selectedRanges),this.je.an("HeaderResizeBehavior::onDocumentMouseUp")),this.gh(null,null),this.CKb());return this.URb=this.TX=!1};this.Tca=za=>{if(this.grid.qj)return!1;za=u.a.create(za.eventName,
za.Ob,za.Ea,za.wb);za=U.a(this.grid.$).ve(za);if(!this.BQf(za,!0))return!1;za=this.grid;var Aa=this.Zjd(za);Aa=I.r(Aa,za.$);za.Eb.Tj([this.isRow?13:14]);za.Eb.pTa();this.CKb();za.$.Yc(this.isRow?146338636:1391094586,C.a.zb,30,{["autoFitRanges"]:Aa});return!1};this.xGf=za=>{this.RX?(this.TX&&!this.URb&&(this.lMg(),E.EwaSettings.wm()&&this.je.an("HeaderResizeBehavior::onHeaderResizeChanged")),this.Jkc||this.Zgf(),za=new Sys.UI.DomEvent(za),za=u.a.create(x.a.Gha,this.domElement,za,2),za=U.a(this.grid.$).ve(za),
this.LEd(za.clientPoint)):z.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.hi?this.hi.nob:-1}, isRow = ${this.isRow}`)};this.yGf=za=>{za=new Sys.UI.DomEvent(za);za=u.a.create(x.a.Gha,this.domElement,za,2);this.XGb(za)};this.nZi=za=>{this.uza(za,this.hi,!1)};this.dab=za=>{za=U.a(this.grid.$).ve(za);G.g(za.Ea);return this.LEd(za.clientPoint)};this.kI=za=>{if(this.grid.qj)return!1;za=U.a(this.grid.$).ve(za);let Aa;
if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ha.selectionType)return Y.a(this.grid.$).Tp()&&(Aa=this.xid(za))&&(Aa.Jwa.style.cursor=""),!1;if(this.RX)return this.Zgf(),!1;Aa=this.xid(za);if(!Aa)return!1;Aa.Jwa.style.cursor=!this.grid.eb&&this.Bvd(Aa)?this.isRow?"row-resize":"col-resize":"";G.g(za.Ea);return!0};this.zr=()=>{this.CKb()};this.gh=()=>{if((3===C.a.zb||t.a.lp)&&this.grid.ha.ra.eh){var za=this.grid.ha.ra.xd;if(!(!za.isRow&&!za.Fg||!this.domElement||za.isRow&&this.isRow&&!this.je.zt.includes(za.top)||
za.Fg&&!this.isRow&&!this.je.zt.includes(za.left))){var Aa=this.grid.Eg(za,this.je.jj.paneType);if(Aa){if(this.grid.qj){const pb=this.isRow?za.bottom:za.right;this.hi=this.je.es(S.Range.Hc(za.bottom,za.right));if(!this.hi){z.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${pb}, is row ${this.isRow}`);return}}this.oG||this.clh();za.isRow&&this.isRow?(D.DOMElementExtensions.setVisible(this.oG,!0),
this.oG.style.top=Aa.bottomRight.y-this.oG.offsetHeight/2+"px"):za.isRow||this.isRow||(D.DOMElementExtensions.setVisible(this.oG,!0),W.c(this.oG.style,this.grid.rtl,Aa.bottomRight.x-this.oG.offsetWidth/2+"px"))}}}};this.LF=(za,Aa)=>{E.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&z.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Aa.TL}`);Aa.TL&&this.Qrb()};this.je=rb;this.isRow=
rb.isRow;this.rtl=rb.jj.rtl;this.grid=xb;this.hxf=this.isRow?e.a.lAd:e.a.Unc;this.egi=J.a.instance.ga(436);this.ngi=J.a.instance.ga(435);this.hgi=J.a.instance.ga(437);ea.a(this.grid.$,za=>{this.zyd=za.cQ(H.a.Wtj,!1)});this.fkj();this.grid.ha.HT(this.gh);this.grid.ha.R9(this.zr);this.grid.ev(this.gh);Y.a(this.grid.$).Wf.Q9(this.LF)}get HCb(){return this.RX}get Ytj(){this.Cwh();return L.Gdb}uza(xb,rb,za){var Aa=new Sys.UI.DomEvent(xb);Aa=u.a.create(x.a.Gha,this.domElement,Aa,2);Aa=U.a(this.grid.$).ve(Aa);
this.AQf(rb,Aa.clientPoint.x,Aa.clientPoint.y,!1,za,xb);xb=this.eBc();this.Ufd(this.UBa,xb,!0);this.XAa||(xb=this.domElement.ownerDocument.body,xb.addEventListener(x.a.Gha,this.xGf),xb.addEventListener(x.a.KHa,this.yGf),this.XAa=!0)}lZi(xb,rb,za){this.AQf(rb,xb.clientX,xb.clientY,!0,this.Qif?za:!1,xb);xb=this.grid;rb=this.Zjd(xb);rb=I.r(rb,xb.$);xb.Eb.Tj([this.isRow?13:14]);xb.Eb.pTa();this.CKb();xb.$.Yc(this.isRow?146338636:1391094586,C.a.zb,30,{["autoFitRanges"]:rb})}dispose(){this.V3c();this.grid.ha&&
(this.grid.ha.PR(this.gh),this.grid.ha.Tda(this.zr));this.grid.ty(this.gh);Y.a(this.grid.$)&&Y.a(this.grid.$).Wf.Rda(this.LF);y.a.instance.Aa(x.a.yk,this.domElement,this.Tca);n.a.instance.Aa(x.a.Of,this.domElement.ownerDocument.body,this.XGb);m.a.instance.Aa(x.a.Ae,this.domElement.ownerDocument.body,this.XGb);t.a.lp||(n.a.instance.Aa(x.a.pointerDown,this.domElement,this.nB),n.a.instance.Aa(x.a.mk,this.domElement,this.kI));this.XAa&&(n.a.instance.Aa(x.a.mk,this.domElement.ownerDocument.body,this.dab),
m.a.instance.Aa(x.a.mg,this.domElement.ownerDocument.body,this.dab),this.XAa=!1);this.oG&&(n.a.instance.Aa(x.a.pointerDown,this.oG,this.nB),y.a.instance.Aa(x.a.yk,this.oG,this.Tca),this.V3c(),this.oG=null);this.j1f&&(D.DOMElementExtensions.yf(L.Gdb),L.Gdb=null);this.je=null;super.dispose()}fkj(){y.a.instance.ta(x.a.yk,this.domElement,this.Tca);n.a.instance.ta(x.a.Of,this.domElement.ownerDocument.body,this.XGb);m.a.instance.ta(x.a.Ae,this.domElement.ownerDocument.body,this.XGb);t.a.lp||(n.a.instance.ta(x.a.pointerDown,
this.domElement,this.nB),n.a.instance.ta(x.a.mk,this.domElement,this.kI))}Cwh(){if(!L.Gdb){document.getElementById(L.i1f);this.j1f=!0;var xb=L.Gdb=document.createElement("div");this.grid.$.frame.iba().appendChild(xb);xb.id=L.i1f;xb.className=k.a.SBh;D.DOMElementExtensions.setVisible(xb,!1)}}GRe(){if(this.XAa){const xb=this.domElement.ownerDocument.body;this.grid.qj?(xb.removeEventListener(x.a.Gha,this.xGf),xb.removeEventListener(x.a.KHa,this.yGf)):(n.a.instance.Aa(x.a.mk,xb,this.dab),m.a.instance.Aa(x.a.mg,
xb,this.dab));this.XAa=!1}this.RX=!1;E.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.eYf():(this.Q1f(),this.fNd());R.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}Q1f(){this.grid.Eb.Tj([this.isRow?13:14]);this.grid.Eb.pTa()}lMg(){this.je.addRowColToModel(this.hi.nob-1,this.hi.hXf);this.URb=!0}LEd(xb){if(!this.RX)return!1;const rb=this.isRow;if(!this.grid.qj&&!this.Q0){this.Q0=document.createElement("div");this.Q0.style.cssText="position: relative; width: inherit; height: inherit;"+
(rb?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var za=this.hi.cK();za.nextSibling;)this.Q0.appendChild(za.nextSibling);za.parentNode.appendChild(this.Q0)}za=rb?xb.y-this.n9a.y:(this.rtl?-1:1)*(xb.x-this.n9a.x);const Aa=rb?xb.y-this.UBa.y:(this.rtl?-1:1)*(xb.x-this.UBa.x),pb=this.grid.qj?this.Uab:this.hi.m4();if(pb===e.a.gxa)return!1;za&&(0<this.nl||0<pb+Aa)&&pb+Aa<=this.hxf&&(this.nl=this.eBc(Aa),this.Ufd(xb,this.nl,!1),this.grid.qj?this.nl>=L.Kdf?(this.iPd=!0,this.hi.setCellExtent(this.nl)):
this.iPd&&(this.iPd=!1,this.hi.setCellExtent(L.Kdf)):(D.DOMElementExtensions.wpa(this.hi.cK(),!rb,Math.max(this.sMb+Aa,0)),this.Q0.style[rb?"top":this.rtl?"right":"left"]=Math.max(Aa,-this.sMb)+"px"),za=(this.grid.qj?this.BNf:rb?this.hi.je.lC:this.hi.je.nC)+Math.max(Aa,this.grid.qj?-this.Uab+L.jfc:-this.sMb),D.DOMElementExtensions.wpa(this.hi.je.domElement,!rb,za),this.grid.qj&&this.hi.je.cCj(za),this.n9a=new Sys.UI.Point(xb.x,xb.y),D.DOMElementExtensions.setVisible(this.oG,!1));return!0}m4(){return this.hi?
this.TX?L.ugi:this.hi.m4():e.a.gxa}Ufd(xb,rb,za){this.VM&&za&&(z.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.fNd());this.VM||za||z.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.zyd&&this.zyd(()=>({["Location"]:"canvas"}));this.VM?this.L1e(rb):(this.VM=document.createElement("div"),
this.VM.id=this.jgi,this.L1e(rb),this.VM.className=k.a.uAh,rb=document.getElementById(this.grid.$.Cb+l.a.Vyf),rb.insertBefore(this.VM,rb.firstChild),xb=U.a(this.grid.$).ska(xb),this.VM.style.left=(this.rtl?Math.max(xb.x-this.VM.offsetWidth,0):xb.x-Math.max(xb.x+this.VM.offsetWidth-rb.offsetWidth,0)).toString()+"px",rb=document.getElementById(l.a.Vsa),this.VM.style.top=(xb.y-(v.AFrameworkApplication.sa&&v.AFrameworkApplication.sa.Qa.kf?0:rb.offsetHeight)-this.VM.offsetHeight).toString()+"px")}fNd(){D.DOMElementExtensions.yf(this.VM);
this.VM=null}L1e(xb){var rb=new T(this.grid.$.workbookContext.DxDigitNormal);rb=this.isRow?rb.iIe(xb).toFixed(2):rb.ZHe(xb).toFixed(2);this.VM.innerText=`${this.isRow?this.egi:this.ngi} ${rb} (${xb.toString()} ${this.hgi})`}BQf(xb,rb){let za;const Aa=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ha.selectionType||2===xb.wb&&xb.Ea.button!==Sys.UI.MouseButton.leftButton||!this.Bvd(za=this.xid(xb))||!Aa)return!1;G.g(xb.Ea);this.UBa=this.n9a=new Sys.UI.Point(xb.clientPoint.x,xb.clientPoint.y);
this.h3g(za,rb);if(!this.hi)return!1;this.RX=!0;this.Gxi(this.hi,za)&&this.jki();this.sMb=this.zhd();return this.CQf(xb.Ea.rawEvent,rb)}AQf(xb,rb,za,Aa,pb,kb){this.RX=!0;this.TX=pb;this.hi=xb;this.Jkc=!1;this.UBa=this.n9a=new Sys.UI.Point(rb,za);xb=this.hi.getRange();this.UR=pb?this.hue(xb):xb;this.Uab=this.m4();this.BNf=this.isRow?this.hi.je.lC:this.hi.je.nC;this.CQf(kb,Aa)}CQf(xb,rb){const za=E.EwaSettings.rqd()&&this.grid.qj?{["IsResizingHiddenHeader"]:this.TX,["IsAutoFitting"]:rb,["NumberOfSelectedRanges"]:this.grid.ha.ra.nD,
["Location"]:"canvas",["ResizeRange"]:this.UR,["ResizedCellAbsoluteIndex"]:this.hi.nob,["HeaderViewBlockHashCode"]:this.je.hashCode}:{["IsResizingHiddenHeader"]:this.TX,["IsAutoFitting"]:rb,["NumberOfSelectedRanges"]:this.grid.ha.ra.nD,["Location"]:"canvas"};ea.b(this.grid.$).qd(H.a.Ntj,za);this.grid.uMj&&(rb=rb?"header_resize_autofit":"header_resize_start",ka.b(this.grid.$).ACa(xb,rb,void 0));this.offset=this.hi.rba();this.nl=this.grid.qj?this.Uab:this.hi.m4();if(this.nl===e.a.gxa)return!1;R.c(this.grid.$,
!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Gxi(xb,rb){var za=this.hi.cK();if(!za)return z.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;za=za.nextSibling;if(!za)return!1;xb=xb.getRange();za=this.je.Kva(za).getRange();if(!xb||!za)return z.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;xb=this.isRow?xb.bottom:xb.right;za=this.isRow?za.bottom:za.right;return xb+1!==za&&xb!==za&&this.Bvd(rb,!0)}jki(){var xb=this.hi.cK();
const rb=this.je.Kva(xb.nextSibling);L.Hxi(rb,this.isRow)?(this.hi=rb,this.UR=this.hi.getRange()):(this.mMg(xb),this.hi=rb,xb=this.hi.getRange(),this.UR=this.hue(xb),this.TX=!0)}hue(xb){return this.isRow?new S.Range(xb.top-1,xb.left,xb.top-1,xb.right,!1,!0):new S.Range(xb.top,xb.left-1,xb.bottom,xb.left-1,!1,!0)}mMg(xb){const rb=this.je.Kva(xb.nextSibling),za=L.ehh(rb,this.isRow,this.rtl);za&&xb.parentNode.insertBefore(za,rb.cK())}Zjd(xb){const rb=this.UR,za=xb.ha.ra.selectedRanges;if(xb.ha.ra.Sub(rb))if(this.isRow){if(A.a.all(za,
Aa=>Aa.isRow))return za}else if(A.a.all(za,Aa=>Aa.Fg))return za;return[rb]}getCellExtent(){return this.hi.getCellExtent()}zhd(){const xb=this.hi.cK().style;return Math.max(0,Math.min(this.hxf,0|parseInt(this.isRow?xb.height:xb.width,10)))}eBc(xb=0){const rb=this.grid;var za=this.je.jj.paneType;let Aa;Aa=this.isRow?3===za?[3,2]:[1,4]:4===za?[2,4]:[1,3];var pb=Math.max(this.grid.qj?this.Uab:this.hi.m4(),0);xb=this.TX&&!this.grid.qj?Math.max(this.zhd(),0):Math.max(pb+xb,0);za=rb.y1h(za,this.isRow);za=
this.isRow?new h.a(0,this.offset,za,xb):new h.a(this.offset,0,xb,za);pb=[this.isRow?13:14];rb.Eb.Bk(new S.Range(1,1,e.a.xg,e.a.wg,!1,!0),pb,!1);rb.Eb.$q(pb,za,Aa);return xb}V3c(){this.UR=this.UBa=this.n9a=null;if(this.Q0){const xb=this.Q0.parentNode;if(xb)for(xb.removeChild(this.Q0);this.Q0.firstChild;)xb.appendChild(this.Q0.firstChild);this.Q0=null}this.hi=null;this.RX=!1;E.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.eYf()}eYf(){this.Jkc=!1;this.fNd();D.DOMElementExtensions.setVisible(L.Gdb,
!1);D.DOMElementExtensions.setVisible(this.oG,!1);E.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.Q1f()}xid(xb){if(D.DOMElementExtensions.qz(xb.Ob,"a"))return null;const rb=this.xpf(xb.Ea);if(rb&&this.grid.ha.ra.eh){var za=this.grid.ha.ra.xd;za=this.je.es(S.Range.Hc(za.bottom,za.right))}else za=this.je.Kva(xb.Ob);if(!za)return null;const Aa=za.cK(),pb=new Sys.UI.Bounds(Aa.offsetLeft,Aa.offsetTop,Aa.offsetWidth,Aa.offsetHeight);var kb=D.DOMElementExtensions.getBoundingClientRect(xb.Ob);
kb=new Sys.UI.Point(xb.clientPoint.x-kb.x,xb.clientPoint.y-kb.y);this.isRow&&!rb&&(kb.y+=N.HelperMethods.XC(xb.Ob,Aa,this.rtl).y);return new da(Aa,kb,pb,za.getRange(),Math.max(L.dNi,Math.min(L.ZLi,(this.isRow?pb.height:pb.width)*L.Xtj)),rb,!this.isRow&&0<Aa.getElementsByTagName("input").length)}Bvd(xb,rb=!1){if(!xb||this.grid.eb)return!1;if(xb.wpf)return!0;var za=xb.pPa;const Aa=xb.Fdb;var pb=this.je.jj.paneType,kb=this.grid.Vf(pb).pi,Cb=!!kb&&kb.top===xb.hnd.top,ob=!!kb&&kb.left===xb.hnd.left;pb=
!!kb&&kb.bottom===xb.hnd.bottom&&(3===pb||2===pb);this.isRow?(ob=xb.GFb.y,xb=ob<=Aa&&!Cb,za=ob>=za.height-Aa-(pb?L.sOh:0),rb=rb?xb:za||xb):(pb=xb.hfi,Cb=this.rtl,kb=xb.GFb.x,xb=kb<=Aa&&(!ob||Cb)&&(!pb||!Cb),za=kb>=za.width-Aa&&(!Cb||!ob)&&(!pb||Cb),rb=rb?Cb?za:xb:xb||za);return rb}h3g(xb,rb){const za=this.isRow;if(xb.wpf)this.hi=this.je.Kva(xb.Jwa);else if(za&&xb.GFb.y<=xb.Fdb&&xb.pPa.height>xb.Fdb||!za&&xb.pPa.width>xb.Fdb&&(!this.rtl&&xb.GFb.x<=xb.Fdb||this.rtl&&xb.GFb.x>=xb.pPa.width-xb.Fdb)){if(this.hi=
xb.Jwa.previousSibling?this.je.Kva(xb.Jwa.previousSibling):this.M0h(),rb&&xb.Jwa.classList.contains(za?k.a.uXe:k.a.tXe)&&(xb=this.je.Kva(xb.Jwa)))xb=xb.getRange(),this.UR=za?new S.Range(xb.top-1,xb.left,xb.top-1,xb.right,!1,!0):new S.Range(xb.top,xb.left-1,xb.bottom,xb.left-1,!1,!0)}else this.hi=this.je.Kva(xb.Jwa);!this.UR&&this.hi&&(this.UR=this.hi.getRange())}M0h(){var xb=this.isRow?1:0;return(xb=this.je.jj.NB(this.je.jj.Ca.Mg(this.grid.$.na,d.a.HJ(this.je.position.X+xb-1,this.je.position.Y-xb,
this.je.position.PaneType))))?xb.L0h():null}Zgf(){this.Jkc=!0;const xb=this.Ytj;D.DOMElementExtensions.setVisible(xb,!0);xb.style.cursor=this.isRow?k.a.HUe:k.a.tTe;this.eBc()}Svh(xb){this.grid.$.Yc(this.isRow?745189930:-445963340,C.a.zb,30,{["resizeRowColumnParameters"]:xb})}clh(){const xb=document.createElement("div");xb.className=k.a.SCh;const rb=document.createElement("div");rb.className=f.a.kv;xb.appendChild(rb);const za=document.createElement("img");za.src=P.a.Le(0);za.className=this.isRow?f.a.PBh:
f.a.KBh;rb.appendChild(za);this.je.zA.domElement.parentNode.insertBefore(xb,this.je.zA.domElement);this.grid.qj?xb.addEventListener(x.a.u$,this.nZi):(n.a.instance.ta(x.a.pointerDown,xb,this.nB),y.a.instance.ta(x.a.yk,xb,this.Tca));D.DOMElementExtensions.setVisible(xb,!1);this.oG=xb}CKb(){this.V3c();this.oG&&(this.je.zA.domElement.parentNode.removeChild(this.oG),this.oG=null)}xpf(xb){return D.DOMElementExtensions.Df(this.oG,xb.target)}Qrb(){this.RX&&(E.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&
this.grid.qj&&this.LEd(this.UBa),this.GRe(),this.grid.qj||D.DOMElementExtensions.wpa(this.hi.cK(),!this.isRow,this.sMb),this.CKb(),this.URb=this.TX=!1)}llf(){return E.EwaSettings.xa(587)}Off(xb){(xb=xb.Ea.rawEvent)&&xb.detail===L.Pyj&&(xb.type===x.a.rp?(this.RX=!1,this.u0c=!0):xb.type===x.a.fI&&(this.RX=!0,this.u0c=!1))}static bhh(xb,rb){return new L(xb,rb)}static ETd(xb,rb,za){if(rb){xb.ColumnWidth=-1;xb.RowHeight=za;for(const Aa of xb.SheetMultiRange.Ranges)Aa.FirstColumn=0,Aa.LastColumn=0}else{xb.RowHeight=
-1;xb.ColumnWidth=za;for(const Aa of xb.SheetMultiRange.Ranges)Aa.FirstRow=0,Aa.LastRow=0}}static Hxi(xb,rb){if(!xb||!xb.cK())return z.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const za=xb.getRange();xb=xb.cK().style;if(!za||!xb)return z.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;xb=rb?xb.height:xb.width;return(rb?za.top:za.left)===(rb?e.a.xg:e.a.wg)&&xb===L.Pqg}static ehh(xb,rb,za){if(!xb)return z.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),
null;var Aa=xb.cK();if(!Aa||!Aa.style)return z.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;xb=document.createElement("div");const pb=Aa.style;xb.style.top=rb?pb.top:L.Pqg;rb||(za?xb.style.right=pb.right:xb.style.left=pb.left);xb.classList.add(rb?w.RBh:w.QBh);xb.classList.add(rb?k.a.Svb:k.a.Rvb);za=document.createElement("div");za.classList.add(rb?k.a.kXe:k.a.ucd);Aa=rb?Number.parseInvariant(Aa.innerText):S.Range.t1a(Aa.innerText);za.innerText=rb?(Aa-1).toString():
S.Range.sM(Aa-1);xb.appendChild(za);return xb}}L.dNi=0;L.ZLi=5;L.jfc=1;L.Kdf=1;L.ugi=0;L.sOh=3;L.Xtj=.1;L.i1f="ewa-rszrbg";L.Pqg="0px";L.Pyj=2;L.Gdb=null;Object(r.a)(L,"HeaderResizeBehavior",O.a,[424]);class fa extends b.a{constructor(){super();this.Gb()}create(){this.qb(L.bhh)}static la(xb){xb.da.Ha(136,new fa)}}Object(r.a)(fa,"HeaderResizeBehaviorFactory",b.a,[]);var wa=a(58),oa=a(714),xa=a(50),bb=a(38),Za=a(178),La=a(429),va=a(379),Ba=a(198),Ea=a(151),pa=a(255),$a=a(290),cb=a(68),ib=a(21);class ta{constructor(xb,
rb){this.isRow=!1;this.autoFitRange=null;this.isRow=xb;this.autoFitRange=rb}}Object(r.a)(ta,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[123]);class Ya{constructor(xb){this.resizeParameters=null;this.resizeParameters=xb}}Object(r.a)(Ya,"MacroRecorderSheetRowsColumnsResizedPayload",null,[123]);var Da=a(87);b=a(292);var ba=a(22),ya=a(62);class V extends b.a{constructor(xb,rb){super(xb);this.eyb=za=>{za=this.Nid(za);return this.Mfd(za)};this.Otj=(za,Aa)=>{var pb=this.K8a=Aa[V.esi];1===za?(za=
Aa[V.ZPj],pb=this.R$e(za,pb),z.ULS.shipAssertTag(537153996,0,pb!==V.Pba,`ResizeHeadersDialogHandler - invalid size input, size = ${za}`),za=pb!==this.lpd,z.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.K8a,pb,za),za&&this.Deh(pb)):z.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===rb.command;this.gridView=ib.h(this.$);
this.Swc=new T(this.$.workbookContext.DxDigitNormal);this.lpd=this.J3g();xb=this.jdh(this.lpd);rb=this.ldh(this.lpd);this.ll=J.a.instance.ga(this.isRow?478:479);xb=this.NM(xb,rb);this.initializeAndShow(this.ll,this.Otj,xb);z.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get pc(){return"ResizeHeadersDialog"}get K8a(){return V.Fde}set K8a(xb){V.Fde=xb}NM(xb,rb){return{[V.oV]:this.pc,[V.Vxi]:this.isRow,[V.Jki]:xb,[V.Iki]:rb,[V.Bui]:this.K8a,[V.Mid]:this.eyb}}J3g(){const xb=
this.KRh();try{return this.wWh(xb)}finally{xb&&xb.dispose()}}Deh(xb){const rb={};rb.SheetMultiRange=I.r(this.gridView.ha.ra.selectedRanges,this.$);V.ETd(rb,this.isRow,xb);this.$.Yc(this.isRow?745189930:-445963340,C.a.zb,8,{["resizeRowColumnParameters"]:rb})}R$e(xb,rb){return ba.a.k5(xb)?rb?this.idh(xb):this.kdh(xb):V.Pba}kdh(xb){return Math.floor(parseFloat(xb))}idh(xb){xb=parseFloat(xb);return 0>xb?V.Pba:xb?this.isRow?N.HelperMethods.x$i(xb):this.Swc.e$g(xb):0}ldh(xb){return xb===V.Pba?"":this.isRow?
this.Swc.iIe(xb).toString():this.Swc.ZHe(xb).toFixed(2)}jdh(xb){return xb===V.Pba?"":xb.toString()}wWh(xb){if(!xb||!xb.$$mn()||!xb.Qm)return V.Pba;var rb=Object(Da.a)(438,xb.Qm);if(!rb)return V.Pba;for(rb=this.isRow?rb.FAb:rb.jpd;xb.$$mn();){const za=Object(Da.a)(438,xb.Qm);if(za&&(this.isRow?za.FAb:za.jpd)!==rb)return V.Pba}return rb}KRh(){const xb=[];for(const za of this.gridView.ha.ra.selectedRanges){const Aa=za.clone();var rb=this.gridView.Vf(this.gridView.jb.Li(Aa));rb=Aa.xe(rb.pi);if(!rb)return null;
this.isRow?Aa.right=Aa.left=rb.left:Aa.top=Aa.bottom=rb.top;xb.push(Aa)}return xb.length?this.gridView.iaa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",xb):null}Nid(xb){if(!ba.a.k5(xb))return 1;xb=this.R$e(xb,this.K8a);if(0===xb)if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){const rb=this.gridView.ha.ra.selectedRanges,za=this.gridView.gk("ResizeHeaderDialog");if(Object(ya.c)(za)){if(!za.value.IBe(rb,this.isRow))return 3}else if(this.Tnf())return 3}else if(this.Tnf())return 3;
return this.QAi(xb)?0:2}Tnf(){const xb=this.gridView.ha.ra.selectedRanges;return this.isRow&&I.Q(xb)||!this.isRow&&I.P(xb)}Mfd(xb){let rb="";switch(xb){case 0:rb="";break;case 1:rb=J.a.instance.ga(767);break;case 2:xb=this.K8a;rb=String.format(J.a.instance.nb(99),0,this.Wdc(xb));break;case 3:rb=J.a.instance.ga(768)}return rb}QAi(xb){return 0<=xb&&xb<=this.Wdc(!1)}Wdc(xb){return this.Swc.Wdc(xb,this.isRow)}static ETd(xb,rb,za){if(rb){xb.ColumnWidth=V.Pba;xb.RowHeight=za;for(const Aa of xb.SheetMultiRange.Ranges)Aa.FirstColumn=
0,Aa.LastColumn=0}else{xb.RowHeight=V.Pba;xb.ColumnWidth=za;for(const Aa of xb.SheetMultiRange.Ranges)Aa.FirstRow=0,Aa.LastRow=0}}}V.oV="id";V.Vxi="isRow";V.Jki="initialSizeInPx";V.Iki="initialSizeInDefaultUnits";V.Bui="isInitialUnitsDefaultUnits";V.Mid="getInputErrorIfInvalid";V.ZPj="size";V.esi="isDefaultUnits";V.Pba=-1;V.Fde=!0;Object(r.a)(V,"ResizeHeadersDialog",b.a,[]);var Z=a(63);const ja=(xb,rb,za,Aa,pb,kb,Cb=null)=>{Cb=xb.Oa(41,Cb);Cb.resizeRowColumnParameters=rb;return Z.g(xb,"ResizeRowsColumns",
Cb,za,Aa,pb,kb,0)};var la=a(350),ua=a(294),eb=a(71),Eb=a(180),Wb=a(29),Ab=a(352);class Jb{constructor(xb,rb,za){this.j2i=(Aa,pb)=>{if(!pa.a(Aa)&&pb){const kb=!!Aa&&!!Aa.RequestTelemetryData;ib.h(this.$).Dh.kma(pb,Aa.StateId,kb?Aa.RequestTelemetryData.EcsOperationDuration:0,kb?Aa.RequestTelemetryData.EcsRequestDuration:0,kb?Aa.RequestTelemetryData.WfeRequestDuration:0)}};this.xUi=(Aa,pb)=>{pb&&pb.E2b&&pb.E2b.SheetName&&pb.E2b.Ranges.length&&pb.qri&&(E.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")&&
v.AFrameworkApplication.Qq("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(this.MYd=pb.E2b.Ranges[0],this.b5()?this.dGe(this.MYd):this.grid.mpb(this.iHb)))};this.iHb=()=>{this.b5()&&(this.grid.QKb(this.iHb),this.dGe(this.MYd))};this.$=xb;this.Zg=rb;this.gridInstantaneousAction=za;this.grid=ib.h(this.$);this.MYd=null}Mc(xb,
rb){xb=!0;switch(rb){case -445963340:case 1391094586:xb=this.Td(8);break;case 745189930:case 146338636:xb=this.Td(16)}return!xb}executeCommand(xb,rb,za){var Aa=ib.h(this.$);const pb=rb.command;var kb=Za.a.create().toString();let Cb=bb.TaskExtensions.Yj();switch(pb){case 1391094586:case 146338636:xb=1391094586===pb;(kb=za.autoFitRanges)&&kb.Ranges&&kb.Ranges.length||(kb=I.r(Aa.ha.ra.selectedRanges,this.$));Cb=this.Rrh(xb?1:0,kb,rb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:xb=
-445963340===pb||-706918724===pb||369708605===pb;E.EwaSettings.oNa()&&-706918724===pb&&Aa.Dh.M0(18,kb);if(-445963340===pb||745189930===pb){var ob=La.a(rb.command);Aa.Dh.M0(16,kb,ob);Aa=za.resizeRowColumnParameters}else{za=Aa.ha.ra.selectedRanges;let ma=0;for(var qa of za)if(-706918724===pb||369708605===pb){const Ga=qa.right-qa.left+1;ma+=0<Ga?Ga:-1*Ga}else if(1542466017===pb||1051390410===pb)ma+=qa.bottom-qa.top+1;369708605===pb||1542466017===pb?z.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${ma}`):
(-706918724===pb||1051390410===pb)&&z.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${ma}`);if(!E.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")||!Object(ya.c)(Aa.gk("ResizeCmdHandler"))){if(-706918724===pb&&6===rb.Ve&&I.P(za)){z.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===pb&&6===rb.Ve&&I.Q(za)){z.ULS.sendTraceTag(537154006,
0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}qa=369708605===pb||1542466017===pb?-2:0;Aa={};Aa.SheetMultiRange=I.r(za,this.$);if(xb)for(ob of Aa.SheetMultiRange.Ranges)ob.FirstRow=0,ob.LastRow=0;else for(const Ga of Aa.SheetMultiRange.Ranges)Ga.FirstColumn=0,Ga.LastColumn=0;Aa.RowHeight=xb?-1:qa;Aa.ColumnWidth=xb?qa:-1}Cb=this.lsh(Aa,rb,kb,xb);break;case 957527587:case 2040891415:new V(this.$,rb)}return Cb}dGe(xb){if(E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)){const rb=eb.d(this.$.ua.na),za=new la.a(I.C(xb),rb);bb.TaskExtensions.za(xa.GetServiceTaskFactory.Pa(this.$.da,426,427,1),Aa=>{void Aa.result.$Dc(za,"ColumnAutoFit")},this.$.ka,3)}}Ac(xb,rb,za,Aa){if(xb=!!za&&!!Aa&&1===Aa.jw)switch(rb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:xb=!1}return xb}Rc(){return!1}lHi(xb){z.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(ua.c)(xb)}. Reason: ${Object(ua.c)(xb)?
void 0:xb.reason}.`)}Td(xb){return(new Ea.a(this.$.ua)).Td(xb)}b5(){return this.grid.Ca.hN(4,this.$.na)}Rrh(xb,rb,za){const Aa=this.$.pa.va.$b(),pb=0===xb,kb=()=>new ta(pb,rb);return va.a(this.$.userOperationManager,(Cb,ob,qa)=>{var ma=this.$.pa.va;Cb=$a.b(Cb,this.xUi);var Ga={qri:!pb,E2b:rb};const vb=ma.Oa(41,Aa);vb.isRow=pb;vb.autoFitRanges=rb;return Z.g(ma,"AutoFit",vb,Cb,ob,qa,Ga,0)},Cb=>new Ba.a(135,0,Cb,void 0,kb),za,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",
!1))}lsh(xb,rb,za,Aa){const pb=rb.command,kb=ib.h(this.$),Cb=I.g(xb.SheetMultiRange.Ranges);if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var ob=1051390410===pb||745189930===pb&&0===xb.RowHeight;const vb=-706918724===pb||-445963340===pb&&0===xb.ColumnWidth,Ka=kb.gk("ResizeCmdHandler");if((ob||vb)&&Object(ya.c)(Ka)&&!Ka.value.IBe(Cb,!Aa))return this.arh(Aa),bb.TaskExtensions.Yj()}let qa;ob=E.EwaSettings.oNa()&&-706918724===pb;if(745189930===pb||-445963340===pb||ob)z.ULS.shipAssertTag(537154002,
0,this.$.activeItemName===xb.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),ob?(this.gridInstantaneousAction.Nij(),Object(Eb.c)(()=>{kb.Dh.cLi();this.gridInstantaneousAction.NXg(pb)},this.$.ka,0)):(qa=this.Zg.lWd(kb,Cb,Aa?xb.ColumnWidth:xb.RowHeight,!Aa),this.lHi(qa),Object(ua.c)(qa)&&kb.Dh.lS(za,cb.BasicTelemetryCalculator.WQ));const ma=this.$.pa.va.$b({ima:!0,$ka:3});Aa=(vb,Ka,Pa)=>{this.$.vy();I.i(Cb,",",this.$,!1);return ja(this.$.pa.va,xb,$a.b(vb,
this.j2i),Ka,Pa,za,ma)};const Ga=()=>new Ya(xb);return qa&&Object(ua.c)(qa)?va.a(this.$.userOperationManager,Aa,vb=>new Ba.a(136,0,vb,64,Ga),rb):va.a(this.$.userOperationManager,Aa,vb=>new Ba.a(136,0,vb,void 0,Ga),rb)}arh(xb){xb=Wb.a.hd(1,0,xb?769:771,xb?770:772,0,xb?-2037763134:503471870,xb?"HideAllColumnsError":"HideAllRowsError");new Ab.a(this.$,xb)}}Object(r.a)(Jb,"ResizeCommandHandler",null,[222]);var Gb=a(108),Nb=a(153),Ja=a(54);class ab extends oa.a{constructor(xb){super(xb)}ld(){let xb;xb=
E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(Gb.c)(Nb.a.resolve(Ja.r,{Wb:this.Na})):xa.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Na);let rb;rb=E.EwaSettings.oNa()?xa.GetServiceTaskFactory.Pa(this.$.da,528,529,this.Na):wa.Task.Ta(null);bb.TaskExtensions.za(xb,()=>{this.fd([new Jb(this.$,xb.result,rb.result)])},this.ka,3)}static la(xb){oa.a.Rd(113,new ab(xb))}}Object(r.a)(ab,"ResizeCommandHandlerFactory",oa.a,[]);a.d(B,"a",function(){return wb});
const wb=()=>{c.a.Fa(xb=>{fa.la(xb);ab.la(xb)})}},1211:function(r,B,a){r=a(0);var c=a(141);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.wc(1,CommonUIStrings.l_DialogClose)}displayError(P){this.Xz(P,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}i$c(P){this.Xz(P,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(r.a)(b,"ErrorDialog",c.StandardDialog,[332]);var e=a(15),f=a(167);class d{k2e(){e.ULS.sendTraceTag(24134234,
352,50,"Returning endpoint for ODC");const P=new f.a;P.setResult("api.onedrive.com");return P.task}}Object(r.a)(d,"OneDriveConsumerEndpointHelper",null,[227]);var h=a(88),l=a(56),k=a(383),w=a(233);class n{constructor(P,D,G,E){this.xFa=this.s6=null;this.nUc=this.pUc=!1;this.TXa=null;this.fb=P;this.QSb=D;this.dFa=G;this.Ls=E}get rve(){return this.QSb}get fa(){return this.fb}u5a(){this.TXa||(this.TXa=this.Mab?w.a.create(this.Mab,null,null,null,!1):null);return this.TXa}setup(P){this.xFa=P;this.pUc||
this.nUc?this.pUc&&this.xFa&&this.xFa(!0):(P=this.u5a())?(this.nUc=!0,P.K9a.continueWith(D=>{this.V0i(D)}),k.a.Zia(P)):(e.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.xFa(!1))}aFd(P){e.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",P.exception?P.exception.toString():"No error detail.")}V0i(P){this.nUc=!1;if(P.Lf)this.aFd(P),this.xFa(!1);else try{this.pUc=!0,e.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),
this.opd(),e.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.xFa(!0)}catch(D){e.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",D.toString()),this.xFa(!1)}}startPicker(P){this.s6=P;this.dFa?e.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.ADd,"onApiReady")))}ADd(P){P?this.vmc():this.vj()}vj(){this.Ls().displayError(l.a.j6i)}onSuccess(P){e.ULS.sendTraceTag(17909057,
352,50,"Success Callback called. Calling callback function.");this.s6&&this.s6(!0,P)}dispose(){this.TXa&&this.TXa.dispose()}}Object(r.a)(n,"AOneDriveFilePickerApiManager",null,[280,3]);class x extends n{constructor(P,D,G,E,O,N){super(D,G,E,N);this.Ih=null;this.d2=P;this.fHg=O}get Mab(){return this.fa.Wa("OneDriveApiUrl")}start(P,D){this.Ih=P;this.startPicker(D)}opd(){WL.init(1===this.rve||2===this.rve?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,
["env"]:"INT"})}startPicker(P){this.s6=P;!this.dFa&&this.d2.QMa?(e.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(h.a)(this,this.ADd,"onApiReady"))):(e.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.fHg())}vmc(){try{e.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Ih).then(Object(h.a)(this,this.onSuccess,"onSuccess"),Object(h.a)(this,this.r6,"onFailure"))}catch(P){e.ULS.sendTraceTag(17909056,
352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",P,P.stack),this.vj()}}r6(P){if(P&&P.error){if("user_canceled"===P.error.code){e.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}e.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",P.error.code,P.error.message)}else e.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.s6&&this.s6(!1,P);this.vj()}}Object(r.a)(x,"OneDriveFilePickerApiManagerV5",n,[]);class m extends n{constructor(P,
D,G,E,O){super(P,D,G,E);this.mVb=this.zhe=null;this.kzg=O;this.options={};this.options.clientId=this.fa.Wa("OneDriveApiV7ClientId");this.options.cancel=Object(h.a)(this,this.FDc,"toggleHostDivVisibility")}get Mab(){return this.fa.Wa("OneDriveApiV72Url")}start(P,D){this.mVb=D;const G=this.kzg.k2e();G.continueWith(()=>{e.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.zhe=G.result;this.startPicker((E,O)=>{this.FDc();P(E,O)})},3);G.continueWith(()=>
{e.ULS.sendTraceTag(24134242,352,15,G.exception.message);this.FDc()},5)}opd(){this.options.success=P=>{const D={};D.data=P;this.onSuccess(D)};this.options.error=P=>{const D={};D.error=P;this.r6(D)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.zhe;this.options.advanced.iframeParentDiv=this.mVb}vmc(){try{e.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.FDc(),OneDrive.open(this.options)}catch(P){e.ULS.sendTraceTag(22090008,
352,10,"Opening OneDrive file picker threw an exception: {0}",P.message),this.vj()}}r6(P){this.s6&&this.s6(!1,P);this.vj()}FDc(){this.mVb.style.visibility="hidden"===this.mVb.style.visibility?"":"hidden"}}Object(r.a)(m,"OneDriveFilePickerApiManagerV7",n,[]);class u extends n{constructor(P,D,G,E){super(P,D,G,E);this.Zvg=P;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Wa("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get Mab(){return this.fa.Wa("OneDriveApiV72Url")}start(P,
D,G,E){this.options.advanced.iframeParentDiv=G;this.options.advanced.endpointHint=E;this.options.cancel=D;this.Zvg.qa("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(P)}startPicker(P){this.s6=P;this.dFa?e.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):
(e.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.ADd,"onApiReady")))}opd(){this.options.success=P=>{const D={};D.data=P;this.onSuccess(D)};this.options.error=P=>{const D={};D.error=P;this.r6(D)}}vmc(){try{e.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(P){e.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",P.message,
P.stack),this.vj()}}aFd(P){e.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",P.exception?P.exception.toString():"No error detail.");k.a.knj(this.Mab);this.TXa=null}vj(){this.Ls().i$c(l.a.Wwj)}r6(P){this.s6&&this.s6(!1,P)}}Object(r.a)(u,"OneDriveFilePickerApiManagerV72",n,[]);class t{constructor(P){this.olsSessionId=this.value=this.key=null;this.olsSessionId=P}}Object(r.a)(t,"IExtraData",null,[]);var y=a(4);class v extends u{constructor(P,D,G,E){super(P,D,G,E);this.options.advanced.filter=
P.Wa("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=y.AFrameworkApplication.zve;P.qa("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=P.Wa("OneDriveApiV72CommandMode")||"none");P.qa("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new t(y.AFrameworkApplication.userSessionId))}get Mab(){return this.fa.Wa("OneDriveApiV72Url")}vmc(){try{e.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",
this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",y.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(P){e.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",P.message,P.stack),this.vj()}}}Object(r.a)(v,"OneDriveFilePickerApiOpenManagerV72",u,[]);var A=a(244);class z{constructor(P){this.Hk=null;this.rh=P;this.oTc=3}k2e(){this.Hk=new f.a;e.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.URd();return this.Hk.task}URd(P=null){const D=String.format("GetMoreInfoHandler.ashx?{0}",y.AFrameworkApplication.aJa);this.rh.eha(D,1,null,P,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(h.a)(this,this.V1h,"getMoreInfoSucceeded"),Object(h.a)(this,this.T1h,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}T1h(P){if(P.data.httpStatus===A.a.eJb&&"X-NewKey"in P.data.responseHeaders){e.ULS.sendTraceTag(24134236,352,
50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const D={};D["X-Key"]=P.data.responseHeaders["X-NewKey"];this.URd(D)}else 0<this.oTc?(e.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.oTc),this.oTc--,this.URd()):(e.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Hk.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}V1h(P){"PersonalFileStorageUrl"in
P.data.responseHeaders&&""!==P.data.responseHeaders.PersonalFileStorageUrl?(e.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Hk.setResult(P.data.responseHeaders.PersonalFileStorageUrl)):(e.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Hk.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(r.a)(z,"OneDriveForBusinessEndpointHelper",null,[227]);var C=a(257),
H=a(569);class I{constructor(){this.$a=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Kh(P){this.$a=P;this.$a.register(x,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").tc().Bc(()=>new x(H.a.instance,y.AFrameworkApplication.fa,y.AFrameworkApplication.x3a,y.AFrameworkApplication.limitedEdit,y.AFrameworkApplication.icg,()=>new b));y.AFrameworkApplication.Iof?this.$a.register(227,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Bc(()=>
new d):this.$a.register(227,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Bc(()=>new z(y.AFrameworkApplication.Hd));this.$a.register(m,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").tc().Bc(()=>new m(y.AFrameworkApplication.fa,y.AFrameworkApplication.x3a,y.AFrameworkApplication.limitedEdit,()=>new b,this.$a.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.$a.register(u,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").tc().Bc(()=>
new u(y.AFrameworkApplication.fa,y.AFrameworkApplication.x3a,y.AFrameworkApplication.limitedEdit,()=>new b));this.$a.register(v,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").tc().Bc(()=>new v(y.AFrameworkApplication.fa,y.AFrameworkApplication.x3a,y.AFrameworkApplication.limitedEdit,()=>new b))}static main(){C.a.instance.si(new I)}}Object(r.a)(I,"PackageManager",null,[4,5]);a.d(B,"a",function(){return S});const S=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");
I.main()}},1218:function(r,B,a){r=a(0);var c=a(88),b=a(15),e=a(141),f=a(56),d=a(25);class h extends e.StandardDialog{constructor(W,ea){super();this.UXa=!1;this.nA=null;this.La=W;this.Wjb=ea;this.qTa=!1}displayError(W,ea,R){this.nA=ea;this.UXa=R;b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",W,R);W=this.u3c(W);0===W?(this.Rb=6,this.wc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.wc(1,CommonUIStrings.l_DialogClose));0===W&&b.ULS.sendTraceTag(8194009,216,50,
"Show standard error dialog.");this.Xz(f.a.Vwj,this.ohd(W),this.lXh(W,ea),Object(c.a)(this,this.bQd,"retryDialogHandler"),!0)}bQd(W){1===W?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.nA?this.La.$d(d.a.nMb,2,[this.nA,this.UXa]):this.La.processAction(d.a.nMb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}u3c(W){return 0>W||6<W?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",W),0):W}lXh(W,ea){W=this.u3c(W);return this.Wjb?
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ea),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][W]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,
ea),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][W]}ohd(W){W=this.u3c(W);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][W]}}Object(r.a)(h,"ErrorRetryDialog",e.StandardDialog,[498]);class l{constructor(W,ea){this.fb=W;this.La=ea;this.Wjb=this.fb.qa("SaveToHostWithExtraCharsInFileName")}create(){return new h(this.La,
this.Wjb)}}Object(r.a)(l,"ErrorRetryDialogFactory",null,[492]);e=a(1082);var k=a(156);class w{static get qg(){return k.a.Iq(w.Ql,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}w.Ql="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(r.a)(w,"FileNameDialogHtml",null,[]);var n=a(4),x=a(31);class m extends e.a{constructor(W,ea,R,Y,U,da){super(W,ea,R,Y,U,da);this.qg=w.qg;this.we="FileNameDialog-SaveAsToHost"}hQ(W,ea){const R=x.a.Pp(n.AFrameworkApplication.um.ln);ea={["txtFileName"]:W||R,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:ea};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.Zac,"fileNameDialogHandler"),ea);this.pOe(W,R)}}Object(r.a)(m,"FileNameDialog",e.a,[497]);class u{constructor(W,
ea,R,Y,U,da){this.La=ea;this.fb=W;this.yX=Y;this.Rga=da;this.Ls=U;this.ff=R}create(){return new m(this.fb,this.La,this.ff,this.yX,this.Ls,this.Rga)}}Object(r.a)(u,"FileNameDialogFactory",null,[491]);var t=a(655),y=a(111);class v{constructor(W,ea,R){this.Rga=R;this.RLc=ea;this.fb=W}Hg(){2===n.AFrameworkApplication.sa.Qa.ri?n.AFrameworkApplication.rb.Je(d.a.nMb,y.a.frame,Object(c.a)(this,this.w3f,"saveAsToHostActionDispatcher"),4):n.AFrameworkApplication.rb.Qb(d.a.nMb,y.a.frame,Object(c.a)(this,this.w3f,
"saveAsToHostActionDispatcher"))}w3f(W,ea,R,Y,U){return ea.contextId!==y.a.frame||W!==d.a.nMb?2:this.fb.qa("SaveAsToHostBrsIsEnabled")?1===R?t.SessionStatusManager.instance.h6a||n.AFrameworkApplication.h5?8:32:2===R?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),W=this.RLc.create(),U&&Object.getType(U)===Array&&2===U.length?W.hQ(U[0],!!U[1]):W.hQ(null,!1),32):8:8}}Object(r.a)(v,"SaveAsToHostActor",null,[]);var A=a(40),z=a(82),C=a(41),H=a(244),I=a(381),
S=a(172),P=a(657),D=a(782);class G{constructor(W,ea,R,Y,U,da,T,ka){this.Km=null;this.UXa=this.xEa=!1;this.Qga=this.Ih=this.nA=null;this.fb=ea;this.uGa=this.fb.appSettings.SaveAsToHostWebServiceBase;this.qce=Y;this.Kmb=U;this.rh=R;this.Ls=da;this.Ah=ka;this.ff=T;this.La=W;this.Qfa=ea.Wa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}KOb(){1!==this.ff.state&&(this.Km=this.Kmb(),this.Km.message=CommonUIStrings.l_CommentProgressTooltip,this.Km.Rb=5,this.Km.yt=!1,this.Km.PBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}iS(W=0){1!==this.ff.state&&this.Ls.create().displayError(W,x.a.Pp(this.nA),this.UXa)}aRa(){const W=this.fb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");C.a.nf(W,C.a.qX(3),void 0,"UploadToHostManager.RedirectToFolder")}$Qa(W){let ea=!1,R=!1;this.fb&&(ea=this.fb.qa("SaveACopyIsEnabledForUiHost"),R=this.fb.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
W,ea,R);if(ea&&R){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Y={};Y[I.a.UQa]="1";Y[I.a.documentUrl]=W;Y[I.a.reason]=P.a.saveAs;n.AFrameworkApplication.JQ().execute(U=>{U.uj(S.a.fZ,Y)})}else ea&&!R&&n.AFrameworkApplication.yV?C.a.nf(W,C.a.qX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):C.a.nf(W,C.a.qX(3),void 0,"UploadToHostManager.RedirectToEditUrl")}Poa(W,ea,R=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.qce&&!this.qce()&&this.rh&&(this.Ah&&(this.Qga=this.Ah.Kc("DialogShown","SaveAsToHostUploadTime")),this.KOb(),this.UXa=ea,this.nA=W,(this.Ih=R)&&"true"===this.Ih.SkipSaveToHost?this.qac():this.oQ())}oQ(){32!==this.La.processAction(d.a.cSa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.qac()):this.La.$d(d.a.cSa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.qac()},(W,
ea)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.iS(ea)}])}w5i(W){this.EJa();this.xEa=!1;if(W&&W.data&&W.data.me)if(({ot:ea}=A.d(W.data.me)).returnValue)if(W=ea,W.StatusCode!==H.a.ZO&&W.StatusCode!==H.a.Otb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var ea={};ea.FailureReason=W.StatusCode.toString();ea.ExtraInfo=W.ExtraInfo;this.Wda(ea);this.iS(parseInt(W.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.QOd();try{W.NewDocumentUrl&&""!==W.NewDocumentUrl?this.$Qa(W.NewDocumentUrl):this.aRa()}catch(R){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",R.toString())}this.LIb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:D.a.Ngb(W.data.me)}),this.Wda({["FailureReason"]:"Failed to deserialize response"}),this.iS();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Wda({["FailureReason"]:"null response"}),this.iS()}v5i(W){5!==W.data.status&&12!==W.data.status||this.xEa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:W.data.status,["HttpStatus"]:W.data.httpStatus}),this.Wda({["FailureReason"]:W.data.httpStatus.toString()}),this.EJa(),this.iS(),this.LIb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.xEa=!0,this.Ih&&"true"===this.Ih.SkipSaveToHost?this.qac():
this.oQ())}EJa(){this.Km&&(this.Km.close(),this.Km=null)}LIb(){this.Qga&&(this.Qga.stop(),this.Qga=null)}QOd(){this.Ih&&"VersionHistory"===this.Ih.SaveEntryPoint&&this.La.processAction(d.a.Gwc,2)}Wda(W){this.Ih&&"VersionHistory"===this.Ih.SaveEntryPoint&&this.La.$d(d.a.TOd,2,W)}qac(){let W=this.uGa+this.Qfa;W=z.a.fl(W,"qs",x.a.pf(n.AFrameworkApplication.xi));W=z.a.fl(W,"n",x.a.pf((new Date).getTime().toString()));W=z.a.fl(W,"ov",x.a.pf(this.UXa.toString()));W=z.a.fl(W,"fn",x.a.pf(this.nA));this.Ih&&
this.Ih.FileDownloadUrl&&(W=z.a.fl(W,"furl",x.a.pf(this.Ih.FileDownloadUrl)));this.rh.Mm(W,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.w5i,"onUploadFinished"),Object(c.a)(this,this.v5i,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(r.a)(G,"UploadToHostManager",null,[490]);var E=a(257),O=a(799);class N{constructor(){this.$a=null}get name(){return"Common.App.SaveAsToHost"}init(){n.AFrameworkApplication.fa.zu(Object(c.a)(this,this.mB,"onFullAppSettingsReady"))}mB(){n.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&
this.$a.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Hg()}Kh(W){this.$a=W;this.$a.register(l,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Bc(()=>new l(n.AFrameworkApplication.fa,n.AFrameworkApplication.rb)).tc();this.$a.register(G,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Bc(()=>new G(n.AFrameworkApplication.rb,n.AFrameworkApplication.fa,n.AFrameworkApplication.Hd,()=>n.AFrameworkApplication.ug,
()=>(new O.a).create(),W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),n.AFrameworkApplication.sa,n.AFrameworkApplication.sa.SD)).tc();this.$a.register(u,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Bc(()=>new u(n.AFrameworkApplication.fa,n.AFrameworkApplication.rb,n.AFrameworkApplication.sa,n.AFrameworkApplication.sa.Qa,W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),W.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).tc();
this.$a.register(v,"Common.App.SaveAsToHost.SaveAsToHostActor").Bc(()=>new v(n.AFrameworkApplication.fa,W.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),W.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).tc()}dispose(){}static main(){E.a.instance.si(new N)}}Object(r.a)(N,"SaveAsToHostPackage",null,[4,5]);a.d(B,"a",function(){return J});const J=()=>{Type.registerNamespace("Common.App.SaveAsToHost");N.main()}},1219:function(r,B,a){r=a(0);var c=a(88),b=a(15),e=a(156);class f{static get qg(){return e.a.Iq(f.Ql,
CommonUIStrings.l_SaveACopyFileName)}}f.Ql="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(r.a)(f,"FileNameDialogHtml",null,[]);var d=a(4),h=a(31);class l extends e.a{constructor(D,G,E,O){super();this.YUb=
this.P8=null;this.La=D;this.yX=G;this.fob=E;this.wc(1,CommonUIStrings.l_SaveButtonLabel);this.qg=f.qg;this.we="FileNameDialog-SaveACopy";this.Ih=O}hQ(D,G,E){this.YUb=D;this.P8=E;D={["txtFileName"]:h.a.Pp(d.AFrameworkApplication.um.ln),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,G)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.Zac,"fileNameDialogHandler"),D);b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}Zac(D,G){1!==D?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(D=G.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),G=h.a.k4(d.AFrameworkApplication.fileName),D&&""!==D&&""!==G&&(D+=G),this.fob.Poa(this.YUb,this.P8,D,this.Ih))}}Object(r.a)(l,"FileNameDialog",e.a,[420]);class k{constructor(D,G,E){this.La=D;this.yX=G;this.fob=E}create(D){return new l(this.La,
this.yX,this.fob,D)}}Object(r.a)(k,"FileNameDialogFactory",null,[399]);var w=a(141),n=a(25);class x extends w.StandardDialog{constructor(D){super();this.Rb=1;this.wc(1,CommonUIStrings.l_RetryButtonLabel);this.wc(0,CommonUIStrings.l_DialogClose);this.La=D}displayError(D){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",D);this.Xz(D,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(c.a)(this,this.bQd,"retryDialogHandler"))}bQd(D){1===D?(b.ULS.sendTraceTag(7165653,
216,50,"User click to retry the action."),this.La.processAction(n.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(r.a)(x,"RetryDialog",w.StandardDialog,[394]);w=a(1083);var m=a(857),u=a(383),t=a(111);class y extends w.a{constructor(D,G,E,O){super(D,G,E,O);this.pEg=G}T8a(){return this.fb.qa("SaveACopyBrsIsEnabled")}S1e(){return n.a.saveACopy}P3b(){u.a.cMd(Object(c.a)(this,this.P3f,"saveToCloudActionDispatcher"));u.a.Gad([new m.a(n.a.saveACopy,t.a.frame,0)],
this.pEg.u5a())}IVf(){d.AFrameworkApplication.yya("CreateCopy_cf;CreateCopy_tf");b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(r.a)(y,"SaveACopyActor",w.a,[]);w=a(1086);class v extends w.a{constructor(D,G,E,O,N,J,W){super(G,E,O,N,J,W);this.Lzg=D}onSuccess(D){D&&D.data&&D.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Lzg.create(this.Ih).hQ(D.data.folders[0].id,D.data.folders[0].name,D.data.folders[0].urls.viewInBrowser)):
(b.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.vj())}r6(D){D&&D.error&&"user_canceled"===D.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.r6(D)}vj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.vj()}}Object(r.a)(v,"SaveACopyManager",w.a,[]);var A=a(1084);class z extends A.a{constructor(D,G,E,O,N,J){super(G,E,O,N,J);this.La=D}bud(){return!!this.Ih&&!!this.Ih.SaveEntryPoint&&
"VersionHistory"===this.Ih.SaveEntryPoint.toString()}iS(){b.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.bud()&&this.La.$d(n.a.TOd,2,{["FailureReason"]:"Unknown"});super.iS()}aRa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.bud()&&this.La.processAction(n.a.Gwc,2);super.aRa()}$Qa(D){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",D);this.bud()&&this.La.processAction(n.a.Gwc,2);super.$Qa(D)}oQ(){this.Ih&&
"true"===this.Ih.SkipSaveToHost?super.oQ():32!==this.La.processAction(n.a.cSa,1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.oQ()):this.La.$d(n.a.cSa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");A.a.prototype.oQ.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.iS()}])}}Object(r.a)(z,"SaveACopyUploadToCloudManager",
A.a,[]);var C=a(257),H=a(569),I=a(799);class S{constructor(){this.$a=null}get name(){return"Common.App.SaveACopy"}init(){d.AFrameworkApplication.fa.zu(Object(c.a)(this,this.mB,"onFullAppSettingsReady"))}mB(){d.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.$a.resolve("Common.App.SaveACopy.SaveACopyActor").Hg()}dispose(){}Kh(D){this.$a=D;this.$a.register(z,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Bc(()=>new z(d.AFrameworkApplication.rb,D.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new I.a).create(),()=>new x(d.AFrameworkApplication.rb),d.AFrameworkApplication.sa,d.AFrameworkApplication.sa.SD)).tc();this.$a.register(k,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Bc(()=>new k(d.AFrameworkApplication.rb,d.AFrameworkApplication.sa.Qa,D.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).tc();this.$a.register(y,"Common.App.SaveACopy.SaveACopyActor").Bc(()=>new y(D.resolve("Common.App.SaveACopy.SaveACopyManager"),
D.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.SD)).tc();this.$a.register(v,"Common.App.SaveACopy.SaveACopyManager").Bc(()=>new v(D.resolve("Common.App.SaveACopy.FileNameDialogFactory"),D.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),H.a.instance,D.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.x3a,()=>new x(d.AFrameworkApplication.rb))).tc()}static main(){C.a.instance.si(new S)}}
Object(r.a)(S,"PackageManager",null,[4,5]);a.d(B,"a",function(){return P});const P=()=>{Type.registerNamespace("Common.App.SaveACopy");S.main()}},1220:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(15),f=a(31),d=a(87),h=a(248),l=a(37);class k extends h.a{constructor(G,E,O){super(G,E);this.rHd=this.executionContext=null;this.W8i=(N,J)=>{this.CIb(N,J)};this.UJ=O}initialize(G){super.initialize(G)}execute(G){this.executionContext=G;G=Object(d.a)(9,this.executionContext.Ke);this.Ftb(G);return 1}RI(G){super.RI(G)}Ftb(){this.subscribe(this.executionContext,
this.W8i,G=>{this.rHd.add_disposing(G)})}CIb(G){this.unsubscribe(E=>{G.remove_disposing(E)});this.executionContext.activityState[l.a.q2]=0}}Object(r.a)(k,"PasswordProtectedFileActivity",h.a,[]);var w=a(292),n=a(272),x=a(14);class m extends w.a{constructor(G){super(G);this.Dqa=0;this.yhj=(E,O)=>{this.scb(E,O)};this.k3d=(E,O)=>{this.eVa(E,O)}}get pc(){return"PasswordDialog"}get Bub(){return this.Dqa}get ll(){return x.a.instance.ga(1982)}scb(G){this.Dqa=G}n3(){const G={};G[w.a.description]=x.a.instance.ga(1983);
G[w.a.placeholderText]=x.a.instance.ga(1979);G[w.a.BOf]=x.a.instance.ga(2001);G[w.a.zOf]=x.a.instance.ga(2002);G[w.a.AOf]=x.a.instance.ga(1980);G[w.a.Tod]=x.a.instance.ga(1986);G[w.a.bye]=x.a.instance.ga(1666);G[w.a.r$j]=x.a.instance.Ua(25);G[w.a.npg]=this.k3d;return G}Yta(){const G={};G[n.a.pt]=this.pc;G[w.a.h0a]=this.n3();return G}tg(){this.Rb=1;this.initializeAndShow(this.ll,this.yhj,this.Yta())}}Object(r.a)(m,"PasswordProtectedFilePasswordInputDialog",w.a,[]);var u=a(63),t=a(29),y=a(255);class v extends m{constructor(G){super(G);
this.YPd=5;this.mde=!1;this.passwordToModify=null;this.COf=()=>{this.$.isEditMode&&this.gkc&&this.$.em(this.COf)};this.tg();this.$.hl(this.COf)}get gkc(){return this.mde}get ll(){return x.a.instance.ga(1984)}scb(G,E){super.scb(G,E);e.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${G}`)}eVa(G,E){this.passwordToModify=G;const O={};O.FileModifyPassword=f.a.pf(G);u.M(this.$.pa.va,O,this.B5i(E),this.A5i(E),null,
null)}n3(){const G=super.n3();G[w.a.Tod]=x.a.instance.ga(1987);G[w.a.description]=x.a.instance.Ua(24);return G}tg(){e.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.tg()}B5i(G){return E=>{t.a.lh(E.Errors,[-2019873242])&&this.e9b(this.wtb());if(!E||y.a(E))if(0<this.YPd)this.gUf(G);else{e.ULS.sendTraceTag(537154754,0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${t.a.qc(E.Errors)}`);
this.$.ea.$n(E.Errors);this.hide();return}this.mde=E.Result;this.gkc&&e.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password.");G(this.gkc?0:1)}}A5i(G){return()=>{0<this.YPd?this.gUf(G):(e.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),G(3))}}gUf(G){--this.YPd;this.eVa(this.passwordToModify,G)}wtb(){return t.a.hd(1,
0,1665,1666,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(r.a)(v,"PasswordProtectedFileModifyPasswordInputDialog",m,[]);var A=a(6);class z extends k{constructor(G,E,O){super(G,E,O)}Ftb(G){this.rHd=new v(G);super.Ftb(G)}CIb(G,E){const O=G.Bub,N=G.gkc,J=G.passwordToModify;super.CIb(G,E);this.executionContext.Qya([2001366804]);switch(O){case 1:N?(E=Object(d.a)(9,this.executionContext.Ke),this.executionContext.activityState[l.a.Spe]=f.a.pf(J),this.executionContext.activityState[l.a.vZa]=
!0,G.passwordToModify="",this.qh(E.isEditMode?A.a.sj:this.OJ)):e.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");this.qp();break;case 0:this.executionContext.activityState[l.a.Rr]=!1;this.qh(this.UJ);this.qp();break;default:e.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${O}'`)}}}Object(r.a)(z,
"PasswordProtectedFileModifyActivity",k,[]);class C extends b.a{constructor(G,E,O,N){super();this.activityName=G;this.OJ=E;this.UJ=O;this.$=N;this.Gb()}create(){this.qb(new z(this.activityName,this.OJ,this.UJ))}static la(G){G.da.Ha(434,new C(A.a.BIb,A.a.Egb,A.a.xsb,G))}}Object(r.a)(C,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var H=a(46);class I extends m{constructor(G,E){super(G);this.password=null;this.Wpf=E;this.tg()}eVa(G,E){this.password=G;E(0)}n3(){const G=super.n3();this.Wpf&&(G[w.a.Wwh]=
1);return G}tg(){e.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.Wpf}`);super.tg();H.a(this.$).kue()}}Object(r.a)(I,"PasswordProtectedFileOpenPasswordInputDialog",m,[]);class S extends k{constructor(G,E,O){super(G,E,O)}Ftb(G){const E=t.a.lh(this.executionContext.errors,[1217361942]);this.rHd=new I(G,E);G.fic||G.WNe();super.Ftb(G)}CIb(G,E){let O,N;O=G.password;G.password="";N=G.Bub;super.CIb(G,E);this.executionContext.activityState[l.a.EXc]=
f.a.pf(O);this.executionContext.activityState[l.a.vZa]=!0;this.executionContext.Qya([110414285,1217361942]);e.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${N}`);switch(N){case 1:this.qh(this.OJ);this.qp();break;case 0:this.qh(this.UJ),this.qp()}}}Object(r.a)(S,"PasswordProtectedFileOpenActivity",k,[]);class P extends b.a{constructor(G,E,O,N){super();this.activityName=G;this.OJ=E;this.UJ=O;this.$=N;this.Gb()}create(){this.qb(new S(this.activityName,
this.OJ,this.UJ))}static la(G){G.da.Ha(386,new P(A.a.Gsc,A.a.sj,A.a.Pj,G))}}Object(r.a)(P,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(B,"a",function(){return D});const D=()=>{c.a.Fa(P.la);c.a.Fa(C.la)}},1228:function(r,B,a){r=a(0);var c=a(141);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.wc(1,CommonUIStrings.l_DialogClose)}displayError(P){this.Xz(P,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(r.a)(b,"ErrorDialog",c.StandardDialog,
[394]);var e=a(1086),f=a(1083),d=a(15),h=a(88),l=a(4),k=a(261),w=a(41),n=a(25);class x extends c.StandardDialog{constructor(P,D,G){super();this.La=P;this.d2=D;this.yX=G;this.nx=!1;this.Rb=1;this.C0(1);this.wc(1,CommonUIStrings.l_SignIn);this.wc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}hQ(){this.d2.IZa(Object(h.a)(this,this.lLf,"onSignIn"));this.Zl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(h.a)(this,this.dni,"inputHandler"))}dni(P){0===
P?(d.ULS.sendTraceTag(6590598,216,l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Qa&&1===l.AFrameworkApplication.sa.Qa.ri?15:50,"User dismissed SignIn Dialog."),this.hide()):this.K6()}R6g(){let P="2";if(this.yX)switch(this.yX.ri){case 3:P="0";break;case 2:P="3";break;case 1:P="1"}return P}hide(){this.d2.KKb(Object(h.a)(this,this.lLf,"onSignIn"));super.hide()}K6(){var P=l.AFrameworkApplication.fa.qa("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";P=new k.QueryStringBuilder(P);
P.hj("prompt","1");P.hj("cbcxt",this.R6g());l.AFrameworkApplication.yZa(P);w.a.nf(P.toString(),"LoginWindow",void 0,"SignInDialog")}lLf(){this.Xn&&this.hide();d.ULS.sendTraceTag(7143885,216,l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Qa&&1===l.AFrameworkApplication.sa.Qa.ri?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(n.a.saveToCloudStorage,2)}}Object(r.a)(x,"SignInDialog",c.StandardDialog,[418]);class m{constructor(P,D,G){this.La=
P;this.d2=D;this.yX=G}create(){return new x(this.La,this.d2,this.yX)}}Object(r.a)(m,"SignInDialogFactory",null,[389]);var u=a(82),t=a(31);class y{constructor(P,D,G,E,O,N,J){this.uGa=P;this.nA=D;this.IWa=G;this.YUb=E;this.KSc=O;this.Qfa=N;this.Ih=J}execute(P,D){if(!l.AFrameworkApplication.ug&&l.AFrameworkApplication.Hd){var G=this.uGa+this.Qfa;G=u.a.fl(G,"fo",t.a.pf(this.YUb));G=u.a.fl(G,"fn",t.a.pf(this.nA));G=u.a.fl(G,"qs",t.a.pf(this.KSc));G=u.a.fl(G,"n",t.a.pf((new Date).getTime().toString()));
this.Ih&&this.Ih.FileDownloadUrl&&(G=u.a.fl(G,"furl",t.a.pf(this.Ih.FileDownloadUrl)));this.IWa&&(G=u.a.fl(G,"fnn",t.a.pf(this.IWa)));l.AFrameworkApplication.Hd.Mm(G,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,P,D,null)}}}Object(r.a)(y,"SkyDriveUploadCaller",null,[417]);class v{constructor(P){this.fb=P;this.vGa=P.appSettings.SkyDriveUploadWebServiceBase;this.nA=P.appSettings.FileName;this.Qfa=P.Wa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(P,D,G){return new y(this.vGa,
this.nA,D,P,l.AFrameworkApplication.xi,this.Qfa,G)}}Object(r.a)(v,"SkydriveUploadCallerFactory",null,[386]);var A=a(1084),z=a(257),C=a(569),H=a(799);class I{constructor(){this.$a=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.$a.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Hg()}dispose(){}Kh(P){this.$a=P;this.$a.register(m,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Bc(()=>
new m(l.AFrameworkApplication.rb,C.a.instance,l.AFrameworkApplication.sa.Qa)).tc();this.$a.register(v,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Bc(()=>new v(l.AFrameworkApplication.fa)).tc();this.$a.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Bc(()=>new f.a(P.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),P.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.sa.SD)).tc();this.$a.register(A.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Bc(()=>new A.a(P.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new H.a).create(),()=>new b,l.AFrameworkApplication.sa,l.AFrameworkApplication.sa.SD)).tc();this.$a.register(e.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Bc(()=>new e.a(P.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),C.a.instance,P.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.x3a,()=>new b)).tc()}static main(){z.a.instance.si(new I)}}Object(r.a)(I,"PackageManager",null,[4,5]);a.d(B,"a",function(){return S});const S=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");I.main()}},1229:function(r,B,a){r=a(0);var c=a(88),b=a(15),e=a(4),f=a(56),d=a(426),h=a(86);class l{constructor(A,z,C,H){this.yQc=null;this.iUb=H;this.XX=A;this.YX=z;this.$D=C;this.Gle=this.Gwf.XKj;A=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.wDg=A[0];this.vDg=A[1]}get Gwf(){return this.yQc||(this.yQc=h.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Mwa(){return CommonUIStrings.l_OICErrorHelpLink}get vAc(){return this.Gle}get Iwf(){return this.wDg}get Hwf(){return this.vDg}get Fwf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Gle?3:2}get zvb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get b6b(){return!!this.YX}get Avb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get ll(){return CommonUIStrings.l_DefaultDialogTitle}XKd(A){this.EGb(A)}ixd(A){this.EGb(A)}EGb(A){let z=
10;this.YX&&1===A&&(this.YX(this.$D),z=1);this.XX&&this.XX(this.$D);this.XF(z)}rPa(){d.Redirect.showHelp("OICFailure");this.XF(2)}oDd(){this.Gwf.dsf();this.XF(4)}XF(A){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.iUb,A);e.AFrameworkApplication.xwc(f.a.hNf,this.iUb,A)}dispose(){this.$D=this.XX=this.YX=null}}Object(r.a)(l,"AOICErrorDialog",null,[3]);var k=a(47),w=a(141);class n extends l{constructor(A,z,C,H){super(A,z,C,H);this.ura=this.lm=null;A=
document.createElement("span");A.id="errorMessageText";A.innerText=this.errorMessage;A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));this.lm=document.createElement("a");this.lm.href="#";this.lm.innerText=this.Mwa;A.appendChild(this.lm);k.a.addHandler(this.lm,"click",Object(c.a)(this,this.rPa,"oicErrorHelpLinkHandler"));z=new w.StandardDialog;z.we=this.id;this.vAc?(C=document.createElement("span"),H=document.createElement("span"),C.innerText=this.Iwf,H.innerText=
this.Hwf,this.ura=document.createElement("a"),this.ura.href="#",this.ura.innerText=this.Fwf,A.appendChild(document.createElement("br")),A.appendChild(C),A.appendChild(this.ura),A.appendChild(H),k.a.addHandler(this.ura,"click",Object(c.a)(this,this.oDd,"oicErrorMacOfferLinkHandler"))):this.b6b&&(A.appendChild(document.createElement("br")),A.appendChild(document.createElement("br")),C=document.createElement("span"),C.innerText=this.zvb,A.appendChild(C));this.b6b?(z.Rb=1,z.wc(1,this.Avb)):z.Rb=0;z.Zl(this.ll,
null,this.icon,Object(c.a)(this,this.ixd,"legacyOICErrorDialogHandler"),A);z.VW("errorMessageText")}dispose(){this.lm&&(k.a.removeHandler(this.lm,"click",Object(c.a)(this,this.rPa,"oicErrorHelpLinkHandler")),this.lm=null);this.ura&&(k.a.removeHandler(this.ura,"click",Object(c.a)(this,this.oDd,"oicErrorMacOfferLinkHandler")),this.ura=null);super.dispose()}}Object(r.a)(n,"OICErrorDialog",l,[]);class x{constructor(A,z,C){this.XX=z;this.YX=A;this.$D=C}get id(){return"OICErrorDialogWithDownload"}get ASe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Mwa(){return CommonUIStrings.l_OICErrorHelpLink}get zvb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Avb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get ll(){return CommonUIStrings.l_DefaultDialogTitle}XKd(A){this.EGb(A)}ixd(A){this.EGb(A)}EGb(A){let z=
10;1===A&&(this.YX(this.$D),z=1);this.XX&&this.XX(this.$D);this.XF(z)}rPa(){d.Redirect.showHelp("OICFailure");this.XF(2)}XF(A){e.AFrameworkApplication.xwc(f.a.iNf,3,A)}dispose(){this.$D=this.YX=this.XX=null}}Object(r.a)(x,"AOICErrorDialogWithDownload",null,[3]);class m extends x{constructor(A,z,C){super(A,z,C);this.lm=null;A=document.createElement("span");A.id="errorMessageText";A.innerText=this.ASe;A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));this.lm=document.createElement("a");
this.lm.href="#";this.lm.innerText=this.Mwa;A.appendChild(this.lm);k.a.addHandler(this.lm,"click",Object(c.a)(this,this.rPa,"oicErrorHelpLinkHandler"));A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));z=document.createElement("span");z.innerText=this.zvb;A.appendChild(z);z=new w.StandardDialog;z.we=this.id;z.Rb=1;z.wc(1,this.Avb);z.Zl(this.ll,null,this.icon,Object(c.a)(this,this.ixd,"legacyOICErrorDialogHandler"),A);z.VW("errorMessageText")}dispose(){this.lm&&
(k.a.removeHandler(this.lm,"click",Object(c.a)(this,this.rPa,"oicErrorHelpLinkHandler")),this.lm=null);super.dispose()}}Object(r.a)(m,"OICErrorDialogWithDownload",x,[]);var u=a(156);class t extends l{constructor(A,z,C,H){super(A,z,C,H);z={["errorMessage"]:this.errorMessage};z.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Mwa,["onExecute"]:I=>{this.rPa(I)}};this.vAc?(z.macOfficePreLinkText=this.Iwf,z.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.Fwf,
["onExecute"]:I=>{this.oDd(I)}},z.macOfficePostText=this.Hwf):this.b6b&&(z.errorFileDownloadOffer=this.zvb);A=new u.a(!1,!1,!0);this.b6b?(A.Rb=1,A.wc(1,this.Avb)):A.Rb=0;A.we=this.id;z={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:z};A.initializeAndShow(this.ll,Object(c.a)(this,this.XKd,"reactOICErrorDialogHandler"),z)}}Object(r.a)(t,"ReactOICErrorDialog",l,[]);class y extends x{constructor(A,z,C){super(A,z,C);z={["errorMessage"]:this.ASe,["errorFileDownloadOffer"]:this.zvb};z.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Mwa,["onExecute"]:H=>{this.rPa(H)}};A=new u.a(!1,!1,!0);A.Rb=1;A.wc(1,this.Avb);A.we=this.id;z={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:z};A.initializeAndShow(this.ll,Object(c.a)(this,this.XKd,"reactOICErrorDialogHandler"),z)}}Object(r.a)(y,"ReactOICErrorDialogWithDownload",x,[]);a.d(B,"a",function(){return v});class v{constructor(){this.Zkb=!!e.AFrameworkApplication.sa&&e.AFrameworkApplication.sa.Qa.Fv}tih(A,z,C){this.Zkb?
new t(A,z,null,C):new n(A,z,null,C)}uih(A,z,C){this.Zkb?new y(A,z,C):new m(A,z,C)}vih(A,z,C,H,I){const {ReactOICErrorDialogWithTrial:S}=a(1373),{OICErrorDialogWithTrial:P}=a(1374);this.Zkb?new S(A,z,C,null,H,I):new P(A,z,C,null,H,I)}static get instance(){return v.Ma||(v.Ma=new v)}}v.Ma=null;Object(r.a)(v,"OICErrorDialogFactory",null,[460])},1248:function(r,B,a){var c=a(9);r=a(0);var b=a(714),e=a(21),f=a(44),d=a(1),h=a(15),l=a(31),k;(function(H){H[H.url=0]="url";H[H.ref=1]="ref";H[H.mailto=2]="mailto"})(k||
(k={}));Object(r.b)("HyperlinkSelectionState",k);var w=a(786),n=a(8),x=a(594),m=a(63),u=a(93),t=a(14);class y extends w.a{constructor(H,I,S){super(H);this.Eob=0;this.CBb=!1;this.P2a=null;this.iOe=!1;this.ktb=!0;this.ll=this.lXc=null;this.$Bd=0;this.YBd=this.aCd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.Qhi=(P,D)=>{1===P||2===P?(h.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===P?"OK":"Remove"} pressed`),this.aCd=D[y.vEi],this.$Bd=D[y.szj],this.YBd=D[y.mrh],2===P&&(this.removeHyperLink=
!0),this.commit()):h.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.Z9j=(P,D)=>0!==D&&P.length?1===D?this.G4e(f.y(P,this.ea.ua)||this.zOi(P),760):this.G4e(l.a.Ird(P),762):null;this.selectedRange=I;this.UL=S;this.ea=H.ea;this.sheetName=I.SheetName;this.CMa();this.fq();this.Rb=this.CBb?9:1;this.wc(1,t.a.instance.ga(4));this.CBb&&(h.ULS.sendTraceTag(509690183,0,50,"Edit HyperLink was called."),this.wc(2,t.a.instance.ga(763)));this.initializeAndShow(this.ll,this.Qhi,{[y.pt]:this.pc,
[y.$9j]:this.Z9j,[y.PZg]:{[y.xqh]:this.iOe,[y.nrh]:this.P2a,[y.IKg]:this.Eob,[y.JKg]:this.lXc,[y.Kdh]:this.ktb}})}get pc(){return"HyperLinkDialog"}u6e(H,I){switch(I){case 2:return H.startsWith("mailto:")?H:"mailto:"+H;case 1:return`${n.a.jQf}${this.c1h(H)}`;default:return H}}get MB(){return 526}ZG(){const H=this.$;this.location=this.u6e(this.aCd,this.$Bd);try{this.location=u.a.qf(this.location)}catch(P){h.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}h.ULS.sendTraceTag(555755667,0,
50,`Committing ${k[this.$Bd]} link`);this.cellValue=this.YBd.length?this.YBd:this.aCd;H.vy();const I=H.pa.va.$b(),S=f.s(this.selectedRange);return(P,D,G)=>m.b(H.pa.va,S,this.cellValue,this.location,this.removeHyperLink,!1,123,P,D,G,this.UL.range,I)}ak(){const H=f.s(this.selectedRange);return()=>new x.a(H,this.cellValue,this.location)}BIh(){let H=this.UL.cell.B6a;this.UL.cell.Dwa?H&&H.startsWith("mailto:")?(this.Eob=2,H=H.substr(7)):this.Eob=0:this.Eob=1;return H}CMa(){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?
this.CBb=this.UL.xba:this.CBb=!!this.UL.tLa(64)||!!this.UL.tLa(128)}fq(){if(this.CBb){this.P2a=this.UL.text;const H=this.BIh();H&&(this.lXc=H);this.ll=t.a.instance.ga(827);this.ktb=this.lXc===this.P2a}else this.UL.text?(this.P2a=this.UL.text,this.ktb=!1):(this.P2a="",this.ktb=!0),this.Eob=0,this.ll=t.a.instance.ga(826);this.UL.WA&&(this.ktb=!1,this.iOe=!0,d.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.P2a=this.UL.formulaBarText))}zOi(H){return this.ea.Bb.Kk(H)}G4e(H,
I){return H?null:t.a.instance.ga(I)}c1h(H){let I,S;({sheetName:I,range:S}=f.ab(H,this.ea.ua)).returnValue&&S&&(H=f.x(S,I||this.sheetName,!1));return H}}y.$9j="validateLinkValues";y.PZg="bodyProps";y.xqh="disableDisplayText";y.nrh="displayTextValue";y.IKg="activeLinkOption";y.JKg="activeLinkValue";y.Kdh="copyLinkValueToDisplay";y.vEi="linkValue";y.szj="selectedLink";y.mrh="displayText";Object(r.a)(y,"HyperlinkDialog",w.a,[]);var v=a(58);class A{constructor(H,I){this.$=H;this.gridView=I}Mc(){return!1}Ac(H,
I){return 1===H&&-1583422759===I.command}Rc(){return!1}executeCommand(){this.hOj();return v.Task.Ta(!0)}hOj(){const H=f.v(this.gridView.ha.ra.xd,this.$),I=e.f(this.gridView);(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.$s([this.gridView.ha.ra.xd],!0))&&I&&new y(this.$,H,I)}}Object(r.a)(A,"ShowHyperlinkCommandHandler",null,[222]);class z extends b.a{constructor(H){super(H)}ld(){this.fd([new A(this.$,e.h(this.$))])}static la(H){b.a.Rd(105,
new z(H))}}Object(r.a)(z,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(B,"a",function(){return C});const C=()=>{c.a.Fa(z.la)}},1249:function(r,B,a){var c=a(9);r=a(0);var b=a(4),e=a(111),f=a(714),d=a(63),h=a(50),l=a(38),k=a(15),w=a(196),n=a(25),x=a(58);class m{constructor(z,C){this.$=z;this.Uh=C}Mc(){return!1}executeCommand(z,C,H){z=2;switch(C.command){case -309686558:z=this.Uh.$d(n.a.saveACopy,2,H);break;case 617689800:z=this.Uh.$d(n.a.saveToCloudStorage,2,H);break;case -1244760097:z=this.Uh.$d(n.a.saveToSharePoint,
2,H)}return 2===z&&C?w.a(C.command):x.Task.Ta(!0)}Ac(z,C){z=!1;switch(C.command){case -1244760097:case -309686558:case 617689800:z=!0,k.ULS.shipAssertTag(537153984,0,this.$.nla,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return z}Rc(){return!1}}Object(r.a)(m,"SaveToHostCommandHandler",null,[222]);class u extends f.a{constructor(z){super(z);this.nNh=(C,H,I,S,P)=>1===I?32:C===n.a.cSa&&2===I?(C=this.$.pa.va.$b(),d.C(this.$.pa.va,P[0],P[1],null,null,C),32):8}ld(){l.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.Na),()=>{this.fd([new m(this.$,b.AFrameworkApplication.rb)])},this.ka,3);b.AFrameworkApplication.rb.Qb(n.a.cSa,e.a.frame,this.nNh)}static la(z){f.a.Rd(267,new u(z))}}Object(r.a)(u,"SaveToHostCommandHandlerFactory",f.a,[]);var t=a(228);class y{constructor(z,C){this.$=z;this.Uh=C;this.$.da.Ha(393,this)}Mc(z){switch(z){case -309686558:return 8===this.Uh.processAction(n.a.saveACopy,1,null);case 617689800:return 8===this.Uh.$d(n.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.Uh.$d(n.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(r.a)(y,"SaveToHostManager",null,[377,3]);class v extends t.a{constructor(z){super();this.$=z;this.Gb()}create(){this.qb(this.$.da.Ba(393)||new y(this.$,b.AFrameworkApplication.rb))}static la(z){z.da.Ha(394,new v(z))}}Object(r.a)(v,"SaveToHostManagerFactory",t.a,[]);a.d(B,"a",function(){return A});const A=()=>{c.a.Fa(u.la);c.a.Fa(v.la)}},1250:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(15),f=a(87),d=a(122),h=a(29),
l=a(37);class k extends d.a{constructor(D,G){super(D,G)}execute(D){const G=Object(f.a)(9,D.Ke);e.ULS.shipAssertTag(537153921,0,h.a.hqb(D.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");G.oI(!0,!0);D.activityState[l.a.W_b]=G.ea.sessionId;D.activityState[l.a.Hob]=!0;D.activityState[l.a.b0b]=!0;e.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(r.a)(k,"SessionReloadActivity",d.a,
[]);var w=a(6);class n extends b.a{constructor(){super();this.Gb()}create(){this.qb(new k(w.a.keb,w.a.Zy))}static la(D){D.da.Ha(142,new n)}}Object(r.a)(n,"SessionReloadActivityFactory",b.a,[]);var x=a(59),m=a(277),u=a(124),t=a(49),y=a(45),v=a(36),A=a(1),z=a(43),C=a(254),H=a(123);class I extends d.a{constructor(D,G,E,O,N){super(D,G);I.Hzd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];I.Gzd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
I.Awf=[-1468309555,611268539,-1750576502,61029505];I.zwf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.kBc=E;this.TPj=O;this.pZj=N}execute(D){var G=Object(f.a)(9,D.Ke);D.activityState[l.a.xsa]=!0;var E=I.F7h(D);if(I.JJj(D,E))return I.eLi(D),E=50,0<D.errors.length&&(E=15),e.ULS.sendTraceTag(537153891,0,E,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.qc(D.errors)}`),D.activityState[l.a.xsa]=!1,this.qh(w.a.idle),
3;switch(E){case 1:case 3:this.Ymi(D,E);break;case 2:this.Xmi(D);break;case 0:D.activityState[l.a.wZa]=null}e.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${E}. activityName:${this.activityName}. NextActivityName:${this.D_}. TimeFromLastStatefulResponse:${G.ea.hX}.`);var O=v.a.ng(D.activityState,H.a.Igb);e.ULS.shipAssertTag(40502925,0,!O||O&&(1===E||3===E),`triggerSilentReloadAfterTokenRefresh: ${O}, silentReloadType: ${E}`);G=G.Yk.reloadCount;return 0!==E&&
0<G?(O=m.a.ELa(G,200),e.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${E}] retryNum [${G}] delayInMs [${O}] activityName [${this.activityName}]`),t.a.instance.create(()=>{I.pM(D)},O,y.a.zBj),1):3}Ymi(D,G){e.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const E=Object(f.a)(9,D.Ke);D.activityState[l.a.Hob]=!0;E.fic||z.PageLoadTrackingInfo.instance.yj("ReopenOnLoad");!I.isEditMode(D)&&h.a.hqb(D.errors)&&
(e.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),D.activityState[l.a.W_b]=E.ea.sessionId,D.activityState[l.a.b0b]=!0);D.Zzd();3===G?(E.ea.Ef()||E.ea.HQi(),E.oI(!0,!0),this.qh(this.pZj),D.activityState[l.a.Ipe]=E.workbookContext.CalcMode):(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===G&&E.oI(!0,!0),D.activityState[l.a.wXc]=!1,this.qh(this.kBc))}Xmi(D){e.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");D.activityState[l.a.wZa]=null;D.Zzd();this.qh(this.TPj);D=Object(f.a)(9,D.Ke);D.fic||(z.PageLoadTrackingInfo.instance.yj("RefreshOnLoad"),D.nLb())}static pM(D){D.pM()}static F7h(D){const G=Object(f.a)(9,D.Ke),E=G.ea,O=I.isEditMode(D);var N=h.a.lh(D.errors,O?I.Gzd:I.Hzd);const J=h.a.lh(D.errors,O?I.zwf:I.Awf),W=G.ZM,ea=G.Yk.reloadCount,R=G.ya.MaxConsecutiveSilentReloadAllowed,Y=G.Yk.kdf(),U=h.a.qc(D.errors),da=h.a.qc(D.kAa),
T=0<h.a.EM(wa=>!wa.triggerSilentReopenOnly,D.errors).length;let ka=N;const L=v.a.ng(D.activityState,H.a.Igb);L&&(ka=!0);const fa={name:"SessionReloadSilentActivity.GetSilentReloadType"};fa.editMode=O;fa.isSilentReopenError=N;fa.isSilentRefreshError=J;fa.reloadSequenceCount=G.Yk.hRa;fa.reloadCount=ea;fa.maxReloads=R;fa.stopSilentReloads=Y;fa.errorNames=U;fa.processedErrorNames=da;fa.isClientDirty=W;fa.errorsForSilentReopenOnly=T;fa.triggerSilentReloadAfterTokenRefresh=L;fa.IsReopenDisabled=G.FNa;N=
x.a.Ec(fa);e.ULS.sendTraceTag(21837004,0,50,N);if(!Y){if(ka&&(O?I.zJj(D):I.CJj(D)))return C.a.y$f(D,G)?3:G.FNa?2:1;if(J&&(O||!E.Acb))return 2}return 0}static JJj(D,G){for(const E of D.errors)if(-1337545025===E.MessageId||-238814601===E.MessageId)return!1;return h.a.EM(E=>!E.triggerSilentReopenOnly,D.errors).length?3!==G:!1}static eLi(D){const G=h.a.EM(E=>!E.triggerSilentReopenOnly,D.errors);for(const E of G)D.Cca(E)}static isEditMode(D){const G=Object(f.a)(9,D.Ke);return G.ea.Yb?G.Dt&&!!(G.Bd&64):
v.a.ng(D.activityState,l.a.Rr)}static CJj(D){const G=Object(f.a)(9,D.Ke),E=h.a.W3(D.errors,I.Hzd);if(u.b(E,O=>O.ForceVersionUpgrade))return!1;D=h.a.hqb(D.errors);return!G.ea.Acb||D?!0:!1}static zJj(D){D=h.a.W3(D.errors,I.Gzd);return!u.b(D,G=>G.ForceVersionUpgrade)}}I.Hzd=null;I.Gzd=null;I.Awf=null;I.zwf=null;Object(r.a)(I,"SessionReloadSilentActivity",d.a,[]);class S extends b.a{constructor(D,G){super();this.activityName=D;this.OJ=G;this.Gb()}create(){this.qb(new I(this.activityName,this.OJ,w.a.Zy,
w.a.Pi,w.a.tQb))}static la(D){D.da.Ha(143,new S(w.a.goa,w.a.I2b));D.da.Ha(144,new S(w.a.Syc,w.a.bQa));D.da.Ha(145,new S(w.a.Tyc,w.a.wGd));D.da.Ha(154,new S(w.a.leb,w.a.UO))}}Object(r.a)(S,"SessionReloadSilentActivityFactory",b.a,[]);a.d(B,"a",function(){return P});const P=()=>{c.a.Fa(D=>{n.la(D);S.la(D)})}},1260:function(r,B,a){var c=a(9);r=a(0);var b=a(228),e=a(15),f=a(87),d=a(248),h=a(325),l=a(29),k=a(14),w=a(389),n=a(93);class x extends w.a{constructor(A,z){super(A,z);this.Dqa=0;this.Hr()}get pc(){return"SharedWorkbookDialog"}get Bub(){return this.Dqa}uO(A,
z){this.Dqa=A;super.uO(A,z)}Hr(){super.Hr();this.Rb=9;const A=this.V0h();this.wc(1,k.a.instance.ga(1664));this.wc(2,k.a.instance.ga(994));this.Zl(k.a.instance.ga(702),n.a.qf(A),this.icon,this.I7)}V0h(){return String.format(k.a.instance.ga(703))}}Object(r.a)(x,"LegacySharedWorkbookDialog",w.a,[]);var m=a(6),u=a(37);class t extends d.a{constructor(A,z,C){super(A,z);this.executionContext=null;this.dEi=H=>{const I=this.Ks.kd,S=Object(f.a)(9,I.Ke);let P;P=H.Bub;this.unsubscribe(D=>{H.remove_disposing(D)});
for(let D=0,G=I.errors.length;D<G;D++)-573864504===I.errors[D].MessageId&&I.Cca(I.errors[D]);switch(P){case 1:S.ea.mEc=!0;e.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.qh(S.isEditMode?m.a.tQb:this.Gnh);this.qp();break;case 2:this.qh(m.a.openInExcelClient);this.qp();break;case 0:I.activityState[u.a.Rr]=!1,this.qh(this.UJ),this.qp()}};this.Gnh=z;this.UJ=C}initialize(A){super.initialize(A)}execute(A){this.executionContext=
A;this.V6c();return 1}RI(A){super.RI(A)}V6c(){const A=Object(f.a)(9,this.executionContext.Ke),z=l.a.r0a([-573864504]);z[0].HelpDescription=k.a.instance.ga(705);z[0].HelpTopicId=h.a.eEi;const C=new x(A,z[0]);this.subscribe(this.executionContext,this.dEi,H=>{C.add_disposing(H)})}}Object(r.a)(t,"LegacySharedWorkbookActivity",d.a,[]);class y extends b.a{constructor(A,z,C,H){super();this.activityName=A;this.OJ=z;this.UJ=C;this.$=H;this.Gb()}create(){this.qb(new t(this.activityName,this.OJ,this.UJ))}static la(A){A.da.Ha(460,
new y(m.a.qEb,m.a.Egb,A.mDb?m.a.Pj:m.a.xsb,A))}}Object(r.a)(y,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(B,"a",function(){return v});const v=()=>{c.a.Fa(y.la)}},1283:function(r,B,a){function c(z){const C=f(z);let H=[];if(0===C&&1===z.length)return H.push({destination:z[0],source:null,skc:!1}),H;for(let I=0;I<=C;I++){const S=z.filter(P=>P.Uja().topLeft.Y===I);for(let P=0;P+1<S.length;P+=1)H.push({destination:S[P],source:S[P+1],skc:!1})}x.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${H.length}`);
return H}function b(z,C){let H;const I=w.HelperMethods.wR(()=>{H=gridRenderer.CanvasRendererGlobals.hideRowCols(z,C,!1)});d("HideRowCols",I);return H}function e(z,C,H,I){z=gridRenderer.CanvasRendererGlobals.performModelCascade(z,C,H,I);z.metric&&d("ModelCascade",z.metric.sek);return z}function f(z){let C=-1;for(let H=0;H<z.length;H++){const I=z[H].Uja().topLeft.Y;I>C&&(C=I)}return C}function d(z,C){x.ULS.sendTraceTag(509723719,0,50,`GridInstantaneousAction: Time taken to complete operation=${z} is time=${C}`)}
var h=a(9);r=a(0);var l=a(228),k=a(21),w=a(11),n=a(178),x=a(15),m=a(1),u=a(62);class t{constructor(z){this.$=z;this.gridView=k.h(this.$);this.Ca=this.gridView.Ca;this.xCb=!1;this.n8c=this.$.ea.se;this.ILb={};this.N4={}}dispose(){this.gridView=this.$=null;this.N4={};this.xCb=!1;this.ILb={}}NXg(z){if(this.xCb)x.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${z}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=false`);
else{var C=this.Ca.wTh(),H=c(C);this.N4={};this.Hui(z,C,H)&&(this.xCb=!0,this.XRf(z,!1,H,C))}}Nij(){this.n8c=this.$.ea.se}Hui(z,C,H){var I=this.gridView;if(-706918724!==z||I.rtl)return!1;var S=I.gk("GridInstantaneousAction");if(!Object(u.c)(S))return x.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${z}, parameter = ActiveSheetProcessedData, value=null, isRow=false`),!1;I=I.ha.ra.selectedRanges;const P=I.length;if(1<P)return x.ULS.sendTraceTag(509658007,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${z}, parameter = SelectedRanges, value=${P}, reason = Discontinuous selection, isRow=false`),!1;if(S.value.rCb(I[0]))return x.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${z}, parameter = isPartOfRangeHidden, value=true, isRow=false`),!1;S=I[0].right-I[0].left+1;if(S>m.EwaSettings.pLi())return x.ULS.sendTraceTag(509658005,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${z}, parameter = ColumnCount, value=${S}, reason = Multiple columns selected, isRow=false`),
!1;C=C.length;if(C>m.EwaSettings.oLi())return x.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${z}, parameter = BlocksInViewport, value=${C}, reason = Blocks in viewport limit exceeded, isRow=false`),!1;a:{for(D of H){if(!D||!D.source||!D.destination){x.ULS.sendTraceTag(509649925,0,50,"GridInstantaneousAction.canRowColCascade: blockPair or sourceBlock or destinationBlock is null");var D=!1;break a}C=D.source.ae.GridBlockModel;if(!gridRenderer.CanvasRendererGlobals.canRowColCascade(C,
C.ColumnNumbers[0],!1)){D=!1;break a}}D=!0}if(!D)return x.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${z}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=false`),!1;I=I[0];D=0;for(let G of H)if(G.destination.Be.vd(I)||G.destination.Be.left>I.right)D+=1;H=D;if(H>m.EwaSettings.sLi())return x.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${z}, parameter = TransitionCount, value=${H}, reason = Transition count limit exceeded, isRow=false`),
!1;x.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${z}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=false`);return!0}XRf(z,C,H,I){try{const S=w.HelperMethods.Lb(),P=m.EwaSettings.rLi();let D=H.filter(G=>!G.skc);for(let G of D){if(this.Joe("WebServiceResponseReceivedInProcessGridAction",I,z))return;const E=this.gridView.ha.ra.selectedRanges[0],O=G.destination.Be.right;if(O<
E.left){G.skc=!0;x.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${z}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${E.left}, blockRangeRightMostValue=${O}, hashCode=${G.destination.gd}, isRow=false`);continue}const N=C?E.topLeft.top:E.topLeft.left,J=this.N2e("SourceModel",G.source),W=this.N2e("DestinationModel",G.destination),ea=G.destination.gd;if(G.destination.Be.vd(E)){if(!b(W,N)){this.rsa();x.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${z}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${ea}, isRow=${C}, rowColNumber=${N}`);
return}x.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${z}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${ea}, isRow=${C}, rowColNumber=${N}`)}const R=J.ColumnNumbers[0],Y=G.source.gd;if(e(J,W,R,C).isSuccess)G.skc=!0,x.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${z}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${Y}, isRow=${C}, rowColNumber=${R}`);
else{this.rsa();x.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${z}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${Y}, isRow=${C}, rowColNumber=${R}`);return}this.UTj(W,J,G);if(w.HelperMethods.Lb()-S>P){this.Zxj(z,C,D,I);return}}this.bah(C,z,I);d("ProcessGridAction",w.HelperMethods.Lb()-S)}catch(S){this.Ici(S)}}bah(z,C,H){if(!this.Joe("CommitGridInstantaneousActionResults",H,C)){var I=w.HelperMethods.Lb();if(this.N4&&
0!==Object.keys(this.N4).length)if(this.N$i(H),this.lug(C,H)){var S=n.a.create().toString(),P=this.gridView.gk("GridInstantaneousAction");Object(u.c)(P)?(P.value.e2d(this.gridView.ha.ra.selectedRanges,0,z),C=Object.keys(this.N4),this.Ca.eTf(C,S,z?"row":"column",!0),this.xCb=!1,d("CommitGridInstantaneousActionResults",w.HelperMethods.Lb()-I)):(this.y1f(H),this.rsa(),x.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${C}, parameter = ActiveSheetProcessedData, value=null, isRow=${z}`))}else this.y1f(H),
this.rsa();else this.rsa(),x.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${C}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${z}`)}}N2e(z,C){let H=this.N4[C.gd];if(!H){const I=w.HelperMethods.wR(()=>{H=C.cVh()});d(z,I)}return H}N$i(z){for(let C of z)z=C.gd,this.ILb[z]||(this.ILb[z]=C.J8e())}y1f(z){for(let C of z){z=C.gd;const H=this.ILb[z];if(H&&!C.t_f(H)){x.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${z}`);
this.rsa();break}}}lug(z,C){for(let H of C)if(C=H.gd,this.N4[C]&&!H.t_f(this.N4[C]))return x.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${z}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${C}, isRow=false`),!1;return!0}Zxj(z,C,H,I){window.setTimeout(()=>{this.XRf(z,C,H,I)},0)}sAi(z){for(let C of z)if(C.ae.Information.Revision>this.n8c)return!0;return!1}Joe(z,C,H){return this.sAi(C)?(this.n8c=this.$.ea.se,
this.rsa(),x.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${H}, parameter = ${z}, value=true, reason = "Server response received before completing client side estimation", isRow=false`),!0):!1}rsa(){this.N4={};this.xCb=!1;this.ILb={}}Ici(z){this.rsa();x.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${z}.`)}UTj(z,C,H){this.N4[H.destination.gd]=z;this.N4[H.source.gd]=C}}Object(r.a)(t,"GridInstantaneousAction",
null,[242]);var y=a(717);class v extends l.a{constructor(z){super();this.$=z;this.Gb()}create(){this.qb(Object(y.a)(this.$.da,528,()=>new t(this.$)))}static la(z){z.da.Ha(529,new v(z))}}Object(r.a)(v,"GridInstantaneousActionFactory",l.a,[]);a.d(B,"a",function(){return A});const A=()=>{h.a.Fa(z=>{v.la(z)})}},1284:function(r,B,a){r=a(0);var c=a(1320),b=a(1321),e=a(4);class f{constructor(){this.G9d=this.$a=null}get name(){return"Common.App.DirectPrint"}Kh(l){this.$a=l;l.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").tc().Bc(()=>
new c.a(e.AFrameworkApplication.sa.fX));l.register(423,"Common.App.DirectPrint.IDirectPrintManager").tc().Bc(()=>b.a.create(this.$a))}init(){this.G9d=this.$a.resolve("Common.App.DirectPrint.IDirectPrintManager");this.G9d.start()}dispose(){}}Object(r.a)(f,"PackageManager",null,[4,5]);var d=a(257);a.d(B,"a",function(){return h});const h=()=>{Type.registerNamespace("Common.App.DirectPrint");d.a.instance.si(new f)}},1307:function(r,B,a){r=a(0);var c=a(228),b=a(966);class e extends c.a{constructor(l){super();
this.$=l;this.Gb()}create(){this.qb(this.$.da.Ba(5)||new b.BusinessBarManager(this.$,!this.$.K4))}static la(l){l.da.Ha(4,new e(l))}}Object(r.a)(e,"BusinessBarManagerFactory",c.a,[]);var f=a(9),d=a(70);a.d(B,"a",function(){return h});const h=()=>{Object(d.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")||f.a.Fa(e.la)};String(b);window.___1678693003372_closurehack=b},1319:function(r,B,a){r=a(0);var c=a(15),b=a(88),e=a(873),f=a(858),d=a(1242);class h{constructor(){this.vIc=new d.a;this.tIc=new d.a;
this.sIc=new d.a;this.R_g(this.vIc);this.Q_g(this.tIc);this.P_g(this.sIc);this.vNc=new d.a;this.uNc=new d.a;this.tNc=new d.a;this.p2g(this.vNc);this.o2g(this.uNc);this.n2g(this.tNc);this.KJc=new d.a;this.j0g(this.KJc);this.JGa(this.KJc);this.JGa(this.sIc);this.JGa(this.tIc);this.JGa(this.vIc);this.JGa(this.uNc);this.JGa(this.vNc);this.JGa(this.tNc)}k8h(x,m){switch(x){case 1:return this.Fai(m);case 2:return this.ASh(m)}return f.a.GAc?this.KJc:null}R_g(x){x.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);
x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}Q_g(x){x.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}P_g(x){x.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
x.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}p2g(x){x.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);x.add("OverlayBig","Get the Word app");x.add("OverlaySmall",
"Built for the iPad\u2014for when you're working on the go, even offline.");x.add("OverlaySmallSplit1","Discover Word");x.add("OverlaySmallSplit2","designed for the iPad.");x.add("SkipButton","Skip for now")}j0g(x){x.add("Headline","Get the Office Online extension for Chrome");x.add("UseAppButton","Get the extension");x.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}o2g(x){x.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);x.add("OverlayBig","Get the PowerPoint app");x.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");x.add("OverlaySmallSplit1","Discover PowerPoint");x.add("OverlaySmallSplit2","designed for the iPad.");x.add("SkipButton","Skip for now")}n2g(x){x.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}JGa(x){x.add("Corporation","Microsoft Corporation")}Fai(x){switch(x){case 3:return this.vNc;case 2:return this.uNc;case 1:return this.tNc}return null}ASh(x){switch(x){case 3:return this.vIc;
case 2:return this.tIc;case 1:return this.sIc}return null}static get instance(){h.Ma||(h.Ma=new h);return h.Ma}}h.Ma=null;Object(r.a)(h,"WildFireStringFactory",null,[]);var l=a(4),k=a(41),w=a(27);a.d(B,"a",function(){return n});class n{constructor(x,m,u,t,y=null,v=null){this.LRc=null;this._id=x;this.uSc=m;this.CAg=y;this.Tkb=t;this.gnb=v;this.bqa=null;this.bZa=u;this.Gnb=h.instance.k8h(m,x)}M6c(){this.bqa=new e.a(this.title,this.message,null);this.bqa.addButton(this.IAe,Object(b.a)(this,this.ECf,
"onButtonOneClick"),"");this.bZa&&this.bqa.CNg(this.KAe,Object(b.a)(this,this.HCf,"onButtonTwoClick"));this.bqa.N$=Object(b.a)(this,this.wOe,"dismissBar");this.bqa.image=3;this.bqa.id=16;this.bqa.closeable=!0}get title(){return this.Gnb.ma("Headline")}get message(){return this.Gnb.ma("CallToAction")}get o8j(){return this.bZa}get IAe(){return this.bZa?this.Gnb.ma("InstallButton"):this.Gnb.ma("UseAppButton")}get KAe(){return this.bZa?this.Gnb.ma("OpenAppButton"):""}ECf(){this.bZa?this.Dni():this.d8j()}HCf(){this.bZa&&
this.o6i()}get s2g(){return this.bqa}get openUrl(){this.LRc||(this.LRc=this.CAg());return this.LRc}Dni(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Tkb&&this.gnb&&this.gnb();f.a.SVf(this._id,this.uSc)}o6i(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Tkb&&this.gnb&&this.gnb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.Bve(this._id),this.openUrl,0,!1))}d8j(){f.a.GAc?this.v2g():(c.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),f.a.VTd("BizBarClicked"),1!==this.uSc&&2!==this.uSc||f.a.X8g(this.openUrl,this.Tkb,this._id,this.gnb))}v2g(){this.Tkb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");k.a.TU(l.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Mqh(){this.Tkb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.VTd(f.a.XDe)}wOe(){f.a.GAc?
this.Mqh():(f.a.VTd(f.a.wgd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static o7b(){const x=l.AFrameworkApplication.sa.Qa,m=new n(x.ri,f.a.Uec(),8<w.a.C6a,1===x.Nca,()=>x.Kx,x.p3f());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return m}}Object(r.a)(n,"WildFireBusinessBar",null,[])},1320:function(r,B,a){r=a(0);var c=a(15),b=a(88),e=a(141),f=a(4),d=a(13),h=a(100),l=a(47),k=a(192),w=a(1107),n=a(92),x=a(57),m=a(82),u=a(962);class t extends e.StandardDialog{constructor(v,
A,z,C=null){super();this.rP=this.om=this.Pqa=null;this.jn=[];this.sXb=A;this.nP=v;this.WAg=z;this.FYb=C;this.Fnb=new u.a("LoadResource","LoadPrintablePdf")}hQ(){this.Rb=5;this.width=40;const v=document.createElement("span");v.id=this.Oh("DirectPrintHeaderContent");const A=document.createElement("span");A.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(A,"DirectPrintHeader");this.rP=document.createElement("iframe");this.rP.name="pdfObjectFrame";this.rP.title=CommonUIStrings.l_DirectPrintDialogIFrame;
this.rP.onload=Object(b.a)(this,this.Dcj,"printablePdfLoaded");if(this.FYb&&0<this.FYb.count){var z=m.a.Bjd(this.sXb,this.FYb);const C=m.a.aNd(this.sXb,this.FYb);this.om=document.createElement("form");this.om.id="printPreviewPostForm";this.om.method="POST";this.om.target=this.rP.name;this.om.action=C;for(let H of z)z=document.createElement("input"),z.type="hidden",z.name=H.key,z.value=H.value,this.om.appendChild(z)}else this.rP.setAttribute("src",this.sXb);Sys.UI.DomElement.addCssClass(this.rP,k.a.ehe);
this.WAg?(Sys.UI.DomElement.addCssClass(this.rP,"DirectPrintPdfObjectHidden"),A.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,n.a.xh(this.rP,n.a.kC,n.a.$j)):(Sys.UI.DomElement.addCssClass(this.rP,"DirectPrintPdfObject"),this.jn.push(this.rP));v.appendChild(A);v.appendChild(document.createElement("br"));v.appendChild(this.rP);this.om&&v.appendChild(this.om);v.appendChild(document.createElement("br"));v.appendChild(this.Ibh(this.om?"#":this.sXb));this.Fnb.start();this.zFb(CommonUIStrings.l_AppTitle,
null,null,null,null,v);this.VW(this.Oh("DirectPrintHeaderContent"));this.om&&this.om.submit();this.Lgh();c.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}Ibh(v){const A=document.createElement("span");var z=document.createElement("span");z.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;A.appendChild(z);f.AFrameworkApplication.fa&&(2===f.AFrameworkApplication.sa.Qa.ri&&f.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.sa.Qa.ri&&
f.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(v=document.createElement("span"),2===f.AFrameworkApplication.sa.Qa.ri?v.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.sa.Qa.ri&&(v.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Pqa=v,A.appendChild(document.createElement("br")),A.appendChild(v)):(z=document.createElement("a"),z.innerText=
CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,z.href=v,z.target="_blank",z.id="PrintPDFLink",z.className="AllowBrowserClick",this.Pqa=z,A.appendChild(document.createElement("br")),A.appendChild(z),this.om&&l.a.addHandler(z,"click",Object(b.a)(this,this.Jrc,"onSubmit")),this.nP.ta(d.a.click,this.Pqa,Object(b.a)(this,this.FPe,"downloadPDFLinkClicked"),null));this.jn.push(this.Pqa);return A}Jrc(v){this.om&&(this.om.target="_blank",this.om.submit());v.preventDefault()}Lgh(){if(0<this.jn.length){const v=
new w.a(this.jn),A=h.FocusManager.instance().BQ();A&&(this.Pqa.focus(),A.lf=v,A.r_=!0)}}FPe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}Xxd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}Dcj(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Fnb&&this.Fnb.stop()}dispose(){this.Pqa&&(this.nP.Aa(d.a.click,this.Pqa,Object(b.a)(this,this.FPe,"downloadPDFLinkClicked")),this.Pqa=null);
x.a.i0(this.rP);this.rP=null;super.dispose()}}Object(r.a)(t,"DirectPrintDialog",e.StandardDialog,[440]);a.d(B,"a",function(){return y});class y{constructor(v){this.nP=v}rXh(v,A){return new t(this.nP,v,A,null)}}Object(r.a)(y,"DirectPrintDialogFactory",null,[426])},1321:function(r,B,a){r=a(0);var c=a(15),b=a(558),e=a(88),f=a(1377),d=a(1108);class h{constructor(m,u){this.Jfg=m;this.$Ta=u}}Object(r.a)(h,"DirectPrintProbeResults",null,[]);var l=a(4),k=a(274),w=a(27),n=a(115);a.d(B,"a",function(){return x});
class x{constructor(m,u,t,y,v,A,z,C,H,I){this.$Zb=null;this.Myg=m;this.amb=u;this.lRc=t;this.bCg=y;this.GCg=v;this.GSc=new b.a(Object(e.a)(this,this.E4h,"getProbeResults"));this.qWa=A;this.Wee=H;this.HHg=z;this.HCg=C;this.OCg=I}get LC(){return this.Myg}start(){}Oej(){const m=Array(this.LC.ZTa.length);if(void 0!==this.amb&&null!==this.amb)for(let u=0;u<this.LC.ZTa.length;u++)m[u]=this.LC.ZTa[u]in this.amb&&this.bCg(this.amb[this.LC.ZTa[u]]);return m}Pej(){const m=Array(this.LC.$Ta.length),u=!(void 0===
this.lRc||null===this.lRc);for(let t=0;t<this.LC.$Ta.length;t++){const y=this.LC.$Ta[t];m[t]=u&&y in this.lRc?!0:this.GCg(y)}return m}y8h(){const m=this.Oej(),u=Array(m.length);for(let t=0;t<m.length;t++)u[t]=m[t]?this.EIh(this.amb[this.LC.ZTa[t]]):null;return u}EIh(m){if(void 0===m||null===m)return null;m=m.enabledPlugin;return void 0===m||null===m?null:m.name}E4h(){var m=this.y8h();const u=this.Pej(),t={},y={};for(let v=0;v<this.LC.ZTa.length;v++)t[this.LC.ZTa[v]]=m[v];for(m=0;m<this.LC.$Ta.length;m++)y[this.LC.$Ta[m]]=
u[m];return new h(t,y)}GMj(){return this.OCg||!this.LC.isEnabled||l.AFrameworkApplication.isUnifiedHostMode?!1:this.KUj()}Qag(){if(null!=this.$Zb)return this.$Zb;const m=x.mkf(this.LC);return this.$Zb=this.LC.nkf&&m||this.cri()}cri(){return w.a.kp&&this.LC.eri&&w.a.ZDe>=this.LC.M7g?!0:!1}KUj(){if(!this.HCg(this.LC))return!1;var m=n.a.kld(this.GSc.value.Jfg);for(const u of m)if(void 0!==u&&null!==u)return!0;m=n.a.kld(this.GSc.value.$Ta);for(const u of m)if(u)return!0;return!1}sfi(){const m=n.a.kld(this.GSc.value.Jfg);
for(const u of m)if(k.a.contains(this.LC.Gii,u))return!0;return!1}TOj(m){l.AFrameworkApplication.sa&&l.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?this.Wee(m,null):this.GMj()?this.drh(m,this.sfi()&&!0):this.Wee(m,null)}drh(m,u){const t=this.HHg.Kc("UserAction","OpenDirectPrintDialog");this.qWa.rXh(m,u).hQ();t.stop()}static Tof(m){try{return new ActiveXObject(m),!0}catch(u){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",m)}return!1}static okf(m){return void 0===
m||null===m?!1:!(void 0===m.enabledPlugin||null===m.enabledPlugin)}static create(m){const u=new d.a(l.AFrameworkApplication.fa.appSettings);let t=null;try{t=window.navigator.mimeTypes}catch(I){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let y=null;try{y=window.navigator.plugins}catch(I){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const v=x.okf,A=x.Tof;m=m.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const z=l.AFrameworkApplication.sa.SD,
C=x.Uof,H=!!l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Qa.Fv&&!l.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");return new x(u,t,y,v,A,m,z,C,(I,S)=>new f.a(I,!1,S,!0,H),l.AFrameworkApplication.V4)}static Uof(m){return w.a.kp||w.a.Dv&&m.Kui||m.nkf&&x.mkf(m)?!0:!1}static mkf(m){var u=w.a.evb;if(u){var t=u.split(".");if(2===t.length)return u=parseInt(t[0]),t=parseInt(t[1]),u>m.PAd||u===m.PAd&&t>=m.nyf}return!1}}Object(r.a)(x,"DirectPrintManager",null,[423])},1372:function(r,
B,a){a.d(B,"a",function(){return k});r=a(0);var c=a(88);B=a(141);var b=a(1096),e=a(270),f=a(4),d=a(13),h=a(82),l=a(27);class k extends B.StandardDialog{constructor(w,n=!0,x=!1,m=null,u=null,t=!1){super();this.OWa=this.NWa=this.om=this.VX=null;var y=this.j_d?this.j_d:CommonUIStrings.l_DefaultDialogTitle;k.r6a=t;this.pUb=m||new b.a(w,!0);this.pUb.Mxe(this);const v=[],A=[];k.Su&&(this.xZc&&this.xZc.forEach(H=>{Array.add(v,H)}),this.Ste&&this.Ste.forEach(H=>{Array.add(A,H)}));n?x?(this.Rb=4,this.wc(1,
this.buttonText),this.wc(2,CommonUIStrings.l_DialogClose)):(this.Rb=6,this.wc(0,CommonUIStrings.l_DialogClose)):this.Rb=5;t=document.createElement("span");this.f8c&&(t.className=this.f8c);m=document.createElement("a");m.innerText=this.Hmc;m.href=w;m.target="_blank";m.id=this.Gmc;m.className=e.AFrame.Cue;var z=!l.a.cB&&!!u&&0<u.count;if(z){const H=h.a.Bjd(w,u);u=h.a.aNd(w,u);m.href="#";m.target="_self";this.om=document.createElement("form");this.om.id="printPreviewPostForm1";this.om.method="post";
this.om.target="_blank";this.om.action=u;for(var C of H)u=document.createElement("input"),u.type="hidden",u.name=C.key,u.value=C.value,this.om.appendChild(u)}else this.om=null;this.om||k.r6a?k.r6a||Array.add(A,{["type"]:"AppLinkProps",["id"]:this.Gmc,["text"]:this.Hmc,["onExecute"]:()=>{this.nUf()}}):Array.add(A,{["type"]:"AppLinkProps",["id"]:this.Gmc,["text"]:this.Hmc,["handler"]:{["href"]:z?"#":w,["target"]:z?"_self":"_blank"}});this.ZOa&&Array.add(v,this.ZOa);x?(w=document.createElement("span"),
w.innerText=this.ZOa.replace("{0}",""),t.appendChild(w)):this.dyf?(w=document.createElement("span"),w.id=this.Oh("message"),C=document.createElement("span"),u=document.createElement("span"),z=this.ZOa.split("{0}"),C.innerText=z[0],u.innerText=z[1],w.appendChild(C),w.appendChild(m),w.appendChild(u),t.appendChild(w)):(w=document.createElement("span"),w.innerText=this.ZOa,t.appendChild(w),t.appendChild(document.createElement("br")),t.appendChild(document.createElement("br")),t.appendChild(m),k.r6a||
Array.add(v,"{0}"));this.om&&t.appendChild(this.om);k.Su&&(this.F9a&&(this.mEb?this.yqe(this.F9a,this.mEb):(Array.add(v,"{0}"),Array.add(A,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.F9a,["onExecute"]:()=>{this.Amc()}}))),this.ysa(v,A));this.zFb(y,null,this.zff,null,Object(c.a)(this,this.ru,"dialogHandler"),k.Su?null:t);this.VW(this.Oh("message"));!k.Su&&this.mEb&&this.F9a&&(y=document.createElement("div"),y.className="WACDialogLearnMoreLinkContainer",this.VX=document.createElement("a"),
this.VX.innerText=this.F9a,this.VX.href=this.mEb,this.VX.target="_blank",this.VX.id=this.Oh("LearnMoreLinkId"),this.VX.className=e.AFrame.Cue,y.appendChild(this.VX),n?this.ib.insertBefore(y,this.ib.lastChild):this.ib.appendChild(y),this.VW(String.format("{0} {1}",this.Oh("message"),this.Oh("LearnMoreLinkId"))));this.Gjb=m;x?this.DI(this.SB):this.DI(this.Gjb);this.Mtf();f.AFrameworkApplication.sa.fX.ta(d.a.click,this.Gjb,Object(c.a)(this,this.DPe,"downloadLinkClicked"),null);this.VX&&f.AFrameworkApplication.sa.fX.ta(d.a.click,
this.VX,Object(c.a)(this,this.Amc,"learnMoreLinkClicked"),null);this.oUb=!1}get zff(){return null}get j_d(){return null}get ZOa(){return null}get mEb(){return null}get F9a(){return null}get dyf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get f8c(){return null}get xZc(){return null}get Ste(){return null}X_c(){this.om&&(this.NWa||(this.NWa=Object(c.a)(this,this.dSi,"onActionButtonClicked"),this.Iy.ta(d.a.click,this.SB,this.NWa)),this.OWa||(this.OWa=Object(c.a)(this,this.eSi,"onActionButtonKeyUp"),
this.fe.ta(d.a.Qd,this.SB,this.OWa)));super.X_c()}dSi(w){this.OXe(w);return!0}eSi(w){return this.Nqf(w,Object(c.a)(this,this.OXe,"executeDismissActionButtonFromArgs"))}OXe(w){this.om&&this.om.submit();this.eva(w.Ob)}Xxd(){}DPe(){this.Otf();this.om?this.om.submit():this.pUb.p$c();return!0}Amc(){return!1}dispose(){this.pUb.dispose();this.Gjb&&(f.AFrameworkApplication.sa.fX.Aa(d.a.click,this.Gjb,Object(c.a)(this,this.DPe,"downloadLinkClicked")),this.Gjb=null);this.VX&&(f.AFrameworkApplication.sa.fX.Aa(d.a.click,
this.VX,Object(c.a)(this,this.Amc,"learnMoreLinkClicked")),this.VX=null);this.Iy&&this.NWa&&(this.Iy.Aa(d.a.click,this.SB,this.NWa),this.NWa=null);this.fe&&this.OWa&&(this.fe.Aa(d.a.Qd,this.SB,this.OWa),this.OWa=null);super.dispose()}nUf(){this.om&&(document.body.appendChild(this.om),this.om.submit(),document.body.removeChild(this.om))}ru(w){1===w&&(this.Xxd(),this.om?k.Su&&this.nUf():this.pUb.p$c());this.dispose()}static get Su(){return f.AFrameworkApplication.sa.Qa.Fv&&f.AFrameworkApplication.sa.Qa.Cnf}static get r6a(){return k.mbe}static set r6a(w){k.mbe=
w}}k.mbe=!1;Object(r.a)(k,"ADialogWithLinkToResource",B.StandardDialog,[])},1373:function(r,B,a){a.r(B);a.d(B,"ReactOICErrorDialogWithTrial",function(){return f});r=a(0);var c=a(88);B=a(1098);var b=a(426),e=a(156);class f extends B.a{constructor(d,h,l,k,w,n){super(d,h,l,k,w,n);h={["errorMessage"]:this.zSe,["offerString"]:this.YAf};d=new e.a(!1,!1,!0);this.Cbg?(d.Rb=1,h.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Mwa,["onExecute"]:()=>{b.Redirect.showHelp(this.Xdf)}}):(d.Rb=4,
d.wc(2,this.tff));d.wc(1,this.t_b);d.we=this.id;h={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:h};d.initializeAndShow(this.ll,Object(c.a)(this,this.nhj,"reactOICErrorDialogWithTrialHandler"),h)}}Object(r.a)(f,"ReactOICErrorDialogWithTrial",B.a,[])},1374:function(r,B,a){a.r(B);a.d(B,"OICErrorDialogWithTrial",function(){return e});r=a(0);var c=a(88);B=a(1098);var b=a(141);class e extends B.a{constructor(f,d,h,l,k,w){super(f,d,h,l,k,w);f=document.createElement("span");f.innerText=this.zSe;
f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));d=document.createElement("span");d.innerText=this.YAf;f.appendChild(d);d=new b.StandardDialog;this.Cbg?(d.Rb=1,d.Iqe(this.Mwa,this.Xdf)):(d.Rb=4,d.wc(2,this.tff));d.wc(1,this.t_b);d.we=this.id;d.Zl(this.ll,null,this.icon,Object(c.a)(this,this.$Di,"legacyOICErrorDialogWithTrialHandler"),f)}}Object(r.a)(e,"OICErrorDialogWithTrial",B.a,[])},1375:function(r,B,a){a.r(B);a.d(B,"CheckRoamingRightsRequest",function(){return c});
r=a(0);a=a(1099);class c extends a.a{constructor(){super()}Ayb(){return 2}gba(){return 1}}Object(r.a)(c,"CheckRoamingRightsRequest",a.a,[])},1376:function(r,B,a){a.r(B);a.d(B,"GetRoamingLauncherRequest",function(){return c});r=a(0);a=a(1099);class c extends a.a{constructor(){super()}Ayb(){return 0}gba(){return 2}}Object(r.a)(c,"GetRoamingLauncherRequest",a.a,[])},1377:function(r,B,a){a.d(B,"a",function(){return k});r=a(0);var c=a(15),b=a(1372),e=a(1096),f=a(4),d=a(92),h=a(82),l=a(27);class k extends b.a{constructor(w,
n,x=null,m=!0,u=!1){super(w,!0,!(k.QCa&&m),new e.a(w,n),x,u);k.QCa=k.QCa&&m;if(k.QCa){n=document.createElement("iframe");m=null;u=this.aqh;n.name="pdfObjectFrame";n.id="pdfObjectIFrame";if(x&&0<x.count){const t=h.a.Bjd(w,x);w=h.a.aNd(w,x);m=document.createElement("form");m.id="printPreviewPostForm";m.method="POST";m.target=n.name;m.action=w;for(let y of t)w=document.createElement("input"),w.type="hidden",w.name=y.key,w.value=y.value,m.appendChild(w)}else n.src=w;u.appendChild(n);m&&(u.appendChild(m),
m.submit());Sys.UI.DomElement.addCssClass(n,"DirectPrintPdfObjectHidden");d.a.xh(n,d.a.kC,d.a.$j)}}get zff(){return"Print_32x32x32"}get j_d(){return k.QCa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get ZOa(){return k.QCa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get xZc(){const w=[];Array.add(w,CommonUIStrings.l_PrintDialogCanCloseDocument);if(b.a.r6a){let n=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.sa.Qa.PLe&&(n=f.AFrameworkApplication.sa.Qa.PLe);
Array.add(w,n)}return k.QCa?w:null}get Hmc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Gmc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get f8c(){return f.AFrameworkApplication.MNe?"UIFontDialogTextLarge":null}Mtf(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Otf(){f.AFrameworkApplication.Kn.xAb(9540);c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Xxd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get QCa(){return!!f.AFrameworkApplication.sa&&
f.AFrameworkApplication.sa.Qa.Fv&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(l.a.cB||l.a.Dv||l.a.Ff||l.a.JNa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set QCa(w){}}Object(r.a)(k,"PrintDialogWithLinkToPdf",b.a,[])},1394:function(r,B,a){r=a(0);var c=a(88),b=a(40);class e{constructor(){this.classId=0}static tJa(k){try{return b.a(k)}catch(w){}return null}}Object(r.a)(e,"ARoamingAppsResponse",
null,[]);class f{constructor(){this.state=this.callback=null;this.Yrd=!1}}Object(r.a)(f,"GetRoamingAppsLauncherContext",null,[]);var d=a(4),h=a(112);a.d(B,"a",function(){return l});class l{constructor(k){this.IJc=!1;this.nYa=l.mhc;this.xTc=this.xRc=0;this.platform=null;this.iGg=k;this.Wne=this.yTc=!1}get roamingAppsAreEnabled(){return this.iGg}get A8j(){return this.roamingAppsAreEnabled&&this.yTc?this.Wne:!1}z7g(){d.AFrameworkApplication.bkc&&this.roamingAppsAreEnabled&&!this.yTc&&!this.IJc&&(this.xTc=
1,this.IJc=!0,this.vtj(),this.LXe())}vtj(){this.nYa=l.mhc;this.xRc=0}getRoamingAppsLauncher(k,w,n){this.A8j?(k=new f,k.callback=w,k.state=n,k.Yrd=!0,this.RXe(k)):w(!1,"",n)}LXe(){const k=new (a(1375).CheckRoamingRightsRequest);k.RoamingApp=this.xTc;k.BaseDocQuerySignature=d.AFrameworkApplication.xi;k.execute(Object(c.a)(this,this.B7g,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.A7g,"checkUserRoamingRightsFailed"),null)}B7g(k){d.AFrameworkApplication.ug||((k=e.tJa(k.data.me))?this.XTd(k.HasRights):
this.XTd(!1))}A7g(){if(!d.AFrameworkApplication.ug)if(this.xRc>=l.QLi)this.XTd(!1);else{var k=new h.a(2,1,this.nYa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);d.AFrameworkApplication.ti.ig(k);this.xRc++;this.nYa*=l.Suj;this.nYa>l.xxf&&(this.nYa=l.xxf)}}XTd(k){this.Wne=k;this.yTc=!0;this.IJc=!1}retryCheckUserRoamingRights(){this.LXe()}RXe(k){const w=new (a(1376).GetRoamingLauncherRequest);w.RoamingApp=this.xTc;w.BaseDocQuerySignature=d.AFrameworkApplication.xi;
w.execute(Object(c.a)(this,this.k6h,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.j6h,"getRoamingAppsLauncherFailed"),k)}k6h(k){if(!d.AFrameworkApplication.ug){var w=e.tJa(k.data.me);k=k.data.state;w?(this.platform=w.Platform,k.callback(!0,w.Launcher,k.state)):k.callback(!1,"",k.state)}}j6h(k){if(!d.AFrameworkApplication.ug){var w=k.data.state;5===k.data.status&&w.Yrd?(w.Yrd=!1,this.RXe(w)):w.callback(!1,"",w.state)}}static get instance(){return l.eC||(l.eC=new l(d.AFrameworkApplication.sWg))}}
l.mhc=1E3;l.Suj=5;l.xxf=12E5;l.QLi=5;l.eC=null;Object(r.a)(l,"RoamingAppsManager",null,[])},1468:function(r,B,a){a.r(B);var c={};a.r(c);a.d(c,"SheetOptionsToggleCommandHandler",function(){return Ue});var b={};a.r(b);a.d(b,"TryOfficeThroughTellMeCommandHandler",function(){return pf});var e={};a.r(e);a.d(e,"NamedSheetViewPublic",function(){return Rb});var f={};a.r(f);a.d(f,"NamedSheetViewTeachingCallout",function(){return Kf});var d=a(1081),h=a(0),l=a(257);class k{get name(){return"Common.App.DialogWithLinkToResource"}Kh(){}init(){}dispose(){}static main(){l.a.instance.si(new k)}}
Object(h.a)(k,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var w=a(558),n=a(15),x=a(88),m=a(197),u=a(832),t=a(31),y=a(139);class v{static vvh(Ha){return v.tAe("New",Ha)}static wvh(Ha){return v.tAe("Open",Ha)}static cAe(Ha,yb){return v.Iha("LoadingMenuSection",v.yFi,Ha,v.nrb("lblLoading",yb))}static orb(Ha,yb,Xb=null,wc=null){return v.Iha("MessageMenuSection",v.Lyf,yb,v.nrb("lblMessage",Ha,Xb,wc))}static d1g(Ha){return v.cAe(Ha,CommonUIStrings.l_VoicedLoadingText)}static e1g(Ha,yb){return v.orb(CommonUIStrings.l_NewCreationLocationMessage,
Ha.Bi,yb.ER,yb.Soa)}static c1g(Ha,yb){return v.orb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,yb.Soa,"\n\n"),Ha.Bi)}static eAe(Ha){return v.orb(CommonUIStrings.l_NewGenericErrorMessage,Ha.Bi)}static a1g(Ha,yb,Xb){return v.Iha("menuNewBlank",v.bgi,Xb?Ha.Bi:null,v.jrb(Ha.Hdf,Ha.Idf,Ha.Jdf,null,Ha.Rka,Ha.jAb,yb,"blank"))}static a2g(){return v.nrb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static qAe(){return v.nrb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static b2g(Ha,
yb){return v.Iha("menuNewTemplates",Ha,null,yb)}static Z0g(Ha,yb){return v.Iha("menuNewMoreTemplates",v.m0e,null,v.jrb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,Ha,yb))}static b0g(Ha,yb,Xb){let wc="";Xb&&yb&&(wc=v.Iha("BrowseMoreMenuSection",v.m0e,null,v.jrb("btnBrowseMore",yb,yb,null,null,null,Ha||"1959943459",Xb)));return wc}static nrb(Ha,yb,Xb=null,wc=null){let Vc=wc;yb&&0<yb.length&&(Vc=v.Izf.Usc(yb).trimEnd(),Vc=0<=Vc.indexOf("{0}")?
String.format(Vc,wc):String.format("{0} {1}",Vc,wc));Xb=Xb&&wc?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',t.a.df(Xb),t.a.df(wc),t.a.df(Vc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',t.a.df(Ha||""),v.Izf.Usc(t.a.df(yb||"")),Xb)}static jrb(Ha,yb,Xb,wc,Vc,yd,Od,be){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
t.a.df(Ha||""),t.a.df(yb||""),t.a.df(Xb||""),wc||"32by32",t.a.df(Vc||""),t.a.df(yd||""),Od,t.a.df(be||""))}static tAe(Ha,yb){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',Ha,yb)}static Iha(Ha,yb,Xb,wc){Xb=Xb?String.format('Title="{0}"',t.a.df(Xb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
t.a.df(Ha||""),t.a.df(yb||""),Xb,wc)}}v.Lyf="MenuMru";v.yFi="MenuLoading";v.bgi="MenuHeader";v.m0e="MenuFooter";v.Izf=y.a.Px("\n","&#10;");Object(h.a)(v,"NewAndOpenXmlUtilities",null,[]);var A=a(4),z=a(102),C=a(150),H=a(140);class I{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(h.a)(I,"HostInformation",null,[]);var S=a(112),P=a(107),D=a(41),G=a(274),E=a(381),O=a(172),N=a(657),J=a(581),W=a(111),ea=a(25);class R{constructor(Ha,yb,Xb,wc,Vc,yd){this.EZb=this.Qo=
this.hTb=null;this.bZb=this.JUc=!1;this.Vfe=0;this.zUc=this.UOc=!1;this.W1=Ha;this.bkb=yb;this.HEa=new w.a(()=>new u.a(Xb.value,Object(x.a)(this,this.jyb,"getMoreInfoEventReceived")));this.NDg=wc;this.Ara=Vc;this.YGg=yd;this.unb=this.EAc;2===this.KK.Ica&&(this.zUc=!0);A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.lJh()}get zP(){switch(this.KK.Ica){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";
case 5:return"VisioWAC"}return null}lJh(){P.a.instance.ig(new S.a(5,1,0,()=>{this.getTemplateListJson()}))}Hg(){const Ha=this.KK.D$a;Ha.Qb(ea.a.newDocument,W.a.frame,Object(x.a)(this,this.newDocument,"newDocument"));Ha.Qb(ea.a.ntc,W.a.frame,Object(x.a)(this,this.ntc,"populateNewMenu"))}newDocument(Ha,yb,Xb,wc,Vc){if(1===Xb)return 32;if(2===Xb&&Vc){if(A.AFrameworkApplication.fa.qa("BackstagePremiumTemplateExperienceEnabled")&&Vc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),
A.AFrameworkApplication.rb.processAction(ea.a.sbj,2);if(Vc.MenuItemId&&Vc.SourceControlId)return"NewDocumentHome"===Vc.SourceControlId&&C.a("NewDocumentFromHomeTab"),this.Y1a(Vc.MenuItemId,Vc.SourceControlId)}return 8}Y1a(Ha,yb){var Xb=this.Voc.z7c;if(null===Xb)return 8;var wc=A.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(A.AFrameworkApplication.eca&&wc){n.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
const Vc={};Vc[E.a.Sgg]=Ha;Vc[E.a.zP]=this.zP;Vc[E.a.lcid]=A.AFrameworkApplication.lcid.toString();Vc[E.a.reason]=N.a.createNew;A.AFrameworkApplication.JQ().execute(yd=>{yd.uj(O.a.Y1a,Vc)})}else wc=(new Date).getTime(),yb=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Xb,t.a.pf(this.tma),t.a.pf(Ha),t.a.pf(this.zP),t.a.pf(A.AFrameworkApplication.lcid.toString()),t.a.pf(wc.toString()),t.a.pf(yb),t.a.pf(A.AFrameworkApplication.canary),
A.AFrameworkApplication.xi),(Xb=A.AFrameworkApplication.fa.Wa("ScenarioId"))&&""!==Xb&&(yb+="&wdscenarioid="+t.a.pf(Xb)),yb+="&"+A.AFrameworkApplication.wec(),A.AFrameworkApplication.Hxa&&(yb+="&"+A.AFrameworkApplication.Rdc()),(Xb=this.Qo?this.Qo.ER:null)&&(yb+="&DestinationUrl="+t.a.pf(Xb)),D.a.nf(yb,"_blank",void 0,"CreateNewDocument");2===this.KK.Ica&&n.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:J.a[this.KK.Ica],["Template"]:Ha});return 32}TIi(Ha){let yb=
Number.MAX_VALUE,Xb=Number.MIN_VALUE;const wc=window.performance;if(wc&&"undefined"!==typeof wc.getEntriesByName){for(let yd=0;yd<Ha.length;yd++){var Vc=wc.getEntriesByName(Ha[yd]);Vc&&0<Vc.length&&(Vc=Vc[0],yb=Math.min(parseInt(String(Vc.fetchStart)),yb),Xb=Math.max(parseInt(String(Vc.responseEnd)),Xb))}Xb>yb&&n.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Xb-yb,["MinFetchStart"]:yb,["MaxResponseEnd"]:Xb})}}ntc(Ha,yb,Xb,wc,Vc){if(1===Xb)return this.zUc&&
(A.AFrameworkApplication.pN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.zUc=!1),32;2!==Xb||this.UOc||(this.Vfe=(new Date).getTime(),n.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.EAc,["CachedNewMenuXmlExists"]:!!this.hTb,["ShouldCallGetMoreInfo"]:this.KK.supportsGetMoreInfoForPersonalStorage}));A.AFrameworkApplication.yya("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");A.AFrameworkApplication.yya("WordConsumerTemplates-tf;WordConsumerTemplates-cf");
return this.iaj(Vc)}iaj(Ha){Ha&&(this.hTb?Ha.PopulationXML=this.hTb:(this.KK.supportsGetMoreInfoForPersonalStorage&&!this.Qo&&this.xPi.HZ("Opened New menu",!0),Ha.PopulationXML=this.pRh(this.getTemplateListJson())));return 32}Hnf(){return!this.KK.supportsGetMoreInfoForPersonalStorage||!!this.Qo&&3===this.Qo.state&&!!this.Qo.Soa&&!!this.Qo.ER}oxi(){return A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Qa.e_?!0:this.Hnf()}getTemplateListJson(){if(!this.EAc||!this.oxi())return null;if(this.unb&&
!this.bZb){var Ha="9";A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(Ha="21");const yb=A.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in yb&&(Ha=yb.NumberOfTemplatesInBackstage);let Xb=this.zP;"TemplateCollectionId"in yb&&(Xb=yb.TemplateCollectionId);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(Xb="WordConsumerWAC",Ha="23");
Ha=String.format(this.KK.C_+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",t.a.pf(A.AFrameworkApplication.lcid.toString()),t.a.pf(Xb),Ha);Boolean.parse(yb.AppendOriginQueryParam||"false")&&(Ha+="&org=backstage");Boolean.parse(yb.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in yb&&(Ha+="&templateTier="+yb.TemplateTier);Ha+="&"+A.AFrameworkApplication.wec();A.AFrameworkApplication.Hxa&&(Ha+="&"+A.AFrameworkApplication.Rdc());this.KK.bGb.Mm(Ha,1,null,null,!1,2,wc=>{this.KK.FOa("CreateNewActor.GetTemplateListJson",
wc.data);this.sWj(wc.data.me)},wc=>{this.KK.FOa("CreateNewActor.GetTemplateListJson",wc.data);this.rWj()},null,void 0,void 0,void 0,void 0,"5");this.unb=!1}return this.EZb}sWj(Ha){A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.EZb=this.oKh(Ha):this.EZb=Ha;this.unb=!1;this.bKb();if(A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Qa.e_&&H.c()){Ha=A.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
const yb=A.AFrameworkApplication.eca;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.EZb,!0,Ha&&yb))}}rWj(){this.bZb=this.unb=!0;this.bKb();A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Qa.e_&&H.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));z.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}oKh(Ha){Ha=JSON.parse(Ha);const yb=new m.a;yb.add("TM00002102");yb.add("TM00002101");
yb.add("TM16392939");const Xb=G.a.Y3d(Ha,wc=>yb.contains(wc.AssetId));Ha=Ha.slice(0,9);Ha.splice.apply(Ha,[2,0].concat(Xb));return JSON.stringify(Ha)}i9h(Ha){var yb=0;for(var Xb=0;Xb<Ha.length;Xb++)if("ST"===Ha[Xb].ImageType){yb=Xb;break}const wc=Ha.length?Ha[yb]:null;Ha=wc?wc.Url||"":"";var Vc;let yd=Xb=yb=!1;if(wc&&(Vc=wc.AspectRatio))Vc=parseFloat(Vc),1>Vc?yb=!0:1.5<Vc?Xb=!0:1===Vc&&(yd=!0);else switch(n.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:Ha}),this.KK.Ica){case 3:yb=
!0;break;case 2:Xb=!0;break;case 5:yd=!0}return{returnValue:Ha,Aii:yb?"95by123":Xb?"123by69":yd?"100by100":"123by95"}}pRh(Ha){Ha=({iAc:yb}=this.b1g(Ha,this.Voc,this.Voc.NHa||"1056925771")).returnValue;if(yb){this.hTb=Ha;var yb=(new Date).getTime()-this.Vfe;n.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:yb})}return Ha}jyb(Ha,yb){n.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Qo||3!==Ha.state?2===Ha.state&&
(n.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.JUc=!0,this.bKb()):(this.Qo=Ha,yb||this.bKb(),A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Qa.e_&&H.c()&&H.d("setFileMenuHostInformation")&&(Ha=Object.assign(new I,{hostUrl:this.Qo.ER,hostName:this.Qo.Soa,folderUrl:A.AFrameworkApplication.breadcrumbFolderUrl,folderName:A.AFrameworkApplication.breadcrumbFolderName}),n.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Ha))))}b1g(Ha,
yb,Xb){let wc;wc=!1;const Vc=this.Hnf();let yd="";this.KK.supportsGetMoreInfoForPersonalStorage&&(this.JUc?(yd=v.eAe(yb),this.JUc=!1,n.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Qo?Vc?yd=v.e1g(yb,this.Qo):this.Qo.Mni?(wc=!0,this.unb=!1,yd=v.c1g(yb,this.Qo),n.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(wc=!0,yd=v.eAe(yb),n.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.Qo.ER,["StorageServiceDisplayNameIsSet"]:!!this.Qo.Soa})):(yd=v.d1g(yb.Bi),n.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Vc&&(yd+=v.a1g(yb,Xb,!yd)+({iAc:wc}=this.$1g(Ha,Xb)).returnValue);return{returnValue:v.vvh(yd),iAc:wc}}$1g(Ha,yb){let Xb;Xb=!1;if(!this.EAc)return Xb=!0,n.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",iAc:Xb};let wc="",Vc="",yd="MenuTemplate";if(this.bZb)wc=
v.qAe(),this.bZb=!1,n.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Ha){try{const Od=Sys.Serialization.JavaScriptSerializer.deserialize(Ha,!0);wc=this.Z1g(Od,yb);n.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");A.AFrameworkApplication.Jzf&&"OneDrive"===this.tma&&(Vc=v.Z0g(this.yPi,A.AFrameworkApplication.Jzf))}catch(Od){n.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:Ha}),
wc=v.qAe()}Xb=!0}else yd="MenuLoading",wc=v.a2g(),n.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:v.b2g(yd,wc)+Vc,iAc:Xb}}Z1g(Ha,yb){let Xb="";const wc=[];for(let yd=0;yd<Ha.length;yd++){var Vc=Ha[yd];let Od="";if(Vc){const be=Vc.Title,Qb=Vc.AssetId;Vc=Vc.Thumbnails;Qb&&be&&Vc&&({Aii:Vc,returnValue:Od}=this.i9h(Vc),Xb+=v.jrb("jbtnNewTemplate"+yd,be,null,Vc,null,Od,yb,Qb))}wc[yd]=Od}Ha=new S.a(4,1,5E3,()=>{this.TIi(wc)},106);this.KK.Toc.ig(Ha);
return Xb}bKb(){this.UOc=!0;this.KK.Bzf.jx(this.Voc.Bwb);this.UOc=!1}get KK(){return this.W1.value}get Voc(){return this.bkb.value}get xPi(){return this.HEa.value}get yPi(){return this.NDg.value}get tma(){return this.Ara.value}get EAc(){return this.YGg.value}}Object(h.a)(R,"CreateNewActor",null,[]);var Y=a(1371);class U extends Y.a{constructor(){super()}xre(){this.zT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.zT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.zT(2,CommonUIStrings.l_Open);
this.zT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.zT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.zT(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return U.Ma||(U.Ma=new U)}static L6i(Ha){return U.instance.ga(Ha)}}U.Ma=null;Object(h.a)(U,"MruActorIntlHelper",Y.a,[]);var da;(function(Ha){Ha[Ha.success=0]="success";Ha[Ha.failure=1]="failure";Ha[Ha.spinner=2]="spinner";Ha[Ha.none=3]="none"})(da||(da={}));Object(h.b)("DisplayState",da);var T=a(40);class ka{constructor(Ha,yb,Xb,
wc,Vc,yd,Od,be){this.qJc=null;this.uWc=!0;this.gTb="";this.IIg=0;this.BXa=null;this.JPc=3;this.fb=be;this.W1=Ha;this.gj=yb;this.Mzg=Xb;this.Nwg=wc;this.Mwg=Vc;this.HEa=new w.a(()=>new u.a(yd.value,null));this.wAg=new w.a(()=>new u.a(Od.value,Object(x.a)(this,this.hOi,"mruEventResultReceived")));this.fb.qa("WacInTabOpenMRUIsEnabledForUiHost");this.fb.qa("UiHostSupportsDocRebootFeatures")}hOi(Ha,yb){this.BXa=Ha;yb||this.hWf()}jlj(){this.vD.D$a.Je(ea.a.mtc,W.a.frame,Object(x.a)(this,this.mtc,"populateMruMenu"),
96)}mtc(Ha,yb,Xb,wc,Vc){return 1!==Xb&&Vc?this.faj(Vc):32}faj(Ha){this.awh();this.$vh();Ha.PopulationXML=v.wvh(this.gTb+this.qJc);return 32}awh(){var Ha=3;let yb=!1;if(this.gTb&&this.IIg===this.BXa.dYj)n.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),Ha=this.JPc;else{n.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var Xb=this.vD.vw();this.BXa=this.gOi.HZ("File Open opened",
!0);this.gTb&&2!==this.JPc&&3!==this.BXa.state?yb=!0:(Ha=this.W6h(this.BXa),A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Qa.e_&&H.c()&&Ha&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ha,!0)),this.gTb=({pPi:Ha}=this.qRh(this.BXa)).returnValue);Xb=this.vD.vw()-Xb;n.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Xb})}2!==Ha&&(Xb={["DisplayState"]:da[Ha]},1!==Ha&&(Xb.IsStale=yb),n.ULS.sendTraceTag(5849630,
202,50,"MRU section display state {0}",Xb));this.JPc=Ha}W6h(Ha){let yb;try{yb=T.c(Ha.nBd)}catch(Xb){yb=null,n.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Xb)}return yb}$vh(){this.uWc?(n.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.qJc=({xak:this.uWc}=this.lKi()).returnValue):n.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");n.ULS.sendTraceTag(5849633,202,
50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.uWc,["NotDisplayingLink"]:!this.qJc})}qRh(Ha){let yb;1===Ha.state||0===Ha.state?(n.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),Ha=2,yb=v.cAe(this.wka(2),this.wka(5))):3===Ha.state&&Ha.nBd?(yb=this.$0g(Ha.nBd),Ha=0):(n.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),yb=v.orb(this.wka(1),this.wka(2)),Ha=1);return{returnValue:yb,pPi:Ha}}$0g(Ha){let yb;const Xb=
this.vFb.NHa||"2155708348";if(Ha.length){yb=v.nrb("lblRecentDocuments",this.wka(3));let wc=0;for(let Vc=0;Vc<Ha.length;Vc++){const yd=Ha[Vc];"FileName"in yd&&"DocumentUrl"in yd&&"Path"in yd&&(yb+=v.jrb("MruButton"+Vc,yd.FileName.toString(),yd.Path.toString(),null,this.vFb.Rka,this.vFb.jAb,Xb,yd.DocumentUrl.toString()),yd.IsPinned&&wc++)}yb=v.Iha("RecentDocumentsMenuSection",v.Lyf,this.wka(2),yb);n.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:Ha.length,
["NumPinnedDocuments"]:wc})}else yb=v.orb(this.wka(0),this.wka(2)),n.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return yb}lKi(){let Ha;Ha=!0;let yb=this.v_g;var Xb=this.u_g;if(yb&&Xb||!this.vD.supportsGetMoreInfoForPersonalStorage)Ha=!1;else{const wc=this.Ydc.HZ("File Open",!1);3===wc.state&&(yb=wc.ER,Xb=wc.Soa,Ha=!1)}Xb=Xb?String.format(this.wka(4),Xb):null;return{returnValue:v.b0g(this.vFb.NHa,Xb,yb),xak:Ha}}hWf(){this.vD.Bzf.jx(this.vFb.Bwb)}get vD(){return this.W1.value}get wka(){return this.gj.value}get vFb(){return this.Mzg.value}get v_g(){return this.Nwg.value}get u_g(){return this.Mwg.value}get Ydc(){return this.HEa.value}get gOi(){return this.wAg.value}}
Object(h.a)(ka,"MruRenderer",null,[]);var L=a(244),fa=a(782);class wa{constructor(Ha,yb,Xb,wc,Vc,yd,Od){this.Qo=null;this.Oke=!1;this.Rqa=this.n7d=0;this.UDg=Ha;this.QXa=yb;this.TWb=Xb;this.bkb=wc;this.Ara=Vc;this.W1=yd;this.HEa=new w.a(()=>new u.a(Od.value,Object(x.a)(this,this.jyb,"getMoreInfoEventReceived")))}Y1a(){!this.Qo&&this.WBd.supportsGetMoreInfoForPersonalStorage?this.Ydc.HZ("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}jyb(Ha){if(!this.Qo&&3===Ha.state)this.Qo=Ha;else if(2===
Ha.state){this.Oke?n.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Ydc.HZ("NewDocumentFromStream",!0),this.Oke=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.n7d=(new Date).getTime();var Ha=this.GJh.z7c;if(null===Ha)this.QXa(null);else{var yb=this.TWb.menuItemId,Xb=this.TWb.dG,wc=this.TWb.ZTj,Vc=this.TWb.LJh;this.Rqa="streamBase64"===wc?Vc.length/1024:0;n.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.zP,
this.Rqa);var yd=(new Date).getTime();Ha=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",Ha,t.a.pf(this.tma),t.a.pf(yb),t.a.pf(this.zP),t.a.pf(A.AFrameworkApplication.lcid.toString()),t.a.pf(yd.toString()),t.a.pf(Xb),t.a.pf(A.AFrameworkApplication.canary),A.AFrameworkApplication.xi,t.a.pf(wc));Ha+="&"+A.AFrameworkApplication.wec();A.AFrameworkApplication.Hxa&&(Ha+="&"+A.AFrameworkApplication.Rdc());(yb=this.Qo?this.Qo.ER:null)&&
(Ha+="&DestinationUrl="+t.a.pf(yb));this.WBd.bGb.Mm(Ha,2,Vc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(x.a)(this,this.sPi,"newDocumentFromStreamSuccessHandler"),Object(x.a)(this,this.rPi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}sPi(Ha){if(Ha&&Ha.data&&Ha.data.me)if(({ot:yb}=T.d(Ha.data.me)).returnValue)if(Ha=yb,Ha.StatusCode!==L.a.ZO&&Ha.StatusCode!==L.a.Otb)n.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.zP,this.Rqa,Ha.StatusCode),this.QXa(null);else if(Ha.NewDocumentUrl&&""!==Ha.NewDocumentUrl){var yb=(new Date).getTime()-this.n7d;n.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.zP,this.Rqa,yb);this.UDg(Ha.NewDocumentUrl)}else n.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.zP,this.Rqa),this.QXa(null);else n.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.zP,this.Rqa,{["ResponseData"]:fa.a.Ngb(Ha.data.me)}),this.QXa(null);else n.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.zP,this.Rqa),this.QXa(null)}rPi(Ha){Ha&&Ha.data&&n.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.zP,this.Rqa,Ha.data.status);this.QXa(null)}get zP(){switch(this.WBd.Ica){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get GJh(){return this.bkb.value}get tma(){return this.Ara.value}get WBd(){return this.W1.value}get Ydc(){return this.HEa.value}}Object(h.a)(wa,"NewDocumentFromStreamOperation",null,[]);class oa{constructor(Ha,yb,Xb,wc){this.bkb=Ha;this.Ara=yb;this.W1=Xb;this.vAg=wc}create(Ha,yb,Xb){return new wa(Ha,yb,Xb,this.bkb,this.Ara,this.W1,this.vAg)}}Object(h.a)(oa,"NewDocumentFromStreamOperationFactory",null,[688]);var xa=a(86),bb=a(524),Za=
a(58);class La{get name(){return"Common.App.NewAndOpen.UX"}Kh(Ha){Ha.register(oa,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").tc().Bc(()=>new oa(new w.a(()=>A.AFrameworkApplication.sa.Qa.Nhd()),new w.a(()=>A.AFrameworkApplication.tma),new w.a(()=>Ha.og("Common.INewAndOpenCommonHelpers")),new w.a(()=>Ha.og("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){A.AFrameworkApplication.fa.zu(()=>{this.CAb()})}CAb(){const Ha=
bb.a.gq(xa.a.instance.Tb("Common.INewAndOpenCommonHelpers")),yb=bb.a.gq(xa.a.instance.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));A.AFrameworkApplication.tma&&Za.Task.WAA.call(null,Ha,yb).continueWith(()=>{const Xb=new R(new w.a(()=>Ha.result),new w.a(()=>A.AFrameworkApplication.sa.Qa.Nhd()),new w.a(()=>yb.result),new w.a(()=>A.AFrameworkApplication.sa.Qa.Ohd().NHa||"1959943459"),new w.a(()=>A.AFrameworkApplication.tma),new w.a(()=>A.AFrameworkApplication.Ovi));Xb.Hg();Xb.bKb()});if(A.AFrameworkApplication.IUf){const Xb=
bb.a.gq(xa.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>"));Za.Task.WAA.call(null,Ha,yb,Xb).continueWith(()=>{const wc=new ka(new w.a(()=>Ha.result),new w.a(()=>U.L6i),new w.a(()=>A.AFrameworkApplication.sa.Qa.Ohd()),new w.a(()=>A.AFrameworkApplication.K6i),new w.a(()=>A.AFrameworkApplication.J6i),new w.a(()=>yb.result),new w.a(()=>Xb.result),A.AFrameworkApplication.fa);wc.jlj();wc.hWf()})}}dispose(){}}Object(h.a)(La,"UXPackageManager",null,[4,5,3]);var va=a(1211),Ba=a(1218),Ea=a(1193),pa=
a(1228),$a=a(1219),cb;(function(Ha){Ha[Ha.myFiles=0]="myFiles";Ha[Ha.recent=1]="recent";Ha[Ha.currentFolder=2]="currentFolder";Ha[Ha.yourPhone=3]="yourPhone"})(cb||(cb={}));Object(h.b)("SharedFilePickerLandingLocation",cb);class ib{constructor(Ha){this.pMa=this.Ybb=null;this._initialized=!1;this.Znd=Ha}s3a(Ha){this._initialized||(Ha.lo(O.a.pVf),Ha.Il(O.a.pVf,Object(x.a)(this,this.U1i,"onReceivedPickerResponse")),this._initialized=!0)}Phd(Ha){return this.pMa=new Promise((yb,Xb)=>{const wc={};wc[E.a.O9i]=
Ha;this.Ybb=(Vc,yd)=>{""===yd?(n.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),yb(Vc)):("Canceled"===yd?n.ULS.sendTraceTag(572548164,306,50,yd):n.ULS.sendTraceTag(556901065,306,10,yd),Xb(yd))};this.Znd.execute(Vc=>{this.s3a(Vc);Vc.uj(O.a.P6i,wc)})})}U1i(Ha){this.Ybb(Ha.Values[E.a.uzj],void 0===Ha.Values[E.a.PHd]||null===Ha.Values[E.a.PHd]?"":Ha.Values[E.a.PHd])}sud(){return A.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")}KJe(Ha,yb,Xb,wc,Vc,yd,Od){const be={};be[E.a.gzj]=
Ha;be[E.a.titleText]=yb;be[E.a.ZTg]=Xb;be[E.a.$Tg]=wc;be[E.a.aUg]=!1;be[E.a.crh]=!0;be[E.a.RJh]=Vc;be[E.a.S9i]=yd;be[E.a.R9i]=cb[Od];H.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(be[E.a.T9i]="Dark");return be}}Object(h.a)(ib,"SharedFilePickerManager",null,[459]);class ta{constructor(){this.$a=null}get name(){return"Common.App.SharedFilePicker"}Kh(Ha){this.$a=Ha;Ha.register(ib,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").tc().Bc(()=>
new ib(Ha.Tb("Postmessage.IHostPostmessenger")))}init(){A.AFrameworkApplication.fa.zu(()=>{this.CAb()})}CAb(){this.$a.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){l.a.instance.si(new ta)}}Object(h.a)(ta,"SharedFilePickerPackage",null,[4,5]);var Ya=a(1319),Da=a(858),ba=a(27);class ya{get name(){return"Common.App.WildFire"}aqe(Ha){let yb=!1;Ha&&(Ha.M6c(),Ha.s2g&&(yb=!1));return yb}nfh(){var Ha=A.AFrameworkApplication.sa.Qa;Ha=new Ya.a(Ha.ri,Da.a.Uec(),!1,1===Ha.Nca);
this.aqe(Ha)&&n.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}o7b(Ha,yb,Xb,wc,Vc,yd){Ha=new Ya.a(Ha,Xb,wc,yb,Vc,yd);this.aqe(Ha)&&n.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}wlh(){const Ha=A.AFrameworkApplication.sa.Qa;var yb=A.AFrameworkApplication.fa;const Xb=Ha.ri,wc=1===Ha.Nca;if(yb.qa(Da.a.T$h(Xb))){var Vc=Da.a.Uec(),yd=8<ba.a.C6a;if(2!==Xb||2!==Vc||!wc){yb=yb.qa(Da.a.U$h(Xb));var Od=Ha.p3f(),be=()=>Ha.Kx;yb&&!Da.a.Msd(Da.a.wgd(Xb))&&this.o7b(Xb,wc,Vc,yd,be,Od)}}}init(){var Ha=
A.AFrameworkApplication.fa;const yb=Ha.qa("WildFireChromeExtensionEnabled");Ha=Ha.qa("WildFireChromeExtensionBar")&&yb;Da.a.GAc&&Ha&&!Da.a.Msd(Da.a.XDe)?this.nfh():(document.body&&Da.a.dMj&&this.wlh(),A.AFrameworkApplication.rb.Qb(ea.a.Zwd,W.a.frame,Object(x.a)(this,this.Zwd,"launchWildFireBusinessBar")))}Zwd(Ha,yb,Xb,wc,Vc){if(1===Xb)return 32;if(!Vc)return 8;this.o7b(Vc.app,Vc.mode,Vc.platform,Vc.useTwoButton,null,null);return 32}dispose(){}Kh(){}static main(){l.a.instance.si(new ya)}}Object(h.a)(ya,
"PackageManager",null,[4,5]);var V=a(1307);a(1095);var Z=a(9),ja=a(714),la=a(50),ua=a(38),eb=a(196),Eb=a(1);class Wb{constructor(Ha){this.Uh=Ha}Mc(){return!1}executeCommand(Ha,yb,Xb){return 2!==this.Uh.$d(ea.a.newDocument,2,Xb)?Za.Task.Ta(!0):eb.a(yb.command)}Ac(Ha,yb){return 1056925771===yb.command}Rc(Ha,yb,Xb){Ha=!0;switch(yb){case "PopulateNewMenu":this.Uh&&(Eb.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&A.AFrameworkApplication.Qq("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),
Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",!1)&&(A.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",A.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.Uh.$d(ea.a.ntc,2,Xb));break;default:Ha=!1}return Ha}}Object(h.a)(Wb,"CreateNewCommandHandler",null,[222]);class Ab extends ja.a{constructor(Ha){super(Ha)}ld(){const Ha=la.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na),yb=la.GetServiceTaskFactory.create(this.$.da,
165,this.ka,this.Na);ua.TaskExtensions.za(ua.TaskExtensions.Md([Ha,yb],this.ka),()=>{this.fd([new Wb(A.AFrameworkApplication.rb)])},this.ka,3)}static la(Ha){ja.a.Rd(87,new Ab(Ha))}}Object(h.a)(Ab,"CreateNewCommandHandlerFactory",ja.a,[]);var Jb=a(1205),Gb=a(1097),Nb=a(1248),Ja=a(517),ab=a(106),wb=a(198),xb=a(11),rb=a(22),za=a(290),Aa=a(1024);class pb{}pb.create="Create";pb.activate="Activate";pb.close="Close";pb.remove="Delete";pb.duplicate="Duplicate";Object(h.a)(pb,"Actions",null,[]);var kb=a(29),
Cb=a(46);class ob extends Za.Task{constructor(Ha){super();this.x4d=null;this.z4d=0;this.XSb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.RXa=this.RXa()}catch(yb){this.dispose(),this.BBa(yb),this._state=3}};this.$t=Ha;this.RXa=this.gHc;this.moveNext()}gHc(){this.x4d=kb.a.hd(3,2,0,1667,0,-1244327602,"MsFormDeleteConfirmation");this.XSb=Cb.a(this.$t.$).vj(this.x4d).G();this.XSb.isCompleted||(this._state=2,this.XSb.aab(this.moveNext));return this.frg}frg(){this.z4d=
this.XSb.HZ();0===this.z4d&&(this.$t.$.workbookContext.Options=xb.HelperMethods.pO(!1,this.$t.$.workbookContext.Options,2048),this.$t.deleteMsFormMetaDataSheet());this._state=3;this.zSa(!0)}dispose(){}}Object(h.a)(ob,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",Za.Task,[3]);class qa{}qa.action="Action";qa.gMh="FlexPane";qa.Vbc="formId";qa.id="id";qa.title="Title";qa.gSb="XlWorkbookId";qa.$Nh="Fragment";qa.host="Host";qa.mZj="TopView";qa.accountType="auth_pvr";
Object(h.a)(qa,"Parameters",null,[]);var ma=a(63);const Ga=(Ha,yb,Xb,wc,Vc,yd,Od=null)=>{Od=Ha.Oa(9,Od);Od.sheetName=yb;Od.confirmationChoice=!0;return ma.g(Ha,"DeleteSheet",Od,Xb,wc,Vc,yd,0)};class vb{constructor(Ha){this.wo="Excel";this.$=Ha;this.UU=Aa.a.current}get hasMsForm(){return ab.c(this.$.gg)}get Hoc(){return this.$.workbookContext.MsFormId}get dSb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return rb.a.contains(this.$.Uy.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":
"OrgId"}Mc(Ha,yb){switch(yb){case -105284469:return!ab.i(this.$.gg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(Ha,yb){Ha=ua.TaskExtensions.Yj();yb=yb.command;switch(yb){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:Ha=this.deleteMsForm();break;default:Ha=eb.a(yb)}return Ha}Ac(Ha,
yb){if(!this.$.ea.Dg.get(61))return!1;Ha=!1;switch(yb.command){case -105284469:Ha=ab.i(this.$.gg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:Ha=this.hasMsForm}return Ha}Rc(){return!1}insertMsForm(){const Ha=t.a.Pp(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),yb={},Xb={};yb[qa.action]=pb.create;yb[qa.accountType]=this.accountType;Xb[qa.action]=pb.create;Xb[qa.gSb]=encodeURIComponent(this.dSb);Xb[qa.host]=this.wo;Xb[qa.title]=encodeURIComponent(Ha);
this.mFb(yb,Xb);this.$.workbookContext.Options=xb.HelperMethods.pO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const Ha={},yb={};Ha[qa.accountType]=this.accountType;yb[qa.Vbc]=this.Hoc;yb[qa.gSb]=encodeURIComponent(this.dSb);yb[qa.host]=this.wo;this.mFb(Ha,yb)}previewMsForm(){const Ha={},yb={};Ha[qa.accountType]=this.accountType;yb[qa.Vbc]=this.Hoc;yb[qa.gSb]=encodeURIComponent(this.dSb);yb[qa.host]=this.wo;yb[qa.mZj]="Preview";this.mFb(Ha,yb)}sendMsForm(){const Ha={},yb={};Ha[qa.accountType]=
this.accountType;yb[qa.Vbc]=this.Hoc;yb[qa.gMh]="SendForm";yb[qa.gSb]=encodeURIComponent(this.dSb);yb[qa.host]=this.wo;this.mFb(Ha,yb)}deleteMsForm(){return new ob(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.bF(new wb.a(158,0,(Ha,yb,Xb)=>Ga(this.$.pa.Mw,this.UU.Iwb,za.b(Ha,()=>{this.xoh()}),yb,Xb,null)))}xoh(){const Ha={},yb={};Ha[qa.action]=pb.remove;Ha[qa.accountType]=this.accountType;yb[qa.action]=pb.remove;yb[qa.host]=this.wo;yb[qa.Vbc]=encodeURIComponent(this.Hoc);yb[qa.gSb]=
encodeURIComponent(this.dSb);this.mFb(Ha,yb)}mFb(Ha,yb){const Xb=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx";let wc="";var Vc="";if(yb){for(let be in yb){var yd=be,Od=yb[be];Vc+=Vc.length?"&":"";Vc+=yd+"="+Od}Ha||(Ha={});Ha[qa.$Nh]=encodeURIComponent(Vc)}if(Ha)for(let be in Ha)yb=be,Vc=Ha[be],wc+=wc.length?"&":"?",wc+=yb+"="+Vc;window.open(Xb+wc,"_blank")}}Object(h.a)(vb,"MsFormCommandHandler",null,[222]);class Ka extends ja.a{constructor(Ha){super(Ha)}ld(){const Ha=la.GetServiceTaskFactory.create(this.$.da,
203,this.ka,this.Na);ua.TaskExtensions.za(ua.TaskExtensions.Md([Ha],this.ka),()=>{this.fd([new vb(this.$)])},this.ka,3)}static la(Ha){Ha.ea.Dg.get(61)&&ja.a.Rd(215,new Ka(Ha))}}Object(h.a)(Ka,"MsFormCommandHandlerFactory",ja.a,[]);var Pa=a(228),fb=a(108),Wa=a(70),Ma=a(153),lb=a(54);class Na extends Pa.a{constructor(Ha){super();this.$=Ha;this.Gb()}create(){ua.TaskExtensions.za(Object(Wa.b)("OfficeVSO:7624895_MigrateNewAndOpenCoreManagerToNewServiceInfra")?Object(fb.c)(Ma.a.resolve(lb.B,{Wb:this.Na})):
la.GetServiceTaskFactory.create(this.$.da,164,this.ka,this.Na),()=>{this.qb(new La)},this.ka,3)}}Object(h.a)(Na,"NewAndOpenUXFactory",Pa.a,[]);class X{constructor(Ha,yb){this.Uh=yb;this.$=Ha}executeCommand(Ha,yb,Xb){Ha=2;switch(yb.command){case ea.a.openUrlInNewTab:Ha=this.Uh.$d(ea.a.openUrlInNewTab,2,Xb);break;case ea.a.aQa:Ha=this.Uh.$d(ea.a.aQa,2,Xb)}return 2!==Ha?Za.Task.Ta(!0):eb.a(yb.command)}Ac(Ha,yb){return yb.command===ea.a.openUrlInNewTab||yb.command===ea.a.aQa}Rc(Ha,yb,Xb){return"PopulateMruMenu"===
yb?(this.Uh.$d(ea.a.mtc,2,Xb),!0):!1}Mc(){return!1}}Object(h.a)(X,"OpenFromMruCommandHandler",null,[222]);class F extends ja.a{constructor(Ha){super(Ha)}ld(){const Ha=la.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na),yb=la.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.Na);ua.TaskExtensions.za(ua.TaskExtensions.Md([Ha,yb],this.ka),()=>{this.fd([new X(this.$,A.AFrameworkApplication.rb)])},this.ka,3)}static la(Ha){ja.a.Rd(88,new F(Ha))}}Object(h.a)(F,"OpenFromMruCommandHandlerFactory",
ja.a,[]);var na=a(1181),hb=a(1220),Ib=a(1260),vc=a(1100),nc=a(1201),Pb=a(1101),oc=a(1102),Ic=a(1206),ec=a(1249),mb=a(1250),Ob=a(155),Ta=a(87),sb=a(379),zb=a(104),db=a(21),jb=a(380);class Ub{constructor(Ha,yb){this.sheetName=null;this.value=!1;this.sheetName=Ha;this.value=yb}getSheetName(){return this.sheetName}twa(){return this.value}}Object(h.a)(Ub,"MacroRecorderSheetOptionToggledPayload",null,[123]);const xd=(Ha,yb,Xb,wc,Vc,yd,Od,be=null)=>{be=Ha.Oa(9,be);be.sheetName=yb;be.show=Xb;return ma.g(Ha,
"ShowGridlines",be,wc,Vc,yd,Od,0)},ne=(Ha,yb,Xb,wc,Vc,yd,Od,be=null)=>{be=Ha.Oa(9,be);be.sheetName=yb;be.show=Xb;return ma.g(Ha,"ShowHeadings",be,wc,Vc,yd,Od,0)},fe=(Ha,yb,Xb,wc,Vc,yd,Od,be=null)=>{be=Ha.Oa(9,be);be.sheetName=yb;be.directionRtl=Xb;return ma.g(Ha,"ChangeSheetDirection",be,wc,Vc,yd,Od,0)};var Bd;let Ue=Bd=class{constructor(Ha){this.$=Ha}Mc(){return!1}executeCommand(Ha,yb){const Xb={};this.$.Sj(Xb);Ha=yb.command;const wc=Object(Ta.a)(zb.a,this.$.ua.getItemByName(Xb.SheetName));if(!wc)return eb.a(Ha);
let Vc,yd,Od,be,Qb;switch(Ha){case 705559150:case -1411193626:Vc=16;yd=!wc.hideGridLines;Od=xd;Qb=183;be=wc.hideGridLines;break;case -2052321504:case 515737500:Vc=4;yd=!wc.headersVisible;Od=ne;Qb=184;be=!wc.headersVisible;break;case -1478455630:Vc=2;yd=!wc.displayRtl;Od=fe;Qb=185;be=!wc.displayRtl;db.h(this.$).Ca.W3j(yd);break;default:return eb.a(Ha)}wc.Yrb(Vc,yd);const zc=()=>new Ub(Xb.SheetName,be),Yc=this.$.pa.va;return sb.a(this.$.userOperationManager,(zd,ke,Td)=>Od(Yc,Xb.SheetName,be,za.b(zd,
Ge=>{Bd.PHb(Ge,wc,Vc,yd)}),za.a(ke,()=>{Bd.bHb(wc,Vc,yd)}),Td,null),zd=>new wb.a(Qb,0,zd,void 0,zc),yb)}Ac(Ha,yb){Ha=!1;switch(yb.command){case -1411193626:case 515737500:case -1478455630:Ha=!0;break;case 705559150:case -2052321504:Ha=jb.a(this.$)}return Ha}Rc(){return!1}static PHb(Ha,yb,Xb,wc){kb.a.wq(Ha.Errors)&&yb.Yrb(Xb,!wc)}static bHb(Ha,yb,Xb){Ha.Yrb(yb,!Xb)}};Ue=Bd=Object(Ob.b)([Object(Ma.d)(lb.N),Object(Ob.c)(0,Object(lb.o)())],Ue);Object(h.a)(Ue,"SheetOptionsToggleCommandHandler",null,[222]);
class mc extends ja.a{constructor(Ha){super(Ha)}ld(){this.fd([new Ue(this.$)])}static la(Ha){ja.a.Rd(100,new mc(Ha))}}Object(h.a)(mc,"SheetOptionsToggleCommandHandlerFactory",ja.a,[]);String(c);window.___1678693024949_closurehack=c;var Fc=a(178),bd=a(189),de=a(159),Md=a(71),se=a(60),tc=a(214),dd=a(597),Hd=a(96),Xc=a(259),gd=a(218),je=a(12);class Ee extends gd.a{constructor(Ha,yb,Xb,wc=null){super(Ha,Xb,2,wc);this.qNc=null;this.onResize=()=>{const Vc=this.K_h();this.rMa.setAttribute("width",Vc.x.toString());
this.rMa.setAttribute("height",Vc.y.toString());this.J4j(Vc);this.QEd()};this.PMe=yb;this.$.iC(this.onResize);this.igc()}get rMa(){return this.qNc}initialize(){const Ha=this.$.Cb+"iframeDialog_frame",yb=this.$.Cb+"iframeDialog";this.Pb.style.margin=xb.HelperMethods.zc(0);this.Pb.style.marginBottom=xb.HelperMethods.zc(-2);if(Eb.EwaSettings.isChangeGateEnabled("OfficeVSO:7111358_IFrameDialogReduceInnerHtml")){var Xb=document.createElement("iframe");Xb.id=Ha;Xb.frameBorder="0";Xb.scrolling="auto";Xb.src=
this.gid(yb);this.Pb.appendChild(Xb)}else Xb=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',Ha,this.gid(yb)),this.Pb.innerHTML=Xb;this.qNc=document.getElementById(Ha);this.domElement.id=yb;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.UF(this.onResize);super.dispose()}setFocus(){je.DOMElementExtensions.setFocus(this.rMa)}onHide(){this.rMa.contentWindow.close();je.DOMElementExtensions.yf(this.rMa);this.qNc=null;super.onHide()}J4j(Ha){const yb=
this.domElement.style;yb.width=xb.HelperMethods.zc(Ha.x);yb.marginLeft=xb.HelperMethods.zc(-Ha.x/2)}K_h(){const Ha=je.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*Ha.width),this.PMe.x),Math.min(Math.floor(.9*Ha.height),this.PMe.y))}}Object(h.a)(Ee,"IFrameDialog",gd.a,[]);var ae=a(5),Yb=a(81),Sc=a(14);class qd extends Ee{constructor(Ha){super(Ha,new Sys.UI.Point(960,680),Sc.a.instance.ga(1264));this.name=ae.a.eRe}get pc(){return"EmbeddingDialog"}gid(Ha){const yb=
new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);tc.a.Qk(yb,ae.a.eyh,Ha);Yb.a(this.$.ya,32)&&tc.a.Qk(yb,ae.a.vTe,"1");Yb.a(this.$.ya,33)&&tc.a.Qk(yb,ae.a.wTe,"1");Yb.a(this.$.ya,34)&&tc.a.Qk(yb,ae.a.uTe,"1");return yb.toString()}onShow(){n.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(h.a)(qd,"EmbeddingDialog",Ee,[]);var Id=a(1274),ic=a(91),Gc=a(82),jd=a(842);class ed{}ed.U9f="FrameDialog_ShareFromEdit";ed.view="FrameDialog_View";
ed.fFe="FrameDialog_CloseAndRefresh";ed.FIj="FrameDialog_ShareFromView";ed.edit="FrameDialog_Edit";ed.wjj="FrameDialog_RefreshGrid";ed.x9g="FrameDialog_CloseMe";ed.pFe="FrameDialog_CloseMeError";ed.ready="FrameDialog_Ready";ed.w$i="FrameDialog_PleaseClose";ed.jK="GotoRange";Object(h.a)(ed,"PostMessageConstants",null,[]);var Qd=a(291),te=a(117),xe=a(255);class He{constructor(){this.jK=null;this.uId=1461300262}}Object(h.a)(He,"SessionUpdateContext",null,[]);class We extends Ee{constructor(Ha,yb,Xb){super(Ha,
new Sys.UI.Point(We.Xnh,We.xnh),Sc.a.instance.ga(yb?1269:1268));this.d2a=null;this.IOc=!1;this.Rrc=wc=>{const Vc=this.$,yd=new He;yd.jK=wc.Values[ed.jK];let Od=!1;switch(wc.MessageId){case ed.U9f:this.lv();Od=!0;yd.uId=1334518759;break;case ed.view:this.fpa=Sc.a.instance.ga(1269);this.zng(!0);break;case ed.fFe:this.lv(),Od=!0}wc=new wb.a(140,0,(be,Qb,zc)=>Qd.n(Vc.pa.va,za.b(be,this.n3i),Qb,zc,yd));wc.flags=Od?16:80;Vc.userOperationManager.Oc(wc,this.Ud)};this.dWi=()=>{const wc=this.$;wc.ya.SurveyRedirectUrl?
(this.lv(),wc.Yc(1305810481,0,8,null)):(this.fpa=Sc.a.instance.ga(1268),this.zng(!1))};this.A3i=()=>{const wc=this.$;this.lv();wc.Yc(1334518759,0,8,null)};this.Wpc=wc=>{const Vc=this.$;this.lv();wc.MessageId===ed.pFe&&Vc.ea.Yed()};this.P1i=()=>{this.IOc=!0;this.raiseEvent(We.lxd)};this.n3i=(wc,Vc)=>{if(!xe.a(wc)){wc=this.$;if(Vc.jK){const yd=wc.ea.ua;if(yd.contains(Vc.jK.SheetName))this.Jqc(Vc);else{let Od=null;Od=()=>{yd.Gna(Od);this.Jqc(Vc)};yd.iha(Od)}}1461300262!==Vc.uId&&wc.Yc(Vc.uId,0,8,null)}};
this.qde=yb;this.Ud=Xb}EQg(Ha){this.addHandler(We.lxd,Ha)}bpj(Ha){this.removeHandler(We.lxd,Ha)}get pc(){return"FormDialog"}get amf(){return this.IOc}get o8a(){return this.qde}dispose(){ic.a.Ja(this.d2a);this.d2a=null;super.dispose()}initialize(){super.initialize();const Ha=Gc.a.oba(this.$.ya.FormLightBoxUrl),yb=this.d2a=new Id.a(this.rMa.contentWindow,Ha);yb.isEnabled()&&yb.nY(Ha)&&(this.vna(ed.U9f,this.Rrc),this.vna(ed.view,this.Rrc),this.vna(ed.fFe,this.Rrc),this.vna(ed.FIj,this.A3i),this.vna(ed.edit,
this.dWi),this.vna(ed.wjj,this.Rrc),this.vna(ed.ready,this.P1i),this.vna(ed.x9g,this.Wpc),this.vna(ed.pFe,this.Wpc))}close(Ha){Ha===this.oM&&this.amf&&this.d2a.send(new jd.a(ed.w$i))||super.close(Ha)}gid(){return this.IJe(this.o8a)}IJe(Ha){const yb=this.$.ya,Xb=new Sys.StringBuilder(yb.FormLightBoxUrl);tc.a.Qk(Xb,ae.a.INh,this.$.ea.sessionId);tc.a.Qk(Xb,ae.a.GNh,Ha?ae.a.HNh:ae.a.FNh);te.a.Ypb(Xb,yb);return Xb.toString()}zng(Ha){this.IOc=!1;this.rMa.src=this.IJe(Ha);this.qde=Ha}vna(Ha,yb){this.d2a.lo(Ha);
this.d2a.Il(Ha,yb)}Jqc(Ha){const yb=this.$.ea.ua.getItemByName(Ha.jK.SheetName);yb&&0===yb.EB&&db.h(this.$).sg(Ha.jK,null,null,null,20,"FormDialog.OnItemInserted")}}We.Xnh=900;We.xnh=1200;We.lxd="lightBoxReady";Object(h.a)(We,"FormDialog",Ee,[212]);var ye;(function(Ha){Ha[Ha.comment=10]="comment";Ha[Ha.range=12]="range";Ha[Ha.table=13]="table";Ha[Ha.chart=14]="chart";Ha[Ha.sheet=15]="sheet"})(ye||(ye={}));Object(h.b)("NavigationType",ye);var $e=a(1007),jf=a(114),gf=a(18),rf=a(567),Mf=a(967),Qa=a(293),
Zb=a(769),nb=a(52);class Tb extends Zb.a{constructor(Ha,yb,Xb,wc,Vc,yd=0,Od){super(Ha,Sc.a.instance.ga(yb),!1);this.htmlSanitizationHelper=null;this.message=Xb;this.VRi=wc;this.O3d=Vc;this.operationFlags=yd;this.htmlSanitizationHelper=Od}get pc(){return"WebMethodConfirmationDialog"}get MB(){return 1005}get yIa(){return this.operationFlags}initialize(){let Ha="<div class='"+jf.a.Sn+"'>\r\n\t<div class='"+jf.a.LTe+"'>\r\n\t\t<div class='"+gf.a.XEe+"'>\r\n\t\t\t<img src='{0}' class='"+gf.a.FWe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+
jf.a.OTe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";Ha=String.format(Ha,nb.a.Le(13),Sc.a.instance.ga(25),Sc.a.instance.ga(this.message));this.htmlSanitizationHelper.jh(this.Pb,Ha);this.addButton(0,this.VRi);this.addButton(1);super.initialize()}ZG(){return this.O3d}}Object(h.a)(Tb,"WebMethodConfirmationDialog",Zb.a,[]);class qb extends $e.a{constructor(Ha,yb){super(Ha,Sc.a.instance.ga(1271));this.htmlSanitizationHelper=this.IUa=this.jSa=this.textBox=null;this.mMf=()=>{const Xb=this.$;this.lv();const wc=
new Tb(Xb,1274,1275,1276,(Vc,yd,Od)=>{var be=Xb.pa.va.$b(),Qb=Xb.pa.va;be=Qb.Oa(1,be);return ma.g(Qb,"UnshareForm",be,Vc,yd,Od,null,0)},16,this.htmlSanitizationHelper);wc.initialize();wc.fg()};this.htmlSanitizationHelper=yb}get pc(){return"ShareFormDialog"}dispose(){this.IUa&&this.IUa.Pda(this.mMf);ic.a.sc([this.textBox,this.jSa,this.IUa]);this.IUa=this.jSa=this.textBox=null;super.dispose()}initialize(){let Ha="<div class='"+jf.a.Sn+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+jf.a.H3a+"'>\r\n\t<input type='text' id='{1}' class='"+
jf.a.RC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";Ha=String.format(Ha,Sc.a.instance.ga(1272),"sfd_input","sfd_unshare",gf.a.uo,Sc.a.instance.ga(1273));this.htmlSanitizationHelper&&Eb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Eb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?this.htmlSanitizationHelper.jh(this.Pb,Ha):this.Pb.innerHTML=Ha;this.textBox=new Qa.a(this.getElementById("sfd_input"));
this.jSa=new Mf.a(this.textBox.domElement);this.IUa=rf.a.create(this.getElementById("sfd_unshare"));this.IUa.y2(this.mMf);this.textBox.text=Sc.a.instance.ga(736);this.textBox.enabled=!1;this.textBox.readOnly=!ba.a.Pg;this.addButton(1,10);super.initialize()}s0a(){return(Ha,yb,Xb)=>{var wc=this.$.pa.va.$b(),Vc=this.$.pa.va;Ha=this.X4a(Ha);yb=this.bLa(yb);wc=Vc.Oa(1,wc);return ma.g(Vc,"ShareForm",wc,Ha,yb,Xb,null,0)}}J_(Ha,yb,Xb){this.textBox.text=Ha.Result;this.textBox.enabled=!0;je.DOMElementExtensions.setVisible(this.IUa.domElement,
!0);super.J_(Ha,yb,Xb)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(Ha){}super.setFocus()}}Object(h.a)(qb,"ShareFormDialog",$e.a,[]);var Kb=a(254),jc=a(6),Ac=a(85),Jc=a(262),hd=a(74),Cd=a(632),ac=a(147),Lc=a(432),rd=a(264),Yd=a(16),ie=a(261);class Je extends bd.a{constructor(Ha,yb,Xb){super();this.FBe=this.GBe=!1;this.Y3a=0;this.kja=!1;this.sTi=()=>{this.GBe=!0;this.fbg()};this.$=Ha;this.Xa=yb;this.dK=Xb;hd.a(this.$).ZLd(new ac.a(jc.a.tlg,jc.a.idle,Je.m6g),
new Kb.a(jc.a.nFe,jc.a.A_,null,jc.a.UO,jc.a.idle))}get UGc(){return ab.b(this.$.gg)}get MQd(){return this.$.isEditMode&&(this.$.ea.Kth||this.$.ZM)}Mc(Ha,yb){switch(yb){case 353606613:case -1099009678:case 192430811:return!Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.E$f();case 783415632:return!Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.E$f();case 869186573:return this.F$f();case -1570751769:case 1986648902:return 131072!==
(this.$.PU&131072);case 330035228:return!(this.t4a(!0)&&this.UGc);case -509039657:return!(this.t4a()&&this.UGc);case 1334518759:return!(this.t4a()&&this.UGc&&this.TBe())}return!1}E$f(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.F$f()}F$f(){const Ha=this.$.workbookContext.FullDocumentInfo,yb=rd.a()&&this.$.ea.Dg.get(5);return!Ha.FileSharingUrl&&!yb}executeCommand(Ha,yb,Xb){Ha=this.$.workbookContext.FullDocumentInfo;var wc=ea.a.workflow,Vc=ua.TaskExtensions.Yj();const yd=yb.command;
if(yd===wc||-266099===yd)return this.Sei(yb,wc,Ha);switch(yd){case 1986648902:this.j9f();break;case -1570751769:this.jci(yb);break;case 869186573:yb=ea.a.EIj;Vc=A.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");wc=null;(Eb.EwaSettings.xa(478)||Vc)&&Xb&&"CopyLink"===Xb.SourceControlId?(wc={},wc[E.a.PNb]="copy",yb=ea.a.T9f):Vc&&Xb&&"ManageAccess"===Xb.SourceControlId?(wc={},wc[E.a.PNb]="manageAccess",yb=ea.a.GIj):Xb&&"LinkToComment"===Xb.SourceControlId&&(wc={},wc[E.a.PNb]="copy",wc[E.a.nUd]=Xb.navId,
yb=ea.a.T9f);Vc=this.ncg(Ha,wc);C.c(yb);break;case -1099009678:Vc=this.Rzc(12,Ha);break;case 192430811:Vc=this.Rzc(13,Ha);break;case 353606613:Vc=this.Rzc(14,Ha);break;case 783415632:Xb&&"LinkToThisSheet"===Xb.SourceControlId&&n.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");Vc=this.Rzc(15,Ha);break;case -59906385:case 1197060601:this.Ydi(yb,Ha);break;case 1305810481:this.Lbf(!1,yb);break;case 330035228:this.Lbf(!0,yb);break;case -509039657:Xb=
Eb.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(fb.c)(Ma.a.resolve(lb.w,{Wb:0})):la.GetServiceTaskFactory.Pa(this.$.da,498,499,0);ua.TaskExtensions.za(Xb,Od=>{this.deleteForm(Od.result)},this.$.ka,3);break;case 1334518759:yb.BBb=!0;Xb=Eb.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(fb.c)(Ma.a.resolve(lb.w,{Wb:0})):la.GetServiceTaskFactory.Pa(this.$.da,498,499,0);ua.TaskExtensions.za(Xb,
Od=>{this.shareForm(Od.result)},this.$.ka,3);break;case 710925581:se.a.rg.kAc("710925581")&&(Vc=ua.TaskExtensions.za(this.dK.value,Od=>{Od.result.uj(O.a.conversation,{})},this.ka,3));break;case 327119921:this.Xbi();break;default:Vc=eb.a(yd)}return Vc}Ac(Ha,yb){Ha=!1;yb=yb.command;if(yb===ea.a.workflow)return!0;switch(yb){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Ha=
!0;break;case 353606613:case -1099009678:case 192430811:Ha=Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:Ha=Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return Ha}Rc(Ha,yb,Xb){if("PopulateFormMenu"===yb){yb=this.UGc?this.TBe()?Je.UHh:Je.VHh:Je.wPi;Ha=this.Xa.Jc();for(let wc=0;wc<yb.length;wc++)Ha.buttons.push(this.Xa.ob(yb[wc]));yb=this.Xa.Bq("Forms.Flyout");
yb.uc.push(Ha);Xb.MenuItems=yb.AE();return!0}return!1}Sei(Ha,yb,Xb){return this.MQd&&Ha.command===yb?(this.KQd(Ha,-266099),ua.TaskExtensions.sba()):ua.TaskExtensions.za(this.dK.value,wc=>{dd.a(wc.result,O.a.workflow,null,Xb.WorkflowPostMessage)||xb.HelperMethods.nf(Xb.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ka,3)}TBe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Dg.get(26)}Xbi(){var Ha=Fc.a.create().toString();n.ULS.sendTraceTag(528581128,
306,50,`Calling share to teams deeplink with ID: ${Ha}`);var yb=this.$.frame,Xb=yb.z$a,wc=this.$;const Vc=new ie.QueryStringBuilder(A.AFrameworkApplication.fa.Wa("TeamsMeetingShareEndpoint"));Vc.hj("deeplinkId",Ha);Vc.hj("lm","deeplink");Ha=Vc.hj;var yd={};const Od=new ie.QueryStringBuilder(A.AFrameworkApplication.fa.Wa("TeamsAppSharingUrl"));Od.hj("auth","2");Od.hj("flight","officeunihost");Od.hj("source","TEAMS-ELECTRON.meetingStage.deeplink");var be={};be.fileType=t.a.k4(wc.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);
be.objectUrl=wc.workbookContext.FullDocumentInfo.WorkbookPath;be.baseUrl=wc.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{wc=wc.workbookContext.WorkbookFileVersionId;let Qb=decodeURIComponent(wc);for(;wc!=Qb;)wc=Qb,Qb=decodeURIComponent(wc);0>wc.indexOf("{")||0>wc.indexOf("}")?(n.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${wc}`),wc=""):wc=wc.substring(wc.indexOf("{")+1,wc.indexOf("}")).toLowerCase()}be.fileId=wc;be=T.c(T.c(be));Od.hj("subEntityId",
be.substring(1,be.length-1));yd.appSharingUrl=Od.toString();yd.appId=A.AFrameworkApplication.fa.Wa("TeamsAppId");yd.useMeetNow=Eb.EwaSettings.isChangeGateEnabled("OfficeVSO:7569119_MeetNowIsEnabled");yd=JSON.stringify(yd);Ha.call(Vc,"appContext",yd);Xb.call(yb,Vc.toString(),!0)}jci(Ha){this.MQd?this.KQd(Ha,1986648902):this.j9f()}Lbf(Ha,yb){!Ha&&this.$.ya.SurveyRedirectUrl?this.Ndj():(Ha=new We(this.$,Ha,yb),Ha.initialize(),Ha.fg())}Ydi(Ha,yb){this.MQd&&1197060601===Ha.command?this.KQd(Ha,-59906385):
ua.TaskExtensions.za(this.dK.value,Xb=>{Xb=Xb.result;Xb&&dd.a(Xb,O.a.replyWithChanges,null,this.$.ea.Dg.get(8))||(Xb=new Sys.StringBuilder(yb.ReplyWithChangesUrl),tc.a.Qk(Xb,Lc.e,Lc.d),de.a.ntw(Xb.toString(),this.$))},this.ka,3)}KQd(Ha,yb){const Xb=hd.a(this.$).kd.activityState,wc=new Hd.a(yb,Ha.method,Ha.mode,Ha.Ve,Ha.tabName);Cb.a(this.$).Br(new Xc.a(jc.a.tw,5,()=>{Xb[Jc.a.Fp]=jc.a.q3f;Xb[Cd.a.sXc]=wc;this.$.Yk.Qy("SocialSharingSaveBeforeCommand");this.$.Yk.gre(wc.command)}))}j9f(){const Ha=this.$.ya.DocumentHostInfo;
Ha.HostEmbeddedViewUrl||this.GBe?this.fbg():this.$.ke.get(53)&&ua.TaskExtensions.za(this.dK.value,yb=>{this.p1j(yb.result)||de.a.ntw(Ha.FileEmbedCommandUrl,this.$)},this.ka,3)}p1j(Ha){return Ha.isEnabled()&&(this.FBe||(this.FBe=Ha.Il(O.a.EBe,this.sTi)))?Ha.uj(O.a.uJh,null):!1}fbg(){if(ba.a.lp)de.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{const Ha=new qd(this.$);Ha.initialize();Ha.fg()}}deleteForm(Ha){const yb=this.$;Ha=new Tb(yb,1277,1278,1270,(Xb,wc,Vc)=>{var yd=yb.pa.va.$b(),Od=yb.pa.va;
yd=Od.Oa(9,yd);yd.surveyId=null;return ma.g(Od,"DeleteSurvey",yd,Xb,wc,Vc,null,0)},0,Ha);Ha.initialize();Ha.fg()}shareForm(Ha){const yb=this.$.workbookContext.FullDocumentInfo;this.$.ea.Dg.get(26)?(Ha=new qb(this.$,Ha),Ha.initialize(),Ha.fg()):ua.TaskExtensions.za(this.dK.value,Xb=>{dd.a(Xb.result,O.a.shareForm,{[E.a.aVj]:this.$.workbookContext.SurveyTitle},this.$.ea.Dg.get(10))||de.a.ntw(yb.ShareFormCommandUrl,this.$)},this.ka,3)}Ndj(){const Ha=this.$;Ha.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]",
"gi"),"");const yb=new Sys.StringBuilder(Ha.ya.SurveyRedirectUrl);tc.a.Qk(yb,"startupDialog","FormEdit");const Xb=hd.a(this.$),wc=Xb.kd.activityState;wc[Ac.a.p2]=yb.toString();wc[Ac.a.VL]=Ac.a.GBd;this.$.Yk.Qy("SocialSharingEnvironmentChange");Cb.a(Ha).Br(new Xc.a(jc.a.tw,5,()=>{const Vc=kb.a.hd(3,2,1322,1323,1324,554412057,"FossEnvironmentUnsupported");Xb.kd.ir([Vc]);wc[Jc.a.Fp]=jc.a.tlg}))}t4a(Ha=!1){return(this.$.ea.isEditMode||Ha)&&this.$.ea.Dg.get(25)&&rd.a()}n7h(Ha){var yb=db.h(this.$).ha;const Xb=
this.$.ua.na?Md.d(this.$.ua.na):null;if(!Xb)return n.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${ye[Ha]}.`),null;var wc=null;14===Ha?wc=this.M6h(yb):12===Ha?(wc=yb.Gia,wc=rb.a.contains(wc,"!",!0)?wc.split("!")[1]:wc):13===Ha&&(yb=yb.ra.selectedRanges,yb[0]&&(yb=db.h(this.$).tb.uh(yb[0])))&&(wc=yb.ej);if(!wc&&15!==Ha)return n.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${ye[Ha]}`),
null;yb={};yb[E.a.PNb]="copy";yb[E.a.nUd]=this.dYh(Ha,wc,Xb);yb[E.a.HIj]="deepLinkShare";n.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${ye[Ha]} and sectionNameOrId: ${wc} and SheetId: ${Xb}`);return yb}M6h(Ha){if(Ha.Sa.Z4&&(Ha=Ha.Sa.jc.floatingObject)&&0===Ha.type){const yb=Ha.id.split(".");if(1<yb.length)return yb[1];n.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${Ha.id}`)}return null}dYh(Ha,
yb,Xb){let wc=Ha+"_";wc=btoa(15===Ha?wc+Xb:wc+(yb+"_"+Xb));wc=wc.replace(RegExp("\\+","g"),"-");wc=wc.replace(RegExp("\\/","g"),"_");return wc=wc.replace(RegExp("\\=+$","g"),"")}ncg(Ha,yb,Xb=!1){return ua.TaskExtensions.za(this.dK.value,wc=>{dd.a(wc.result,O.a.sharing,yb,this.$.ea.Dg.get(5))?(n.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${yb?yb[E.a.PNb]:""}`),Xb&&Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&!this.kja&&(this.Y3a=window.setInterval(()=>{this.l_j()},6E4),this.kja=!0)):xb.HelperMethods.nf(Ha.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ka,3)}Rzc(Ha,yb){if(15===Ha&&!Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==Ha&&!Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;
const Xb=this.n7h(Ha);if(Xb)return n.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${Xb[E.a.nUd]}`),this.ncg(yb,Xb,!0);n.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${ye[Ha]}`);return null}l_j(){this.kja&&window.clearInterval(this.Y3a);Eb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.Yc(638984051,0,
0,null),n.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}Je.wPi=[103];Je.UHh=[107,104,105,106];Je.VHh=[104,105];Je.m6g=[new Yd.a(jc.a.nFe,554412057,0,0,1325),new Yd.a(jc.a.idle,554412057,0,1)];Object(h.a)(Je,"SocialSharingCommandHandler",bd.a,[222]);class ff extends ja.a{constructor(Ha){super(Ha)}ld(){const Ha=new w.a(()=>la.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Na));ua.TaskExtensions.za(la.GetServiceTaskFactory.create(this.$.da,
102,this.ka,this.Na),yb=>{this.fd([new Je(this.$,yb.result,Ha)])},this.ka,3)}static la(Ha){ja.a.Rd(114,new ff(Ha))}}Object(h.a)(ff,"SocialSharingCommandHandlerFactory",ja.a,[]);var Ae=a(1188);let pf=class{constructor(Ha){this.Uh=Ha}executeCommand(Ha,yb,Xb){return 2!==this.Uh.$d(ea.a.tryOfficeThroughTellMe,2,Xb)?Za.Task.Ta(!0):eb.a(yb.command)}Ac(Ha,yb){return 215809929===yb.command}Rc(){return!1}Mc(){return!1}};pf=Object(Ob.b)([Object(Ma.d)(lb.S),Object(Ob.c)(0,Object(lb.a)())],pf);Object(h.a)(pf,
"TryOfficeThroughTellMeCommandHandler",null,[222]);class he extends ja.a{constructor(Ha){super(Ha)}ld(){this.fd([new pf(A.AFrameworkApplication.rb)])}static la(Ha){ja.a.Rd(207,new he(Ha))}}Object(h.a)(he,"TryOfficeThroughTellMeCommandHandlerFactory",ja.a,[]);var Va=a(167),bc=a(272),yc=a(156),Hc=a(185);class Zc{static aV(){return yc.a.Iq(Zc.Ql,Hc.a.Ua(444))}}Zc.Ql="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(h.a)(Zc,"NamedSheetViewTeachingDialogHtml",null,[]);var Sd=a(73),ue=a(165),Fe=a(53);class Be extends bc.a{constructor(Ha){super(Ha);this.stopwatch=this.qt=null;this.HOi=yb=>{if(1===yb)this.$.Ia.Hb(new Hd.a(-2050946363,Sd.a.zb,2,8,null)).continueWith(Xb=>{this.qt.setResult(!ue.a(Xb)&&Xb.result)}),yb="Yes";else{const Xb=2===yb;this.qt.setResult(Xb);yb=2===yb?"No":"Close";Xb&&this.lcj()}this.EHi(yb);this.hide()}}get pc(){return"ShowNamedSheetViewTeachingDialog"}tg(){this.Rb=4;this.stopwatch=this.$.Mb.Kc("UserAction",
this.pc);const Ha=Sc.a.instance.ga(1913);this.qg=Zc.aV();this.qt=new Va.a;this.initializeAndShow(Ha,this.HOi,{});return this.qt.task}xy(Ha){super.xy(Ha);this.wc(1,Sc.a.instance.ga(1915));this.wc(2,Sc.a.instance.Ua(457))}lcj(){this.$.ea.ABd=!1}EHi(Ha){const yb={};yb.a=this.$.ya.UserSessionId;yb.b="NamedSheetViewTeachingDialogClose";yb.c=Ha;yb.e=!0;this.stopwatch&&(this.stopwatch.stop(),yb.d=this.stopwatch.Fc);Fe.b().Ze(53,yb,!0)}}Object(h.a)(Be,"NamedSheetViewTeachingDialog",bc.a,[]);var Ua=a(157);
let Rb=class{constructor(Ha){this.$=Ha;Object(Wa.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")||Ha.da.Ha(309,this)}lTa(){return this.MLj()?(new Be(this.$)).tg():Za.Task.Ta(!0)}MLj(){const Ha=this.$.ua.na;return this.$.ea.N$a&&this.$.ea.ABd&&!Ha.ie.uz&&this.$.ea.AM&&!Object(Ua.g)(this.$)}};Rb=Object(Ob.b)([Object(Ma.d)(lb.z),Object(Ob.c)(0,Object(lb.o)())],Rb);Object(h.a)(Rb,"NamedSheetViewPublic",null,[501]);class sc extends Pa.a{constructor(Ha){super();this.$=Ha;this.Gb()}create(){this.qb(this.$.da.Ba(309)||
new Rb(this.$))}static la(Ha){Ha.da.Ha(310,new sc(Ha))}}Object(h.a)(sc,"NamedSheetViewPublicFactory",Pa.a,[]);var Mc=a(7),id=a(1370),Ed=a(883),ee=a(464);class oe{constructor(Ha,yb,Xb,wc,Vc,yd,Od){this.title=Ha;this.body=yb;this.vcj=Xb;this.primaryButtonAction=wc;this.secondaryButtonAction=yd;this.P4f=Vc;this.targetObject=Od}}Object(h.a)(oe,"NamedSheetViewTeachingCalloutContent",null,[]);class Xe{constructor(Ha){this.Zme=0;this.Ggg=Ha}get Egg(){return this.Zme}get Ydj(){return this.Egg<this.Ggg.count?
this.Ggg.ma(this.Zme++):null}}Object(h.a)(Xe,"NamedSheetViewTeachingCalloutList",null,[]);var mf=a(1106),wf;let Kf=wf=class{constructor(Ha){this.$=Ha;this.stopwatch=this.K1b=this.bDc=this.DZd=null;this.Fgg=0}wki(Ha){this.Fgg=Ha;const yb=Object(Mc.a)(new m.a,{});wf.gti(Ha)?(yb.add(new oe(Sc.a.instance.Ua(446),Sc.a.instance.Ua(447),Sc.a.instance.ga(1943),()=>{this.S5(2,"Continue");this.zaa(!0)},Sc.a.instance.ga(1944),()=>{this.zaa();this.S5(1,"ExitGuide")},mf.a())),1===Ha&&yb.add(new oe(Sc.a.instance.ga(1945),
Sc.a.instance.Ua(449),Sc.a.instance.ga(1943),()=>{this.S5(2,"FirstEnterTempViewContinueSecond");this.zaa(!0)},Sc.a.instance.ga(1944),()=>{this.zaa();this.S5(1,"FirstEnterTempViewExitGuideSecond")},mf.a())),yb.add(new oe(Sc.a.instance.Ua(450),Sc.a.instance.Ua(451),Sc.a.instance.ga(1943),()=>{this.S5(2,"FirstEnterExitCalloutContinue");this.zaa(!0)},Sc.a.instance.ga(1944),()=>{this.zaa();this.S5(1,"FirstEnterExitCalloutGuide")},wf.l2h())),yb.add(new oe(Sc.a.instance.ga(1946),Sc.a.instance.Ua(448),Sc.a.instance.ga(1947),
()=>{this.yOj();this.zaa();this.S5(1,"LearnMore")},Sc.a.instance.ga(1948),()=>{this.zaa();this.S5(1,"Done")},wf.k2h()))):2===Ha&&yb.add(new oe(Sc.a.instance.ga(1945),Sc.a.instance.Ua(449),Sc.a.instance.ga(1942),()=>{this.zaa();this.S5(1,"EnterTempViewAfterPersistedView")},null,null,mf.a()));this.DZd=new Xe(yb)}yOj(){const Ha=new Hd.a(-859308420,Sd.a.zb,this.$.xc,9,null);this.$.Ia.Hb(Ha,{[Sd.a.Sf]:"HelpID=SheetViews",["InputMethod"]:Sd.a.zb,[Sd.a.Pc]:ae.a.mV,["ShouldCanvasTakeFocus"]:!0})}show(Ha){this.wki(Ha);
this.nfb()}cFj(Ha){this.K1b=Ha}nfb(){var Ha=this.DZd.Ydj;if(Ha){var yb=Object(Mc.a)(new id.a,{label:Ha.vcj,onExecute:Ha.primaryButtonAction}),Xb=null;Ha.P4f&&(Xb=Object(Mc.a)(new id.a,{label:Ha.P4f,onExecute:Ha.secondaryButtonAction}));Ha=Object(Mc.a)(new Ed.a,{target:Ha.targetObject,content:Ha.body,title:Ha.title,showCloseIcon:!0,primaryButtonProps:yb,secondaryButtonProps:Xb,useTeachingStyles:!0});Ha=this.K1b.callout(Ha);yb=Object(Mc.a)(new ee.a,{onShow:()=>{this.S5(0)}});this.bDc=this.K1b.addNotification(Ha,
yb)}}dismiss(){this.zaa();this.S5(1,"DismissedByOthers")}zaa(Ha=!1){this.bDc&&(this.K1b.removeNotification(this.bDc),this.bDc=null);Ha&&this.nfb()}S5(Ha,yb=null){const Xb={};Xb.a=this.$.ya.UserSessionId;Xb.b=this.Fgg;Xb.c=this.DZd.Egg;Xb.d=Ha;Xb.e=yb;0===Ha?this.stopwatch=this.$.Mb.Kc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Xb.f=this.stopwatch.Fc,this.stopwatch=null),2===Ha&&(this.stopwatch=this.$.Mb.Kc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));
Fe.b().Ze(52,Xb,!0)}static k2h(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static l2h(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static gti(Ha){return 0===Ha||1===Ha}};Kf=wf=Object(Ob.b)([Object(Ma.d)(lb.A),Object(Ob.c)(0,Object(lb.o)())],Kf);Object(h.a)(Kf,"NamedSheetViewTeachingCallout",null,[502]);class af extends Pa.a{constructor(Ha){super();this.$=Ha;this.Gb()}create(){let Ha=this.$.da.Ba(322);Ha||(Ha=new Kf(this.$),this.$.da.Ha(322,
Ha));this.qb(Ha)}static la(Ha){Ha.da.Ha(323,new af(Ha))}}Object(h.a)(af,"NamedSheetViewTeachingCalloutFactory",Pa.a,[]);var Wf=a(1284),Gf=a(1178),cg=a(1283);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(d.a)();Type.registerNamespace("CADWLTR");k.main();Type.registerNamespace("Common.App.NewAndOpen.UX");l.a.instance.si(new La);Object(va.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(Ba.a)();Object(Ea.a)();Object(pa.a)();Object($a.a)();Type.registerNamespace("Common.App.SharedFilePicker");ta.main();Type.registerNamespace("Common.App.WildFire");ya.main();
Object(V.a)();Z.a.Fa(Ab.la);Object(Jb.a)();Object(Gb.a)();Object(Nb.a)();Ja.a.ni(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{Z.a.Fa(Ha=>{Ka.la(Ha)})})();(()=>{Z.a.Fa(Ha=>{Ha.da.Ha(165,new Na(Ha))})})();Z.a.Fa(F.la);Object(na.a)();Object(hb.a)();Object(Ib.a)();Object(vc.a)();Object(nc.a)();Object(Pb.a)();Object(oc.a)();Object(Ic.a)();
Object(ec.a)();Object(mb.a)();Object(cg.a)();(()=>{Z.a.Fa(Ha=>{Eb.EwaSettings.isChangeGateEnabled("OfficeVSO:7505051_MoveBatchHandlerToNewServices")||mc.la(Ha)})})();Z.a.Fa(ff.la);Object(Ae.a)();(()=>{Z.a.Fa(Ha=>{Object(Wa.b)("OfficeVSO:7624545_MigrateTryOfficeThroughTellMeCommandHandlerService")||he.la(Ha)})})();(()=>{Z.a.Fa(Ha=>{Object(Wa.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")||(sc.la(Ha),af.la(Ha))})})();Object(Wf.a)();Object(Gf.a)();String(e);String(f);String(b);window.___1678693106894_closurehack=
e;window.___1678693106894_closurehack=f;window.___1678693106894_closurehack=b},727:function(r,B,a){a.d(B,"a",function(){return S});r=a(0);var c=a(7),b=a(15),e=a(91),f=a(229),d=a(13),h=a(113),l=a(183),k=a(4),w=a(90);B=a(242);var n=a(1088),x=a(18),m=a(5),u=a(330),t=a(52),y=a(12),v=a(77),A=a(14),z=a(21),C=a(93),H=a(926),I=a(1);class S extends B.a{constructor(P,D){super(document.createElement("div"));this.Asf=this.Que=this.Uoe=this.i5b=this.sca=this.p8=this.aP=this.Yy=null;this.Gwa=this.lV=this.hs=this.hideCloseButton=
!1;this.nUi=G=>{this.pD(G)};this.tUi=G=>{13===G.keyCode&&this.pD(G)};this.sDd=G=>{this.Xm(G.wb);return!0};this.yDd=G=>{this.UV(G.wb);return!0};this.Nqc=G=>{this.Pma(G.wb?G.wb:0);return!0};this.oUi=G=>{this.pD(G.Ea);return!0};this.ytg=(G=null)=>{this.Xm(G.inputMethod?G.inputMethod:0);return!0};this.ztg=(G=null)=>{this.UV(G.inputMethod?G.inputMethod:0);return!0};this.p1=P;this.uu=D;this.v0c=D.v0a.toString();this.title=D.title;this.message=D.message;this.set_visibilityMode(1)}get u2g(){return this.uu.v0a}get businessBar(){return this.p1}get actionButton(){return this.uu?
this.uu.actionButton:""}get Qsa(){return this.uu?this.uu.Qsa:""}get linkText(){return this.uu?this.uu.link:""}get jk(){return this.uu?this.uu.jk:""}get alt(){return this.uu?this.uu.alt:""}hoa(P){this.uu.businessBarType=P}dispose(){e.a.sc([this.i5b,this.aP,this.p8]);this.hs&&this.aP&&(f.a.instance.Aa(d.a.click,this.aP.domElement,this.sDd),h.KeyInputManager.instance.ix(this.domElement,this.Uoe));this.lV&&this.p8&&(f.a.instance.Aa(d.a.click,this.p8.domElement,this.yDd),h.KeyInputManager.instance.ix(this.domElement,
this.Que));this.Gwa&&this.sca&&(f.a.instance.Aa(d.a.click,this.sca,this.Nqc),h.KeyInputManager.instance.ix(this.domElement,this.Asf));this.sca=this.Yy=this.p1=this.p8=this.aP=null;super.dispose()}update(){}a4j(){this.xKe(!0)}M6c(){this.xKe(!1)}vjh(){const P=this.businessBar.$.Mb.vg("DOMUpdate","ReactBusinessBar");P.start();this.message=C.a.qf(this.message);this.title=C.a.qf(this.title);l.UISurfaces.ejd().then(D=>{D.initializeMessageBarInStore();let G=Object(c.a)(new H.a,{messageTitle:this.title,message:this.message,
isMultiline:!1,messageBarType:this.uu.businessBarType,dismissButtonAriaLabel:A.a.instance.ga(10)});this.hideCloseButton||(G.onDismiss=this.oUi);this.Gwa&&(G.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.Nqc});this.hs&&(G.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.ytg});this.lV&&(G.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.Qsa,["onExecute"]:this.ztg});I.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&
this.uu.iconName&&(G.messageBarIconProps={["iconName"]:this.uu.iconName});I.EwaSettings.isChangeGateEnabled("OfficeVSO:7476511_BizBarCallbackTelemetry")?D.createNewMessageBarWithCallback(this.domElement,G,()=>{P.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.uu.YJa} in: ${P.Fc} milliSeconds.`)}):D.createNewMessageBar(this.domElement,G);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.uu.YJa} could not be initialized`);return null});
k.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");I.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")||(this.domElement.tabIndex=0);this.businessBar.domElement.appendChild(this.domElement)}Dih(P){P||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var D=this.businessBar.$.Cb;
P=D+"ewaBusinessBarEntryBody"+this.v0c;const G=D+"ewaBusinessBarEntryTitle"+this.v0c;var E=D+"ewaBusinessBarEntryIcon"+this.v0c;this.domElement.className=n.a.Hxh;if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7409767_BizBarUpdateReduceInnerHtml")){y.DOMElementExtensions.JE(this.domElement);D=document.createElement("div");D.className=n.a.$Se;D.id=P;var O=document.createElement("div");O.className=n.a.ZSe;var N=document.createElement("a");N.className=n.a.fTe;N.title=this.alt;const J=document.createElement("span");
J.classList.add(x.a.tsb);J.classList.add(n.a.bTe);J.id=E;this.jk.length&&(E=document.createElement("img"),E.classList.add(this.jk),E.src=t.a.Le(0),J.appendChild(E));N.appendChild(J);O.appendChild(N);E=document.createElement("span");E.classList.add(n.a.eTe);E.id=G;E.innerText=C.a.qf(this.title);O.appendChild(E);E=document.createElement("span");E.classList.add(n.a.dTe);E.id="message";E.innerText=C.a.qf(this.message);O.appendChild(E);E=document.createElement("a");E.id="link";E.href="#";E.className=n.a.cTe;
E.innerText=C.a.qf(this.linkText);O.appendChild(E);E=document.createElement("span");E.classList.add(n.a.K$b);N=document.createElement("button");N.type="button";N.id="action";N.className=n.a.J$b;N.innerText=C.a.qf(this.actionButton);E.appendChild(N);O.appendChild(E);E=document.createElement("span");E.classList.add(n.a.K$b);N=document.createElement("button");N.type="button";N.id="altAction";N.className=n.a.J$b;N.innerText=C.a.qf(this.Qsa);E.appendChild(N);O.appendChild(E);D.appendChild(O);O=document.createElement("a");
O.className=n.a.aTe;O.tabIndex=0;O.setAttribute("role","button");E=document.createElement("span");E.id="close";E.classList.add(x.a.kv);N=document.createElement("img");N.classList.add(x.a.cac);N.src=t.a.Le(13);N.alt=A.a.instance.ga(793);N.title=A.a.instance.ga(793);N.setAttribute("role","button");E.appendChild(N);O.appendChild(E);D.appendChild(O);this.domElement.appendChild(D)}else D="<div class='"+n.a.$Se+"' id='{0}'><div class='"+n.a.ZSe+"'><a class='"+n.a.fTe+"' title='{1}'><span class='"+x.a.tsb+
" "+n.a.bTe+"' id='{2}'>",this.jk.length&&(D+="<img class='{3}' src='{4}'/>"),D+="</span></a><span class='"+n.a.eTe+"' id='{5}'>{6}</span><span class='"+n.a.dTe+"' id='message'>{7}</span><a id='link' href='#' class='"+n.a.cTe+"'>{8}</a><span class='"+n.a.K$b+"'><button type='button' id='action' class='"+n.a.J$b+"'>{9}</button></span><span class='"+n.a.K$b+"'><button type='button' id='altAction' class='"+n.a.J$b+"'>{10}</button></span></div><a class='"+n.a.aTe+"' tabindex='0' role='button'><span id='close' class='"+
x.a.kv+"'><img class='"+x.a.cac+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>",this.domElement.innerHTML=String.format(D,P,this.alt,E,this.jk,t.a.Le(0),G,this.title,this.message,this.linkText,this.actionButton,this.Qsa,t.a.Le(13),A.a.instance.ga(793));y.DOMElementExtensions.Rt(this.domElement,m.a.Zsa,G,P);this.sca=$get("link",this.domElement);y.DOMElementExtensions.setVisible(this.sca,this.Gwa);this.Gwa&&(f.a.instance.ta(d.a.click,this.sca,this.Nqc),this.Asf=h.KeyInputManager.instance.Mt(this.sca,
this.Nqc,w.a.Sh,w.a.nX));this.aP=new u.a(y.DOMElementExtensions.getElementById(this.domElement,"action"));this.aP.isVisible=this.hs;this.p8=new u.a(y.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.p8.isVisible=this.lV;this.hs&&(f.a.instance.ta(d.a.click,this.aP.domElement,this.sDd),this.Uoe=h.KeyInputManager.instance.Mt(this.aP.domElement,this.sDd,w.a.Sh,w.a.nX),this.lV&&(f.a.instance.ta(d.a.click,this.p8.domElement,this.yDd),this.Que=h.KeyInputManager.instance.Mt(this.aP.domElement,
this.yDd,w.a.Sh,w.a.nX)));this.Yy=$get("close",this.domElement);this.i5b=this.Fe.qe(this.Yy);this.i5b.la("click",this.nUi);this.i5b.la("keydown",this.tUi);y.DOMElementExtensions.setVisible(this.Yy,!this.hideCloseButton)}xKe(P){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&k.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?this.vjh():this.Dih(P)}Xm(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.uu.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.uu.YJa}`);
z.h(this.businessBar.$).No(!0)}UV(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.uu.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.uu.YJa}`);z.h(this.businessBar.$).No(!0)}Pma(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.uu.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.uu.YJa}`);z.h(this.businessBar.$).No(!0)}pD(P){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.uu.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.uu.YJa}`);this.set_visible(!1);
this.businessBar.removeEntry(this.u2g);v.g(P)}ZJ(){return I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&k.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?this.domElement.getElementsByTagName("button")[0]:this.aP.domElement}}Object(r.a)(S,"BusinessBarEntry",B.a,[])},798:function(r,B,a){a.r(B);var c=a(155);r=a(0);var b=a(7),e=a(15),f=a(4);a(27);var d=a(392),h=a(39),l=a(50),k=a(12),w=a(136),n=a(1),x=a(14),m=a(21);class u extends Sys.EventArgs{constructor(N){super();
this.Acj=N}}Object(r.a)(u,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var t=a(269),y=a(256);class v{constructor(N){this.lg=N}fi(){t.a(this.lg.$).zw(this.ee)||t.a(this.lg.$).fi(this)}b8(){t.a(this.lg.$).zw(this.ee)&&t.a(this.lg.$).Nz(this)}get ee(){return y.a.tRf}get mc(){const {PrintPreviewPane:N}=a(798);return document.getElementById(N.ycj)}get If(){return!0}Bh(N){return k.DOMElementExtensions.Df(this.mc,N)}Bj(){this.lg.$.frame.Se.rk(this.lg.$.frame.Se.ZE)}ik(){}eg(N,J){return J?
!1:(this.lg.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(r.a)(v,"PrintPreviewHeaderKeyboardAccessibleSection",null,[63]);class A{constructor(N){this.lg=N}fi(){t.a(this.lg.$).zw(this.ee)||t.a(this.lg.$).fi(this)}b8(){t.a(this.lg.$).zw(this.ee)&&t.a(this.lg.$).Nz(this)}get ee(){return y.a.uRf}get mc(){const {PrintPreviewPane:N}=a(798);return this.lg.useMSPdfViewer?document.getElementById(a(798).PrintPreviewPane.uHd):document.getElementById(N.NOf)}get If(){return!0}Bh(N){return k.DOMElementExtensions.Df(this.mc,
N)}Bj(){this.lg.$.frame.Se.rk(this.lg.$.frame.Se.ZE)}ik(){}eg(N,J){return J?!1:(this.lg.useMSPdfViewer?(N=document.getElementById(a(798).PrintPreviewPane.uHd))&&k.DOMElementExtensions.setFocus(N,!0):k.DOMElementExtensions.setFocus(this.lg.QK),!0)}}Object(r.a)(A,"PrintPreviewKeyboardAccessibleSection",null,[63]);class z{constructor(N){this.lg=N}fi(){t.a(this.lg.$).zw(this.ee)||t.a(this.lg.$).fi(this)}b8(){t.a(this.lg.$).zw(this.ee)&&t.a(this.lg.$).Nz(this)}get ee(){return y.a.xRf}get mc(){const {PrintPreviewPane:N}=
a(798);return document.getElementById(N.wRf)}get If(){return!0}Bh(N){return k.DOMElementExtensions.Df(this.mc,N)}Bj(){this.lg.$.frame.Se.rk(this.lg.$.frame.Se.ZE)}ik(){}eg(N,J){return J?!1:(this.lg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)}}Object(r.a)(z,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[63]);class C{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(r.a)(C,"MSPdfViewerFileUrl",null,[]);class H{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=
this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(r.a)(H,"PrintSettingsTaskPaneProps",null,[]);class I{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(r.a)(I,"ViewerPaneProps",
null,[]);var S=a(387),P=a(5);class D{}D.printDialogTitle="PrintDialogTitle";D.L$b="ewa-dlg-elements-container-rtl";D.uB="PrintPreviewerContainer";Object(r.a)(D,"CssClassNames",null,[]);var G=a(153),E=a(54);a.d(B,"PrintPreviewPane",function(){return O});class O extends h.a{constructor(N,J,W,ea){super();this.BEb=this.Omc=this.QK=this.uJb=this.uB=this.gW=this.SN=this.RN=null;this.AEb=!1;this.yxa=!0;this.zJd=this.wJd=this.xJd=this.ewaAccessibilityManager=this.Lsc=null;this.vrd=!1;this.TGf=()=>{e.ULS.sendTraceTag(537154206,
0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.AEb}`);this.AEb&&(this.$gi(),this.QK.style.visibility="visible",this.Omc?this.Omc.stop():e.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),this.raiseEvent(O.oGb,new u(1)),this.$Sd(),this.AEb=!1)};this.$=N;this.PF=J;this.hjh();this.useMSPdfViewer=W;this.isUniversalPrintEnabled=ea;this.isExportPdfMode=!1}UQg(N){this.addHandler(O.oGb,N)}ppj(N){this.removeHandler(O.oGb,
N)}WOj(N){this.isExportPdfMode=N;this.bjh()}XOj(){var N=this.$.Mb.Kc("UserAction","createSettingsPaneStopwatch");const J=document.getElementById(O.wRf);this.ijh();const W=this.jjh();this.SN.createPrintSettingsTaskPane(J,W);N.stop();this.AEb=!1;if(this.isUniversalPrintEnabled&&this.uB){N="A4";switch(W.selectedPrintSettingsValues.selectedPaperSize){case 8:N="A3";break;case 9:N="A4";break;case 11:N="A5";break;case 12:N="JIS B4";break;case 13:N="JIS B5";break;case 5:N="North America Legal";break;case 1:N=
"North America Letter";break;case 6:N="North America Invoice";break;case 7:N="North America Executive";break;case 3:N="North America Ledger"}this.RN.setDocumentSettings({mediaSize:N,orientation:2===W.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===W.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.lMd()}setPageRangeSettings(N,J,W,ea,R){this.SN&&(this.SN.setPageRangeSettings(N,J,W,ea,R),this.s8f(String.format(x.a.instance.nb(205),ea,R,N)))}Qgi(){this.uB&&
(this.uB.style.display="none")}Frh(){this.dispose();this.e1d();this.N0d();this.RN&&this.RN.closePrintPreviewPane();this.gW=this.SN=this.RN=this.uB=null}eFi(N){e.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.BEb=this.$.Mb.Kc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||e.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.gW.renderPdf(N)):this.QK&&((this.Omc=this.$.Mb.Kc("UserAction",
"loadPdfStopwatch"))||e.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.AEb=!0,this.QK.src&&this.QK.src===N?this.TGf(null):this.QK.src=N);if(this.uB){const J=S.b(this.$.workbookContext);this.RN.setFileUrl(N,J)}}onPdfLoad(){this.BEb?(e.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.BEb.Fc} ms, isFirstTimeLoad: ${this.yxa}`),this.BEb.stop()):e.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");
this.raiseEvent(O.oGb,new u(1));this.hideWaitCursor();this.enablePrintButton();this.$Sd()}printPdf(){k.DOMElementExtensions.setFocus(this.QK);this.QK.contentWindow.print()}LPj(){this.showSpinner();this.showWaitCursor();this.disablePrintButton();this.s8f("")}$gi(){this.hideSpinner();this.hideWaitCursor();this.enablePrintButton()}Xz(N,J,W=null){this.uB&&this.gW&&(this.vrd=!1,this.gW.showErrorDetails(J,N,W),this.PF.x7a=!0,this.QK&&(this.QK.src=""),this.hideWaitCursor(),this.disablePrintButton(),O.qwi(J)&&
(this.vrd=!0,this.e1i()))}hidePreviewError(){this.PF.x7a=!1;this.gW.hidePreviewError();this.enablePrintButton()}wrh(){(this.uJb=document.getElementById(O.vRf))&&this.uJb.parentNode&&this.uJb.parentNode.removeChild(this.uJb)}hideErrorMessageForPrintOptions(){this.SN&&this.SN.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(N){this.SN&&this.SN.showErrorMessageForPrintOptions(N)}showSpinner(){this.PF.x7a||this.vrd?this.hidePreviewError():this.QK&&(this.QK.style.visibility="hidden");
this.gW&&this.gW.showSpinner()}hideSpinner(){this.gW&&this.gW.hideSpinner()}enablePrintButton(){this.uB&&this.RN.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.uB&&this.RN.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.SN&&this.SN.showWaitCursor()}hideWaitCursor(){this.SN&&this.SN.hideWaitCursor()}fjh(){if(this.uB)e.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.uB=document.createElement("div"),
this.uB.id=O.vRf,this.uB.classList.add(O.Bcj),this.$.Hp.insertBefore(this.uB,this.$.Hp.firstChild),f.AFrameworkApplication.sa&&f.AFrameworkApplication.sa.Qa.kf){const N=document.getElementById(P.a.Vsa);N&&(this.uB.style.top=`${N.clientHeight}px`,this.uB.style.height=`calc(100vh - ${N.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.RN.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.RN.enterPrintSettingsTaskPaneFocusTrapZone()}maj(){this.$.da.hb(15,
N=>{this.ewaAccessibilityManager=N;this.ewaAccessibilityManager.mode=3})}hjh(){this.zJd=new z(this);this.xJd=new A(this);this.wJd=new v(this)}lMd(){this.zJd.fi();this.xJd.fi();this.wJd.fi();this.maj()}e1d(){this.zJd.b8();this.xJd.b8();this.wJd.b8();m.h(this.$).D0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}qI(){this.Lsc=w.a.instance.qe(this.QK);this.Lsc.la("load",this.TGf)}N0d(){this.Lsc&&this.QK&&this.Lsc.detach("load")}$Sd(){this.EDj(O.zcj,O.APi)}EDj(N,J){this.yxa&&(N=
document.getElementById(N))&&(J=k.DOMElementExtensions.getElementById(N,J))&&(this.yxa=!1,J.focus())}e1i(){this.PF.x7a=!1;this.enablePrintButton();this.$Sd()}bjh(){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService"))void G.a.resolve(E.l,{Wb:0}).then(J=>Object(c.a)(this,void 0,void 0,function*(){yield J("excel-print-preview-sprite");yield J("printPreviewer");yield J("excelPrintPreviewer");this.FKe()}));else{var N=l.GetServiceTaskFactory.Pa(this.$.da,283,284,0).result.Ll;
N.loadScript("excel-print-preview-sprite").then(()=>{N.loadScript("printPreviewer").then(()=>{N.loadScript("excelPrintPreviewer").then(()=>{this.FKe()})},()=>{e.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{e.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}}FKe(){const N=this.$.Mb.Kc("UserAction",
"createEmptyPreviewerStopwatch");this.fjh();this.gjh();this.RN.createEmptyPrintPreviewPaneAsync(this.uB,this.ejh()).then(()=>{N.stop();this.ibh();this.RN.updatePrintButtonEnableDisableState(!1)})}ibh(){const N=this.$.Mb.Kc("UserAction","createPdfPreviewPaneStopwatch"),J=document.getElementById(O.uHd);this.useMSPdfViewer&&(J.tabIndex=0);this.Nih();this.Mih(J);N.stop();this.raiseEvent(O.oGb,new u(0))}gjh(){this.RN||(this.RN=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());
this.RN||e.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}ijh(){this.SN||(this.SN=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.SN||e.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}Nih(){this.gW||(this.gW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());
this.gW||e.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}Mih(N){this.gW.createPrintPreviewPane(N,this.tlh());this.useMSPdfViewer||(this.QK=k.DOMElementExtensions.getElementById(this.uB,O.NOf),this.QK.title=x.a.instance.ga(1212),this.qI())}jjh(){let N,J="en-US";N=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?J=this.$.ya.DataCultureTag:e.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");
return Object(b.a)(new H,{whatToPrintOptions:this.PF.Kv.whatToPrintOptions,orientationOptions:this.PF.Kv.orientationOptions,paperSizeOptions:this.PF.Kv.paperSizeOptions,scalingOptions:this.PF.Kv.scalingOptions,marginDetailedOptions:this.PF.x1h(),selectedPrintSettingsValues:this.PF.B4h(),printSettingsTaskPaneCallbacks:this.PF.z4h(),logger:new d.a,shouldDisableCurrentSelection:this.PF.D$f(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:N,dataCultureTag:J,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}ejh(){return this.PF.x4h()}tlh(){return this.useMSPdfViewer?
Object(b.a)(new I,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.aih(),onPdfLoad:()=>{this.onPdfLoad()}}):Object(b.a)(new I,{useMSPdfViewer:!1})}aih(){return Object(b.a)(new C,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})}s8f(N){this.uB&&this.RN.setAdditionalHeaderText(N)}static qwi(N){return 3===N||2===N}}O.vRf="PrintPreviewerContainer";O.wRf="printSettingsTaskPaneId";O.uHd=
"previewId";O.NOf="printpreviewiframe";O.ycj="printPreviewHeaderId";O.zcj="printPreviewPaneId";O.APi="printButtonId";O.Bcj=D.uB;O.oGb="pppnosu";Object(r.a)(O,"PrintPreviewPane",h.a,[477])},858:function(r,B,a){a.d(B,"a",function(){return d});r=a(0);var c=a(15),b=a(4),e=a(41),f=a(27);class d{static o2e(h,l){switch(h){case 3:return d.X$h(l);case 2:return d.u3h(l);case 1:return d.sYh(l)}return""}static X$h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static u3h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static sYh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,
l,k){if(f.a.Pg||f.a.jp)window.setTimeout(()=>{d.SVf(k,d.Uec())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.Bve(k),h,0,!1)}static X8g(h,l,k,w){l&&w&&w();d.openInClient(h,l,k)}static Uec(){return f.a.Pg?1:f.a.jp?2:f.a.d9a?3:f.a.isMac?4:0}static T$h(h){switch(h){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static U$h(h){switch(h){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";
case 1:return"WildFireExcelBizBarFlight";default:return""}}static get dCb(){return"zh-CN"===window.navigator.language}static SVf(h,l){1===l?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),h=d.o2e(h,l),8<f.a.C6a?e.a.nf(h,void 0,void 0,"RedirectToAppStore"):e.a.TU(h)):document.hidden||(d.dCb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.TU(h)):c.ULS.sendTraceTag(18088019,
306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.o2e(h,l),null,null)))}static Bve(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get GAc(){return(f.a.d9a||f.a.isMac)&&f.a.kp}static get dMj(){return f.a.Pg||f.a.jp}static wgd(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Msd(h){return(h=
d.u0h(h))&&""!==h?Boolean.parse(h):!1}static VTd(h){d.yEj(h)}static u0h(h){try{return localStorage.getItem(h)}catch(l){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static yEj(h){try{localStorage.setItem(h,"true")}catch(l){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}d.XDe="ChromeExtensionBarDismiss";Object(r.a)(d,"WildFireUtilities",null,[])},966:function(r,
B,a){a.r(B);r=a(155);var c=a(0),b=a(15),e=a(4),f=a(91),d=a(27),h=a(138),l=a(270),k=a(39),w=a(84),n;(function(T){T[T.unableToRefreshLock=0]="unableToRefreshLock";T[T.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";T[T.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";T[T.workbookTooLarge=3]="workbookTooLarge";T[T.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";T[T.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";T[T.editAndRefreshDisabledOnBIAHostedFiles=
6]="editAndRefreshDisabledOnBIAHostedFiles";T[T.unsupportedFeatures=7]="unsupportedFeatures";T[T.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";T[T.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";T[T.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";T[T.lastGenericStatusError=11]="lastGenericStatusError";T[T.scratchPadWarning=12]="scratchPadWarning";T[T.authenticationLost=13]="authenticationLost";T[T.odfCompatibilityIssues=14]="odfCompatibilityIssues";
T[T.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";T[T.workbookIsIrmProtected=16]="workbookIsIrmProtected";T[T.biFeatureNotAvailable=17]="biFeatureNotAvailable";T[T.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";T[T.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";T[T.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";T[T.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";T[T.editAttemptInReadOnly=
22]="editAttemptInReadOnly";T[T.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";T[T.unsupportedBrowser=24]="unsupportedBrowser";T[T.readOnlyPermissions=25]="readOnlyPermissions";T[T.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";T[T.policyWarningMessage=27]="policyWarningMessage";T[T.workingOnIt=28]="workingOnIt";T[T.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";T[T.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";
T[T.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";T[T.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";T[T.legacyConnectionsBB=33]="legacyConnectionsBB";T[T.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";T[T.groupedSlicersBB=35]="groupedSlicersBB";T[T.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";T[T.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";T[T.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";
T[T.wacGdprNotice=39]="wacGdprNotice";T[T.automaticSensitivityLabel=40]="automaticSensitivityLabel";T[T.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";T[T.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";T[T.localStorageDisabled=43]="localStorageDisabled";T[T.autoRefreshDisabled=44]="autoRefreshDisabled";T[T.corruptedFileRepaired=45]="corruptedFileRepaired";T[T.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";T[T.minorVersionLimitReached=47]="minorVersionLimitReached";
T[T.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";T[T.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";T[T.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";T[T.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";T[T.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";T[T.sensitivityApplicationMinorVersionLimitReachedError=
53]="sensitivityApplicationMinorVersionLimitReachedError";T[T.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";T[T.promptEnableExternalLinks=55]="promptEnableExternalLinks";T[T.networkDown=56]="networkDown";T[T.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";T[T.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";T[T.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";T[T.canvasHealth=60]="canvasHealth";T[T.mismatchedFileFormatConverted=
61]="mismatchedFileFormatConverted";T[T.optimizeWorkbook=62]="optimizeWorkbook";T[T.novModePostDepreciation=63]="novModePostDepreciation";T[T.officeScriptsRunning=64]="officeScriptsRunning";T[T.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";T[T.readOnlyPivotTable=66]="readOnlyPivotTable";T[T.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";T[T.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";T[T.msFormsDataSyncStatus=
69]="msFormsDataSyncStatus";T[T.count=70]="count"})(n||(n={}));Object(c.b)("EwaBusinessBarEntryType",n);var x=a(5),m=a(1089);class u extends Sys.EventArgs{constructor(T,ka,L=null){super();this.v0a=T;this.j$c=ka;this.data=L}}Object(c.a)(u,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var t=a(1091),y=a(1090),v=a(1093);a(1092);var A=a(1087),z=a(478),C=a(50),H=a(38),I=a(659),S=a(29),P=a(1),D=a(22),G=a(21),E=a(61),O=a(74),N=a(858),J=a(33),W=a(40),ea=a(153),R=a(54);a.d(B,"BusinessBarManager",
function(){return da});var Y;const U=[55,39,5,30,16,14,7,41,4,37];let da=Y=class extends w.a{constructor(T,ka=!T.K4){super();this.Ra=new k.a;this.LP=null;this.qLc=[];this.Kpc=()=>{this.$.pa.QMa?this.removeEntry(13):this.sh(13,null)};this.nh=(L,fa)=>{for(let wa=0,oa=Y.Wec().length;wa<oa;wa++)L=Y.Wec()[wa],this.removeEntry(L);fa.context&&0<fa.context.communicationErrorRetryCount&&(b.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
this.removeEntry(21));this.vrj()};this.zm=(L,fa)=>{var wa;L=this.lKh(fa.errors);let oa=[];for(let bb=0,Za=L.length;bb<Za;++bb){const La=L[bb];if(1===La.Type&&La.Appearance&32)oa=this.jei(La,oa);else if(fa.mBj){b.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var xa=(null===(wa=fa.context)||void 0===wa?0:wa.stopwatch)?fa.context.stopwatch.Fc:-1;5E3>xa?b.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${xa}ms).`):
e.AFrameworkApplication.fzi()||this.tOg(La,fa.context.methodName)}xa=[...Y.Wec()];for(let va=0,Ba=oa.length;va<Ba;++va){const Ea=oa[va];this.sh(Ea,La);Array.remove(xa,Ea)}for(let va=0,Ba=xa.length;va<Ba;++va)this.removeEntry(xa[va])}};this.Wc=(L,fa)=>{this.yc(L,fa)};this.yc=()=>{const L=this.$.ea;L.Yb||L.Ef()||(this.DMd(),this.qLc.length=0)};this.od=(L,fa)=>{this.$.ea.Ef()&&!fa.EV||this.qgf(fa.EV)};this.ZHb=()=>{const L=this.$.userOperationManager.Hec();L&&L.operation.flags&1&&this.Bbg()};this.qGf=
()=>{this.Bbg()};this.xf=()=>{this.zDe();this.Jbg()};this.BN=()=>{if(this.$.p5&&this.$.ea.Ef()&&this.$.ea.Yb)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const L=this.$.da.Ba(331);L&&L.qKa||this.removeEntry(55);this.removeEntry(5)}};this.$=T;this.l_a=ka;this.$Wg();e.AFrameworkApplication.Hd&&e.AFrameworkApplication.Hd.$Xc(this);
this.BGa=Array(70);for(let L=0;70>L;L++)this.BGa[L]=null;this.Ch=I.EcmaDateClock.instance;this.Uqf=this.Ch.Zb.getTime();ka&&(ka=T.pa,ka.Ax(this.zm),ka.kr(this.nh),ka.epb(this.Kpc),ka.IZa(this.Kpc),T.ea.Oj(this.Wc),T.ea.ju(this.xf),T.hl(this.od),T.ij(this.yc),T.ea.x2(this.BN),T.userOperationManager.jr(this.ZHb),P.EwaSettings.xa(158)&&T.ea.Dg.get(45)&&e.AFrameworkApplication.fa.qa("SupportsPolicies")||this.bcf(),this.qgf(E.c(T)));T.da.Ha(5,this);J.a.L8a()&&(this.$.ROb=this.cqi())}bcf(){S.a.wq(this.$.ea.MF)&&
this.zm(this,new z.a(this.$.ea.MF,null,!1,-1,-1,-1,-1,"",-1,"",-1))}YOg(T){this.Ra.addHandler("bBarAttachedOrDetached",T)}get mad(){return this.qLc}get domElement(){return this.LP?this.LP.domElement:null}dispose(){if(this.$){const T=this.$,ka=T.pa;ka.uy(this.zm);ka.zs(this.nh);ka.Evc(this.Kpc);ka.KKb(this.Kpc);T.ea.pk(this.Wc);T.ea.Lv(this.xf);T.em(this.od);T.$k(this.yc);T.ea.Z6(this.BN);T.userOperationManager.ao(this.ZHb);G.h(T).Xb.Zk(this.qGf)}f.a.Ja(this.LP);this.$=this.LP=null;super.dispose()}cqi(){for(let T=
0;T<U.length;T++)if(this.BGa[U[T]])return!0;return!1}Fqi(T){switch(T){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:return!0;default:return!1}}sh(T,ka,L=null,fa=null,wa=null){if(!this.$.isMobileMode||this.Fqi(T))this.l_a&&!this.bH(T)&&(this.BGa[T]=this.Ch.bfa,this.LP.rE(T,ka,fa,wa),J.a.L8a()&&this.b4j(T),this.Ra.raiseEvent("bBarAttachedOrDetached",new u(T,!0,L))),ka&&32===ka.Appearance&&O.a(this.$).kd.Cca(ka)}XNj(T,ka,L,fa){b.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");
A.a.initialize(T,ka,L,fa);this.sh(39,null)}WMj(T,ka,L,fa){m.a.initialize(T,ka,L,fa);this.sh(40,null)}ePj(T,ka,L,fa){y.a.initialize(T,ka,L,fa);this.sh(41,null)}vOj(T,ka,L,fa){t.a.initialize(T,ka,L,fa);this.sh(42,null)}lPj(T,ka,L,fa){v.a.initialize(T,ka,L,fa);this.sh(54,null)}removeEntry(T){this.l_a&&(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&b.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(n,T)}`),this.BGa[T]=null,this.LP.removeEntry(T)&&
this.Ra.raiseEvent("bBarAttachedOrDetached",new u(T,!1)))}qla(T){return this.l_a?this.LP.qla(T):!1}bH(T){return this.l_a?this.LP.bH(T):!1}aGb(){b.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}Soc(){b.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}$Wg(){const {BusinessBarControl:T}=a(1182);if(this.l_a&&!this.LP){G.h(this.$).Xb.gl(this.qGf);
var ka=document.getElementById(this.$.Cb+x.a.zAe);this.LP=new T(this.$,ka)}}DMd(){this.l_a&&this.LP.DMd()}b4j(T){0<=U.indexOf(T)&&!this.$.ROb&&(this.$.ROb=!0,this.$.v3b=T,this.$.OZc&&this.B6f(!0))}vrj(){if(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const ka=this.Ch.bfa;if(3E5<=ka-this.Uqf){this.Uqf=ka;for(let L=0;70>L;L++){var T=this.BGa[L];if(T&&(T=ka-T,3E5<=T)){const fa=Enum.toString(n,L);b.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${fa}] was activated but not turned off for ${T} Millis`)}}}}}lKh(T){const ka=
[];for(const L of T)switch(L.MessageId){case -113742550:const fa=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||S.a.lh(T,fa))&&ka.push(-113742550)}return S.a.Oz(T,ka)}jei(T,ka){switch(T.MessageId){case 2113407564:const L=S.a.r0a([1821390342,-943219229,-502303485,1437034227]);for(let fa=0;fa<L.length;fa++)L[fa].HelpTopicId=T.HelpTopicId,L[fa].HelpDescription=T.HelpDescription,this.qLc.push(L[fa])}switch(T.MessageId){case -395951567:this.sh(6,
T);break;case 1643490758:this.sh(4,T);break;case -907264831:this.sh(5,T);break;case 757111532:case 2113407564:this.sh(7,T);break;case 2010656511:this.sh(15,T);break;case 1321660996:this.$.R8c=!0;this.sh(8,T);break;case 526339737:this.$.R8c=!0;this.sh(9,T);break;case -407088521:this.sh(10,T);break;case 1756116017:this.sh(14,T);break;case -1703455218:this.sh(17,T);break;case 1393475740:this.sh(25,T);break;case -949523941:this.sh(26,T);break;case 1779381952:this.sh(44,T);break;case 1421575100:this.sh(45,
T);break;case 613676060:this.sh(46,T);break;case 1233668252:this.sh(61,T);break;case 1911608588:T=!!(this.$.Bd&64);!this.$.ea.Ef()&&T&&ka.push(29);break;case 1544494907:break;case -655555355:ka.push(this.Xud()?1:0);break;case -1221382671:ka.push(2);break;case 1662282929:ka.push(3);break;case 104919273:this.$.ea.Ef()||ka.push(30);break;case -689453604:T=!!(this.$.Bd&64);this.$.ea.ndf=!0;!this.$.ea.Ef()&&T&&ka.push(31);break;case 157762400:this.$.ea.Hjc=!0;!this.$.ea.Ef()&&this.$.Bd&64&&!this.$.isEditMode&&
ka.push(32);break;case -1125398042:P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.Ef()&&this.$.Bd&64&&!this.$.isEditMode&&ka.push(34);break;case -73730134:!this.$.ea.Ef()&&this.$.Bd&64&&ka.push(33);break;case -293349236:ka.push(65);break;case 1580811823:ka.push(67);break;case -37299333:break;case 136737622:ka.push(47);break;case -1780327030:this.sh(55,T);break;case -113742550:this.sh(57,T);break;case -260312420:this.$.ea.Ef()||ka.push(66);
break;default:this.sh(11,T)}return ka}Eki(){if(e.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!N.a.Msd(N.a.wgd(1))&&(d.a.jp||d.a.Pg)){const T=C.GetServiceTaskFactory.create(this.$.da,155,this.$.ka,1);H.TaskExtensions.za(T,()=>{this.sh(20,null)},this.ka,3)}}Vji(T){T||3!==this.$.workbookContext.WorkbookNovType||this.sh(63,null)}qgf(T){(!T&&!this.$.printingEnabled||this.$.ke.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(b.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),
this.sh(16,null));this.Eki();this.zDe();this.Jbg();this.Vji(T)}zDe(){this.$.workbookContext.Options&32768&&this.MNj()}MNj(){this.BGa[37]||this.sh(37,null)}NPj(){this.BGa[38]||this.sh(38,null)}Jbg(){this.$.workbookContext.Options&524288&&this.sh(59,null)}gcg(T,ka){this.sh(58,T,null,ka)}Yqe(T,ka=null){this.LP.bH(T)?this.LP.WQb(T,ka):this.sh(T,null,null,null,ka)}Bbg(){this.$.Bd&8&&this.sh(12,null)}Xud(){const T=this.$.da.Ba(38);return T?T.tokenExpired:!1}tOg(T,ka){if(!this.bH(21)&&-1387426400!==T.MessageId){b.ULS.sendTraceTag(537170204,
0,50,"BusinessBar: raising the transient communication failures notification.");const L={};L.FailedMethod=ka;this.sh(21,T,L)}}static Wec(){return Y.zue||(Y.zue=[0,1,2,3])}B6f(T){try{const fa=h.a.get(x.a.cHd);if(D.a.ah(fa))b.ULS.sendTraceTag(509682970,0,50,"BusinessBarManager.setBusinessBarFlagInCookie: Can't find skeleton cookie eventough alreadyDefinedSkeletonCookie = true. Set page load skeleton cookie."),this.$.yTd();else{var ka=W.a(decodeURIComponent(fa)),L=ka.Options;ka.Options=T?L|4096:~(~L|
4096);try{const wa=W.c(ka);h.a.Bs(x.a.cHd,wa,l.AFrame.PO);b.ULS.sendTraceTag(509686989,0,50,"BusinessBarManager.setBusinessBarFlagInCookie: Business bar flag in PageLoadSkeletonState cookie has been raised");h.a.Bs(x.a.w3b,this.$.v3b.toString(),l.AFrame.PO)}catch(wa){b.ULS.sendTraceTag(509686988,0,50,`BusinessBarManager.setBusinessBarFlagInCookie: Failed setting PageLoadSkeletonState cookie with error message: ${wa.message}`)}}}catch(fa){b.ULS.sendTraceTag(509686987,0,50,`BusinessBarManager.setBusinessBarFlagInCookie: exception while parsing PageLoadSkeletonCookie. Message: ${fa.message}`)}}zgd(T){return this.LP.zgd(T)}};
da.zue=null;da=Y=Object(r.b)([Object(ea.d)(R.e),Object(r.c)(0,Object(R.o)())],da);Object(c.a)(da,"BusinessBarManager",w.a,[644,3,72])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/a69aa3fbf9d0ab2f522874a4063ebeb7/EwaDSEsNext.kmhv.js.map