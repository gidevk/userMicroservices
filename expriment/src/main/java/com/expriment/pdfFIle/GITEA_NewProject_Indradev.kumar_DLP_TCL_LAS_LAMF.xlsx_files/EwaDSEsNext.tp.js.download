'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[62],{1481:function(r,B,a){a.r(B);var c=a(0),b=a(517),e=a(48),f=a(9),d=a(52),h=a(91),l=a(87),k=a(228),w=a(425),n=a(38),x=a(7),m=a(15),u=a(90),t=a(86),y=a(229),v=a(13),A=a(113),z=a(4),C=a(92),H=a(158),I=a(127),S=a(431),P=a(99),D=a(751),G=a(5),E=a(132),O=a(379),N=a(198),J=a(291),W=a(33),ea=a(256),R=a(575),Y=a(12),U=a(1),da=a(11),T=a(14),ka=a(21),L=a(133),fa=a(163),wa=a(351),oa=a(702),xa=a(559),bb=a(18),Za=a(561),La=
a(73),va;(function(tc){tc[tc.NavigateToPane=24]="NavigateToPane"})(va||(va={}));Object(c.b)("InsightsActionType",va);var Ba;(function(tc){tc[tc.Feedback=0]="Feedback"})(Ba||(Ba={}));Object(c.b)("TargetPane",Ba);var Ea;(function(tc){tc[tc.Error=0]="Error"})(Ea||(Ea={}));Object(c.b)("InsightsResponseType",Ea);class pa{constructor(tc){this.$=tc}Mkj(){window.addEventListener("message",this.onMessage.bind(this))}blg(){window.removeEventListener("message",this.onMessage.bind(this))}onMessage(tc){if(pa.bqi(tc.origin)){var dd;
try{(dd=tc.data)&&"string"===typeof dd&&(dd=JSON.parse(dd)),tc.source!==window&&dd&&void 0!==dd.actionType&&this.actionHandler(dd)}catch(Hd){tc.source.postMessage(JSON.stringify({responseType:Ea.Error,errorMessage:Hd?Hd.message:void 0}),tc.origin)}}}actionHandler(tc){if(tc)switch(tc.actionType){case va.NavigateToPane:this.navigateToPane(tc.data);break;default:throw Error(`unknow action type: ${tc.actionType}`);}}navigateToPane(tc){switch(tc){case Ba.Feedback:this.$.Yc(802602464,La.a.zb,12,{[G.a.VJ]:"AnalyzeDataPane"});
break;default:throw Error(`unknow navigate pane: ${tc}`);}}static bqi(tc){return tc&&tc.endsWith("insights.microsoft.com")?!0:!1}}Object(c.a)(pa,"InsightsTaskPaneListener",null,[]);const $a=bb.a.Nbd;class cb extends P.a{constructor(tc,dd,Hd,Xc){super(tc);this.vTg='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.u1b=null;this.rod=this.Mhg=!1;this.Abe=this.wj=this.hf=null;this.Qv=0;this.button=null;this.wSf=!1;this.dfc="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=
gd=>{if(void 0!==gd.Ea&&null!==gd.Ea&&gd.Ea.keyCode===u.a.Fy)if(gd.Ea.shiftKey){if(!W.a.Gd(this.$)){gd=this.$.da.Ba(183);if(!gd)return!1;gd.aTd()}}else this.eg(!0,!1),gd.Ea.preventDefault(),gd.Ea.stopPropagation();return!0};this.grc=(gd,je)=>{Object.getType(je)===String&&je.toString()===this.hf.InstanceId&&(gd=!!this.title,je=!this.rod,gd&&this.kRe(),this.fkg(),W.a.Gd(this.$)&&(gd&&this.Mhg||je&&this.rod)&&this.P7.updateTaskPane(this.R0,this.IB))};this.Hma=()=>{var gd;U.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&
this.wj.dNd(this.hf.InstanceId);this.bxa&&(this.bxa.blg(),this.bxa=void 0);const je=R.a(this.hf);if(je)if(this.hf.TaskpaneTitle===T.a.instance.ga(984))m.ULS.sendTraceTag(537151139,9,50,"Chart task pane closed");else if(this.hf.PrimaryMarketplace)if("FA000000005"===this.hf.PrimaryMarketplace.SolutionId){m.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let Ee="Unknown",ae="Unknown",Yb="Unknown";null===(gd=this.hf.OsfPropertyBag)||void 0===gd?void 0:gd.forEach(Sc=>{2===Sc.length&&("LaunchMode"===
Sc[0]?Ee=Sc[1]:"CorrelationId"===Sc[0]?ae=Sc[1]:"LaunchSelectionMode"===Sc[0]&&(Yb=Sc[1]))});gd={["LaunchMode"]:Ee,["CorrelationId"]:ae,["LaunchSelectionMode"]:Yb,["Location"]:"taskPane"};L.b(this.$).qd(E.a.v9g,gd,void 0,!0);'"Default"'===Ee?t.a.instance.Tb("Common.ISystemInitiatedFeedback").execute(Sc=>{Sc.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===Ee?t.a.instance.Tb("Common.ISystemInitiatedFeedback").execute(Sc=>{Sc.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",
null)}):'"RecommendedPivotTables"'===Ee&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?t.a.instance.Tb("Common.ISystemInitiatedFeedback").execute(Sc=>{Sc.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===Ee&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&t.a.instance.Tb("Common.ISystemInitiatedFeedback").execute(Sc=>{Sc.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",
null)})}else W.a.rpi()&&"FA000000043"===this.hf.PrimaryMarketplace.SolutionId?"Record Actions"===this.hf.TaskpaneTitle&&(this.$.Uba=!1,m.ULS.sendTraceTag(537151137,0,50,"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.hf.PrimaryMarketplace.SolutionId===S.b?this.ruf(!1):"FA000000075"===this.hf.PrimaryMarketplace.SolutionId&&(U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1)||U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",
!1))&&(gd=this.$.da.Ba(465))&&(gd.Tmi(),gd.UOe());da.HelperMethods.Aw(this.hf)?this.Sg(!1):(W.a.Gd(this.$)?this.P7.hideTaskPane(this.R0):this.raiseEvent("AgavePaneRemovedEventKey"),this.wj.mRa(this.hf.InstanceId),W.a.Gd(this.$)||this.P7.KB());ka.h(this.$).setFocus();if(1===this.hf.WebExtensionOsfControlType&&!je){this.hf.TaskpaneVisible=!1;const Ee=this.$.pa.va.$b();O.a(this.$.userOperationManager,(ae,Yb,Sc)=>J.c(this.$.pa.va,this.hf.InstanceId,!1,ae,Yb,Sc,Ee),ae=>new N.a(547,0,ae,64),null)}return!0};
this.DIf=(gd,je)=>{Object.getType(je)===String&&je.toString()===this.hf.InstanceId&&(W.a.Gd(this.$)?this.P7.hideTaskPane(this.R0):this.raiseEvent("AgavePaneRemovedEventKey"))};this.CIf=(gd,je)=>{Object.getType(je)===String&&je.toString()===this.hf.InstanceId&&(this.k0d(),W.a.Gd(this.$)?this.E6():this.P7.yI(this,!0))};this.onResize=()=>{this.Tad()};this.$=dd;this.P7=Hd;Xc.jh(this.domElement,String.format(this.vTg,$a,this.$.Cb+G.a.uue,this.$.Cb+G.a.tue));this.Gvg=Y.DOMElementExtensions.getElementById(this.domElement,
this.$.Cb+G.a.tue);this.Nsa=Y.DOMElementExtensions.getElementById(this.domElement,this.$.Cb+G.a.uue);this.u1b=Y.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");tc=Y.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");this.$oa=this.sfh();tc.appendChild(this.$oa);y.a.instance.ta(v.a.click,this.$oa,this.Hma);this.Jlc=A.KeyInputManager.instance.Mt(this.$oa,this.Hma,u.a.Sh);W.a.Gd(this.$)||A.KeyInputManager.instance.ta(v.a.Vb,this.$oa,this.onCloseButtonTabKeyDown);
Y.DOMElementExtensions.setVisible(this.Nsa,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.Tad();this.$&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&this.domElement.classList.add(D.a.zUe);this.$.iC(this.onResize)}ET(tc){this.addHandler("AgavePaneRemovedEventKey",tc)}AW(tc){this.removeHandler("AgavePaneRemovedEventKey",tc)}MOg(tc){this.addHandler("AgavePaneReadyKey",tc)}Dnj(tc){this.removeHandler("AgavePaneReadyKey",
tc)}get gHa(){return this.Gvg}get Qh(){return 6}get jk(){return this.hf.TaskpaneIconCssClass||""}get QQ(){return this.hf.TaskpaneButtonTooltip||this.hf.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.Abe}get Xp(){return this.hf.TaskpaneWidth}get isResizable(){const tc=dd=>{var Hd,Xc;return(null===(Xc=null===(Hd=this.hf)||void 0===Hd?void 0:Hd.PrimaryMarketplace)||void 0===Xc?void 0:Xc.SolutionId)===dd};return!OSF.OsfControl.isFirstPartyStoreString(this.hf.PrimaryMarketplace.MarketplaceType)&&
U.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||tc("FA000000043")||tc("FA000000054")||U.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&tc("FA000000005")||U.EwaSettings.isChangeGateEnabled("OfficeVSO:6197879_DataFromPictureResize")&&tc("FA000000050")?!0:!1}get ee(){return ea.a.wTg}get mc(){return this.domElement}get If(){return!!this.hf}get title(){return this.wj.aXh(this.hf.InstanceId)}get titleText(){return this.title}get h_a(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.hf.InstanceId}get R0(){return"AgaveTaskPane-"+
this.instanceId.replace(RegExp("[{}]","g"),"")}get IB(){const tc=this.P7.Ava(this.mc,this.titleText,this.Xp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Xp,void 0,this.iconUrl,this.hf.TaskpaneIconId,da.HelperMethods.Aw(this.hf));if(U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.hf.SrcLocationOverrideResourceId===this.dfc){tc.contentProps.type="OcvFeedbackTaskPaneProps";tc.hideHeader=
!1;let dd=JSON.parse(this.hf.OsfPropertyBag[0][1]);dd.IsProd=!0;tc.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:dd,taskPaneLocation:tc.location,taskPaneIdToClose:this.R0}}return tc}startEdit(){return!0}dCc(){return!0}Qqf(){this.wj.Lg.notifyAgave(this.hf.InstanceId,OSF.AgaveHostAction.TabIn)}Rqf(){this.wj.Lg.notifyAgave(this.hf.InstanceId,OSF.AgaveHostAction.TabInShift)}UEd(){this.wj.kse(this.DIf);this.wj.sPg(this.CIf);let tc=this.wj.khd(this.hf.InstanceId);this.title&&tc||this.wj.vPg(this.grc);
this.title&&this.kRe();this.raiseEvent("AgavePaneReadyKey");W.a.Gd(this.$)&&(""!==this.jk?d.a.Le(10):d.a.current.Un(102),this.cmg(),U.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&W.a.Gd(this.$)&&da.HelperMethods.Aw(this.hf)&&this.hf.Preload&&!this.hf.TaskpaneVisible?this.k7b():this.E6())}k7b(){this.P7.k7b(this.R0,this.IB)}E6(){"FA000000005"!==this.hf.PrimaryMarketplace.SolutionId||this.bxa||(this.bxa=new pa(this.$),this.bxa.Mkj());this.P7.E6(this.R0,this.IB)}dispose(){var tc,
dd;this.wSf||(null===(dd=null===(tc=this.hf)||void 0===tc?void 0:tc.PrimaryMarketplace)||void 0===dd?void 0:dd.SolutionId)!==S.b||this.ruf(!0);this.bxa&&(this.bxa.blg(),this.bxa=void 0);y.a.instance.Aa(v.a.click,this.$oa,this.Hma);A.KeyInputManager.instance.ix(this.$oa,this.Jlc);W.a.Gd(this.$)||A.KeyInputManager.instance.Aa(v.a.Vb,this.$oa,this.onCloseButtonTabKeyDown);this.wj&&(this.wj.goj(this.grc),this.wj.eoj(this.DIf),this.wj.doj(this.CIf),this.$&&(this.$.UF(this.onResize),this.$=null));this.$=
this.hf=null;super.dispose()}cmg(){this.hf&&this.fkg()}ZV(tc){tc||this.k0d()}Sg(tc){if(this.hf){const dd=this.hf.TaskpaneVisible!==tc;this.hf.TaskpaneVisible=tc;W.a.Gd(this.$)?tc||this.P7.hideTaskPane(this.R0):this.P7.KB();da.HelperMethods.Aw(this.hf)&&dd&&this.wj.BLh(this.instanceId,tc)}}Oq(){let tc=!1;this.hf&&this.$.Bd&8388608&&(tc=this.hf.TaskpaneVisible);return tc}Et(){return!this.hf||OSF.OsfControl.isFirstPartyStoreString(this.hf.PrimaryMarketplace.MarketplaceType)||this.$.AP?da.HelperMethods.Aw(this.hf)?
this.hf.TaskpaneVisible:!!this.hf:!1}eg(tc,dd){return dd?!1:(this.k0d(),this.wj.Lg.notifyAgave(this.hf.InstanceId,tc?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift),!0)}Bh(tc){return Y.DOMElementExtensions.Df(this.mc,tc)}Bj(){}ik(){}jV(tc,dd){var Hd=dd.querySelectorAll(Y.DOMElementExtensions.Hq);dd=Y.DOMElementExtensions.Dl(Hd);Hd=Y.DOMElementExtensions.UA(Hd);let Xc=!1;dd===tc.Ob&&tc.Ea.shiftKey?((tc=document.getElementById(this.$.Cb+G.a.ipc))&&Y.DOMElementExtensions.isVisible(tc)?Y.DOMElementExtensions.setFocus(tc):
this.eg(!1,!1),Xc=!0):Hd!==tc.Ob||tc.Ea.shiftKey||(this.v7f(),Xc=!0);return Xc}v7f(){this.$oa&&Y.DOMElementExtensions.setFocus(this.$oa)}sfh(){const tc=document.createElement("a");tc.tabIndex=0;tc.id="AgaveTaskpaneCloseButtonId";tc.className=G.a.JPb+(z.AFrameworkApplication.isRtl?G.a.yja:G.a.zja);tc.title=T.a.instance.ga(10);tc.setAttribute(C.a.Jd,C.a.Ws);tc.style.borderColor="transparent";U.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?tc.style.margin=
"6px 6px 0px 6px":tc.style.margin="6px";tc.style.zIndex="2";tc.style.position="relative";const dd=document.createElement("span");dd.className="StandardButtonImage clip16x16 StandardButtonImageNoText";dd.id=tc.id+"-close";const Hd=fa.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,T.a.instance.ga(793));dd.appendChild(Hd);tc.appendChild(dd);return tc}kRe(){this.Nsa.innerText=this.title;this.Nsa.style.textOverflow="ellipsis";this.Nsa.style.whiteSpace="nowrap";this.Nsa.style.overflowX="hidden";
this.hf.TaskpaneTitleCssClass&&(this.Nsa.className=this.Nsa.className+" "+this.hf.TaskpaneTitleCssClass);this.u1b.className=this.u1b.className+" "+this.hf.TaskpaneHeaderCssClass;Y.DOMElementExtensions.setVisible(this.Nsa,!0);this.button&&(this.button.x0a.title=this.title);this.Tad();this.Mhg=!0}fkg(){if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.jk&&!W.a.Gd(this.$)){if(this.button){var tc=d.a.Le(10),dd=this.button.Gl;dd.setAttribute("src",tc);dd.setAttribute("class",
this.jk)}return}}else if(this.jk){this.button&&(tc=d.a.Le(10),dd=this.button.Gl,dd.setAttribute("src",tc),dd.setAttribute("class",this.jk));return}if(dd=U.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?this.hf.TaskpaneIconUrl?this.hf.TaskpaneIconUrl:this.wj.khd(this.hf.InstanceId):this.wj.khd(this.hf.InstanceId))this.$.Bla&&this.hf.PrimaryMarketplace&&this.hf.PrimaryMarketplace.SolutionId===Za.a.solutionId&&(dd=this.M_h(dd)),W.a.Gd(this.$)?this.Abe=dd:(tc=this.button.Gl,
tc.setAttribute("src",dd),dd=d.a.current.Un(102),tc.setAttribute("onerror","this.onerror = null;this.src = '"+dd+"';")),this.rod=!0}M_h(tc){const dd=Za.a.v8e(this.$),Hd=Za.a.Lxb(this.$),Xc=Za.a.Byb(this.$),gd=Za.a.c8e(this.$),je=this.hf.SrcLocationOverrideResourceId,Ee=W.a.Gd(this.$);return je===dd?Ee?tc.replace("/icon-32.png","/record-tp-20.png"):tc.replace("/icon-32.png","/record-tp-32.png"):je===Hd?Ee?tc.replace("/icon-32.png","/code-tp-20.png"):tc.replace("/icon-32.png","/code-tp-32.png"):je===
Xc?Ee?tc.replace("/icon-32.png","/rfb-tp-20.png"):tc.replace("/icon-32.png","/rfb-tp-32.png"):je===gd?Ee?tc.replace("/icon-32.png","/flowconnector-tp-20.png"):tc.replace("/icon-32.png","/flowconnector-tp-32.png"):tc}Tad(){this.$&&!U.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&(this.gHa.style.height=da.HelperMethods.zc(this.P7.DO.offsetHeight-this.u1b.offsetHeight))}k0d(){this.wj.ICd(this)}ruf(tc){tc={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:tc.toString()};
const dd=new oa.a(xa.a.li());dd.add("PaneClosedTime",3);dd.add("IsSessionEnded",1);H.a.sendTelemetryEvent(Object(x.a)(new wa.a,{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:I.a.ki(tc,dd)}));this.wSf=!0}}Object(c.a)(cb,"AgaveTaskPane",P.a,[63,504,457,254]);var ib=a(50),ta=a(108),Ya=a(153),Da=a(54);class ba extends k.a{constructor(tc){super();this.hHd=[];this.TMf=null;this.RBf=dd=>{this.qb(Object(l.a)(504,dd))};this.$=tc;this.Gb()}create(){let tc=U.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?
Object(ta.c)(Ya.a.resolve(Da.w,{Wb:this.Na})):ib.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na);const dd=w.a(this.$);n.TaskExtensions.za(n.TaskExtensions.Md([dd,tc],this.$.ka),()=>{const Hd=new cb(document.createElement("div"),this.$,dd.result,tc.result);this.hHd.push(Hd);Hd.MOg(this.RBf);this.Ra.raiseEvent(k.a.L0c,null,Hd)},this.ka,3)}dispose(){for(const tc of this.hHd)tc.Dnj(this.RBf);h.a.sc(this.hHd);h.a.Ja(this.TMf);this.$=this.TMf=null;super.dispose()}}Object(c.a)(ba,"AgaveTaskPaneFactory",
k.a,[]);var ya=a(31),V=a(242),Z=a(216),ja=a(269),la=a(63),ua=a(49),eb=a(45),Eb=a(330),Wb=a(77),Ab=a(22),Jb=a(293),Gb=a(290);const Nb=bb.a.uEh,Ja=`<div class="${bb.a.Nbd}"><div title="{0}" class="${bb.a.CBh}">{0}</div></div><div><div class="${bb.a.vBh}">{1}</div><div class="${bb.a.zBh} ${bb.a.vo}" id="parametersSection">&nbsp;</div><div align="bottom" class="${bb.a.uBh}"><button class="${bb.a.xUe} ${bb.a.tBh}" id="applyButton" type="submit">{2}</button><button class="${bb.a.xUe}" id="resetButton" type="button">{3}</button></div></div>`,
ab=`<div><div class="${bb.a.ABh}"><label for="{2}" title="{1}">{0}</label></div><div class="${bb.a.BBh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;class wb extends V.a{constructor(tc,dd,Hd,Xc){super(tc);this.zTd=this.vWa=this.T0=null;this.Qv=0;this.htmlSanitizationHelper=null;this.PKf=()=>{this.vWa=null};this.qFj=()=>{h.a.Ja(this.zTd);this.zTd=null;this.isVisible!==this.cVd&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.qah=(gd,je)=>Ab.a.compare(gd.Name,je.Name,!0);
this.$Bf=gd=>{Wb.g(gd);if(!this.Wsa.domElement.classList.contains(bb.a.R$b)){ka.h(this.$).No(!0);var je=[];for(gd=0;gd<this.T0.length;gd++){const ae=this.vWa[gd],Yb=this.T0[gd].text;ae.Values=[Yb];Yb&&je.push(ae)}if(je.length){var Ee=this.$.pa.va.$b();this.Wsa.addCssClass(bb.a.R$b);this.$.userOperationManager.Oc(new N.a(142,0,(ae,Yb,Sc)=>la.F(this.$.pa.va,je,!1,0,!1,Gb.b(ae,this.w3i),Gb.a(Yb,this.v3i),Sc,null,Ee)),null)}}};this.h2i=gd=>{Wb.g(gd);gd=this.T0;for(let je=0,Ee=gd.length;je<Ee;je++)gd[je].text=
""};this.w3i=()=>{this.Wsa.removeCssClass(bb.a.R$b)};this.v3i=()=>{this.Wsa.removeCssClass(bb.a.R$b)};this.QHb=(gd,je)=>{13===je.charCode&&this.$Bf(je)};this.$=dd;this.taskPaneManager=Hd;this.htmlSanitizationHelper=Xc;dd=String.format(Ja,this.titleText,T.a.instance.ga(1329),T.a.instance.ga(1330),T.a.instance.ga(1331));this.htmlSanitizationHelper.jh(tc,dd);this.ysc=this.getElementById("parametersSection");this.Wsa=new Eb.a(this.getElementById("applyButton"));this.Wsa.Gc.la("click",this.$Bf);this.lPd=
new Eb.a(this.getElementById("resetButton"));this.lPd.Gc.la("click",this.h2i);this.$.ea.Oj(this.PKf);ja.a(this.$).fi(this)}ET(tc){this.get_events().addHandler("RemoveParamTpEventKey",tc)}AW(tc){this.get_events().removeHandler("RemoveParamTpEventKey",tc)}vE(tc){this.addHandler("parameterTaskPaneVilibilityChanged",tc)}WF(tc){this.removeHandler("parameterTaskPaneVilibilityChanged",tc)}get i9b(){this.Qgf();return this.vWa}get mc(){return this.domElement}get Xp(){return 250}get isResizable(){return!1}get If(){return this.isVisible}get ee(){return ea.a.c8i}get Qh(){return 2}get jk(){return Nb}get QQ(){return T.a.instance.ga(1070)}get cVd(){return!!this.i9b&&
0<this.i9b.length&&!this.$.isEditMode}get titleText(){return T.a.instance.ga(1328)}get IB(){return this.taskPaneManager.Ava(this.mc,this.titleText,this.Xp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}Sg(tc){W.a.Gd(this.$)&&(tc?(this.Qgf(),this.taskPaneManager.E6("ParametersTaskPane",this.IB)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}Oq(){return this.cVd}Et(){return this.cVd}ZV(){}dispose(){this.$&&this.$.ea.pk(this.PKf);
this.kYf();h.a.sc([this.Wsa,this.lPd]);this.vWa=this.ysc=this.$=this.Wsa=this.lPd=null;super.dispose()}eg(tc,dd){dd||(this.T0&&0<this.T0.length?this.T0[0]:this.Wsa).focus();return!dd}Bh(tc){return Y.DOMElementExtensions.Df(this.mc,tc)}Bj(){}ik(){}jV(){return!1}Qgf(){!this.vWa&&this.$.Bd&2048&&this.wXg(this.$.workbookContext.TaskPaneParameters,this.$.ya.SlicerParameters)}wXg(tc,dd){var Hd=[];this.kYf();if(!this.$.isEditMode&&tc&&0<tc.length){var Xc=this.qah;if(dd&&0<dd.length){var gd=new Z.a([...dd]);
gd.l$.sort(Xc)}else gd=null;for(let Ee=0,ae=tc.length;Ee<ae;Ee++){var je=tc[Ee];dd&&!(0>da.HelperMethods.Bx(gd,0,gd.Zva(),je,Xc))||je.IsPivotPageField||je.IsSlicer||Hd.push(je)}}this.vWa=Hd;if(this.ysc&&(this.isVisible!==0<Hd.length&&(this.zTd=ua.a.instance.create(this.qFj,500,eb.a.d8i,!0,!0)),this.htmlSanitizationHelper.JE(this.ysc),Hd.length)){dd="";tc=[];for(let Ee=0,ae=Hd.length;Ee<ae;Ee++)Xc=this.$.Cb+"param"+Ee,tc.push(Xc),je=Hd[Ee],gd=je.Name?ya.a.Og(je.Name):"",je=je.Comment?ya.a.OQ(je.Comment):
"",dd+=String.format(ab,gd,je,Xc);this.htmlSanitizationHelper.jh(this.ysc,dd);dd=[];for(let Ee=0,ae=Hd.length;Ee<ae;Ee++)Hd=new Jb.a(document.getElementById(tc[Ee])),dd.push(Hd),Hd.xQg(this.QHb);this.T0=dd}}kYf(){if(this.T0){for(let tc=0,dd=this.T0.length;tc<dd;tc++)this.T0[tc].Voj(this.QHb);h.a.sc(this.T0);this.T0=null}}static xXg(tc,dd,Hd){const Xc=tc.da;let gd=Xc.Ba(17);if(!gd){const je=document.getElementById(tc.Cb+G.a.e8i);je&&(gd=Xc.Ha(17,new wb(je,tc,dd,Hd)))}return gd}}Object(c.a)(wb,"ParametersTaskPane",
V.a,[146,457,63,3]);class xb extends k.a{constructor(tc){super();this.$=tc;this.Gb()}create(){let tc=U.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(ta.c)(Ya.a.resolve(Da.w,{Wb:this.Na})):ib.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na);const dd=w.a(this.$);n.TaskExtensions.za(n.TaskExtensions.Md([dd,tc],this.$.ka),()=>{this.qb(wb.xXg(this.$,dd.result,tc.result))},this.ka,3)}}Object(c.a)(xb,"ParametersTaskPaneFactory",k.a,[]);var rb=
a(714),za=a(196),Aa=a(58);class pb{Mc(){return!1}executeCommand(tc,dd){tc=dd.command;switch(tc){case 329273335:case 1962240939:case 296943390:case -625072140:return Aa.Task.Ta(!0);default:return za.a(tc)}}Ac(tc,dd,Hd,Xc){if(tc=!!Xc&&2===Xc.jw)switch(dd.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;default:tc=!1}return tc}Rc(){return!1}}Object(c.a)(pb,"TaskPaneCommandHandler",null,[222]);class kb extends rb.a{constructor(tc){super(tc)}ld(){this.fd([new pb])}static la(tc){rb.a.Rd(115,
new kb(tc))}}Object(c.a)(kb,"TaskPaneCommandHandlerFactory",rb.a,[]);var Cb=a(1356),ob=a(183);class qa{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(c.a)(qa,"TaskPaneGroupAppProps",null,[]);var ma=a(27),Ga=a(39),vb=a(219);class Ka{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=
!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(c.a)(Ka,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var Pa=a(301),fb=a(19),Wa=a(17),Ma=a(136);class lb{constructor(tc){this.width=tc}}Object(c.a)(lb,"ActiveTaskPaneData",null,[]);class Na extends Ga.a{constructor(tc,dd){super();this.isVisible=!1;this.zZd=this.Gea=-1;this.bNe=40;this.Lh=this.FO=this.animationManager=this.FKc=null;this.AEd=()=>{this.T0f()};this.YCc=new Set;this.YCc.add("FieldListTaskPane");this.YCc.add("PivotTableSettingsTaskPane");
this.YCc.add("SlicerSettingsTaskPane");this.mb=dd;ja.a(this.$).fi(this);this.Zz=tc;this.p$a=this.Y0g();W.a.pj(dd)||z.AFrameworkApplication.sa.Qa.kf||(this.Zz.style.bottom=this.$.Bd&4?da.HelperMethods.zc(this.$.Cea):"0");this.Hac={};this.LPb={};this.R5d={};this.wZd=Ma.a.instance.qe(this.mc);this.wZd.la("focusin",this.AEd);this.Jmi()}get $(){return this.mb}get Yga(){return this.R5d}get wM(){return this.FKc}get isCollapsed(){return!this.wM}dispose(){ja.a(this.$).Nz(this);const tc=this.Hac;for(let dd in tc)({key:dd,
value:tc[dd]}).value();this.LPb=this.R5d=this.Hac=null;this.wZd.KC();this.p$a=this.Zz=this.wZd=null;super.dispose()}Ava(tc,dd,Hd,Xc,gd,je,Ee,ae,Yb=Na.bEi,Sc=Na.aEi,qd=null,Id=null,ic=!1){const Gc=Object(x.a)(new Ka,{getContent:()=>tc});Gc.isSharedRuntime=ic;return Object(x.a)(new Cb.a,{hideHeader:!0,contentProps:Gc,title:dd,width:Hd,location:2,onOpen:gd,onClose:je,onShow:Ee,onHide:ae,iconUrl:qd,iconId:Id,enableResize:Xc,minResizeWidth:Yb,maxResizeWidth:Sc})}E6(tc,dd){ob.UISurfaces.mj().then(Hd=>{tc in
this.Yga?Hd.setSelectedTaskPane(tc):Hd.showTaskPane(tc,dd);return null})}k7b(tc,dd){ob.UISurfaces.mj().then(Hd=>{Hd.initializeHiddenSharedRuntimeTaskPane(tc,dd);const Xc=this.$.domElement;Xc.addEventListener("scroll",function je(){0!=Xc.scrollLeft&&(Xc.scrollLeft=0,Xc.removeEventListener("scroll",je))})})}updateTaskPane(tc,dd){ob.UISurfaces.mj().then(Hd=>{Hd.updateTaskPane(tc,dd);return null})}setSelectedTaskPane(tc){ob.UISurfaces.mj().then(dd=>{dd.setSelectedTaskPane(tc);return null})}hideTaskPane(tc){ob.UISurfaces.mj().then(dd=>
{dd.hideTaskPane(tc,Na.dWj);return null})}get mc(){return this.Zz}get If(){return this.isVisible}get ee(){return ea.a.WCc}eg(tc,dd){return dd?!1:(this.Y4f(),!0)}Bh(tc){return Y.DOMElementExtensions.Df(this.mc,tc)}Bj(){this.$.frame.Se.rk(this.ee)}ik(){}Y0g(){const tc=document.createElement(vb.a.div);tc.style.height="0px";tc.style.width="0px";tc.tabIndex=-1;return tc}HRh(){var tc=Y.DOMElementExtensions.getElementById(this.Zz,"tabStripFocusZone");if(tc){tc=tc.getElementsByTagName("button");for(let dd=
0;dd<tc.length;dd++)if(Boolean.parse(tc[dd].getAttribute("aria-selected")))return tc[dd].getAttribute("aria-controls")}return null}Sah(tc){return(tc=window.getComputedStyle(tc,null).getPropertyValue("transition-duration"))?parseInt(tc.endsWith("ms")?parseFloat(tc):1E3*parseFloat(tc),10):0}mkj(){const tc=document.getElementById("tabbedTaskPaneContainer");tc&&tc.addEventListener("transitionend",()=>this.WHa(-1))}Jmi(){ob.UISurfaces.mj().then(tc=>{let dd;tc.renderTaskPaneGroups(null,this.Zz,(dd=new qa,
dd.middleContainer=this.p$a,dd.onOpen=(Hd,Xc)=>{this.isVisible=!0;-1===this.Gea&&(this.Gea=this.Sah(Xc));W.a.pj(this.$)||(this.Yga[Hd]=new lb(Y.DOMElementExtensions.SP(Y.DOMElementExtensions.getElementById(Xc,Na.wgg))))},dd.onClose=Hd=>{this.isVisible=0<tc.selectors.getTabbedTaskPaneCount();m.ULS.sendTraceTag(537014371,0,50,`Closing of ${Hd} TaskPane`);if(!this.isVisible)this.a0e(),W.a.pj(this.$)||z.AFrameworkApplication.sa.Qa.kf||window.requestAnimationFrame(()=>{this.n1b(this.p$a)});else if(!W.a.pj(this.$)&&
this.wM&&this.wM!==Hd){const Xc=1<tc.selectors.getTabbedTaskPaneCount()?this.Fec():0,gd=1===tc.selectors.getTabbedTaskPaneCount()?-1*this.Fec():0;this.Yte(Hd,this.wM,Xc,gd)}W.a.pj(this.$)?this.WHa(this.Gea):(z.AFrameworkApplication.sa.Qa.kf&&0>=this.Gea&&this.WHa(this.Gea),delete this.Yga[Hd]);delete this.LPb[Hd]},dd.onShow=(Hd,Xc)=>{null!=this.ai&&(this.ai.stop(),this.ai=null);this.FKc=Hd;this.T0f();1!==Xc&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.twj()},0)});W.a.pj(this.$)?
window.requestAnimationFrame(()=>{this.WHa(this.Gea)}):z.AFrameworkApplication.sa.Qa.kf&&0>=this.Gea?window.requestAnimationFrame(()=>{this.WHa(this.Gea)}):window.requestAnimationFrame(()=>{this.Pxj(this.p$a,this.Gea)})},dd.onHide=(Hd,Xc,gd)=>{const je=this.HRh();je!==Hd&&(this.ai=this.$.Mb.Kc("UserAction","TaskPaneToggle"),m.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${Hd} to ${je}`));gd?W.a.pj(this.$)||this.n1b(this.p$a):!W.a.pj(this.$)&&je&&(Hd=1===Object.keys(this.Yga).length?this.Fec():
0,this.Yte(this.wM,je,this.Fec(),Hd));this.FKc=null;gd&&1!==Xc&&this.a0e();W.a.pj(this.$)&&window.requestAnimationFrame(()=>{this.WHa(this.Gea)})},dd.setFocusCallback=(Hd,Xc)=>{Xc&&(this.LPb[Hd]=Xc)},dd.onResizeStart=()=>{W.a.pj(this.$)||this.zZc(da.HelperMethods.zc(0))},dd.onResizeEnd=()=>{W.a.pj(this.$)?this.WHa():(this.n1b(this.p$a),this.Yga[this.wM]=this.Pkd(this.wM));m.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.wM} TaskPane`)},dd));z.AFrameworkApplication.sa.Qa.kf&&!W.a.pj(this.$)&&
this.mkj();return null})}n1b(tc){this.zZc(this.$.isChromeRtl?tc.style.left:tc.style.right)}zZc(tc){m.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.wM}`);this.$.etj(tc)}WHa(tc=0){-1<tc?Aa.Task.delay(tc+this.bNe).continueWith(()=>{this.$.qAa(Pa.a.CZ("ResetContentAreaMargin"))}):this.$.qAa(Pa.a.CZ("ResetContentAreaMargin"))}Yte(tc,dd,Hd,Xc){dd=dd.endsWith(Na.xZd)?dd.substring(0,dd.length-Na.xZd.length):dd;dd=this.iaf(dd);Xc=dd+Xc;tc=this.iaf(tc);Xc<tc&&this.zZc(da.HelperMethods.zc(dd+
Hd))}Pxj(tc,dd){window.setTimeout(()=>{this.n1b(tc)},dd+this.bNe)}Fec(){return-1!==this.zZd?this.zZd:this.zZd=Y.DOMElementExtensions.SP(Y.DOMElementExtensions.getElementById(this.Zz,"tabStripFocusZone"))}Pkd(tc){return Y.DOMElementExtensions.SP(Y.DOMElementExtensions.getElementById(Y.DOMElementExtensions.getElementById(this.Zz,tc+Na.xZd),Na.wgg))}iaf(tc){if(tc in this.Yga){const dd=this.Yga[tc].width;return 0<dd?dd:this.Pkd(tc)}return tc?this.Pkd(tc):0}a0e(){ka.h(this.$).setFocus()}twj(){if(this.LPb[this.wM]){const tc=
this.LPb[this.wM];tc&&tc(null,null)}else this.YCc.has(this.wM)||this.Y4f()}Y4f(){ob.UISurfaces.mj().then(tc=>{1<tc.selectors.getTabbedTaskPaneCount()?tc.focusTabbedTaskPaneArea():(tc=Y.DOMElementExtensions.getElementById(this.mc,"AgaveTaskpaneCloseButtonId"))?tc.focus():(tc=Y.DOMElementExtensions.Dl(this.mc.querySelectorAll("button")))&&tc.focus();return null})}T0f(){this.$.domElement.scrollLeft=0;ma.a.JNa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=
0},0)})}vE(tc){this.addHandler(Na.Jhb,tc)}WF(tc){this.removeHandler(Na.Jhb,tc)}get DO(){return this.Zz}get RD(){m.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}ytb(tc,dd,Hd,Xc,gd){let je=tc.Ba(dd);je||(je=Wa.a(fb.a,Hd,tc,dd),je.SetScriptLoadFlavor(gd));Xc&&je.xYc(Xc);const Ee=""+dd;let ae=null;const Yb=()=>{je.create();ae()};this.Hac[Ee]=ae=()=>{je.Kvc(Yb);delete this.Hac[Ee]};je.G0b(Yb)}initialize(){m.ULS.shipAssertTag(537151111,
11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}Dbg(){}VQ(){m.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}yI(){m.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}Cre(){m.ULS.shipAssertTag(537151108,11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}q0f(){m.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}M5a(){m.ULS.shipAssertTag(537151106,
11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}Agd(){m.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}jja(){m.ULS.shipAssertTag(537151104,11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}KB(){m.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){m.ULS.shipAssertTag(537151070,
11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}aTd(){m.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static la(tc){const dd=Na.V1g(tc.Cb,tc.isChromeRtl,tc);Na.CXg(tc,dd);return new Na(dd,tc)}static V1g(tc,dd,Hd){const Xc=document.createElement("div");Xc.id=tc+G.a.XCc;W.a.pj(Hd)?Xc.classList.add(bb.a.hak):(Xc.classList.add(dd?bb.a.jak:bb.a.iak),z.AFrameworkApplication.sa.Qa.kf&&
Xc.classList.add(bb.a.DAa));return Xc}static CXg(tc,dd){tc.isMobileMode&&dd.setAttribute("aria-hidden","true");z.AFrameworkApplication.sa.Qa.kf?document.getElementById("FarPaneRegion").appendChild(dd):(U.EwaSettings.isChangeGateEnabled("OfficeVSO:7643983_GridLayoutRemoval")||W.a.pj(tc)&&dd.classList.add(bb.a.$xh),document.getElementById(tc.Cb+G.a.i1a).insertBefore(dd,tc.VBa))}}Na.bEi=300;Na.aEi=950;Na.dWj=2;Na.xZd="-panel";Na.wgg="ExcelTaskPaneContentWrapper";Na.Ucg="rtpSizeChanged";Na.XFe="rtpCollapsed";
Na.aOf="rtpAdded";Na.Jhb="rtpVisibility";Object(c.a)(Na,"ReactTaskPaneManager",Ga.a,[517,63,3]);var X=a(100),F=a(166),na=a(243),hb=a(424),Ib=a(88),vc=a(564);class nc extends Sys.EventArgs{constructor(){super()}}Object(c.a)(nc,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var Pb=a(47);const oc=D.a.WAh,Ic=D.a.YAh,ec=`<span class='${bb.a.tsb} ${D.a.ZAh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;class mb extends V.a{constructor(tc){super(document.createElement("a"));this.Ra=new Ga.a;
this.htmlSanitizationHelper=this.Vme=null;this.jd=()=>{this.enabled&&this.Ra.raiseEvent("tpButtonClicked",null,this);return!0};this.htmlSanitizationHelper=tc}$Og(tc){this.Ra.addHandler("tpButtonClicked",tc)}AYf(tc){this.Ra.removeHandler("tpButtonClicked",tc)}get x0a(){return this.domElement}get taskPane(){return this.Vme}get enabled(){return super.enabled}set enabled(tc){tc!==super.enabled&&(this.domElement.classList.toggle(D.a.lU),this.domElement.classList.toggle(Ic),this.domElement.tabIndex=tc?
0:-1,super.enabled=tc)}get Gl(){return this.domElement.firstChild.firstChild}dispose(){h.a.sc([this.Ra]);this.Ra=null;this.domElement&&Pb.a.yna(this.domElement);super.dispose()}Imi(tc){const dd=6===tc.Qh;var Hd=dd&&!tc.jk;Hd=String.format(ec,tc.QQ,tc.jk,Hd?d.a.current.Un(102):d.a.Le(10),D.a.Cia,Hd?String.format('style="width:24px;{0}:0px"',"left"):"");this.htmlSanitizationHelper.jh(this.domElement,Hd);this.domElement.classList.add(oc);this.domElement.classList.add(Ic);this.domElement.title=tc.QQ;
this.domElement.tabIndex=0;Y.DOMElementExtensions.Rt(this.domElement,G.a.Ws,null,null);this.Vme=tc;dd&&(tc=this.taskPane,null===tc||void 0===tc?void 0:tc.cmg());y.a.instance.ta(v.a.click,this.domElement,this.jd);A.KeyInputManager.instance.Mt(this.domElement,this.jd,u.a.Sh)}}Object(c.a)(mb,"TaskPaneButton",V.a,[609]);class Ob extends P.a{constructor(tc,dd,Hd,Xc){super(tc);this.animationManager=this.J5=this.Te=null;this.bJ=this.VVa=!1;this.S8d=0;this.mb=null;this.DOc=!1;this.htmlSanitizationHelper=
null;this.Ez=()=>{this.cui||(this.KB(),this.$.tf())};this.NDd=(gd,je)=>{this.onButtonClick(gd,je)};this.k6=()=>{this.QEc()};this.$=dd;this.htmlSanitizationHelper=Xc;ja.a(this.$).fi(this);this.$.Bb.Yf(this.k6);this.configuration=Hd;this.baseName=da.HelperMethods.bwa(this.domElement,this.configuration.zgg||this.configuration.R0);this.Gac={};this.agb=[];this.gu=[];this.urb={};this.Wme=document.getElementById(this.baseName+this.configuration.vZd);this.DO||m.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+
this.configuration.vZd} not found`);this.gIg=document.getElementById(this.baseName+this.configuration.R0);this.Zz||m.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.R0} not found`);this.hIg=document.getElementById(this.baseName+this.configuration.B_d);this.FO||m.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.B_d} not found`);tc=String.format(Ob.eWj,this.baseName+this.configuration.pig,
this.baseName+Ob.KPb);this.htmlSanitizationHelper.jh(this.FO,tc);this.g7d=document.getElementById(this.baseName+Ob.KPb);this.CAe||m.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ob.KPb} not found`);(this.trb=document.getElementById(this.baseName+Ob.KPb))||m.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ob.KPb} not found`);this.yxg=this.WJe(this.configuration.VFe,this.SFe);this.xxg=this.kJe(this.configuration.TFe,
T.a.instance.ga(1297),this.Nai,this.q1a,!0);this.xzg=this.WJe(this.configuration.hYe,this.XHh);this.wzg=this.kJe(this.configuration.fYe,T.a.instance.ga(1296),this.Oai,this.nKa,!1);Y.DOMElementExtensions.setVisible(this.nKa,!1);y.a.instance.ta(v.a.click,this.p1a,Object(Ib.a)(this,this.Xpc,"onCollapseIconClicked"));y.a.instance.ta(v.a.click,this.mKa,Object(Ib.a)(this,this.nqc,"onExpandIconClicked"));y.a.instance.ta(v.a.click,this.q1a,Object(Ib.a)(this,this.Xpc,"onCollapseIconClicked"));y.a.instance.ta(v.a.click,
this.nKa,Object(Ib.a)(this,this.nqc,"onExpandIconClicked"));A.KeyInputManager.instance.ta(v.a.Vb,this.p1a,Object(Ib.a)(this,this.pDf,"onCollapseIconKeyDown"));A.KeyInputManager.instance.ta(v.a.Vb,this.mKa,Object(Ib.a)(this,this.WEf,"onExpandIconKeyDown"))}vE(tc){this.addHandler(Ob.Jhb,tc);tc(this,new nc(this.isVisible,Y.DOMElementExtensions.isVisible(this.FO)))}WF(tc){this.removeHandler(Ob.Jhb,tc)}get FO(){return this.hIg}get mc(){return this.FO}get If(){return this.VVa}set If(tc){this.VVa=tc}get Zz(){return this.gIg}get ee(){return ea.a.QQi}get DO(){return this.Wme}get RD(){return this.gu}get Lh(){return this.Te}get wM(){return null}get Yga(){return null}get isCollapsed(){return this.bJ}get w8c(){return this.S8d}get $(){return this.mb}set $(tc){this.mb=
tc}get CAe(){return this.g7d}get p1a(){return this.xxg}get mKa(){return this.wzg}get q1a(){return this.yxg}get nKa(){return this.xzg}get cui(){return this.DOc}get Oai(){return this.configuration.UFe}get Nai(){return this.configuration.gYe}ytb(tc,dd,Hd,Xc,gd){let je=tc.Ba(dd);je||(je=Wa.a(fb.a,Hd,tc,dd),je.SetScriptLoadFlavor(gd));Xc&&je.xYc(Xc);const Ee=""+dd;Ee in this.Gac||je.Z0b((Sc,qd)=>{this.u6(qd)});let ae=null;const Yb=()=>{je.create();ae()};this.Gac[Ee]=ae=()=>{je.Kvc(Yb);delete this.Gac[Ee]};
je.G0b(Yb)}dispose(){if(this.gu)for(let dd=0,Hd=this.gu.length;dd<Hd;dd++)this.gu[dd].AYf(this.NDd),this.gu[dd].dispose();const tc=this.Gac;for(let dd in tc)({key:dd,value:tc[dd]}).value();this.$.ea&&this.$.Bb&&this.$.Bb.yg(this.k6);this.trb=this.g7d=this.Wme=this.Te=this.urb=this.agb=this.gu=null;y.a.instance.Aa(v.a.click,this.p1a,Object(Ib.a)(this,this.Xpc,"onCollapseIconClicked"));y.a.instance.Aa(v.a.click,this.mKa,Object(Ib.a)(this,this.nqc,"onExpandIconClicked"));y.a.instance.Aa(v.a.click,this.q1a,
Object(Ib.a)(this,this.Xpc,"onCollapseIconClicked"));y.a.instance.Aa(v.a.click,this.nKa,Object(Ib.a)(this,this.nqc,"onExpandIconClicked"));A.KeyInputManager.instance.Aa(v.a.Vb,this.p1a,Object(Ib.a)(this,this.pDf,"onCollapseIconKeyDown"));A.KeyInputManager.instance.Aa(v.a.Vb,this.mKa,Object(Ib.a)(this,this.WEf,"onExpandIconKeyDown"));super.dispose()}eg(tc,dd){if(dd)return!1;this.Te&&!this.isCollapsed?(tc=this.Lh.taskPane,tc.If&&tc.eg(!0,!1)||Y.DOMElementExtensions.setFocus(this.Lh.x0a)):Y.DOMElementExtensions.setFocus(this.mKa);
return!0}Bh(tc){return this.isVisible?Y.DOMElementExtensions.Df(this.domElement,tc)||Y.DOMElementExtensions.Df(this.domElement,Y.DOMElementExtensions.byb(tc)):!1}Bj(){}ik(){this.Te&&this.Te.taskPane.ik()}setFocusOnToolbarFirstElement(){this.isCollapsed?Y.DOMElementExtensions.setFocus(this.mKa):Y.DOMElementExtensions.setFocus(this.p1a)}aTd(){for(let tc=this.gu.length-1;0<=tc;tc--)if(this.gu[tc].isVisible){Y.DOMElementExtensions.setFocus(this.gu[tc].x0a);return}this.setFocusOnToolbarFirstElement()}M5a(tc){const dd=
[];for(let Hd=this.gu.length-1;0<=Hd;Hd--)this.gu[Hd].taskPane.Qh===tc&&dd.push(this.gu[Hd].taskPane);return dd}Agd(tc){const dd=[];for(let Hd=0;Hd<this.gu.length;Hd++)this.gu[Hd].taskPane.Qh===tc&&dd.push(this.gu[Hd]);return dd}Cre(tc){if(tc){let dd;const Hd=Object(l.a)(504,tc);Hd?(dd=new mb(this.htmlSanitizationHelper),dd.domElement.id=this.baseName+"bt_"+tc.Qh.toString()+"_"+tc.hf.InstanceId,this.trb.appendChild(dd.domElement),this.urb["6"]=dd,Hd.button=dd):dd=this.urb[tc.Qh.toString()];dd.Imi(tc);
dd.$Og(this.NDd);dd.isVisible=tc.Oq();dd.enabled=tc.Et();this.agb.push(tc);this.gu.push(dd);Ob.$Ni(tc,this.DO);this.jwh(dd);this.QEc()}}yI(tc,dd){let Hd;for(const Xc of this.gu)Hd=Xc.taskPane,Hd.Qh===tc.Qh&&Hd==tc&&this.y4b(Xc,dd)}Ava(){m.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}E6(){m.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}k7b(){m.ULS.shipAssertTag(512291712,
11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){m.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){m.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){m.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}Dbg(tc,dd){tc?(this.DOc=!0,this.RTd(!1)):
(this.DOc=!1,this.RTd(!0),dd&&(this.KB(),this.$.tf()))}VQ(tc){if(!this.agb.includes(tc)){let Hd=null;Hd=()=>{this.nnj(tc);tc.AW(Hd)};tc.ET(Hd);this.Cre(tc);var dd=Object(l.a)(556,tc);dd&&(dd.vE(this.Ez),this.Ez(dd,Sys.EventArgs.Empty));if(dd=Object(l.a)(147,tc))dd.vE(this.Ez),this.Ez(dd,Sys.EventArgs.Empty);if(dd=Object(l.a)(594,tc))dd.vE(this.Ez),this.Ez(dd,Sys.EventArgs.Empty);this.raiseEvent(Ob.aOf,null,tc);this.KB()}}y4b(tc,dd){if(tc.taskPane.Et()&&tc.taskPane.Oq()){if(this.Te){this.Te.domElement.classList.remove(Ob.yob);
this.Te.taskPane.isVisible=!1;if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Hd=Object(l.a)(504,this.Te.taskPane);Hd&&Hd.wj.dNd(Hd.hf.InstanceId)}this.J5=this.Te}this.Te=tc;this.Te.taskPane.isVisible=!0;this.Te.domElement.classList.add(Ob.yob);dd&&this.jja(!1,!1);this.shb()}}onButtonClick(tc){let dd=!1;if(this.Te!==tc){dd=!0;const Hd=tc.taskPane.mc;this.animationManager.Sbj(Hd);if(this.Te){if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Xc=
Object(l.a)(504,this.Te.taskPane);Xc&&Xc.wj.dNd(Xc.hf.InstanceId)}this.Te.taskPane.isVisible=!1;this.Te.domElement.classList.remove(Ob.yob)}this.J5=this.Te;this.Te=tc;this.Te.domElement.classList.add(Ob.yob);this.Te.taskPane.isVisible=!0;this.shb();this.animationManager.QHh(Hd)}this.jja(!(this.isCollapsed||dd),!1)}shb(){const tc=this.w8c;let dd=0;this.Te&&(dd=this.Te.taskPane.Qv?this.Te.taskPane.Qv:this.Te.taskPane.Xp);dd!==tc&&(this.S8d=dd,this.isCollapsed||(this.animationManager&&this.Te?this.animationManager.H1b(this.Zz,
tc,dd,this.Lh.taskPane):this.Zz.style.width=da.HelperMethods.zc(dd)),this.ARa(),this.raiseEvent(Ob.Ucg,null,this))}uM(tc){const dd=new mb(this.htmlSanitizationHelper);dd.isVisible=!1;dd.domElement.id=this.baseName+"bt_"+tc.toString();this.trb.appendChild(dd.domElement);this.urb[tc.toString()]=dd}QEc(){if(void 0!==this.gu&&null!==this.gu){void 0===this.Te||null===this.Te||this.Te.taskPane.Et()||(this.Te.domElement.classList.remove(Ob.yob),this.Te.taskPane.isVisible=!1,this.Te.taskPane.Oq()&&(this.J5=
this.Te),this.Te=null);var tc=null;for(let dd=0;dd<this.gu.length;dd++)if(this.agb[dd].Oq()){const Hd=this.agb[dd].Et();(this.gu[dd].enabled=Hd)&&!tc&&(tc=this.gu[dd])}void 0!==this.Te&&null!==this.Te||!tc||(void 0!==this.J5&&null!==this.J5&&this.J5.taskPane.Et()&&this.J5.taskPane.Oq()?this.y4b(this.J5,!1):this.y4b(tc,!1));void 0!==vc.a(this.$)&&null!==vc.a(this.$)&&vc.a(this.$).isVisible&&void 0!==this.Te&&null!==this.Te&&1!==this.Te.taskPane.Qh&&(vc.a(this.$).isVisible=!1);void 0!==this.Te&&null!==
this.Te&&7!==this.Te.taskPane.Qh&&(tc=this.$.da.Ba(52),null===tc||void 0===tc?0:tc.isVisible)&&(tc.isVisible=!1);void 0!==this.Te&&null!==this.Te&&8!==this.Te.taskPane.Qh&&(tc=this.$.da.Ba(233))&&(tc.isVisible=!1);void 0!==this.Te&&null!==this.Te&&9!==this.Te.taskPane.Qh&&(tc=this.$.da.Ba(248))&&(tc.isVisible=!1);U.EwaSettings.xa(264)&&void 0!==this.Te&&null!==this.Te&&12!==this.Te.taskPane.Qh&&(tc=this.$.da.Ba(302))&&(tc.isVisible=!1);U.EwaSettings.xa(418)&&void 0!==this.Te&&null!==this.Te&&15!==
this.Te.taskPane.Qh&&(tc=this.$.da.Ba(365))&&(tc.isVisible=!1);W.a.yvd(this.$)&&void 0!==this.Te&&null!==this.Te&&13!==this.Te.taskPane.Qh&&(tc=this.$.da.Ba(334))&&(tc.isVisible=!1);void 0!==this.Te&&null!==this.Te&&14!==this.Te.taskPane.Qh&&(tc=this.$.da.Ba(346))&&(tc.isVisible=!1);void 0!==this.Te&&null!==this.Te&&16!==this.Te.taskPane.Qh&&(tc=this.$.da.Ba(371))&&(tc.isVisible=!1);void 0!==this.Te&&null!==this.Te&&17!==this.Te.taskPane.Qh&&(tc=this.$.da.Ba(408))&&(tc.isVisible=!1);this.shb()}}wKh(tc,
dd){Y.DOMElementExtensions.setVisible(this.q1a,!tc);Y.DOMElementExtensions.setVisible(this.nKa,tc);tc&&this.raiseEvent(Ob.XFe,null,this);this.shb();dd&&Y.DOMElementExtensions.setFocus(tc?this.mKa:this.p1a)}Bfc(tc,dd){this.$.Yc(tc,dd,26,null)}u6(tc){tc.nO&&this.VQ(tc.nO)}nnj(tc){if(tc){const dd=this.gu.length;let Hd=!1;for(let Xc=0;Xc<dd;Xc++){const gd=this.gu[Xc];if(gd.taskPane===tc){this.trb.removeChild(gd.x0a);delete this.urb[tc.Qh.toString()];Array.remove(this.agb,tc);Array.remove(this.gu,gd);
gd.AYf(this.NDd);gd.taskPane.mc.parentNode.removeChild(gd.taskPane.mc);this.Te&&this.Te.taskPane===gd.taskPane&&(this.Te=null);this.J5&&this.J5.taskPane===gd.taskPane&&(this.J5=null);Hd=!0;break}}Hd&&this.QEc()}}jwh(tc){const dd=tc.taskPane.Qh,Hd=!!this.Te&&1===this.Te.taskPane.Qh;(1===dd||!Hd&&2===dd)&&this.y4b(tc,!1)}static $Ni(tc,dd){const Hd=tc.mc;Hd.parentNode&&Hd.parentNode.removeChild(Hd);dd.appendChild(Hd);tc.isVisible=!1}kJe(tc,dd,Hd,Xc,gd){const je=document.createElement("a");je.setAttribute(G.a.PT,
gd?G.a.$j:G.a.xq);je.setAttribute(G.a.Jd,G.a.Ws);je.tabIndex=0;je.classList.add(bb.a.kv);je.classList.add(tc);je.classList.add(D.a.VAh);tc=String.format(Ob.I7g,dd,Hd,d.a.Le(10));this.htmlSanitizationHelper.jh(je,tc);Xc.appendChild(je);return je}}Ob.Jhb="tpVisibility";Ob.eWj=`<div id='{0}' class='${D.a.aBh}'><div id='{1}' class='${D.a.$Ah}'></div></div>`;Ob.I7g="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Ob.KPb="novTaskpaneButtonGroup";Ob.yob=D.a.XAh;Ob.Ucg="tpSizeChanged";Ob.XFe="tpCollapsed";
Ob.aOf="tpAdded";Object(c.a)(Ob,"TaskPaneControl",P.a,[517,63,3]);var Ta=a(51),sb=a(375),zb=a(729);class db{constructor(){this.gYe=this.UFe=this.fYe=this.TFe=this.hYe=this.VFe=this.pig=this.B_d=this.vZd=this.R0=this.zgg=null}}Object(c.a)(db,"Configuration",null,[]);a(438);var jb=a(304);class Ub extends jb.a{constructor(tc){super(5,tc)}}Object(c.a)(Ub,"ResizeAnimationEvent",jb.a,[]);var xd=a(476),ne=a(595),fe=a(105);class Bd{constructor(tc,dd){this.Agg=null;this.$=dd;this.taskPane=tc}IHh(){this.Agg=
Y.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Cb+G.a.RCd);const tc=Bd.V7c(this.taskPane),dd=Bd.V7c(this.Agg),Hd=ne.a(fe.a.Tl);Hd.animate(tc,G.a.Wzc);Hd.animate(dd,G.a.Wzc)}Sbj(tc){tc.style.opacity="0"}QHh(tc){ne.a(fe.a.Tl).animate(Bd.V7c(tc),G.a.Wzc)}H1b(tc,dd,Hd,Xc){dd||(Xc.isVisible=!0);this.$.ARa(Hd);ne.a(fe.a.Tl).animate(Bd.Njh(tc,dd,Hd),G.a.Wzc,null,null,()=>{this.$.WAa();Hd||1===Xc.Qh||(Xc.isVisible=!1);Xc.ZV(Hd<dd)})}static Njh(tc,dd,Hd){tc=new Ub(tc);tc.wUg(dd,Hd);
return tc}static V7c(tc){tc=new xd.a(tc);tc.uJ(0,1);return tc}}Object(c.a)(Bd,"TaskPaneAnimationManager",null,[550]);const Ue=`<div id="{0}" class="${D.a.eBh}" runat="server"></div></div><div id="{1}" class="${D.a.dBh} ${D.a.vo}" runat="server"></div>`,mc=`<button type="button" id="{0}" class="${D.a.bBh}"></button><span><div id="{1}" class="${D.a.cBh}"></div></span>`,Fc=D.a.PAh;class bd extends Ob{constructor(tc,dd,Hd,Xc){super(tc,Hd,bd.Efh(),Xc);this.zsc=null;this.Sud=!1;this.mS=null;this.d1i=gd=>
{var je=!1;if(9===gd.Ea.keyCode){je=this.Lh.taskPane.jV(gd,this.FO);if(!je){je=this.$.da.Ba(52);var Ee=this.domElement.querySelectorAll(this.Lh.taskPane===je?je.Hq:sb.a.V7i);je=Y.DOMElementExtensions.Dl(Ee);Ee=Y.DOMElementExtensions.UA(Ee);je=Y.DOMElementExtensions.xBa(gd.Ea,je,Ee)}return je}Ee=X.FocusManager.instance().di;if(null===Ee||void 0===Ee?0:Ee.nN)return je;27===gd.Ea.keyCode&&this.Lh.taskPane.Sg(!1);return je};this.od=()=>{this.FO.style.bottom=this.Zz.style.bottom=this.$.Bd&4&&!z.AFrameworkApplication.sa.Qa.kf?
da.HelperMethods.zc(this.$.Cea):"0";this.KB()};this.KJf=gd=>{Object(hb.a)(504,this.Lh.taskPane)&&(this.Lh.taskPane.gHa.firstChild.style[G.a.pointerEvents]="none");this.Sud=!0;this.mS=this.lyb(gd.clientPoint);F.a.instance.ta(v.a.mg,this.domElement.ownerDocument.body,this.trc);F.a.instance.ta(v.a.Ae,this.domElement.ownerDocument.body,this.urc);na.a.instance.ta(v.a.mk,this.domElement.ownerDocument.body,this.trc);na.a.instance.ta(v.a.Of,this.domElement.ownerDocument.body,this.urc);return!0};this.urc=
()=>{Object(hb.a)(504,this.Lh.taskPane)&&(this.Lh.taskPane.gHa.firstChild.style[G.a.pointerEvents]="");this.Sud=!1;F.a.instance.Aa(v.a.mg,this.domElement.ownerDocument.body,this.trc);F.a.instance.Aa(v.a.Ae,this.domElement.ownerDocument.body,this.urc);na.a.instance.Aa(v.a.mk,this.domElement.ownerDocument.body,this.trc);na.a.instance.Aa(v.a.Of,this.domElement.ownerDocument.body,this.urc);return!0};this.trc=gd=>{this.Sud&&(gd=this.lyb(gd.clientPoint),gd=zb.a.OD(gd,this.mS),this.Yue(gd.x));return!0};
this.i2i=gd=>{void 0!==gd.Ea&&null!==gd.Ea&&(9===gd.Ea.keyCode?gd.Ea.shiftKey?(gd=Object(hb.a)(63,this.Lh.taskPane)?this.Lh.taskPane:null)&&gd.eg(!1,!1):this.setFocusOnToolbarFirstElement():37!==gd.Ea.keyCode&&39!==gd.Ea.keyCode||this.Yue(37===gd.Ea.keyCode?-20:20));return!0};this.$.domElement.classList.add(Fc);this.xgg=dd;this.initialize();A.KeyInputManager.instance.ta(v.a.Vb,this.domElement,this.d1i);this.MPb=Y.DOMElementExtensions.getElementById(dd.parentNode,this.$.Cb+G.a.ipc);this.$Cc=Y.DOMElementExtensions.getElementById(dd.parentNode,
this.$.Cb+G.a.wAf);this.MPb.title=T.a.instance.ga(2233);F.a.instance.ta(v.a.uf,this.$Cc,this.KJf);na.a.instance.ta(v.a.pointerDown,this.$Cc,this.KJf);A.KeyInputManager.instance.ta(v.a.Vb,this.MPb,this.i2i)}get ee(){return ea.a.WCc}get SFe(){return this.FO}get XHh(){return this.SFe}shb(){super.shb();this.MPb&&(this.Lh&&this.Lh.taskPane.isResizable?(this.MPb.style.display="block",this.$Cc.style.display="block"):(this.MPb.style.display="none",this.$Cc.style.display="none"))}get KDc(){const tc=this.FO;
return tc&&Y.DOMElementExtensions.isVisible(tc)?sb.a.KDc:0}q0f(tc){tc&&(this.animationManager=tc);this.ysj();this.animationManager=tc||new Bd(this.Zz,this.$);this.animationManager.IHh()}dispose(){this.zsc&&this.zsc.WF(this.Ez);vc.a(this.$)&&vc.a(this.$).WF(this.Ez);const tc=this.$.da.Ba(52);tc&&tc.WF(this.Ez);this.$.em(this.od);h.a.sc([this.zsc]);this.zsc=null;super.dispose()}initialize(){this.q0f(null);this.uM(0);this.uM(1);this.uM(2);this.uM(7);this.uM(8);this.uM(9);this.uM(10);this.uM(17);U.EwaSettings.xa(264)&&
this.uM(12);U.EwaSettings.xa(418)&&this.uM(15);U.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.uM(13):W.a.yvd(this.$)&&this.uM(13);this.uM(14);this.uM(16);U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&this.uM(18);this.KB()}KB(){var tc=0;let dd=0;for(let Hd=this.RD.length-1;0<=Hd;Hd--){const Xc=this.RD[Hd].taskPane.Oq(),gd=this.RD[Hd].taskPane;if(this.RD[Hd].isVisible=Xc)dd++,(1!==gd.Qh&&(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||
7!==gd.Qh)&&14!==gd.Qh&&16!==gd.Qh||gd.Et())&&tc++}tc=0<tc;Y.DOMElementExtensions.setVisible(this.FO,tc);this.RTd(tc);Y.DOMElementExtensions.setVisible(this.nKa,tc&&this.isCollapsed);Y.DOMElementExtensions.setVisible(this.q1a,tc&&!this.isCollapsed);Y.DOMElementExtensions.setVisible(this.CAe,1<dd);this.QEc()}jja(tc,dd){if(this.isCollapsed!==tc){tc||(this.xgg.style.display=z.AFrameworkApplication.sa.Qa.kf?"flex":"block");var Hd=this.w8c;this.bJ=!this.isCollapsed;var Xc=tc?Hd:0;Hd=tc?0:Hd;this.Lh&&(this.animationManager.H1b(this.Zz,
Xc,Hd,this.Lh.taskPane),this.ARa());tc&&(this.xgg.style.display="none");this.wKh(tc,dd)}}RTd(tc){const dd=this.isVisible!==tc;this.If=tc;Y.DOMElementExtensions.setVisible(this.domElement,tc);dd&&(z.AFrameworkApplication.sa.Qa.kf&&Y.DOMElementExtensions.toggleCssClass(this.domElement,D.a.DAh,tc),this.ARa(),this.raiseEvent(Ob.Jhb,new nc(tc,tc),this))}Xpc(tc){if(tc.Ob===this.q1a&&3!==tc.wb)return!1;this.Bfc(296943390,tc.wb);this.jja(!0,!0);return!0}nqc(tc){if(tc.Ob===this.nKa&&3!==tc.wb)return!1;this.Bfc(-625072140,
tc.wb);this.jja(!1,!0);return!0}pDf(tc){return 13===tc.Ea.keyCode?(this.Bfc(296943390,tc.wb),this.jja(!0,!0),!0):!1}WEf(tc){return 13===tc.Ea.keyCode?(this.Bfc(-625072140,tc.wb),this.jja(!1,!0),!0):!1}ARa(){let tc=0;this.$.Bd&262144&&(tc+=this.KDc,Y.DOMElementExtensions.isVisible(this.Zz)&&!this.isCollapsed&&(tc+=this.w8c));this.$.ARa(tc)}WJe(tc,dd){const Hd=document.createElement("div");Hd.classList.add(tc);dd.insertBefore(Hd,dd.firstChild);return Hd}ysj(){const tc=this.domElement;let dd=document.getElementById(this.$.Cb+
G.a.i1a);z.AFrameworkApplication.sa.Qa.kf&&(dd=document.getElementById("FarPaneRegion"));tc.parentNode&&tc.parentNode!==dd&&tc.parentNode.removeChild(tc);dd.appendChild(tc);this.Hei()}Hei(){const tc=this.Zz,dd=this.FO,Hd=this.$.ea;tc.style.right="0";z.AFrameworkApplication.sa.Qa.kf||(tc.style.marginRight=da.HelperMethods.zc(sb.a.KDc));tc.style.bottom=this.$.Bd&4&&!z.AFrameworkApplication.sa.Qa.kf?da.HelperMethods.zc(this.$.Cea):"0";this.DO.style.bottom="0";dd.style.right="0";this.$.hl(this.od);Hd.TH&&
this.od(null,null)}lyb(tc){const dd=new Ta.a(0,0);return zb.a.Qu(dd,this.Zz,tc,!1)}Yue(tc){const dd=this.Zz.offsetWidth;tc=dd-tc;tc<this.Lh.taskPane.Xp?tc=this.Lh.taskPane.Xp:950<tc&&(tc=950);this.Lh.taskPane.Qv=tc;const Hd=new Bd(this.Zz,this.$);Hd.H1b(this.Zz,dd,tc,this.Lh.taskPane);Object(hb.a)(504,this.Lh.taskPane)||Hd.H1b(this.Lh.taskPane.mc,dd,tc,this.Lh.taskPane);this.$.ARa(this.FO.offsetWidth+tc);this.$.qAa(Pa.a.CZ("AnimateTaskpaneResize"))}static la(tc,dd){let Hd=null;tc.Mb&&(Hd=tc.Mb.vg("ComponentAttach",
"AttachTaskPanePickerControl"),Hd.start());const Xc=bd.X1g(tc.Cb),gd=bd.W1g(tc.Cb,dd),je=bd.Y1g(tc.Cb);Xc.appendChild(je);Xc.appendChild(gd);bd.DXg(tc,Xc);tc=new bd(Xc,gd,tc,dd);Hd&&Hd.stop();return tc}static X1g(tc){const dd=document.createElement("div");dd.id=tc+G.a.XCc;return dd}static W1g(tc,dd){const Hd=document.createElement("div");Hd.id=tc+G.a.vAf;Hd.className=D.a.QAh;let Xc=String.format(Ue,tc+G.a.OQi,tc+G.a.SV);Xc+=String.format(mc,tc+G.a.ipc,tc+G.a.wAf);dd.jh(Hd,Xc);z.AFrameworkApplication.sa.Qa.kf&&
Y.DOMElementExtensions.toggleCssClass(Hd,D.a.DAa,!0);return Hd}static Y1g(tc){const dd=document.createElement("div");dd.id=tc+G.a.RCd;dd.className=D.a.PCh;dd.style.zIndex="100";z.AFrameworkApplication.sa.Qa.kf&&Y.DOMElementExtensions.toggleCssClass(dd,D.a.DAa,!0);return dd}static DXg(tc,dd){(z.AFrameworkApplication.sa.Qa.kf?document.getElementById("FarPaneRegion"):document.getElementById(tc.Cb+G.a.i1a)).appendChild(dd)}static Efh(){const tc=new db;tc.zgg=G.a.XCc;tc.R0=G.a.vAf;tc.vZd=G.a.SV;tc.B_d=
G.a.RCd;tc.pig=G.a.PQi;tc.VFe=D.a.SAh;tc.hYe=D.a.UAh;tc.TFe=D.a.RAh;tc.fYe=D.a.TAh;tc.UFe=D.a.OWe;tc.gYe=D.a.PWe;return tc}}Object(c.a)(bd,"TaskPanePickerControl",Ob,[]);var de=a(717);class Md extends k.a{constructor(tc){super();this.$=tc;this.Gb()}create(){if(W.a.Gd(this.$))this.uWf(()=>Na.la(this.$));else{const tc=U.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(ta.c)(Ya.a.resolve(Da.w,{Wb:this.Na})):ib.GetServiceTaskFactory.Pa(this.$.da,
498,499,this.Na);n.TaskExtensions.za(tc,()=>{this.uWf(()=>bd.la(this.$,tc.result))},this.ka,3)}}static la(tc){tc.da.Ha(50,new Md(tc))}uWf(tc){U.EwaSettings.isChangeGateEnabled("OfficeVSO:7377510_InitializingTPSlicePI")?(tc=Object(de.a)(this.$.da,183,tc),this.qb(tc)):this.qb(tc())}}Object(c.a)(Md,"TaskPaneManagerFactory",k.a,[]);class se extends e.a{constructor(tc){super(tc);this.Gt=()=>{this.$.ea.ZN(this.Gt);this.cLe()};this.$=tc}cLe(){const tc=this.$.da;tc.Ha(72,new xb(this.$));tc.Ha(77,new ba(this.$));
Md.la(this.$);kb.la(this.$)}static main(){f.a.Fa(tc=>{b.a.Yff(tc.domElement.ownerDocument,d.a.current.Un(97),()=>{tc.sI()});const dd=new se(tc);tc.ea.Cv?dd.cLe():tc.ea.wP(dd.Gt)})}}Object(c.a)(se,"TaskPaneSliceBootstrapper",e.a,[]);Type.registerNamespace("_Ewa");se.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/5db788abcef6549323cbfde43509835b/EwaDSEsNext.tp.js.map