'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1270:function(r,B,a){r=a(0);var c=a(7),b=a(15),e=a(27),f=a(91),d=a(13),h=a(87),l=a(424),k=a(84),w=a(8),n=a(65),x=a(463);class m{constructor(da,T){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=T;this.parentElement=da}Yeh(){const da=this.Zeh();x.a(this.$,243,242,0,T=>{this.cardViewManager=T;T.kbg(this.parentElement,2,da)})}gef(){this.cardViewManager&&
this.cardViewManager.iMa(-1,-1,this.parentElement)}Zeh(){const da={layoutId:"AutoDetectTooltip"};da.description=this.longDescription;da.convertToDomainName=this.convertToDomainName;da.longDescription=this.longDescription;da.urlValue=this.urlValue;da.imageAltText=this.imageAltText;da.helpText=this.helpText;da.helpId=this.helpId;return da}}Object(r.a)(m,"AutoDetectCardManager",null,[]);var u=a(34),t=a(216),y=a(31),v=a(229),A=a(18),z=a(52);class C extends k.a{constructor(da,T,ka){super();this.jd=L=>
{if(L.Ob.id===this.JJa.firstChild.id){L=this.mye;const fa={};fa.Id=L.Lqb;this.convertToLinkedEntityManager.f6c(fa,!0,L);this.JJa.removeChild(this.JJa.firstChild);return!0}return!1};this.mye=da;this.convertToLinkedEntityManager=T;this.JJa=document.createElement("div");this.JJa.className="clip16x16";this.Zwa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',y.a.Og("autodetectid"+this.mye.left),A.a.fcd,z.a.Le(11));ka.jh(this.JJa,
this.Zwa);da=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");v.a.instance.ta(d.a.click,da,this.jd)}get domElement(){return this.JJa}dispose(){if(this.JJa){const da=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");v.a.instance.Aa(d.a.click,da,this.jd)}super.dispose()}static get x2g(){return"clip16x16"}}Object(r.a)(C,"AutoDetectColumnHeaderButton",k.a,[]);var H=a(1),I=a(1119),S=a(11),P=a(21),D=a(187);class G extends k.a{constructor(da,T,ka){super();this.htmlSanitizationHelper=
null;this.$=da;this.gridView=P.h(da);this.convertToLinkedEntityManager=T;this.htmlSanitizationHelper=ka;this.R4c=new D.a}dispose(){super.dispose()}brh(da){for(let T of this.gridView.iia)for(let ka of T){const L=ka,fa=L.zt,wa=I.a(L.y4);this.ELg(da,wa,fa);L.hTd(wa)}}ELg(da,T,ka){if(T.length){var L=ka.length;ka[L-1]<da.left||(ka=S.HelperMethods.Bx(new t.a(ka),0,L,da.left,S.HelperMethods.FF),0>ka||!(T=T[ka]))||(this.gridView.rtl?T.classList.add(u.a.MEh):T.classList.add(u.a.LEh),this.R4c.kb(da.left)||
this.R4c.add(da.left,new C(da,this.convertToLinkedEntityManager,this.htmlSanitizationHelper)),da=this.R4c.ma(da.left).domElement,!T.getElementsByClassName(C.x2g).length&&this.CRj(T)&&T.appendChild(da))}}CRj(da){const T=parseInt(da.style.width,10);var ka=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";ka=G.Ngh(ka);da=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.htmlSanitizationHelper.z6h(da.firstChild.innerHTML),ka,!0,H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",
!1));return 18.4<T-(T/2+da/2)?!0:!1}static Ngh(da){return`${"normal"} ${"normal"} ${da} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(r.a)(G,"AutoDetectColumnHeaderManager",k.a,[]);var E=a(433),O=a(24),N=a(71),J=a(151),W=a(12),ea=a(14),R=a(150),Y=a(72);a.d(B,"a",function(){return U});class U extends k.a{constructor(da,T,ka,L,fa){super();this.isMac=e.a.isMac;this.rZa=-1;this.y7b=null;this.aua=-1;this.oN=this.Klc=this.IWd=this.n_=this.nye=!1;this.QT=null;this.gh=
()=>{this.ixa&&this.gridView&&this.aX()};this.yc=()=>{this.ey()};this.jd=()=>{this.NIa();P.h(this.$).eg(!0,!1)};this.vza=(oa,xa)=>{xa?(this.Elg(this.y7b),this.rfb()):(oa=[29],this.gridView.Eb.Tj(oa),this.gridView.Eb.Bk(null,oa),this.QT&&this.QT.gef())};this.Ak=()=>{this.d8a()&&this.Eh.hide();1===this.gridView.ha.Oe&&this.aX()};this.yR=()=>{const oa=this.gridView.ha.Oe;this.gridView.ha.ra.activeCell&&1===oa&&this.aX()};this.onKeyUp=oa=>this.jEb?this.n_?!1:17===oa.Ea.keyCode&&this.IWd?(this.oN?(this.rfb(),
this.Zda()):this.uNb(),!0):!1:this.n_=!1;this.onKeyDown=oa=>{if(!this.jEb)return this.n_=!1;this.IWd=!1;this.n_=oa.ctrlKey;switch(oa.Ea.keyCode){case 27:return this.oN?(this.vza(null,!1),this.Zda()):this.QT&&(this.QT.gef(),this.uNb()),!0;case 13:if(this.oN)return this.oN=!1,this.NIa(),!0;break;case 17:return this.IWd=!0}return!1};const {AutoDetectActionButton:wa}=a(1381);this.$=da;this.Mqb=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);T||b.ULS.sendTraceTag(537166983,
0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=L;L.ZIb();this.Eh=new wa(da,T,this.jd,ka,"");this.aYg=new G(this.$,L,fa);this.gridView=P.h(this.$);this.gridView.ha.HT(this.gh);this.gridView.Xb.KZa(this.gh);this.gridView.ev(this.yR);da.ij(this.yc);da.iC(this.Ak);this.gridBlockManager=Object(h.a)(697,this.gridView.Ca);this.Co=da.frame.Ut;this.aX()}get mc(){return this.Eh.domElement(1)}get jEb(){const da=this.Eh.domElement(U.Zea);return da?
W.DOMElementExtensions.isVisible(da):!1}get ixa(){return this.$.isEditMode&&H.EwaSettings.xa(128)&&H.EwaSettings.xa(131)&&(new J.a(this.$.ua)).Xh?!1:-1!==this.aua}dispose(){this.gridView&&this.gridView.ha.PR(this.gh);if(this.$){const da=this.$;da.$k(this.yc);da.UF(this.Ak);P.h(da).ty(this.yR)}f.a.Ja(this.Eh);this.Co=this.$=this.gridView=this.Eh=null;super.dispose()}ey(){this.vza(null,!1);this.rZa=-1;this.Eh.hide();this.e2j();this.oN=!1}Zda(){this.Eh.getButton(U.Zea).zdb();this.oN=!1}uNb(){this.Eh.getButton(U.Zea).TIb();
this.Elg(this.y7b);this.oN=!0;this.$.da.hb(211,da=>{da.wAa(ea.a.instance.ga(1751))})}onAutoDetectUIShown(){if(this.ixa&&-1!==this.rZa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}bYg(da){var T=new O.Range(1===da.top?1:da.top-1,da.left,da.bottom,da.right,!0,!1);T=this.gridView.getRangeInformation(T);for(const ka of T)if(Object(l.a)(E.AutoDetectRange,ka)&&this.xic(da,!1,ka))return!0;return!1}NIa(){if(this.ixa&&-1!==this.rZa){this.Eh.getButton(U.Zea).TIb();var da={};da.Id=this.aua;da.StringId=
null;this.convertToLinkedEntityManager.f6c(da,!0,this.y7b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");da=[Object(c.a)(new Y.a,{name:"Domain",int64:this.aua})];R.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,da);this.aua=-1}}UTh(){let da=ea.a.instance.ga(1747);if(-1!==this.aua){da+=" ";try{da+=this.convertToLinkedEntityManager.EDb(this.aua.toString())}catch(T){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.aua}`)}}da+=
" ";return da=this.Mqb?da+ea.a.instance.ga(1750):da+ea.a.instance.ga(this.isMac?1749:1748)}rfb(){this.Mqb&&(this.QT||(this.QT=new m(this.mc,this.$),this.QT.convertToDomainName=ea.a.instance.ga(1752),this.QT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.QT.imageAltText=ea.a.instance.ga(1754),this.QT.helpId="HID_DataTypes_Wolfram",this.QT.helpText=ea.a.instance.ga(1753)),this.QT.longDescription=this.convertToLinkedEntityManager.G_d(this.rZa.toString()),
this.QT.Yeh())}xic(da,T,ka){if((new O.Range(ka.top,ka.left,ka.bottom===w.a.xg?ka.bottom:ka.bottom+1,ka.right,!0,!1)).vd(da)){if(T){if(ka&&ka.Lqb!==this.rZa){this.rZa=ka.Lqb;da=ka.Lqb.toString();T=this.Mqb?"":this.convertToLinkedEntityManager.G_d(da);const L=this.convertToLinkedEntityManager.Yhi(da);this.Eh.thb(this.convertToLinkedEntityManager.EDb(da),T,L,U.Zea)}this.aua=ka.Lqb;this.y7b=ka}return!0}return!1}aX(){if(this.convertToLinkedEntityManager){var da=this.gridView.ha.Oe;if(this.gridBlockManager&&
this.gridBlockManager.Cmd){var T=this.gridView.ha.ra.activeCell,ka=!this.gridBlockManager.ds(T),L=this.gridView.getRangeInformation(this.gridView.pi);for(const fa of L)if(Object(l.a)(E.AutoDetectRange,fa))switch(L=fa,L.R7g){case 3:if(this.xic(T,!0,L)){if(1!==da||ka){this.ey();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.kMd();this.Eh.LBa(T,this.vza);this.nye||(this.nye=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",
!1)||H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.aYg.brh(L);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.ey()}}Elg(da){const T=[29];this.gridView.Eb.Bk(da,T);this.gridView.Eb.$q(T)}d8a(){return this.$.ea.isNamedObjectViewMode&&N.f(this.$.na)}kMd(){this.Mqb&&!this.Klc&&this.Co&&(this.Co.xs(d.a.Vb,this.$.domElement,this.onKeyDown,!0),this.Co.xs(d.a.Qd,
this.$.domElement,this.onKeyUp,!0),this.Klc=!0)}e2j(){this.Mqb&&this.Klc&&this.Co&&(this.Co.Fs(d.a.Vb,this.$.domElement,this.onKeyDown,!0),this.Co.Fs(d.a.Qd,this.$.domElement,this.onKeyUp,!0),this.Klc=!1)}static get Zea(){return 1}static dWh(da){return ea.a.instance.ga(1808)+n.a.space+da}}Object(r.a)(U,"AutoDetectManager",k.a,[])},1381:function(r,B,a){a.r(B);a.d(B,"AutoDetectActionButton",function(){return d});r=a(0);B=a(84);var c=a(1270),b=a(52),e=a(14),f=a(21);class d extends B.a{constructor(h,
l,k,w,n){super();this.$=h;this.qo=w.e7b(h,l,k,"",b.a.Le(11),n,"AutoDetectPointerDown",e.a.instance.ga(1808)+"...")}get kz(){return this.qo.kz}dispose(){this.qo.dispose();this.$=null;super.dispose()}domElement(h){return this.qo.domElement(h)}getButton(h){return this.qo.getButton(h,!1)}thb(h,l,k,w){this.qo.SUa(c.a.dWh(h),l,w);this.qo.Bmg(k,l,w)}LBa(h,l){const k=f.h(this.$),w=k.jb.Li(h);h=k.Eg(h,w);const n=k.Vf(w).Dn;if(h&&0<=h.x&&0<=h.y&&n.width>h.width+160){let x=h.bottomRight.x+this.kz,m=h.topLeft.y+
this.kz,u=!1;x+160>n.bottomRight.x&&(x=h.topLeft.x-this.kz,u=!0);if(m<n.topLeft.y+this.kz){if(k.jb.wCa){this.hide();return}m=n.topLeft.y+this.kz}this.qo.e$b(l,w);this.eo(x,m,k.rtl,w,u)}else this.hide()}eo(h,l,k,w,n){this.qo.eo(h,l,k,w,!1,n)}hide(){this.qo.hide()}}Object(r.a)(d,"AutoDetectActionButton",B.a,[])},1488:function(r,B,a){a.r(B);r=a(0);var c=a(714),b=a(15),e=a(5),f=a(73),d=a(38),h=a(1),l=a(196),k=a(21),w=a(150);class n{constructor(Y,U){this.$=U;this.convertToLinkedEntityManager=Y}Mc(Y,U){switch(U){case -1203788282:case 48568533:case -1662108744:return Y=
k.h(this.$),U=this.convertToLinkedEntityManager.pMi||7E3,(null===Y||void 0===Y?0:Y.ha)&&Y.ha.ra.xd.hw>U?!0:!1;default:return!1}}executeCommand(Y,U,da){Y=d.TaskExtensions.Yj();U=U.command;switch(U){case -1203788282:this.convertToLinkedEntityManager.qdh(da[f.a.Pc].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();
break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(da[f.a.Pc].toString());break;case 1266950951:this.convertToLinkedEntityManager.gDi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:this.convertToLinkedEntityManager.sRe();break;case 1702917262:this.convertToLinkedEntityManager.showHelpArticle(e.a.z3j);break;case -90814711:this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();
break;case 48568533:case -1027730316:if(48568533===U||da[f.a.ksf]&&"ConvertToLinkedEntityGallery"===da[f.a.ksf].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),w.a("ExpandDataTypeGallery");break;default:Y=l.a(U)}return Y}Ac(Y,U){switch(U.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return h.EwaSettings.xa(123);case -1081442996:case 1702917262:case -90814711:case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;
default:return!1}}Rc(Y,U,da){return"PopulateConvertToLinkedEntityMenu"===U&&h.EwaSettings.xa(123)?this.convertToLinkedEntityManager.Rc(Y,U,da):!1}}Object(r.a)(n,"ConvertToLinkedEntityCommandHandler",null,[222]);var x=a(463);class m extends c.a{constructor(Y){super(Y)}ld(){x.a(this.$,271,272,this.Na,Y=>{this.fd([new n(Y,this.$)])})}static la(Y){c.a.Rd(273,new m(Y))}}Object(r.a)(m,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);var u=a(58);B=a(228);var t=a(776),y=a(50),v=a(425),A=a(717),z=a(108),
C=a(153),H=a(54),I=a(70);class S extends B.a{constructor(Y){super();this.$=Y;this.Gb()}create(){const Y=y.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.Na),U=Object(I.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(z.c)(C.a.resolve(H.e,{Wb:this.Na})):y.GetServiceTaskFactory.Pa(this.$.da,5,4,this.Na),da=y.GetServiceTaskFactory.Pa(this.$.da,388,387,this.Na);let T=u.Task.Ta(null);T=h.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?
Object(z.c)(C.a.resolve(H.w,{Wb:this.Na})):y.GetServiceTaskFactory.Pa(this.$.da,498,499,this.Na);const ka=y.GetServiceTaskFactory.Pa(this.$.da,257,258,this.Na),L=v.a(this.$);d.TaskExtensions.za(d.TaskExtensions.Md([Y,ka,L,U,da,T],this.ka),()=>{this.qb(Object(A.a)(this.$.da,271,()=>new t.ConvertToLinkedEntityManager(this.$,Y.result,da.result,ka.result,L.result,U.result,T.result)))},this.$.ka,3)}static la(Y){Y.da.Ha(272,new S(Y))}}Object(r.a)(S,"ConvertToLinkedEntityManagerFactory",B.a,[]);var P=a(242),
D=a(269),G=a(33),E=a(256),O=a(12),N=a(724);const J=a(18).a.tEh;class W extends P.a{constructor(Y,U,da){super(Y);this.Qv=0;this.Is=!1;this.yc=()=>{this.Sg(!1)};this.$=U;this.taskPaneManager=da;D.a(U).fi(this);this.$.ij(this.yc);G.a.Gd(this.$)&&(this.isVisible=!1)}ET(Y){this.get_events().addHandler("EnrichmentTaskPaneRemoved",Y)}AW(Y){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",Y)}vE(Y){this.addHandler("EnrichmentTaskPaneVilibilityChanged",Y)}WF(Y){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",
Y)}$Qg(Y){this.addHandler("EnrichmentTaskPaneOnFocus",Y)}spj(Y){this.removeHandler("EnrichmentTaskPaneOnFocus",Y)}get isVisible(){return super.isVisible}set isVisible(Y){super.isVisible=Y;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get If(){return this.isVisible}get ee(){return E.a.Uvh}get Qh(){return 10}get jk(){return J}get QQ(){return this.titleText}get titleText(){return"Enrichment"}get Xp(){return 300}get isResizable(){return!1}get mc(){return this.domElement}get height(){return this.taskPaneManager.DO.offsetHeight}get IB(){return this.taskPaneManager.Ava(this.mc,
this.titleText,this.Xp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Xp)}Oq(){return this.Is}Et(){return this.Is}ZV(){}dispose(){this.$&&this.$.$k(this.yc);this.taskPaneManager=this.$=null;super.dispose()}eg(Y,U){U||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!U}Bh(Y){return O.DOMElementExtensions.Df(this.mc,Y)}Bj(){}ik(){}Sg(Y){this.Is=Y;const U=this.taskPaneManager;this.isVisible=Y;G.a.Gd(this.$)?Y?this.taskPaneManager.E6("EnrichmentTaskPane",
this.IB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(Y&&0<U.RD.length&&(!U.Lh||10!==U.Lh.taskPane.Qh||U.isCollapsed)&&U.yI(this,!0),U.KB());Y||(k.h(this.$).eg(!0,!1),this.$.tf())}jV(){return!1}static la(Y,U){var da=Y.Cb;let T=document.getElementById(da+e.a.QRe);T||(T=N.a("div",Y.Cb+e.a.QRe,"cui-taskpane"),G.a.Gd(Y)||(da=document.getElementById(da+e.a.SV),void 0!==da&&null!==da?da.appendChild(T):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${Y.eD}`)));
da=Y.da;return da.Ba(257)||da.Ha(257,new W(T,Y,U))}}Object(r.a)(W,"EnrichmentTaskPane",P.a,[673,3,457,63]);class ea extends B.a{constructor(Y){super();this.hh=this.gi=null;this.$=Y;this.Gb()}get yD(){this.gi||(this.gi=d.TaskExtensions.za(v.a(this.$),Y=>{this.hh=W.la(this.$,Y.result)},this.ka,3));return this.gi}create(){const Y=y.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),U=y.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);d.TaskExtensions.za(d.TaskExtensions.ts(d.TaskExtensions.Md([Y,
U],this.ka),()=>this.yD,this.ka),()=>{this.qb(this.hh)},this.ka,3)}dispose(){this.hh=this.gi=this.$=null;super.dispose()}static la(Y){Y.da.Ha(258,new ea(Y))}}Object(r.a)(ea,"EnrichmentTaskPaneFactory",B.a,[]);var R=a(9);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{R.a.Fa(Y=>{ea.la(Y);S.la(Y);m.la(Y)})})()},776:function(r,B,a){a.r(B);var c=a(0),b=a(15),e=a(91),f=a(274),d=a(4),h=a(31),l=a(847),k=a(142),w=a(86),n=a(39),x=a(18),m=a(5),u=a(171),t=a(1270),y=a(1273),
v=a(178),A=a(565),z=a(353),C=a(63);const H=(ec,mb,Ob,Ta,sb,zb=null)=>{zb=ec.Oa(1,zb);return C.g(ec,"GetRichDataClassificationLabels",zb,mb,Ob,Ta,sb,4)},I=(ec,mb,Ob,Ta,sb,zb,db,jb,Ub=null)=>{Ub=ec.Oa(1,Ub);Ub.selectedRanges=mb;Ub.domainId=Ob;Ub.autodetect=Ta;return C.g(ec,"ConvertToLinkedEntity",Ub,sb,zb,db,jb,4)},S=(ec,mb,Ob,Ta,sb,zb=null)=>{zb=ec.Oa(1,zb);return C.g(ec,"OnAutoDetectUIShown",zb,mb,Ob,Ta,sb,4)},P=(ec,mb,Ob,Ta,sb,zb=null)=>{zb=ec.Oa(1,zb);return C.g(ec,"GetLinkedEntityMetadata",zb,
mb,Ob,Ta,sb,4)},D=(ec,mb,Ob,Ta,sb,zb,db=null)=>{db=ec.Oa(1,db);db.selectedRanges=mb;return C.g(ec,"ConvertLinkedEntityToText",db,Ob,Ta,sb,zb,4)},G=(ec,mb,Ob,Ta,sb,zb,db=null)=>{db=ec.Oa(1,db);db.selectedRanges=mb;return C.g(ec,"RefreshLinkedEntitiesInRange",db,Ob,Ta,sb,zb,4)},E=(ec,mb,Ob,Ta,sb,zb,db,jb,Ub,xd,ne=null)=>{ne=ec.Oa(1,ne);ne.selectedRanges=mb;ne.isChangeObject=Ob;ne.isFloodgateEnabled=Ta;ne.isStarterData=sb;ne.starterDataDomainId=zb;return C.g(ec,"GetDataSelectorPaneData",ne,db,jb,Ub,
xd,4)},O=(ec,mb,Ob,Ta,sb,zb,db,jb=null)=>{jb=ec.Oa(9,jb);jb.activeCell=mb;jb.selectionIndex=Ob;return C.g(ec,"SelectLinkedEntityForDisambiguation",jb,Ta,sb,zb,db,4)},N=(ec,mb,Ob,Ta,sb,zb,db,jb,Ub,xd,ne,fe=null)=>{fe=ec.Oa(1,fe);fe.searchCell=mb;fe.searchQuery=Ob;fe.isFloodgateEnabled=Ta;fe.isStarterData=sb;fe.starterDataDomainId=zb;fe.starterDataDomainIdString=db;return C.g(ec,"LinkedEntitySearch",fe,jb,Ub,xd,ne,4)},J=(ec,mb,Ob,Ta,sb,zb,db,jb,Ub=null)=>{Ub=ec.Oa(1,Ub);Ub.cell=mb;Ub.starterDataDomainId=
Ob;Ub.starterDataDomainIdString=Ta;return C.g(ec,"InsertStarterDataTable",Ub,sb,zb,db,jb,4)},W=(ec,mb,Ob,Ta,sb,zb,db,jb=null)=>{jb=ec.Oa(1,jb);jb.activeCell=mb;jb.isBackward=Ob;return C.g(ec,"MoveToNextAmbiguousLinkedEntity",jb,Ta,sb,zb,db,4)},ea=(ec,mb,Ob,Ta,sb,zb,db=null)=>{db=ec.Oa(9,db);db.activeCell=mb;return C.g(ec,"CancelSearchLinkedEntity",db,Ob,Ta,sb,zb,4)},R=(ec,mb,Ob,Ta,sb,zb,db,jb=null)=>{jb=ec.Oa(1,jb);jb.selectedRanges=mb;jb.letyDomainId=Ob;return C.g(ec,"GetDataTypeSelectorData",jb,
Ta,sb,zb,db,4)},Y=(ec,mb,Ob,Ta,sb,zb=null)=>{zb=ec.Oa(1,zb);return C.g(ec,"GetErrorMessageForLinkedDataTypeRefresh",zb,mb,Ob,Ta,sb,4)},U=(ec,mb,Ob,Ta,sb,zb=null)=>{zb=ec.Oa(1,zb);return C.g(ec,"GetHasUntrustedImageUrls",zb,mb,Ob,Ta,sb,4)},da=(ec,mb,Ob,Ta,sb,zb=null)=>{zb=ec.Oa(1,zb);return C.g(ec,"LinkedEntitiesEnableUntrustedImages",zb,mb,Ob,Ta,sb,0)},T=(ec,mb,Ob,Ta,sb,zb=null)=>{zb=ec.Oa(1,zb);return C.g(ec,"LinkedEntityTryAutoRefresh",zb,mb,Ob,Ta,sb,0)};var ka=a(88),L=a(724),fa=a(807);class wa{}
wa.Shi="EnrichmentContentFrame";wa.width=320;Object(c.a)(wa,"EnrichmentConstants",null,[]);class oa{constructor(ec){this.messageType=0;this.messageType=ec}}Object(c.a)(oa,"EnrichmentResponseMessage",null,[]);class xa extends oa{constructor(ec,mb){super(ec);this.messageContent=null;this.messageContent=mb}}Object(c.a)(xa,"EnrichmentResponseMessageWithContent",oa,[]);class bb extends xa{constructor(ec,mb,Ob){super(ec,mb);this.telemetryJson=null;this.telemetryJson=Ob}}Object(c.a)(bb,"EnrichmentResponseMessageWithContentAndTelemetryData",
xa,[]);var Za=a(270),La=a(13),va=a(100),Ba=a(47),Ea=a(90),pa=a(113),$a=a(40),cb=a(82),ib=a(27),ta=a(111),Ya=a(715),Da=a(25);class ba{constructor(ec,mb,Ob,Ta,sb){this.cr=this.vk=this.Sbe=this.Pbe=this.Xv=this.Xu=null;this.px=!1;this.Fi=ec;this.fe=mb;this.kP=Ob;this.fc=Ta;this.La=sb;this.Kqa=pa.KeyInputManager.Fl(Ea.a.Fpa,0)}get ZNb(){return!0}get qvb(){return d.AFrameworkApplication.fa.Wa("EnrichmentPaneUrl")}dispose(){this.ZNb&&this.cr&&(this.Fi.Aa(La.a.click,this.cr,Object(ka.a)(this,this.tl,"onClosePaneClick")),
this.fe.Aa(La.a.Qd,this.cr,Object(ka.a)(this,this.fHf,"onKeyHide")));this.cr=null;this.Xv&&(this.L2j(),this.Xv.parentNode.removeChild(this.Xv),this.Xv=null);this.fc.zi("EnrichmentPaneId").Dk(this.Kqa)}show(ec,mb,Ob){this.Xu=ec;this.px||(this.vk=this.V1a(),this.Rna.appendChild(this.vk),this.Dkj(),this.La.Qb(Da.a.kFe,ta.a.frame,Object(ka.a)(this,this.nci,"handleEscapeKeyAction")),this.VSa(),this.px=!0);this.Xv.src=this.qvb&&this.qvb.length?this.qvb+"?culture="+mb.market+"&appName="+mb.applicationName+
"&themeId="+mb.themeId+"&featuresBitMask="+mb.featuresBitMask:ba.BAf;this.Pbe=mb;this.Sbe=Ob;this.nfb()}gFc(ec,mb){ec=new bb(2,ec,mb);this.ptc(ec)}VSa(){const ec=this.fc.zi("EnrichmentPaneId");ec.parent=Za.AFrame.TOa;this.Fi.Xob("EnrichmentPaneId",this.vk);ec.bindAction(this.Kqa,Da.a.kFe)}y7f(){if(this.Xv){va.FocusManager.opa(this.Xv.contentWindow);const ec=new bb(4,null,null);this.ptc(ec)}}tl(){this.k5b();return!0}fHf(ec){ec=ec.Ea.keyCode;return ec===Sys.UI.Key.enter||ec===Sys.UI.Key.space?(this.k5b(),
!0):!1}k5b(){this.hide();if(this.Xu)this.Xu.onPaneClosed()}V1a(){const ec=L.a("div","EnrichmentPaneId","EnrichmentPane");this.ZNb&&ec.appendChild(this.j7c());this.Jli(ec);return ec}j7c(){const ec=L.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),mb=L.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");mb.innerText=CommonUIStrings.l_EnrichmentPaneTitle;mb.title=CommonUIStrings.l_EnrichmentPaneTitle;const Ob=fa.a.ob("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.Fi.ta(La.a.click,Ob,Object(ka.a)(this,this.tl,"onClosePaneClick"));this.fe.ta(La.a.Qd,Ob,Object(ka.a)(this,this.fHf,"onKeyHide"));ec.appendChild(mb);ec.appendChild(Ob);this.cr=Ob;return ec}Jli(ec){this.Xv=L.b("iframe","","EnrichmentFrame");ec.appendChild(this.Xv);this.Xv.id=wa.Shi;this.Xv.setAttribute("role","presentation")}Dkj(){Ba.a.addHandler(this.Xv,"load",Object(ka.a)(this,this.JGf,"onIFrameLoad"));Ba.a.addHandler(this.Xv,"error",Object(ka.a)(this,this.Cqc,
"onIFrameError"));$addHandler(window,"message",Object(ka.a)(this,this.KGf,"onIFrameMessage"))}L2j(){Ba.a.removeHandler(this.Xv,"load",Object(ka.a)(this,this.JGf,"onIFrameLoad"));Ba.a.removeHandler(this.Xv,"error",Object(ka.a)(this,this.Cqc,"onIFrameError"));$removeHandler(window,"message",Object(ka.a)(this,this.KGf,"onIFrameMessage"))}Zmh(){this.Xv.src=ba.BAf}hide(){this.ogc();this.Zmh()}nci(ec,mb,Ob){if(1!==Ob&&(this.hide(),this.Xu))this.Xu.onPaneClosed();return 32}JGf(){}Cqc(){}KGf(ec){ec=ec.rawEvent;
if(!this.Xv||-1!==this.Xv.src.indexOf(ec.origin)){try{var mb=$a.a(ec.data)}catch(Ob){return}if(!Ya.c(mb.messageType)){ec=window.g_badCastCallback;window.g_badCastCallback=null;switch(mb.messageType){case 2:this.ptc(new bb(1,$a.c(this.Pbe),this.Sbe));break;case 1:this.ptc(new xa(0,this.rSh()));break;case 3:this.Xu&&this.Xu.selectEntity(mb.messageContent);break;case 5:this.Xu&&this.Xu.LFb(mb.messageContent);break;case 8:this.Xu&&(mb=$a.a(mb.messageContent),0<mb.DomainId?this.Xu.lRd(mb.Query,mb.TelemetryJson,
mb.DomainId,mb.DomainIdString):this.Xu.searchEntity(mb.Query,mb.TelemetryJson));break;case 6:this.Xu&&this.Xu.cancelSearch();break;case 11:mb=$a.a(mb.messageContent);mb=ba.a7b("keydown","f6",Ea.a.sSb,!0,!1,mb,!0,!1);this.Xv&&this.Xv.dispatchEvent(mb);break;case 12:if($a.a(mb.messageContent).keyCode===Ea.a.sG&&(mb=ba.a7b("keydown","esc",Ea.a.sG,!0,!1,!1,!1,!1),this.Xv&&(this.Xv.dispatchEvent(mb),this.hide(),this.Xu)))this.Xu.onPaneClosed();break;case 13:this.Xu&&this.Xu.selectDataType(mb.messageContent);
break;case 14:this.Xu&&this.Xu.showHelpArticle(mb.messageContent);break;case 15:this.Xu&&this.Xu.showSurveyDialog(mb.messageContent);break;case 16:this.Xu&&(mb=$a.a(mb.messageContent),this.Xu.insertTable(mb.DomainId,mb.DomainIdString))}window.g_badCastCallback=ec}}}rSh(){return $a.c([2,1,3,5,8,6])}ptc(ec){ec=$a.c(ec);this.Xv.contentWindow.postMessage(ec,cb.a.oba(this.qvb))}static a7b(ec,mb,Ob,Ta,sb,zb,db,jb){ib.a.Cw?(zb=String.format("{0} {1} {2}",zb?"Shift":"",db?"Control":"",jb?"Alt":""),zb.trim(),
Ob=document.createEvent("KeyboardEvent"),Ob.initKeyboardEvent(ec,Ta,sb,window.self,mb,0,zb,!1,"en-US")):(mb={},mb.keyCode=Ob,mb.ctrlKey=db,mb.shiftKey=zb,mb.altKey=jb,mb.bubbles=Ta,mb.cancelable=sb,Ob=new KeyboardEvent(ec,mb));return Ob}}ba.BAf="about:blank";Object(c.a)(ba,"EnrichmentPane",null,[729,3]);class ya extends ba{constructor(ec){super(d.AFrameworkApplication.sa.By,d.AFrameworkApplication.sa.Ut,d.AFrameworkApplication.sa.Kea,d.AFrameworkApplication.sa.Se,d.AFrameworkApplication.rb);this.taskPane=
ec;this.taskPane.$Qg(this.y7f)}get Rna(){return this.taskPane.mc}nfb(){this.taskPane.isVisible||this.taskPane.Sg(!0)}ogc(){this.taskPane.Sg(!1)}dispose(){this.taskPane&&(this.taskPane.spj(this.y7f),this.taskPane=null);super.dispose()}}Object(c.a)(ya,"EnrichmentTaskPaneWrapper",ba,[]);class V{constructor(ec){this.Ly=null;this.Gfa=ec}jDi(ec,mb){this.Ly=ec;this.Gfa&&this.Gfa.show(this,mb,null)}gFc(ec,mb){this.Gfa&&this.Gfa.gFc(ec,mb)}Uzb(){this.Gfa&&this.Gfa.hide()}dispose(){this.Gfa&&(this.Gfa.dispose(),
this.Gfa=null)}selectEntity(ec){return this.Ly?this.Ly.selectEntity(ec):!1}searchEntity(ec,mb){this.Ly&&this.Ly.searchEntity(ec,mb)}lRd(ec,mb,Ob,Ta){this.Ly&&this.Ly.lRd(ec,mb,Ob,Ta)}LFb(ec){return this.Ly?this.Ly.LFb(ec):!1}onPaneClosed(){if(this.Ly)this.Ly.onPaneClosed()}cancelSearch(){this.Ly&&this.Ly.cancelSearch()}selectDataType(ec){this.Ly&&this.Ly.selectDataType(ec)}showHelpArticle(ec){this.Ly&&this.Ly.showHelpArticle(ec)}showSurveyDialog(ec){this.Ly&&this.Ly.showSurveyDialog(ec)}insertTable(ec,
mb){this.Ly&&this.Ly.insertTable(ec,mb)}}Object(c.a)(V,"EnrichmentManager",null,[728,3]);class Z extends V{constructor(ec){super(ec)}dispose(){super.dispose()}}Object(c.a)(Z,"ExcelEnrichmentManager",V,[]);var ja=a(14);class la{constructor(ec){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=ec;this.commentQuestion=ja.a.instance.nb(199);
this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=ja.a.instance.nb(195);this.ratingValuesAscending=[ja.a.instance.nb(196),ja.a.instance.nb(197),ja.a.instance.nb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=ja.a.instance.nb(194)}}Object(c.a)(la,"FloodgateSurvey",null,[]);var ua=a(24),eb=a(73),Eb=a(427),Wb=a(44),Ab=a(379),Jb=a(198),Gb=a(33),Nb=a(96),Ja=a(29),ab=a(290),wb=a(21);class xb{constructor(){this.market=this.appCorrelationId=
this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(xb,"EnrichmentMessageContentAppProperties",null,[]);class rb{constructor(ec,mb,Ob,Ta,sb){this.wua=this.tOe=!1;this.ceb=this.zxa=!0;this.cIb=this.gOb=!1;this.xfb=null;this.vsc=0;this.yR=()=>{(this.ceb||this.wua)&&2!==this.vsc&&(this.cIb||this.Vwd(!1))};this.Wc=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.aVi=zb=>{Ja.a.Zf(zb.Errors)?(zb=Ja.a.qc(zb.Errors),zb.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${zb}`)):zb.Result&&(this.$.ea.pk(this.Wc),this.$.ea.Oj(this.Wc),zb=zb.Result,this.xfb=zb.SkydanceFeatureBitmask,this.kBd(zb),this.gOb=!0)};this.gh=()=>{(this.ceb||this.wua)&&this.Vwd(!1)};this.vqc=(zb,db)=>{Ja.a.Zf(zb.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Ja.a.qc(zb.Errors)}`):zb.Result&&(zb=zb.Result,zb.DisambiguationJson?(this.gOb=!1,this.t8f(db),this.xfb=zb.SkydanceFeatureBitmask,db=zb.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.cIb=!1,this.fsf(db)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.KXi=(zb,db)=>{Ja.a.Zf(zb.Errors)?(db=Ja.a.qc(zb.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${db}`)):zb.Result&&(zb=zb.Result,zb.DisambiguationJson?(this.t8f(db),this.xfb=zb.SkydanceFeatureBitmask,db=zb.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.cIb=!0,this.fsf(db)):b.ULS.sendTraceTag(537166939,0,
10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.l0i=zb=>{Ja.a.Zf(zb.Errors)?(zb=Ja.a.qc(zb.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${zb}`),this.ceb=!0):zb.Result&&(zb=zb.Result,this.xfb=zb.SkydanceFeatureBitmask,this.kBd(zb),this.gOb=!0)};this.f3i=zb=>{if(Ja.a.Zf(zb.Errors)){const db=Ja.a.qc(zb.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${db}`)}zb.Result?
(this.kBd(zb.Result),this.gOb=!0):this.Dta()};this.xKf=zb=>{Ja.a.Zf(zb.Errors)?(zb=Ja.a.qc(zb.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${zb}`)):zb.Result?this.o$b.gFc(zb.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.Dta())};this.TZi=zb=>{Ja.a.Zf(zb.Errors)?(zb=Ja.a.qc(zb.Errors),b.ULS.sendTraceTag(537166926,
0,15,`Failed to insert starter data table. Error id names: ${zb}`)):this.Dta()};this.$=ec;this.gridView=wb.h(this.$);this.gridView.ha.HT(this.gh);this.gridView.ev(this.yR);this.qSe=Ta;this.convertToLinkedEntityManager=sb;Gb.a.Gd(this.$)||Ob.VQ(mb);ec=new ya(mb);this.o$b=new Z(ec);w.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(zb=>{zb.isFeatureEnabled("mso_sendASmile",!0).then(db=>{this.zxa=db;return null})})}dispose(){this.$&&(this.gridView.ha.PR(this.gh),
this.gridView.ty(this.yR))}selectEntity(ec){const mb=Wb.o(this.gridView.ha.ra.activeCell,this.$),Ob=()=>new Eb.a;Ab.a(this.$.userOperationManager,(Ta,sb,zb)=>O(this.$.pa.va,mb,ec,ab.b(Ta,this.f3i),sb,zb,null),Ta=>new Jb.a(109,0,Ta,void 0,Ob),null);return!0}searchEntity(ec,mb,Ob=!1,Ta=0,sb=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${mb}`);const zb=Wb.o(this.gridView.ha.ra.activeCell,this.$);Ab.a(this.$.userOperationManager,
(db,jb,Ub)=>N(this.$.pa.va,zb,ec,this.zxa,Ob,Ta,sb,ab.b(db,this.xKf),jb,Ub,null),db=>new Jb.a(110,0,db,16),null)}LFb(ec){const mb=Wb.o(this.gridView.ha.ra.activeCell,this.$);this.ceb=!1;Ab.a(this.$.userOperationManager,(Ob,Ta,sb)=>W(this.$.pa.va,mb,ec,ab.b(Ob,this.l0i),Ta,sb,null),Ob=>new Jb.a(111,0,Ob,16),null);return!0}onPaneClosed(){this.wua=!1;this.tOe=!0;this.vsc=0;this.cIb=!1}cancelSearch(){const ec=this.ERd();ec&&Ab.a(this.$.userOperationManager,(mb,Ob,Ta)=>ea(this.$.pa.va,ec,ab.b(mb,this.xKf),
Ob,Ta,null),mb=>new Jb.a(112,0,mb,16),null)}selectDataType(ec){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Dta();if(ec&&ec.length)if(ec=JSON.parse(ec))if(null==ec.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var mb={};mb.Id=ec.domainId;mb.StringId=ec.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(mb)}else b.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(ec){const mb=new Nb.a(-859308420,eb.a.zb,this.$.xc,9,null);this.$.Ia.Hb(mb,{[eb.a.Sf]:"HelpID="+ec,["InputMethod"]:eb.a.zb,["ShouldCanvasTakeFocus"]:!0,[eb.a.Pc]:m.a.mV})}showSurveyDialog(ec){y.a.JOb(new la(ec))}insertTable(ec,mb){const Ob=this.ERd();Ob&&Ab.a(this.$.userOperationManager,(Ta,sb,zb)=>
J(this.$.pa.va,Ob,ec,mb,ab.b(Ta,this.TZi),sb,zb,null),Ta=>new Jb.a(259,0,Ta,1),null)}Vwd(ec){this.launchOrCloseDisambiguationPane(ec)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const ec=this.vzj();ec&&Ab.a(this.$.userOperationManager,(mb,Ob,Ta)=>E(this.$.pa.va,ec,!0,this.zxa,!1,null,ab.b(mb,this.KXi),Ob,Ta,1),mb=>new Jb.a(114,0,mb,16),null)}launchLinkedEntityDataTypeSelectorPane(ec,
mb){Ab.a(this.$.userOperationManager,(Ob,Ta,sb)=>R(this.$.pa.va,ec,mb,ab.b(Ob,this.vqc),Ta,sb,2),Ob=>new Jb.a(233,0,Ob,16),null)}dDi(ec,mb){ec&&Ab.a(this.$.userOperationManager,(Ob,Ta,sb)=>E(this.$.pa.va,ec,!1,!1,!0,mb,ab.b(Ob,this.vqc),Ta,sb,2),Ob=>new Jb.a(257,0,Ob,16),null)}t8f(ec){ec&&(this.vsc=ec)}fsf(ec){var mb=new Nb.a(-90814711,eb.a.zb,0,10,null);this.$.Ia.Hb(mb,null);this.wua?this.o$b.gFc(ec,null):(mb=3,null!=this.xfb?mb=this.xfb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),
(ec=this.gYh(ec,mb))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.qSe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.o$b.jDi(this.qSe,ec),this.wua=!0)}Dta(){this.wua&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.o$b.Uzb(),this.wua=!1,this.vsc=0,this.cIb=!1)}kBd(ec){var mb=ec.Row+1;ec=ec.Column+1;0>mb||0>ec?(b.ULS.sendTraceTag(537166933,
0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Dta(),this.$.ea.pk(this.Wc)):(mb=new ua.Range(mb,ec,mb,ec,!0,!1),this.gridView.ha.updateSelection(mb,mb,60),this.ceb=!0)}gYh(ec,mb){const Ob=new xb;Ob.applicationVersion=d.AFrameworkApplication.buildVersion;Ob.applicationName="ExcelWac";Ob.anid="00000000-0000-0000-0000-000000000000";Ob.sessionId=d.AFrameworkApplication.userSessionId;Ob.appCorrelationId=v.a.create().toString();var Ta=A.a.bK(d.AFrameworkApplication.lcid);
Ta=Ta?Ta.name:null;Ob.uiLanguage=Ta;Ob.market=this.gdc(Ta);Ob.themeId=0;Ob.disambiguationJson=ec;mb<=z.a.j1?Ob.featuresBitMask=mb:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Ob}gdc(ec){ec=ec.split("-");return ec[ec.length-1]}launchOrCloseDisambiguationPane(ec){const mb=this.gridView.ha.ra.activeCell;if(this.ERd()&&mb)if(this.gridView.tb.aBb(mb)){if((!this.tOe||ec||this.gOb)&&!this.gridView.eb){ec&&(this.ceb=!0);var Ob=
Wb.q(mb,this.$);Ab.a(this.$.userOperationManager,(Ta,sb,zb)=>E(this.$.pa.va,Ob,!1,this.zxa,!1,null,ab.b(Ta,this.vqc),sb,zb,1),Ta=>new Jb.a(114,0,Ta,16),null)}}else this.Dta();else this.Dta()}sjj(){if(this.wua){var ec=this.gridView.ha.ra.activeCell;if(ec){var mb=Wb.q(ec,this.$);Ab.a(this.$.userOperationManager,(Ob,Ta,sb)=>E(this.$.pa.va,mb,!1,this.zxa,!1,null,ab.b(Ob,this.vqc),Ta,sb,1),Ob=>new Jb.a(114,0,Ob,16),null)}else this.Dta()}}ERd(){const ec=this.gridView.ha.ra;return ec.aca()?Wb.o(ec.activeCell,
this.$):null}vzj(){const ec=this.gridView.ha.ra;return ec.aca()?Wb.q(ec.activeCell,this.$):null}}Object(c.a)(rb,"ConvertToLinkedEntityDisambiguationPane",null,[3]);var za=a(7),Aa=a(382),pb=a(1345),kb=a(52),Cb=a(732);class ob{constructor(ec,mb,Ob){this.Esf=2;this.Dsf="Size64by48";this.$=ec;this.Xa=mb;this.convertToLinkedEntityManager=Ob}gQh(ec,mb){var {ConvertToLinkedEntityManager:Ob}=a(776);this.p5j();mb=this.Xa.Bq(mb).AE();let Ta=0,sb=0,zb=!1;for(var db of ec.Categories){const jb=this.MQh(db,Ta);
jb&&(sb===Ob.I9a&&(zb=!0),mb.MenuSectionList.push(jb),++Ta);++sb}zb&&Ta<=Ob.Fsf&&mb.MenuSectionList.splice(Ob.I9a,1);Ob=this.Xa.Jc().s3b();db=kb.a.Le(11);for(const jb of ec.LongButtons)this.convertToLinkedEntityManager.$Lj(jb)&&this.zNg(Ob,jb,db);0<Ob.ControlList.length&&mb.MenuSectionList.push(Ob);return mb}zNg(ec,mb,Ob){if(mb){var Ta="Data.ConvertToLinkedEntityMenuItem_"+mb.Name,sb=this.convertToLinkedEntityManager.zU(mb.DomainId);sb&&(mb=Object(za.a)(new Aa.a,{Id:Ta,ExternalId:Ta,Command:"-1662108744",
LabelText:mb.Name,Alt:mb.SuperTip,Visible:!0,MenuItemId:a(776).ConvertToLinkedEntityManager.V2a(mb.DomainId),Image16by16:Ob,Image16by16Class:this.yii(sb.FontLocator)}),ec.ControlList.push(mb))}}HQh(ec,mb){return Object(za.a)(new pb.a,{Id:a(776).ConvertToLinkedEntityManager.kQe+ec.toString(),ExternalId:a(776).ConvertToLinkedEntityManager.kQe+ec.toString(),MenuItemId:a(776).ConvertToLinkedEntityManager.Q$c+ec.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.xff(mb.FontLocator),
LabelText:mb.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.mhd(mb)})}cYg(ec){switch(ec){case "Animal":return Cb.a.qUg;case "Apple":return Cb.a.uVg;case "Atom":return Cb.a.XWg;case "Beaker":return Cb.a.RYg;case "Bridge":return Cb.a.s_g;case "Cat":return Cb.a.y5g;case "City":return Cb.a.O7g;case "Constellation":return Cb.a.Hbh;case "Dog":return Cb.a.Esh;case "Finance":return Cb.a.JYg;case "GradCap":return Cb.a.Xai;case "HumanAnatomy":return Cb.a.Phi;case "LocationPointer":return Cb.a.KFi;
case "Map":return Cb.a.I6i;case "MedicineNeedle":return Cb.a.uMi;case "Mountain":return Cb.a.LNi;case "Movie":return Cb.a.dOi;case "Music":return Cb.a.qOi;case "OuterSpace":return Cb.a.l7i;case "Planet":return Cb.a.s$i;case "Satellite":return Cb.a.Rwj;case "WolframGeneric":return Cb.a.Hvj;default:return Cb.a.pdh}}yii(ec){if("PowerBIRibbon"!==ec)return x.a.fcd;switch(ec){case "AnimalRibbon":return x.a.JDh;case "AppleRibbon":return x.a.KDh;case "AtomRibbon":return x.a.LDh;case "BeakerRibbon":return x.a.MDh;
case "BridgeRibbon":return x.a.NDh;case "CenterMapRibbon":return x.a.ODh;case "CityRibbon":return x.a.PDh;case "CurrencyRibbon":return x.a.QDh;case "ExerciseRibbon":return x.a.RDh;case "FinanceRibbon":return x.a.CWe;case "FirstAidRibbon":return x.a.SDh;case "GlobeLightningRibbon":return x.a.TDh;case "GradCapRibbon":return x.a.UDh;case "HumanAnatomyRibbon":return x.a.VDh;case "LeafRibbon":return x.a.WDh;case "LocationPointerRibbon":return x.a.YDh;case "MapRibbon":return x.a.AWe;case "MountainRibbon":return x.a.ZDh;
case "MovieRibbon":return x.a.$Dh;case "MusicRibbon":return x.a.aEh;case "NotablePeopleRibbon":return x.a.bEh;case "OuterSpaceRibbon":return x.a.cEh;case "PartlySunnyWeatherRibbon":return x.a.dEh;case "PowerBIRibbon":return x.a.BWe;case "SatelliteRibbon":return x.a.eEh;case "WolframGenericRibbon":return x.a.XDh;case "YogaRibbon":return x.a.gEh;default:return x.a.zWe}}xff(ec){switch(ec){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";
case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";
case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";
case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}MQh(ec,mb){mb=this.Xa.HC("ConvertToLinkedEntitySection_"+mb,this.Esf,this.Dsf);var Ob=!1;for(var Ta of ec.DomainIds){const sb=this.convertToLinkedEntityManager.zU(Ta);if(!sb||sb.DomainBlocked||!sb.ShowInRibbon)continue;Ob=sb.Name;const zb=a(776).ConvertToLinkedEntityManager.V2a(Ta);
mb.hu("Data.ConvertToLinkedEntityMenuItem_"+zb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,zb,this.xff(sb.FontLocator),void 0,void 0,this.mhd(sb),Ob);Ob=!0}if(!Ob)return null;Ta=mb.p3b(!0);mb=this.Xa.Jc();mb.title=ec.Name;ec=mb.s3b();ec.ControlList.push(Ta);return ec}p5j(){this.Esf=5;this.Dsf="Size112by64"}mhd(ec){return ec.RibbonTooltipHeader?ec.RibbonTooltipHeader+"\n\n"+ec.RibbonTooltip:ec.RibbonTooltip}}Object(c.a)(ob,"ConvertToLinkedEntityMenuRenderer",null,[696]);var qa=a(59),ma=a(291),
Ga=a(117),vb=a(1),Ka=a(150),Pa=a(72);class fb{constructor(ec,mb){this.Vmd=this.Xmd=!1;this.N1i=Ob=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Xmd=!0;if(Ja.a.Zf(Ob.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Ja.a.qc(Ob.Errors)}`);else{var Ta=0,sb=[],zb=!1;try{if(!Ob.Result)return;const db=Ob.Result;if(!db){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}sb=
this.F8i(db);if(!sb||!sb.length)return;Ta=sb.length;this.KMi(sb);this.cBa.P0f();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.cBa.Fcb.length}`);if(vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const jb of this.cBa.Fcb)if(1===(jb.Id&1048320)>>8){zb=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${zb}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Ta} data types.`),
Ob=[],Ob.push(Object(za.a)(new Pa.a,{name:"MruCount",int64:Ta})),Ob.push(Object(za.a)(new Pa.a,{name:"MruWolframAvailable",bool:zb})),Ka.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Ob)}this.Vmd&&(this.Lqg(this.cBa.Fcb),this.Vmd=!1)}};this.g6i=Ob=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Ja.a.Zf(Ob.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Ja.a.qc(Ob.Errors)}`):Ob.Result&&(Ob.Result||b.ULS.sendTraceTag(537166672,
0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.bKf=(Ob,Ta,sb)=>{Ob=Ga.a.Ue(Ob.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${sb}. Errors: ${Ja.a.qc(Ob)}.`)};this.$=ec;this.cBa=mb}p5h(){!this.Xmd&&this.$.ea.Yb&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),ma.w(this.$.pa.va,0,this.N1i,this.bKf,null,null))}Lqg(ec){ec&&ec.length?
this.Xmd?(ec=this.dBj(ec))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),ma.C(this.$.pa.va,0,ec,this.g6i,this.bKf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Vmd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}dBj(ec){if(!ec||
!ec.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var mb=[];for(const Ob of ec)ec={},ec.Id=Ob.Id,Ob.StringId&&(ec.StringId=Ob.StringId),mb.push(ec);mb="<DataTypes>"+qa.a.Ec(mb)+"</DataTypes>";return 1906<mb.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):mb}F8i(ec){if(!ec)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!ec.startsWith("<DataTypes>")||!ec.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;ec=ec.substring(11,ec.length-12);if(!ec)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let mb=[];try{mb=qa.a.Yh(ec)}catch(Ob){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Ob.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${mb.length} data types.`);return mb}KMi(ec){const mb=this.cBa.Fcb,Ob=this.cBa.oij;if(mb.length!==Ob){for(let Ta=0;Ta<ec.length&&mb.length<Ob;++Ta){const sb=ec[Ta];this.cBa.zU(sb)&&!mb.includes(sb)&&mb.push(sb)}this.cBa.Fcb=mb}}}Object(c.a)(fb,"LinkedDataTypeRoamingHandler",null,[]);var Wa=a(60),Ma=a(50),lb=a(180),Na=a(38),X=a(49),F=a(28),na=a(255),hb=a(22),Ib=a(103),vc=a(70),nc=a(108),Pb=a(153),oc=a(54);a.d(B,"ConvertToLinkedEntityManager",
function(){return Ic});class Ic extends n.a{constructor(ec,mb,Ob,Ta,sb,zb,db){super();this.Qof=this.Eud=this.Cvd=this.wtd=this.vtd=this.n8a=this.Aqd=null;this.nGb=this.wmd=0;this.Yla=null;this.Kqd=!1;this.vfd=this.Rn=this.oQd=null;this.rs=0;this.BY=null;this.YLa=8;this.p2c=this.Csf=this.Lkf=this.Vab=!1;this.Uza=this.Q1e=this.yZe=null;this.t0c=0;this.mYg=5;this.G2b=3E4;this.Pig=!1;this.q$=null;this.Iua=Array(5);this.ulg=this.o1d=!1;this.h2f=this.uxd=0;this.htmlSanitizationHelper=this.Ofe=null;this.Ccg=
!0;this.Wc=(jb,Ub)=>{Ub.Yb&&!Ub.QCb&&this.showUntrustedImageBusinessBarIfNecessary()};this.LYi=jb=>{if(jb.Result){var Ub=jb.Result;if(Ub&&Ub.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Ub.length} labels`);var xd=Ma.GetServiceTaskFactory.Pa(this.$.da,274,275,0);Na.TaskExtensions.za(xd,()=>{xd.result.h0c(Ub,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ka,3)}}else b.ULS.sendTraceTag(537166923,
0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.xf=()=>{this.s0j();this.cdi(this.$.ea.Tm.LinkedEntityAsyncRefreshStateId);this.y8a?this.gei(this.$.ea.Tm.RichDataClassificationLabelStateId):this.E7a&&this.B0d(!0)};this.gWi=()=>{this.o1d=!0;this.Rn&&this.Rn.sjj()};this.cYi=jb=>{if(jb&&!na.a(jb))try{jb.Result.HasUntrustedImageUrl&&(this.businessBar.sh(59,null),this.ulg=!0)}catch(Ub){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Ub}.`)}};
this.csf=()=>{if(!this.Csf&&this.sBb()&&!this.xrd())if(Ka.a("DataTabActive"),Wa.a.rg.dR)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var jb=this.O6b();if(jb){var Ub={};Ub.InputMethod=eb.a.zb;Ub.CalloutName=8;Ub.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ia.Hb(jb,Ub);this.Csf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.bVi=jb=>{Ja.a.Zf(jb.Errors)||(this.y8a||this.B0d(!1),this.raiseEvent("LinkedEntityConverted"))};this.g4i=()=>{this.$.da.hb(211,jb=>{jb.readText(ja.a.instance.ga(1813))})};this.od=(jb,Ub)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Ub.EV?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.HDe():this.ktj(),this.o1d&&this.sRe())};this.mYi=jb=>{this.V4b();if(jb.Result){var Ub=jb.Result;jb=Ub.DomainDataArray;if(this.Yla=Ub.Ribbon){var xd={};xd.Name=ja.a.instance.ga(1803);xd.DomainIds=this.wK;this.Yla.Categories.splice(Ic.I9a,0,xd)}0<Ub.MaximumCellsToConvert&&(this.Ofe=Ub.MaximumCellsToConvert);this.rs=2;Ub=!1;if(jb){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${jb.length} domains`);
this.uOa||(this.uOa=[]);xd=ja.a.instance.ga(1800);const ne=ja.a.instance.ga(1802);for(const fe of jb)fe.DomainId?(this.uOa.push(fe),fe.DomainBlocked?(jb=!!fe.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${jb?fe.DomainId.Id.toString():fe.Name} is telemetry only, do not show in menu (Has String ID: ${jb})`)):(this.yU.ia(Ic.V2a(fe.DomainId),fe),fe.Name===xd||268435456===fe.DomainId.Id?this.yZe=fe.DomainId.Id.toString():fe.Name===ne||536870912===fe.DomainId.Id?this.Q1e=fe.DomainId.Id.toString():
268435712===fe.DomainId.Id&&fe.ShowInRibbon&&(this.p2c=!0),Ub=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Ub||(this.uOa=null);this.jmg();this.oQd.p5h();this.Pig||(this.n0j(),this.Pig=!0)}else this.uOa=null,this.rs=3,-1<this.YLa&&window.setTimeout(()=>{this.ZIb()},100*(8-this.YLa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.TLd();this.ZJe();this.p2c&&this.dmf&&lb.c(this.csf,this.$.ka,500);
this.E7a&&!this.y8a&&this.B0d(!0)};this.lYi=jb=>{jb=Ga.a.Ue(jb.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Ja.a.qc(jb)}].`);this.uOa=null;this.rs=3;this.Vab=!0;this.TLd()};this.onContentReady=()=>{this.dkg()&&this.gridView.ty(this.onContentReady);this.Ccg&&this.$.workbookContext.Options&1048576&&(this.businessBar.NPj(),this.Ccg=!1)};this.Ak=()=>{this.V4b()};this.K_i=jb=>{if(na.a(jb)){const Ub=Object(vc.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?
Object(nc.c)(Pb.a.resolve(oc.e,{Wb:0})):Ma.GetServiceTaskFactory.Pa(this.$.da,5,4,0);Na.TaskExtensions.za(Ub,()=>{let ne=null;if(null===jb||void 0===jb?0:jb.Errors)ne=jb.Errors[0];Ub.result.gcg(ne,null)},this.$.ka,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ja.a.qc(jb.Errors)}].`);const xd=Ja.a.Oz(jb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");
this.$.ea.$n(xd)}};this.h2c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.G2b} millisecond interval`);this.iif("Periodic auto-refresh check",this.qTi,this.pTi)};this.qTi=jb=>{na.a(jb)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ja.a.qc(jb.Errors)}].`),++this.t0c):this.t0c=0;e.a.Ja(this.Uza);this.t0c>=this.mYg?
(b.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.Uza=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.Uza=X.a.instance.create(this.h2c,this.G2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.pTi=jb=>{jb=Ga.a.Ue(jb.data);f.a.ah(jb)?b.ULS.sendTraceTag(537166791,
0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Ja.a.qc(jb)}].`);e.a.Ja(this.Uza);this.Uza=X.a.instance.create(this.h2c,this.G2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.K0i=jb=>{jb=!!jb.Result&&jb.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${jb.toString()}`);
jb?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${F.a.Ya.ze.m-this.wmd} ms, retry count = ${this.nGb}`),this.ZIb()):this.SBc()};this.J0i=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.SBc()};this.OXi=jb=>{jb.Result?(jb=jb.Result)?(this.eNd(),this.businessBar.gcg(null,jb)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,
0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=ec;this.businessBar=zb;this.svgIconProvider=Ob;this.htmlSanitizationHelper=db;this.uOa=[];this.wK=[];this.gridView=wb.h(this.$);this.Lfc=-1;this.evi=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.E7a=vb.EwaSettings.xa(387)&&vb.EwaSettings.xa(259);this.y8a=vb.EwaSettings.xa(586);this.dmf=vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",
!1);this.yU=new Ib.a;this.m$a=new ob(ec,mb,this);Ta&&(this.Rn=new rb(ec,Ta,sb,this,this));this.$.hl(this.od);u.a(this.$)&&u.a(this.$).FCj(this);this.HDe();(this.E7a||this.y8a)&&this.$.ea.ju(this.xf);vb.EwaSettings.xa(123)&&vb.EwaSettings.xa(131)&&(this.dkg()||this.gridView.ev(this.onContentReady));this.$.iC(this.Ak);this.$.ea.Oj(this.Wc);this.showUntrustedImageBusinessBarIfNecessary();this.oQd=new fb(this.$,this)}dispose(){(this.E7a||this.y8a)&&this.$.ea.Lv(this.xf);this.$.ea.pk(this.Wc);!this.q$&&
vb.EwaSettings.xa(123)&&vb.EwaSettings.xa(131)&&this.gridView.ty(this.onContentReady);this.Rn&&this.Rn.dispose();this.$.UF(this.Ak);this.$.em(this.od);this.E7a&&(this.Aqd=null);e.a.Ja(this.Uza)}FQg(ec){this.addHandler("LinkedEntityConverted",ec)}cpj(ec){this.removeHandler("LinkedEntityConverted",ec)}get oij(){return 5}get Fcb(){return this.wK}set Fcb(ec){this.wK=ec}selectEntity(ec){return this.Rn?this.Rn.selectEntity(ec):!1}searchEntity(ec,mb){this.Rn&&this.Rn.searchEntity(ec,mb)}lRd(ec,mb,Ob,Ta){this.Rn&&
this.Rn.searchEntity(ec,mb,!0,Ob,Ta)}LFb(ec){return this.Rn?this.Rn.LFb(ec):!1}onPaneClosed(){if(this.Rn)this.Rn.onPaneClosed()}cancelSearch(){this.Rn&&this.Rn.cancelSearch()}selectDataType(ec){this.Rn&&this.Rn.selectDataType(ec)}showHelpArticle(ec){this.Rn&&this.Rn.showHelpArticle(ec)}showSurveyDialog(ec){this.Rn&&this.Rn.showSurveyDialog(ec)}insertTable(ec,mb){this.Rn&&this.Rn.insertTable(ec,mb)}gei(ec){this.$.isEditMode&&this.h2f!==ec&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&(this.h2f=
ec,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),H(this.$.pa.va,this.LYi,null,null,null))}sRe(){this.$.userOperationManager.Oc(new Jb.a(589,0,(ec,mb,Ob)=>da(this.$.pa.va,ab.b(ec,this.gWi),mb,Ob,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.o1d||this.ulg||!this.$.ea.Yb||this.iAj()}iAj(){this.$.userOperationManager.Oc(new Jb.a(588,0,(ec,mb,Ob)=>U(this.$.pa.va,ab.b(ec,this.cYi),mb,Ob,null),80),null)}B0d(ec){if(this.E7a&&
null==this.Aqd&&!this.y8a&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.n8a&&this.n8a&&(!ec||this.$.workbookContext.Options&262144)){var mb=Ma.GetServiceTaskFactory.Pa(this.$.da,274,275,0);Na.TaskExtensions.za(mb,()=>{this.Aqd=mb.result.wWf(2)},this.$.ka,3)}}get oFb(){return this.Iua.length}get pMi(){return this.Ofe}qdh(ec){(ec=this.Ish(ec))?this.convertToLinkedEntity(ec):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(ec){b.ULS.sendTraceTag(34415004,
0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${ec.Id}].`);if(this.gridView){var mb=this.gridView.ha.ra.xd,Ob=mb.xe(this.gridView.xQ);this.Kqd&&this.mOg(ec);if(Ob){Ob=this.gridView.tb.Fla(Ob);if(!this.Rcf(ec)&&this.onf(ec.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Wa.a.rg.dR){mb=this.Dgd();if(!mb){b.ULS.sendTraceTag(537166917,
0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ob=this.O6b();if(!Ob){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var Ta={["InputMethod"]:eb.a.zb,CalloutName:3};Ta.Target=mb;Ta.RibbonButtonLabel=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.V1f(ec):this.EDb(ec.Id.toString());Ta.ExampleEntities=this.xXe(ec);this.$.Ia.Hb(Ob,Ta);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.onf(ec.Id)&&
!ec.StringId)this.launchLinkedEntityDataTypeSelectorPane(Ic.V2a(ec));else{if(Ob){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.SUj(ec)){mb=Wb.r(this.gridView.ha.ra.selectedRanges,this.$);this.Rn.dDi(mb,ec);return}if(Wa.a.rg.dR){mb=this.Dgd();if(!mb){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");
return}Ob=this.O6b();if(!Ob){b.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}Ta={["InputMethod"]:eb.a.zb,CalloutName:2};Ta.Target=mb;Ta.RibbonButtonLabel=this.V1f(ec);Ta.ExampleEntities=this.xXe(ec);Ta.BlankCellResourceId=this.qZg(ec);Ta.HasBlankCellWalkthrough=this.afi(ec);Ta.ServiceDomain=ec.Id;this.$.Ia.Hb(Ob,Ta);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.f6c(ec,
!1,mb)}}}else b.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.q$&&this.q$.NIa()}onAutoDetectUIShown(){Ab.a(this.$.userOperationManager,(ec,mb,Ob)=>S(this.$.pa.va,ec,mb,Ob,null),ec=>new Jb.a(230,0,ec,80),null)}f6c(ec,mb,Ob){const Ta=Wb.q(Ob,this.$),sb=()=>new Eb.a;Ab.a(this.$.userOperationManager,(zb,db,jb)=>I(this.$.pa.va,Ta,ec,mb,ab.b(zb,this.bVi,this.g4i,this.Rn.aVi),db,jb,null),zb=>new Jb.a(115,0,zb,void 0,sb),null)}mOg(ec){if(this.Kqd){var mb=
{};mb.Id=ec.Id;ec.StringId&&(mb.StringId=ec.StringId);if(!(0<this.wK.length&&this.wK[0].Id===mb.Id&&this.wK[0].StringId===mb.StringId)){ec=!1;this.wK.splice(0,0,mb);for(let Ob=1;Ob<this.wK.length;++Ob)if(this.wK[Ob].Id===mb.Id&&this.wK[Ob].StringId===mb.StringId){this.wK.splice(Ob,1);ec=!0;break}for(;5<this.wK.length;)this.wK.splice(this.wK.length-1,1);this.Yla.Categories[Ic.I9a].DomainIds=this.wK;this.P0f();ec||this.oQd.Lqg(this.wK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,
"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var ec=Wb.q(this.gridView.ha.ra.xd,this.$);Ab.a(this.$.userOperationManager,(mb,Ob,Ta)=>D(this.$.pa.va,ec,mb,Ob,Ta,null),mb=>new Jb.a(116,0,mb),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(wb.h(this.$)){this.$.isEditMode||
b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.eNd();var ec=Wb.r(this.gridView.ha.ra.selectedRanges,this.$);Ab.a(this.$.userOperationManager,(mb,Ob,Ta)=>G(this.$.pa.va,ec,mb,Ob,Ta,null),mb=>new Jb.a(248,0,mb),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}$Lj(ec){ec=this.zU(ec.DomainId);if(!ec||ec.DomainBlocked||vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!ec.HasCuratedData)return!1;if(this.evi){for(let mb of this.yU)if(mb.value.DomainId.Id===ec.DomainId.Id&&mb.value.ShowInRibbon)return!0;return!1}return ec.ShowInRibbon}FKj(ec){return 2!==this.rs||!this.Iua[ec]}launchDisambiguationPaneForSearch(){this.Rn&&this.Rn.launchDisambiguationPaneForSearch()}Rc(ec,mb,Ob){if("PopulateConvertToLinkedEntityMenu"!==mb)return!1;this.vfd=Ob.MenuId;if(0===this.rs||3===this.rs)return this.W$i(),!0;if(!this.Yla)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),
!1;if(!this.yU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.BY=this.BY||this.m$a.gQh(this.Yla,Ob.MenuId);Ob.MenuItems=this.BY;return this.Kqd=!0}W$i(){-1===this.Lfc&&(this.ZIb(),this.Lfc=window.setInterval(()=>{this.ZIb()},2E3))}ZIb(){this.$.ea.Yb&&2!==this.rs&&(this.YLa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.rs=1,P(this.$.pa.va,this.mYi,this.lYi,null,null))}xrd(){return this.$.isEditMode&&
2!==this.rs&&(0<=this.YLa||!this.Vab)}$1d(ec){d.AFrameworkApplication.ug?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):u.a(this.$)?(this.T5j(),ec&&this.$.tf()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}ktj(){this.nGb=0;this.YLa=8;this.Vab=!1;this.rs=this.Lfc=0;this.uOa=this.Yla=null;this.V4b();for(let ec=0;ec<this.oFb;++ec)this.Iua[ec]=null;this.sBb()&&this.$1d(!0)}V4b(){this.BY=null}sBb(){const ec=
m.a.QJb,mb=u.a(this.$);return!!mb&&mb.yp.Vz===ec}jmg(){if(this.Yla){let Ob=0;var ec=-1,mb=-1;let Ta=0,sb=0,zb=0,db=0;const jb=[null,null,null,null,null];for(const Ub of this.Yla.Categories){let xd=!1;for(const ne of Ub.DomainIds){let fe=this.zU(ne);fe&&!fe.DomainBlocked&&fe.ShowInRibbon&&(Ob<this.oFb?(this.Iua[Ob]=ne,sb===Ic.I9a&&(-1===ec&&(ec=Ob),mb=Ob,db=mb-ec+1),++Ob):Ob===this.oFb&&Ta<db&&sb!==Ic.I9a&&(jb[Ta]=ne,++Ta),xd=!0)}xd&&++zb;++sb}if(-1<ec&&zb<=Ic.Fsf){for(;mb>=ec;--mb)this.Iua.splice(mb,
1);for(ec=0;ec<db;++ec)this.Iua.splice(Ob+ec,0,jb[ec])}for(;Ob<this.oFb;)this.Iua[Ob]=null,++Ob}}dkg(){const ec=wb.h(this.$).Ca,mb=this.gridView.ha.Oe;if(ec&&ec.Cmd&&1===mb&&this.gridView.ha.ra.activeCell){const Ob=Object(vc.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(nc.c)(Pb.a.resolve(oc.L,{Wb:1})):Ma.GetServiceTaskFactory.Pa(this.$.da,12,477,1);Na.TaskExtensions.za(Ob,()=>{this.q$=new t.a(this.$,this.svgIconProvider,Ob.result,this,this.htmlSanitizationHelper)},this.$.ka,
3);return!0}return!1}gDi(){this.Rn&&this.Rn.Vwd(!0)}launchLinkedEntityDataTypeSelectorPane(ec){if(this.Rn)if(ec=this.y$c(ec))if(ec.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var mb=Wb.r(this.gridView.ha.ra.selectedRanges,this.$);this.Rn.launchLinkedEntityDataTypeSelectorPane(mb,ec.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}Kbh(ec){const mb=this.xii(ec),
Ob=h.a.Og(this.EDb(ec));ec=h.a.Og(this.G_d(ec));return Ic.KPh(mb,kb.a.Le(11),Ob,ec)}G_d(ec){try{return this.sPe(parseInt(ec,10)).Description}catch(mb){}return ja.a.instance.ga(1797)}EDb(ec){try{return this.sPe(parseInt(ec,10)).Name}catch(mb){}return ja.a.instance.ga(1783)}V1f(ec){try{return this.zU(ec).Name}catch(mb){}return this.EDb(ec.Id.toString())}qZg(ec){try{return this.zU(ec).BlankCellResourceId}catch(mb){}return null}afi(ec){try{return this.zU(ec).HasBlankCellWalkthrough}catch(mb){}return!1}Rcf(ec){try{const mb=
Ic.V2a(ec);if(this.yU.kb(mb))return this.yU.ma(mb).HasCuratedData}catch(mb){}return!1}SUj(ec){try{return this.zU(ec).SupportsStarterData}catch(mb){}return!1}onf(ec){return 268435968===ec}Dgd(){return 2===u.a(this.$).dO?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}O6b(){return new Nb.a(-847286761,eb.a.zb,this.$.xc,0,m.a.a0)}ZJe(){if(this.sBb()&&!this.xrd()&&!this.Lkf&&vb.EwaSettings.xa(387)&&this.Rcf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
Wa.a.rg.dR){const Ob=this.Dgd();if(Ob){var ec=this.O6b();if(ec){var mb={["InputMethod"]:eb.a.zb,CalloutName:6};mb.Target=Ob;mb.ShouldCanvasTakeFocus=!0;this.$.Ia.Hb(ec,mb);this.Lkf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Yhi(ec){ec=
this.y$c(ec);return ec?this.m$a.cYg(ec.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}xic(ec){return this.q$?this.q$.bYg(ec):!1}WSh(){return this.q$?this.q$.UTh():""}hqi(){return this.q$?this.q$.jEb:!1}RXh(ec,mb){const Ob=this.igf(ec);if(0>Ob)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${ec}`);else if(ec=(ec=this.tPe(ec))?this.zU(ec):
null)mb[l.a.GalleryButtonProps]=this.m$a.HQh(Ob,ec),mb[l.a.Alt]=this.m$a.mhd(ec)}P0f(){this.jmg();this.sBb()&&this.$1d(!0);this.V4b()}xii(ec){return ec===this.yZe?x.a.CWe:ec===this.Q1e?x.a.AWe:x.a.zWe}xXe(ec){try{return this.zU(ec).ExampleEntities}catch(mb){}return ja.a.instance.ga(1805)}TLd(){(0>this.YLa||this.Vab)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.rs||0>this.YLa||this.Vab)&&window.clearInterval(this.Lfc);this.xrd()?
this.vfd&&this.$.frame.jx(this.vfd):this.$1d(this.sBb())}Fb(ec){return this.$.Cb+ec}T5j(){var ec=!0;const mb=Array(this.oFb),Ob=u.a(this.$)?u.a(this.$).yp:null;if(Ob){for(let Ta=0;Ta<mb.length;++Ta)this.FKj(Ta)?mb[Ta]=!0:ec=mb[Ta]=!1;Ob.J8f(["ConvertToLinkedEntityGallery"],ec);if(!ec)for(ec=0;ec<mb.length;++ec)mb[ec]&&Ob.J8f([this.QXh(ec)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}zU(ec){const mb=Ic.V2a(ec);if(this.yU.kb(mb))return this.yU.ma(mb);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${ec.Id} (Has String ID: ${!!ec.StringId})`);return null}QXh(ec){return"ConvertToLinkedEntityPreview"+ec.toString()}R1d(){k.a.get_instance().Rj(10,()=>{this.ZJe();this.p2c&&this.dmf&&lb.c(this.csf,this.$.ka,500)})}yfc(ec,mb){switch(ec){case "QueryLinkedEntityGalleryButtons":if(!mb[l.a.InnerHTML]){ec=mb[eb.a.Pc].toString();const Ob=hb.a.equals(ec,ja.a.instance.ga(1800),!0)||hb.a.equals(ec,ja.a.instance.ga(1801),!0),Ta=hb.a.equals(ec,ja.a.instance.ga(1802),
!0);Ob||Ta||this.RXh(ec,mb)}break;case "QueryLinkedEntityMenuGalleryButtons":mb[l.a.InnerHTML]||(mb[l.a.InnerHTML]=this.Kbh(mb[eb.a.Pc]))}return mb}Ish(ec){var mb=this.tPe(ec);if(mb)return mb;if(mb=this.y$c(ec))return mb.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${ec}`);return null}sPe(ec){const mb={};mb.Id=ec;return this.zU(mb)}y$c(ec){return this.yU.kb(ec)?this.yU.ma(ec):null}igf(ec){if(!ec.startsWith(Ic.Q$c))return-1;const mb=parseInt(ec.substr(Ic.Q$c.length),
10);return isNaN(mb)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${ec}`),-1):mb}tPe(ec){ec=this.igf(ec);return 0>ec?null:this.Iua[ec]}iif(ec,mb,Ob){this.yU&&this.yU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${ec})`),ec=this.$.pa.va.$b(),this.$.ea.Yb&&T(this.$.pa.va,ab.b(this.K_i,mb),Ob,null,null,ec))}n0j(){this.iif("Auto-refresh on load",null,null)}s0j(){this.yU&&this.yU.count&&(this.Uza?b.ULS.sendTraceTag(537166799,
0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Tm.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Uza=X.a.instance.create(this.h2c,this.G2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}SBc(){if(this.$.ea.Yb&&null!=this.n8a&&null!=this.vtd&&null!=this.wtd&&null!=this.Cvd&&null!=this.Eud)if(++this.nGb,12>=this.nGb){1===this.nGb&&(this.wmd=F.a.Ya.ze.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const ec=this.$.pa.va.$b();ma.u(this.$.pa.va,
this.jEi,this.kEi(),this.K0i,this.J0i,null,ec)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${F.a.Ya.ze.m-this.wmd} ms`),this.Vab=!0,this.TLd()}HDe(){if(this.$.isEditMode)if(null!=this.n8a)this.SBc();else{var ec=F.a.Ya.ze.m,mb=[];w.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ob=>{Ob.isFeatureEnabled("ExcelPowerBiPro",!1).then(Ta=>{b.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${F.a.Ya.ze.m-
ec} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${Ta}]`);return this.n8a=Ta}).then(()=>{mb.push(Ob.isFeatureEnabled("ExcelWolframAlpha",!1).then(Ta=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${F.a.Ya.ze.m-ec} Millisecond.`);b.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${Ta}]`);
return this.Cvd=Ta}))}).then(()=>{mb.push(Ob.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(Ta=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${F.a.Ya.ze.m-ec} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${Ta}]`);let sb;const zb=[(sb=new Pa.a,sb.name="IsRestrictedByLicense",sb.bool=Ta,sb)];
Ka.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,zb);this.Qof=Ta&&vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return Ta}))}).then(()=>{mb.push(Ob.isFeatureEnabled("StockHistory",!1).then(Ta=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${F.a.Ya.ze.m-ec} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${Ta}]`);
return this.Eud=Ta}))}).then(()=>{mb.push(Ob.isFeatureEnabled("ExcelPowerBiFree",!1).then(Ta=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${F.a.Ya.ze.m-ec} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${Ta}]`);return this.vtd=Ta}))}).then(()=>{mb.push(Ob.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(Ta=>{b.ULS.sendTraceTag(537166734,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${F.a.Ya.ze.m-ec} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${Ta}]`);return this.wtd=Ta}))}).then(()=>{Promise.all(mb).then(()=>{this.SBc()})})})}}get jEi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}kEi(){return[this.n8a,
this.Cvd,this.Eud,this.vtd,this.wtd,this.Qof]}eNd(){this.businessBar&&this.businessBar.qla(58)&&this.businessBar.removeEntry(58)}cdi(ec){this.uxd!==ec&&this.businessBar&&((this.uxd=ec)?Y(this.$.pa.va,this.OXi,null,null,null):this.eNd())}static KPh(ec,mb,Ob,Ta){ec=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',ec,mb,Ta);Ob=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Ob);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',ec,Ob)}static V2a(ec){return ec.StringId?ec.Id.toString()+"."+ec.StringId:ec.Id.toString()}}Ic.kQe="ConvertToLinkedEntityPreview";Ic.Q$c="PreviewGalleryButtonIndex.";Ic.I9a=0;Ic.Fsf=2;Object(c.a)(Ic,"ConvertToLinkedEntityManager",n.a,[676,677,3,678])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/eb06ca89bd6931731e7a385713ff02a2/EwaDSEsNext.le.js.map