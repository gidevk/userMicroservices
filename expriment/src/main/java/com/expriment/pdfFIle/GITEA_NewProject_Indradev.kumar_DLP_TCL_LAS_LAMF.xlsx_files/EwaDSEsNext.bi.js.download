'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[58],{1462:function(r,B,a){a.r(B);var c=a(517),b=a(0),e=a(15),f=a(91),d=a(87),h=a(424),l=a(84),k=a(51),w=a(269),n=a(243),x=a(13),m=a(769),u=a(76);class t{}t.Lxh="ewa-bix-ltr";t.Mxh="ewa-bix-rtl";t.Oxh="ewa-bix-titlebar";t.mTe="ewa-bix-subtitle";t.Nxh="ewa-bix-title";t.hTe="ewa-bix-close";t.kv="clip16x16";t.gTe="ewa-bix-body";t.lTe="ewa-bix-drilldetails";t.iTe="ewa-bix-DrillButton";t.Kxh="ewa-bix-hover";t.jTe="ewa-bix-DrillLabel1";
t.kTe="ewa-bix-DrillLabel2";t.nTe="ewa-bixfl";t.pTe="ewa-bixfl-NoFocus";t.Qxh="ewa-bixfl-ItemSelected";t.oTe="ewa-bixfl-Icon";t.Pxh="ewa-bixfl-Item";t.Jxh="ewa-bix-calloutBackground";t.O$b="ewa-ipad";Object(b.a)(t,"CssClassNames",null,[]);var y=a(18),v=a(5),A=a(63),z=a(31),C=a(242),H=a(12),I=a(77),S=a(14),P=a(21),D=a(1),G=a(296);class E extends C.a{constructor(Ca,Hb,cc,ca,ia,Sb){super(Hb);this.H$c=["bix-drill-action-down","bix-drill-action-up","bix-drill-action-to"];this.D7b=-1;this.qva=this.b3a=
this.a3a=this.c3a=null;this.jd=Oc=>{const td=this.domElement;let Jd=Oc.target;for(;Jd!==td;){if(Jd.id.startsWith("bix-drill-action")){this.drillTo(this.D7b,Jd.id);I.g(Oc);break}Jd=Jd.parentNode}};this.JKf=(Oc,td)=>{Oc=-1===this.D7b;const Jd=td.bhi;this.D7b=Jd;let qe=null;Jd===this.Zye.HierarchyId?(this.i7f(!1),this.drillUp||this.drillDown?(this.j7f(!0),H.DOMElementExtensions.setVisible(this.domElement,!0),qe=this.a3a||this.c3a):H.DOMElementExtensions.setVisible(this.domElement,!1)):(this.j7f(!1),
qe=this.b3a,E.$Cj(qe,td.caption,S.a.instance.ga(1195)),this.i7f(!0),H.DOMElementExtensions.setVisible(this.domElement,!0));Oc||this.u7f(qe)};this.$=Ca;this.cx=cc;this.Zye=ca.Context;Ca=ca.DrillContext;this.drillUp=Ca.DrillUp;this.drillDown=Ca.DrillDown;this.Dnd=ia;this.mJ=Sb;ia.kRg(this.JKf);D.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:7386688_ReduceInnerHTMLUsageDomExtensionsSetInnerHtmlSafe")?this.mgh():this.dH()}dispose(){this.Dnd&&
this.Dnd.xpj(this.JKf);this.H$c=this.c3a=this.a3a=this.b3a=this.qva=this.mJ=this.drillUp=this.drillDown=this.Zye=this.cx=this.mJ=this.Dnd=this.$=null;super.dispose()}focus(){this.setFocus(!0)}hasFocus(){var Ca=H.DOMElementExtensions.Np(this.domElement);if(!Ca)return!1;Ca=Ca.id;return!!Ca&&Ca.startsWith("bix-drill-action")}onKeyDown(Ca){const Hb=Ca.keyCode;Ca=Ca.shiftKey;if(this.hasFocus()){let cc=!1;13===Hb?(this.drillTo(this.D7b,this.qva.id),cc=!0):9===Hb&&((cc=this.y_(!Ca))||this.ZMe());return cc}return 9===
Hb?this.setInitialFocus(!Ca):!1}setFocus(Ca){return this.hasFocus()?this.y_(Ca):this.setInitialFocus(Ca)}dH(){H.DOMElementExtensions.Rt(this.domElement,v.a.qqb,null,null);var Ca='<button id="{0}" class="'+t.iTe+'" tabIndex="-1" title="{1}" style="display:none" onkeyup="return false;" onkeypress="return false;" role="menuitem" aria-describedby="{2} {4}"><div id="{2}"class="'+t.jTe+'">{3}</div><div id="{4}" class="'+t.kTe+'">{5}</div></button>';let Hb="",cc;let ca;if(this.drillDown){cc=S.a.instance.ga(1197);
var ia=this.drillDown.Caption;ca=String.format("{0} ({1})",cc,ia?z.a.OQ(ia):"");ia=ia?z.a.Og(ia):"";Hb+=String.format(Ca,"bix-drill-action-down",ca,"bixdddl_1",cc,"bixdddl_2",ia)}this.drillUp&&(cc=S.a.instance.ga(1196),ia=this.drillUp.Caption,ca=String.format("{0} ({1})",cc,ia?z.a.OQ(ia):""),ia=ia?z.a.Og(ia):"",Hb+=String.format(Ca,"bix-drill-action-up",ca,"bixddul_1",cc,"bixddul_2",ia));Hb+=String.format(Ca,"bix-drill-action-to","","bixddtl_1",S.a.instance.ga(1195),"bixddtl_2","");Ca=this.domElement;
H.DOMElementExtensions.Gr(Ca,Hb);this.c3a=this.getElementById("bix-drill-action-up");this.a3a=this.getElementById("bix-drill-action-down");this.b3a=this.getElementById("bix-drill-action-to");this.Gc.la("click",this.jd);Ca.setAttribute(v.a.vY,"");H.DOMElementExtensions.setVisible(Ca,!1)}mgh(){H.DOMElementExtensions.Rt(this.domElement,v.a.qqb,null,null);let Ca;let Hb;if(this.drillDown){Ca=S.a.instance.ga(1197);var cc=this.drillDown.Caption;Hb=String.format("{0} ({1})",Ca,cc?z.a.OQ(cc):"");cc=cc?z.a.Og(cc):
"";this.domElement.appendChild(this.N6c("bix-drill-action-down",Hb,"bixdddl_1",Ca,"bixdddl_2",cc))}this.drillUp&&(Ca=S.a.instance.ga(1196),cc=this.drillUp.Caption,Hb=String.format("{0} ({1})",Ca,cc?z.a.OQ(cc):""),cc=cc?z.a.Og(cc):"",this.domElement.appendChild(this.N6c("bix-drill-action-up",Hb,"bixddul_1",Ca,"bixddul_2",cc)));this.domElement.appendChild(this.N6c("bix-drill-action-to","","bixddtl_1",S.a.instance.ga(1195),"bixddtl_2",""));this.c3a=this.getElementById("bix-drill-action-up");this.a3a=
this.getElementById("bix-drill-action-down");this.b3a=this.getElementById("bix-drill-action-to");this.Gc.la("click",this.jd);this.domElement.setAttribute(v.a.vY,"");H.DOMElementExtensions.setVisible(this.domElement,!1)}N6c(Ca,Hb,cc,ca,ia,Sb){const Oc=document.createElement("button");Oc.id=Ca;Oc.classList.add(t.iTe);Oc.tabIndex=-1;Oc.title=Hb;Oc.style.display=G.a.none;Oc.onkeyup=()=>!1;Oc.onkeypress=()=>!1;Oc.setAttribute(v.a.Jd,v.a.G_c);Oc.setAttribute(v.a.WG,cc+" "+ia);Ca=document.createElement("div");
Ca.id=cc;Ca.classList.add(t.jTe);Ca.textContent=ca;cc=document.createElement("div");cc.id=ia;cc.classList.add(t.kTe);cc.textContent=Sb;Oc.appendChild(Ca);Oc.appendChild(cc);return Oc}drillTo(Ca,Hb){let cc;switch(Hb){case "bix-drill-action-up":cc=this.drillUp.Id;break;case "bix-drill-action-down":cc=this.drillDown.Id;break;case "bix-drill-action-to":cc=1;break;default:return}P.h(this.$).No(!0);this.mJ.W$g((ca,ia,Sb)=>{var Oc=this.cx,td=this.$.pa.va,Jd=Oc.confirmationRequiredForDataOps,qe=cc;Oc=A.L(td,
Oc.ax,Oc.externalSourceIndex,this.cx.FR);Oc.requiresConfirmation=Jd;Oc.hierarchyId=Ca;Oc.levelId=qe;return A.g(td,"BixDrill",Oc,ca,ia,Sb,null,0)})}y_(Ca){let Hb=0;if(this.qva)switch(this.qva.id){case "bix-drill-action-down":Hb=0;break;case "bix-drill-action-up":Hb=1;break;case "bix-drill-action-to":Hb=2}return this.k8f(Ca?Hb+1:Hb-1,Ca)}ZMe(){const Ca=this.qva;Ca&&(Ca.blur(),this.domElement.setAttribute(v.a.vY,""));this.qva=null}i7f(Ca){this.b3a&&H.DOMElementExtensions.setVisible(this.b3a,Ca)}j7f(Ca){this.c3a&&
H.DOMElementExtensions.setVisible(this.c3a,Ca);this.a3a&&H.DOMElementExtensions.setVisible(this.a3a,Ca)}u7f(Ca){Ca!==this.qva&&this.ZMe();if(!Ca)return!1;Ca.tabIndex=0;H.DOMElementExtensions.setFocus(Ca);this.domElement.setAttribute(v.a.vY,Ca.id);this.qva=Ca;return!0}setInitialFocus(Ca){return this.k8f(Ca?0:this.H$c.length-1,Ca)}k8f(Ca,Hb){const cc=this.H$c;for(;0<=Ca&&Ca<cc.length;){const ca=H.DOMElementExtensions.getElementById(this.domElement,cc[Ca]);if(ca&&H.DOMElementExtensions.isVisible(ca))return this.u7f(ca);
Ca=Hb?Ca+1:Ca-1}return!1}static $Cj(Ca,Hb,cc){cc=String.format("{0} ({1})",cc,Hb);Ca.setAttribute("title",cc);Ca.lastChild.innerText=Hb}}Object(b.a)(E,"BixDrillDetails",C.a,[]);var O=a(229),N=a(27),J=a(36),W=a(216),ea=a(52),R=a(137);const Y=t.Pxh,U=t.Qxh,da=`<div id="{0}" class="${t.oTe}" style="{1}"><div class="${y.a.kv}"><img id="{2}" class="{3}" role="{4}" src="{5}"/></div></div>`;class T{constructor(Ca,Hb,cc,ca,ia){this._element=null;this.bJ=this.visible=!0;this.fieldListSelector=Ca;this.Bib=
Hb.Name||"";this.clientId=Hb.ClientId;this.X8=Hb.IsCollapsible;this.parentId=Hb.ClientParentId;this.UEg=Hb.PivotCacheIndex;this.type=Hb.TypeTag;this.uog=Hb.UserRank;this.Mhi=cc;this.g8c=ca;this.Llh=ia;this.fieldListSelector.iOg(this.clientId,this);this.children=[];Hb.Children.forEach(Sb=>{this.children.push(new T(Ca,Sb,cc,ca,ia))})}get caption(){return this.Bib}get element(){return this._element||(this._element=this.fieldListSelector.getElementById(T.BQa+this.clientId))}get zfi(){return-1!==this.parentId}get isCollapsed(){return this.bJ}get isCollapsible(){return this.X8}get isVisible(){return this.visible}get iPf(){return this.UEg}dispose(){this.children&&
(f.a.sc(this.children),this.children=null);this._element=null}WFe(){for(const Ca of this.children)Ca.visible=!1,Ca.X8&&(Ca.bJ=!0,Ca.o9f(),0<Ca.children.length&&Ca.WFe())}Mve(Ca,Hb){this.visible=!Ca;var cc=11*Ca;let ca=`aria-labelledby="${this.KM(T.xtc)}" aria-selected="false" aria-level="${Ca+1}"`;this.X8&&(ca+=`aria-expanded="false" aria-owns="${this.KM(T.wtc)}"`);this.X8?(this.bJ=!0,cc=String.format(da,this.KM(T.EId),this.Jdc(cc+4),this.KM(T.vtc),this.g8c,v.a.yq,ea.a.Le(9))):cc=String.format('<div style="{0}"></div>',
this.Jdc(cc+23));const ia=String.format('<span id="{0}">{1}</span>',this.KM(T.xtc),z.a.Og(this.Bib));Hb+=String.format('<div id="{0}" class="{1}" tabIndex="-1" title="{2}" role="treeitem" {3}><table cellspacing="0" cellPadding="0" role="presentation"><tr><td style="width: 8px">{4}</td><td>{5}</td></tr></table></div>',this.KM(T.BQa),Y,z.a.OQ(this.Bib),ca,cc,ia);this.X8&&(++Ca,Hb+=String.format('<div id="{0}" role="group" style="display:none;">',this.KM(T.wtc)),this.children.forEach(Sb=>{Hb=Sb.Mve(Ca,
Hb)}),Hb+="</div>");return Hb}Nve(Ca,Hb){this.visible=!Ca;var cc=11*Ca,ca=document.createElement("div");if(this.X8){this.bJ=!0;ca.id=this.KM(T.EId);ca.classList.add(t.oTe);ca.setAttribute(R.a.style,this.Jdc(cc+4));cc=document.createElement("div");cc.classList.add(y.a.kv);var ia=document.createElement("img");ia.id=this.KM(T.vtc);ia.classList.add(this.g8c);ia.setAttribute(v.a.Jd,v.a.yq);ia.src=ea.a.Le(9);cc.appendChild(ia);ca.appendChild(cc)}else ca.setAttribute(R.a.style,this.Jdc(cc+23));cc=document.createElement("span");
cc.id=this.KM(T.xtc);cc.textContent=this.Bib;ia=document.createElement("div");ia.id=this.KM(T.BQa);ia.classList.add(Y);ia.tabIndex=-1;ia.title=this.Bib;ia.setAttribute(v.a.Jd,v.a.l2b);ia.setAttribute(v.a.dM,this.KM(T.xtc));ia.setAttribute(v.a.k$,"false");ia.setAttribute(v.a.gxe,Ca+1);this.X8&&(ia.setAttribute(v.a.PT,"false"),ia.setAttribute(v.a.k2b,this.KM(T.wtc)));const Sb=document.createElement("table");Sb.setAttribute(R.a.cellSpacing,0);Sb.setAttribute(R.a.cellPadding,0);Sb.setAttribute(v.a.Jd,
v.a.yq);const Oc=document.createElement("tr"),td=document.createElement("td");td.setAttribute(R.a.style,"width: 8px");td.appendChild(ca);ca=document.createElement("td");ca.appendChild(cc);Oc.appendChild(td);Oc.appendChild(ca);Sb.appendChild(Oc);ia.appendChild(Sb);Hb.appendChild(ia);if(this.X8){++Ca;const Jd=document.createElement("div");Jd.id=this.KM(T.wtc);Jd.setAttribute(v.a.Jd,v.a.tHa);Jd.style.display=v.a.apc;this.children.forEach(qe=>{qe.Nve(Ca,Jd)});Hb.appendChild(Jd)}}w8b(){this.element.blur();
this.element.tabIndex=-1}YHh(){this.children.forEach(Ca=>{Ca.visible=!0})}h4e(Ca,Hb){const cc=this.children;for(const ca of cc)if(!ca.X8&&5===ca.type&&ca.uog>Hb&&(Ca=ca,Hb=ca.uog,3===Hb))return{returnValue:Ca,sAd:Hb};for(const ca of cc)if(ca.X8&&({sAd:Hb,returnValue:Ca}=ca.h4e(Ca,Hb),3===Hb))break;return{returnValue:Ca,sAd:Hb}}l6h(){let Ca=this;for(;-1!==Ca.parentId;)Ca=this.fieldListSelector.Rid(Ca.parentId);return Ca}Lic(Ca){let Hb=this;for(;-1!==Hb.parentId;){if(Ca.clientId===Hb.parentId)return!0;
Hb=this.fieldListSelector.Rid(Hb.parentId)}return!1}setFocus(){this.element.tabIndex=0;H.DOMElementExtensions.setFocus(this.element)}o9f(){const Ca=H.DOMElementExtensions.getElementById(this.element,this.KM(T.vtc));if(Ca){var Hb=this.element.nextSibling;H.DOMElementExtensions.rCa(Ca,this.bJ,this.g8c,this.Llh);this.element.setAttribute(v.a.PT,this.bJ?v.a.xq:v.a.$j);H.DOMElementExtensions.setVisible(Hb,!this.bJ)}}qHj(){const Ca=this.fieldListSelector.domElement.querySelectorAll(`.${U}`);for(let Hb=
0;Hb<Ca.length;Hb++){const cc=Ca[Hb];cc.classList.remove(U);cc.setAttribute(v.a.k$,"false")}this.element.classList.add(U);this._element.setAttribute(v.a.k$,"true")}iQb(){(this.bJ=!this.bJ)?this.WFe():this.YHh();this.o9f()}KM(Ca){return Ca+this.clientId}Jdc(Ca){return String.format(this.Mhi,Ca.toString())}}T.EId="bixflec_";T.vtc="bixfleci_";T.BQa="bixfli_";T.xtc="bixflil_";T.wtc="bixflg_";Object(b.a)(T,"BixFieldListItem",null,[3]);class ka extends Sys.EventArgs{constructor(Ca,Hb){super();this.bhi=
Ca;this.caption=Hb}}Object(b.a)(ka,"BixHierarchySelectionChangedEventArgs",Sys.EventArgs,[]);var L=a(11);class fa extends C.a{constructor(Ca,Hb,cc,ca,ia){super(Hb);this.H4c=0;this.Oya=new J.a(!1);this.pyc=-1;this.UD=this.GM=this.$4f=null;this.jd=Oc=>{Oc.Ob&&this.Wtc(Oc.Ob);return!0};this.nB=Oc=>{Oc.button===Sys.UI.MouseButton.leftButton&&Oc.target&&(this.Wtc(Oc.target),I.g(Oc))};this.onDoubleClick=Oc=>{if(Oc.button===Sys.UI.MouseButton.leftButton&&Oc.target){var td;0!==({v_b:td}=this.VZe(Oc.target)).returnValue&&
(I.g(Oc),(Oc=this.d6e(td))&&Oc.isCollapsible&&this.iQb(Oc))}};(this.touchMode=ia)?O.a.instance.ta(x.a.click,this.domElement,this.jd):(this.Gc.la("mousedown",this.nB),this.Gc.la("dblclick",this.onDoubleClick));this.Rcg=!N.a.eyi&&!ia;let Sb;Ca.isChromeRtl?(Sb="padding-right:{0}px;",this.H4c=39):(Sb="padding-left:{0}px;",this.H4c=37);ia=new W.a(ca.ExcludeHierarchies);ia.l$.sort((Oc,td)=>Oc-td);Ca=-1;Hb=null;if(cc=({$Db:Ca,oe:Hb}=this.Agf(cc.FieldListItems,ia,Ca,Hb,ca.Context)).returnValue)1===cc.length&&
(cc=[...cc[0].Children],cc.forEach(Oc=>{Oc.ClientParentId=-1})),cc.length&&(this.fieldListItems=[],cc.forEach(Oc=>{this.fieldListItems.push(new T(this,Oc,Sb,y.a.oDh,y.a.pDh))}),Hb||(Hb=fa.RKh(cc,ca.Context.DimensionCaption)||cc[0]),this.oe=this.Rid(Hb.ClientId),this.dH())}kRg(Ca){this.get_events().addHandler("SelectionChanged",Ca)}xpj(Ca){this.get_events().removeHandler("SelectionChanged",Ca)}get uyi(){return!!this.fieldListItems}dispose(){this.touchMode&&(O.a.instance.Aa(x.a.click,this.domElement,
this.jd),this.touchMode=!1);this.UD=null;this.fieldListItems&&(f.a.sc(this.fieldListItems),this.fieldListItems=null);this.Oya=null;super.dispose()}focus(){this.setFocus(!0)}iOg(Ca,Hb){this.Oya.add(Ca.toString(),Hb)}Rid(Ca){Ca=Ca.toString();return this.Oya.kb(Ca)?this.Oya.getItem(Ca):null}hasFocus(){var Ca=H.DOMElementExtensions.Np(this.UD);return Ca?(Ca=Ca.id)&&Ca.startsWith(T.BQa)&&this.GM?!0:!1:!1}onKeyDown(Ca){Ca=Ca.keyCode;if(this.hasFocus()){var Hb=!1;38===Ca||40===Ca?(this.y_(40===Ca),Hb=!0):
37===Ca||39===Ca?(Ca=Ca===this.H4c,Hb=this.GM,Hb.isCollapsible&&Hb.isCollapsed!==Ca?this.iQb(Hb):Ca&&Hb.zfi&&this.y_(!1),Hb=!0):13===Ca||32===Ca?((Ca=this.GM)&&this.select(Ca),Hb=!0):9===Ca&&this.$Me(!0);return Hb}return 9===Ca?this.GM?this.wNb(this.GM):this.setInitialFocus(!0):!1}VBj(){this.UD.setAttribute(v.a.dxe,"bix-drilldetails")}setFocus(Ca){return this.UD.firstChild?this.hasFocus()?this.y_(Ca):this.GM?this.wNb(this.GM):this.setInitialFocus(Ca):!1}start(){this.oe&&(this.select(this.oe.l6h()),
this.GM&&this.scroll(this.GM,!0))}dH(){if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:7386688_ReduceInnerHTMLUsageDomExtensionsSetInnerHtmlSafe"))this.UD=this.domElement,this.fieldListItems.forEach(Ca=>{Ca.Nve(0,this.UD)});else{let Ca="";this.fieldListItems.forEach(Hb=>{Ca=Hb.Mve(0,Ca)});this.UD=this.domElement;H.DOMElementExtensions.Gr(this.UD,Ca.toString())}H.DOMElementExtensions.Rt(this.UD,v.a.m2b,null,null,null);this.UD.setAttribute(v.a.fv,
S.a.instance.ga(1198));this.UD.classList.add(y.a.vo);this.UD.style.position="relative"}s0h(Ca){for(;Ca&&Ca!==this.UD;){const Hb=Ca.id;if(Hb&&Hb.startsWith(T.BQa))return Ca;Ca=Ca.parentNode}return null}Agf(Ca,Hb,cc,ca,ia){const Sb=cc;if(!Ca||!Ca.length)return{returnValue:null,$Db:cc,oe:ca};let Oc=0;for(let td=0,Jd=Ca.length;td<Jd;td++){const qe=Ca[td];if(fa.Mui(Hb,qe))Ca[td]=null,++Oc;else{qe.ClientParentId=Sb;qe.ClientId=++cc;if(qe.IsCollapsible&&(qe.Children=({$Db:cc,oe:ca}=this.Agf(qe.Children,
Hb,cc,ca,ia)).returnValue,!qe.Children)){Ca[td]=null;++Oc;continue}5!==qe.TypeTag&&3!==qe.TypeTag||qe.PivotCacheIndex!==ia.HierarchyId||(qe.UserRank=3,ca=qe)}}return Oc?Oc===Ca.length?{returnValue:null,$Db:cc,oe:ca}:{returnValue:fa.anj(Ca),$Db:cc,oe:ca}:{returnValue:Ca,$Db:cc,oe:ca}}$Me(Ca){const Hb=this.GM;Hb&&(Hb.w8b(),this.UD.setAttribute(v.a.vY,""));this.w8b();Ca||(this.GM=null)}w8b(){this.Rcg&&this.UD.classList.add(t.pTe)}y_(Ca){let Hb=this.GM;if(!Hb)return this.setInitialFocus(Ca);const cc=
this.Oya.values,ca=cc.length;let ia=Array.indexOf(cc,Hb);for(ia=Ca?++ia:--ia;0<=ia&&ia<ca;){Hb=cc[ia];if(Hb.isVisible)return this.wNb(Hb),this.scroll(Hb,Ca),!0;ia=Ca?++ia:--ia}return!1}scroll(Ca,Hb){var cc=Ca.element;Ca=cc.offsetHeight;cc=cc.offsetTop;const ca=this.UD,ia=ca.scrollTop,Sb=(Math.floor(ca.clientHeight/Ca)-3)*Ca;let Oc=ca.scrollTop;Hb?cc>ia+Ca+Sb&&(Oc=cc-(Ca+Sb)):cc<ia+Ca&&(Oc=cc-Ca);ca.scrollTop=Oc}setInitialFocus(Ca){const Hb=this.Oya.count;let cc=Ca?0:Hb-1;for(;0<=cc&&cc<Hb;){const ca=
this.Oya.$f(cc);if(ca.isVisible)return this.wNb(ca),this.scroll(ca,!0),!0;cc=Ca?++cc:--cc}return!1}wNb(Ca){this.GM&&Ca!==this.GM&&this.$Me(!1);if(!Ca)return!1;this.UD.setAttribute(v.a.vY,Ca.element.id);this.GM=Ca;-1!==this.pyc&&(Ca.setFocus(),this.Rcg&&this.UD.classList.remove(t.pTe));return!0}VZe(Ca){for(;Ca&&Ca!==this.UD;){const Hb=Ca.id;if(Hb.startsWith(T.BQa))return{returnValue:1,v_b:Ca};if(Hb.startsWith(T.EId)||Hb.startsWith(T.vtc))return{returnValue:2,v_b:Ca};Ca=Ca.parentNode}return{returnValue:0,
v_b:null}}d6e(Ca){if(!Ca.id||!Ca.id.startsWith(T.BQa)&&(Ca=this.s0h(Ca),!Ca))return null;Ca=Ca.id.split("_")[1];return J.a.Ic(this.Oya.Du,Ca)}Wtc(Ca){var Hb;Ca=({v_b:Hb}=this.VZe(Ca)).returnValue;if(0!==Ca&&(Hb=this.d6e(Hb)))switch(Ca){case 2:this.iQb(Hb);break;case 1:this.select(Hb)}}select(Ca){if(Ca){Ca.qHj();this.wNb(Ca);if(Ca.isCollapsible){let Hb=-1;({sAd:Hb,returnValue:Ca}=Ca.h4e(null,Hb));if(!Ca)return}this.oe=Ca;this.pyc!==Ca.iPf&&(this.pyc=Ca.iPf,this.$4f=Ca.caption,this.raiseEvent("SelectionChanged",
new ka(this.pyc,this.$4f)),this.hasFocus()||this.w8b())}}iQb(Ca){Ca.iQb();Ca.isCollapsed&&this.oe&&this.oe.Lic(Ca)&&this.select(Ca);this.scroll(Ca,!Ca.isCollapsed)}static RKh(Ca,Hb){for(const cc of Ca)if(11===cc.TypeTag&&cc.Name===Hb)return cc;return null}static Mui(Ca,Hb){switch(Hb.TypeTag){case 5:case 3:break;default:return!1}return 0<=L.HelperMethods.Bx(Ca,0,Ca.Zva(),Hb.PivotCacheIndex,(cc,ca)=>cc-ca)}static anj(Ca){let Hb=null;for(let cc=0;cc<Ca.length;cc++)Ca[cc]&&(Hb||(Hb=[]),Hb.push(Ca[cc]));
return Hb}}Object(b.a)(fa,"BixFieldListSelector",C.a,[607]);var wa=a(50),oa=a(38),xa=a(218),bb=a(49),Za=a(45),La=a(255),va=a(290),Ba=a(75),Ea=a(93),pa=a(108),$a=a(153),cb=a(54),ib=a(70);class ta extends m.a{constructor(Ca,Hb,cc,ca){super(Ca,S.a.instance.ga(1192),!0,4);this.fieldListSelector=this.RT=this.AOa=this.qC=this.kKc=this.Faa=null;this.tce=!1;this.TXi=(ia,Sb)=>{if(this.domElement&&(this.AOa.PTa(),!La.a(ia))){const Oc=ia.Result;Oc&&this.aTj(Oc,Sb);super.J_(ia,null,"")}};this.AOj=()=>{D.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
D.EwaSettings.isChangeGateEnabled("OfficeVSO:7386688_ReduceInnerHTMLUsageDomExtensionsSetInnerHtmlSafe")?this.a0a.textContent=S.a.instance.ga(1194):H.DOMElementExtensions.Gr(this.a0a,S.a.instance.ga(1194));const ia=this.Lea.querySelector("."+t.hTe);ia.tabIndex=-1;H.DOMElementExtensions.setFocus(ia)};this.X$a=()=>{this.close(1);return!0};this.domElement.id=Ca.domElement.id+"_BIExploreCallout";this.cx=Hb;this.targetElement=cc;this.t1f=!1;this.domElement.classList.remove(this.rtl?u.a.Fbd:u.a.Ebd);this.domElement.classList.remove(y.a.uo);
this.domElement.classList.add(this.rtl?t.Mxh:t.Lxh);(this.touchMode=ca)||this.domElement.classList.add(t.Kxh);this.Lea.className=t.Oxh;this.Lea.style.backgroundImage="";this.epa.className=t.Nxh;this.Yy.parentNode.className=t.hTe;Ca=this.Pb;Ca.className="";if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:7386688_ReduceInnerHTMLUsageDomExtensionsSetInnerHtmlSafe")){Hb=document.createElement("div");Hb.id="bix-subtitle";Hb.classList.add(t.mTe);
Hb.textContent=Ea.a.qf(this.cx.lff);cc=document.createElement("div");cc.classList.add(t.gTe);ca=document.createElement("div");ca.id="bix-fieldlistselector";ca.classList.add(t.nTe);const ia=document.createElement("div");ia.id="bix-drilldetails";ia.classList.add(t.lTe);cc.appendChild(ca);cc.appendChild(ia);Ca.appendChild(Hb);Ca.appendChild(cc)}else Hb=String.format('<div id="{0}"class="{1}">{2}</div><div class="{3}"><div id="{4}" class="{5}"></div><div id="{6}" class="{7}"></div></div>',"bix-subtitle",
t.mTe,this.cx.lff,t.gTe,"bix-fieldlistselector",t.nTe,"bix-drilldetails",t.lTe),H.DOMElementExtensions.Gr(Ca,Hb);this.a0a=Ca.lastChild;this.igc()}get pc(){return"BIExploreCallout"}get pqi(){return this.tce}get yIa(){return 6}get MB(){return 561}zvi(Ca){Ca=document.getElementById(Ca);return H.DOMElementExtensions.isVisible(Ca)?(this.Faa.setFocus(!0),!0):!1}W$g(Ca){this.kKc=Ca;P.h(this.$).No(!0);this.tce=!0;this.close(2)}dispose(){f.a.sc([this.qC,this.AOa,this.Faa,this.fieldListSelector]);this.cx=this.Faa=
this.fieldListSelector=this.AOa=this.qC=null;this.ovc();this.kKc=this.targetElement=this.a0a=null;super.dispose()}takeFocus(){this.setFocus()}close(Ca){this.ovc();super.close(Ca)}fg(Ca=!1){const Hb=Object(ib.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(pa.c)($a.a.resolve(cb.L,{Wb:0})):wa.GetServiceTaskFactory.Pa(this.$.da,12,477,0);oa.TaskExtensions.za(Hb,cc=>{this.t1f||(this.AOa=cc.result.Mtb(this.Pb,500,null,null,736),this.AOa.JTa())},this.$.ka);return oa.TaskExtensions.ts(oa.TaskExtensions.za(wa.GetServiceTaskFactory.create(this.$.da,
84,this.ka,0),cc=>{this.qC=cc.result;this.qC.init(this.domElement,this.targetElement,document.body,this.$.na.displayRtl);this.qC.L5c=8;this.qC.WZc=!0;this.qC.Cbb=ta.vai();this.HXc();this.qC.fq()},this.ka,3),()=>xa.a.prototype.fg.call(this,Ca),this.ka,3,Ba.a.current)}ZG(){return this.kKc}s0a(){return(Ca,Hb,cc)=>{var ca=this.$.pa.va;Ca=this.X4a(Ca);Hb=this.bLa(Hb);const ia=A.L(ca,this.cx.ax,this.cx.externalSourceIndex,this.cx.FR);return A.g(ca,"GetBixAnalysis",ia,Ca,Hb,cc,null,4)}}onShow(){this.qC.DQd();
super.onShow()}J_(Ca){const Hb=Ca.Result;if(Ca.Errors&&!Ca.Errors.length&&Hb&&-1===Hb.Context.HierarchyId)this.t1f=!0,this.AOa&&this.AOa.PTa(),bb.a.instance.create(this.AOj,1,Za.a.gZg,!0,!0),super.J_(Ca,null,"");else{var cc=ca=>{ca.Vz=0;this.HMa(169,(ia,Sb,Oc)=>{var td=this.$.pa.va,Jd=ca.lH,qe=ca.oKb,Ie=ca.Vz;ia=va.b(ia,this.TXi);const Ze=A.L(td,ca.ax,ca.externalSourceIndex,ca.zih());Ze.type=4;Ze.version=Jd;Ze.relatedGroup=qe;Ze.selectedTab=Ie;return A.g(td,"GetPivotFieldListData",Ze,ia,Sb,Oc,Hb,
4)},16)};oa.TaskExtensions.za(wa.GetServiceTaskFactory.create(this.$.da,110,this.ka,0),ca=>{cc(ca.result)},this.ka,3)}}onKeyDown(Ca){let Hb=this.r2e();if(Ca.altKey&&85===Ca.keyCode)this.close(1),I.g(Ca);else if(117===Ca.keyCode&&Ca.ctrlKey)this.close(1),I.g(Ca);else if(0===Hb)if(13===Ca.keyCode)this.close(1);else super.onKeyDown(Ca);else{let cc=!1;for(let ca=0;3>ca&&!cc;ca++)2===Hb?(cc=this.fieldListSelector.onKeyDown(Ca))||(Hb=1):1===Hb&&((cc=this.Faa.onKeyDown(Ca))||(Hb=2));if(cc)I.g(Ca);else super.onKeyDown(Ca)}}setFocus(){(this.Faa||
this.fieldListSelector)&&this.SWg(this.r2e())}SWg(Ca){let Hb=!1;for(let cc=0;2>cc&&!Hb;cc++)1===Ca&&this.Faa?(Hb=this.Faa.setFocus(!0))||(Ca=2):2===Ca&&this.fieldListSelector&&((Hb=this.fieldListSelector.setFocus(!0))||(Ca=1))}r2e(){if(!this.fieldListSelector||!this.Faa)return 0;const Ca=this.fieldListSelector.hasFocus(),Hb=this.Faa.hasFocus();return!Ca&&!Hb||Hb?1:2}aTj(Ca,Hb){let cc=this.getElementById("bix-fieldlistselector");this.fieldListSelector=new fa(this.$,cc,Ca,Hb,this.touchMode);this.fieldListSelector.uyi?
(this.a0a.setAttribute(v.a.e2b,"true"),cc=this.getElementById("bix-drilldetails"),this.Faa=new E(this.$,cc,this.cx,Hb,this.fieldListSelector,this),this.fieldListSelector.VBj(),this.fieldListSelector.start(),this.setFocus(),this.a0a.setAttribute(v.a.e2b,"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=null,D.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:7386688_ReduceInnerHTMLUsageDomExtensionsSetInnerHtmlSafe")?
this.a0a.textContent=S.a.instance.ga(1194):H.DOMElementExtensions.Gr(this.Pb,S.a.instance.ga(1194)))}HXc(){const Ca=this.RT=document.createElement("div");Ca.classList.add(t.Jxh);n.a.instance.ta(x.a.pointerDown,Ca,this.X$a);this.domElement.ownerDocument.body.appendChild(Ca)}ovc(){this.RT&&(n.a.instance.Aa(x.a.pointerDown,this.RT,this.X$a),H.DOMElementExtensions.yf(this.RT),this.RT=null)}static vai(){return ta.Cbb||(ta.Cbb=[0,1,4,5])}}ta.Cbb=null;Object(b.a)(ta,"BIExploreCallout",m.a,[591,215]);class Ya extends l.a{constructor(Ca,
Hb,cc){super();this.$=Ca;this.zha=cc.e7b(Ca,null,Hb,y.a.W$b,ea.a.Le(9),S.a.instance.ga(1193),"BIXPointerDown")}get kz(){return this.zha.kz}get z4b(){return this.zha.z4b}dispose(){this.zha.dispose();this.$=null;super.dispose()}getButton(Ca){return this.zha.getButton(Ca)}COj(Ca,Hb,cc,ca){this.zha.eo(Ca+this.z4b,Hb+this.z4b,cc,ca)}DOj(){var Ca=P.h(this.$).ha.ra.activeCell;const Hb=P.h(this.$).jb.Li(Ca);(Ca=P.h(this.$).Eg(Ca,Hb))&&0<=Ca.x&&0<=Ca.y?this.eo(Ca.bottomRight.x+this.kz,Ca.bottomRight.y+this.kz,
P.h(this.$).rtl,Hb):this.hide()}eo(Ca,Hb,cc,ca){this.zha.eo(Ca,Hb,cc,ca)}hide(){this.zha.hide()}domElement(Ca){return this.zha.domElement(Ca)}u3a(Ca){this.zha.u3a(Ca)}}Object(b.a)(Ya,"BIExploreLaunchButton",l.a,[]);var Da=a(44);class ba{constructor(Ca){this.Yib=!1;this.wEa=0;this.Yra=this.rSc=this.qSc=this.Fkb=null;this.$=Ca;this.reset()}get confirmationRequiredForDataOps(){return this.Yib}get externalSourceIndex(){return this.wEa}get lff(){return this.Fkb}get XZ(){return!!this.FR}get $jf(){return!!this.ax}get FR(){return this.qSc}get pivotTableName(){return this.rSc}get ax(){return this.Yra}reset(){this.Fkb=
"";this.Yra=this.rSc=this.qSc=null}yFj(Ca,Hb){this.reset();this.Yib=Hb.confirmationRequiredForDataOps;this.wEa=Hb.externalSourceIndex;this.rSc=Hb.pivotTableName;this.Yra=Da.o(Ca,this.$);Ca.vd(Hb.zB)||Ca.vd(Hb.ME)?(Hb=P.h(this.$).Jb(Ca),this.Fkb=z.a.Og(Hb.text)):(Ca=Ca.top-Hb.top,Hb.sQd&&Hb.sQd.length>Ca&&(this.Fkb=Hb.sQd[Ca]))}oCj(Ca,Hb,cc){this.reset();this.wEa=Hb.ExternalSourceIndex;this.Yib=!!(Hb.Attributes&64);this.Fkb=z.a.Og(cc.ValueString);this.qSc={};this.FR.ChartId=Ca;this.FR.AnchorValue2=
-1;switch(cc.Type){case 1:case 2:0<=cc.CategoryIndex?(this.FR.AnchorType=2,this.FR.AnchorValue1=cc.CategoryIndex):(this.FR.AnchorType=1,this.FR.AnchorValue1=cc.SeriesIndex);break;default:0>cc.CategoryIndex&&0<=cc.SeriesIndex?(this.FR.AnchorType=1,this.FR.AnchorValue1=cc.SeriesIndex):(this.FR.AnchorType=3,this.FR.AnchorValue1=cc.SeriesIndex,this.FR.AnchorValue2=cc.CategoryIndex)}this.Yra={};this.$.Sj(this.ax);this.ax.FirstRow=-1;this.ax.FirstColumn=-1}}Object(b.a)(ba,"BixSelectionContext",null,[]);
var ya=a(806),V=a(230),Z=a(71),ja=a(324),la=a(256),ua=a(729),eb=a(462),Eb=a(3),Wb=a(522),Ab=a(58);class Jb extends l.a{constructor(Ca,Hb){super();this.callout=this.gridView=null;this.jVi=cc=>{if(cc.isLoaded){this.state=1;cc=this.$;const ca=P.h(cc);this.GXg(ca);cc.ij(this.yc);cc.iC(this.Ak);ca.ev(this.yR);Wb.a(cc).ev(this.OGb);cc.userOperationManager.jr(this.sMf);ja.a.I9(1529658657,Eb.a.iw,0,1);cc.Ia.t2(this)}else this.dispose()};this.Eza=(cc,ca)=>{this.allow&&0===ca.G4&&(cc=this.gridView.ha.Oe,1===
cc?(this.s4c(),this.aX()):2!==cc||this.cx.XZ||(this.cx.reset(),this.ey()))};this.Di=()=>{this.ey()};this.yc=()=>{this.ey()};this.jd=(cc,ca)=>{this.callout||this.showCallout(3===cc.wb,ca)};this.PDd=()=>{this.callout.LAa(this.PDd);this.callout=null;this.Eh.hide()};this.Ak=()=>{this.callout?this.ey():this.d8a()&&this.Eh.hide()};this.OGb=()=>{3===this.state&&(this.state=1)};this.yR=()=>{3===this.state&&this.lRe()};this.sMf=(cc,ca)=>{(cc=ca.Gf?ca.Gf.operation:null)&&cc.flags&4&&(this.allow&&0===ca.Uq?
(this.state=3,this.ey()):3===this.state&&1===ca.Uq&&(ca=cc.zd?cc.zd.Errors:null)&&0<ca.length&&this.lRe())};this.lRe=()=>{this.state=1;this.aX()};this.$=Ca;this.state=2;this.cx=new ba(Ca);this.Eh=new Ya(Ca,this.jd,Hb);w.a(this.$).fi(this);c.a.Yff(Ca.domElement.ownerDocument,ea.a.current.Un(96),this.jVi)}get mc(){return this.callout?this.callout.domElement:null}get If(){return!!this.callout}get ee(){return la.a.P0c}get p6e(){e.ULS.shipAssertTag(537170304,8,!P.h(this.$).jb.oj,"GetLaunchMonocleButton is not supported in freeze pane");
return Object(d.a)(Sys.UI.Control,this.Eh.getButton(1))}get N6e(){return this.callout}get allow(){return this.$.ke.get(6)&&1===this.state&&this.$.ic.G2(135200)}TEe(){this.showCallout(!1)}dispose(){this.gridView&&(this.gridView.Eb.$Kb(this.Eza),this.gridView.Xb&&this.gridView.Xb.Zk(this.Di));if(this.$){const Ca=this.$;Ca.userOperationManager.ao(this.sMf);Ca.$k(this.yc);Ca.UF(this.Ak);P.h(Ca).ty(this.yR);Wb.a(Ca).ty(this.OGb)}f.a.Ja(this.Eh);this.cx=this.$=this.gridView=this.callout=this.Eh=null;super.dispose()}Mc(Ca,
Hb){if(1529658657===Hb&&(8===Ca||!this.cx.$jf))return!0;1247109494!==Hb&&-498523270!==Hb||this.ey();return!1}executeCommand(Ca,Hb){this.callout?this.ey():(this.scrollIntoView(),this.showCallout(3===Hb.method));return Ab.Task.Ta(!0)}Ac(Ca,Hb){return 1529658657===Hb.command}Rc(){return!1}ey(){this.s4c();this.Eh.hide()}eg(Ca,Hb){this.callout&&!Hb&&this.callout.takeFocus();return!Hb}Bh(Ca){return H.DOMElementExtensions.Df(this.mc,Ca)}Bj(){}ik(){}RRf(Ca,Hb,cc,ca,ia){this.cx.reset();if(this.allow&&!Z.e(this.$.na))if(cc&&
cc.Attributes&512&&ca&&Hb){const Sb=this.$.oJ;this.s4c();this.cx.oCj(Hb,cc,ca);this.d8a()?(Hb=Wb.a(this.$).domElement,cc=H.DOMElementExtensions.getLocation(Hb),ca=Math.abs(Hb.scrollLeft),this.$.isChromeRtl&&(Sys.Browser.agent===Sys.Browser.Safari&&(ca=Hb.scrollWidth-Hb.offsetWidth-ca),ca*=-1),Ca=new k.a(Ca.x-cc.x+ca,Ca.y-cc.y+Hb.scrollTop),Sb&&(Ca.x=Hb.offsetWidth-Ca.x)):(Hb=this.gridView.Vf(ia).view.ui,Ca=ua.a.Qu(Hb,this.gridView.Vf(ia).domElement,new Sys.UI.Point(Math.round(Ca.x),Math.round(Ca.y)),
Sb));this.Eh.COj(Ca.x,Ca.y,Sb,ia)}else this.ey()}GXg(Ca){Ca&&(this.gridView=Ca,this.gridView.Eb.wpb(this.Eza),this.gridView.Xb.gl(this.Di))}aX(){this.HLj()?this.Eh.DOj():this.Eh.hide()}HLj(){this.cx.reset();if(!this.allow||this.gridView.ha.Sa.jc)return!1;const Ca=eb.a(this.$).BLa();if(Object(h.a)(V.PivotTableRange,Ca)&&Ca.supportsBIExplore){const ca=this.gridView.ha.ra.activeCell,ia=this.gridView.Jb(ca);if(ca&&ia&&this.gridView.ha.ra.u5){var Hb=ca.left-Ca.left,cc=ca.top-Ca.top;if(!(Ca.l$g&1<<Hb||
Ca.$vj&1<<cc||Ca.g$g&1<<Hb||Ca.Vvj&1<<cc||ia.hasAutoFilter)&&(Hb=ca.vd(Ca.zB)||ca.vd(Ca.ME),cc=!1,Ca.zB&&Ca.ME?cc=ca.top<Ca.zB.top&&ca.left<Ca.ME.left||ca.top<Ca.ME.top:Ca.ME&&(cc=ca.top<Ca.ME.top),!Hb&&!cc&&0<ia.text.length||Hb&&(0<ia.text.length||ia.Mxa||ia.m8a)))return this.cx.yFj(ca,Ca),!0}}return!1}showCallout(Ca,Hb=1){eb.a(this.$).Lx(this.cx.confirmationRequiredForDataOps,cc=>{cc&&this.cx.$jf&&(this.callout=new ta(this.$,this.cx,this.Eh.domElement(Hb),Ca),this.callout.initialize(),this.Eh.u3a(Hb),
this.callout.YL(this.PDd),this.callout.fg());this.Eh.getButton(1).zdb()})}s4c(){this.Eh.getButton(1).zdb();this.callout&&!this.callout.pqi&&(this.callout.LAa(this.PDd),this.callout.lv(),this.callout=null)}scrollIntoView(){var Ca=this.gridView.ha;if(1===Ca.Oe){Ca=Ca.ra.activeCell;const Hb=this.gridView.view.visibleArea,cc=this.gridView.Eg(Ca);Hb&&cc&&!Hb.contains(cc)&&this.gridView.yv(Ca,3,"BIExploreManager.ScrollIntoView")}}d8a(){return this.$.ea.isNamedObjectViewMode&&Z.f(this.$.na)}static la(Ca,
Hb){ya.a(Ca)||Ca.da.Ha(2,new Jb(Ca,Hb))}}Object(b.a)(Jb,"BIExploreManager",l.a,[222,519,63,3,520]);var Gb=a(9),Nb=a(714),Ja=a(106),ab=a(473),wb=a(151),xb=a(28),rb=a(196);class za{constructor(Ca,Hb,cc){Hb||e.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");this.$=Ca;this.fieldManagerPane=Hb;this.HKg=cc}Mc(Ca,Hb){return(2140436015===Hb||-1006032470===Hb)&&!(new wb.a(this.HKg)).Td(8192)}executeCommand(Ca,Hb,cc,ca){Ca=Hb.command;ca=ca.QM();switch(Ca){case 2140436015:case -1006032470:this.fieldManagerPane&&
(this.fieldManagerPane.WAc(!Ja.f(this.$.gg),Hb,!1),e.ULS.sendTraceTag(537162717,0,50,`${2140436015===Ca?"Show":"Hide"} Field List`));break;case 589118293:case -1687560254:return this.s9b(!0,!1,ca);case 1176256599:return this.s9b(!1,!1,ca);case -1751201991:return this.s9b(!0,!0,ca);case -232434744:return this.s9b(!1,!0,ca);default:return rb.a(Ca)}return Ab.Task.Ta(!0)}Ac(Ca,Hb){Ca=!1;switch(Hb.command){case 2140436015:case -1006032470:Ca=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:Ca=
!0}return Ca}Rc(){return!1}s9b(Ca,Hb,cc){const ca=xb.a.Ya.Zb,ia=P.h(this.$).ha.ra.activeCell;cc=Object(ib.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(pa.c)($a.a.resolve(cb.L,{Wb:cc})):wa.GetServiceTaskFactory.Pa(this.$.da,12,477,cc);return oa.TaskExtensions.za(cc,()=>{eb.a(this.$).Lx(!1,Sb=>{if(Sb){P.h(this.$).No(!0);const Oc=Da.o(ia,this.$);this.$.Oc(-867563466,(td,Jd,qe)=>A.J(this.$.pa.va,Oc,0,!1,!1,!1,Ca,Hb,td,Jd,qe,null,null),ca,0,6,161,()=>new ab.a(Oc,Hb))}})},this.$.ka,
3)}static $1a(Ca,Hb,cc){const ca={};Ca.Sj(ca);ca.FirstRow=Hb;ca.FirstColumn=cc;return ca}}Object(b.a)(za,"FieldListCommandHandler",null,[222]);class Aa extends Nb.a{constructor(Ca){super(Ca)}ld(){oa.TaskExtensions.za(wa.GetServiceTaskFactory.Pa(this.$.da,16,74,this.Na),Ca=>{this.fd([new za(this.$,Ca.result,this.$.ua)])},this.ka,3)}static la(Ca){Nb.a.Rd(75,new Aa(Ca))}}Object(b.a)(Aa,"FieldListCommandHandlerFactory",Nb.a,[]);var pb=a(228);class kb{constructor(Ca,Hb){this.Dla=this.ptd=this.Cla=this.lkc=
!1;this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.Aje=-1;this.Xke=1;this.wEa=this.S$d=this.R$d=-1;this.Yra=null;if(Ca&&(this.Vz=Hb,this.Cla=this.lkc=!1,Ca.na)){var cc=P.h(Ca),ca=Hb=null;if(Z.f(Ca.na)){var ia=Wb.a(Ca);ia.ed&&ia.ed.Attributes&4&&(this.chartId=ia.chartId,Hb=ia.ed)}else Z.i(Ca.na)&&((ia=cc.ha.Sa.jc)?(cc=ia.floatingObject)&&0===cc.type&&cc.ed&&cc.ed.Attributes&4&&(this.chartId=ia.floatingObject.id,Hb=cc.ed):cc.ha.ra.activeCell&&(ia=
eb.a(Ca).BLa(),Object(h.a)(V.PivotTableRange,ia)&&(ca=ia)));Hb?(this.Cla=!0,this.ptd=!!(Hb.Attributes&256),this.anchorType=7,this.Dla=!!(Hb.Attributes&128),this.confirmationRequiredForDataOps=!!(Hb.Attributes&64),this.wEa=Hb.ExternalSourceIndex,this.lH=Hb.FieldListVersion,this.DM=Hb.FieldWellVersion,Hb=this.Yra={},Ca.Sj(Hb),Hb.FirstColumn=Hb.FirstRow=-1):ca&&(this.lkc=!0,this.ptd=ca.isActionable,this.anchorType=0,this.Dla=ca.isOlap,this.confirmationRequiredForDataOps=ca.confirmationRequiredForDataOps,
this.wEa=ca.externalSourceIndex,this.lH=ca.nJh,this.DM=ca.sJh,this.pivotTableName=ca.pivotTableName,this.Yra=Da.o(ca,Ca))}}get oKb(){return this.Aje}set oKb(Ca){this.Aje=Ca}get Vz(){return this.Xke}set Vz(Ca){this.Xke=Ca}get lH(){return this.R$d}set lH(Ca){this.R$d=Ca}get DM(){return this.S$d}set DM(Ca){this.S$d=Ca}get zNa(){return this.Cla||this.lkc}get xwi(){return this.zNa&&!this.ptd}get externalSourceIndex(){return this.wEa}get ax(){return this.Yra}get sheetName(){return this.ax?this.ax.SheetName:
null}get kub(){return this.chartId+"_"+this.pivotTableName+"_"+this.lH+"_"+this.DM}zih(){const Ca={};Ca.AnchorType=this.anchorType;7===this.anchorType&&(Ca.ChartId=this.chartId);Ca.AnchorValue1=Ca.AnchorValue2=-1;return Ca}static R6b(){return new kb(null,-1)}static create(Ca,Hb){return new kb(Ca,Hb)}static bpf(Ca,Hb){return Ca.zNa!==Hb.zNa||Ca.anchorType!==Hb.anchorType||Ca.chartId!==Hb.chartId||Ca.pivotTableName!==Hb.pivotTableName||!!Ca.ax&&!!Hb.ax&&Ca.ax.SheetName!==Hb.ax.SheetName}static qAi(Ca,
Hb){return kb.bpf(Ca,Hb)||Ca.oKb!==Hb.oKb||Ca.Vz!==Hb.Vz}}Object(b.a)(kb,"FieldListRequestState",null,[557]);class Cb extends pb.a{constructor(Ca){super();this.$=Ca;this.Gb()}create(){const Ca=kb.create(this.$,-1);this.qb(Ca)}dispose(){this.$=null;super.dispose()}static la(Ca){Ca.da.Ha(110,new Cb(Ca))}}Object(b.a)(Cb,"FieldListRequestStateFactory",pb.a,[]);var ob=a(425),qa=a(33),ma=a(807),Ga=a(113),vb=a(4),Ka=a(90);class Pa{constructor(){this.bE=0;this.request=null;this.ml=!0}get correlationId(){return this.bE}Dzf(){return this.bE=
this.correlationId+1}}Object(b.a)(Pa,"DataRequestInfo",null,[]);class fb{}fb.Uzh="ewa-flp-react-pane";fb.Tzh="ewa-flp-react-header";fb.Vzh="ewa-flp-react-title";fb.Rzh="ewa-flp-react-body";fb.Szh="ewa-flp-react-close-button";Object(b.a)(fb,"CssClassNames",null,[]);var Wa=a(24),Ma=a(592),lb=a(198),Na=a(291),X=a(117),F=a(564),na=a(22);const hb=(Ca,Hb,cc)=>{if(Ca)for(let ca=0,ia=Ca.length;ca<ia;ca++){const Sb=Ca[ca];Sb.ClientId=cc++;Sb.ClientParentId=Hb;cc=hb(Sb.Children,Sb.ClientId,cc)}return cc},Ib=
(Ca,Hb,cc,ca)=>{for(const ia of Ca){if(ia.PivotCacheIndex===Hb&&(ia.TypeTag===cc||0===cc))return ia;if(ca&&(Ca=Ib(ia.Children,Hb,cc,ca)))return Ca}return null},vc=(Ca,Hb,cc)=>{if(Ca)for(let ia=0,Sb=Ca.length;ia<Sb;ia++){var ca=Ca[ia];if(ca.ClientId===Hb||cc&&(ca=vc(ca.Children,Hb,cc)))return ca}return null};var nc=a(7),Pb=a(183),oc=a(1356),Ic=a(770);class ec{constructor(){this.type=null;this.dataUpdateType=0;this.fieldWellsItems=this.fieldListItems=null;this.isSortAscending=this.isPivotChart=this.isOlap=
this.isDataModel=!1;this.focusResetId=this.focusResetType=this.fieldListSizePercentage=this.selectedTab=0;this.onFieldListItemMenuClickV2=this.onFieldWellItemMenuClickV2=this.onFieldCheckedChanged=this.onFieldExpandCollapse=this.onFieldMove=this.onExpandCollapseAll=this.onSortOrderChanged=this.onSelectedTabChanged=this.onSaveFieldListSizePercentage=null;this.isRichPivotFieldList=!1;this.onSearchInputChanged=this.fieldListSearchInfo=null}}Object(b.a)(ec,"FieldListTaskPaneProps",null,[]);class mb{constructor(Ca,
Hb){this.$=Ca;this.fieldManagerPane=Hb}lL(Ca){Pb.UISurfaces.mj().then(Hb=>{Hb.showTaskPane("FieldListTaskPane",this.pu(Ca,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})}LB(Ca,Hb,cc,ca,ia,Sb,Oc,td,Jd,qe,Ie){Pb.UISurfaces.mj().then(Ze=>{Ze.updateTaskPane("FieldListTaskPane",this.pu(Ca,Hb,cc,ca,ia,Sb,Oc,td,Jd,qe,Ie));return null})}jBa(){Pb.UISurfaces.mj().then(Ca=>{Ca.setSelectedTaskPane("FieldListTaskPane");return null})}mK(){Pb.UISurfaces.mj().then(Ca=>{Ca.hideTaskPane("FieldListTaskPane",2);return null})}pu(Ca,
Hb,cc,ca,ia,Sb,Oc,td,Jd,qe,Ie){Hb=Object(nc.a)(new ec,{type:"FieldListTaskPaneProps",fieldListItems:cc,fieldWellsItems:ca,dataUpdateType:Hb,isDataModel:ia,selectedTab:Sb,isSortAscending:Oc,focusResetType:td,focusResetId:Jd,isRichPivotFieldList:qe,fieldListSearchInfo:Ie,isOlap:this.fieldManagerPane.Dla,isPivotChart:this.fieldManagerPane.Cla,fieldListSizePercentage:this.fieldManagerPane.ehj,onFieldExpandCollapse:this.fieldManagerPane.ahj,onExpandCollapseAll:this.fieldManagerPane.$gj,onFieldCheckedChanged:this.fieldManagerPane.jhj,
onFieldListItemMenuClickV2:this.fieldManagerPane.chj,onSortOrderChanged:this.fieldManagerPane.Vgj,onSaveFieldListSizePercentage:this.fieldManagerPane.Bhj,onSearchInputChanged:this.fieldManagerPane.dhj,onSelectedTabChanged:Ze=>{this.fieldManagerPane.Wgj(Ze)},onFieldMove:(Ze,Oe,eg,Qf)=>{this.fieldManagerPane.mhj(Ze,Oe,eg,Qf)},onFieldWellItemMenuClickV2:(Ze,Oe,eg,Qf)=>{this.fieldManagerPane.fhj(Ze,Oe,eg,Qf)}});if(qa.a.Gd(this.$))return Object(nc.a)(new oc.a,{contentProps:Hb,onOpen:()=>{this.fieldManagerPane.nJf()},
onClose:()=>{this.fieldManagerPane.J1i()},onManualClose:()=>{this.fieldManagerPane.K1i()},title:this.fieldManagerPane.Cla?S.a.instance.ga(1183):S.a.instance.ga(1182),width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950});Ca=Object(nc.a)(new Ic.a,{type:"ExcelLegacyTaskPaneProps",container:Ca,paneProps:Hb});return Object(nc.a)(new oc.a,{contentProps:Ca,onOpen:()=>{this.fieldManagerPane.nJf()}})}}Object(b.a)(mb,"FieldListReactTaskPane",null,[573]);class Ob{constructor(Ca,Hb,cc){this.cachedItemIndex=
this.cachedSourceAxis=0;this.cachedItemName=null;this.cachedSourceAxis=Ca;this.cachedItemIndex=Hb;this.cachedItemName=cc}}Object(b.a)(Ob,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);class Ta{constructor(Ca,Hb,cc,ca){this.activeCell=this.additionalInformation=this.pivotData=this.pivotName=null;this.pivotName=Ca;this.pivotData=Hb;this.additionalInformation=cc;this.activeCell=ca}getActiveCell(){return this.activeCell}}Object(b.a)(Ta,"MacroRecorderPivotTablePivotedPayload",null,[123]);
var sb=a(165),zb=a(96),db=a(29),jb=a(109),Ub=a(74),xd=a(724);class ne{constructor(){this.id=0;this.name=null;this.type=0;this.showSeparator=this.showMenu=this.showCheckBox=this.canDrag=this.isMoreFields=this.isChecked=this.isCollapsed=this.isCollapsible=!1;this.children=null;this.isBolded=!1}}Object(b.a)(ne,"FieldListItem",null,[]);class fe{constructor(){this.searchRestoreValue=null;this.searchWithNoMatch=this.needSearchReset=this.needSearchRestore=!1}}Object(b.a)(fe,"FieldListSearchInfo",null,[]);
class Bd{constructor(){this.id=0;this.name=null}}Object(b.a)(Bd,"FieldWellItem",null,[]);class Ue{constructor(){this.valuesWellItems=this.rowsWellItems=this.columnsWellItems=this.filtersWellItems=null}}Object(b.a)(Ue,"FieldWellsItems",null,[]);class mc extends C.a{constructor(Ca,Hb,cc){var ca;super(Ca);this.Bdd=300;this.rQ=new Pa;this.sQ=new Pa;this.S9c={};this.iva=this.fk=this.dk=null;this.rrb=this.y3b=this.Mbc=!1;this.currentState=kb.R6b();this.HHa=this.pHa=null;this.hca=0;this.YSd=this.Bsd=!1;
this.hva=null;this.dnf=this.dh=!1;this.mFe=this.PJb=this.tAa=null;this.SJb=-1;this.tW=[];this.OJb=!1;this.RQa=null;this.NJb=this.sUf=this.YKd=!1;this.MJb="";this.QQa=null;this.V6=0;this.U6="";this.WKd=!1;this.qUf=null;this.fj=!1;this.Qv=0;this.jhj=(ia,Sb)=>{this.fk&&this.Gla&&(ia=vc(this.fk.FieldListItems,ia,!0))&&(e.ULS.sendTraceTag(554317778,0,50,"React Field List: check/uncheck a field."),this.mBi(ia,Sb))};this.ahj=ia=>{this.fk&&(ia=vc(this.fk.FieldListItems,ia,!0))&&ia.IsCollapsible&&(5===ia.TypeTag&&
ia.IsCollapsed&&!ia.Children.length?(this.tW.length=0,this.tW.push(ia),this.Scd()):(ia.IsCollapsed=!ia.IsCollapsed,this.dh&&this.mcc(0,-1,!1,!1,!1,!1)))};this.$gj=ia=>{this.fk&&(e.ULS.sendTraceTag(554317777,0,50,"React Field List: expand/collapse all fields."),0<this.tW.length&&(this.tW.length=0),this.oUf(this.fk.FieldListItems,ia)?this.Scd():this.dh&&this.mcc(0,-1,!1,!1,!1,!1))};this.chj=(ia,Sb,Oc)=>{if(this.fk){var td=document.getElementById(Sb);if(td){var Jd=vc(this.fk.FieldListItems,ia,!0);if(Jd){ia=
{};ia.domElement=td;ia.fieldItem=Jd;ia.versionkey=this.kub;ia.isChart=!!this.chartId;ia.isPpm=this.fk.IsPpm;ia.isOlap=this.currentState.Dla;ia.supportsImplicitMeasures=this.fk.SupportsImplicitMeasures;ia.isKeyboardInput=Oc;this.RQa=Sb;Sb=new zb.a(330754562,0,this.$.xc,30,null);var qe;this.OJb=!sb.a(qe=this.$.Ia.Hb(Sb,ia))&&(6!==qe.status||qe.result)}}}};this.Vgj=ia=>{e.ULS.sendTraceTag(554317775,0,50,"React Field List: change field list sort order.");const Sb=mc.Htb(this.currentState);this.$.userOperationManager.Oc(new lb.a(251,
0,(Oc,td,Jd)=>{var qe=this.$.pa.va;const Ie=A.L(qe,this.currentState.ax,this.currentState.externalSourceIndex,Sb);Ie.isAscending=ia;return A.g(qe,"ChangePivotFieldListSortOrder",Ie,Oc,td,Jd,null,0)}),null)};this.Bhj=ia=>{this.oje=ia};this.dhj=ia=>{ia!==this.U6&&(e.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),this.U6=ia,this.mcc(0,-1,!1,!0,!1,!1))};this.mJf=()=>{if(this.OJb&&this.RQa){const ia=document.getElementById(this.RQa);ia&&ia.classList.add("fieldItemMenuOpen")}};
this.lJf=()=>{if(this.OJb&&this.RQa){const ia=document.getElementById(this.RQa);ia&&(ia.classList.remove("fieldItemMenuOpen"),ia.classList.contains("fieldItemOnHover")||ia.classList.contains("fieldItemOnFocus")||(ia.style.visibility="hidden"))}this.OJb=!1;this.RQa=null};this.tl=()=>{this.USd(!0,null);this.hideTaskPane();return!0};this.t$=()=>{if(this.$)if(Ub.a(this.$).SMa&&this.isVisible&&this.currentState.zNa&&this.$.ea.Yb){if(this.rQ.ml&&!this.rQ.request){var ia=this.rQ;var Sb=this.$.pa.va;var Oc=
this.currentState.lH,td=this.currentState.oKb,Jd=this.currentState.Vz,qe=this.RXi,Ie=this.SXi,Ze=this.rQ.Dzf();const Oe=A.L(Sb,this.currentState.ax,this.currentState.externalSourceIndex,mc.Htb(this.currentState));Oe.type=1;Oe.version=Oc;Oe.relatedGroup=td;Oe.selectedTab=Jd;Sb=A.g(Sb,"GetPivotFieldListData",Oe,qe,Ie,null,Ze,4);ia.request=Sb}this.sQ.ml&&!this.sQ.request&&(ia=this.sQ,Sb=this.$.pa.va,Oc=this.currentState.DM,td=this.UXi,Jd=this.VXi,qe=this.sQ.Dzf(),Ie=A.L(Sb,this.currentState.ax,this.currentState.externalSourceIndex,
mc.Htb(this.currentState)),Ie.type=1,Ie.version=Oc,Sb=A.g(Sb,"GetPivotFieldManagerData",Ie,td,Jd,null,qe,4),ia.request=Sb)}else mc.EY(this.rQ),mc.EY(this.sQ)};this.RXi=(ia,Sb)=>{this.GQf(ia,Sb,this.rQ)&&(ia=ia.Result)&&(this.currentState.lH=ia.FieldListVersion,this.rQ.ml=!1,this.rmg(ia));eb.a(this.$).dRb();this.refresh()};this.SXi=ia=>{this.bEf(ia,this.rQ)};this.UXi=(ia,Sb)=>{this.GQf(ia,Sb,this.sQ)&&(ia=ia.Result)&&(this.currentState.DM=ia.FieldWellVersion,this.sQ.ml=!1,this.img(ia));this.refresh()};
this.VXi=ia=>{this.bEf(ia,this.sQ)};this.HSi=ia=>{if(db.a.Zf(ia.Errors)){this.rrb=!1;this.pHa=null;for(let Oc=0,td=ia.Errors.length;Oc<td;++Oc)if(1244452614===ia.Errors[Oc].MessageId){if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")){ia=P.h(this.$);var Sb=ia.tb.fp(ia.ha.ra.activeCell);Sb&&(Sb=Wa.Range.Hc(Sb.C2f+1,Sb.left),Sb=Da.v(Sb,this.$),ia.sg(Sb,null,null,null,3,"FieldManagerPane.OnApplyPivotSuccess"))}this.currentState.lH=-1;this.currentState.DM=-1;this.refresh();
break}}this.Mbc=!0};this.tWi=ia=>{this.y3b=!1;if(!db.a.Zf(ia.Errors)){if(0<this.tW.length)for(ia=0;ia<this.tW.length;++ia)this.tW[ia].IsCollapsed=!1;this.currentState.lH=-1;this.refresh()}};this.F_=()=>{const ia=P.h(this.$).ha;ia.Sa.Usd&&ia.Oe&470||P.h(this.$).inRangePicker||P.h(this.$).ei||this.$Jb(!0,!0)};this.xf=()=>{this.refresh();this.$.ea.Tm.FieldListForceOnTop&&this.WAc(!1,null,!0)};this.sqc=()=>{this.$Jb(!0,!0)};this.od=()=>{this.$Jb(!0,!1)};this.rj=(ia,Sb)=>{ia=Z.e(Sb.OF)||Z.e(Sb.na);this.$Jb(!0,
ia)};this.Sq=(ia,Sb)=>{for(let Oc of Sb.U7j)this.smg(Oc);this.Bsd&&(this.Bsd=!1,this.Lla||this.taskPaneManager.Lh&&1===this.taskPaneManager.Lh.taskPane.Qh||this.taskPaneManager.yI(this,!0));this.$Jb(!1,!0)};this.lGf=(ia,Sb)=>{P.h(this.$).Jr||this.smg(Sb.dd.hash)};this.NGb=()=>{this.refresh()};this.Wc=()=>{this.$K()};this.Io=()=>{this.$K()};this.LLf=()=>{this.refresh()};this.MMf=()=>{this.t$()};this.$=Hb;this.gg=Hb.gg;this.taskPaneManager=cc;this.taskPaneManager.vE(this.LLf);this.Pxi=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",
!1)&&D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",!1);this.Lla=qa.a.Gd(this.$);this.oje=.5;this.hva=new mb(this.$,this);this.$.Ia.Rse(this.mJf);this.$.Ia.OZa(this.lJf);this.Bdd=400;this.Lla||(Ca.style.width=L.HelperMethods.zc(this.Bdd));na.a.equals("rtl",Ca.dir,!0)&&(this.fj=!0);this.rJh=[4,2,1,8];this.$.hl(this.od);Ca=P.h(this.$);Ca.Ca.Us(this.lGf);Ca.BT(this.Sq);Wb.a(this.$).Ca.Us(this.NGb);Ca.ha.vA(this.F_);Ca.uE(this.F_);Ca.ha.Sa.SPg(this.sqc);null===(ca=jb.a(this.$))||
void 0===ca?void 0:ca.Y0b(this.sqc);this.$.ua.Yf(this.rj);this.$.ea.ju(this.xf);this.$.ea.Oj(this.Wc);this.$.ea.ZL(this.Io);Ub.a(this.$).BYc(this.MMf);w.a(this.$).fi(this);this.refresh()}ET(Ca){this.get_events().addHandler(mc.XYe,Ca)}AW(Ca){this.get_events().removeHandler(mc.XYe,Ca)}vE(Ca){this.addHandler(mc.awb,Ca)}WF(Ca){this.removeHandler(mc.awb,Ca)}QPg(Ca){this.addHandler(mc.VYe,Ca)}voj(Ca){this.removeHandler(mc.VYe,Ca)}PPg(Ca){this.addHandler(mc.UYe,Ca)}uoj(Ca){this.removeHandler(mc.UYe,Ca)}get pivotName(){return this.currentState.pivotTableName}get chartId(){return this.currentState.chartId}get ax(){return this.currentState.ax}get Dla(){return this.currentState.Dla}get Cla(){return this.currentState.Cla}get confirmationRequiredForDataOps(){return this.currentState.confirmationRequiredForDataOps}get externalSourceIndex(){return this.currentState.externalSourceIndex}get lH(){return this.currentState.lH}get DM(){return this.currentState.DM}get kub(){return this.currentState.kub}get isRtl(){return this.fj}get gVd(){return this.n_a}get Gla(){return!(!this.isVisible||
this.rQ.ml||this.sQ.ml||this.y3b||this.rrb)}get parentElement(){return this.$.domElement}get mc(){return this.domElement}get isVisible(){return super.isVisible}set isVisible(Ca){Ca=this.o_a&&Ca;!Ca||this.HHa||this.dnf||this.Rki();Ca!==super.isVisible&&(super.isVisible=Ca,this.raiseEvent(mc.awb));this.nWf(null,Ca)}get If(){return this.isVisible}get ee(){return la.a.pJh}get Qh(){return 1}get jk(){return y.a.sEh}get QQ(){return S.a.instance.ga(1069)}get Xp(){return this.Bdd}get isResizable(){return!0}get titleText(){return S.a.instance.ga(1182)}get ehj(){return this.oje}get IB(){return this.taskPaneManager.Ava(this.mc,
this.titleText,this.Xp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Xp)}get n_a(){return this.$.ic.G2(36896)&&this.o_a}get o_a(){const Ca=new wb.a(this.$.ua);return this.$.isEditMode&&Ca.Td(8192)||!Ca.Xh}get pmh(){return(this.pivotName||"")+(this.chartId||"")}Sg(){}Oq(){return this.n_a&&!Ja.f(this.gg)}Et(){const Ca=kb.create(this.$,this.SJb);return Ca.zNa&&!Ca.xwi&&!Ja.f(this.gg)}ZV(){}Ere(Ca,Hb){(Ca=Ib(this.fk.FieldListItems,
Ca,this.currentState.Dla?5:17,!0))&&Ca.CanDrag&&this.QJ(Ca,Hb,0,null,null)}QJ(Ca,Hb,cc,ca,ia){let Sb,Oc,td;if(ca&&!na.a.equals(ca,this.kub,!1))alert(S.a.instance.Ua(18));else{({axis:ca,pos:Oc,oPf:td}=this.v2e(Ca.PivotCacheIndex,Ca.PivotTableIndex));-1!==Ca.PivotTableIndex?Sb=ca:(Oc=Sb=0,td=Ca.PivotCacheIndex);if(0===Sb){if(7===Ca.TypeTag&&(Ca=0<=Ca.ClientParentId?vc(this.fk.FieldListItems,Ca.ClientParentId,!0):null,!Ca))return;Oc=0;td=Ca.PivotCacheIndex}if(Sb!==Hb||0===Hb||Oc!==cc&&Oc!==cc-1){var Jd=
new Ob(ca,Ca.PivotCacheIndex,Ca.Name);eb.a(this.$).Lx(this.currentState.confirmationRequiredForDataOps,qe=>{qe&&this.applyPivot(this.currentState,Sb,Oc,Ca.TypeTag,td,Hb,cc,ia,P.h(this.$),Jd,Ca)})}}}mhj(Ca,Hb,cc,ca){if(this.fk&&this.dk){var ia=null;switch(Hb){case 0:ia=vc(this.fk.FieldListItems,Ca,!0);break;case 1:ia=vc(this.dk.RowAxis,Ca,!1);break;case 2:ia=vc(this.dk.ColumnAxis,Ca,!1);break;case 4:ia=vc(this.dk.FilterAxis,Ca,!1);break;case 8:ia=vc(this.dk.DataAxis,Ca,!1)}ia&&(e.ULS.sendTraceTag(554317779,
0,50,"React Field List: drag and drop a field."),this.QJ(ia,cc,ca,null,null))}}oUf(Ca,Hb){let cc;cc=!1;for(let ca=0;ca<Ca.length;ca++){const ia=Ca[ca];Hb&&ia.IsCollapsible&&5===ia.TypeTag&&ia.IsCollapsed&&!ia.Children.length?(this.tW.push(ia),cc=!0):Hb&&ia.IsCollapsible&&ia.IsCollapsed?ia.IsCollapsed=!1:Hb||!ia.IsCollapsible||ia.IsCollapsed||(ia.IsCollapsed=!0);ia.IsCollapsible&&ia.Children&&0<ia.Children.length&&this.oUf(ia.Children,Hb)&&(cc=!0)}return cc}mcc(Ca,Hb,cc,ca,ia,Sb){if(this.fk){var Oc=
!1,td=!1,Jd=!1,qe=null;Jd=null;var Ie=Ca;ca&&0<this.tW.length&&(this.tW.length=0);({wzb:td,nua:Jd,isRichPivotFieldList:Oc,returnValue:qe}=this.Tfd(this.fk.FieldListItems,ca,!1));Jd?this.y3b||this.Scd():(Jd=new fe,Jd.needSearchReset=Sb,Jd.needSearchRestore=!Sb&&ia,Jd.searchRestoreValue=Jd.needSearchRestore?this.U6:"",Jd.searchWithNoMatch=""!==this.U6&&!td,Jd.searchWithNoMatch&&ca&&oa.TaskExtensions.za(wa.GetServiceTaskFactory.Pa(this.$.da,211,212,0),Ze=>{Ze.result.readText(S.a.instance.ga(778))},this.$.ka,
3),""!==this.U6&&2===Ca&&(Jd.searchWithNoMatch?Ie=1:cc&&qe&&0<qe.length&&(Hb=qe[0].id)),this.hva.LB(this.HHa,0,qe,null,this.fk.IsPpm,this.fk.SelectedTab,this.fk.IsSortAscending,Ie,Hb,Oc,Jd))}}Wgj(Ca){e.ULS.sendTraceTag(554317776,0,50,"React Field List: change All/Active tab.");this.SJb=Ca;this.uVj()}fhj(Ca,Hb,cc,ca){if(this.dk){var ia=document.getElementById(cc);if(ia){var Sb=null,Oc=-1;switch(Hb){case 4:Sb=vc(this.dk.FilterAxis,Ca,!1);Oc=this.dk.FilterAxis.length;break;case 2:Sb=vc(this.dk.ColumnAxis,
Ca,!1);Oc=this.dk.ColumnAxis.length;break;case 1:Sb=vc(this.dk.RowAxis,Ca,!1);Oc=this.dk.RowAxis.length;break;case 8:Sb=vc(this.dk.DataAxis,Ca,!1),Oc=this.dk.DataAxis.length}if(Sb){var td={};this.currentState.Cla?(td.AnchorType=8,td.ChartId=this.currentState.chartId):td.AnchorType=9;td.AnchorValue1=Sb.PivotTableIndex;td.AnchorValue2=Sb.PivotCacheIndex;var Jd,qe;({axis:Jd,pos:qe}=this.v2e(Sb.PivotCacheIndex,Sb.PivotTableIndex));Ca=new zb.a(-1453503574,0,this.$.xc,30,null);Hb={};Hb.domElement=ia;Hb.fieldItem=
Sb;Hb.zoneCount=Oc;Hb.sourceAxis=Jd;Hb.sourceAxisPos=qe;Hb.optionalPivotMenuAnchorParameter=td;Hb.isOlap=this.currentState.Dla;Hb.isPpm=this.fk.IsPpm;Hb.versionkey=this.kub;Hb.isKeyboardInput=ca;Hb.cell=this.currentState.ax;Hb.externalSourceIndex=this.externalSourceIndex;ca=!1;D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&this.currentState.Dla&&!this.fk.IsPpm&&this.fk.SupportsImplicitMeasures&&(Sb=Ib(this.fk.FieldListItems,Sb.PivotCacheIndex,5,!0),ca=!!Sb&&
!Sb.IsCollapsible);Hb.fieldItemsupportsImplicitMeasures=ca;this.RQa=cc;var Ie;this.OJb=!sb.a(Ie=this.$.Ia.Hb(Ca,Hb))&&(6!==Ie.status||Ie.result)}}}}bhj(Ca){Ca&&oa.TaskExtensions.za(wa.GetServiceTaskFactory.Pa(this.$.da,103,104,0),Hb=>{var cc=Hb.result;const ca=P.h(this.$),ia=Da.v(Wa.Range.Hc(1,1),this.$).SheetName;Hb=cc.Ghb(ca);let Sb,Oc,td,Jd;Hb?(cc=Hb.je,Sb=cc.Be.top,Oc=cc.Be.left,td=Hb.TI.x,Jd=Hb.TI.y):(Sb=Oc=1,Hb=cc.NLa(ca),td=Hb.x,Jd=Hb.y);this.$.userOperationManager.Oc(new lb.a(203,0,(qe,Ie,
Ze)=>Na.t(this.$.pa.va,ia,this.pivotName,Ca.PivotCacheIndex,0,Sb,Oc,td,Jd,qe,Ie,Ze,null),void 0,()=>new Ma.a(ia,this.pivotName,Ca.PivotCacheIndex,0)),null)},this.$.ka,8)}dispose(){var Ca;if(this.$){this.$.em(this.od);this.$.Ia.kZf(this.mJf);this.$.Ia.TKb(this.lJf);this.tW.length=0;const Hb=P.h(this.$);Hb&&(Hb.YN(this.Sq),Hb.VF(this.F_),Hb.ha&&(Hb.ha.TF(this.F_),Hb.ha.Sa.xoj(this.sqc)),Hb.Ca&&Hb.Ca.Dr(this.lGf));null===(Ca=jb.a(this.$))||void 0===Ca?void 0:Ca.awc(this.sqc);Ca=Wb.a(this.$);(null===
Ca||void 0===Ca?0:Ca.Ca)&&Ca.Ca.Dr(this.NGb);this.$.ua&&this.$.ua.yg(this.rj);if(Ca=this.$.ea)Ca.Lv(this.xf),Ca.pk(this.Wc),Ca.MR(this.Io);Ub.a(this.$)&&Ub.a(this.$).Ivc(this.MMf)}this.taskPaneManager&&this.taskPaneManager.WF(this.LLf);this.tAa&&(O.a.instance.Aa(x.a.click,this.tAa,this.tl),Ga.KeyInputManager.instance.ix(this.tAa,this.mFe));this.hideTaskPane();this.taskPaneManager=this.$=this.hva=null;super.dispose()}eg(Ca,Hb){if(!Hb){Ca=H.DOMElementExtensions.Dl(this.domElement.querySelectorAll(H.DOMElementExtensions.Hq));
if(!Ca)return!1;H.DOMElementExtensions.setFocus(Ca)}return!Hb}Bh(Ca){return H.DOMElementExtensions.Df(this.mc,Ca)}Bj(){}ik(){}uVj(){this.refresh()}mBi(Ca,Hb){Ca&&Ca.CanDrag&&this.QJ(Ca,Hb?-1:0,-1,null,null)}u6(){this.Lla&&this.Oq()&&this.Et()&&(this.isVisible=!0)}nJf(){this.YKd=!0;this.refresh()}J1i(){this.hideTaskPane()}K1i(){this.USd(!0,null);this.hideTaskPane()}Rki(){this.dnf=this.dh=!0;this.Lla||this.mmi();this.hva.lL(this.HHa)}showTaskPane(){this.isVisible=!0;""!==this.U6&&(this.WKd=!0);this.dh?
this.Lla?this.hva.jBa():this.taskPaneManager.yI(this,!0):(this.dh=!0,this.hva.lL(this.HHa),this.Lla||this.taskPaneManager.yI(this,!0))}hideTaskPane(){this.isVisible=this.YKd=this.dh=!1;this.hva.mK()}WAc(Ca,Hb,cc){this.USd(Ca,Hb);this.Bsd=cc;this.YSd=!Ca&&!!Hb||cc;Ca?this.hideTaskPane():this.showTaskPane()}Scd(){eb.a(this.$).Lx(this.currentState.confirmationRequiredForDataOps,Ca=>{Ca&&this.expandPivotFieldListLevels(this.currentState)})}jV(){return!1}pVg(){const Ca=document.getElementsByTagName("head")[0];
if(Ca){const Hb=document.createElement("link");Hb.setAttribute("rel","stylesheet");Hb.setAttribute("type","text/css");Hb.setAttribute("href",H.DOMElementExtensions.xZ(this.domElement,"data-cssfile",null));Ca.appendChild(Hb)}}mmi(){const Ca=document.getElementById(this.$.Cb+v.a.WYe);if(Ca){this.pVg();Ca.classList.add(mc.thj);var Hb=this.Cjh();Ca.appendChild(Hb);Hb=xd.b("div",mc.qhj,mc.phj);Ca.appendChild(Hb);this.HHa=Hb}}Cjh(){const Ca=xd.b("div",mc.vhj,mc.uhj);this.PJb=xd.b("span",mc.xhj,mc.whj);
this.PJb.innerText=this.titleText;this.tAa=ma.a.ob(mc.rhj,mc.shj,S.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.tAa.classList.add(vb.AFrameworkApplication.isRtl?v.a.yja:v.a.zja);O.a.instance.ta(x.a.click,this.tAa,this.tl);this.mFe=Ga.KeyInputManager.instance.Mt(this.tAa,this.tl,Ka.a.Sh);Ca.appendChild(this.PJb);Ca.appendChild(this.tAa);return Ca}rmg(Ca){if(this.fk=Ca)this.currentState.lH=this.fk.FieldListVersion,this.hca=hb(this.fk.FieldListItems,-1,this.hca);if(this.fk)if(this.dh){this.SJb=
this.currentState.Vz=this.fk.SelectedTab;this.fFi();Ca=-1;var Hb=0,cc=!1;this.YSd?(this.fk.FieldListItems&&0<this.fk.FieldListItems.length&&(Ca=this.fk.FieldListItems[0].ClientId,Hb=2,cc=!0),this.YSd=!1):this.Mbc&&0===this.V6&&(this.QQa||this.NJb?this.fk.FieldListItems&&0<this.fk.FieldListItems.length&&(Ca=this.NJb?this.fk.FieldListItems[0].ClientId:this.QQa.ClientId,Hb=2,cc=this.NJb):this.sUf&&(Ca=this.fk.FieldListItems[0].ClientId,Hb=1),this.U4b());var ca=!1;this.qUf!==this.fk.PivotXluid&&(this.qUf=
this.fk.PivotXluid,ca=!0,this.U6="");this.mcc(Hb,Ca,cc,!1,!ca&&this.WKd&&""!==this.U6,ca);this.WKd=!1}else this.U4b()}U4b(){this.V6=0;this.QQa=null;this.MJb="";this.Mbc=this.NJb=this.sUf=!1}WLj(Ca){return 7===Ca.TypeTag?!1:Ca.ShowFilterArrow||Ca.ShowCheckBox}oBi(Ca){return Ca.IsCollapsible&&(!Ca.IsCollapsed||2===Ca.Image)&&!!Ca.Children&&0<Ca.Children.length}wzb(Ca,Hb){const cc=Hb.length;return 2<cc&&'"'===Hb.charAt(0)&&'"'===Hb.charAt(cc-1)?na.a.contains(Ca,Hb.substring(1,cc-1),!0):na.a.L1a(Hb,"*")||
na.a.L1a(Hb,"?")?(Hb=Hb.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),Hb="^"+na.a.uRa(na.a.uRa(Hb,"\\\\?",".",!0),"\\\\*",".*",!0)+"$",0<=Ca.search(new RegExp(Hb,"i"))):na.a.contains(Ca,Hb,!0)}Tfd(Ca,Hb,cc){let ca,ia,Sb,Oc;ca=Oc=Sb=ia=!1;const td=[];for(let Ie=0;Ie<Ca.length;Ie++){const Ze=Ca[Ie];var Jd=!1;let Oe=!1,eg=!1,Qf,gg=[];if(""===this.U6){if(this.oBi(Ze)){var qe=void 0;({wzb:Oe,nua:Qf,xdf:qe,isRichPivotFieldList:Jd,returnValue:gg}=this.Tfd(Ze.Children,Hb,!1));Ze.ShowCheckBox||(Ze.IsChecked=
qe)}}else 2!==Ze.Image&&this.wzb(Ze.Name,this.U6)&&(ca=eg=!0,Hb&&Ze.IsCollapsible&&Ze.IsCollapsed&&(5!==Ze.TypeTag||Ze.Children.length?Ze.IsCollapsed=!1:(this.tW.push(Ze),ia=!0))),Hb&&cc&&Ze.IsCollapsible&&Ze.IsCollapsed&&(5!==Ze.TypeTag||Ze.Children.length?Ze.IsCollapsed=!1:(this.tW.push(Ze),ia=!0)),Ze.IsCollapsible&&Ze.Children&&0<Ze.Children.length&&({wzb:Oe,nua:Qf,xdf:qe,isRichPivotFieldList:Jd,returnValue:gg}=this.Tfd(Ze.Children,Hb,eg||cc),Ze.ShowCheckBox||(Ze.IsChecked=qe),Oe&&(ca=!0,Hb&&(Ze.IsCollapsed=
!1)),Qf&&(ia=!0));this.Pxi&&(Jd||66===Ze.TypeTag)&&(Oc=!0);Ze.IsChecked&&(Sb=!0);if(""===this.U6||eg||Oe||cc)Jd=new ne,Jd.id=Ze.ClientId,Jd.name=Ze.Name,Jd.type=Ze.TypeTag,Jd.isCollapsible=Ze.IsCollapsible,Jd.showCheckBox=Ze.ShowCheckBox,Jd.isMoreFields=2===Ze.Image,Jd.canDrag=Ze.CanDrag&&7!==Ze.TypeTag,Jd.showSeparator=Ze.ShowSeparator,Jd.showMenu=this.WLj(Ze),Jd.isCollapsed=Ze.IsCollapsed,Jd.isChecked=Ze.IsChecked,Jd.isBolded=Ze.IsBolded,Jd.children=gg,td.push(Jd)}return{returnValue:td,wzb:ca,nua:ia,
xdf:Sb,isRichPivotFieldList:Oc}}scc(Ca){const Hb=Array(Ca.length);for(let cc=0;cc<Ca.length;cc++){const ca=Ca[cc],ia=new Bd;ia.id=ca.ClientId;ia.name=ca.Name;Hb[cc]=ia}return Hb}hxj(){this.J3f(this.fk.FieldListItems,"")}fFi(){this.$sf(this.fk.FieldListItems,"")}Yac(Ca,Hb){return Ca.Name+"_"+Ca.UniqueName+"_"+Ca.TypeTag+"_"+(Hb||this.pmh)}J3f(Ca,Hb){if(Ca)for(let cc=0,ca=Ca.length;cc<ca;cc++){const ia=Ca[cc];let Sb="";if(ia.IsCollapsible||ia.Children)Sb=this.Yac(ia,Hb),ia.IsCollapsible&&(this.S9c[Sb]=
!!ia.IsCollapsed),ia.Children&&this.J3f(ia.Children,Sb);this.QQa&&ia.ClientId===this.QQa.ClientId&&(this.MJb=Sb||this.Yac(ia,Hb))}}$sf(Ca,Hb){if(Ca)for(let cc=0,ca=Ca.length;cc<ca;cc++){const ia=Ca[cc];let Sb="";if(ia.IsCollapsible||ia.Children)Sb=this.Yac(ia,Hb),ia.IsCollapsible&&Sb in this.S9c&&(ia.IsCollapsed=J.a.ng(this.S9c,Sb)),ia.Children&&this.$sf(ia.Children,Sb);this.MJb&&na.a.equals(this.MJb,Sb||this.Yac(ia,Hb),!1)&&(this.QQa=ia,this.MJb="")}}img(Ca){if(this.dk=Ca)this.currentState.DM=this.dk.FieldWellVersion,
this.hca=hb(this.dk.FilterAxis,-1,this.hca),this.hca=hb(this.dk.ColumnAxis,-1,this.hca),this.hca=hb(this.dk.RowAxis,-1,this.hca),this.hca=hb(this.dk.DataAxis,-1,this.hca);this.iva?this.iva.length=0:this.iva=[];if(this.dk)if(this.iva.push(this.dk.FilterAxis),this.iva.push(this.dk.ColumnAxis),this.iva.push(this.dk.RowAxis),this.iva.push(this.dk.DataAxis),this.dh){Ca=-1;var Hb=0;if(this.Mbc&&0!==this.V6){switch(this.V6){case 1:0<this.dk.RowAxis.length&&(Ca=this.dk.RowAxis[0].ClientId,Hb=3);break;case 2:0<
this.dk.ColumnAxis.length&&(Ca=this.dk.ColumnAxis[0].ClientId,Hb=3);break;case 4:0<this.dk.FilterAxis.length&&(Ca=this.dk.FilterAxis[0].ClientId,Hb=3);break;case 8:0<this.dk.DataAxis.length&&(Ca=this.dk.DataAxis[0].ClientId,Hb=3)}this.U4b()}var cc=new Ue;cc.filtersWellItems=this.scc(this.dk.FilterAxis);cc.columnsWellItems=this.scc(this.dk.ColumnAxis);cc.rowsWellItems=this.scc(this.dk.RowAxis);cc.valuesWellItems=this.scc(this.dk.DataAxis);this.hva.LB(this.HHa,1,null,cc,!1,-1,!1,Hb,Ca,!1,null)}else this.U4b()}Q4j(){this.PJb&&
(this.PJb.innerText=this.currentState.Cla?S.a.instance.ga(1183):this.titleText)}refresh(){if(this.YKd){var Ca=kb.create(this.$,this.SJb);this.nWf(Ca)}}nWf(Ca,Hb=!1){if(this.isVisible&&(this.Lla||this.HHa)){Ca=Ca||kb.create(this.$,this.SJb);const cc=this.currentState;this.fk&&this.hxj();this.currentState=Ca;if(kb.qAi(cc,Ca)||Hb){if(this.rrb=!1,this.rQ.ml=Ca.zNa,mc.EY(this.rQ),kb.bpf(cc,Ca)||Hb)this.sQ.ml=Ca.zNa,mc.EY(this.sQ),this.rmg(null),this.img(null),this.Q4j()}else cc.lH<Ca.lH?(this.rQ.ml=!0,
mc.EY(this.rQ)):this.currentState.lH=cc.lH,cc.DM<Ca.DM?(this.rrb=!1,this.sQ.ml=!0,mc.EY(this.sQ)):this.currentState.DM=cc.DM}bb.a.instance.create(this.t$,0,Za.a.oJh,!0,!0)}USd(Ca,Hb){this.applyPivotFieldManagerHiddenState(Ca,Hb);this.gg=L.HelperMethods.pO(Ca,this.gg,4);this.refresh();this.raiseEvent(mc.awb);this.Lla&&this.$.tf()}applyPivotFieldManagerHiddenState(Ca,Hb){this.$.userOperationManager.Oc(new lb.a(144,0,(cc,ca,ia)=>{const Sb=Da.o(P.h(this.$).ha.ra.activeCell,this.$);var Oc=this.$.pa.va;
const td=Oc.Oa(9);td.hidden=Ca;td.activeCell=Sb;return A.g(Oc,"ApplyPivotFieldManagerHiddenStateV2",td,cc,ca,ia,null,0)},16),Hb)}GQf(Ca,Hb,cc){cc.ml=!1;if(!cc.request||Hb!==cc.correlationId)return!1;cc.request=null;return db.a.Zf(Ca.Errors)?(this.$.ea.$n(Ca.Errors),!1):!0}bEf(Ca,Hb){const cc=X.a.Ue(Ca.data);this.$.ea.$n(cc);Hb.request=null;10!==Ca.data.status&&(Hb.ml=!1);this.t$()}applyPivot(Ca,Hb,cc,ca,ia,Sb,Oc,td,Jd,qe,Ie){0<Jd.getRangeInformation(Jd.ha.ra.activeCell).length?this.rrb=!0:(this.rQ.ml=
!0,this.sQ.ml=!0);Ca.lkc&&(this.pHa=Ca.pivotTableName);const Ze=mc.Htb(Ca),Oe={FieldListType:1};Oe.FieldListVersion=Ca.lH;Oe.FieldWellVersion=Ca.DM;Oe.SourceAxis=Hb;Oe.SourceAxisPosition=cc;Oe.ItemType=ca;Oe.ItemIndex=ia;Oe.DestinationAxis=Sb;Oe.DestinationAxisPosition=Oc;this.P6j(Ie,Hb,Sb);Hb=new lb.a(145,0,(eg,Qf,gg)=>{var ug=this.$.pa.va;eg=va.b(eg,this.HSi);const ng=A.L(ug,Ca.ax,Ca.externalSourceIndex,Ze);ng.pivotFieldApplyData=Oe;return A.g(ug,"ApplyPivot",ng,eg,Qf,gg,null,0)},4,()=>new Ta(this.pivotName,
Oe,qe,Ca.ax));this.$.userOperationManager.Oc(Hb,td)}P6j(Ca,Hb,cc){if(this.fk&&this.dk)if(0===Hb)this.V6=0,this.QQa=Ca;else if(0!==cc)this.V6=cc;else switch(this.V6=0,this.NJb=!0,Hb){case 1:1<this.dk.RowAxis.length&&(this.V6=1);break;case 2:1<this.dk.ColumnAxis.length&&(this.V6=2);break;case 4:1<this.dk.FilterAxis.length&&(this.V6=4);break;case 8:1<this.dk.DataAxis.length&&(this.V6=8)}}expandPivotFieldListLevels(Ca){const Hb=mc.Htb(Ca);this.y3b=!0;this.$.userOperationManager.Oc(new lb.a(146,0,(cc,
ca,ia)=>{var Sb=this.$.pa.va;cc=va.b(cc,this.tWi);const Oc=A.L(Sb,Ca.ax,Ca.externalSourceIndex,Hb);Oc.type=1;return A.g(Sb,"ExpandPivotFieldListLevels",Oc,cc,ca,ia,null,0)}),null)}v2e(Ca,Hb){var cc;for(let ia=mc.Qqg;ia<=mc.Rqg;ia++){const Sb=this.iva[ia];for(cc=Sb.length-1;0<=cc;cc--){var ca=Sb[cc];if(ca.PivotCacheIndex===Ca&&(-1===Hb||ca.PivotTableIndex===Hb))return Ca=this.K3h(ia),ca=ca.PivotTableIndex,{returnValue:!0,axis:Ca,pos:cc,oPf:ca}}}return{returnValue:!1,axis:0,pos:-1,oPf:-1}}$Ai(Ca){return Ca>=
mc.Qqg&&Ca<=mc.Rqg}clear(){this.currentState=kb.R6b();this.refresh()}K3h(Ca){return this.$Ai(Ca)?this.rJh[Ca]:0}$Jb(Ca,Hb){Ca&&(this.pHa=null);this.refresh();Hb&&(this.Lla?!this.dh&&this.Et()&&this.Oq()?this.showTaskPane():!this.dh||this.Oq()&&this.Et()||this.hideTaskPane():this.raiseEvent(mc.awb))}JRh(){var Ca=P.h(this.$);let Hb=null;Ca=Ca.getRangeInformation(Ca.ha.ra.activeCell);for(let cc=0,ca=Ca.length;cc<ca;++cc){const ia=Ca[cc];if(Object(h.a)(V.PivotTableRange,ia)){Hb=ia.pivotTableName;break}}return Hb}smg(Ca){const Hb=
P.h(this.$);var cc=Hb.Ca.pl(Ca);if(cc){if(this.pHa){Ca=cc.ranges;if(!Ca)return;for(cc=Ca.length-1;0<=cc;--cc){var ca=Ca[cc];if(Object(h.a)(V.PivotTableRange,ca)&&na.a.equals(ca.pivotTableName,this.pHa,!1)){Ca=this.JRh();Ca&&na.a.equals(Ca,this.pHa,!1)||(Ca=Da.v(ca.topLeft,this.$),Hb.sg(Ca,null,null,null,0,"FieldManagerPane.UpdateFieldsPaneStatus"));this.pHa=null;break}}}P.h(this.$).Jr||this.refresh()}else e.ULS.sendTraceTag(537162690,0,15,`Block ${Ca} was removd from BlockManager`)}$K(){this.clear()}static hXg(Ca,
Hb,cc){let ca=F.a(Ca);if(!ca){const ia=document.getElementById(Ca.Cb+v.a.WYe);ia?ca=Ca.da.Ha(16,new mc(ia,Ca,Hb,cc)):e.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null.")}return ca}static Htb(Ca){const Hb={};Hb.AnchorType=Ca.anchorType;7===Ca.anchorType&&(Hb.ChartId=Ca.chartId,Hb.AnchorValue1=Hb.AnchorValue2=-1);return Hb}static EY(Ca){Ca.request&&(vb.AFrameworkApplication.Hd.Wt(Ca.request.Xs),Ca.request=null)}}mc.awb="fieldListPaneVisibilityChanged";mc.VYe=
"FieldListPaneChanging";mc.UYe="FieldListPaneChanged";mc.XYe="FieldManagerRemovePaneEventKey";mc.Qqg=0;mc.Rqg=3;mc.vhj="FieldListReactPaneHeaderId";mc.qhj="FieldListReactPaneBodyId";mc.xhj="FieldListReactPaneTitleId";mc.rhj="FieldListReactPaneCloseButtonId";mc.thj=fb.Uzh;mc.uhj=fb.Tzh;mc.whj="cui-taskPaneTitle "+fb.Vzh;mc.phj=fb.Rzh;mc.shj=fb.Szh;Object(b.a)(mc,"FieldManagerPane",C.a,[555,556,3,457,63]);class Fc extends pb.a{constructor(Ca){super();this.Nyb=()=>Object(ib.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?
Object(pa.c)($a.a.resolve(cb.L,{Wb:this.Na})):wa.GetServiceTaskFactory.Pa(this.$.da,12,477,this.Na);this.$=Ca;this.Gb()}create(){const Ca=D.EwaSettings.isChangeGateEnabled("OfficeVSO:7079204_pivotTableFieldPanePain")?Ab.Task.Ta(null):this.Nyb(),Hb=ob.a(this.$),cc=[Ca,Hb];if(!qa.a.Gd(this.$)){const ca=wa.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),ia=wa.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);cc.push(ca);cc.push(ia)}oa.TaskExtensions.za(oa.TaskExtensions.Md(cc,this.ka),
()=>{const ca=mc.hXg(this.$,Hb.result,Ca.result);ca&&(qa.a.Gd(this.$)||Hb.result.VQ(ca),ca.u6());this.qb(ca)},this.ka,3)}dispose(){this.$=null;super.dispose()}static la(Ca){Ca.da.Ha(74,new Fc(Ca))}}Object(b.a)(Fc,"FieldManagerTaskPaneFactory",pb.a,[]);var bd=a(167),de=a(86);class Md{constructor(){this.F8b=this.sourceRange=this.wea=null}}Object(b.a)(Md,"SelectedRangeForPivot",null,[]);var se=a(560),tc=a(197),dd=a(272),Hd=a(156),Xc=a(185);class gd{static get qg(){return Hd.a.Iq(gd.wni,Xc.a.ga(66),Xc.a.ga(67),
Xc.a.ga(68),Xc.a.ga(69),Xc.a.ga(70),Xc.a.ga(71),Xc.a.ga(72))}}gd.wni="<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(b.a)(gd,"InsertPivotTableDialogHtml",null,[]);var je=a(171),Ee=a(379);class ae{constructor(Ca,Hb){this.FZb=Ca;this.wFg=Hb;this.guc=null}get textBox(){return this.FZb}get icb(){return this.wFg}bindAction(Ca){this.icb&&Ca&&(this.guc=Ca,this.icb.hPg(this.guc))}V1j(){this.icb&&this.guc&&this.icb.Snj(this.guc)}isValid(){return!!this.icb&&!!this.textBox}}Object(b.a)(ae,"TextBoxRadioButtonPair",null,[588]);var Yb=a(895),Sc=a(293);class qd{constructor(Ca,Hb){this.title=Ca;this.qg=Hb}}Object(b.a)(qd,
"DialogData",null,[]);const Id=(Ca,Hb,cc,ca,ia,Sb,Oc,td=null)=>{td=Ca.Oa(41,td);td.sheetRange=Hb;td.destinationRange=cc;return A.g(Ca,"InsertPivotTable",td,ca,ia,Sb,Oc,0)},ic=(Ca,Hb,cc,ca,ia,Sb,Oc,td,Jd=null)=>{Jd=Ca.Oa(41,Jd);Jd.activeCell=Hb;Jd.newRange=cc;Jd.isDataSource=ca;return A.g(Ca,"ChangePivotLocation",Jd,ia,Sb,Oc,td,0)},Gc=(Ca,Hb,cc,ca,ia,Sb,Oc=null)=>{Oc=Ca.Oa(1,Oc);Oc.activeCell=Hb;return A.g(Ca,"GetDataSourceRangeForPivotTable",Oc,cc,ca,ia,Sb,0)};class jd{constructor(Ca,Hb){this.destinationRange=
this.sourceRange=null;this.sourceRange=Ca;this.destinationRange=Hb}}Object(b.a)(jd,"MacroRecorderPivotTableCreatedPayload",null,[123]);var ed=a(390),Qd=a(182),te=a(246);class xe extends ed.a{constructor(Ca){super(Ca)}C5a(Ca){let Hb,cc=({dlc:Hb}=super.C5a(Ca)).returnValue;if(!cc){const ca=Object(d.a)(te.a,this.$.Bb);ca&&ca.Kk(Ca)&&(cc=(Ca=ca.getItemByName(Ca))&&1!==Ca.type?2===Ca.type?Qd.a(Ca):Ca.usedRange:null,Hb=2===Ca.type)}return{returnValue:cc,dlc:Hb}}}Object(b.a)(xe,"PivotTableRangeHighlightPolicy",
ed.a,[]);class He extends dd.a{constructor(Ca,Hb){super(Ca,new xe(Ca));this.OZd=this.destinationRange=this.Raa=this.eza=this.GTa=null;this.$Ba=!1;this.pv=0;this.vNe="";this.thf=(cc,ca)=>{this.hide();if(1===cc){let ia=cc="";2!==this.pv&&(cc=He.kHd(ca[He.EBc],this.$.ua),this.yRj(cc,this.$)&&e.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));1!==this.pv&&ca[He.Ocd]&&(ia=He.kHd(ca[He.E8b],this.$.ua));2===this.pv&&ia===this.vNe||
this.Umi(cc,ia)}else this.AOb(!0,!0),e.ULS.sendTraceTag(537155780,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};this.Fu=()=>{this.PQb()};this.dqc=()=>{this.destinationRange.disabled=!this.Raa.checked;this.PQb();return!1};this.hEf=()=>{this.PQb();return!1};this.yLf=()=>{this.PQb();return!1};this.VEd=cc=>{if(La.a(cc))this.AOb(!0,!0),e.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");else{e.ULS.sendTraceTag(537155743,0,50,
"InsertPivotTableDialog.OnInsertPivotTableDone - success.");const ca=cc.Result;if(ca){if(cc=this.$.ua.getItemByName(ca.SheetName))cc.activate(),this.gridView.sg(ca,null,null,null,3,"InsertPivotTableDialog.OnInsertPivotTableDone"),this.AOb(!0,!1),0===this.pv&&this.uDj(),cc=v.a.uuc,cc!==je.a(this.$).yp.Vz&&(je.a(this.$).huc(2),je.a(this.$).yp.activateRibbonTab(cc))}else this.AOb(!0,!1)}};this.gridView=P.h(this.$);this.UQ=se.a.instance;this.nx=!1;-1128516639===Hb?(this.pv=1,e.ULS.sendTraceTag(537155785,
0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):-63037693===Hb?(this.pv=2,e.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):e.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog")}dispose(){e.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.CEc();super.dispose()}get pc(){return"InsertPivotTableDialog"}get Vrb(){return!0}get XCe(){return!0}get WCe(){return!0}Vja(){let Ca;
return Ca=new tc.a,Ca.add(He.EBc),Ca.add(He.E8b),Ca}sph(){let Ca=!1;2!==this.pv&&(Ca=He.uph(this.GTa.value));Ca||1===this.pv||(Ca=He.tph(this.Raa.checked,this.destinationRange.value));return Ca}get rD(){return()=>{let Ca=this.destinationRange.value;1!==this.pv&&this.destinationRange.disabled&&(Ca="");this.thf(1,He.X5e(this.GTa.value,Ca))}}ehc(Ca){e.ULS.sendTraceTag(537155779,0,50,"InsertPivotTableDialog.InitAndShow");const Hb=this.nhd();this.qg=Hb.qg;var cc="";2!==this.pv&&(cc=He.kHd(Ca.wea,this.$.ua));
cc=He.X5e(cc,Ca.F8b);1!==this.pv&&2===this.pv&&(this.vNe=Ca.F8b);this.AOb(!1,!1);this.initializeAndShow(Hb.title,this.thf,cc);this.DYd();this.GDj();this.PQb();e.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")}yRj(Ca,Hb){let cc=!1;Ca=({dlc:cc}=(new xe(Hb)).C5a(Ca)).returnValue;return!!Ca&&Ca.v5&&!cc}PQb(){this.n0a.disabled=this.sph()}DYd(){this.UQ.ta(x.a.change,this.eza,this.dqc);this.UQ.ta(x.a.change,this.Raa,this.dqc);this.UQ.ta(x.a.Qd,this.GTa,this.yLf);this.UQ.ta(x.a.Qd,
this.destinationRange,this.hEf);this.ePg(this.Fu);this.$Ba=!0}CEc(){this.$Ba&&(this.UQ.Aa(x.a.change,this.eza,this.dqc),this.UQ.Aa(x.a.change,this.Raa,this.dqc),this.UQ.Aa(x.a.Qd,this.GTa,this.yLf),this.UQ.Aa(x.a.Qd,this.destinationRange,this.hEf),this.Qnj(this.Fu),this.$Ba=!1)}GDj(){2===this.pv?this.destinationRange.focus():this.GTa.focus()}qfg(){const Ca=new Sc.a(this.destinationRange),Hb=new Yb.a(this.Raa,!1);this.OZd=new ae(Ca,Hb);this.FYd(this.OZd)}mlg(){this.k1d(this.OZd)}Bt(){super.Bt();e.ULS.sendTraceTag(537155777,
0,50,"InsertPivotTableDialog.InitializeDialogElements");this.GTa=document.getElementById(He.EBc);this.eza=document.getElementById(He.Nzf);this.Raa=document.getElementById(He.Ocd);this.destinationRange=document.getElementById(He.E8b);switch(this.pv){case 0:case 2:this.destinationRange.value?He.a9f(this.Raa,this.eza):(this.destinationRange.disabled=!0,He.a9f(this.eza,this.Raa));Ja.k(this.$.gg)&&(this.eza.checked=!1,this.eza.disabled=!0,this.destinationRange.value="",this.Raa.checked=!0);if(2===this.pv){this.GTa.disabled=
!0;var Ca=document.getElementById(He.ymh);Ca.style.visibility="hidden";Ca.style.display="none"}break;case 1:this.destinationRange.disabled=!0,this.eza.disabled=!0,this.Raa.disabled=!0,Ca=document.getElementById(He.Z9i),Ca.style.visibility="hidden",Ca.style.display="none"}}Umi(Ca,Hb){e.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");const cc=this.$.pa.va;let ca=1;const ia=cc.$b(),Sb=Da.o(P.h(this.$).ha.ra.activeCell,this.$);let Oc=null,td=null;switch(this.pv){case 0:ca=
132;Oc=(Jd,qe,Ie)=>Id(cc,Ca,Hb,va.b(Jd,this.VEd),qe,Ie,null,ia);td=()=>new jd(Ca,Hb);break;case 2:ca=219;Oc=(Jd,qe,Ie)=>ic(cc,Sb,Hb,!1,va.b(Jd,this.VEd),qe,Ie,null,ia);break;case 1:ca=219,Oc=(Jd,qe,Ie)=>ic(cc,Sb,Ca,!0,va.b(Jd,this.VEd),qe,Ie,null,ia)}Ee.a(this.$.userOperationManager,Oc,Jd=>new lb.a(ca,0,Jd,void 0,td),null)}nhd(){let Ca=0;switch(this.pv){case 0:Ca=65;break;case 1:Ca=2157;break;case 2:Ca=2153}return new qd(S.a.instance.ga(Ca),gd.qg)}uDj(){const Ca=this.$.da.Ba(16);Ca&&Ca.WAc(!1,null,
!0)}AOb(Ca,Hb){const cc=!Ca,ca=this.$.da.Ba(183);ca&&ca.Dbg(cc,Hb);Ca&&this.gridView.Ng&&this.gridView.Ng.Ap(v.a.gV)}set Vrb(Ca){super.Vrb=Ca}set rD(Ca){super.rD=Ca}static X5e(Ca,Hb){const cc=!Hb;return{[He.EBc]:Ca,[He.E8b]:Hb,[He.Nzf]:cc,[He.Ocd]:!cc}}static a9f(Ca,Hb){Ca.tabIndex=He.fNh;Hb.tabIndex=He.RPi}static kHd(Ca,Hb){let cc,ca;Ca=Ca.startsWith("=")?Ca.substring(1,Ca.length):Ca;({sheetName:cc,range:ca}=Da.ab(Ca,Hb)).returnValue&&ca&&(cc||(cc=Hb.na.name),Ca=Da.x(ca,cc,!1,!0));return Ca}static uph(Ca){return na.a.Pq(Ca)}static tph(Ca,
Hb){return Ca&&na.a.Pq(Hb)}}He.jRe="";He.fNh=0;He.RPi=-1;He.EBc="sourceRange";He.E8b="destinationRange";He.Nzf="newWorksheet";He.Ocd="existingWorksheet";He.ymh="DataSourceDiv";He.Z9i="PivotDestinationDiv";Object(b.a)(He,"InsertPivotTableDialog",dd.a,[]);class We{constructor(Ca){this.sod=!1;this.w_a=null;this.$=Ca;this.gridView=P.h(Ca);de.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Hb=>{this.w_a=Hb;Hb.isFeatureEnabled(We.Eff,!1).then(cc=>this.sod=cc);Hb.FAa(We.Eff,
cc=>{this.sod=cc.isEnabled})})}Mc(){return!1}executeCommand(Ca,Hb,cc){var ca;Ca=oa.TaskExtensions.Yj();const ia=Hb.command;let Sb;const Oc=new bd.a;Hb=this.gridView.ha.ra;switch(ia){case 2137617149:Ca=null!==(ca=cc.Vtg)&&void 0!==ca?ca:Hb.selectedRanges;this.a5h(Ca,Oc);if(qa.a.Blf(this.$)&&this.sod){const qe=new bd.a;Oc.task.Yo(Ie=>{cc.SourceSelection=sb.b(Ie)&&Ie.result&&Ie.result.wea?Ie.result.wea:"";return this.$.Yc(-1444574190,0,0,cc).continueWith(Ze=>{sb.b(Ze)&&Ze.result||(Sb=new He(this.$,ia),
Sb.ehc(Ie.result));qe.setResult(!0)})});Ca=qe.task}else Sb=new He(this.$,ia),Ca=Oc.task.continueWith(()=>{Sb.ehc(Oc.task.result)});break;case -1128516639:const td=this.$.pa.va.$b(),Jd=Da.o(Hb.activeCell,this.$);ca=new lb.a(554,0,(qe,Ie,Ze)=>Gc(this.$.pa.va,Jd,va.b(qe,Oe=>{this.QFf(Oe,Oc,!1)}),va.a(Ie,()=>{We.PFf(Oc,this.$)}),Ze,null,td),88);ca.zBa(()=>!0);this.$.userOperationManager.Oc(ca,null);Sb=new He(this.$,ia);Ca=Oc.task.continueWith(()=>{Sb.ehc(Oc.task.result)});break;case -63037693:ca=new Md;
if(Hb=this.gridView.tb.fp(Hb.activeCell))Hb=Wa.Range.Hc(Hb.C2f+1,Hb.left),ca.F8b=Da.h(Hb,this.$,!0,void 0,!0);Oc.setResult(ca);Sb=new He(this.$,ia);Ca=Oc.task.continueWith(()=>{Sb.ehc(Oc.task.result)})}return Ca}QFf(Ca,Hb,cc){const ca=Ca.Result,ia=new Md;if(cc||ca){const Sb=this.gridView.ha.ra.eh;La.a(Ca)?Sb&&(ia.wea=this.gridView.ha.k9e(!0)):(ia.wea=ca,Sb&&cc&&this.hvh()&&!this.gridView.tb.uh(this.gridView.ha.ra.xd)&&(ia.F8b=this.gridView.ha.fgd(!0,!0)))}else if(Ca=this.gridView.tb.fp(this.gridView.ha.ra.activeCell))ia.wea=
Ca.dataSource;Hb.setResult(ia)}hvh(){var Ca=this.gridView.ha.ra.activeCell;Ca=new Wa.Range(Ca.top,Ca.left,Ca.top+1,Ca.left+1,!1,!1);Ca=this.gridView.Qj("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",Ca);try{for(Ca.$$rst();Ca.$$mn();)if(Ca.$$cu().text)return!1}finally{Ca&&Ca.dispose()}return!0}a5h(Ca,Hb){if(1!==Ca.length)Hb.setResult(Object(nc.a)(new Md,{wea:""}));else{Ca=Ca[0];const cc=this.gridView.tb.uh(Ca);if(cc)Hb.setResult(Object(nc.a)(new Md,{wea:cc.name,sourceRange:cc.usedRange}));
else{const ca=this.$.pa.va.$b(),ia=Da.o(Ca,this.$),Sb=Da.v(Ca,this.$);Ca=new lb.a(511,0,(Oc,td,Jd)=>{const qe=Ie=>Ie(this.$.pa.va,Sb,ia,va.b(Oc,Ze=>{this.QFf(Ze,Hb,!0)}),va.a(td,()=>{We.PFf(Hb,this.$)}),Jd,null,ca);return wa.GetServiceTaskFactory.Pa(this.$.da,482,483,1).Yo(Ie=>{sb.b(Ie)&&qe(Ie.result.getExpandedRangeForPivotTable)})},88);Ca.zBa(()=>!0);this.$.userOperationManager.Oc(Ca,null)}}}Ac(Ca,Hb){Ca=!1;switch(Hb.command){case -1128516639:case -63037693:case 2137617149:Ca=!0}return Ca}Rc(){return!1}static PFf(Ca,
Hb){e.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");P.h(Hb).ha.ra.eh?Ca.setResult(Object(nc.a)(new Md,{wea:P.h(Hb).ha.Gia})):Ca.setResult(Object(nc.a)(new Md,{wea:""}))}}We.Eff="ExcelIdeas";Object(b.a)(We,"InsertPivotTableCommandHandler",null,[222]);class ye extends Nb.a{constructor(Ca){super(Ca)}ld(){const Ca=wa.GetServiceTaskFactory.create(this.$.da,128,this.ka,this.Na);oa.TaskExtensions.za(oa.TaskExtensions.Md([Ca],
this.ka),()=>{this.fd([new We(this.$)])},this.ka,3)}static la(Ca){Nb.a.Rd(91,new ye(Ca))}}Object(b.a)(ye,"InsertPivotTableCommandHandlerFactory",Nb.a,[]);var $e=a(292);class jf extends $e.a{constructor(Ca,Hb,cc){super(Ca);this.edg=null;this.xni=(ca,ia)=>{1===ca?(ca=ia.indices,e.ULS.sendTraceTag(537155741,0,50,`InsertSlicerDialog.ClickedOK: User clicked OK, inserting ${ca.length} Slicers`),0<ca.length&&this.Hph(ca)):e.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};
this.fYi=ca=>{this.edg=ca.Result;ca={["id"]:this.pc,["singleDimFields"]:this.edg};this.initializeAndShow(S.a.instance.ga(2154),this.xni,ca)};this.gridView=P.h(Ca);this.ra=this.gridView.ha.ra;this.ha=P.h(Ca).ha;this.pivotTableName=Hb;this.UHd=cc;P.h(Ca).tb.fp(this.ha.ra.activeCell);e.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");this.Vmi()}get pc(){return"InsertSlicerDialog"}Hph(Ca){oa.TaskExtensions.za(wa.GetServiceTaskFactory.Pa(this.$.da,103,
104,0),Hb=>{var cc=Hb.result,ca=P.h(this.$),ia=cc.Ghb(ca);if(ia){var Sb=ia.je;Hb=Sb.Be.top;Sb=Sb.Be.left;cc=ia.TI.x;ia=ia.TI.y}else Hb=Sb=1,ia=cc.NLa(ca),cc=ia.x,ia=ia.y;ca=0;for(const Oc of Ca)this.yni(parseInt(Oc,10),Hb,Sb,cc+ca,ia+ca),ca+=22},this.$.ka,8)}yni(Ca,Hb,cc,ca,ia){const Sb=new lb.a(203,0,(Oc,td,Jd)=>{const qe=this.$.pa.va.$b();return Na.t(this.$.pa.va,this.UHd,this.pivotTableName,Ca,0,Hb,cc,ca,ia,Oc,td,Jd,qe)},void 0,()=>new Ma.a(this.UHd,this.pivotTableName,Ca,0));this.$.userOperationManager.Oc(Sb,
null)}Vmi(){const Ca=new lb.a(596,0,(Hb,cc,ca)=>{const ia=this.$.pa.va.$b();return Na.j(this.$.pa.va,this.pivotTableName,this.UHd,va.b(Hb,this.fYi),cc,ca,ia)},16);this.$.userOperationManager.Oc(Ca,null)}}Object(b.a)(jf,"InsertSlicerDialog",$e.a,[]);class gf{constructor(Ca){this.activeCell=this.hc=null;this.$=Ca;this.ha=P.h(this.$).ha}Mc(){return!1}executeCommand(Ca,Hb){Ca=oa.TaskExtensions.Yj();Hb=Hb.command;this.activeCell=this.ha.ra.activeCell;switch(Hb){case -1924368815:(this.hc=P.h(this.$).tb.fp(this.activeCell))&&
!this.hc.isOlap&&new jf(this.$,this.hc.pivotTableName,this.$.ua.na.sheetName)}return Ca}Ac(Ca,Hb){Ca=!1;switch(Hb.command){case -1924368815:Ca=!0}return Ca}Rc(){return!1}}Object(b.a)(gf,"InsertSlicerCommandHandler",null,[222]);class rf extends Nb.a{constructor(Ca){super(Ca)}ld(){this.fd([new gf(this.$)])}static la(Ca){Nb.a.Rd(353,new rf(Ca))}}Object(b.a)(rf,"InsertSlicerCommandHandlerFactory",Nb.a,[]);var Mf=a(82),Qa=a(383),Zb=a(558),nb=a(335),Tb=a(34),qb=a(603),Kb=a(60),jc=a(200),Ac=a(125);class Jc{constructor(Ca){this.interactiveReportView=
Ca}executeCommand(Ca,Hb){return Ab.Task.Ta(this.interactiveReportView.refreshSelectedConnection(Hb))}Ac(Ca,Hb){return 32===Ca&&2054778433===Hb.command}Rc(){return!1}Mc(Ca,Hb){return 32===Ca&&(1588554917===Hb||1891435765===Hb||2054778433===Hb&&!this.interactiveReportView.uxi)}static la(Ca,Hb){Ca.Ia.t2(new Jc(Hb))}}Object(b.a)(Jc,"InteractiveReportCommandHandler",null,[222]);var hd=a(136);class Cd{constructor(Ca,Hb){this.iframe=document.createElement("iframe");this.iframe.src=Hb;this.iframe.frameBorder=
"0";this.iframe.scrolling="no";this.iframe.id=Ca;this.fja=hd.a.instance.qe(this.iframe);this.fja.la("load",()=>{InteractiveReportAPI.SetHost(this.contentWindow,Hb)})}get V$(){return this.iframe}get Igf(){return 1}get contentWindow(){return this.iframe.contentWindow}ESa(){}setVisible(Ca){this.iframe&&this.iframe.style&&(this.iframe.style.visibility=Ca?"visible":"hidden")}dispose(){f.a.Ja(this.fja);this.fja=null}}Object(b.a)(Cd,"IFrameContentElement",null,[606,3]);class ac{constructor(Ca){this.L6a=
document.createElement("img");H.DOMElementExtensions.setVisible(this.L6a,!0);this.L6a.setAttribute("style","height: 80%; width: auto");this.p9b=document.createElement("div");this.p9b.id=Ca;this.p9b.appendChild(this.L6a)}get V$(){return this.p9b}get Igf(){return 7}get contentWindow(){return null}ESa(Ca){this.L6a&&(this.L6a.src="data:image/png;charset=utf-8;base64,"+Ca,H.DOMElementExtensions.setVisible(this.L6a,!0))}setVisible(Ca){H.DOMElementExtensions.setVisible(this.p9b,Ca)}dispose(){}}Object(b.a)(ac,
"ImageContentElement",null,[606,3]);class Lc{constructor(Ca,Hb,cc,ca,ia){this.interactiveReportContent=this.gtc=this.zG=null;this.Jhf=!1;this.C$i=()=>{this.interactiveReportView.Icc(this)};this.cce=Ca;this.JBg=cc;this.$=ia;this.zG=ca?new ac(Hb):new Cd(Hb,cc);this.RZ=this.zG.Igf;this.QUa()}get interactiveReportView(){return this.cce}get exa(){return this.JBg}get sbk(){return this.$.workbookContext.WorkbookUri}get V$(){return this.zG.V$}get contentWindow(){return this.zG.contentWindow}ESa(Ca){this.zG.ESa(Ca)}QUa(){this.interactiveReportView.isVisible&&
this.V$&&this.V$.style&&(H.DOMElementExtensions.SI(this.V$,this.interactiveReportView.domElement.clientHeight),H.DOMElementExtensions.Sv(this.V$,this.interactiveReportView.domElement.clientWidth))}setVisible(Ca){this.zG.setVisible(Ca)}Pvh(){f.a.Ja(this.gtc);this.gtc=bb.a.instance.create(this.C$i,2E3,Za.a.Yni)}dispose(){H.DOMElementExtensions.yf(this.zG.V$);f.a.sc([this.gtc,this.zG]);this.cce=this.zG=this.gtc=null}}Object(b.a)(Lc,"InteractiveReportFrameInfo",null,[3]);class rd{constructor(Ca,Hb){this.xBc=
Ca;this.Lac=Hb}}Object(b.a)(rd,"InteractiveReportSheetData",null,[]);class Yd{constructor(){this.qDb=this.Vba=this.JCb=!1}}Object(b.a)(Yd,"SheetVisibilityStateData",null,[]);const ie=(Ca,Hb,cc,ca,ia,Sb=null)=>{Sb=Ca.Oa(1,Sb);return A.g(Ca,"GetSessionInformation",Sb,Hb,cc,ca,ia,4)};var Je=a(46),ff=a(61),Ae=a(6),pf=a(40);class he extends nb.a{constructor(Ca,Hb,cc,ca){super(Hb,Ca,!1);this.$i=this.j6d=null;this.Zzc=new J.a(!0);this.v3=new J.a(!0);this.oLb=this.t2a=this.hua=null;this.LRb=!1;this.hashCode=
this.LDb=null;this.ZDc=!1;this.NTa=null;this.t9a=xb.a.Ya.Zb;this.businessBar=null;this.NPa=(ia,Sb)=>{Sb&&Sb.Result&&(ia=Sb.Result,ia.DataConnections&&ia.DataConnections.DataConnections&&this.aWf(ia.DataConnections))};this.rf=(ia,Sb)=>{switch(Sb.dd.block.state){case 1:case 3:case 5:this.oea(Sb)}};this.Ym=()=>{};this.Go=(ia,Sb)=>{this.Lad();Sb.na&&this.isVisible&&this.NDi(!Z.j(Sb.na));this.clearCache();this.XQ=!1};this.AN=ia=>{switch(ia.vu){case 1:this.ZDc&&this.Icc(this.$i)}};this.od=(ia,Sb)=>{Sb.EV||
(this.Lad(),ia=this.$,this.Wvb=Ja.d(ia.gg),ia.ea.lDa.getTime()>this.lDa.getTime()&&(this.a5b(),this.lDa=ia.ea.lDa),this.Pxa&&this.Icc(this.$i))};this.Zd=()=>{this.MTa(!1)};this.nB=()=>{this.$.ea.Xma()};this.onKeyDown=ia=>{ia=this.$.shortcutKeyManager.tt(ia);this.executeRibbonCommand(ia)};this.Ak=()=>{this.$i&&this.$i.QUa()};this.B6=()=>{this.ngc();this.LJ.Vba=!0};this.A6=()=>{this.LJ.JCb||this.LJ.qDb||this.KQb();this.LJ.Vba=!1};this.KHf=()=>{this.ngc();this.LJ.Vba=!0};this.my=()=>{this.LJ.JCb||this.LJ.qDb||
this.KQb();this.LJ.Vba=!1};this.WJf=()=>{this.LJ.JCb=this.SLb.EK&&this.SLb.K$i;this.LJ.JCb?this.ngc():this.LJ.Vba||this.LJ.qDb||this.KQb()};this.hJf=()=>{switch(Je.a(this.$).state){case 0:case 1:case 2:case 4:this.LJ.JCb||this.LJ.Vba||this.KQb();this.LJ.qDb=!1;break;case 5:case 3:case 7:case 8:case 6:this.ngc(),this.LJ.qDb=!0}};this.yXi=(ia,Sb)=>{if(this.GNa(3)||this.Pxa){var Oc=ia.Result;ia=this.Pxa;if(null===Oc||void 0===Oc?0:Oc.ReportData)this.oLb=Oc.ReportData;if(Oc&&Oc.DataConnectionsInfo)if(Oc=
Oc.DataConnectionsInfo,1===Oc.DataConnections.length&&Oc.DataConnections[0].StreamingFailed)this.a5b(),this.MTa(!0);else{var td=!0;this.t2a=Oc.DataSources;for(const Jd of Oc.DataConnections)if(Jd.IsReady||0>Jd.SourceIndex){const qe=Jd.ConnectionName.toLowerCase();this.v3.getItem(qe)||this.v3.add(qe,Jd)}else{Sb.Pvh();td=!1;break}td&&(ia?this.aWf(Oc):(this.$i.RZ=4,this.ghb(Sb,null)))}else this.$i.RZ=1}};this.OYi=ia=>{ia&&this.$.ea.$n(ia.Errors)};this.$6a=new qb.a(Ca,Ca.ea,Ca.pa.Rk,4,0);this.lDa=Ca.ea.lDa;
this.Wvb=!Ca.ic.refreshConfirmationRequired||Ja.d(Ca.gg);this.USe=!1;this.domElement.classList.add(Tb.a.fac);this.domElement.style.overflow="hidden";this.domElement.tabIndex=0;this.MTa(!1);this.Gc.la("mousedown",this.nB);this.Gc.la("keydown",this.onKeyDown);Ca.ua.sJ(this.Go);Ca.Bb.sJ(this.Go);Ca.Bb.Yf(this.Zd);Ca.ua.Yf(this.Zd);Ca.iC(this.Ak);Ca.pb.e1b(this.B6);Ca.pb.d1b(this.A6);Ca.Ia.Rse(this.KHf);Ca.Ia.OZa(this.my);Je.a(Ca).vq(this.hJf);this.Ca.Us(this.rf);this.Ca.TG(this.Ym);eb.a(Ca).lte(this.NPa);
Ca.hl(this.od);this.ev(this.qza);Ub.a(Ca).yQ(Ae.a.idle).vq(this.AN);this.SLb=cc;this.SLb.vE(this.WJf);this.LJ=new Yd;this.x3b=ca;Jc.la(Ca,this)}get Ca(){return this.$6a}get Oe(){return 32}get uxi(){if(this.Pxa){const Ca=this.f9e();return!!Ca&&-1!==Ca.SourceIndex}return!1}get bTj(){this.NTa=this.NTa||new jc.a;return this.NTa.token}Z8a(){return!0}get ove(){return this.j6d||(this.j6d=he.Neh(this.$))}get M_b(){return this.$.na.index.toString()}get L_b(){return this.Zzc.getItem(this.M_b)}get boi(){if(D.EwaSettings.xa(23)){let Ca=
Mf.a.yT(this.$.workbookContext.FullDocumentInfo.InteractiveReportsServiceUrl,he.hoi,this.$.workbookContext.FullDocumentInfo.WorkbookPath);Ca=Mf.a.yT(Ca,he.coi,he.doi);Ca=Mf.a.yT(Ca,he.Uni,this.$.ya.DataCultureTag);return Ca=Mf.a.yT(Ca,he.eoi,this.$.ya.UICultureTag)}return ea.a.current.SK.InteractiveReportServiceUrl}get Pxa(){return this.GNa(5)}dispose(){if(this.$){const Ca=this.$;Ca.ua.XK(this.Go);Ca.Bb.XK(this.Go);Ca.Bb.yg(this.Zd);Ca.ua.yg(this.Zd);Je.a(Ca).Wq(this.hJf);Ca.UF(this.Ak);Ca.pb.fwc(this.B6);
Ca.pb.ewc(this.A6);Ca.Ia.kZf(this.KHf);Ca.Ia.TKb(this.my);this.SLb.WF(this.WJf);this.SLb=null}this.$6a&&(this.$6a.Dr(this.rf),this.$6a.rI(this.Ym));this.ty(this.qza);he.ala.includes(this)&&Array.remove(he.ala,this);this.clearCache();f.a.sc([this.NTa,this.$6a,this.$i]);this.$i=this.$6a=this.NTa=null;H.DOMElementExtensions.yf(this.domElement);this.Zzc.clear();this.v3.clear();this.x3b=this.businessBar=this.LDb=this.hua=this.t2a=this.oLb=null;super.dispose()}refreshSelectedConnection(Ca){const Hb=this.f9e();
if(Hb){const cc=Hb.IsEmbedded?-1:Hb.SourceIndex;eb.a(this.$).CAa(Hb.ConnectionName,cc,Ca);return!0}return!1}Icc(Ca){e.ULS.sendTraceTag(537155663,0,15,"InteractiveReportView.GetBootstrapData()");const Hb=this.$,cc=this.oLb;ff.c(Hb)?e.ULS.sendTraceTag(537155662,0,50,"InteractiveReportView.GetBootstrapData: During RenderCachedContent"):Ub.a(Hb).Vh.activityName!==Ae.a.idle?this.ZDc=!0:(this.ZDc=!1,Hb.userOperationManager.Oc(new lb.a(512,0,(ca,ia,Sb)=>{var Oc=Hb.pa.va.$b(),td=Hb.pa.va;ca=va.b(ca,this.yXi);
var Jd=!!cc;Oc=td.Oa(1,Oc);Oc.connectionsOnly=Jd;return A.g(td,"GetInteractiveReportBootstrapData",Oc,ca,ia,Sb,Ca,0)},64),null))}f9e(){for(let Ca=0;Ca<this.v3.count;++Ca){const Hb=this.v3.$f(Ca);for(const cc of Hb.SlidesIds)if(cc===this.hua)return Hb}return null}uLg(Ca,Hb){this.hashCode=this.Ca.Asa(Ca,Hb,this.hashCode)}clearCache(){this.Ca.kRa(this.hashCode);this.hashCode=null}yif(){this.Lad();const Ca=this.$.na;return this.isVisible=!!Ca&&Z.j(Ca)}vMg(){he.ala.includes(this)||he.ala.push(this)}g5g(){f.a.Ja(this.NTa);
this.NTa=null}MTa(Ca){this.yif()&&(this.vMg(),this.g5g(),oa.TaskExtensions.za(this.ove,()=>{const Hb=6===this.ove.status;Hb&&!this.USe&&(this.Sni(),this.USe=!0);this.yif()&&(this.XEi(Ca||!Hb),Hb||this.mfj(),this.$.K4||this.focus())},this.bTj,0))}Lad(){const Ca=this.$.workbookContext.WorkbookFileVersionId;Ca&&(this.LDb||(this.LDb=Ca),this.LDb!==Ca&&this.a5b())}aWf(Ca){this.t2a=Ca.DataSources;for(const Hb of Ca.DataConnections){Ca=Hb.ConnectionName.toLowerCase();const cc=this.v3.getItem(Ca);cc&&(cc.ConnectionString!==
Hb.ConnectionString||new Date(cc.RefreshTimestampUTC)<new Date(Hb.RefreshTimestampUTC))&&(Hb.IsEmbedded&&this.eij(Hb.SecurityToken),this.yjj(Hb.DataSourceName),this.v3.remove(Ca));this.v3.add(Ca,Hb)}this.GNa(8)&&this.isVisible&&this.ghb(this.$i,null)}eij(Ca){if(this.Pxa){const Hb=vb.AFrameworkApplication.Hd.p9a,cc=this.$.ea.sessionId;try{InteractiveReportAPI.Rebind(this.$i.contentWindow,this.$i.exa,this.t2a,Ca,Hb,cc)}catch(ca){e.ULS.sendTraceTag(537155657,0,10,`RebindInteractiveReport: Failed to call Rebind: ${ca.message}`)}}}yjj(Ca){if(this.Pxa){const Hb=
vb.AFrameworkApplication.Hd.p9a,cc=this.$.ea.sessionId;try{InteractiveReportAPI.Refresh(this.$i.contentWindow,this.$i.exa,0,Ca,Hb,cc)}catch(ca){e.ULS.sendTraceTag(537155655,0,10,`RefreshInteractiveReport: Failed to call Refresh: ${ca.message}`)}}}oea(Ca){if(Ca.dd.block.na.active){Ca=Ca.dd.block.ae;const Hb=new rd(Ca.SlideId,Ca.FallbackImage);this.Zzc.add(this.M_b,Hb);this.$i.interactiveReportContent||(this.$i.interactiveReportContent=Ca);this.ghb(this.$i,Hb)}}NDi(Ca){if(this.Pxa)try{InteractiveReportAPI.LeaveSlide(this.$i.contentWindow,
this.$i.exa)}catch(Hb){e.ULS.sendTraceTag(537155651,0,10,`LeaveInteractiveReport(): Failed to call LeaveSlide: ${Hb.message}`)}this.hua=null;Ca&&(this.$i.setVisible(!1),this.$.isEditMode&&this.zKd(!0))}a5b(){f.a.Ja(this.$i);this.$i=null;this.v3.clear();this.Zzc.clear();this.oLb=this.t2a=this.hua=null;this.ZDc=this.LRb=!1;this.LDb=this.$.workbookContext.WorkbookFileVersionId;this.clearCache()}KQb(){if(this.$i&&this.LRb&&Z.j(this.$.na))try{InteractiveReportAPI.UnHideWindowedElements(this.$i.contentWindow,
this.$i.exa),this.LRb=!1}catch(Ca){e.ULS.sendTraceTag(537155618,0,10,`UnHideInteractiveReport: UnHideWindowedElements failed - ${Ca.message}`)}}ngc(){if(this.$i&&!this.LRb&&Z.j(this.$.na))try{InteractiveReportAPI.HideWindowedElements(this.$i.contentWindow,this.$i.exa),this.LRb=!0}catch(Ca){e.ULS.sendTraceTag(537155617,0,10,`HideInteractiveReport: HideWindowedElements failed - ${Ca.message}`)}}XEi(Ca){const Hb=this.$;if(this.$i)this.KQb(),this.$i.QUa(),this.$i.setVisible(!0);else{try{InteractiveReportAPI.ClearState()}catch(Sb){}const ca=
this.domElement.id+"_irframe";var cc=document.getElementById(ca);cc&&this.domElement.removeChild(cc);cc=Hb.ic;Ca=Ca||!(cc.allowFiltering&&cc.allowSorting&&cc.allowInteractivity);let ia=this.boi;ia&&(cc.allowHyperlinks||(ia+=he.Wni),cc.inEmbedView&&(ia+=he.Xni),cc.isBiPreviewOverride&&(ia+=he.Tni));this.$i=new Lc(this,ca,ia,Ca||!this.Wvb,Hb);this.domElement.appendChild(this.$i.V$);Ca||this.Wvb||(this.$i.RZ=8)}(this.Pxa||this.GNa(1)||this.GNa(7))&&this.ghb(this.$i,this.L_b);this.uLg(Hb.na,Kb.a.m8b)}nHe(Ca){Ca.RZ=
2;eb.a(this.$).Lx(!0,Hb=>{Ca.RZ=8;Hb&&(this.Wvb=!0,this.a5b(),this.MTa(!1))})}O6i(Ca){var Hb=this.v3.count;const cc=Array(Hb);for(var ca=0;ca<Hb;++ca){var ia=this.v3.$f(ca);const Sb={};Sb.Name=ia.ConnectionName;Sb.rck=ia.ConnectionString;Sb.SecurityToken=ia.SecurityToken;Sb.DataSourceName=ia.DataSourceName;Sb.yck=0>ia.SourceIndex&&ia.IsEmbedded;cc[ca]=Sb}Hb=vb.AFrameworkApplication.Hd.p9a;ca=this.$.ea.sessionId;ia=this.L_b.xBc;try{InteractiveReportAPI.OpenReport(Ca.contentWindow,Ca.exa,this.oLb,null,
ia,this.t2a,cc,Ca.sbk,Hb,ca),this.$.isEditMode&&this.zKd()}catch(Sb){e.ULS.sendTraceTag(537155605,0,10,`OnGetBootstrapDataSuccess: Failed to call OpenReport: ${Sb.message}`);return}Ca.RZ=5;this.hua=ia;this.ghb(Ca,null)}ghb(Ca,Hb){switch(Ca.RZ){case 6:this.ESa(this.$i,Hb);break;case 1:this.Wvb?(this.Icc(Ca),Ca.RZ=3):this.nHe(Ca);break;case 4:Ca.Jhf&&Ca.interactiveReportContent&&this.O6i(Ca);break;case 5:this.SOi(Ca,Hb);break;case 8:this.T6f(Hb);this.nHe(Ca);break;case 7:this.T6f(Hb)}}Sni(){try{InteractiveReportAPI.RegisterEvent("Initialized",
he.aoi),InteractiveReportAPI.RegisterEvent("UserInteractivity",he.foi),InteractiveReportAPI.RegisterEvent("GetFallbackImage",he.Zni),InteractiveReportAPI.RegisterEvent("HostKeyPressed",he.$ni),D.EwaSettings.xa(33)&&InteractiveReportAPI.RegisterEvent("UserModifiedPV",he.Vni)}catch(Ca){}}KRb(Ca){return!!this.$i&&!!this.$i.V$&&this.$i.contentWindow===Ca}YZi(Ca){this.KRb(Ca)&&(this.$i.Jhf=!0,this.GNa(5)?this.$i.RZ=4:this.GNa(6)&&(this.$i.RZ=1),this.isVisible&&this.ghb(this.$i,this.L_b))}ZZi(Ca){this.isVisible&&
this.KRb(Ca)&&Ac.a(xb.a.Ya,this.t9a)>=he.bCi&&this.$.ea.Yb&&(this.t9a=xb.a.Ya.Zb,ie(this.$.pa.va,this.OYi,null,null,null))}WZi(Ca,Hb){if(this.KRb(Ca)){const cc=this.$,ca=Hb.SessionId;Hb.sck&&cc.userOperationManager.Oc(new lb.a(513,0,(ia,Sb,Oc)=>{var td=cc.pa.va.$b(),Jd=cc.pa.va;ia=va.b(ia);td=Jd.Oa(9,td);td.sessionId=ca;return A.g(Jd,"InteractiveReportDataWasModified",td,ia,Sb,Oc,null,0)},64),null)}}sZi(Ca,Hb){if(this.KRb(Ca)&&Hb){Ca=[];Hb.Dck&&Ca.push("Control");Hb.Eck&&Ca.push("Meta");Hb.Cck&&Ca.push("Alt");
Hb.Fck&&Ca.push("Shift");const cc=document.createEvent("KeyboardEvent");cc.initKeyboardEvent("keypress",!0,!0,null,String.fromCharCode(Hb.Ack),0,Ca.join(" "),!1);Hb=new Sys.UI.DomEvent(cc);Hb=this.$.shortcutKeyManager.tt(Hb);this.executeRibbonCommand(Hb)}}executeRibbonCommand(Ca){1461300262!==Ca&&(Ca=new zb.a(Ca,1,1,6,null),this.$.Ia.Hb(Ca))}XZi(Ca){this.KRb(Ca)&&(this.$i.RZ=6,this.ESa(this.$i,this.L_b))}T6f(Ca){this.isVisible&&Ca&&Ca.Lac&&this.$i.ESa(Ca.Lac)}ESa(Ca,Hb){if(this.isVisible&&Hb&&Hb.Lac)try{InteractiveReportAPI.SetFallbackImage(Ca.contentWindow,
Ca.exa,Hb.Lac)}catch(cc){}}SOi(Ca,Hb){if(this.isVisible){if(Hb&&(!this.hua||Hb.xBc!==this.hua)){const cc=vb.AFrameworkApplication.Hd.p9a,ca=this.$.ea.sessionId;try{this.$.isEditMode&&this.zKd(),InteractiveReportAPI.Navigate(Ca.contentWindow,Ca.exa,Hb.xBc,cc,ca)}catch(ia){e.ULS.sendTraceTag(537155593,0,10,`NavigateToActiveSheetSlide: Failed to call InteractiveReportApi.Navigate: ${ia.message}`);return}this.hua=Hb.xBc}this.HJb(!0)}}GNa(Ca){return!!this.$i&&this.$i.RZ===Ca}zKd(Ca=!1){this.businessBar?
Ca?this.businessBar.removeEntry(19):this.businessBar.sh(19,null):this.x3b&&oa.TaskExtensions.za(this.x3b.value,Hb=>{this.businessBar=Hb=Hb.result;this.x3b=null;Ca?Hb.removeEntry(19):Hb.sh(19,null)},this.$.ka)}static xHa(Ca){if(!Ca.da.Ba(36)){const Hb=new Zb.a(()=>Object(ib.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(pa.c)($a.a.resolve(cb.e,{Wb:1})):wa.GetServiceTaskFactory.Pa(Ca.da,5,4,1)),cc=wa.GetServiceTaskFactory.create(Ca.da,168,Ca.ka,1);oa.TaskExtensions.za(cc,()=>{var ca=
Ca.Bf;ca=new he(Ca,ca.appendChild(ca.ownerDocument.createElement("div")),cc.result,Hb);Ca.da.Ha(36,ca)},Ca.ka)}}static Vni(Ca,Hb){he.ala.forEach(cc=>{cc.WZi(Ca,Hb)})}static aoi(Ca){he.ala.forEach(Hb=>{Hb.YZi(Ca)})}static foi(Ca){he.ala.forEach(Hb=>{Hb.ZZi(Ca)})}static Zni(Ca){he.ala.forEach(Hb=>{Hb.XZi(Ca)})}static $ni(Ca,Hb){he.ala.forEach(cc=>{cc.sZi(Ca,Hb)})}static Neh(Ca){Ca=D.EwaSettings.xa(23)?he.ckh(Ca.workbookContext.FullDocumentInfo.InteractiveReportsApiUrl).task:ea.a.loadScript(80,4,1,!0);
return oa.TaskExtensions.za(Ca,()=>{try{InteractiveReportAPI.InitScript(pf.c,pf.b)}catch(Hb){throw Hb;}},ea.a.ka)}static ckh(Ca){const Hb=new bd.a;if(!Ca)return e.ULS.sendTraceTag(537155588,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: interactive report api url is null"),Hb.setException(Error.create("apiUrl is null")),Hb;Qa.a.PRe(Ca,(cc,ca)=>{ca.succeeded?Hb.setResult(!0):(Hb.setException(Error.create("Network")),e.ULS.sendTraceTag(537155585,0,10,`InteractiveReportView.CreateApiLoadAndInitializeTask: script ${Ca} failed to load successfully`))},
4,!0);return Hb}}he.Wni="&EnableHyperlinks=false";he.Xni="&EmbeddedView=true";he.Tni="&BIPreview=true";he.hoi="WORKBOOKURL";he.coi="ServiceName";he.doi="ExcelServices";he.Uni="culture";he.eoi="uiculture";he.bCi=3E4;he.ala=[];Object(b.a)(he,"InteractiveReportView",nb.a,[]);var Va=a(122),bc=a(1009),yc=a(214),Hc=a(85);class Zc extends Va.a{constructor(Ca,Hb){super(Ca,Hb)}execute(Ca){const Hb=Object(d.a)(9,Ca.Ke),cc=ea.a.current.SK;Ca.activityState[Hc.a.VL]=Hc.a.A$a;Ca.activityState[Hc.a.p2]=Zc.pgh(Hb,
cc.OfferPowerBiTrialUrl,cc.OfferPowerBiTrialCompleteSignUpParameter);Ca.activityState[Hc.a.vXc]=!0;Hb.Yk.Qy("PowerBiTrial");return 3}static pgh(Ca,Hb,cc){Ca=new Sys.StringBuilder(Ca.isEditMode?Ca.workbookContext.FullDocumentInfo.HostEditUrl:Ca.workbookContext.FullDocumentInfo.HostViewUrl);yc.a.Qk(Ca,bc.a.vej,"1");Ca=encodeURIComponent(Ca.toString());return`${Hb}&${"ru"}=${cc}${encodeURIComponent(`?${"returnUrl"}=${Ca}`)}`}}Object(b.a)(Zc,"OfferPowerBiTrialActivity",Va.a,[]);class Sd extends pb.a{constructor(){super();
this.Gb()}create(){this.qb(new Zc(Ae.a.SXd,Ae.a.A_))}static la(Ca){Ca.da.Ha(79,new Sd)}}Object(b.a)(Sd,"OfferPowerBiTrialFactory",pb.a,[]);var ue=a(1325),Fe=a(73),Be=a(59),Ua=a(593);const Rb=(Ca,Hb,cc,ca,ia,Sb,Oc,td=null)=>{td=Ca.Oa(41,td);td.activeCell=Hb;td.showDrillInIndicator=cc;return A.g(Ca,"PivotTableShowExpandButton",td,ca,ia,Sb,Oc,0)},sc=(Ca,Hb,cc,ca,ia,Sb,Oc=null)=>{Oc=Ca.Oa(41,Oc);Oc.activeCell=Hb;return A.g(Ca,"PivotTableShowDetails",Oc,cc,ca,ia,Sb,0)},Mc=(Ca,Hb,cc,ca,ia,Sb,Oc,td,Jd,qe=
null)=>{qe=Ca.Oa(41,qe);qe.activeCell=Hb;qe.option=cc;qe.userInputText=ca;qe.userInputInt=ia;return A.g(Ca,"PivotTableSettingsPaneOperations",qe,Sb,Oc,td,Jd,0)};class id{constructor(Ca){this.activeCell=this.hc=null;this.I3i=Hb=>{La.a(Hb)||(Hb=this.$.ua.getItemByName(Hb.Result.toString()),D.EwaSettings.isChangeGateEnabled("OfficeVSO:7288763_FixGarbageSheetNameValueShowDetails")?(null===Hb||void 0===Hb?0:Hb.name)&&Hb.activate():Hb&&Hb.activate(),Hb=document.querySelector(".ewa-stb-tabs .tab-active"),
this.R_j(Hb))};this.yYi=Hb=>{Hb&&!db.a.Zf(Hb.Errors)&&this.Xwd(Hb.Result)};this.xYi=()=>{};this.AYi=Hb=>{Hb&&!db.a.Zf(Hb.Errors)&&this.Ywd(Hb.Result)};this.zYi=()=>{};this.wYi=(Hb,cc)=>{Hb&&!db.a.Zf(Hb.Errors)&&this.Swd(Hb.Result,cc)};this.vYi=()=>{};this.$=Ca;this.ha=P.h(this.$).ha}Mc(){return!1}executeCommand(Ca,Hb,cc){Ca=oa.TaskExtensions.Yj();const ca=Hb.command,ia=this.$.pa.va;let Sb=null,Oc=1;const td=this.$.pa.va.$b();this.activeCell=Da.o(this.ha.ra.activeCell,this.$);this.hc=P.h(this.$).tb.fp(this.ha.ra.activeCell);
switch(ca){case 498319061:e.ULS.sendTraceTag(537154699,0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.hc)return Ca;Sb=(Jd,qe,Ie)=>Rb(ia,this.activeCell,!this.hc.showDrillIndicators,Jd,qe,Ie,null,td);Oc=218;break;case 1529441790:oa.TaskExtensions.za(wa.GetServiceTaskFactory.Pa(this.$.da,441,442,0),Jd=>{(Jd=Jd.result)&&Jd.cOj()},this.$.ka,3);break;case -1556797033:this.hc&&this.Gjd(this.yYi,this.xYi);break;case -1611233597:this.hc&&this.Gjd(this.AYi,this.zYi);
break;case 786260386:this.hc&&(cc=Number.parseInvariant(cc.MenuItemId),this.Gjd(this.wYi,this.vYi,cc));break;case 1771091375:this.showDetails();break;default:Ca=rb.a(ca)}Sb&&(Ca=Ee.a(this.$.userOperationManager,Sb,Jd=>new lb.a(Oc,0,Jd,void 0,null),Hb));return Ca}Ac(Ca,Hb){Ca=!1;switch(Hb.command){case 498319061:case 1529441790:case -1556797033:case 786260386:case -1611233597:Ca=!0;break;case 1771091375:Ca=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return Ca}Rc(){return!1}dispose(){this.$=
null}showDetails(){Ee.a(this.$.userOperationManager,(Ca,Hb,cc)=>sc(this.$.pa.va,this.activeCell,va.b(Ca,this.I3i),Hb,cc,null),Ca=>new lb.a(262,0,Ca,void 0,null),null)}R_j(Ca){const Hb=de.a.instance.Tb("Common.ISystemInitiatedFeedback");Hb&&Ca?(Hb.execute(cc=>{cc.logActivity("TeachingUIForShowDetails",null)}),e.ULS.sendTraceTag(523613786,0,50,"TeachingUIForShowDetails triggered an LPP activity")):e.ULS.sendTraceTag(523613787,0,15,"TeachingUIForShowDetails failed to get a sifFuture")}Gjd(Ca,Hb,cc=0){this.$.userOperationManager.Oc(new lb.a(1016,
0,(ca,ia,Sb)=>A.q(this.$.pa.va,this.activeCell,this.hc.externalSourceIndex,this.hc.pivotTableName,this.$.domElement.id,this.$.isChromeRtl,this.$.workbookContext.NovMode,va.b(ca,Ca),va.a(ia,Hb),Sb,0!==cc?cc:null,null,!0),16),null)}Xwd(Ca){if(this.ovd(Ca))if(this.pvd(Ca)){var Hb=Ca.PivotFields[0];if(this.kvd(Hb)){var cc={};cc.FieldId=Hb.IdString;cc.Location=this.activeCell;cc.DataSourceIndex=this.hc.externalSourceIndex;cc.SelectedFieldIndex=Hb.SortByValueIndex;var ca=Hb.DisplayString;ca.length>ue.n&&
(ca=ca.substring(0,ue.n)+"...");cc.ColumnName=z.a.Og(ca);cc.SortAscend=Hb.IsSortedAscending&&Hb.IsSortedByValue;Ca=Object(nc.a)(new Ua.a,{pivotName:this.hc.pivotTableName,YOb:cc,kua:this.bka(Ca.PivotDataItems,!1),lua:this.bka(Ca.PivotDataItems,!0)});this.$.Yc(-1681601147,Fe.a.zb,0,{["launchSortByValueDialogCommandData"]:Ca})}else this.vj(154,"AutoFilterSortByValueIncorrectSelection")}else this.vj(750,"SortByValueNoDataFields")}Ywd(Ca){if(this.ovd(Ca))if(this.pvd(Ca)){var Hb=Ca.PivotFields[0];if(this.kvd(Hb)){var cc=
{};cc.FilterType=ue.e;cc.AdvancedFilter=Ca.AdvancedFiltering;cc.Location=this.activeCell;cc.DataSourceIndex=this.hc.externalSourceIndex;cc.MaxCount=ue.a;cc.Title=Hb.DisplayString;cc.IsPivotFilter=!0;cc.FieldId=Hb.IdString;cc.AnchorType=0;(Hb=Hb.FilterParameter)?(cc.Count=0<Hb.FilterValue?Hb.FilterValue.toString():"",cc.Top=Hb.IsTopFilter,cc.Type=Hb.FilterType,cc.SelectedFieldIndex=ue.g(Ca.PivotDataFields,Hb.DataFieldId)):(cc.Count=ue.b,cc.Top=!0,cc.Type=1,cc.SelectedFieldIndex=ue.o);Hb=new zb.a(856841605,
Fe.a.zb,this.$.xc,0,null);var ca={};ca.Top10FilterParameters=cc;ca.PivotName=this.hc.pivotTableName;ca.DataFieldIds=this.bka(Ca.PivotDataFields,!1);ca.DataFieldNames=this.bka(Ca.PivotDataFields,!0);Ca={};Ca[Fe.a.Sf]=Be.a.Ec(ca);this.$.Ia.Hb(Hb,Ca)}}else this.vj(246,"ValueFilterNoDataFields")}ovd(Ca){return 1===Ca.PivotFields.length}pvd(Ca){return 0<Ca.PivotDataFields.length&&0<Ca.PivotDataItems.length}kvd(Ca){return!Ca.IsDataField&&!Ca.IsFieldInPageFilterArea}Swd(Ca,Hb){if(this.ovd(Ca))if(ue.m(Hb)&&
!this.pvd(Ca))this.vj(246,"ValueFilterNoDataFields");else{var cc=Ca.PivotFields[0];if(this.kvd(cc)){var ca=this.WKh(cc.PivotFilterParameters,Hb),ia={};ia.ActiveCompareType=this.fmh(Hb);ia.ShowDataFields=ue.m(Hb);ia.FilterType=this.SYh(Hb);ia.ValueTypeText=ue.j(Hb);ia.Location=this.activeCell;ia.ColumnName=cc.DisplayString;ia.IsPivotFilter=!0;ia.IsTimeSlicer=!1;ia.NonNumericCaptionFilteringEnabled=cc.IsNonnumericCaptionFilteringEnabled;ia.FieldId=cc.IdString;ia.AnchorType=0;ia.ControlGroupOrder=ue.h();
ia.ShowWholeDays=cc.IsDateField&&!ue.m(Hb);ia.EnabledWholeDays=cc.IsEnabledWholeDays;ia.WholeDays=cc.IsWholeDays;ia.MemberProperties=!1;ia.SelectedFieldIndex=ue.o;ca&&(ue.m(Hb)||cc.IsDataField?(ia.Value1=ca.FilterValue1.toString(),ia.Value2=ca.FilterValue2.toString(),ue.m(Hb)&&(ia.SelectedFieldIndex=ue.g(Ca.PivotDataFields,ca.DataFieldId))):(ia.Value1=ca.FilterString1,ia.Value2=ca.FilterString2));Hb=new zb.a(-2042011094,Fe.a.zb,this.$.xc,0,null);ca={};ca.CustomFilterParameters=ia;ca.FieldId=cc.IdString;
ca.PivotName=this.hc.pivotTableName;ca.DataFieldIds=this.bka(Ca.PivotDataFields,!1);ca.DataFieldNames=this.bka(Ca.PivotDataFields,!0);Ca={};Ca[Fe.a.Sf]=Be.a.Ec(ca);this.$.Ia.Hb(Hb,Ca)}}}bka(Ca,Hb){const cc=[];for(let ca=0;ca<Ca.length;++ca)Hb?cc.push(Ca[ca].DisplayString):cc.push(Ca[ca].IdString);return cc}fmh(Ca){switch(Ca){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;
case 13:case 21:case 64:return 9;case 14:case 22:case 27:return 10;case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;case 17:case 25:case 65:return 13}return 14}SYh(Ca){return ue.j(Ca)?ue.c:ue.m(Ca)?ue.f:ue.k(Ca)?ue.d:""}WKh(Ca,Hb){for(let cc=0;cc<Ca.length;++cc)if(Ca[cc].FilterType===Hb)return Ca[cc];return null}vj(Ca,Hb){Ca=db.a.hd(1,0,0,Ca,0,0,Hb);Je.a(this.$).vj(Ca)}}Object(b.a)(id,"PivotCommandHandler",null,[222,3]);class Ed extends Nb.a{constructor(Ca){super(Ca)}ld(){const Ca=
wa.GetServiceTaskFactory.create(this.$.da,128,this.ka,this.Na);this.$.jz(()=>{D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)?oa.TaskExtensions.za(oa.TaskExtensions.Md([Ca],this.ka),()=>{this.fd([new id(this.$)])},this.ka,3):this.fd([new id(this.$)])})}static la(Ca){Ca.da.Ha(345,new Ed(Ca))}}Object(b.a)(Ed,"PivotCommandHandlerFactory",Nb.a,[]);class ee{constructor(Ca,Hb,cc,ca,ia){this.pivotTableName=this.activeCell=null;this.opType=0;this.userInputText=null;
this.userInputInt=0;this.activeCell=Ca;this.pivotTableName=Hb;this.opType=cc;this.userInputText=ca;this.userInputInt=ia}getActiveCell(){return this.activeCell}}Object(b.a)(ee,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[123]);class oe{constructor(){this.pPf=0;this.qPf=null}}Object(b.a)(oe,"PivotTableSettingsPaneOperationsUserContext",null,[]);class Xe{constructor(){this.onSettingChange=this.settingsInfo=this.type=null;this.hasLessThanTwoRowFields=this.expandAllByDefault=this.isNativePivotTable=
this.isRangeChanged=!1;this.onSaveSectionCollapseState=this.sectionCollapseStates=null;this.needFocusOnFirstElement=!1}}Object(b.a)(Xe,"PivotTableSettingsTaskPaneProps",null,[]);class mf{constructor(Ca,Hb){this.$=Ca;this.pivotTableSettingsPaneManager=Hb}lL(Ca){Pb.UISurfaces.mj().then(Hb=>{Hb.showTaskPane("PivotTableSettingsTaskPane",this.pu(null,Ca,!1,!1,!1,null,!1));return null})}LB(Ca,Hb,cc,ca,ia,Sb,Oc){Pb.UISurfaces.mj().then(td=>{td.updateTaskPane("PivotTableSettingsTaskPane",this.pu(Ca,Hb,cc,
ca,ia,Sb,Oc));return null})}mK(){Pb.UISurfaces.mj().then(Ca=>{Ca.hideTaskPane("PivotTableSettingsTaskPane",2);return null})}pu(Ca,Hb,cc,ca,ia,Sb,Oc){Ca=Object(nc.a)(new Xe,{type:"PivotTableSettingsTaskPaneProps",settingsInfo:Ca,isRangeChanged:cc,isNativePivotTable:ca,expandAllByDefault:!0,hasLessThanTwoRowFields:ia,sectionCollapseStates:this.pivotTableSettingsPaneManager.sectionCollapseStates,needFocusOnFirstElement:Oc,onSaveSectionCollapseState:(td,Jd)=>{this.pivotTableSettingsPaneManager.onSaveSectionCollapseState(td,
Jd)},onSettingChange:(td,Jd,qe)=>{this.pivotTableSettingsPaneManager.m1i(td,Jd,qe,Sb)}});if(qa.a.Gd(this.$))return Object(nc.a)(new oc.a,{contentProps:Ca,onOpen:()=>{this.pivotTableSettingsPaneManager.lI()},onClose:()=>{this.pivotTableSettingsPaneManager.Dz()},onManualClose:()=>{this.pivotTableSettingsPaneManager.sFd()},title:S.a.instance.ga(1078),width:320,enableResize:!0,minResizeWidth:320,maxResizeWidth:900});Hb=Object(nc.a)(new Ic.a,{type:"ExcelLegacyTaskPaneProps",container:Hb,paneProps:Ca});
return Object(nc.a)(new oc.a,{contentProps:Hb,onOpen:()=>{this.pivotTableSettingsPaneManager.lI()}})}}Object(b.a)(mf,"PivotTableSettingsReactTaskPane",null,[572]);class wf{constructor(){this.pivotTableName=null;this.rwGrandTotalOn=this.colGrandTotalOn=!1;this.indentIncrement=0;this.displayNullString=this.displayErrorString=this.showItemsWithNoDataOnCol=this.showItemsWithNoDataOnRw=this.showDrillIndicators=this.autoFormatOnUpdate=!1;this.nullString=this.errorString=null;this.refreshOnLoad=this.saveSourceDataWithFile=
!1;this.slicerConnections=this.altTextSummary=this.altText=null}}Object(b.a)(wf,"PivotTableSettingsInfo",null,[]);class Kf{constructor(){this.enabled=!1;this.caption=this.sheet=this.name=null}}Object(b.a)(Kf,"SlicerConnectionItem",null,[]);class af{constructor(Ca){this.$sc=this.RIb=this.pivotTableSettingsTaskPane=null;this.dh=!1;this.xda="";this.gAa=!1;this.XQf=0;this.o3=this.ina=this.w7b=this.WQf=null;this.Zr=this.hPa=!1;this.n1i=(Hb,cc)=>{if(La.a(Hb)){const ca=Hb.Errors[0].Description;Hb=Hb.Errors[0].MessageId;
const ia=cc.pPf;cc=cc.qPf;let Sb=this.rka();if(!Sb||cc!==Sb.qda)if(this.ina&&cc===this.ina.qda)Sb=this.ina;else{e.ULS.sendTraceTag(537154689,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${ia}`);return}switch(ia){case 1:Sb.pivotTableName=this.xda;break;case 2:Sb.rwGrandTotalOn=this.gAa;break;case 3:Sb.colGrandTotalOn=this.gAa;break;case 12:Sb.errorString=this.xda;break;case 13:Sb.nullString=this.xda;break;case 14:Sb.saveSourceDataWithFile=this.gAa;break;case 15:Sb.refreshOnLoad=
this.gAa;break;case 16:Sb.altText=this.xda;break;case 17:Sb.altTextSummary=this.xda;break;case 20:Sb.indentIncrement=this.XQf}e.ULS.sendTraceTag(537154688,0,50,`OnPivotTableSettingsChangedSuccessCallback encounters error ${Hb} ${ca} for opType: ${ia}`);this.updateTaskPane(this.rka())}};this.AHb=()=>{this.hideTaskPane(!0)};this.F_=()=>{const Hb=this.gridView.inRangePicker||this.gridView.ei||!!(this.ha.Oe&470);qa.a.Gd(this.$)?(this.Oq()&&!Hb&&this.Mlg(),this.MFc()):this.dh&&!Hb&&(this.Mlg(),this.o3!==
this.ina&&this.o3&&this.updateTaskPane(this.rka(),!0))};this.Sq=()=>{qa.a.Gd(this.$)?(this.Oq()&&(this.o3=this.rka()),this.MFc()):this.dh&&(this.o3=this.rka(),this.updateTaskPane(this.o3))};this.$=Ca;this.gridView=P.h(this.$);this.gmi(Ca);this.ha=this.gridView.ha;this.ha.vA(this.F_);this.gridView.uE(this.F_);this.gridView.BT(this.Sq);this.RL=Array(6);for(Ca=0;Ca<this.RL.length;Ca++)this.RL[Ca]=!1}get sectionCollapseStates(){return this.RL}get n_a(){return this.$.ic.G2(4128)&&this.o_a}get o_a(){const Ca=
new wb.a(this.$.ua);return this.$.isEditMode&&Ca.Td(8192)||!Ca.Xh}cOj(){if(qa.a.Gd(this.$))this.dh?(this.Zr=!1,this.hideTaskPane(!0)):(this.Zr=!0,this.showTaskPane(!0)),this.$.tf();else if(this.pivotTableSettingsTaskPane)this.pivotTableSettingsTaskPane.Sg(!this.dh),this.dh?this.hideTaskPane(!0):this.showTaskPane(!0);else{const Ca=wa.GetServiceTaskFactory.Pa(this.$.da,346,347,0),Hb=ob.a(this.$);oa.TaskExtensions.za(oa.TaskExtensions.Md([Ca,Hb],this.$.ka),()=>{this.pivotTableSettingsTaskPane=Ca.result;
Hb.result.VQ(this.pivotTableSettingsTaskPane);this.u6();this.pivotTableSettingsTaskPane.Sg(!0);this.showTaskPane(!0)},this.$.ka,3)}}onSaveSectionCollapseState(Ca,Hb){this.RL&&0<=Ca&&Ca<this.RL.length&&(this.RL[Ca]=Hb)}m1i(Ca,Hb,cc,ca){let ia=this.w7b,Sb=this.o3;if(!Sb||ca!==Sb.qda)if(this.ina&&ca===this.ina.qda)Sb=this.ina,ia=this.WQf;else{e.ULS.sendTraceTag(537154690,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${Ca}`);return}switch(Ca){case 1:this.xda=Sb.pivotTableName;Hb=
255<Hb.length?Hb.substring(0,255):Hb;Sb.pivotTableName=Hb;break;case 2:this.gAa=Sb.rwGrandTotalOn;Sb.rwGrandTotalOn=!!cc;break;case 3:this.gAa=Sb.colGrandTotalOn;Sb.colGrandTotalOn=!!cc;break;case 6:Sb.autoFormatOnUpdate=!!cc;break;case 7:Sb.showDrillIndicators=!!cc;break;case 8:Sb.showItemsWithNoDataOnRw=!!cc;break;case 9:Sb.showItemsWithNoDataOnCol=!!cc;break;case 10:Sb.displayErrorString=!!cc;break;case 11:Sb.displayNullString=!!cc;break;case 12:this.xda=Sb.errorString;Sb.errorString=Hb;break;
case 13:this.xda=Sb.nullString;Sb.nullString=Hb;break;case 14:this.gAa=Sb.saveSourceDataWithFile;Sb.saveSourceDataWithFile=!!cc;break;case 15:this.gAa=Sb.refreshOnLoad;Sb.refreshOnLoad=!!cc;break;case 16:this.xda=Sb.altText;Sb.altText=Hb;break;case 17:this.xda=Sb.altTextSummary;Sb.altTextSummary=Hb;break;case 20:this.XQf=Sb.indentIncrement,Sb.indentIncrement=cc}e.ULS.sendTraceTag(595125196,0,50,`OnPivotTableSettingsChanged for opType: ${Ca}`);this.$.userOperationManager.Oc(new lb.a(225,0,(Oc,td,Jd)=>
{const qe=new oe;qe.pPf=Ca;qe.qPf=ca;return Mc(this.$.pa.va,ia,Ca,Hb,cc,va.b(Oc,this.n1i),td,Jd,qe)},64,()=>new ee(ia,Sb.pivotTableName,Ca,Hb,cc)),null)}gmi(Ca){this.RIb=new mf(Ca,this)}u6(){this.$sc=this.pivotTableSettingsTaskPane.jU();this.pivotTableSettingsTaskPane.DT(this.AHb)}dispose(){this.ha.TF(this.F_);this.gridView.VF(this.F_);this.gridView.YN(this.Sq);this.$=this.gridView=this.ha=null;this.hideTaskPane();this.pivotTableSettingsTaskPane&&(this.pivotTableSettingsTaskPane.zW(this.AHb),this.pivotTableSettingsTaskPane=
this.$sc=null);this.RL=this.RIb=null}lI(){this.w7b=Da.o(this.ha.ra.activeCell,this.$);this.o3=this.rka();this.updateTaskPane(this.rka())}Dz(){this.hideTaskPane()}sFd(){this.Zr=!1;this.hideTaskPane(!0);this.$.tf()}Oq(){return this.n_a&&this.Zr}Et(){const Ca=P.h(this.$).tb.fp(this.ha.ra.activeCell);return!(this.ha.Oe&470)&&!!Ca&&!Ca.YNa(!0)&&this.Zr}showTaskPane(Ca=!1){Ca&&(this.hPa=!0,e.ULS.sendTraceTag(537154659,0,50,"PivotTable settings pane is opened by the user."));this.dh=!0;this.RIb.lL(this.$sc)}updateTaskPane(Ca,
Hb=!1){if(this.dh&&Ca&&!Ca.YNa(!0)){var cc=new wf;cc.pivotTableName=Ca.KKd;cc.colGrandTotalOn=Ca.colGrandTotalOn;cc.rwGrandTotalOn=Ca.rwGrandTotalOn;cc.indentIncrement=Ca.indentIncrement;cc.autoFormatOnUpdate=Ca.autoFormatOnUpdate;cc.showDrillIndicators=Ca.showDrillIndicators;cc.showItemsWithNoDataOnRw=Ca.showItemsWithNoDataOnRw;cc.showItemsWithNoDataOnCol=Ca.showItemsWithNoDataOnCol;cc.displayErrorString=Ca.displayErrorString;cc.errorString=Ca.errorString;cc.displayNullString=Ca.displayNullString;
cc.nullString=Ca.nullString;cc.saveSourceDataWithFile=Ca.saveSourceDataWithFile;cc.refreshOnLoad=Ca.refreshOnLoad;cc.altText=Ca.altText;cc.altTextSummary=Ca.altTextSummary;cc.slicerConnections=this.BQj(Ca.slicerConnections);this.RIb.LB(cc,this.$sc,Hb,!Ca.isOlap,!Ca.cL||2>Ca.cL.length,Ca.qda,this.hPa);this.hPa=!1}}hideTaskPane(Ca=!1){this.dh=!1;this.RIb.mK();Ca&&e.ULS.sendTraceTag(537154658,0,50,"PivotTable settings pane is closed by the user.")}BQj(Ca){const Hb=new tc.a;if(Ca)for(let cc=0;cc<Ca.length;cc++){const ca=
Ca[cc],ia=new Kf;ia.name=ca.Name;ia.caption=ca.Caption;ia.sheet=ca.WorksheetName;ia.enabled=ca.Enabled||!1;Hb.add(ia)}return Hb.toArray()}rka(){return this.gridView.tb.fp(this.ha.ra.activeCell)}MFc(){this.Oq()&&this.Et()?this.dh?this.o3!==this.ina&&this.o3&&this.updateTaskPane(this.rka(),!0):this.showTaskPane():this.dh&&this.hideTaskPane()}Mlg(){this.WQf=this.w7b;this.ina=this.o3;this.w7b=Da.o(this.ha.ra.activeCell,this.$);this.o3=this.rka()}}Object(b.a)(af,"PivotTableSettingsPaneManager",null,[553,
3]);class Wf extends pb.a{constructor(Ca){super();this.$=Ca;this.Gb()}create(){this.qb(this.$.da.Ba(441)||this.$.da.Ha(441,new af(this.$)))}static la(Ca){Ca.da.Ha(442,new Wf(Ca))}}Object(b.a)(Wf,"PivotTableSettingsPaneManagerFactory",pb.a,[]);class Gf{}Gf.GBh="ewa-ptsp-pane";Gf.FBh="ewa-ptsp-header";Gf.HBh="ewa-ptsp-title";Gf.DBh="ewa-ptsp-body";Gf.EBh="ewa-ptsp-close-button";Object(b.a)(Gf,"CssClassNames",null,[]);const cg=Gf.GBh,Ha=Gf.FBh,yb="cui-taskPaneTitle "+Gf.HBh,Xb=Gf.DBh,wc=Gf.EBh;class Vc extends C.a{constructor(Ca,
Hb,cc){super(Ca);this.sFe=this.De=null;this.Qv=0;this.Zr=!1;this.yc=(ca,ia)=>{ia.Ef||this.Sg(!1)};this.tl=()=>{this.Sg(!1);this.raiseEvent("PivotTableSettingsTaskPaneClosed");return!0};this.$=Hb;this.taskPaneManager=cc;this.$.ij(this.yc);this.ha=P.h(this.$).ha;w.a(Hb).fi(this)}ET(Ca){this.get_events().addHandler("PivotTableSettingsTaskPaneRemoved",Ca)}AW(Ca){this.get_events().removeHandler("PivotTableSettingsTaskPaneRemoved",Ca)}DT(Ca){this.addHandler("PivotTableSettingsTaskPaneClosed",Ca)}zW(Ca){this.removeHandler("PivotTableSettingsTaskPaneClosed",
Ca)}get isVisible(){return super.isVisible}set isVisible(Ca){super.isVisible!==Ca&&(super.isVisible=Ca)}get If(){return this.isVisible}get ee(){return la.a.h$i}get Qh(){return 14}get jk(){return y.a.RWe}get QQ(){return S.a.instance.ga(1078)}get titleText(){return S.a.instance.ga(1078)}get Xp(){return 320}get isResizable(){return!0}get mc(){return this.domElement}get height(){return this.taskPaneManager.DO.offsetHeight}get n_a(){return this.$.ic.G2(4128)&&this.o_a}get o_a(){const Ca=new wb.a(this.$.ua);
return this.$.isEditMode&&Ca.Td(8192)||!Ca.Xh}Oq(){return this.n_a&&this.Zr}Et(){const Ca=P.h(this.$).tb.fp(this.ha.ra.activeCell);return!(this.ha.Oe&470)&&!!Ca&&!Ca.YNa(!0)&&this.Zr}ZV(){}Bj(){}ik(){}jV(){return!1}dispose(){this.$&&this.$.$k(this.yc);this.De&&(O.a.instance.Aa(x.a.click,this.De,this.tl),Ga.KeyInputManager.instance.ix(this.De,this.sFe));this.De=this.taskPaneManager=this.$=null;super.dispose()}eg(Ca,Hb){if(!Hb){Ca=H.DOMElementExtensions.getElementById(this.domElement,"PivotTableName");
if(!Ca&&(Ca=H.DOMElementExtensions.Dl(this.domElement.querySelectorAll(H.DOMElementExtensions.Hq)),!Ca))return!1;H.DOMElementExtensions.setFocus(Ca)}return!Hb}Bh(Ca){return H.DOMElementExtensions.Df(this.mc,Ca)}Sg(Ca){this.Zr=Ca;const Hb=this.taskPaneManager;this.isVisible=Ca;this.taskPaneManager.KB();const cc=!!this.taskPaneManager.Lh&&14===this.taskPaneManager.Lh.taskPane.Qh;Ca&&0<Hb.RD.length&&(!cc||Hb.isCollapsed)&&Hb.yI(this,!0);this.$.tf()}jU(){const Ca=document.getElementById(this.$.Cb+v.a.THd);
var Hb=this.vM();Ca.appendChild(Hb);Hb=xd.b("div","PivotTableSettingsPaneBodyId",Xb);Ca.appendChild(Hb);return Hb}vM(){const Ca=xd.b("div","PivotTableSettingsPaneHeaderId",Ha),Hb=xd.b("span","PivotTableSettingsPaneTitleId",yb);Hb.innerText=this.titleText;this.De=ma.a.ob("PivotTableSettingsPaneCloseButtonId",wc,S.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.De.classList.add(vb.AFrameworkApplication.isRtl?v.a.yja:v.a.zja);O.a.instance.ta(x.a.click,this.De,this.tl);this.sFe=Ga.KeyInputManager.instance.Mt(this.De,
this.tl,Ka.a.Sh);Ca.appendChild(Hb);Ca.appendChild(this.De);return Ca}static la(Ca,Hb){var cc=Ca.Cb;let ca=document.getElementById(cc+v.a.THd);ca||(ca=document.createElement("div"),ca.id=Ca.Cb+v.a.THd,ca.classList.add(cg),document.getElementById(cc+v.a.SV).appendChild(ca));cc=Ca.da;return cc.Ba(346)||cc.Ha(346,new Vc(ca,Ca,Hb))}}Object(b.a)(Vc,"PivotTableSettingsTaskPane",C.a,[552,3,457,63]);class yd extends pb.a{constructor(Ca){super();this.hh=this.gi=null;this.$=Ca;this.Gb()}get yD(){this.gi||(this.gi=
oa.TaskExtensions.za(ob.a(this.$),Ca=>{this.hh=Vc.la(this.$,Ca.result)},this.ka,3));return this.gi}create(){const Ca=wa.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),Hb=wa.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);oa.TaskExtensions.za(oa.TaskExtensions.ts(oa.TaskExtensions.Md([Ca,Hb],this.ka),()=>this.yD,this.ka),()=>{this.qb(this.hh)},this.ka,3)}dispose(){this.hh=this.gi=this.$=null;super.dispose()}static la(Ca){Ca.da.Ha(347,new yd(Ca))}}Object(b.a)(yd,"PivotTableSettingsTaskPaneFactory",
pb.a,[]);class Od extends Nb.a{constructor(Ca){super(Ca)}ld(){oa.TaskExtensions.za(wa.GetServiceTaskFactory.create(this.$.da,472,this.ka,this.Na),()=>{const Ca=this.$.da.Ba(13);this.fd([Ca])},this.$.ka,3)}static la(Ca){Nb.a.Rd(78,new Od(Ca))}}Object(b.a)(Od,"BICommandHandlerFactory",Nb.a,[]);var be=a(654),Qb=a(39),zc=a(841),Yc=a(325),zd=a(363),ke=a(427);class Td{constructor(Ca,Hb){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=Ca;this.pivotTableName=Hb}}Object(b.a)(Td,"MacroRecorderPivotTableRefreshedPayload",
null,[123]);var Ge=a(402);class bf extends Ge.a{constructor(Ca,Hb,cc,ca,ia=Ge.a.u9c,Sb=null){super(Ca,Hb,cc,ca,ia,Sb)}get Nza(){return 4}get hMb(){return!!(this.flags&64)}}Object(b.a)(bf,"DepartableRefreshWebMethodOperation",Ge.a,[]);var Fa=a(164);class aa extends Fa.ErrorDialog{constructor(Ca,Hb){super(Ca,aa.DQ(Hb))}fq(){super.fq();this.fpa=String.format(S.a.instance.Ua(7),null)}static DQ(Ca){const Hb=db.a.hd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");Hb.Description=Ca;Hb.HelpDescription=S.a.instance.ga(1319);
Hb.HelpTopicId=zc.a.z5c;return Hb}}Object(b.a)(aa,"DataRefreshConfirmationDialog",Fa.ErrorDialog,[]);const Xa=(Ca,Hb,cc,ca,ia,Sb,Oc,td,Jd)=>{const qe=td?"RefreshAllDirtyDataSources":"RefreshAll";Jd=Ca.Oa(1,Jd);const Ie=Jd.context;Ie.RequestId=cc;Ie.CompleteResponseTimeout=ca;Jd.periodic=Hb;return A.g(Ca,qe,Jd,ia,Sb,Oc,td,Hb?8:0)};var Lb=a(352);class kc extends l.a{constructor(Ca){super();this.Vsc=null;this.Jcb=!1;this.sAa=null;this.RLd=!1;this.Ra=new Qb.a;this.Gx=null;this.EFg=new Map;this.tQa=new Map;
this.XXb=[];this.Fz=(cc,ca)=>{2===ca.Uq?this.tQa.clear():1===ca.Uq&&this.tQa&&this.tQa.forEach((ia,Sb)=>{ca.Gf==ia&&this.tQa.delete(Sb)})};this.goi=cc=>{this.U_c(cc.Ca)};this.j4g=()=>{this.ATd(0);this.YVf(!0,null,!1)};this.h1i=cc=>{cc.RequestId||(this.wbb=null,this.$.ea.$n(cc.Errors))};this.i1i=cc=>{this.wbb=null;cc=X.a.Ue(cc.data);this.$.ea.$n(cc)};this.AJf=cc=>{this.BJf(cc);(cc.DepartableWebMethodOperationCompleted||cc.Errors&&0<cc.Errors.length)&&this.Ra.raiseEvent("refreshAllCompleted",cc,this)};
this.NYi=cc=>{cc&&!La.a(cc)&&(!(cc=cc.Result)||1>cc.length||(this.Gx&&this.Gx.cancel(),this.Gx=new be.a,this.njg(cc,0,this.Gx.token)))};this.MYi=cc=>{e.ULS.sendTraceTag(537163298,306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");cc=X.a.Ue(cc.data);this.$.ea.$n(cc)};this.Zc=()=>{this.gqd()};this.JF=()=>{D.EwaSettings.isChangeGateEnabled("OfficeVSO:6013906_MarkRefreshRangeInvalidWhenCurrentSheetIsChanged")&&this.gqd()};this.Y$a=(cc,ca)=>{const ia=ca.dd.block;var Sb=ia.ae.PeriodicRefreshExpiryInSeconds;
void 0!==Sb&&this.x8f(Sb);Sb=P.h(this.$);5===ia.state&&cc===Sb.Ca&&((cc=(cc=Sb.NB(ca.dd.hash))?cc.Be:null)&&!cc.vd(Sb.ha.ra.activeCell)||this.gqd())};this.Wc=()=>{this.$.ea.Yb||this.clear()};this.$=Ca;this.LHd=-1;this.wbb=null;Ca=P.h(this.$);const Hb=Ca.ha;Hb.$L(this.Zc);Hb.hha(this.Zc);Ca.Ca.N9(this.Y$a);this.$.ua.Fsa(this.JF);this.$.Bb.Fsa(this.JF);this.$.userOperationManager.jr(this.Fz);this.U_c(Ca.Ca);this.U_c(Wb.a(this.$).Ca);this.$.da.hb(36,this.goi);this.$.ea.Oj(this.Wc);Ca=this.$.ya.StartupDelayMultiplierForLabelsOnRefreshOnOpen*
this.$.ya.TimeToWaitForApplyingSensitivityLabels;e.ULS.sendTraceTag(537163332,306,50,`DataRefreshManager async call to UpdateSensitivityLabels after ${Ca} ms.`);bb.a.instance.create(()=>{this.dRb()},Ca,Za.a.xmh,!0,!0)}lte(Ca){this.Ra.addHandler("refreshCompleted",Ca)}Wre(Ca){this.Ra.addHandler("beforeSingleRefreshStarted",Ca)}wYf(Ca){this.Ra.removeHandler("beforeSingleRefreshStarted",Ca)}kZc(Ca){this.Ra.addHandler("singleRefreshCompleted",Ca)}ZNd(Ca){this.Ra.removeHandler("singleRefreshCompleted",
Ca)}get Knf(){return!!this.BLa()||kc.AHe(this.$)||kc.Ltd(this.$)}get WLd(){return this.XXb}get MLd(){return this.EFg}get confirmationRequired(){return this.$.ic.refreshConfirmationRequired}Mc(){return!1}executeCommand(Ca,Hb,cc,ca){Ca=Hb.command;switch(Ca){case -1193102612:this.YVf(!1,Hb,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===cc.SourceControlId);break;case 2054778433:this.refreshSelected(Hb,ca);break;default:return rb.a(Ca)}return Ab.Task.Ta(!0)}Ac(Ca,Hb){Ca=!1;switch(Hb.command){case 2054778433:case -1193102612:Ca=
!0}return Ca}Rc(){return!1}dispose(){if(this.$){const Ca=P.h(this.$),Hb=Ca.ha;Hb.NR(this.Zc);Hb.Cna(this.Zc);this.$.Bb.KAa(this.JF);this.$.ua.KAa(this.JF);this.$.userOperationManager.ao(this.Fz);Ca.Ca.Dr(this.Y$a);Ca.Ca.pRa(this.Y$a);Wb.a(this.$).Ca.Dr(this.Y$a);this.$.da.Ba(36)&&this.$.da.Ba(36).Ca.Dr(this.Y$a);this.$.ea&&this.$.ea.pk(this.Wc)}this.clear();f.a.sc([this.Vsc,this.Ra]);this.$=this.Ra=null;super.dispose()}g1j(Ca,Hb,cc,ca){this.$.ea.Yb&&this.$.userOperationManager.Oc(new lb.a(604,0,(ia,
Sb,Oc)=>Na.f(this.$.pa.va,Ca,Hb,cc,va.b(ia,td=>{td=td.Result;null===td||""===td.DataConnectionName||-1===td.ExternalSourceIndex?this.sWd():this.CAa(td.DataConnectionName,td.ExternalSourceIndex,ca)}),va.a(Sb,td=>{e.ULS.sendTraceTag(509696077,306,15,"DataRefreshManager::onGetConnectionNameFailure");this.sWd();td=X.a.Ue(td.data);this.$.ea.$n(td)}),Oc,null,null),80,()=>new ke.a),null)}CAa(Ca,Hb,cc){if(this.$.ea.Yb){var ca=ia=>{var Sb=null;if(this.sAa&&Object(h.a)(V.PivotTableRange,this.sAa)){const Oc=
this.sAa;Sb=()=>new Td(Oc.qda,Oc.pivotTableName)}Sb=this.$.userOperationManager.Oc(new bf(50,0,(Oc,td,Jd,qe)=>{var Ie=this.$.pa.va.$b();Ie.FlightHolder=this.$.ya.FlightHolder;null==Oc&&this.MLd.set(Ca,Ie.ClientRequestId);var Ze=this.$.pa.va;td=va.b(this.u5h(Ca),td);Ie=Ze.Oa(1,Ie);const Oe=Ie.context;Oe.RequestId=Oc;Oe.CompleteResponseTimeout=2E3;Ie.connectionName=Ca;Ie.externalSourceIndex=Hb;Ie.userAadToken=ia;return A.g(Ze,"Refresh",Ie,td,Jd,qe,null,0)},68,250,Sb),cc);this.tQa.set(Ca,Sb);this.Q3i(Ca)};
this.WSi(Ca);if(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)){const ia=wa.GetServiceTaskFactory.Pa(this.$.da,470,471,0);oa.TaskExtensions.za(ia,Sb=>{Sb.result.e4h(Ca).then(Oc=>{ca(Oc)},Oc=>{e.ULS.sendTraceTag(520680469,0,10,`DataRefreshManager.RefreshConnection: failed to get power query aad token ${Oc}`)})},this.$.ka,3)}else ca(null)}}Lx(Ca,Hb){var cc=null;if(this.confirmationRequired&&Ca)if(this.Jcb)Hb(!0);else if(cc=cc||kc.PKi,D.EwaSettings.jy()){Ca=
db.a.hd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");Ca.Caption=S.a.instance.Ua(7);Ca.Description=cc;Ca.HelpDescription=S.a.instance.ga(1319);Ca.HelpTopicId=zc.a.z5c;const ca=new Lb.a(this.$,Ca);ca.YL(()=>{this.Jcb=2===ca.returnValue;Hb(this.Jcb)})}else{const ca=new aa(this.$,cc);ca.YL(()=>{ca.hide();this.Jcb=2===ca.returnValue;Hb(this.Jcb)});ca.fg()}else Hb(!0)}BLa(){if(!this.RLd){var Ca=P.h(this.$);Ca=Ca.getRangeInformation(Ca.ha.ra.activeCell);for(let Hb=0,cc=Ca.length;Hb<cc;++Hb){const ca=Ca[Hb];
if(Object(h.a)(zd.a,ca)){this.sAa=ca;break}}this.RLd=!0}return this.sAa}dRb(){var Ca=this.$.pa.va.$b(),Hb=this.$.pa.va,cc=this.NYi,ca=this.MYi;Ca=Hb.Oa(1,Ca);A.g(Hb,"GetSensitivityLabelsForPowerBIDatasets",Ca,cc,ca,null,null,4)}wjg(Ca){return this.tQa.has(Ca)?(this.$.userOperationManager.rua(this.tQa.get(Ca)),!0):!1}static AHe(Ca){if(D.EwaSettings.xa(123)){var Hb=Ca.ic;if(!Hb||Hb.inEmbedView||Hb.inWebPart||Hb.inViewerFromWebPart)return!1;Ca=P.h(Ca);Hb=Ca.ha.ra.selectedRanges;for(let cc=0;cc<Hb.length;cc++)if(Ca.tb.ykc(Hb[cc]))return!0}return!1}sWd(){const Ca=
db.a.hd(1,0,0,1503,0,-853845742,"ErrorConnectingToDataSource");Je.a(this.$).St([Ca])}YVf(Ca,Hb,cc){if(this.$.ea.Yb){this.nmj();if(0<this.$.workbookContext.LegacyConnections.length){const ca=db.a.hd(32,2,1649,1662,0,-73730134,"BB_LegacyConnectionsWarning");ca.HelpDescription=S.a.instance.ga(1644);ca.HelpTopicId=Yc.a.TDi;const ia=Object(ib.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(pa.c)($a.a.resolve(cb.e,{Wb:0})):wa.GetServiceTaskFactory.Pa(this.$.da,5,4,0);oa.TaskExtensions.za(ia,
()=>{const Sb=ia.result;Sb&&Sb.sh(33,ca)},this.$.ka,3)}Ca?(Ca=this.$.pa.va.$b(),this.wbb=Xa(this.$.pa.va,!0,null,0,va.b(this.h1i,this.AJf),this.i1i,null,null,Ca)):this.$.userOperationManager.Oc(new bf(51,0,(ca,ia,Sb,Oc)=>{const td=this.$.pa.va.$b();td.FlightHolder=this.$.ya.FlightHolder;let Jd=null;cc&&(Jd={});return Xa(this.$.pa.va,!1,ca,2E3,va.b(this.AJf,ia),Sb,Oc,Jd,td)},68,250,()=>new ke.a),Hb)}}refreshSelected(Ca,Hb){if(this.$.ea.Yb&&Z.i(this.$.na)&&!this.fBb()){var cc=this.BLa();if(!kc.AHe(this.$)||
cc&&Object(h.a)(V.PivotTableRange,cc))cc?this.CAa(this.sAa.Abh,this.sAa.externalSourceIndex,Ca):D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIQueryTablesRefreshSelectedEnabled",!1)&&P.h(this.$).ha.ra.uif()?this.g1j(this.$.ua.na.sheetName,this.$.ua.na.activeCell.top-1,this.$.ua.na.activeCell.left-1,Ca):this.sWd();else{let ca;Ca=wa.GetServiceTaskFactory.Pa(this.$.da,271,272,Hb.QM());oa.TaskExtensions.za(Ca,ia=>{(ca=ia.result)&&ca.refreshLinkedEntitiesInRange()},this.$.ka,3)}}}clear(){this.ATd(0);
this.Jcb=!1;this.LHd=-1;kc.AQc=null;this.wbb&&(vb.AFrameworkApplication.Hd.Wt(this.wbb.Xs),this.wbb=null)}static Ltd(Ca){var Hb=!1;Ca=P.h(Ca).ha;2===Ca.Oe&&(Hb=Ca.Sa.jc,Ca=(null===Hb||void 0===Hb?0:Hb.floatingObject)?Hb.floatingObject.ed:null,Hb=Hb.$w&&!!Ca&&!!(Ca.Attributes&4));return Hb}fBb(){return 2===P.h(this.$).ha.Oe}gqd(){this.RLd=!1;this.sAa=null}ATd(Ca){let Hb=0<Ca;!Hb||this.$.ea.Yb&&this.$.ic.allowPeriodicDataRefresh||(Hb=!1);f.a.Ja(this.Vsc);this.Vsc=null;Hb&&(this.Vsc=bb.a.instance.GC(this.j4g,
Ca,Za.a.vmh))}BJf(Ca){D.EwaSettings.isChangeGateEnabled("OfficeVSO:6837645_SensitivityLabelOnRefreshCompleted")?Ca.RequestId||(this.Ra.raiseEvent("refreshCompleted",Ca,this),this.dRb()):(Ca.RequestId||this.Ra.raiseEvent("refreshCompleted",Ca,this),this.dRb())}u5h(Ca){return Hb=>{var cc;this.BJf(Hb);Hb&&(Hb.DepartableWebMethodOperationCompleted||Hb.Errors&&0<Hb.Errors.length)&&(Array.remove(this.XXb,Ca),Hb.Result=null!==(cc=Hb.Result)&&void 0!==cc?cc:{},Hb.Result.ConnectionName=Ca,this.Ra.raiseEvent("singleRefreshCompleted",
Hb,this))}}WSi(Ca){this.Ra.raiseEvent("beforeSingleRefreshStarted",Ca,this)}Q3i(Ca){this.XXb.includes(Ca)||this.XXb.push(Ca);this.Ra.raiseEvent("singleRefreshStarted",Ca,this)}njg(Ca,Hb,cc){const ca=wa.GetServiceTaskFactory.Pa(this.$.da,274,275,0);let ia=!1;cc.qK?e.ULS.sendTraceTag(537163297,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):oa.TaskExtensions.za(ca,()=>{if(({F7a:ia}=ca.result.i0c(Ca,ia)).returnValue)e.ULS.sendTraceTag(537163293,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the ${Hb} attempt.`);
else if(ia&&3>Hb)if(cc.qK)e.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");else{var Sb=this.$.ya.TimeToWaitForApplyingSensitivityLabels;e.ULS.sendTraceTag(537163295,306,100,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after ${Sb} ms on the ${Sb} attempt.`);bb.a.instance.create(()=>{this.njg(Ca,Hb+1,cc)},Sb,Za.a.wmh,!0,!0)}else e.ULS.sendTraceTag(537163294,
306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the ${Hb} attempt.  Not scheduling anymore retries.`)},cc,3)}U_c(Ca){Ca.Us(this.Y$a);Ca=Ca.E9i;0<Ca&&this.x8f(Ca)}x8f(Ca){const Hb=this.$.ea.se;Hb>this.LHd&&(this.LHd=Hb,this.ATd(1E3*Ca))}nmj(){const Ca=Object(ib.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(pa.c)($a.a.resolve(cb.e,{Wb:0})):wa.GetServiceTaskFactory.Pa(this.$.da,5,4,0);oa.TaskExtensions.za(Ca,()=>{const Hb=Ca.result;
Hb&&Hb.qla(58)&&Hb.removeEntry(58)},this.$.ka,3)}static get PKi(){return kc.AQc||(kc.AQc=S.a.instance.Ua(8)+"<br /><br />"+S.a.instance.Ua(10))}static la(Ca){Ca.da.Ha(13,new kc(Ca))}}kc.AQc=null;Object(b.a)(kc,"DataRefreshManager",l.a,[14,222]);class Nc extends Nb.a{constructor(Ca){super(Ca)}ld(){oa.TaskExtensions.za(wa.GetServiceTaskFactory.Pa(this.$.da,470,471,this.Na),Ca=>{this.fd([Ca.result])},this.$.ka,3)}static la(Ca){Nb.a.Rd(472,new Nc(Ca))}}Object(b.a)(Nc,"PowerQueryManagerCommandHandlerFactory",
Nb.a,[]);const ad=(Ca,Hb,cc,ca,ia,Sb,Oc,td=null)=>{td=Ca.Oa(1,td);td.groupOperation=Hb;td.groupOperationPayload=cc;return A.g(Ca,"EditPowerQueryGroup",td,ca,ia,Sb,Oc,0)},sd=(Ca,Hb,cc,ca,ia,Sb,Oc,td=null)=>{td=Ca.Oa(1,td);td.queryAction=Hb;td.queryActionPayload=cc;return A.g(Ca,"PowerQueryQueryAction",td,ca,ia,Sb,Oc,0)},ce=(Ca,Hb,cc,ca,ia,Sb,Oc,td=null)=>{td=Ca.Oa(1,td);td.powerQueryDataSourceConnections=Hb;td.operationType=cc;return A.g(Ca,"WritePowerQueryRoaming",td,ca,ia,Sb,Oc,4)};var Ce=a(896);
class ve{constructor(Ca,Hb){this.U5b=this.stateId=0;this.ZLe=!1;this.Mae=null;this.ode=!1;this.zae=null;this.sHe=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1);this.cKb=cc=>{if(this.zkc(cc)&&this.K4g(cc)&&this.ED.kb(cc))if(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryCleanRoamingOnRefresh",!1))ce(this.$.pa.va,[],0,()=>{e.ULS.sendTraceTag(509682770,0,100,"PowerQueryManager:WriteRoaming ClearAllConnections: succeeded");const ca=
this.ED.getItem(cc);eb.a(this.$).CAa(ca.ConnectionName,ca.ExternalSourceIndex,null)},()=>{e.ULS.sendTraceTag(509682769,0,100,"PowerQueryManager:WriteRoaming ClearAllConnections: Failed");const ca=this.ED.getItem(cc);eb.a(this.$).CAa(ca.ConnectionName,ca.ExternalSourceIndex,null)},null,null);else{const ca=this.ED.getItem(cc);eb.a(this.$).CAa(ca.ConnectionName,ca.ExternalSourceIndex,null)}};this.xf=()=>{const cc=this.$.ea.Tm.PowerQueryStateId,ca=this.$.ea.Tm.ConnectionsStateId;e.ULS.sendTraceTag(537154444,
0,50,`PowerQueryManager.OnWorkbookMetadataChanged: powerQueryStateId: ${cc}, this.stateId: ${this.stateId}. connectionsStateId: ${ca}, this.connectionsStateId: ${this.U5b}`);cc>this.stateId&&this.nja().continueWith(ia=>{ia.result?this.stateId=cc:e.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")});this.sHe&&ca>this.U5b&&this.wdd().continueWith(ia=>{ia.result?this.U5b=ca:e.ULS.sendTraceTag(509371268,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local legacy connections state")})};
this.Io=()=>{this.nja();this.wdd()};this.X5j=cc=>{if(cc&&!La.a(cc)){cc=cc.Result;if(cc.Queries){this.fcb.clear();for(var ca of cc.Queries)try{this.fcb.add(ca.Name,ca)}catch(ia){e.ULS.sendTraceTag(523534750,0,10,"PowerQueryManager.OnGetQueriesSuccess: more than one query with the same name in queryInfo.")}}this.Mae=cc.QueryGroups;e.ULS.sendTraceTag(537154441,0,50,`PowerQueryManager.OnGetQueriesSuccess: no. queries: ${this.queries?this.queries.length.toString():"null"}`);if(cc.PowerQueryConnectionsInfo){this.ED.clear();
ca=[];for(const ia of cc.PowerQueryConnectionsInfo)try{this.ED.add(ia.QueryName,ia)}catch(Sb){e.ULS.sendTraceTag(523534749,0,10,"PowerQueryManager.OnGetQueriesSuccess: same query with more than one connection."),ca.push(ia.QueryName)}ca.forEach(ia=>{this.ED.remove(ia)})}this.zae=cc.Formulas;this.ZLe=!0}};this.S5j=cc=>{if(cc&&!La.a(cc)){cc=cc.Result;if(cc.LegacyConnections){this.gxd.clear();for(const ca of cc.LegacyConnections)try{this.gxd.add(ca.Name,ca)}catch(ia){e.ULS.sendTraceTag(509696094,0,10,
"PowerQueryManager.OnGetLegacyConnectionsSuccess: more than one legacy connection with the same name in LegacyConnections.")}}e.ULS.sendTraceTag(509696093,0,50,`PowerQueryManager.OnGetLegacyConnectionsSuccess: Legacy connections: ${this.qca?this.qca.length.toString():"null"}`)}};this.EEd=()=>{e.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.iYi=()=>{e.ULS.sendTraceTag(509696092,0,15,"PowerQueryManager.OnGetLegacyConnectionsFailure")};this.gGd=cc=>{this.Ra.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",
cc);D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebRefreshOnOpen",!1)&&this.LLd(ca=>ca.IsPendingRefresh)};this.o5i=cc=>{this.Ra.raiseEvent("OnUpdatePowerQueryDataFailed",cc)};this.q5i=cc=>{this.Ra.raiseEvent("OnUpdatePowerQueryLegacyConnectionsSucceeded",cc)};this.p5i=cc=>{this.Ra.raiseEvent("OnUpdatePowerQueryLegacyConnectionsFailed",cc)};this.NPa=(cc,ca)=>{if(ca&&ca.Result&&!(ca.Errors&&0<ca.Errors.length)&&ca.Result.PowerQueryRefreshChallengeResult){if(!ca.Result.ConnectionName)throw Error.argumentNull;
this.$.Ia.Hb(new zb.a(-1496653501,0,this.$.xc,8,null),{["kind"]:ca.Result.PowerQueryRefreshChallengeResult.Kind,["path"]:ca.Result.PowerQueryRefreshChallengeResult.Path,["queryName"]:this.l8e(ca.Result.ConnectionName)})}};this.sgd=cc=>{e.ULS.sendTraceTag(520734801,0,50,"PowerQueryManager:GetToken: Token requested for PQO service");try{return this.wGb.tL("PowerQueryWeb",null!==cc&&void 0!==cc?cc:this.$.ya.PowerQueryAudienceUri).then(ca=>{if(ca.IsSuccess)return e.ULS.sendTraceTag(520734800,0,20,"PowerQueryManager.getAuthToken: successfully fetch token."),
ca.Token;e.ULS.sendTraceTag(520734799,0,15,`PowerQueryManager.getAuthToken: failed to get token. Error code: ${ca.ErrorCode}, Error message : ${ca.ErrorMessage}`);return Promise.resolve(null)},()=>{e.ULS.sendTraceTag(520734798,0,15,"PowerQueryManager.getAuthToken: got rejected promise, use fallback value");return Promise.resolve(null)})}catch(ca){return e.ULS.sendTraceTag(520734797,0,10,`PowerQueryManager.getAuthToken: Exception thrown when fetching token, Exception: ${ca}`),Promise.resolve(null)}};
this.$=Ca;this.wGb=Hb;this.fcb=new J.a(!1);this.gxd=new J.a(!1);this.sFg=new J.a(!1);this.Ra=new Qb.a;this.$.ea.ju(this.xf);this.$.ea.ZL(this.Io);this.$.ea.Tm&&(this.stateId=this.$.ea.Tm.PowerQueryStateId,this.U5b=this.$.ea.Tm.ConnectionsStateId);D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&(eb.a(this.$).kZc(this.NPa),D.EwaSettings.isChangeGateEnabled("OfficeVSO:7597596_InitPowerQueryClientOnDemand")&&this.cki());D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebRefreshOnOpen",
!1)&&this.nja();de.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(cc=>{cc.isFeatureEnabled("ExcelPowerQuery",!1).then(ca=>{this.ode=ca;return null})})}get zwi(){return this.ode}get queries(){return this.fcb.values}get groups(){return this.Mae}get qca(){return this.gxd.values}get formulas(){return this.zae}get ED(){return this.sFg}tSg(Ca){this.Ra.addHandler("OnUpdatePowerQueryDataKeySucceeded",Ca)}xqj(Ca){this.Ra.removeHandler("OnUpdatePowerQueryDataKeySucceeded",
Ca)}uSg(Ca){this.Ra.addHandler("OnUpdatePowerQueryLegacyConnectionsSucceeded",Ca)}yqj(Ca){this.Ra.removeHandler("OnUpdatePowerQueryLegacyConnectionsSucceeded",Ca)}zkc(Ca){if(this.fcb.kb(Ca)){const Hb=this.fcb.getItem(Ca);if(1!==Hb.FillObjectType&&!Hb.LoadedToDataModel&&this.ED.kb(Ca))return!0}else e.ULS.sendTraceTag(537154446,0,10,"Query not present in the queryNameToQueryInfo dictionary");return!1}nja(){const Ca=new bd.a;if(!this.$.userOperationManager.pAc()&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:7597603_CheckshouldEnqueueOperationGetQueries"))return Ca.setResult(!1),
Ca.task;this.$.userOperationManager.Oc(new lb.a(587,0,(Hb,cc,ca)=>Ce.d(this.$.pa.va,va.b(Hb,this.X5j,this.gGd,()=>{Ca.setResult(!0)}),va.a(cc,this.EEd,this.o5i,()=>{Ca.setResult(!0)}),ca,null),80,()=>new ke.a),null);return Ca.task}wdd(){const Ca=new bd.a;if(!this.$.userOperationManager.pAc()&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:7597603_CheckshouldEnqueueOperationGetQueries"))return Ca.setResult(!1),Ca.task;const Hb=(cc,ca,ia)=>Ce.b(this.$.pa.va,va.b(cc,this.S5j,this.q5i,()=>{Ca.setResult(!0)}),
va.a(ca,this.iYi,this.p5i,()=>{Ca.setResult(!0)}),ia,null);this.sHe&&this.$.userOperationManager.Oc(new lb.a(603,0,Hb,80,()=>new ke.a),null);return Ca.task}qCe(Ca){if(this.ED.kb(Ca)){Ca=this.ED.getItem(Ca).ConnectionName;const Hb=eb.a(this.$).MLd;if(Hb&&Hb.has(Ca))e.ULS.sendTraceTag(525342226,0,50,"PowerQueryManager.cancelRefreshQuery: sending cancellation request"),Ca=Hb.get(Ca),A.h(this.$.pa.va,Ca,null,null,null);else if(!eb.a(this.$).wjg(Ca))return e.ULS.sendTraceTag(525342225,0,15,"PowerQueryManager.cancelRefreshQuery: cannot find canceled connection on running requests map"),
!1}return!0}handleQueryGroupOperation(Ca,Hb){this.dxh(Ca,Hb);this.$.userOperationManager.Oc(new lb.a(1023,0,(cc,ca,ia)=>ad(this.$.pa.va,Ca,Hb,va.b(Sb=>{0<Sb.Errors.length&&this.nja()},cc),va.a(()=>{this.nja()},ca),ia,null),4),null)}cki(){const Ca=document.createElement("div");Ca.id=this.$.Cb+"PowerQueryMashupClientId";this.$.Hp.appendChild(Ca);appChrome.initPowerQueryMashupClient(Ca,this.sgd,this.$.ya.UICultureTag,this.$.ya.UserSessionId,this.$.ya.PowerQueryHostContextType,this.$.ya.PowerQueryEndpointUrl).finally(()=>
{this.$.Hp.removeChild(Ca)})}dxh(Ca,Hb){let cc=this.groups.find(ca=>ca.Id===Hb.Id);if(cc){switch(Ca){case 3:this.ixh(Hb,cc);break;case 2:this.bxh(Hb);break;case 4:this.fxh(Hb,cc);break;default:return}this.gGd(void 0,void 0,void 0)}else e.ULS.sendTraceTag(509752481,0,10,"PowerQueryManager.estimateGroupOperation: Group not found")}ixh(Ca,Hb){Hb.Name=Ca.Name}bxh(Ca){let Hb=this.groups.findIndex(cc=>cc.Id===Ca.Id);-1===Hb?e.ULS.sendTraceTag(509752480,0,10,"PowerQueryManager.estimateDeleteGroup: Group index not found"):
this.groups.splice(Hb,1)}fxh(Ca,Hb){const cc=Ca.ParentId?Ca.ParentId:"{00000000-0000-0000-0000-000000000000}";let ca=-1;this.groups.forEach(ia=>{ia.ParentId===cc&&ia.Order>ca&&(ca=ia.Order)});Hb.ParentId=cc;Hb.Order=ca+1}handleQueryAction(Ca,Hb){this.hxh(Ca,Hb);this.$.userOperationManager.Oc(new lb.a(1023,0,(cc,ca,ia)=>sd(this.$.pa.va,Ca,Hb,va.b(Sb=>{0<Sb.Errors.length&&this.nja()},cc),va.a(()=>{this.nja()},ca),ia,null),68),null)}hxh(Ca,Hb){switch(Ca){case 2:this.jxh(Hb);break;case 1:this.cxh(Hb);
break;default:return}this.gGd(void 0,void 0,void 0)}cxh(Ca){this.queries.find(Hb=>Hb.Name===Ca.Name).IsDeleting=!0}jxh(Ca){var Hb=this.queries.find(cc=>cc.Name===Ca.Name);Hb.Name=Ca.ExtraData;Hb.LoadedToDataModel||((Hb=this.ED.getItem(Ca.Name))?(Hb.ConnectionName="Query - "+Ca.ExtraData,Hb.QueryName=Ca.ExtraData,this.ED.remove(Ca.Name),this.ED.add(Ca.ExtraData,Hb)):e.ULS.sendTraceTag(512492568,0,10,"PowerQueryManager.estimateRenameQuery: Connection info not found"))}Rc(){return!1}Mc(){return!1}executeCommand(Ca,
Hb){Ca=oa.TaskExtensions.Yj();return-1193102612===Hb.command?(this.ojj(),Ca):rb.a(Hb.command)}Ac(Ca,Hb){switch(Hb.command){case -1193102612:return!0}return!1}e4h(Ca){return this.l8e(Ca)?this.sgd():Promise.resolve(null)}dispose(){f.a.sc([this.Ra]);D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&eb.a(this.$).ZNd(this.NPa);this.$.ea.Lv(this.xf);this.$.ea.MR(this.Io);this.$=null}DNj(Ca,Hb){let cc=db.a.hd(1,2,2211,0,0,Ca,"PowerQueryRefreshValidationFailed");
switch(Ca){case -1543585732:cc.MessageIdName="PowerQueryRefreshProtectedSheetFailed";cc.Description=String.format(S.a.instance.Ua(709),Hb,S.a.instance.ga(2212));break;case 165156185:cc.MessageIdName="PowerQueryRefreshSheetViewFailed";cc.Description=String.format(S.a.instance.Ua(709),Hb,S.a.instance.ga(2213));break;default:e.ULS.sendTraceTag(529069344,0,10,`PowerQueryManager.showEwaErrorDialog: unhandled error id ${Ca}`)}D.EwaSettings.jy()?new Lb.a(this.$,cc):(Ca=new Fa.ErrorDialog(this.$,cc),Ca.initialize(),
Ca.fg())}K4g(Ca){var Hb=this.fcb.getItem(Ca);return Hb?(Hb=this.oYh(Hb))?(this.DNj(Hb,Ca),!1):!0:(e.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),!1)}oYh(Ca){if((Ca=this.p7h(Ca))&&Ca.Xh)return-1543585732;if(Ca&&Ca.ie.uz)return 165156185}p7h(Ca){let Hb=void 0,cc=void 0;if(3===Ca.FillObjectType||2===Ca.FillObjectType)Hb=Ca.FillObjectName.split("!")[0];else if(0==Ca.FillObjectType){if(!Ca.FillObjectName)return e.ULS.sendTraceTag(523534751,
0,15,"PowerQueryManager.getSheetFromLoadDestination: FillObjectName is undefined for Query loaded to table."),cc;(Ca=this.$.Bb.getItemByName(Ca.FillObjectName))?Hb=Ca.sheetName:e.ULS.sendTraceTag(527743194,0,15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query")}Hb&&(cc=this.$.ua.getItemByName(Hb));return cc}ojj(){this.ZLe?this.LLd(()=>!0):this.nja().continueWith(Ca=>{Ca.result?this.LLd(()=>!0):e.ULS.sendTraceTag(537154445,0,10,"PowerQueryManager.RefreshAllQueries failed to fetch queries")})}LLd(Ca){this.queries.filter(Ca).forEach(Hb=>
this.cKb(Hb.Name))}l8e(Ca){for(const Hb of this.queries)if(this.ED.getItem(Hb.Name).ConnectionName===Ca)return Hb.Name;return null}}Object(b.a)(ve,"PowerQueryManager",null,[620,222,3]);var De=a(717);class le extends pb.a{constructor(Ca){super();this.$=Ca;this.Gb()}create(){const Ca=this.$.da;oa.TaskExtensions.za(Object(ib.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")?Object(pa.c)($a.a.resolve(cb.D,{Wb:this.Na})):wa.GetServiceTaskFactory.Pa(Ca,349,350,this.Na),Hb=>{this.qb(Object(De.a)(Ca,
470,()=>new ve(this.$,Hb.result)))},this.$.ka,3)}static la(Ca){Ca.da.Ha(471,new le(Ca))}}Object(b.a)(le,"PowerQueryManagerFactory",pb.a,[]);var qf;(function(Ca){Ca[Ca.null=-1]="null";Ca[Ca.table=0]="table";Ca[Ca.connectionOnly=1]="connectionOnly";Ca[Ca.pivotTable=2]="pivotTable";Ca[Ca.pivotChart=3]="pivotChart"})(qf||(qf={}));Object(b.b)("FillObjectType",qf);var Nf=a(274);a(353);a(124);class Tf{constructor(){this.name=this.key=null;this.startIndex=this.count=0;this.data=this.children=null;this.order=
this.level=0;this.parentKey=null}}Object(b.a)(Tf,"GroupInfo",null,[]);class Oa{constructor(){this.onLegacyConnectionRefresh=this.handleQueryAction=this.onCancelQueryRefresh=this.handleQueryGroupOperation=this.onQueryRefresh=this.onQuerySelected=null}}Object(b.a)(Oa,"PowerQueryTaskPaneCallbacks",null,[]);class Fb{constructor(){this.callbacks=this.selectedQueryKey=this.groups=this.connections=this.queries=this.type=null}}Object(b.a)(Fb,"PowerQueryTaskPaneProps",null,[]);class $b{constructor(){this.name=
null;this.rowsLoaded=0;this.lastRefresh=null;this.fillObjectType=0;this.loadedToDataModel=!1;this.queryError=0;this.groupKey=null;this.rowsWithError=this.nestingDepth=0;this.isDeleting=this.refreshEnabled=this.inRefresh=!1}}Object(b.a)($b,"QueryInfo",null,[]);class Cc{constructor(){this.description=this.name=null;this.fillObjectType=0;this.refreshEnabled=this.inRefresh=this.loadedToDataModel=!1}}Object(b.a)(Cc,"ConnectionInfo",null,[]);class Pc{constructor(Ca,Hb,cc){new J.a(!1);new J.a(!0);new J.a(!0);
this.hxd=this.Zaf=this.oAa=null;this.$Vf=0;this.onCancelQueryRefresh=ca=>{this.powerQueryManager.qCe(ca)&&this.oYd([ca])};this.handleQueryGroupOperation=(ca,ia)=>{const Sb={};Sb.Id=ia.id;Sb.Name=ia.name;Sb.Description=ia.description;Sb.ParentId=ia.parentId;this.powerQueryManager.handleQueryGroupOperation(ca,Sb)};this.handleQueryAction=(ca,ia)=>{const Sb={};Sb.Name=ia.name;Sb.ExtraData=ia.extraData;Sb.Formulas=this.powerQueryManager.formulas;this.powerQueryManager.handleQueryAction(ca,Sb)};this.$=
Ca;this.ttc=cc;this.isVisible=!1;this.Suc=new J.a(!0);this.VLd={};this.powerQueryManager=Hb}jBa(){Pb.UISurfaces.mj().then(Ca=>{Ca.setSelectedTaskPane("PowerQueryTaskPane");return null})}lL(Ca){this.isVisible=!0;Pb.UISurfaces.mj().then(Hb=>{Hb.showTaskPane("PowerQueryTaskPane",this.L6c(Ca));return null})}LB(Ca,Hb,cc=null,ca=null,ia=null){if(this.isVisible){var Sb=this.L6c(Ca,Hb,cc,ca,ia);Pb.UISurfaces.mj().then(Oc=>{Oc.updateTaskPane("PowerQueryTaskPane",Sb||this.L6c(Ca,Hb,cc,ca,ia));return null})}else this.Fng(Hb,
cc,ca)}mK(){this.isVisible=!1;Pb.UISurfaces.mj().then(Ca=>{Ca.hideTaskPane("PowerQueryTaskPane",2);return null})}Xdg(Ca){if(!Nf.a.ah(Ca)){for(const Hb of this.oAa)Ca.includes(Hb.name)&&(this.Suc.add(Hb.name,Hb),this.VLd[Hb.name]=++this.$Vf,e.ULS.sendTraceTag(537154401,0,50,`Refresh started for query #: ${this.$Vf}`));this.LB(null,this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.qca)}}oYd(Ca){if(!Nf.a.ah(Ca)){for(const Hb of this.oAa)Ca.includes(Hb.name)&&(Hb.name in
this.VLd&&e.ULS.sendTraceTag(537154400,0,50,`Refresh stoped for query #: ${this.VLd[Hb.name]}`),this.Suc.remove(Hb.name));this.LB(null,this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.qca)}}Fng(Ca=null,Hb=null,cc=null){this.w7j(Ca,Hb,cc)}w7j(Ca=null,Hb=null,cc=null){Ca&&(this.oAa=[],null===Ca||void 0===Ca?void 0:Ca.forEach(ca=>this.oAa.push(this.pjh(ca))));cc&&(this.hxd=[],null===cc||void 0===cc?void 0:cc.forEach(ca=>this.hxd.push(this.Ffh(ca))));Hb&&(this.Zaf=this.ahh(Hb));
this.Qbj()}L6c(Ca,Hb=null,cc=null,ca=null,ia=null){this.Fng(Hb,cc,ca);Hb=Object(nc.a)(new Oa,{onQuerySelected:this.ttc.onQuerySelected,onQueryRefresh:this.powerQueryManager.cKb,onCancelQueryRefresh:this.onCancelQueryRefresh,handleQueryGroupOperation:this.handleQueryGroupOperation,handleQueryAction:this.handleQueryAction});ia=Object(nc.a)(new Fb,{type:"PowerQueryTaskPaneProps",callbacks:Hb,queries:this.oAa,groups:this.Zaf,connections:this.hxd,selectedQueryKey:ia});if(qa.a.Gd(this.$))return Object(nc.a)(new oc.a,
{contentProps:ia,onOpen:()=>{this.ttc.lI()},onClose:()=>{this.ttc.Dz()},width:320,title:S.a.instance.ga(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?2288:2201)});Ca=Object(nc.a)(new Ic.a,{container:Ca,paneProps:ia});return Object(nc.a)(new oc.a,{contentProps:Ca,onOpen:()=>{this.ttc.lI()}})}Qbj(){if(this.oAa)for(let Hb=0;Hb<this.oAa.length;Hb++){var Ca=!1;const cc=this.oAa[Hb],ca=this.Suc.getItem(cc.name);null!=ca&&(Ca=new Date(cc.lastRefresh),(Ca=
(new Date(ca.lastRefresh)).getTime()===Ca.getTime())||this.Suc.remove(ca.name));cc.inRefresh=Ca;cc.refreshEnabled=this.powerQueryManager.ED.kb(cc.name)}}pjh(Ca){const Hb=new $b;Hb.name=Ca.Name;Hb.rowsLoaded=Ca.RowsLoaded;Hb.lastRefresh=Ca.LastRefresh;Hb.fillObjectType=Ca.FillObjectType;Hb.loadedToDataModel=Ca.LoadedToDataModel;Hb.queryError=Ca.QueryError;Hb.nestingDepth=0;Hb.rowsWithError=Ca.RowsWithError;Hb.groupKey=Ca.GroupID;Hb.isDeleting=Ca.IsDeleting;return Hb}Ffh(Ca){const Hb=new Cc;Hb.name=
Ca.Name;Hb.description=Ca.Description;Hb.fillObjectType=Ca.FillObjectType;Hb.loadedToDataModel=Ca.LoadedToDataModel;Hb.inRefresh=Ca.InRefresh;Hb.refreshEnabled=Ca.RefreshEnabled;return Hb}ahh(Ca){const Hb=[];Ca.forEach(cc=>{const ca=Object(nc.a)(new Tf,{});ca.key=cc.Id;ca.name=cc.Name;ca.order=cc.Order;ca.parentKey=cc.ParentId;ca.data=cc.Description;Hb.push(ca)});return Hb}}Object(b.a)(Pc,"PowerQueryReactTaskPane",null,[578]);class od{constructor(Ca,Hb){this.stc=this.tda=this.VCc=this.powerQueryTaskPane=
null;this.kQf=this.ssc=this.dh=!1;this.onQuerySelected=cc=>{for(var ca of this.powerQueryManager.queries)if(ca.FillObjectName&&ca.Name===cc){3!==ca.FillObjectType&&2!==ca.FillObjectType||na.a.contains(ca.FillObjectName,"!",!0)||e.ULS.sendTraceTag(537154438,0,15,`PowerQueryPaneManager.OnQuerySelected: Selection Query of type : ${qf[ca.FillObjectType]} and no ! on FillObjectName`);3===ca.FillObjectType?(cc=ca.PivotChartSheetRange,cc.SheetName=ca.FillObjectName.split("!")[0],ca=ca.FillObjectName.split("!")[1],
P.h(this.$).ha.Sa.hIa(cc,ca,0).continueWith(ia=>{ia.result||e.ULS.sendTraceTag(537154437,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):(ca=2===ca.FillObjectType?ca.FillObjectName.split("!")[1]:ca.FillObjectName,(ca=this.$.Bb.getItemByName(ca))&&ca.activate(D.EwaSettings.isChangeGateEnabled("OfficeVSO:7317913_FixFocusLostOnQuerySelection")));break}};this.zHb=()=>{this.hideTaskPane();this.$.Bb.yg(this.Zd)};this.onCancelQueryRefresh=cc=>{this.powerQueryManager.qCe(cc)&&
this.tda.oYd([cc])};this.onQueryRefresh=cc=>{this.powerQueryManager.cKb(cc)};this.Jnf=cc=>this.powerQueryManager.ED.kb(cc);this.dGf=()=>{this.IYi()};this.$Ff=()=>{this.jYi()};this.Zd=(cc,ca)=>{ca.na&&2===ca.na.type&&this.pZd.kb(ca.na.name)&&this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.qca,this.pZd.getItem(ca.na.name))};this.DJf=(cc,ca)=>{cc=[];for(const ia of this.powerQueryManager.ED.values)if(ca===ia.ConnectionName){const Sb=ia.QueryName;
if(this.powerQueryManager.zkc(Sb)){cc.push(Sb);break}}this.tda.Xdg(cc)};this.NPa=(cc,ca)=>{if(ca&&ca.Result){cc=ca.Result.ConnectionName;ca=[];for(const ia of this.powerQueryManager.ED.values)if(cc===ia.ConnectionName){const Sb=ia.QueryName;if(this.powerQueryManager.zkc(Sb)){ca.push(Sb);break}}this.tda.oYd(ca)}};this.$=Ca;this.powerQueryManager=Hb;this.pZd=new J.a(!0);this.LVj=new J.a(!0);this.hmi(Ca);eb.a(this.$).kZc(this.NPa);eb.a(this.$).Wre(this.DJf);this.powerQueryManager.tSg(this.dGf);this.powerQueryManager.uSg(this.$Ff);
e.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}SOj(){if(qa.a.Gd(this.$))this.showTaskPane();else if(this.powerQueryTaskPane||this.kQf)this.powerQueryTaskPane&&(this.powerQueryTaskPane.Sg(!0),this.showTaskPane());else{this.kQf=!0;const Ca=wa.GetServiceTaskFactory.Pa(this.$.da,408,409,0),Hb=ob.a(this.$);oa.TaskExtensions.za(oa.TaskExtensions.Md([Ca,Hb],this.$.ka),()=>{this.powerQueryTaskPane=Ca.result;Hb.result.VQ(this.powerQueryTaskPane);this.u6();this.powerQueryTaskPane.Sg(!0);
this.showTaskPane()},this.$.ka,3)}}hmi(Ca){this.tda=new Pc(Ca,this.powerQueryManager,this)}u6(){this.stc=this.powerQueryTaskPane.jU();this.powerQueryTaskPane.DT(this.zHb)}dispose(){eb.a(this.$).ZNd(this.NPa);eb.a(this.$).wYf(this.DJf);this.powerQueryManager.xqj(this.dGf);this.powerQueryManager.yqj(this.$Ff);this.$=null;this.hideTaskPane();this.powerQueryTaskPane&&(this.powerQueryTaskPane.zW(this.zHb),this.powerQueryTaskPane=this.stc=null);this.tda=null}lI(){this.powerQueryManager.nja();this.powerQueryManager.wdd();
this.$.Bb.Yf(this.Zd)}Dz(){this.dh=!1}handleQueryGroupOperation(Ca,Hb){Ee.a(this.$.userOperationManager,(cc,ca,ia)=>ad(this.$.pa.va,Ca,Hb,cc,ca,ia,null),cc=>new lb.a(1021,0,cc),null)}showTaskPane(){this.dh?qa.a.Gd(this.$)&&this.tda.jBa():(this.VCc=this.$.Mb.Kc("UserAction","PowerQueryTaskPaneInitialLoadTime"),this.dh=!0,this.tda.lL(this.stc))}updateTaskPane(Ca,Hb,cc,ca){this.tda.LB(this.stc,Ca,Hb,cc,ca);this.VCc&&(this.VCc.stop(),this.VCc=null);for(Ca=0;Ca<this.powerQueryManager.queries.length;Ca++)Hb=
this.powerQueryManager.queries[Ca],0===Hb.FillObjectType&&this.pZd.add(Hb.FillObjectName,Hb.Name),Hb.LastRefresh||e.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.");Ca=this.powerQueryManager.qca;for(Hb=0;Hb<Ca.length;Hb++)cc=Ca[Hb],0===cc.FillObjectType&&this.LVj.add(cc.FillObjectName,cc.Name)}hideTaskPane(){this.dh=!1;this.tda.mK()}IYi(){this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.qca,
null);this.ssc||(this.fIf(eb.a(this.$).WLd),this.ssc=!0)}jYi(){this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.qca,null);this.ssc||(this.fIf(eb.a(this.$).WLd),this.ssc=!0)}fIf(Ca){const Hb=[];for(const cc of Ca)for(const ca of this.powerQueryManager.ED.values)if(cc===ca.ConnectionName&&(Ca=ca.QueryName,this.powerQueryManager.zkc(Ca))){Hb.push(Ca);break}this.tda.Xdg(Hb)}}Object(b.a)(od,"PowerQueryPaneManager",null,[570]);class Ld{constructor(Ca,
Hb){this.utc=null;this.$=Ca;this.dbj=Hb}Rc(){return!1}Mc(){return!1}executeCommand(Ca,Hb){this.utc||(this.utc=new od(this.$,this.dbj));Ca=oa.TaskExtensions.Yj();return 1156885807===Hb.command?(this.utc.SOj(),Ca):rb.a(Hb.command)}dispose(){this.$=this.utc=null}Ac(Ca,Hb){return 1156885807===Hb.command}}Object(b.a)(Ld,"PowerQueryPaneCommandHandler",null,[222,3]);class Wd extends Nb.a{constructor(Ca){super(Ca)}ld(){this.$.jz(()=>{D.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient")?
oa.TaskExtensions.za(wa.GetServiceTaskFactory.Pa(this.$.da,470,471,1),Ca=>{this.fd([new Ld(this.$,Ca.result)])},this.$.ka,3):this.fd([new Ld(this.$,null)])})}static la(Ca){Nb.a.Rd(407,new Wd(Ca))}}Object(b.a)(Wd,"PowerQueryPaneCommandHandlerFactory",Nb.a,[]);class Fd{}Fd.nBh="ewa-pqtp-pane";Fd.mBh="ewa-pqtp-header";Fd.oBh="ewa-pqtp-title";Fd.kBh="ewa-pqtp-body";Fd.lBh="ewa-pqtp-close-button";Object(b.a)(Fd,"CssClassNames",null,[]);const $d=Fd.nBh,Ye=Fd.mBh,zf=Fd.kBh,kf=Fd.oBh,Df=v.a.JPb+Fd.lBh;class Of extends C.a{constructor(Ca,
Hb,cc){super(Ca);this.qFe=this.De=null;this.Is=!1;this.Qv=0;this.yc=(ca,ia)=>{ia.Ef||this.Sg(!1)};this.tl=()=>{this.Sg(!1);this.raiseEvent("PQTPC");return!0};this.$=Hb;this.taskPaneManager=cc;w.a(Hb).fi(this);this.$.ij(this.yc)}ET(Ca){this.get_events().addHandler("PQTPR",Ca)}AW(Ca){this.get_events().removeHandler("PQTPR",Ca)}DT(Ca){this.addHandler("PQTPC",Ca)}zW(Ca){this.removeHandler("PQTPC",Ca)}get isVisible(){return super.isVisible}set isVisible(Ca){super.isVisible!==Ca&&(super.isVisible=Ca)}get If(){return this.isVisible}get ee(){return la.a.cbj}get Qh(){return 17}get jk(){return y.a.wEh}get QQ(){return S.a.instance.ga(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",
!1)?2288:2201)}get titleText(){return S.a.instance.ga(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?2288:2201)}get Xp(){return 320}get mc(){return this.domElement}get height(){return this.taskPaneManager.DO.offsetHeight}get isResizable(){return!1}Oq(){return this.Is}Et(){return this.Is}ZV(){}jV(){return!1}Bj(){}ik(){}dispose(){this.$&&this.$.$k(this.yc);this.De&&(O.a.instance.Aa(x.a.click,this.De,this.tl),Ga.KeyInputManager.instance.ix(this.De,this.qFe));
this.De=this.taskPaneManager=this.$=null;super.dispose()}eg(Ca,Hb){Hb||(Ca=H.DOMElementExtensions.getElementById(this.domElement,"PowerQueryContainerId-1"),Ca||(Ca=this.De),H.DOMElementExtensions.setFocus(Ca));return!Hb}Bh(Ca){return H.DOMElementExtensions.Df(this.mc,Ca)}Sg(Ca){this.Is=Ca;const Hb=this.taskPaneManager;this.isVisible=Ca;this.taskPaneManager.KB();Ca&&0<Hb.RD.length&&(!Hb.Lh||17!==Hb.Lh.taskPane.Qh||Hb.isCollapsed)&&Hb.yI(this,!0)}jU(){const Ca=document.getElementById(this.$.Cb+v.a.zId);
Ca.setAttribute(R.a.ariaLabel,S.a.instance.ga(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?2288:2201));var Hb=this.vM();Ca.appendChild(Hb);Hb=xd.b("div","PowerQueryPaneBodyId",zf);Ca.appendChild(Hb);return Hb}vM(){const Ca=xd.b("div","PowerQueryPaneHeaderId",Ye),Hb=xd.b("span","PowerQueryPaneTitleId",kf);Hb.innerText=this.titleText;this.De=ma.a.ob("PowerQueryPaneCloseButtonId",Df,S.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.De.classList.add(vb.AFrameworkApplication.isRtl?
v.a.yja:v.a.zja);O.a.instance.ta(x.a.click,this.De,this.tl);this.qFe=Ga.KeyInputManager.instance.Mt(this.De,this.tl,Ka.a.Sh);Ca.appendChild(Hb);Ca.appendChild(this.De);return Ca}static la(Ca,Hb){var cc=Ca.Cb;let ca=document.getElementById(cc+v.a.zId);ca||(ca=document.createElement("div"),ca.id=Ca.Cb+v.a.zId,qa.a.Gd(Ca)||document.getElementById(cc+v.a.SV).appendChild(ca));ca.classList.add($d);cc=Ca.da;return cc.Ba(408)||cc.Ha(408,new Of(ca,Ca,Hb))}}Object(b.a)(Of,"PowerQueryTaskPane",C.a,[549,3,457,
63]);class Bb extends pb.a{constructor(Ca){super();this.hh=this.gi=null;this.$=Ca;this.Gb()}get yD(){this.gi||(this.gi=oa.TaskExtensions.za(ob.a(this.$),Ca=>{this.hh=Of.la(this.$,Ca.result)},this.ka,3));return this.gi}create(){const Ca=wa.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),Hb=wa.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);oa.TaskExtensions.za(oa.TaskExtensions.ts(oa.TaskExtensions.Md([Ca,Hb],this.ka),()=>this.yD,this.ka),()=>{this.qb(this.hh)},this.ka,3)}dispose(){this.hh=
this.gi=this.$=null;super.dispose()}static la(Ca){Ca.da.Ha(409,new Bb(Ca))}}Object(b.a)(Bb,"PowerQueryTaskPaneFactory",pb.a,[]);var Vb=a(155),rc=a(643);class Kc extends $e.a{constructor(Ca,Hb,cc,ca){super(Ca);this.duj=(ia,Sb)=>{switch(ia){case 0:D.EwaSettings.isChangeGateEnabled("OfficeVSO:7549735_ResolveChallengeDisposeNewChallenge")&&this.hide();this.uTi();break;case 1:D.EwaSettings.isChangeGateEnabled("OfficeVSO:7549735_ResolveChallengeDisposeNewChallenge")&&this.hide(),this.FUi(Sb),D.EwaSettings.isChangeGateEnabled("OfficeVSO:7549735_ResolveChallengeDisposeNewChallenge")||
this.hide()}e.ULS.sendTraceTag(509613449,0,20,`PowerQueryReactFlowDialog.ResolveChallengeFlow committed with action button: ${rc.a[ia]}`)};e.ULS.sendTraceTag(512267668,0,50,"PowerQueryReactFlowDialog.PowerQueryReactFlowDialog");this.Dq=Hb;this.Dq.id=this.pc;this.uTi=ca;this.FUi=cc}get pc(){return"PowerQueryFlowDialog"}tg(){e.ULS.sendTraceTag(509613450,0,50,`PowerQueryReactFlowDialog.initializeAndShowDialog started. FlowID: ${this.Dq.FlowProps.flowId}`);this.initializeAndShow("",this.duj,this.Dq)}}
Object(b.a)(Kc,"PowerQueryReactFlowDialog",$e.a,[]);class cd{constructor(){this.flowId=0}}Object(b.a)(cd,"PowerQueryFlowProps",null,[]);class Nd extends cd{constructor(){super();this.resourcePath=this.resourceKind=null}}Object(b.a)(Nd,"PowerQueryResolveChallengeFlowProps",cd,[]);class Vd{constructor(Ca,Hb){this.cuj={["height"]:440,["width"]:650};this.$=Hb;this.iye=Ca}V6c(Ca,Hb,cc,ca){let ia;switch(cc){case -1496653501:ia=this.U5h(ca.kind,ca.path)}return new Kc(this.$,ia,Ca,Hb)}dispose(){this.iye=
this.$=null}U5h(Ca,Hb){const cc=this.jXh();cc.bodyProps=this.cuj;let ca=new Nd;ca.flowId=0;ca.resourceKind=Ca;ca.resourcePath=Hb;cc.FlowProps=ca;return cc}jXh(){const Ca={isModal:!0};Ca.Locale=this.$.ya.UICultureTag;Ca.SessionId=this.$.ya.UserSessionId;Ca.HostContextType=this.$.ya.PowerQueryHostContextType;Ca.PowerQueryEndpointUrl=this.$.ya.PowerQueryEndpointUrl;Ca.AuthTokenAsyncCallback=this.iye;return Ca}}Object(b.a)(Vd,"PowerQueryReactFlowDialogBuilder",null,[]);class ge{constructor(Ca,Hb){this.eya=
"kind";this.tHd="path";this.Bbh="connectionName";this.ecb="queryName";this.$Xd=()=>{const cc=this.z0j();cc&&(e.ULS.sendTraceTag(509613448,0,50,`PowerQueryUIFlowManager:ResolveChallenge: starting resolve challenge flow.
         Kind: ${cc[this.eya]}`),this.xId.V6c(this.EVh(cc[this.ecb]),this.buj,-1496653501,cc).tg())};this.buj=()=>{this.ICb=!1;this.$Xd()};this.$=Ca;this.powerQueryManager=Hb;this.xId=new Vd(Hb.sgd,Ca);this.ERa=[];this.ICb=!1;this.FLb=new J.a(!1)}Rc(){return!1}Mc(){return!1}executeCommand(Ca,Hb,cc){Ca=oa.TaskExtensions.Yj();switch(Hb.command){case -1496653501:return this.ojg(cc)||(Array.enqueue(this.ERa,cc),this.$Xd()),Ca;default:return rb.a(Hb.command)}}dispose(){this.$=this.powerQueryManager=null;
this.xId.dispose();this.FLb=this.ERa=this.xId=null}Ac(Ca,Hb){switch(Hb.command){case -1496653501:return!0;default:return!1}}z0j(){return!this.ICb&&0<this.ERa.length?(this.ICb=!0,Array.dequeue(this.ERa)):null}o0j(){for(let Ca=this.ERa.length-1;0<=Ca;Ca--){let Hb=this.ERa[Ca];this.ojg(Hb)&&e.ULS.sendTraceTag(509636695,0,50,`PowerQueryUIFlowManager:ResolveChallenge: auto resolve challenge succeeded.
           Kind: ${Hb[this.eya]}`)}this.cjg()}ojg(Ca){var Hb=this.uOf(Ca);Hb=this.FLb.getItem(Hb);if(!Hb||Array.contains(Hb,Ca[this.ecb]))return e.ULS.sendTraceTag(509613447,0,50,`PowerQueryUIFlowManager:ResolveChallenge: try auto resolve challenge failed.
         isCached: ${!!Hb},
         prevResolved: ${Array.contains(Hb,Ca[this.ecb])}`),!1;Array.remove(this.ERa,Ca);this.ICb=!1;Array.add(Hb,Ca[this.ecb]);this.powerQueryManager.cKb(Ca[this.ecb]);return!0}Q6j(Ca){var Hb=this.uOf(Ca);const cc=Ca[this.ecb];this.FLb.kb(Hb)?(Hb=this.FLb.getItem(Hb),Hb.includes(cc)||Array.add(Hb,cc)):this.FLb.add(Hb,[cc]);e.ULS.sendTraceTag(509613446,0,50,`PowerQueryUIFlowManager:ResolveChallenge: Cache updated with Kind: ${Ca[this.eya]}`)}uOf(Ca){return Ca[this.eya].concat("_",Ca[this.tHd])}cjg(){this.ICb=
!1;this.$Xd()}EVh(Ca){return Hb=>Object(Vb.a)(this,void 0,void 0,function*(){if(Hb){var cc=[];Hb.forEach(ca=>{cc.push({K:ca[this.eya],P:ca[this.tHd],ID:ca[this.Bbh],V:null})});ce(this.$.pa.va,cc,2,ca=>{!ca||0<ca.Errors.length?e.ULS.sendTraceTag(509743360,0,10,`PowerQueryUIFlowManager:ResolveChallenge: success callback failure: ${ca.Result}`):(1<Hb.length&&e.ULS.sendTraceTag(509649952,0,10,"PowerQueryUIFlowManager:ResolveChallenge: commit result array contains more than one result"),this.powerQueryManager.cKb(Ca),
e.ULS.sendTraceTag(509613445,0,20,`PowerQueryUIFlowManager:ResolveChallenge: Write Roaming succeeded, challenge resolved.
          Kind: ${Hb[0][this.eya]}`),this.Q6j({kind:Hb[0][this.eya],path:Hb[0][this.tHd],queryName:Ca}),this.o0j())},()=>{e.ULS.sendTraceTag(509743330,0,10,`PowerQueryUIFlowManager:ResolveChallenge: Write Roaming failed,
          Kind: ${Hb[0][this.eya]}`);this.cjg()},null,null)}else e.ULS.sendTraceTag(509691530,0,10,"PowerQueryUIFlowManager:ResolveChallenge: commit result null")})}}Object(b.a)(ge,"PowerQueryUIFlowManager",null,[222,3]);class we extends Nb.a{constructor(Ca){super(Ca)}ld(){this.$.jz(()=>{oa.TaskExtensions.za(wa.GetServiceTaskFactory.Pa(this.$.da,470,471,this.Na),Ca=>{this.fd([new ge(this.$,Ca.result)])},this.$.ka,3)})}static la(Ca){Nb.a.Rd(512,new we(Ca))}}Object(b.a)(we,"PowerQueryUIFlowManagerFactory",
Nb.a,[]);class Le{getExpandedRangeForPivotTable(Ca,Hb,cc,ca,ia,Sb,Oc,td=null){td=Ca.Oa(1,td);td.sheetRange=Hb;td.activeCell=cc;return A.g(Ca,"GetExpandedRangeForPivotTable",td,ca,ia,Sb,Oc,0)}}Object(b.a)(Le,"ExpandRange",null,[548]);class Te extends pb.a{constructor(Ca){super();this.$=Ca;this.Gb()}static la(Ca){Ca.da.Ha(483,new Te(Ca))}create(){var Ca;this.qb(null!==(Ca=this.$.da.Ba(482))&&void 0!==Ca?Ca:this.$.da.Ha(482,new Le))}}Object(b.a)(Te,"ExpandRangeFactory",pb.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");c.a.ni(".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}");c.a.ni('.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}');
c.a.ni('.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}');
(()=>{Gb.a.Fa(Ca=>{const Hb=Object(ib.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(pa.c)($a.a.resolve(cb.L,{Wb:1})):wa.GetServiceTaskFactory.Pa(Ca.da,12,477,1);oa.TaskExtensions.za(Hb,cc=>{Jb.la(Ca,cc.result)},Ca.ka)})})();(()=>{Gb.a.Fa(Ca=>{Fc.la(Ca);Cb.la(Ca);Aa.la(Ca)})})();Gb.a.Fa(ye.la);(()=>{Gb.a.Fa(Ca=>{rf.la(Ca)})})();Gb.a.Fa(he.xHa);Gb.a.Fa(Sd.la);(()=>{Gb.a.Fa(Ca=>{Ed.la(Ca);yd.la(Ca);Wf.la(Ca)})})();(()=>{Gb.a.Fa(Ca=>{kc.la(Ca);Od.la(Ca)})})();(()=>{Gb.a.Fa(Ca=>
{Wd.la(Ca);Nc.la(Ca);Bb.la(Ca);le.la(Ca);we.la(Ca)})})();(()=>{Gb.a.Fa(Ca=>{Te.la(Ca)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.bi.js.map/784e2f063a91fabd3a18f873ba8615d6/EwaDSEsNext.bi.js.map