var clipboardPlatform=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=655)}({1:function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return n})),r.d(t,"__assign",(function(){return o})),r.d(t,"__rest",(function(){return i})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return l})),r.d(t,"__runInitializers",(function(){return d})),r.d(t,"__propKey",(function(){return u})),r.d(t,"__setFunctionName",(function(){return p})),r.d(t,"__metadata",(function(){return g})),r.d(t,"__awaiter",(function(){return f})),r.d(t,"__generator",(function(){return m})),r.d(t,"__createBinding",(function(){return h})),r.d(t,"__exportStar",(function(){return b})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return S})),r.d(t,"__spread",(function(){return C})),r.d(t,"__spreadArrays",(function(){return v})),r.d(t,"__spreadArray",(function(){return E})),r.d(t,"__await",(function(){return w})),r.d(t,"__asyncGenerator",(function(){return L})),r.d(t,"__asyncDelegator",(function(){return T})),r.d(t,"__asyncValues",(function(){return _})),r.d(t,"__makeTemplateObject",(function(){return I})),r.d(t,"__importStar",(function(){return P})),r.d(t,"__importDefault",(function(){return A})),r.d(t,"__classPrivateFieldGet",(function(){return j})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return M}));var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}function s(e,t,r,a){var n,o=arguments.length,i=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(o<3?n(i):o>3?n(t,r,i):n(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,a){t(r,a,e)}}function l(e,t,r,a,n,o){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=a.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?a.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,a.name):{}),p=!1,g=r.length-1;g>=0;g--){var f={};for(var m in a)f[m]="access"===m?{}:a[m];for(var m in a.access)f.access[m]=a.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");o.push(i(e||null))};var h=(0,r[g])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(s=i(h.get))&&(u.get=s),(s=i(h.set))&&(u.set=s),(s=i(h.init))&&n.push(s)}else(s=i(h))&&("field"===c?n.push(s):u[l]=s)}d&&Object.defineProperty(d,a.name,u),p=!0}function d(e,t,r){for(var a=arguments.length>2,n=0;n<t.length;n++)r=a?t[n].call(e,r):t[n].call(e);return a?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,a){return new(r||(r=Promise))((function(n,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))}function m(e,t){var r,a,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(r=1,a&&(n=2&s[0]?a.return:s[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,s[1])).done)return n;switch(a=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,a=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){i.label=s[1];break}if(6===s[0]&&i.label<n[1]){i.label=n[1],n=s;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(s);break}n[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],a=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var h=Object.create?function(e,t,r,a){void 0===a&&(a=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,n)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]};function b(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function v(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var a=Array(e),n=0;for(t=0;t<r;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,n++)a[n]=o[i];return a}function E(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function L(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,n=r.apply(e,t||[]),o=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(e){n[e]&&(a[e]=function(t){return new Promise((function(r,a){o.push([e,t,r,a])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,l):d(o[0][2],r)}catch(e){d(o[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function T(e){var t,r;return t={},a("next"),a("throw",(function(e){throw e})),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,n){t[a]=e[a]?function(t){return(r=!r)?{value:w(e[a](t)),done:!1}:n?n(t):t}:n}}function _(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(r){t[r]=e[r]&&function(t){return new Promise((function(a,n){(function(e,t,r,a){Promise.resolve(a).then((function(t){e({value:t,done:r})}),t)})(a,n,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return O(t,e),t}function A(e){return e&&e.__esModule?e:{default:e}}function j(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)}function x(e,t,r,a,n){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?n.call(e,r):n?n.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},106:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,a){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(a,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var a={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])}));var n=Object.getPrototypeOf(t);n&&"object"==typeof n&&Object.keys(n).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])}));var o={};return Object.keys(a).forEach((function(t){o[t]=e(a[t],r+1)})),o}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var a=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(a,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),a=function(t){r=r.catch((function(r){return e(t,r)}))},n=1;n<=t;n+=1)a(n);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),a=function(a){var n=e[a];r=r.catch((function(){return t(n)}))},n=1;n<e.length;n+=1)a(n);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,a=e.length,n=0;n<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==a-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));var o=t+35685*r+(23896*r<<16)&4294967295;return o<0&&(o+=4294967296),o},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var a=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,t))&&(a=o.offset,n=null!=o.offsetNode&&null!=o.offsetNode.parentElement&&"SPAN"===o.offsetNode.parentElement.nodeName?o.offsetNode.parentElement:o.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(o=document.caretRangeFromPoint(e,t))&&(a=o.startOffset,n=null!=o.startContainer&&null!=o.startContainer.parentElement&&"SPAN"===o.startContainer.parentElement.nodeName?o.startContainer.parentElement:o.startContainer)}else try{var o;n=document.elementFromPoint(e,t),(o=document.body.createTextRange()).moveToPoint(e,t);var i=document.body.createTextRange();i.moveToElementText(n),i.setEndPoint("EndToStart",o),a=i.text.length}catch(e){return a}if(r)for(var s=!1;null!=n;)null===n.previousSibling&&null!==n.parentNode&&null!==n.parentNode.parentNode&&n.parentNode.parentNode.childNodes.length>1&&!s?(n=n.parentNode,s=!0):null!=(n=n.previousSibling)&&null!=n.textContent&&(a+=n.textContent.length,s&&(a+=1));else for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(a+=n.textContent.length);return a},t.getBoundingRectForText=function(e,t,r,a){function n(e,t,r){if(!e||!e.textContent)return t;if(a&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var o=e.childNodes,i=0;i<o.length&&t>=0;i+=1)t=n(o[i],t,r),a&&"DIV"===o[i].nodeName&&(t-=1);return t}void 0===a&&(a=!1);var o=document.createRange();return n(e,t,(function(e,t){return o.setStart(e,t)})),n(e,r,(function(e,t){return o.setEnd(e,t)})),o.getBoundingClientRect()}},125:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var a={};t.promises=function(){return void 0===a.promises&&(a.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),a.promises}},126:function(e,t,r){"use strict";function a(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,r){e[t]=a()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=a(),r=e,o=t,i={},s=function(e,t,a){return function(e,t,r,a,o,i){n(e,"end",r);var s={sessionName:t,result:a?"success":"failure",message:i,marks:e},c=JSON.stringify(s);o(c)}(i,r,o,e,t,a)};return i.start=0,{mark:function(e){return function(e){return n(i,e,o)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=a},134:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var a=r(204);t.globalThis=a},163:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var a=r(164),n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,a.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),n=e}},164:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1);a.__exportStar(r(165),t),a.__exportStar(r(166),t)},165:function(e,t,r){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){a=e};t.isChangeGateEnabled=function(e){return!a||a.isChangeGateEnabled(e)}},166:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},167:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var a=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(a=function(){return self.performance.now()}),function(r){var n=a(),o=r;return{reset:function(e){null!=e&&(o=e),n=a()},stop:function(r){var i=a()-n,s=JSON.stringify({Target:o,Duration:i.toFixed(t),StopInfo:r});e(s)}}}}},168:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var a=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=a},169:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,a=r.crypto||r.msCrypto;if(a){t.crypto=!0;try{return a.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var n=!1,o=r.performance;try{o&&o.now&&o.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var i=0;i<e.length;i+=1){try{if(n){t.perfNow=!0;var s=Math.floor(100*o.now())%10;(s<0||s>9)&&(s=0);for(var c=0;c<s;c+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=15&e[r];return r+=1,("x"===t?a:3&a|8).toString(16)})),t]}},170:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},171:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0;t.replaceChildren=function(e){if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)};t.isReplaceChildrenSupported=function(e){return!!e.replaceChildren}},2:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var a=r(106);t.utils=a;var n=r(56);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return n.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return n.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return n.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return n.ConsoleLogger}});var o=r(125);t.browserSupport=o;var i=r(126);t.perfWatch=i;var s=r(163);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var c=r(167);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return c.initStopwatchFactory}});var l=r(168);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return l.TelemetryCollector}});var d=r(169);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return d.getNewGuid}});var u=r(170);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return u.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return u.TextAreaInputMode}});var p=r(171);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return p.replaceChildren}})},204:function(e,t,r){"use strict";e.exports=r(205)()?globalThis:r(206)},205:function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},206:function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},207:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var a=r(97);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,a.getBooleanFeatureGate)(t,r);case"number":return(0,a.getNumberFeatureGate)(t,r);case"string":return(0,a.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},208:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var a=r(98);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,a.isChangeGateEnabled)(e)}}},209:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var a=r(1),n=r(98);function o(e){var t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return a.__assign(a.__assign({},r),e)})),t}t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)}},210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var a=r(1),n=r(97);function o(e){for(var t,r,o={},i=0,s=Object.keys(e);i<s.length;i++){var c=s[i];o[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var l=null!==(r=(0,n.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,n.setFeatureGateDictionaryGetter)((function(){return a.__assign(a.__assign({},l()),o)})),l}t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)}},22:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1);a.__exportStar(r(97),t),a.__exportStar(r(207),t),a.__exportStar(r(98),t),a.__exportStar(r(208),t),a.__exportStar(r(209),t),a.__exportStar(r(210),t)},3:function(e,t,r){"use strict";var a={};r.r(a),r.d(a,"sharedClipboardSettingsVariableName",(function(){return ge})),r.d(a,"defaultPromiseTimeoutInMinutes",(function(){return he})),r.d(a,"getSharedClipboardSettings",(function(){return be})),r.d(a,"initializeSharedClipboardSettingsFromWindow",(function(){return ye})),r.d(a,"initializeSharedClipboardSettings",(function(){return Se})),r.d(a,"createEmptySharedClipboardSettings",(function(){return ve}));var n={};r.r(n),r.d(n,"divTagName",(function(){return Mt})),r.d(n,"preTagName",(function(){return Dt})),r.d(n,"tableTagName",(function(){return Wt})),r.d(n,"trTagName",(function(){return Rt})),r.d(n,"tdTagName",(function(){return Ut})),r.d(n,"ccpTimestampHtmlCustomAttributeName",(function(){return Vt})),r.d(n,"minCcpTimestampHtmlCustomAttributeValue",(function(){return Gt})),r.d(n,"ensureOneLFPerNewLine",(function(){return Bt})),r.d(n,"trimToLength",(function(){return Kt})),r.d(n,"createTextHtmlFromTextPlain",(function(){return qt})),r.d(n,"createHtmlItemFromTextPlain",(function(){return Xt})),r.d(n,"createPlainTextFromHtml",(function(){return Yt})),r.d(n,"isContainsTimestampWrapper",(function(){return $t})),r.d(n,"addClipboardWrapperForEdge",(function(){return Zt})),r.d(n,"getFragmentFromTextHtml",(function(){return er})),r.d(n,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",(function(){return tr})),r.d(n,"getExternalSource",(function(){return rr})),r.d(n,"encodeAngleBrackets",(function(){return ar})),r.d(n,"wrapContentWithTagAndAttributes",(function(){return nr}));var o,i=r(2);function s(){return o}function c(e){if(!e)throw new Error("The 'logger' argument is missing");o=i.ULS.getFromExternalLogger(e)}var l,d,u,p,g,f=r(1);!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(g||(g={}));var m=r(22);function h(e,t){return b(e,[t])}function b(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;if(!function(e){if(!e&&0!==e)return!1;var t=Number(e);if(isNaN(t)||t.toString()!==e.toString())return!1;return!0}(e.reason))return!1;return!0}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}function y(e){if(!Object(m.isChangeGateEnabled)("OfficeVSO:7488405_CheckIfLocalStorageSupported"))return!1;if(e&&"object"==typeof e){if(S(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(S(JSON.parse(e.innerError).reason))return!0}catch(e){}}if("string"==typeof e)try{if(S(JSON.parse(e).reason))return!0}catch(e){}return!1}function S(e){return e===d.LocalStorageInitilizationInaccessible}var C=function(e){function t(r,a,n){var o=this,c=t.augmentParameterValue(r);if((o=e.call(this,c)||this).name=t.augmentParameterValue(a),o.errorName=o.name,o.name?s().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '".concat(o.name,"': ").concat(c)):s().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: ".concat(c)),n){o.innerError=n;var l=o.innerError.message;l||(l=o.innerError.name);var d=t.augmentParameterValue(l);d.length>0&&s().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: ".concat(d))}return o.stack||(o.stack=(new Error).stack),o}return Object(f.__extends)(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():""},t}(Error),v=function(e){function t(t,r){return e.call(this,t,"NoValidKeyError",r)||this}return Object(f.__extends)(t,e),t}(C),E=function(e){function t(r,a,n){var o=this,i=C.augmentParameterValue(a),s=t.getDefaultMessage(i),c=C.augmentParameterValue(r);return 0===c.length&&(c=s),(o=e.call(this,c,"MissingArgumentError",n)||this).name=i,o}return Object(f.__extends)(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '".concat(e,"'")),t},t}(C),w=function(e){function t(r,a,n,o){var i=this,s=C.augmentParameterValue(a),c=n;c||(c="");var l=t.getDefaultMessage(s,c),d=C.augmentParameterValue(r);return 0===r.length&&(d=l),(i=e.call(this,d,"InvalidArgumentError",o)||this).name=s,i.value=c,i}return Object(f.__extends)(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '".concat(e,"' argument: '").concat(t,"'"):"Invalid argument"},t}(C),L=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return Object(f.__extends)(t,e),t}(C),T=function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}return Object(f.__extends)(t,e),t}(C),_=function(e){function t(t,r,a,n,o){return e.call(this,"".concat(t,". Data version: ").concat(r,", Infra version: ").concat(a,", blockMismatchDataVersion: ").concat(n),"MismatchVersionError",o)||this}return Object(f.__extends)(t,e),t}(C),I=function(e){function t(t,r,a,n){return e.call(this,"".concat(t,". Duration in clipboard (ms) : ").concat(r,", TTL (ms): ").concat(a),"TTLClipboardDataError",n)||this}return Object(f.__extends)(t,e),t}(C),O=function(e){function t(t,r,a,n){return e.call(this,"".concat(t,". Data User Hash : ").concat(r,", infra User Hash: ").concat(a),"UserHashMismatchError",n)||this}return Object(f.__extends)(t,e),t}(C),P=function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}return Object(f.__extends)(t,e),t}(C);function A(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:""}var j=function(e){function t(t,r,a,n,o){var i=e.call(this,r||"reason=".concat(t),a,n)||this;return i.reason=t,o&&(i.errorName=o),i}return Object(f.__extends)(t,e),t}(C),x=function(e){function t(t,r,a){return e.call(this,t,r,"CopyError",a,A(t,u))||this}return Object(f.__extends)(t,e),t}(j),M=function(e){function t(t,r,a){return e.call(this,t,r,"PasteError",a,A(t,p))||this}return Object(f.__extends)(t,e),t}(j),D=function(e){function t(t,r,a){return e.call(this,t,r,"CancelError",a,A(t,g))||this}return Object(f.__extends)(t,e),t}(j),W=function(e){function t(t,r,a){return e.call(this,t,r,"ClipboardPlatformError",a,A(t,d))||this}return Object(f.__extends)(t,e),t}(j),R=function(e){function t(t,r,a){return e.call(this,t,r,"SharedClipboardError",a,A(t,d))||this}return Object(f.__extends)(t,e),t}(j);function U(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #".concat(t," threw an exception: ").concat(e.message)),r||(r=new L(e.message,e))}else s().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #".concat(t," is empty"))})),r)throw r}else s().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}function F(){return N}var N={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:""},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:""}},k={};function J(){k={}}var z=new RegExp("(\\bTrident/| MSIE )"),H=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function V(){if(void 0===k.isIEProperty){k.isIEProperty=!1;var e=F();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(z);r&&2===r.length&&(k.isIEProperty=!0)}}}return k.isIEProperty}function G(){if(void 0===k.isEdgeProperty){k.isEdgeProperty=!1,k.isEdgeWithTextHtmlClipboardSupportProperty=!1,k.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=F();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(H);if(r&&2===r.length){k.isEdgeProperty=!0;var a=Number(r[1]);isNaN(a)||(a>=16.16299&&(k.isEdgeWithTextHtmlClipboardSupportProperty=!0),a>=17.17123&&(k.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return k.isEdgeProperty}function B(){return G()&&k.isEdgeWithTextHtmlClipboardSupportProperty}function K(){return G()&&k.isEdgeVersionWithTextHtmlWrapperSupportProperty}function q(){var e=F(),t=!1;if(e&&e.userAgent){var r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}function X(){return Y}var Y={postMessage:function(e,t,r,a){e.postMessage(t,r,a)}},Q=function(e,t,r,a){return void 0===a&&(a=!1),e.addEventListener(t,r,a),function(){e.removeEventListener(t,r,a)}};function $(){return{items:{}}}var Z,ee,te,re,ae=(Z={items:{}},{getData:function(){return Z},getItem:function(e){},setItem:function(e,t){throw new L("Cannot set an item with clipboard data format '".concat(e,"' in an immutable empty clipboard (content is ").concat(t&&t.length>0?"not ":"","empty)"))},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return pe(void 0)}});function ne(){return ae}function oe(e){return e&&e.items?Object.keys(e.items).length:0}function ie(e){return oe(e&&e.getData())}function se(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return ce(t,e)};return{getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new E("","clipboardItemsData");if(!e.items)throw new w("","clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return pe(t)}}}function ce(e,t){if(!e)throw new E("","clipboardItemsData");if(!e.items)throw new w("","clipboardItemsData.items");return e.items[t]}function le(e,t){if(!e||0===e.length||!t||!t.trim())return"";var r=void 0;return e.forEach((function(e){e.clipboardDataFormat===t&&(r=e.data)})),r||""}function de(e){return le(e,"text/plain")}function ue(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:"text/plain",data:""}),t}function pe(e){var t=[];if(0===oe(e))return t;for(var r in e.items){var a=ce(e,r);a||(a="");var n={clipboardDataFormat:r,data:a,deferred:!1};t.push(n)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}(ee||(ee={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink"}(te||(te={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(re||(re={}));var ge="sharedClipboardSettings",fe=ve(),me=!1,he=2;function be(){if(!me)throw new L("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return fe}function ye(){me=!1,function(){if(!window||!(ge in window))return fe=ve(),void(me=!0);var e=window[ge];if(!e||"object"!=typeof e)return fe=ve(),void(me=!0);Ce(e)}()}function Se(e){me=!1,Ce(e)}function Ce(e){if(!e)throw new E("","sharedClipboardSettingsCandidate");var t=ve();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return fe=t,void(me=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),fe=t,void(me=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,a=r.indexOf("-");a>=0&&(r=r.substr(a+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){s().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],fe=t,void(me=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){s().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' or '").concat(r,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0)}t.whitelistOriginComponents=!0,fe=t,me=!0}function ve(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:"",sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:he,remoteLoggerPath:""}}function Ee(){var e="";return window&&window.location&&window.location.origin?(e=window.location.origin)||(e=""):(s().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: ".concat(!!window,". is window.location exist: ").concat(window&&!!window.location,". is window.location.origin exist ").concat(window&&window.location&&!!window.location.origin,". is window.location.protocol exist ").concat(window&&window.location&&!!window.location.protocol,". is window.location.hostname exist ").concat(window&&window.location&&!!window.location.hostname,". is window.location.port exist ").concat(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}var we,Le,Te=new RegExp("^\\d+$"),_e=!1;function Ie(e){if(!e)throw new E("","origin");var t="",r=e.trim().toLowerCase().split("://",3);if(!r||0===r.length||!r[0]||"http"!==r[0]&&"https"!==r[0])throw new w("Missing protocol","origin",e);if(1===r.length)throw new w("Missing domain","origin",e);if(r.length>2)throw new w("'".concat("://","' should appear once"),"origin",e);var a=r[1];if(!a)throw new w("Missing domain","origin",e);if(t=r[0]+"://",!(r=(a=a.trim()).trim().split("/",3))||0===r.length||!r[0]||!r[0].trim())throw new w("Missing domain","origin",e);if(r.length>2)throw new w("The last part of the origin should be the domain","origin",e);if(2===r.length&&r[1])throw new w("The last part of the origin should be the domain","origin",e);if(!(r=a.split(":",3))||0===r.length||!r[0]||!r[0].trim())throw new w("Missing domain","origin",e);if(r.length>2||2===r.length&&(!r[1]||!r[1].trim()))throw new w("The last part of the origin should be the domain and an optional port number","origin",e);if(t+=a=r[0].trim(),2===r.length){var n=r[1].trim(),o=Te.exec(n);if(!o||1!==o.length)throw new w("Invalid port number","origin",e);var c=Number(n);if(isNaN(c))throw new w("Invalid port number","origin",e);t+=":"+n}return s().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '".concat(e,"'; validated origin = '").concat(t,"'")),t}function Oe(e){Me();var t=Ie(e),r=t.split("://");if(!r||2!==r.length||!r[0]||!r[1])throw new w("Invalid origin","parentOrigin",e);var a=be(),n="";if(a.whitelistOriginComponents){var o=r[0]+"://";if(!(r=r[1].split("."))||r.length<2||!r[0])throw new w("Invalid origin","parentOrigin",e);r.splice(0,1,a.sharedClipboardHostingApp),n=o+r.join(".")}else n=t;return s().ULS.traceTag(596452424,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getSharedClipboardValidatedOrigin: app's origin = '".concat(e,"'; Shared Clipboard iframe origin = '").concat(n,"' components=").concat(JSON.stringify(r))),n}function Pe(e){Me();var t=Ie(e),r=Ie(Ee().origin);if(t===r)return t;if(!be().whitelistOriginComponents)throw new L("validateOriginForReceivedMessage: Caller origin '".concat(e,"' doesn't match the current window's origin '").concat(r,"'"));var a=Ae(t),n=Ae(r);if(a.protocol!==n.protocol)throw new L("validateRemoteWindowOrigin: Caller origin's protocol '".concat(a.protocol,"' doesn't match the current window origin's protocol '").concat(n.protocol,"'"));if(a.environment!==n.environment)throw new L("validateRemoteWindowOrigin: Caller origin's environment '".concat(a.environment,"' doesn't match the current window origin's environment '").concat(n.environment,"'"));return t}function Ae(e){Me();var t=e.split("://",2),r=t[0],a=je(t[1]),n={protocol:r};if(n.environment=xe(e,a,Le),a.length<=n.environment.length+1)throw new w("Missing app component","origin",e);if("."!==a.charAt(n.environment.length))throw new w("Missing a domain separator after the environment component","origin",e);var o=a.substr(n.environment.length+".".length);if(n.app=xe(e,o,we),n.app.length<o.length&&"-"!==o.charAt(n.app.length))throw new w("When the Office Online app name is not the domain prefix, '".concat("-","' should precede it"),"origin",e);return n}function je(e){if(!e)throw new E("","stringToReverse");for(var t="",r=e.length-1;r>=0;r-=1)t+=e.charAt(r);return t}function xe(e,t,r){if(!t)throw new E("","reversedValidatedHostname");if(!r)throw new E("","reversedStringsToLengthMap");var a=t.length,n=Object.keys(r).filter((function(e){var n=r[e];return n<=a&&t.substr(0,n)===e}));if(n&&n.length>0)return je(n[0]);throw new w("Invalid origin","validatedOrigin",e)}function Me(){if(!_e){var e=be();e.whitelistOriginComponents&&(we=De(e.sharedClipboardHostingApps),Le=De(e.sharedClipboardHostingEnvironments),_e=!0)}}function De(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[je(e)]=e.length})),t):t}function We(e,t){return null==e||1===e||null==t||e!==t}function Re(){return Ne()}function Ue(){return Ne()}function Fe(e){if(!e)throw new E("","id");var t=e.trim().toLowerCase();if(0===t.length)throw new w("","id");return t}function Ne(){return(Math.random()+1).toString(36).substring(7)}function ke(e,t,r,a,n){var o={id:e,operationCode:t,destination:r,userHash:a,clipboardItemsData:n};return He(o),o}var Je=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function ze(e){return"get"===e||"set"===e||"init"===e}var He=function(e){if(!e)throw new E("","clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new E("","id");if(!e.operationCode)throw new E("","operationCode");if(!e.destination)throw new E("","destination");if(!ze(e.operationCode))throw new w("","operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects no clipboard items"),"clipboardItemsData")};function Ve(e,t,r,a,n){var o={id:e,operationCode:t,failed:r,error:a,clipboardItemsData:n};return Ge(o),o}var Ge=function(e){if(!e)throw new E("","clipboardOperationResultMessage");for(var t=!1,r=0,a=["failed","error","clipboardItemsData","operationCode","id","userHash"];r<a.length;r++){var n=a[r];if(e.hasOwnProperty(n)){t=!0;break}}if(!t)throw new v("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw s().ULS.traceTag(553747865,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Missing argument 'id'. keys: ".concat(JSON.stringify(Object.keys(e)),", isConstructorObject: ").concat(e.constructor===Object,", operationCode: ").concat(e.operationCode,", id: ").concat(e.id,", failed: ").concat(e.failed,", error: ").concat(e.error,".")),new E("","id");if(!e.operationCode)throw new E("","operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new w("","operationCode",e.operationCode);if(e.failed){if(!e.error)throw new w("A failed '".concat(e.operationCode,"' operation expects a non-empty error argument"),"error");if(e.clipboardItemsData)throw new w("A failed '".concat(e.operationCode,"' operation does not expect a clipboardItemsData argument"),"clipboardItemsData")}else{if(e.error)throw new w("'".concat(e.operationCode,"' expects an empty error argument"),"error");if("unknownresult"===e.operationCode)throw new w("'".concat(e.operationCode,"' can only be used with a failure message"),"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects a clipboardItems argument"),"clipboardItemsData")}else if(e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects no clipboardItemsData argument"),"clipboardItemsData")};function Be(e){if(!e||0===e.trim().length)throw new w("","className",e);return function(){var t=!1;function r(t){return"".concat(e,":").concat(t,": already disposed")}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new L(r(e))}}}()}var Ke=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=Be("".concat(e))}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,s().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '".concat(t.clipboardStrategyType,"' was initialized.")),Promise.resolve(t)}),(function(e){return s().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,y(e)?i.TraceLevel.Info:i.TraceLevel.Error,"Failed to initialize clipboard strategy type '".concat(t.clipboardStrategyType,"'. Error: ").concat(i.utils.getStringifiedError(e))),Promise.reject(e)}))},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new W(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new W(d.SetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").set"),e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new W(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)}))}catch(e){return Promise.reject(new W(d.GetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").get"),e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(ne(),e):(s().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new W(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new W(d.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),qe=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Xe(e){var t=e;return t&&0!==t.trim().length||(t=Re()),new Ze(t)}function Ye(){return qe?window.performance.now():Date.now()}function Qe(e){return qe?new Date(e+window.performance.timing.navigationStart):new Date(e)}function $e(e,t,r){if(!r)throw new E("","creationTimestamp");return"".concat(e?"Fulfilled":"Still unfulfilled"," after ").concat(e?t?t-r:"?":Ye()-r,"ms")}var Ze=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=Fe(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=Ye(),s().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' on ").concat(Qe(this.creationTimestamp))),this.promise=new Promise((function(e,t){s().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #".concat(r.sequenceId," with id '").concat(r.id,"' on ").concat(Qe(Ye()))),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Ye(),s().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #".concat(this.sequenceId," with id '").concat(this.id,"' as fulfilled (").concat(this.rejected?"rejected":"resolved","). ").concat($e(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))))},e.prototype.fulfillmentCheck=function(e){return s().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"'")),this.isFulfilled&&s().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"' since it was ").concat(this.rejected?"rejected":"resolved"," already on ").concat(Qe(this.fulfillmentTimestamp),". ").concat($e(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))),this.isFulfilled},e.sequenceId=0,e}();function et(){return new tt}var tt=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=Fe(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '".concat(e,"'.")),t.promise;s().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '".concat(e,"'."))},e.prototype.addNewPromise=function(e){var t=Xe(e);if(this.getDeferredPromise(t.id))throw new w("A deferred promise already exists in the cache for the specified id","id",t.id);var r=Fe(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '".concat(t.id,"'.")),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=Fe(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '".concat(e,"'."))}else s().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '".concat(e,"' since this id is not associated with an existing deferred promise."))},e.prototype.clear=function(){if(s().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing ".concat(this.getLength()," items from the cache")),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '".concat(e,"' with this exception: ").concat(t.message,". Ignoring."))}}this.deferredResultMessagePromiseCache={}},e}();function rt(e){if(!e)throw new E("","validator");return{deserialize:function(t){return function(e,t){if(!e)throw new E("","incomingMessage");if(!t)throw new E("","validator");if(0===e.length)throw new w("An empty message is invalid","incomingMessage");var r,a=e.trim();if(0===a.length)throw new w("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(a)}catch(t){throw new w("Deserialization failed","incomingMessage","Contains ".concat(e.length.toString()," characters"),t)}if(!r)throw new w("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function at(e){if(!e)throw new E("","validator");return{serialize:function(t){return function(e,t){if(!e)throw new E("","outgoingMessage");if(!t)throw new E("","validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new w("Serialization failed","outgoingMessage","".concat(Object.keys(e).length," properties"),t)}return s().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is ".concat(t.length)),t}(e)}(t,e)}}}function nt(e){if(!e)throw new E("","remoteWindow");if(!("window"in e)||!e.window)throw new E("","remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new E("","remoteWindow.windowOrigin");var t=Pe(e.windowOrigin);return{window:e.window,windowOrigin:t}}var ot=function(){function e(e,t,r,a){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=Be(a)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(U([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new E("","outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new L(t)}this.sender.postMessage(e)},e}();function it(){return st}var st={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};function ct(e,t,r){return new dt(e,t,r)}function lt(e,t,r){return new dt(e,t,r)}var dt=function(){function e(e,t,r){var a=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return a.onMessageReceived(e)},!e)throw new E("","deserializer");if(!t)throw new E("","handler");if(!r)throw new E("","windowRPC");this.disposableImplementationExtension=Be("WindowRPCReceiverInternal"),this.remoteWindow=nt(r.remoteWindow),it().addEventListener("message",this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(it().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. ".concat(i.utils.getStringifiedError(e)));try{this.handler.handleDeserializationError(e)}catch(e){s().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. ".concat(i.utils.getStringifiedError(e)))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){s().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. ".concat(i.utils.getStringifiedError(e)))}))}catch(e){s().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. ".concat(i.utils.getStringifiedError(e)))}else s().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();function ut(e,t){return new gt(e,t)}function pt(e,t){return new gt(e,t)}var gt=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new E("","serializer");if(!t)throw new E("","windowRPC");this.disposableImplementationExtension=Be("WindowRPCSenderInternal"),this.remoteWindow=nt(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new E("","outgoingMessage");if(!this.remoteWindow.window)throw new L("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new L("The remote window does not support postMessage");var t=this.serializer.serialize(e);X().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function ft(){try{return localStorage.setItem("XLO_CCP","1"),"1"===localStorage.getItem("XLO_CCP")}catch(e){return!1}}function mt(e){return"OfficeOnlineCCP_Data_"+e}function ht(e){return"OfficeOnlineCCP_Metadata_"+e}function bt(e){return ht(e)+"_LocalStorageChangedFlag"}var yt,St=function(){this.copyStatus=yt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0},Ct=function(){function e(){this.startTime=i.perfWatch.timeStamp()}return e.prototype.profilingMessage=function(e){var t=i.perfWatch.timeStamp()-this.startTime;return"onPasteProfiling: ".concat(e,", pasteId: ").concat(this.id,", timeMS: ").concat(t.toFixed())},e}();function vt(){return{}}function Et(e){var t=void 0;return e&&e.lastCopy&&(t=Object(f.__assign)({},e.lastCopy)),{lastCopy:t}}function wt(e){try{s().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '".concat(ee.LocalStorage,"'"));var t=new Lt(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(yt||(yt={}));var Lt=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new W(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new W(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=ee.LocalStorage,this.disposableImplementationExtension=Be("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),s().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters.id='".concat(e?e.id:"","'"));var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(ne());try{var r=JSON.parse(t);if(!r||0===oe(r))return Promise.resolve(ne());var a=se(r);return Promise.resolve(a)}catch(e){return Promise.resolve(ne())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),s().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count=".concat(ie(e),"'; commandParameters.id='").concat(t?t.id:"","'")),0===ie(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r="".concat(this.localStorageKey+"_LocalStorageChangedFlag"),a=Re();return s().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = ".concat(r,". eventFlagValue = ").concat(a)),localStorage.setItem(r,a),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),["text/plain","text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Tt(e){return s().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '".concat(l.LocalStorage,"' with localStorageKey: '").concat(e,"'")),(new _t).initialize(wt(e))}var _t=function(e){function t(t){return e.call(this,l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(f.__extends)(t,e),t}(Ke),It=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;s().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),s().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ".concat(e.key,". localStorageKeyToWatch = ").concat(this.localStorageKeyToWatch,". lastLocalStorageValue = ").concat(this.lastLocalStorageValue)),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),s().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){s().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return s().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),s().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ".concat(e.lastLocalStorageValue))}),(function(e){s().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return s().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ".concat(this.lastLocalStorageValue,". currentLocalStorageValue = ").concat(e)),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(s().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged())return s().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),Promise.resolve();var r=Xe(),a=new Date,n=setInterval((function(){var o=(new Date).getTime()-a.getTime();s().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ".concat(a,". elapseTime = ").concat(o,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),t.isLocalStorageValueChanged()?(clearInterval(n),s().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ".concat(a,". elapseTime = ").concat(o,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.resolve()):o>e&&(clearInterval(n),s().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ".concat(a,". elapseTime = ").concat(o,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.reject())}),200);return r.promise},e}(),Ot="\n",Pt=new RegExp("(".concat(Ot).concat("\r",")|(").concat("\r").concat(Ot,")|(").concat("\r",")"),"g"),At=new RegExp("(".concat("\t",")"),"g"),jt=new RegExp("<","g"),xt=new RegExp(">","g"),Mt="div",Dt="pre",Wt="table",Rt="tr",Ut="td",Ft="\x3c!--EndFragment--\x3e",Nt="\x3c!--StartFragment--\x3e".length,kt=Ft.length,Jt="Version:0.9".concat(Ot,"StartHTML:0000000").concat(100).concat(Ot,"EndHTML:{EndHTML0}").concat(Ot,"StartFragment:0000000").concat(134).concat(Ot,"EndFragment:{EndFragm}").concat(Ot,"<html>").concat(Ot,"<body>").concat(Ot).concat("\x3c!--StartFragment--\x3e").concat(Ot),zt="".concat(Ft).concat(Ot,"</body>").concat(Ot,"</html>"),Ht="</html>".length,Vt="data-ccp-timestamp",Gt=0;function Bt(e){return e?e.replace(Pt,Ot):e}function Kt(e){return e?e.length<=10240?e:e.substr(0,10240):""}function qt(e){var t,r=ar(e),a=function(e){return e?e.replace(Pt,"</".concat(Ut,"></").concat(Rt,"><").concat(Rt,"><").concat(Ut,">")):e}((t=r)?t.replace(At,"</".concat(Ut,"><").concat(Ut,">")):t);return"<".concat(Wt,"><").concat(Rt,"><").concat(Ut,">").concat(a,"</").concat(Ut,"></").concat(Rt,"></").concat(Wt,">")}function Xt(e,t,r){if(r!==Gt&&!r)throw new E("","timestamp");if(isNaN(r))throw new w("","timestamp",r.toString());return Zt(function(e,t,r){return"<".concat(e," ").concat(Vt,"='").concat(r,"'>").concat(t,"</").concat(e,">")}(e,qt(t),r))}function Yt(e){var t=[],r=e.getElementsByTagName("tr");if(r.length>0){var a=Qt(r[0]);t.push(a);for(var n=1;n<r.length;n+=1){t.push("\r"),t.push(Ot);var o=Qt(r[n]);t.push(o)}}return t.join("")}function Qt(e){var t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(var a=1;a<r.length;a+=1)t.push("\t"),t.push(r[a].innerText)}return t.join("")}function $t(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(Vt)}function Zt(e){if(!G()||K())return e;var t="0000000000".length,r=Jt.length+e.length+zt.length,a=(r-zt.length).toString();if(a.length<t&&(a="0000000000".substr(0,t-a.length)+a),a.length!==t){var n="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ".concat(a.length," but it should be ").concat(t);throw s().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,n),new W(d.UnexpectedClipboardTextHtmlContentLength,n)}var o=(r-Ht).toString();if(o.length<t&&(o="0000000000".substr(0,t-o.length)+o),o.length!==t){n="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ".concat(o.length," but it should be ").concat(t);throw s().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,n),new W(d.UnexpectedClipboardTextHtmlContentLength,n)}var c=Jt.replace("{EndHTML0}",o).replace("{EndFragm}",a)+e+zt;return s().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,c.length===r,"addClipboardWrapperForEdge: The resulting text/html payload length of ".concat(c.length," differs from the expected length of ").concat(r)),c}function er(e){if(!e)return"";if(!e.trim())return e;var t=e.indexOf("\x3c!--StartFragment--\x3e"),r=e.indexOf(Ft);if(t<0||r<0||t>r)return e;var a=t+Nt,n=r-a,o=e.indexOf("\x3c!--StartFragment--\x3e",a),i=e.indexOf(Ft,r+kt);return o>=0||i>=0?e:e.substr(a,n)}function tr(e){var t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new E("","attributeName");var r=new RegExp("".concat(t,"=['\"](\\d+)['\"]"),"i").exec(e);if(!r||r.length<2)return;return r[1]}(e,Vt);if(t&&t.trim()){var r=Number(t);if((r||r===Gt)&&!isNaN(r))return r}}function rr(e){if(e&&e.trim()){var t=(new DOMParser).parseFromString(e,"text/html"),r=function(e){for(var t=e.getElementsByTagName("meta"),r=0;r<t.length;r+=1){var a=t[r];if("ProgId"===a.getAttribute("name")){var n=a.getAttribute("content");if(null!==n){if(n.length>64)return void s().ULS.shipAssertTag(595683460,i.LogCategory.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(n.startsWith("Word"))return"Word Desktop";if(n.startsWith("Excel"))return"Excel Desktop";if(n.startsWith("PowerPoint"))return"PowerPoint Desktop";if(n.startsWith("OneNote"))return"OneNote Desktop";s().ULS.traceTag(595683457,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}return}(t);if(void 0!==r)return r;var a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;var t=e.body.children[0];if(null!=t&&null!=t.classList)for(var r=0;r<t.classList.length;r+=1){var a=t.classList[r];if(a.startsWith("SCXO"))return"OneNote Online";if(a.startsWith("SCXP"))return"PowerPoint Online";if(a.startsWith("SCXW"))return"Word Online"}return}(t);return void 0!==a?a:function(e){if(null===e)return!1;var t=e.getElementsByTagName("b");if(0===t.length)return!1;var r=t[0];if(null!=r&&null!=r.id&&null!=r.id.startsWith&&r.id.startsWith("docs-internal-guid-"))return!0;return!1}(t)?"Google Docs":void 0}}function ar(e){return e?e.replace(jt,"&lt;").replace(xt,"&gt;"):""}function nr(e,t,r){var a="";return r&&(a=Object.keys(r).reduce((function(e,t){return t?"".concat(e," ").concat(t,"='").concat(r[t],"'"):e}),"")),"<".concat(t).concat(a,">").concat(e,"</").concat(t,">")}r.d(t,"ic",(function(){return s})),r.d(t,"Eb",(function(){return c})),r.d(t,"Hb",(function(){return h})),r.d(t,"Ib",(function(){return b})),r.d(t,"Nb",(function(){return y})),r.d(t,"a",(function(){return C})),r.d(t,"D",(function(){return v})),r.d(t,"B",(function(){return E})),r.d(t,"t",(function(){return w})),r.d(t,"u",(function(){return L})),r.d(t,"M",(function(){return T})),r.d(t,"A",(function(){return _})),r.d(t,"K",(function(){return I})),r.d(t,"N",(function(){return O})),r.d(t,"L",(function(){return P})),r.d(t,"b",(function(){return j})),r.d(t,"m",(function(){return x})),r.d(t,"H",(function(){return M})),r.d(t,"c",(function(){return D})),r.d(t,"e",(function(){return W})),r.d(t,"J",(function(){return R})),r.d(t,"ec",(function(){return U})),r.d(t,"Db",(function(){return J})),r.d(t,"Mb",(function(){return V})),r.d(t,"Jb",(function(){return G})),r.d(t,"Lb",(function(){return B})),r.d(t,"Kb",(function(){return K})),r.d(t,"Gb",(function(){return q})),r.d(t,"Ab",(function(){return X})),r.d(t,"jb",(function(){return""})),r.d(t,"Zb",(function(){return" "})),r.d(t,"Yb",(function(){return"."})),r.d(t,"Wb",(function(){return"1"})),r.d(t,"Xb",(function(){return"1"})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return"copy"})),r.d(t,"p",(function(){return"cut"})),r.d(t,"E",(function(){return"paste"})),r.d(t,"k",(function(){return"copy"})),r.d(t,"q",(function(){return"cut"})),r.d(t,"F",(function(){return"paste"})),r.d(t,"P",(function(){return Q})),r.d(t,"hb",(function(){return"text/plain"})),r.d(t,"ib",(function(){return"Text"})),r.d(t,"hc",(function(){return"text/html"})),r.d(t,"Cb",(function(){return"image/png"})),r.d(t,"Ub",(function(){return"metadata/is-last-copy-was-external"})),r.d(t,"Vb",(function(){return"metadata/is-last-copy-was-external-XLO-source"})),r.d(t,"Rb",(function(){return"metadata/chrome-extension-id"})),r.d(t,"Tb",(function(){return"metadata/ccp-infra-version"})),r.d(t,"Sb",(function(){return"copyId"})),r.d(t,"Qb",(function(){return"metadata/additional-signature-data-attributes"})),r.d(t,"qb",(function(){return $})),r.d(t,"sb",(function(){return ne})),r.d(t,"ob",(function(){return oe})),r.d(t,"nb",(function(){return ie})),r.d(t,"R",(function(){return se})),r.d(t,"mb",(function(){return ce})),r.d(t,"lb",(function(){return le})),r.d(t,"pb",(function(){return de})),r.d(t,"tb",(function(){return ue})),r.d(t,"g",(function(){return ee})),r.d(t,"r",(function(){return te})),r.d(t,"f",(function(){return d})),r.d(t,"n",(function(){return u})),r.d(t,"I",(function(){return p})),r.d(t,"d",(function(){return g})),r.d(t,"s",(function(){return re})),r.d(t,"xb",(function(){return Oe})),r.d(t,"mc",(function(){return Pe})),r.d(t,"C",(function(){return 1})),r.d(t,"gc",(function(){return We})),r.d(t,"bb",(function(){return Re})),r.d(t,"U",(function(){return Ue})),r.d(t,"kb",(function(){return Fe})),r.d(t,"S",(function(){return ke})),r.d(t,"z",(function(){return Je})),r.d(t,"Pb",(function(){return ze})),r.d(t,"kc",(function(){return He})),r.d(t,"T",(function(){return Ve})),r.d(t,"lc",(function(){return Ge})),r.d(t,"h",(function(){return Ke})),r.d(t,"V",(function(){return Xe})),r.d(t,"W",(function(){return et})),r.d(t,"X",(function(){return Be})),r.d(t,"ab",(function(){return rt})),r.d(t,"cb",(function(){return at})),r.d(t,"Fb",(function(){return"initmessageid"})),r.d(t,"jc",(function(){return"unknownmessageid"})),r.d(t,"bc",(function(){return"CreatorOrigin"})),r.d(t,"yb",(function(){return nt})),r.d(t,"O",(function(){return ot})),r.d(t,"fb",(function(){return ct})),r.d(t,"db",(function(){return lt})),r.d(t,"gb",(function(){return ut})),r.d(t,"eb",(function(){return pt})),r.d(t,"v",(function(){return"_LocalStorageChangedFlag"})),r.d(t,"Ob",(function(){return ft})),r.d(t,"ub",(function(){return mt})),r.d(t,"vb",(function(){return ht})),r.d(t,"wb",(function(){return bt})),r.d(t,"l",(function(){return St})),r.d(t,"G",(function(){return Ct})),r.d(t,"o",(function(){return yt})),r.d(t,"rb",(function(){return vt})),r.d(t,"Q",(function(){return Et})),r.d(t,"zb",(function(){return Ee})),r.d(t,"Z",(function(){return Tt})),r.d(t,"x",(function(){return _t})),r.d(t,"Y",(function(){return wt})),r.d(t,"w",(function(){return Lt})),r.d(t,"y",(function(){return It})),r.d(t,"ac",(function(){return"BulsEndpointUrl"})),r.d(t,"cc",(function(){return"usid"})),r.d(t,"dc",(function(){return"WacCluster"})),r.d(t,"Bb",(function(){return n})),r.d(t,"fc",(function(){return a}))},412:function(e,t,r){
/*! @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,r){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,r)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function a(e,n,o){return(a=r()?Reflect.construct:function(e,r,a){var n=[null];n.push.apply(n,r);var o=new(Function.bind.apply(e,n));return a&&t(o,a.prototype),o}).apply(null,arguments)}function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var i=Object.hasOwnProperty,s=Object.setPrototypeOf,c=Object.isFrozen,l=Object.getPrototypeOf,d=Object.getOwnPropertyDescriptor,u=Object.freeze,p=Object.seal,g=Object.create,f="undefined"!=typeof Reflect&&Reflect,m=f.apply,h=f.construct;m||(m=function(e,t,r){return e.apply(t,r)}),u||(u=function(e){return e}),p||(p=function(e){return e}),h||(h=function(e,t){return a(e,n(t))});var b,y=P(Array.prototype.forEach),S=P(Array.prototype.pop),C=P(Array.prototype.push),v=P(String.prototype.toLowerCase),E=P(String.prototype.toString),w=P(String.prototype.match),L=P(String.prototype.replace),T=P(String.prototype.indexOf),_=P(String.prototype.trim),I=P(RegExp.prototype.test),O=(b=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return h(b,t)});function P(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return m(e,t,a)}}function A(e,t,r){r=r||v,s&&s(e,null);for(var a=t.length;a--;){var n=t[a];if("string"==typeof n){var o=r(n);o!==n&&(c(t)||(t[a]=o),n=o)}e[n]=!0}return e}function j(e){var t,r=g(null);for(t in e)m(i,e,[t])&&(r[t]=e[t]);return r}function x(e,t){for(;null!==e;){var r=d(e,t);if(r){if(r.get)return P(r.get);if("function"==typeof r.value)return P(r.value)}e=l(e)}return function(e){return console.warn("fallback value for",e),null}}var M=u(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),D=u(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),W=u(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),R=u(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),U=u(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),F=u(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),N=u(["#text"]),k=u(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),J=u(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),z=u(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=u(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),V=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),G=p(/<%[\w\W]*|[\w\W]*%>/gm),B=p(/\${[\w\W]*}/gm),K=p(/^data-[\-\w.\u00B7-\uFFFF]/),q=p(/^aria-[\-\w]+$/),X=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Y=p(/^(?:\w+script|data):/i),Q=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),$=p(/^html$/i),Z=function(){return"undefined"==typeof window?null:window},ee=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var a=null;r.currentScript&&r.currentScript.hasAttribute("data-tt-policy-suffix")&&(a=r.currentScript.getAttribute("data-tt-policy-suffix"));var n="dompurify"+(a?"#"+a:"");try{return t.createPolicy(n,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+n+" could not be created."),null}};return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z(),a=function(e){return t(e)};if(a.version="2.4.1",a.removed=[],!r||!r.document||9!==r.document.nodeType)return a.isSupported=!1,a;var o=r.document,i=r.document,s=r.DocumentFragment,c=r.HTMLTemplateElement,l=r.Node,d=r.Element,p=r.NodeFilter,g=r.NamedNodeMap,f=void 0===g?r.NamedNodeMap||r.MozNamedAttrMap:g,m=r.HTMLFormElement,h=r.DOMParser,b=r.trustedTypes,P=d.prototype,te=x(P,"cloneNode"),re=x(P,"nextSibling"),ae=x(P,"childNodes"),ne=x(P,"parentNode");if("function"==typeof c){var oe=i.createElement("template");oe.content&&oe.content.ownerDocument&&(i=oe.content.ownerDocument)}var ie=ee(b,o),se=ie?ie.createHTML(""):"",ce=i,le=ce.implementation,de=ce.createNodeIterator,ue=ce.createDocumentFragment,pe=ce.getElementsByTagName,ge=o.importNode,fe={};try{fe=j(i).documentMode?i.documentMode:{}}catch(e){}var me={};a.isSupported="function"==typeof ne&&le&&void 0!==le.createHTMLDocument&&9!==fe;var he,be,ye=V,Se=G,Ce=B,ve=K,Ee=q,we=Y,Le=Q,Te=X,_e=null,Ie=A({},[].concat(n(M),n(D),n(W),n(U),n(N))),Oe=null,Pe=A({},[].concat(n(k),n(J),n(z),n(H))),Ae=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),je=null,xe=null,Me=!0,De=!0,We=!1,Re=!1,Ue=!1,Fe=!1,Ne=!1,ke=!1,Je=!1,ze=!1,He=!0,Ve=!1,Ge="user-content-",Be=!0,Ke=!1,qe={},Xe=null,Ye=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Qe=null,$e=A({},["audio","video","img","source","image","track"]),Ze=null,et=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tt="http://www.w3.org/1998/Math/MathML",rt="http://www.w3.org/2000/svg",at="http://www.w3.org/1999/xhtml",nt=at,ot=!1,it=null,st=A({},[tt,rt,at],E),ct=["application/xhtml+xml","text/html"],lt="text/html",dt=null,ut=i.createElement("form"),pt=function(e){return e instanceof RegExp||e instanceof Function},gt=function(t){dt&&dt===t||(t&&"object"===e(t)||(t={}),t=j(t),he=he=-1===ct.indexOf(t.PARSER_MEDIA_TYPE)?lt:t.PARSER_MEDIA_TYPE,be="application/xhtml+xml"===he?E:v,_e="ALLOWED_TAGS"in t?A({},t.ALLOWED_TAGS,be):Ie,Oe="ALLOWED_ATTR"in t?A({},t.ALLOWED_ATTR,be):Pe,it="ALLOWED_NAMESPACES"in t?A({},t.ALLOWED_NAMESPACES,E):st,Ze="ADD_URI_SAFE_ATTR"in t?A(j(et),t.ADD_URI_SAFE_ATTR,be):et,Qe="ADD_DATA_URI_TAGS"in t?A(j($e),t.ADD_DATA_URI_TAGS,be):$e,Xe="FORBID_CONTENTS"in t?A({},t.FORBID_CONTENTS,be):Ye,je="FORBID_TAGS"in t?A({},t.FORBID_TAGS,be):{},xe="FORBID_ATTR"in t?A({},t.FORBID_ATTR,be):{},qe="USE_PROFILES"in t&&t.USE_PROFILES,Me=!1!==t.ALLOW_ARIA_ATTR,De=!1!==t.ALLOW_DATA_ATTR,We=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=t.SAFE_FOR_TEMPLATES||!1,Ue=t.WHOLE_DOCUMENT||!1,ke=t.RETURN_DOM||!1,Je=t.RETURN_DOM_FRAGMENT||!1,ze=t.RETURN_TRUSTED_TYPE||!1,Ne=t.FORCE_BODY||!1,He=!1!==t.SANITIZE_DOM,Ve=t.SANITIZE_NAMED_PROPS||!1,Be=!1!==t.KEEP_CONTENT,Ke=t.IN_PLACE||!1,Te=t.ALLOWED_URI_REGEXP||Te,nt=t.NAMESPACE||at,t.CUSTOM_ELEMENT_HANDLING&&pt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ae.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&pt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ae.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ae.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Re&&(De=!1),Je&&(ke=!0),qe&&(_e=A({},n(N)),Oe=[],!0===qe.html&&(A(_e,M),A(Oe,k)),!0===qe.svg&&(A(_e,D),A(Oe,J),A(Oe,H)),!0===qe.svgFilters&&(A(_e,W),A(Oe,J),A(Oe,H)),!0===qe.mathMl&&(A(_e,U),A(Oe,z),A(Oe,H))),t.ADD_TAGS&&(_e===Ie&&(_e=j(_e)),A(_e,t.ADD_TAGS,be)),t.ADD_ATTR&&(Oe===Pe&&(Oe=j(Oe)),A(Oe,t.ADD_ATTR,be)),t.ADD_URI_SAFE_ATTR&&A(Ze,t.ADD_URI_SAFE_ATTR,be),t.FORBID_CONTENTS&&(Xe===Ye&&(Xe=j(Xe)),A(Xe,t.FORBID_CONTENTS,be)),Be&&(_e["#text"]=!0),Ue&&A(_e,["html","head","body"]),_e.table&&(A(_e,["tbody"]),delete je.tbody),u&&u(t),dt=t)},ft=A({},["mi","mo","mn","ms","mtext"]),mt=A({},["foreignobject","desc","title","annotation-xml"]),ht=A({},["title","style","font","a","script"]),bt=A({},D);A(bt,W),A(bt,R);var yt=A({},U);A(yt,F);var St=function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:nt,tagName:"template"});var r=v(e.tagName),a=v(t.tagName);return!!it[e.namespaceURI]&&(e.namespaceURI===rt?t.namespaceURI===at?"svg"===r:t.namespaceURI===tt?"svg"===r&&("annotation-xml"===a||ft[a]):Boolean(bt[r]):e.namespaceURI===tt?t.namespaceURI===at?"math"===r:t.namespaceURI===rt?"math"===r&&mt[a]:Boolean(yt[r]):e.namespaceURI===at?!(t.namespaceURI===rt&&!mt[a])&&!(t.namespaceURI===tt&&!ft[a])&&!yt[r]&&(ht[r]||!bt[r]):!("application/xhtml+xml"!==he||!it[e.namespaceURI]))},Ct=function(e){C(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=se}catch(t){e.remove()}}},vt=function(e,t){try{C(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){C(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Oe[e])if(ke||Je)try{Ct(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Et=function(e){var t,r;if(Ne)e="<remove></remove>"+e;else{var a=w(e,/^[\r\n\t ]+/);r=a&&a[0]}"application/xhtml+xml"===he&&nt===at&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var n=ie?ie.createHTML(e):e;if(nt===at)try{t=(new h).parseFromString(n,he)}catch(e){}if(!t||!t.documentElement){t=le.createDocument(nt,"template",null);try{t.documentElement.innerHTML=ot?"":n}catch(e){}}var o=t.body||t.documentElement;return e&&r&&o.insertBefore(i.createTextNode(r),o.childNodes[0]||null),nt===at?pe.call(t,Ue?"html":"body")[0]:Ue?t.documentElement:o},wt=function(e){return de.call(e.ownerDocument||e,e,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT,null,!1)},Lt=function(e){return e instanceof m&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Tt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},_t=function(e,t,r){me[e]&&y(me[e],(function(e){e.call(a,t,r,dt)}))},It=function(e){var t;if(_t("beforeSanitizeElements",e,null),Lt(e))return Ct(e),!0;if(I(/[\u0080-\uFFFF]/,e.nodeName))return Ct(e),!0;var r=be(e.nodeName);if(_t("uponSanitizeElement",e,{tagName:r,allowedTags:_e}),e.hasChildNodes()&&!Tt(e.firstElementChild)&&(!Tt(e.content)||!Tt(e.content.firstElementChild))&&I(/<[/\w]/g,e.innerHTML)&&I(/<[/\w]/g,e.textContent))return Ct(e),!0;if("select"===r&&I(/<template/i,e.innerHTML))return Ct(e),!0;if(!_e[r]||je[r]){if(!je[r]&&Pt(r)){if(Ae.tagNameCheck instanceof RegExp&&I(Ae.tagNameCheck,r))return!1;if(Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(r))return!1}if(Be&&!Xe[r]){var n=ne(e)||e.parentNode,o=ae(e)||e.childNodes;if(o&&n)for(var i=o.length-1;i>=0;--i)n.insertBefore(te(o[i],!0),re(e))}return Ct(e),!0}return e instanceof d&&!St(e)?(Ct(e),!0):"noscript"!==r&&"noembed"!==r||!I(/<\/no(script|embed)/i,e.innerHTML)?(Re&&3===e.nodeType&&(t=e.textContent,t=L(t,ye," "),t=L(t,Se," "),t=L(t,Ce," "),e.textContent!==t&&(C(a.removed,{element:e.cloneNode()}),e.textContent=t)),_t("afterSanitizeElements",e,null),!1):(Ct(e),!0)},Ot=function(e,t,r){if(He&&("id"===t||"name"===t)&&(r in i||r in ut))return!1;if(De&&!xe[t]&&I(ve,t));else if(Me&&I(Ee,t));else if(!Oe[t]||xe[t]){if(!(Pt(e)&&(Ae.tagNameCheck instanceof RegExp&&I(Ae.tagNameCheck,e)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(e))&&(Ae.attributeNameCheck instanceof RegExp&&I(Ae.attributeNameCheck,t)||Ae.attributeNameCheck instanceof Function&&Ae.attributeNameCheck(t))||"is"===t&&Ae.allowCustomizedBuiltInElements&&(Ae.tagNameCheck instanceof RegExp&&I(Ae.tagNameCheck,r)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(r))))return!1}else if(Ze[t]);else if(I(Te,L(r,Le,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==T(r,"data:")||!Qe[e])if(We&&!I(we,L(r,Le,"")));else if(r)return!1;return!0},Pt=function(e){return e.indexOf("-")>0},At=function(t){var r,n,o,i;_t("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Oe};for(i=s.length;i--;){var l=r=s[i],d=l.name,u=l.namespaceURI;if(n="value"===d?r.value:_(r.value),o=be(d),c.attrName=o,c.attrValue=n,c.keepAttr=!0,c.forceKeepAttr=void 0,_t("uponSanitizeAttribute",t,c),n=c.attrValue,!c.forceKeepAttr&&(vt(d,t),c.keepAttr))if(I(/\/>/i,n))vt(d,t);else{Re&&(n=L(n,ye," "),n=L(n,Se," "),n=L(n,Ce," "));var p=be(t.nodeName);if(Ot(p,o,n)){if(!Ve||"id"!==o&&"name"!==o||(vt(d,t),n=Ge+n),ie&&"object"===e(b)&&"function"==typeof b.getAttributeType)if(u);else switch(b.getAttributeType(p,o)){case"TrustedHTML":n=ie.createHTML(n);break;case"TrustedScriptURL":n=ie.createScriptURL(n)}try{u?t.setAttributeNS(u,d,n):t.setAttribute(d,n),S(a.removed)}catch(e){}}}}_t("afterSanitizeAttributes",t,null)}},jt=function e(t){var r,a=wt(t);for(_t("beforeSanitizeShadowDOM",t,null);r=a.nextNode();)_t("uponSanitizeShadowNode",r,null),It(r)||(r.content instanceof s&&e(r.content),At(r));_t("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(t){var n,i,c,d,u,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((ot=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Tt(t)){if("function"!=typeof t.toString)throw O("toString is not a function");if("string"!=typeof(t=t.toString()))throw O("dirty is not a string, aborting")}if(!a.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(Tt(t))return r.toStaticHTML(t.outerHTML)}return t}if(Fe||gt(p),a.removed=[],"string"==typeof t&&(Ke=!1),Ke){if(t.nodeName){var g=be(t.nodeName);if(!_e[g]||je[g])throw O("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(i=(n=Et("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!ke&&!Re&&!Ue&&-1===t.indexOf("<"))return ie&&ze?ie.createHTML(t):t;if(!(n=Et(t)))return ke?null:ze?se:""}n&&Ne&&Ct(n.firstChild);for(var f=wt(Ke?t:n);c=f.nextNode();)3===c.nodeType&&c===d||It(c)||(c.content instanceof s&&jt(c.content),At(c),d=c);if(d=null,Ke)return t;if(ke){if(Je)for(u=ue.call(n.ownerDocument);n.firstChild;)u.appendChild(n.firstChild);else u=n;return Oe.shadowroot&&(u=ge.call(o,u,!0)),u}var m=Ue?n.outerHTML:n.innerHTML;return Ue&&_e["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&I($,n.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+m),Re&&(m=L(m,ye," "),m=L(m,Se," "),m=L(m,Ce," ")),ie&&ze?ie.createHTML(m):m},a.setConfig=function(e){gt(e),Fe=!0},a.clearConfig=function(){dt=null,Fe=!1},a.isValidAttribute=function(e,t,r){dt||gt({});var a=be(e),n=be(t);return Ot(a,n,r)},a.addHook=function(e,t){"function"==typeof t&&(me[e]=me[e]||[],C(me[e],t))},a.removeHook=function(e){if(me[e])return S(me[e])},a.removeHooks=function(e){me[e]&&(me[e]=[])},a.removeAllHooks=function(){me={}},a}()}()},56:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,a){return t.traceTag(0,e,r,a)},traceTag:function(e,r,a,n){return t.traceTag(e,r,a,n)},debugTrace:function(e,r,a){return t.debugTraceTag(0,e,r,a)},debugTraceTag:function(e,r,a,n){return t.debugTraceTag(e,r,a,n)},assert:function(e,r,a){return t.assertTag(0,e,r,a)},assertTag:function(e,r,a,n){return t.assertTag(e,r,a,n)},shipAssert:function(e,r,a){return t.shipAssertTag(0,e,r,a)},shipAssertTag:function(e,r,a,n){return t.shipAssertTag(e,r,a,n)},dnmTrace:function(e,r,a){return t.dnmTraceTag(0,e,r,a)},dnmTraceTag:function(e,r,a,n){return t.dnmTraceTag(e,r,a,n)}}}}};var a=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,a){console.assert(r,"shipAssertTag:",e,t,a)},e.prototype.assertTag=function(e,t,r,a){console.assert(r,"assertTag",e,t,a)},e.prototype.traceTag=function(e,t,r,a){console.log("traceTag",e,a,t,r)},e.prototype.dnmTraceTag=function(e,t,r,a){console.log("dnmTraceTag",e,a,t,r)},e.prototype.debugTraceTag=function(e,t,r,a){console.log("debugTraceTag",e,a,t,r)},e}();t.ConsoleLogger=a;var n=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=n},655:function(e,t,r){"use strict";r.r(t);var a,n=r(3),o=r(2);function i(e){Object(n.ic)().ULS.shipAssertTag(595944468,o.LogCategory.msoulscat_ES_EWAJS,!!e,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),a=e}var s,c=r(22),l=r(1);var d,u={serializeMetadata:function(e){if(!e)return"{}";try{var t={},r=function(e){if(!e)return;try{if(!e.id)throw new n.e(n.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!e.sessionId)throw new n.e(n.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===e.copyStatus)throw new n.e(n.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:e.id,sessionId:e.sessionId,sourceItem:s.serializeSourceItem(e.sourceItem),commandParameters:s.serializeCommandParameters(e.commandParameters),copyStatus:e.copyStatus,isTimestampStoredInSystemClipboard:e.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:e.isAsyncSerializeFailed}}catch(e){return void Object(n.ic)().ULS.traceTag(595945243,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataSerializer.serializeCopyContext: failed to serialized copyContext: ".concat(o.utils.getStringifiedError(e)))}}(e.lastCopy);return r&&(t.copyContext=r),JSON.stringify(t)}catch(e){return Object(n.ic)().ULS.traceTag(595945242,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataSerializer.serializeMetadata: failed to serialized metadata: ".concat(o.utils.getStringifiedError(e))),"{}"}},deserializeMetadata:function(e){if(!e)return Object(n.rb)();try{var t=JSON.parse(e),r={};return t.copyContext&&(r.lastCopy=function(e){if(!e)return;try{if(!e.id)throw new n.e(n.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!e.sessionId)throw new n.e(n.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!e.copyStatus)throw new n.e(n.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!e.sourceItem)throw new n.e(n.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!e.commandParameters)throw new n.e(n.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");var t=new n.l;return t.id=e.id,t.sessionId=e.sessionId,t.copyStatus=e.copyStatus,t.isTimestampStoredInSystemClipboard=e.isTimestampStoredInSystemClipboard,t.isAsyncSerializeFailed=e.isAsyncSerializeFailed,t.sourceItem=s.deserializeSourceItem(e.sourceItem),t.commandParameters=s.deserializeCommandParameters(e.commandParameters),t}catch(e){return void Object(n.ic)().ULS.traceTag(595945245,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: ".concat(o.utils.getStringifiedError(e),"."))}}(t.copyContext)),r}catch(e){Object(n.ic)().ULS.traceTag(595945244,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: ".concat(o.utils.getStringifiedError(e)))}return Object(n.rb)()}};function p(e,t,r){return Object(n.ic)().ULS.shipAssertTag(595945246,o.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),Object(n.ic)().ULS.shipAssertTag(595945247,o.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),d=e,g=function(e){return s=e,u}(t),(f=r)&&f.setOnMetadataChangedListener(S),y}var g,f,m,h=Object(n.rb)(),b={},y={getCachedMetadata:function(){return Object(n.ic)().ULS.traceTag(595730648,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.getCachedMetadata: get cached metadata with value: ".concat(w(h))),Object(n.Q)(h)},updateMetadata:function(e){Object(n.ic)().ULS.traceTag(595730652,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.updateMetadata: start update metadata with metadata : ".concat(w(e)));var t=Object(l.__assign)(Object(l.__assign)({},h),e),r=Object(n.R)();r.setItem("metadata",g.serializeMetadata(t)),Object(n.ic)().ULS.traceTag(595730653,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.updateMetadata: schedule metadata with value: ".concat(w(t))),v(r,t)},clear:function(){Object(n.ic)().ULS.traceTag(595730654,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.clear: start clear metadata");var e=Object(n.rb)();v(Object(n.R)(),e)},addMetadataChangeListener:function(e,t){e||Object(n.ic)().ULS.traceTag(595936158,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");t||Object(n.ic)().ULS.traceTag(595936159,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define");b[e]&&Object(n.ic)().ULS.traceTag(595936160,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: listener with same listenerId(".concat(e," already exist."));b[e]=t},removeMetadataChangeListener:function(e){e||Object(n.ic)().ULS.traceTag(595936161,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");b[e]?delete b[e]:Object(n.ic)().ULS.traceTag(595936162,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = ".concat(e,"."))},getMetadataSyncPromise:function(){if(!m||!Object(o.ewaUtils)().isChangeGateEnabled("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete"))return Object(n.ic)().ULS.traceTag(595937173,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(Object(n.Q)(h));return Object(n.ic)().ULS.traceTag(595937174,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),m.deferredPromise.promise.then((function(e){return Object(n.ic)().ULS.traceTag(595937175,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),e}))},isMetadataSync:function(){return!m}};function S(e){try{if(e&&0!==Object(n.nb)(e)){var t=e.getItem("metadata");h=g.deserializeMetadata(t),Object(n.ic)().ULS.traceTag(595730650,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.onMetadataChanged: set cached metadata with value ".concat(w(h)))}else Object(n.ic)().ULS.traceTag(595730649,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),h=Object(n.rb)()}catch(e){Object(n.ic)().ULS.traceTag(595945248,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.onMetadataChanged: failed to parse metadata string with error: ".concat(o.utils.getStringifiedError(e))),h=Object(n.rb)()}C(Object(n.Q)(h))}function C(e){for(var t in Object(n.ic)().ULS.traceTag(595730651,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : ".concat(w(e))),b){var r=b[t];r&&r(e)}}function v(e,t){var r=Object(n.bb)();m?m.metadataSyncMessageId=r:(m={metadataSyncMessageId:r,deferredPromise:Object(n.V)()},Object(n.ic)().ULS.traceTag(595937176,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: _syncMetadata created. ".concat(m.metadataSyncMessageId))),Object(n.ic)().ULS.traceTag(595937177,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id ".concat(r,".")),setTimeout((function(){d.set(e,{}).then((function(){h=t,Object(n.ic)().ULS.traceTag(595937178,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId=".concat(r,". _syncMetadata.metadataSyncMessageId = ").concat(m&&m.metadataSyncMessageId,". newMetadata = ").concat(w(t))),E(r)}),(function(e){Object(n.ic)().ULS.traceTag(595945250,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"MetadataManager.updateMetadata: failed to update metadata store with error: ".concat(o.utils.getStringifiedError(e))),E(r)}))}),0)}function E(e){if(Object(n.ic)().ULS.traceTag(595730655,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: ".concat(e)),m&&m.metadataSyncMessageId===e){var t=m;m=void 0;var r=Object(n.Q)(h);Object(n.ic)().ULS.traceTag(595730656,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: ".concat(w(r))),C(r),t.deferredPromise.resolve(r)}}function w(e){return e?e.lastCopy?"copyContext.id=".concat(e.lastCopy.id):"copy context is null":"metadata is null"}var L=function(){function e(e,t,r){this.ttlInMs=t,this.blockMismatchDataVersion=r,e?this.userHash=o.utils.calcHashCode(e):(this.userHash=1565411791,Object(n.ic)().ULS.traceTag(595903939,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"userId not exist!. Use default ID"))}return e.prototype.wrapTextWithDataSignature=function(e,t,r,a,o){void 0===a&&(a="null");var i,s={ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:a};return(i=null!==o&&0!==Object.keys(o).length?Object(l.__assign)(Object(l.__assign)({},s),o):s)[n.Bb.ccpTimestampHtmlCustomAttributeName]=r,n.Bb.wrapContentWithTagAndAttributes(e,t,i)},e.prototype.ensureDataSignatureInHtmlItem=function(e){if(0!==Object(n.nb)(e)){var t=Object(n.tb)(e),r=Object(n.lb)(t,n.hc),a=Object(n.lb)(t,n.Sb),o=Object(n.lb)(t,n.Qb),i=null;if(o!==n.jb&&(i=JSON.parse(o)),r){if(void 0!==this.getRegExIntValue(r,"ccp_infra_version=['|\"](\\d+)['|\"]"))return;e.setItem(n.hc,this.wrapTextWithDataSignature(r,n.Bb.divTagName,Date.now(),a,i))}else{var s=Object(n.pb)(t),c=n.Bb.createTextHtmlFromTextPlain(s),l=this.wrapTextWithDataSignature(c,n.Bb.preTagName,Date.now(),a,i);e.setItem(n.hc,n.Bb.addClipboardWrapperForEdge(l))}}},e.prototype.extractSignatureData=function(e){if(Object(n.ob)(e)>0){var t=Object(n.mb)(e,n.hc),r=this.getRegExIntValue(t,"ccp_infra_version=['|\"](\\d+)['|\"]");if(void 0===r)return this.parsePreSignatureData(t);if(this.blockMismatchDataVersion&&3!==r)throw Object(n.ic)().ULS.traceTag(595902983,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"clipboardDataManager.extractSignatureData: block mismatch version. dataVer = ".concat(r,", CCPInfraVersion = ").concat(3)),new n.A("ClipboardDataManagerImpl.extractSignatureData",r,3,this.blockMismatchDataVersion);return r<3?(Object(n.ic)().ULS.traceTag(595902986,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = ".concat(r,", CCPInfraVersion = ").concat(3,". Converting to the data")),this.parseOldSignatureData(t)):(r>3&&Object(n.ic)().ULS.traceTag(595900176,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = ".concat(r,", CCPInfraVersion = ").concat(3,". ( It's OK - Should be forward compatibility)")),this.parseCurrentVersionSignatureData(t))}},e.prototype.parseCurrentVersionSignatureData=function(e){var t=this.getRegExIntValue(e,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]"),r=this.getRegExIntValue(e,"\\s+ccp_infra_user_hash=['|\"](\\d+)['|\"]");if(void 0!==t&&void 0!==r){var a=this.getRegExStringValue(e,"\\s+ccp_infra_copy_id=['|\"]([\\w-]+)['|\"]");return a&&Object(n.ic)().ULS.traceTag(595183181,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : ".concat(a)),{ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:r,ccp_infra_copy_id:a||""}}Object(n.ic)().ULS.traceTag(595902985,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"clipboardDataManager.extractSignatureData: Failed to extract SignatureData. textHtmlItem: ".concat(e))},e.prototype.parseOldSignatureData=function(e){return this.parseCurrentVersionSignatureData(e)},e.prototype.parsePreSignatureData=function(e){var t=n.Bb.getCcpTimestampHtmlCustomAttributeFromWrappingTag(e);if(Object(n.ic)().ULS.traceTag(595723668,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData: dataTimeStamp=".concat(t)),t){if(this.blockMismatchDataVersion)throw Object(n.ic)().ULS.traceTag(595899270,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new n.A("ClipboardDataManagerImpl.extractSignatureData",NaN,3,this.blockMismatchDataVersion);var r={ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:0};return Object(n.ic)().ULS.traceTag(595723669,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData"),r}},e.prototype.validateTTL=function(e){if(e&&this.ttlInMs){var t=Date.now()-e.ccp_infra_timestamp;if(t>this.ttlInMs)throw Object(n.ic)().ULS.traceTag(595899858,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"Time elapsed (".concat(t," ms) from setting Clipboard (").concat(e.ccp_infra_timestamp,") is greater then TTL (").concat(this.ttlInMs," ms) - return error")),new n.K("clipboardDataManager.validateTTL validation failed",t,this.ttlInMs)}},e.prototype.validateUserHash=function(e){if(e&&e.ccp_infra_user_hash!==this.userHash)throw Object(n.ic)().ULS.traceTag(595723670,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error"),new n.N("clipboardDataManager.validateUserHash validation failed",e?e.ccp_infra_user_hash:0,this.userHash)},e.prototype.setMetaDataVersionItem=function(e){if(0!==Object(n.nb)(e)){var t={ccp_infra_version:3};e.setItem(n.Tb,JSON.stringify(t))}},e.prototype.validateMetaDataVersionItem=function(e){if(e&&Object(n.nb)(e)>0){var t=Object(n.mb)(e.getData(),n.Tb),r=void 0;try{r=JSON.parse(t)}catch(e){if(!this.blockMismatchDataVersion)return;throw Object(n.ic)().ULS.traceTag(595899272,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = ".concat(e)),new n.L("ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = ".concat(t))}if(this.blockMismatchDataVersion&&3!==r.ccp_infra_version)throw Object(n.ic)().ULS.traceTag(595899203,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = ".concat(r.ccp_infra_version,", CCPInfraVersion = ").concat(3)),new n.A("ClipboardDataManagerImpl.validateMetaDataVersionItem",r.ccp_infra_version,3,this.blockMismatchDataVersion)}},e.prototype.createClipboardDataProcessor=function(e){var t=this;Object(n.ic)().ULS.traceTag(595723671,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash=".concat(e));return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(r){if(Object(n.ic)().ULS.traceTag(595723672,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash=".concat(e)),r){var a=t.extractSignatureData(r.getData());Object(n.ic)().ULS.traceTag(595723673,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash=".concat(e)),a&&r.setItem(n.Sb,a.ccp_infra_copy_id),t.validateTTL(a),e&&(Object(n.ic)().ULS.traceTag(595723674,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash=".concat(e)),t.validateUserHash(a))}}.bind(this)}},e.prototype.createDualClipboardDataProcessor=function(e){var t=this;Object(n.ic)().ULS.traceTag(595723675,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called.");return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(e){Object(n.ic)().ULS.traceTag(595723676,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),e&&e.clipboardItemsData&&(e.signatureData=t.extractSignatureData(e.clipboardItemsData),e.signatureData&&(e.clipboardItemsData.items[n.Sb]=e.signatureData.ccp_infra_copy_id),t.validateTTL(e.signatureData))}.bind(this),validateUserHash:e?this.validateUserHash.bind(this):function(){}}},e.prototype.createClipboardMetaDataProcessor=function(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}},e.prototype.getRegExStringValue=function(e,t){var r=new RegExp(t,"g").exec(e);if(r&&r.length&&r.length>1)return r[1]},e.prototype.getRegExIntValue=function(e,t){var r=this.getRegExStringValue(e,t);if(r){var a=Number(r);return isNaN(a)?void 0:a}},e}();var T=function(e){function t(t,r,a){var n=e.call(this,t,r,a,"WindowRPCClientInternal")||this;return n.pushMessageListeners={},n}return Object(l.__extends)(t,e),t.prototype.init=function(e){return this.deferredResultMessagePromiseCache=Object(n.W)(),this.sender=Object(n.eb)(this.serializer,this),this.receiver=Object(n.db)(this.deserializer,this,this),this.postInitMessage(e).catch((function(e){return Object(n.ic)().ULS.traceTag(596129250,o.LogCategory.msoulscat_ES_EWAJS,Object(n.Nb)(e)?o.TraceLevel.Info:o.TraceLevel.Error,"Init failure or timeout. Error: ".concat(o.utils.getStringifiedError(e))),Object(n.Hb)(e,n.f.IframeInitializationTimeout)?Promise.reject(e):Promise.reject(new n.e(n.f.IframeInitialization,"failed to init the Shared Clipboard",e))}))},t.prototype.registerPushMessageListener=function(e,t){this.pushMessageListeners[e]=t},t.prototype.postInitMessage=function(e){var t=Object(n.S)(n.Fb,"init",n.z.initIframe);if(!this.deferredResultMessagePromiseCache){var r="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return Object(n.ic)().ULS.shipAssertTag(596121487,o.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new n.u(r))}var a=this.postMessage(t),i=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),s=Date.now();return setTimeout((function(){if(i&&!i.fulfilled()){var e=Date.now(),t="initialization started on ".concat(new Date(s)," and timed out on ").concat(new Date(e)," after ").concat(e-s," ms");Object(n.ic)().ULS.traceTag(596129251,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,t),i.reject(new n.e(n.f.IframeInitializationTimeout,t))}}),e),a},t.prototype.postMessage=function(t){try{if(!t)throw new n.B(n.jb,"outgoingMessage");if(Object(n.ic)().ULS.shipAssertTag(596452175,o.LogCategory.msoulscat_ES_EWAJS,!!t.id,"postMessage: outgoingMessage.id must be defined"),e.prototype.postMessage.call(this,t),!this.deferredResultMessagePromiseCache){var r="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw Object(n.ic)().ULS.shipAssertTag(596121488,o.LogCategory.msoulscat_ES_EWAJS,!1,r),new n.u(r)}return this.deferredResultMessagePromiseCache.addNewPromise(t.id).promise}catch(e){return Promise.reject(new n.u("Unable to post message for operation '".concat(t?t.operationCode:void 0,"'"),e))}},t.prototype.handleMessage=function(e){Object(n.ic)().ULS.traceTag(596452376,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"RPC Client - handleMessage: incomingMessage.id='".concat(e&&e.id,"'; incomingMessage.operationCode='").concat(e&&e.operationCode,"'; incomingMessage.failed='").concat(e&&e.failed,"'; incomingMessage.error='").concat(e&&e.error,"'; incomingMessage.clipboardItems.length=").concat(Object(n.ob)(e&&e.clipboardItemsData)));var t=this.pushMessageListeners[e.operationCode];if(t)return t(e.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){var r="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return Object(n.ic)().ULS.shipAssertTag(596121489,o.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new n.u(r))}var a="initresult"===e.operationCode?n.Fb:e.id,i=this.deferredResultMessagePromiseCache.getDeferredPromise(a);return i?(this.deferredResultMessagePromiseCache.delete(a),e.failed?i.reject(e.error):i.resolve(e),Promise.resolve()):(Object(n.ic)().ULS.traceTag(596452377,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,a===e.id?"RPC Client - handleMessage: no deferred promise with id '".concat(e.id,"'; dropping this result."):"RPC Client - handleMessage: no deferred promise with id '".concat(a,"' for message id '").concat(e.id,"'; dropping this result.")),Promise.resolve())},t.prototype.handleDeserializationError=function(e){return!e||"NoValidKeyError"!==e.errorName||this.deferredResultMessagePromiseCache&&0!==this.deferredResultMessagePromiseCache.getLength()?(Object(n.ic)().ULS.traceTag(596452379,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"RPC Client - handleDeserializationError. There are ".concat(this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0," deferred promise(s) in the cache. Error: ").concat(o.utils.getStringifiedError(e))),Promise.resolve()):(Object(n.ic)().ULS.traceTag(542687372,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"RPC Client - handleDeserializationError. Error: ".concat(o.utils.getStringifiedError(e))),Promise.resolve())},t.prototype.dispose=function(){var t=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(n.ec)([function(){t.deferredResultMessagePromiseCache&&t.deferredResultMessagePromiseCache.clear()}]),e.prototype.dispose.call(this))},t}(n.O),_=["OfficeVSO:7538717_RouteClipboardBulsToDataBoundary"],I={initialized:!1,origin:n.jb,src:n.jb,deferredPromise:void 0},O=void 0;function P(){return I}function A(){var e=document.createElement("iframe");return e.style.display="none",e.id="clipboard",Object(n.ic)().ULS.shipAssertTag(595952726,o.LogCategory.msoulscat_ES_EWAJS,!O,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),x(),O=Object(n.P)(e,"load",(function(e){return function(e){Object(n.ic)().ULS.traceTag(595952727,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"CCP iframe onload event: Entering"),x();var t=P().deferredPromise;if(!t)return void Object(n.ic)().ULS.shipAssertTag(595952728,o.LogCategory.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");var r=t.id;try{P().deferredPromise=void 0;var a=e.target;if(!a){var i="CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '".concat(r,"'");return Object(n.ic)().ULS.shipAssertTag(595952729,o.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new n.u(i))}if(!a.contentWindow){i="CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '".concat(r,"'");return Object(n.ic)().ULS.shipAssertTag(595952730,o.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new n.u(i))}Object(n.ic)().ULS.traceTag(595952732,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"CCP iframe onload event: resolving deferred promise id '".concat(r,"' with the iframe")),t.resolve(a)}catch(e){i="iframeOnLoad: an error has occurred: [".concat(o.utils.getStringifiedError(e),"]. Rejecting deferred promise id '").concat(r,"'");Object(n.ic)().ULS.traceTag(595952733,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,i),t.reject(new n.u(i,e))}}(e)})),e.src=P().src,e}function j(e){var t=P().origin,r=t;"/"!==t.charAt(t.length-1)&&(r+="/"),r+="clipboard/shared.aspx",e&&(r+="?".concat(encodeURIComponent(n.bc),"=").concat(encodeURIComponent(e)));var i=[];_.forEach((function(e){Object(o.ewaUtils)().isChangeGateEnabled(e)||i.push({key:e,value:"1"})}));var s=function(){if(!a)throw new n.u("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return a}();s&&(s.sessionId&&i.push({key:n.cc,value:s.sessionId}),s.bulsEndpointUrl&&i.push({key:n.ac,value:s.bulsEndpointUrl}));var c=Object(o.getNewGuid)(),l=c[0],d=c[1];return Object(n.ic)().ULS.traceTag(595722560,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: ".concat(l," newGuidLogging: ").concat(d)),i.push({key:"corrid",value:l}),i.push({key:"NoAuth",value:"true"}),i.length>0&&i.forEach((function(e){r+=function(e){if(e.indexOf("?")>=0)return"&";return"?"}(r),r+="".concat(encodeURIComponent(e.key),"=").concat(encodeURIComponent(e.value))})),r}function x(){if(O){try{O()}catch(e){}O=void 0}}var M=void 0;function D(){if(!M)return Promise.reject("state in undefined, please make sure to call initialize first");var e=function(){if(!P().initialized)throw new n.u("getIframe: the initialize function should be called beforehand");var e=document.getElementsByTagName("iframe");if(e&&0!==e.length){Object(n.ic)().ULS.traceTag(595952723,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getIframe: found ".concat(e.length," iframes"));for(var t=0;t<e.length;t+=1){var r=e[t];if(r&&r.id&&"clipboard"===r.id)return r}Object(n.ic)().ULS.traceTag(595952724,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getIframe: the CCP iframe does not exist")}else Object(n.ic)().ULS.traceTag(595952722,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getIframe: found no iframes")}();e&&(Object(n.ic)().ULS.traceTag(596448770,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src ".concat(void 0!==e.src&&void 0!==M.src&&e.src.toLowerCase()===M.src.toLowerCase()?"===":"!=="," src; deferredPromise ").concat(void 0===M.deferredPromise?"does not exist":"exists","; The iframe's content window ").concat(void 0===e.contentWindow?"does not exist":"exists",".")),function(e){if(!e)throw new n.B(n.jb,"iframe");Object(n.ic)().ULS.traceTag(595952725,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"removeIframe: removing the CCP iframe"),x(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);var t=M.deferredPromise,r=t?t.id:n.jb;if(t){x(),M.deferredPromise=void 0;var a="ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '".concat(r,"' and creating a new one");Object(n.ic)().ULS.shipAssertTag(596453587,o.LogCategory.msoulscat_ES_EWAJS,!1,a),t.reject(new n.u(a)),t=void 0}M.deferredPromise=Object(n.V)(Object(n.bb)()),r=(t=M.deferredPromise).id;try{e=A(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){a="ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '".concat(r,"'");return Object(n.ic)().ULS.traceTag(596453588,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,a),M.deferredPromise=void 0,x(),Promise.reject(new n.u(a,e))}return t&&!t.fulfilled()?t.promise:(x(),e.contentWindow?(M.deferredPromise=void 0,Promise.resolve(e)):(Object(n.ic)().ULS.shipAssertTag(596453589,o.LogCategory.msoulscat_ES_EWAJS,!1,"ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '".concat(r,"'")),Promise.reject(new n.u("ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '".concat(r,"'")))))}var W,R;function U(){if(R)return R.promise;R=Object(n.V)(Object(n.bb)());try{var e=function(e){return M||(M=P()),M.initialized||(M.origin=Object(n.xb)(e),M.src=j(e),M.initialized=!0),M.origin}(Object(n.zb)().origin);W=function(e,t){return new T(Object(n.cb)(n.kc),Object(n.ab)(n.lc),{window:t,windowOrigin:e})}(e,void 0),o.utils.retry((function(e,t){return function(e,t){if(!W){var r="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return Object(n.ic)().ULS.shipAssertTag(595947544,o.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new n.u(r))}var a=o.perfWatch.start("Iframe_initialize_".concat(e));o.perfWatch.mark(a,"start"),W.remoteWindow.window=void 0;var i=function(r){var i=Object(n.Hb)(r,n.f.IframeInitializationTimeout)?" due to a timeout of approx. ".concat(t," ms"):n.jb;o.perfWatch.mark(a,"finish_error"),o.perfWatch.failure(a,(function(e){return Object(n.ic)().ULS.traceTag(596452419,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,e)}),"Attempt #".concat(e," failed to initialize an iframe ").concat(i,". ").concat(e<3?"Retrying...":"No more retries!",". Error: ").concat(o.utils.getStringifiedError(r)))},s=Object(n.V)();return D().then((function(r){if(o.perfWatch.mark(a,"iframe_loaded"),o.perfWatch.mark(a,"iframe_waiting_for_idb_init"),!W){var s="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";Object(n.ic)().ULS.shipAssertTag(595947545,o.LogCategory.msoulscat_ES_EWAJS,!1,s);var c=new n.u(s);return i(c),Promise.reject(c)}if(!r.contentWindow){s="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined";Object(n.ic)().ULS.shipAssertTag(595903557,o.LogCategory.msoulscat_ES_EWAJS,!1,s);c=new n.u(s);return i(c),Promise.reject(c)}return W.remoteWindow.window=r.contentWindow,W.init(t).then((function(){return o.perfWatch.mark(a,"iframe_idb_init_complete"),o.perfWatch.mark(a,"finish"),o.perfWatch.success(a,(function(e){return Object(n.ic)().ULS.traceTag(596452418,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,e)}),"Attempt #".concat(e," initialized iframe")),Promise.resolve()}))})).then((function(){s.resolve()}),(function(e){i(e),s.reject(e)})),s.promise}(e,2e4+(Object(n.Hb)(t,n.f.IframeInitializationTimeout)?5e3:0)*(e-1))}),3).then((function(){R.resolve(W)}),(function(e){R.reject(e)}))}catch(e){R.reject(e)}return R.promise}var F=function(){function e(){this.initialized=!1}return e.prototype.innerInitialize=function(){var e=this;return U().then((function(t){return e.initialized=!0,e.windowRPCClient=t,e}))},e.prototype.registerPushMessageListener=function(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)},e.prototype.postMessage=function(e,t){if(!this.initialized)return Promise.reject(new n.e(n.f.IframeInitialization));var r=o.perfWatch.start("BaseIframeProxy_".concat(t));o.perfWatch.mark(r,"start");var a=function(e){return o.perfWatch.mark(r,"finish_error"),o.perfWatch.failure(r,(function(e){return Object(n.ic)().ULS.traceTag(596452188,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,e)}),"Failed in BaseIframeProxy.postMessage. Error: ".concat(o.utils.getStringifiedError(e))),Promise.reject(new n.e(n.f.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",e))};if(!this.windowRPCClient){var i="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return Object(n.ic)().ULS.shipAssertTag(595944461,o.LogCategory.msoulscat_ES_EWAJS,!1,i),a(new n.u(i))}return this.windowRPCClient.postMessage(e).then((function(e){return Object(n.ic)().ULS.shipAssertTag(595944462,o.LogCategory.msoulscat_ES_EWAJS,!!e,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),e?e.failed?Promise.reject(new n.e(n.f.IframeProxyGeneralError,"BaseIframeProxy.postMessage: the operation failed. Error: ".concat(e.error))):(o.perfWatch.mark(r,"finish"),o.perfWatch.success(r,(function(e){return Object(n.ic)().ULS.traceTag(596452187,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,e)})),Promise.resolve(e)):Promise.reject(new n.e(n.f.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing"))})).catch((function(e){return a(e)}))},e}(),N=function(){function e(e){this.localStorageKey=e}return e.prototype.initialize=function(e){var t=this;return new n.y(this.localStorageKey,e,(function(e){t._onMetadataChangedListener&&t._onMetadataChangedListener(e)})),Promise.resolve()},e.prototype.setOnMetadataChangedListener=function(e){Object(n.ic)().ULS.traceTag(595716297,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(n.ic)().ULS.shipAssertTag(595716298,o.LogCategory.msoulscat_ES_EWAJS,!!e,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},e}(),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.initialize=function(t){var r=this;return e.prototype.innerInitialize.call(this).then((function(){r.registerPushMessageListener("getMetadata_longPollingresult",(function(e){r._onMetadataChangedListener&&r._onMetadataChangedListener(Object(n.R)(e))}))}))},t.prototype.setOnMetadataChangedListener=function(e){Object(n.ic)().ULS.traceTag(595730647,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(n.ic)().ULS.shipAssertTag(595944466,o.LogCategory.msoulscat_ES_EWAJS,!!e,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},t}(F),J=function(e){function t(t){return e.call(this,n.i.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},t)||this}return Object(l.__extends)(t,e),t}(n.h),z=!0;function H(){return z}function V(){z=!1}var G=!0;function B(){return G}function K(){G=!1}function q(){var e=void 0;try{e=window.clipboardData}catch(e){Object(n.ic)().ULS.traceTag(595985225,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: ".concat(o.utils.getStringifiedError(e)))}return e}function X(){if(Object(n.ic)().ULS.shipAssertTag(596455701,o.LogCategory.msoulscat_ES_EWAJS,Object(n.Mb)(),"The browser must be IE"),!Object(n.Mb)())throw new n.u("The browser must be IE")}function Y(e){return!!e}function Q(e){if(e){var t=void 0;try{t=e.clipboardData}catch(e){throw Object(n.ic)().ULS.traceTag(595985224,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: ".concat(o.utils.getStringifiedError(e))),e}return t}Object(n.ic)().ULS.traceTag(596456320,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"A clipboard event parameter is missing")}function $(e,t,r,a){var i=!1;try{var s=Q(r);if(!s||!Y(s))return Object(n.ic)().ULS.traceTag(596456264,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"setData - programmatic ".concat(n.j," and ").concat(n.p," is broken. There is no valid data transfer object. clipboardDataFormat = '").concat(e,"'")),!1;!1===(i=s.setData(e,t))&&Object(n.ic)().ULS.traceTag(596456265,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"setData returned false for '".concat(e,"'."))}catch(t){Object(n.ic)().ULS.traceTag(596456266,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"setData with '".concat(e,"' threw an exception: ").concat(o.utils.getStringifiedError(t)))}return void 0===i&&(i=!0),i}function Z(e,t,r,a){if(X(),!a&&!H()&&!B())return Object(n.ic)().ULS.traceTag(596456269,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"setData - programmatic ".concat(n.j," and ").concat(n.p," clipboard access is not supported. rawEvent is empty = ").concat(!!r)),!1;var i=q();if(!i||!Y(i))return Object(n.ic)().ULS.traceTag(596456270,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"setData - ".concat(n.j," and ").concat(n.p," is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '").concat(e,"'")),a||(Object(n.ic)().ULS.shipAssertTag(596456271,o.LogCategory.msoulscat_ES_EWAJS,H()&&B(),"setData - programmatic ".concat(n.j," and ").concat(n.p," is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '").concat(H(),"'. isProgrammaticAccessSupported = '").concat(B(),"'. clipboardDataFormat = '").concat(e,"'")),V(),K()),!1;var s,c=e;c===n.hb&&(c=n.ib);try{!1===(s=i.setData(c,t))&&Object(n.ic)().ULS.traceTag(596456272,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"setData returned false for '".concat(c,"'."))}catch(e){Object(n.ic)().ULS.traceTag(596456273,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"setData with '".concat(c,"' threw an exception: ").concat(e.message))}return!a&&H()&&(V(),!1===s&&K()),void 0===s&&(s=!0),s}function ee(){return H()&&Z(n.hb,n.jb,void 0,!1),!!B()||(Object(n.ic)().ULS.traceTag(596456274,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"document.execCommand - programmatic clipboard access is not allowed for '".concat(n.j,"' and '").concat(n.p,"'.")),!1)}var te={execCommandCopy:function(){var e;try{e=document.execCommand(n.j,!1,null)}catch(e){Object(n.ic)().ULS.traceTag(596456262,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"document.execCommand('".concat(n.j,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},execCommandCut:function(){var e;try{e=document.execCommand(n.p,!1,null)}catch(e){Object(n.ic)().ULS.traceTag(596456263,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"document.execCommand('".concat(n.p,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},setData:$,defaultClipboardDataFormat:n.hb},re={execCommandCopy:function(){if(X(),!ee())return!1;try{document.execCommand(n.j,!1,null)}catch(e){Object(n.ic)().ULS.traceTag(596456267,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"document.execCommand('".concat(n.j,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},execCommandCut:function(){if(X(),!ee())return!1;try{document.execCommand(n.p,!1,null)}catch(e){Object(n.ic)().ULS.traceTag(596456268,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"document.execCommand('".concat(n.p,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},setData:Z,defaultClipboardDataFormat:n.ib},ae=void 0;function ne(e,t,r,a){return oe().setData(e,t,r,a)}function oe(){return void 0===ae&&(ae=te),ae}Object(n.Mb)()&&(ae=re);var ie=void 0,se={};function ce(){if(void 0===ie&&(ie=!1,"chrome"in window)){var e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?ie=!0:Object(n.ic)().ULS.traceTag(596455703,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"chrome.runtime.sendMessage is not available"):Object(n.ic)().ULS.traceTag(596455704,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"chrome.runtime is not available"))}return ie}function le(){if(!ce())return Promise.reject(new n.e(n.f.MissingBrowserExtensionCapability));var e=function(){for(var e in se){if(se[e].includes("getClipboardData"))return e}return null}();if(!e)return Promise.reject(new n.e(n.f.NoBrowserExtensionWithGetClipboardDataCommand));var t={command:"getClipboardData"};return function(e,t){return new Promise((function(r,a){var i=!0;window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var o=window.chrome.runtime.lastError;if(!t||"object"!=typeof t||Array.isArray(t)||o){i=!1;var s=n.jb;o&&"message"in o&&"string"==typeof o.message&&(s=o.message),a(new n.e(n.f.UnavailableBrowserExtension,"chromeSystemClipboard - '".concat("getClipboardData","': browser extension '").concat(e,"' is not available. Error: ").concat(s)))}else{i=!1;var c=t,l=c.html,d=c.img,u=c.text,p=function(e,t,r){var a=!!e,n=!!t,o=!!r,i=e.includes("<img src="),s=n&&a&&i;return n&&!o||s}(l,d,u);r({text:u,html:p?d:l})}})),setTimeout((function(){i&&(Object(n.ic)().ULS.traceTag(589947076,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"chromeSystemClipboard - getPasteWithExtensionPromise reject the promise after timeout. chromeExtenstionsInfo: '".concat(se,"'")),a(new n.e(n.f.UnavailableBrowserExtension,"chromeSystemClipboard - '".concat("getClipboardData","': browser extension '").concat(e,"' is not available. Timeout after : ").concat(2e3," ms"))))}),2e3)}))}(e,t).then((function(t){if(!t)return Promise.reject(new n.e(n.f.NoAvailableBrowserExtensions));Object(n.ic)().ULS.traceTag(589947075,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"chromeSystemClipboard - paste by browser extension '".concat(e,"'"));var r=Object(n.R)();return r.setItem(n.hb,t.text),r.setItem(n.hc,t.html),r.setItem(n.Rb,e),r}))}function de(e){if(!e||!e.items)return Promise.reject(new n.H(n.I.ClipboardIsInaccessible,"getImageDataUrlFromClipboardData: clipboardData is undefined=".concat(!e," clipboardData.items is undefined=").concat(!e.items)));for(var t=function(t){var r=Object(o.ewaUtils)().isChangeGateEnabled("OfficeVSO:5868076_BlockNonImageFilePaste"),a=!r||e.items[t].type&&e.items[t].type.startsWith("image");if(r&&!a&&Object(n.ic)().ULS.traceTag(528859143,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Non-image type read from System Clipboard. File Type is "+e.items[t].type),"file"===e.items[t].kind&&a){var i=o.perfWatch.start("ImageFile_Read_From_Clipboard"),s=e.items[t].getAsFile(),c=s?s.size:-1,l=Object(n.V)(),d=new FileReader;return d.onload=function(){d.result?(o.perfWatch.success(i,(function(e){return Object(n.ic)().ULS.traceTag(595911452,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,ue(e,c))})),l.resolve(d.result.toString())):(o.perfWatch.failure(i,(function(e){return Object(n.ic)().ULS.traceTag(595911453,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,ue(e,c))})),l.reject(new n.H(n.I.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},d.onerror=function(){o.perfWatch.failure(i,(function(e){return Object(n.ic)().ULS.traceTag(595911454,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,ue(e,c))})),l.reject(new n.H(n.I.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},o.perfWatch.mark(i,"Starting_readAsDataURL"),d.readAsDataURL(s),{value:l.promise}}},r=0;r<e.items.length;r+=1){var a=t(r);if("object"==typeof a)return a.value}return Promise.resolve(n.jb)}function ue(e,t){var r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function pe(e,t,r){if(X(),!r&&!H()&&!B())return Object(n.ic)().ULS.traceTag(596456327,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getData - programmatic ".concat(n.E," clipboard access is not supported. rawEvent is empty = ").concat(!!t)),Promise.resolve(n.jb);var a=q();if(!a||!Y(a))return Object(n.ic)().ULS.traceTag(596456328,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"getData - ".concat(n.E," is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '").concat(e,"'")),r||(Object(n.ic)().ULS.shipAssertTag(596456329,o.LogCategory.msoulscat_ES_EWAJS,H()&&B(),"getData - programmatic ".concat(n.E," is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '").concat(H(),"'. isProgrammaticAccessSupported = '").concat(B(),"'. clipboardDataFormat = '").concat(e,"'")),V(),K()),Promise.resolve(n.jb);var i=e;i===n.hb&&(i=n.ib);var s=n.jb;try{(s=a.getData(i))||(s=n.jb),Object(n.ic)().ULS.traceTag(596456330,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getData('".concat(i,"') returned ").concat(s.length," characters"))}catch(e){Object(n.ic)().ULS.traceTag(596456331,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getData with '".concat(i,"' threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}if(!r&&H()&&(V(),s===n.jb)){if($(e,n.Zb,void 0))return pe(e,void 0,!1).then((function(t){return t===n.jb?K():$(e,n.jb,void 0),Promise.resolve(s)}));K()}return Promise.resolve(s)}var ge={init:function(){},execCommandPaste:function(){var e;try{e=document.execCommand(n.E,!1,null)}catch(e){Object(n.ic)().ULS.traceTag(596456322,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"document.execCommand('".concat(n.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},getData:function(e,t,r){var a=n.jb;try{var i=Q(t);if(!i||!Y(i))return Promise.resolve(a);if(e===n.Cb)return de(i);(a=i.getData(e))||(a=n.jb),Object(n.ic)().ULS.traceTag(596456323,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getData('".concat(e,"') returned ").concat(a.length," characters"))}catch(t){Object(n.ic)().ULS.traceTag(596456324,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"getData with '".concat(e,"' threw an exception. This is a browser bug. Ignoring. Exception:: ").concat(o.utils.getStringifiedError(t)))}return Promise.resolve(a)},browserExtensionPaste:function(){return Promise.reject(new n.e(n.f.NoBrowserExtensionsInConfiguration))}},fe={init:function(){},execCommandPaste:function(){if(X(),H()&&pe(n.hb,void 0,!1),!B())return Object(n.ic)().ULS.traceTag(596456325,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"document.execCommand - programmatic clipboard '".concat(n.E,"' access is not allowed in this session.")),!1;try{document.execCommand(n.E,!1,null)}catch(e){Object(n.ic)().ULS.traceTag(596456326,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"document.execCommand('".concat(n.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},getData:pe,browserExtensionPaste:function(){return Promise.reject(new n.e(n.f.NoBrowserExtensionsInConfiguration))}},me={init:function(){!function(){var e=ze().getChromeExtensionIds();if(0!==e.length){var t={command:"getAvailableCommands"};e.forEach((function(e){window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var r=window.chrome.runtime.lastError;if(t&&Array.isArray(t)&&0!==t.length&&!r)se[e]=t;else{var a=n.jb;r&&"message"in r&&"string"==typeof r.message&&(a=r.message),Object(n.ic)().ULS.traceTag(589947074,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"chromeSystemClipboard - '".concat("getAvailableCommands","': browser extension '").concat(e,"' is not available. Error: ").concat(a))}}))}))}}()},execCommandPaste:function(){var e=!1;try{void 0===(e=document.execCommand(n.E,!1,null))&&(e=!0)}catch(e){Object(n.ic)().ULS.traceTag(596455698,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Chrome: document.execCommand('".concat(n.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return e},getData:function(e,t,r){var a=n.jb;try{var i=Q(t);if(!i||!Y(i))return Promise.resolve(a);if(e===n.Cb)return de(i);(a=i.getData(e))||(a=n.jb),Object(n.ic)().ULS.traceTag(596455699,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Chrome: getData('".concat(e,"') returned ").concat(a.length," characters"))}catch(t){Object(n.ic)().ULS.traceTag(596455700,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"Chrome: getData with '".concat(e,"' threw an exception. This is a browser bug. Ignoring. Exception:: ").concat(o.utils.getStringifiedError(t)))}return Promise.resolve(a)},browserExtensionPaste:function(){return le()}},he=void 0;function be(){return void 0===he&&(he=ce()?me:ge),he}Object(n.Mb)()&&(he=fe);var ye=r(412),Se=function(e,t){if(ve(e))e.replaceChildren(t);else{for(;e.firstChild;)e.removeChild(e.firstChild);Ce(e,t)}},Ce=function(e,t){if(Ee(e))e.append(t);else if("string"==typeof t){var r=document.createTextNode(t);e.appendChild(r)}else e.appendChild(t)},ve=function(e){return!!e.replaceChildren},Ee=function(e){return!!e.append};function we(){var e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function Le(e,t,r){void 0===r&&(r=void 0),Object(n.ic)().ULS.shipAssertTag(596444114,o.LogCategory.msoulscat_ES_EWAJS,!1===t&&!r||!0===t&&(!!r||r===n.jb),"enableClipboardEvents: useTextHtmlContentCandidate = '".concat(t,"', textHtmlContentCandidate is ").concat(r||r===n.jb?n.jb:"not ","provided"));var a=document.activeElement&&document.activeElement.id;a||Object(n.ic)().ULS.traceTag(595719625,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");var i=function(e,t){var r=Ie();r&&r.tagName&&"div"!==r.tagName.toLowerCase()&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0);r||(r=function(){var e=document.createElement("div");return function(e){e.id="ccpContentEditable",e.contentEditable="true",Ae()&&(e.contentEditable="false");e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=function(){e.onmousemove=null,Object(n.ic)().ULS.assertTag(595957699,o.LogCategory.msoulscat_ES_EWAJS,!1,"contentEditableElement.onmousemove: Mouse move event is not expected on element '".concat("ccpContentEditable","'. it should be covered by other elements"))}}(e),document.body.appendChild(e),e}());if(Object(n.Mb)()){var a=t;e?a||(a=n.jb):a=Pe().outerHTML,r.innerHTML=ye.sanitize(a)}else if(Object(o.ewaUtils)().isChangeGateEnabled("OfficeVSO:6526590_firefoxrowheadersmisalignonpaste"))Se(r,e?null!=t?t:n.jb:Pe());else{a=t;e?(a||(a=n.jb),je(r,a)):je(r,Pe())}return r}(t,r);a&&a===i.id&&(a=void 0),i.focus();var s=document.getSelection();if(s){s.removeAllRanges();var c=document.createRange();c.selectNodeContents(i),s.addRange(c)}return e&&Te(!0),a}function Te(e){if(Ae()){var t=Ie();t&&(t.contentEditable=e?"true":"false")}}function _e(){var e=Ie();if(!e)return!1;try{var t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,a=document.elementFromPoint(t,r);return!!a&&(a.id===e.id||!!a.parentElement&&a.parentElement.id===e.id)}catch(e){return Object(n.ic)().ULS.traceTag(595957534,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"isContentEditableElementVisibleToUser: hit test failed with error: ".concat(o.utils.getStringifiedError(e))),!1}}function Ie(){return document.getElementById("ccpContentEditable")}function Oe(){var e=Ie();e&&(Object(n.Mb)()?e.innerHTML=ye.sanitize(Pe().outerHTML):Object(o.ewaUtils)().isChangeGateEnabled("OfficeVSO:6526590_firefoxrowheadersmisalignonpaste")?Se(e,Pe()):je(e,Pe()))}function Pe(){var e=document.createElement("span");return e.innerText=n.Yb,e}function Ae(){return!Object(n.Mb)()}function je(e,t){try{e.append(t)}catch(a){if(!(a instanceof TypeError))throw a;if("string"==typeof t){var r=document.createTextNode(t);e.appendChild(r)}else e.appendChild(t)}}var xe=function(){function e(e){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.clipboardFormatReadTimes={},this.clipboardFormatReadStatus={},this.asyncApiReadTimedOut=!1,this.skipFilesIfPlainTextExists=e,this.clipboardStorageType=n.g.SystemClipboard,this.disposableImplementationExtension=Object(n.X)("SystemClipboardStorage"),be().init()}return e.prototype.get=function(e){var t=this;if(this.disposableImplementationExtension.throwIfDisposed("get"),Object(n.ic)().ULS.traceTag(596449096,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.get: isKeyboardEvent = '".concat(e.isKeyboardEvent,"'")),e.skipSystemClipboardAccess){Object(n.ic)().ULS.traceTag(596124883,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.get: Skipping system clipboard access");var r=Object(n.P)(document,n.F,(function(e){return t.skipSystemClipboardPasteHandler(e,r)}),!0);return this.removeLastPasteEventListenerCallback=r,Promise.resolve(Object(n.sb)())}if(this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){var a=this.lastDeferredPastePromise,i="There exists a pending deferred promise with id '".concat(a.id,"', representing an active ").concat(n.E," event. Scheduling a rejection to execute after the current operation.");Object(n.ic)().ULS.traceTag(596455680,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,i),window.setTimeout((function(){a.reject(new n.e(n.f.RejectingPendingPastePromiseDueToNewPasteOperation,i))}),0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);var s=Object(n.V)();this.lastDeferredPastePromise=s;var c=s.id,l=Object(n.P)(document,n.F,(function(r){return t.pasteHandler(r,s,e.isKeyboardEvent,l,e)}),!0);this.removeLastPasteEventListenerCallback=l,this.selectedRangeToRestore=we(),this.activeElementIdToRestore=Le(!0,!1);try{var d=!1;if(e.isKeyboardEvent||(d=be().execCommandPaste()),e.isKeyboardEvent);else if(!d)return this.clearPasteCallbackConfiguration(s,!0,!0),be().browserExtensionPaste().then((function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Promise.reject(new n.e(n.f.ClipboardIsInaccessible,"document.execCommand(".concat(n.E,") failed in SystemClipboard.get. Deferred promise id = '").concat(c,"'"),r))}))}catch(e){return this.clearPasteCallbackConfiguration(s,!0,!1),Promise.reject(new n.e(n.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '".concat(c,"'"),e))}return s.promise.then((function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Object(n.Hb)(r,n.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(r):Promise.reject(new n.e(n.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '".concat(c,"'"),r))}))},e.prototype.set=function(t,r){var a=this;if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(n.ic)().ULS.traceTag(596449097,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.set: isKeyboardEvent = '".concat(r.isKeyboardEvent,"'; cutCopyPasteFlags = '").concat(r.commandType,"'")),Object(n.ic)().ULS.shipAssertTag(595932513,o.LogCategory.msoulscat_ES_EWAJS,!r.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),Object(n.Mb)()&&!r.isKeyboardEvent){if(r.silentClipboardAccessFailures&&H())return Object(n.ic)().ULS.traceTag(596455681,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!H()&&!B())return Object(n.ic)().ULS.traceTag(596455682,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){var i=this.lastDeferredCutCopyPromise,s="There exists a pending deferred promise with id '".concat(i.id,"', representing an active ").concat(n.p,"/").concat(n.j," event. Scheduling a rejection to execute after the current operation.");Object(n.ic)().ULS.traceTag(596455683,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,s),window.setTimeout((function(){i.reject(new n.e(r.isKeyboardEvent?n.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:n.f.RejectingBlockedSyncCutCopyPromise,s))}),0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);var c=Object(n.V)();this.lastDeferredCutCopyPromise=c;var l=c.id;try{var d=Object(n.tb)(t),u=e.getClipboardCutCopyEventType(r.commandType),p=Object(n.P)(document,u,(function(e){r.isTimestampStoredInSystemClipboard=!0,a.cutCopyHandler(e,c,d,r.isKeyboardEvent,r.commandType,p)}));this.removeLastCutCopyEventListenerCallback=p;var g=n.jb;Object(n.Mb)()&&(g=Object(n.lb)(d,n.hc)),this.selectedRangeToRestore=we(),this.activeElementIdToRestore=Le(!1,!!g,g);var f=!1;if(Object(n.Mb)()&&r.isKeyboardEvent||(f=r.commandType===n.r.Cut?oe().execCommandCut():oe().execCommandCopy()),r.isKeyboardEvent);else if(!f)return this.clearCutCopyCallbackConfiguration(c,!0,!0),!Object(n.Mb)()||H()||B()||(Object(n.ic)().ULS.traceTag(596455684,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '".concat(l,"'")),c.resolve()),Promise.resolve()}catch(e){return this.clearCutCopyCallbackConfiguration(c,!0,!1),Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '".concat(l,"'"),e))}return c.promise.catch((function(e){return e&&Object(n.Ib)(e,[n.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,n.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '".concat(l,"'"),e))}))},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[n.hb,n.hc,n.Cb]},e.prototype.cutCopyHandler=function(e,t,r,a,i,s){var c=this;try{if(Object(n.ic)().ULS.traceTag(596449098,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'; bubbles = '").concat(e.bubbles,"'; eventPhase = '").concat(e.eventPhase,"'")),s(),this.removeLastCutCopyEventListenerCallback===s&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(Object(n.ic)().ULS.shipAssertTag(596455686,o.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'")),!t)return;if(Object(n.ic)().ULS.traceTag(596455687,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'; deferred promise id = '").concat(t.id,"'")),Object(n.ic)().ULS.shipAssertTag(596455688,o.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.cutCopyHandler: deferred promise '".concat(t.id,"' is already fulfilled. isKeyboardEvent = '").concat(a,"'; cutCopyPasteFlags = '").concat(i,"'")),t.fulfilled())return;var l=function(){t.resolve(),c.clearCutCopyCallbackConfiguration(t,!1,!1)},d=Object(n.lb)(r,n.hc);if(d&&Object(n.Mb)())window.setTimeout(l,0);else{d&&ne(n.hc,d,e,a);var u=Object(n.pb)(r);ne(oe().defaultClipboardDataFormat,u,e,a),e.preventDefault(),l()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),Object(n.ic)().ULS.traceTag(596455689,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"SystemClipboardStorage.cutCopyHandler callback with deferred promise id '".concat(t?t.id:n.jb,"' (fulfilled = '").concat(t?t.fulfilled():n.jb,"') failed with this exception: ").concat(e&&e.message?e.message:"NA",". Call stack: ").concat(e.stack?e.stack:"NA")),t&&t.reject(new n.e(n.f.SetClipboardItems,"Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '".concat(t.id,"'. Error: ").concat(e&&e.message?e.message:"NA"),e))}},e.prototype.pasteHandler=function(e,t,r,a,i){var s=this,c=!0,l=Object(o.ewaUtils)().isChangeGateEnabled("OfficeVSO:6526590_firefoxrowheadersmisalignonpaste");try{if(Object(n.ic)().ULS.traceTag(596449099,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '".concat(r,"'; eventPhase='").concat(e.eventPhase,"'")),l&&e.preventDefault(),a(),this.removeLastPasteEventListenerCallback===a&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(Object(n.ic)().ULS.shipAssertTag(596455690,o.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '".concat(r,"'")),!t)return;if(Object(n.ic)().ULS.traceTag(596455691,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '".concat(r,"'; deferred promise id = '").concat(t.id,"'")),Object(n.ic)().ULS.shipAssertTag(596455692,o.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.pasteHandler: deferred promise '".concat(t.id,"' is already fulfilled. isKeyboardEvent = '").concat(r,"'")),t.fulfilled())return;Object(n.ic)().ULS.traceTag(541405714,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: Checking if navigator.clipboard exists");Object(n.ic)().ULS.traceTag(541405715,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: shouldLogAsyncApiImpact is false");var d=Object(n.R)(),u=this.getSupportedDataFormats(),p=this.readDataFormats(u,e,r,d,!!i.clipboardAsyncApiDataFormatsToRead);Promise.all(p).then((function(){e.stopPropagation(),c=!1,Object(n.Mb)()?window.setTimeout((function(){var e,r=document.getElementById("ccpContentEditable");if(r&&r.firstChild&&"IMG"===r.firstChild.nodeName){var a=r.firstChild;a&&a.src&&a.src.indexOf("base64")>-1?d.setItem(n.Cb,a.src):Object(n.ic)().ULS.traceTag(595907107,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else d.setItem(n.hc,(e=Ie(),Object(n.ic)().ULS.shipAssertTag(596444113,o.LogCategory.msoulscat_ES_EWAJS,!!e,"getTextHtmlContent: the content editable element does not exist"),e?ye.sanitize(e.innerHTML):n.jb)),n.Bb.isContainsTimestampWrapper(r)&&d.setItem(n.hb,n.Bb.createPlainTextFromHtml(r));Oe(),t.resolve(d),s.clearPasteCallbackConfiguration(t,!1,!1)}),0):(l||e.preventDefault(),Oe(),t.resolve(d),s.clearPasteCallbackConfiguration(t,!1,!1))}))}catch(r){Oe();try{c&&e.stopPropagation(),l||e.preventDefault()}catch(e){Object(n.ic)().ULS.traceTag(595985030,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: ".concat(o.utils.getStringifiedError(e)))}this.clearPasteCallbackConfiguration(t,!1,!1),Object(n.ic)().ULS.traceTag(596455693,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"SystemClipboardStorage.pasteHandler callback with deferred promise id '".concat(t?t.id:n.jb,"' (fulfilled = '").concat(t?t.fulfilled():n.jb,"') failed with an exception: ").concat(r&&r.message?r.message:"NA",". Call stack: ").concat(r.stack?r.stack:"NA")),t&&t.reject(new n.e(n.f.GetClipboardItems,"Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '".concat(t.id,"'. Error: ").concat(r&&r.message?r.message:"NA"),r))}},e.prototype.isFileFormat=function(e){return e===n.Cb},e.prototype.isPlainTextEmpty=function(e){var t=e.getItem("text/plain");return!t||0===t.length},e.prototype.readDataFormats=function(e,t,r,a,i){var s=this;if(!this.skipFilesIfPlainTextExists||!r&&Object(n.Gb)()&&Object(o.ewaUtils)().isChangeGateEnabled("OfficeVSO:7309157_ValidateEdgeRibbonCommandImageCopy"))return!r&&Object(n.Gb)()&&Object(n.ic)().ULS.traceTag(509687138,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.readDataFormats: reading all data formats for chromium edge when paste command is initiated through Ribbon/context menu"),this.readDataFormatsInternal(e,t,r,a,i);var c=e.filter((function(e){return s.isFileFormat(e)}));if(0===c.length)return this.readDataFormatsInternal(e,t,r,a,i);var l=e.filter((function(e){return!s.isFileFormat(e)})),d=this.readDataFormatsInternal(l,t,r,a,i);return[Promise.all(d).then((function(){if(!s.isPlainTextEmpty(a))return Object(n.ic)().ULS.traceTag(595653317,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.readDataFormats: skip files loading because clipboard contains plain text"),Promise.resolve();var e=s.readDataFormatsInternal(c,t,r,a,i);return Promise.all(e)}))]},e.prototype.logClipboardReadTimeAndStatus=function(e){var t=this;Object(n.ic)().ULS.traceTag(545399641,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.logClipboardReadTimeAndStatus: Logging time taken to read data from clipboard and success or failure status"),e.clipboardFormatReadTimes=n.hb+":"+this.clipboardFormatReadTimes[n.hb]+","+n.hc+":"+this.clipboardFormatReadTimes[n.hc],e.clipboardFormatReadStatus=n.hb+":"+this.clipboardFormatReadStatus[n.hb]+","+n.hc+":"+this.clipboardFormatReadStatus[n.hc],e.clipboardAsyncApiDataFormatsToRead.forEach((function(r){e.clipboardFormatReadTimes+=","+r+":"+t.clipboardFormatReadTimes[r],e.clipboardFormatReadStatus+=","+r+":"+t.clipboardFormatReadStatus[r]})),e.asyncApiReadTimedOut=this.asyncApiReadTimedOut},e.prototype.initializeClipboardFormatReadArrays=function(e){var t=this;this.clipboardFormatReadStatus[n.hb]="_",this.clipboardFormatReadTimes[n.hc]="_",e.clipboardAsyncApiDataFormatsToRead.forEach((function(e){t.clipboardFormatReadStatus[e]="_",t.clipboardFormatReadTimes[e]="_"})),this.asyncApiReadTimedOut=!1},e.prototype.willClipboardReadPermissionPromptShow=function(){try{if(navigator.permissions){return navigator.permissions.query({name:"clipboard-read",allowWithoutGesture:!0}).then((function(e){return e&&"prompt"===e.state?Promise.resolve(!0):Promise.resolve(!1)}),(function(){return Promise.resolve(!1)}))}return Promise.resolve(!1)}catch(e){return Object(n.ic)().ULS.traceTag(540037264,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.willClipboardReadPermissionPromptShow: In catch block: "+e),Promise.resolve(!1)}},e.prototype.getAsyncTextReadPromiseWrapper=function(e,t,r,a,i){return new Promise((function(s){var c=!1;i().then((function(e){e||window.setTimeout((function(){c||(Object(n.ic)().ULS.traceTag(540160580,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromiseWrapper: navigator.clipboard.read() has timed out"),a(),s())}),1750)})),r(e,t).then((function(){c=!0,s()}))}))},e.prototype.getAsyncTextReadPromise=function(e,t){try{Object(n.ic)().ULS.traceTag(541646986,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Before calling navigator.clipboard.read()");var r=window.performance.now(),a=navigator.clipboard.read();return Object(n.ic)().ULS.traceTag(541646987,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Created navigator.clipboard.read() promise"),a.then((function(e){return Object(n.ic)().ULS.traceTag(541646988,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Inside first navigatorReadPromise then() block"),e[0].getType(n.hb)})).then((function(e){return e.text()})).then((function(){return Object(n.ic)().ULS.traceTag(545399642,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Plain text successfully read using Async API"),e[n.hb+"Async"]=(window.performance.now()-r).toFixed(3).toString(),t[n.hb+"Async"]="success",Promise.resolve()}),(function(a){return Object(n.ic)().ULS.traceTag(543470850,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Promise rejected:"+a),e[n.hb+"Async"]=(window.performance.now()-r).toFixed(3).toString(),t[n.hb+"Async"]="failure",Promise.resolve()})).catch((function(a){return Object(n.ic)().ULS.traceTag(545118098,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Inside inner catch block:"+a),e[n.hb+"Async"]=(window.performance.now()-r).toFixed(3).toString(),t[n.hb+"Async"]="failure",Promise.resolve()}))}catch(e){return Object(n.ic)().ULS.traceTag(545118099,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.getAsyncTextReadPromise: Inside outer catch block:"+e),Promise.resolve()}},e.prototype.readDataFormatsInternal=function(e,t,r,a,i){var s=[],c={};return e.forEach((function(e){!i||e!==n.hb&&e!==n.hc||(c[e]=window.performance.now()),s.push(function(e,t,r){return be().getData(e,t,r)}(e,t,r).then((function(t){if(i&&(e===n.hb||e===n.hc)){var r=(window.performance.now()-c[e]).toFixed(3).toString();Object(n.ic)().ULS.traceTag(538248469,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.readDataFormatsInternal: Read successful, Format="+e+",TimeInMs="+r)}Object(n.ic)().ULS.traceTag(541646989,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.readDataFormatsInternal: Read "+e+" from clipboard"),a.setItem(e,t)})).catch((function(t){if(i&&(e===n.hb||e===n.hc)){var r=(window.performance.now()-c[e]).toFixed(3).toString();Object(n.ic)().ULS.traceTag(538248470,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.readDataFormatsInternal: Read failed, Format="+e+",TimeInMs="+r)}Object(n.ic)().ULS.traceTag(595653318,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"SystemClipboardStorage.readDataFormatsInternal: Failed to get data of type [".concat(e,"]. Error [").concat(o.utils.getStringifiedError(t),"]"))})))})),s},e.prototype.skipSystemClipboardPasteHandler=function(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){Object(n.ic)().ULS.traceTag(595993058,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: ".concat(e&&e.message?e.message:"NA",". Call stack: ").concat(e.stack?e.stack:"NA"))}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)},e.prototype.hasPlainText=function(e){return!!e&&Object.keys(e.getData().items).indexOf(n.hb)>-1},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(n.ec)([function(){e.lastDeferredCutCopyPromise&&!e.lastDeferredCutCopyPromise.fulfilled()&&(e.lastDeferredCutCopyPromise.reject(),e.lastDeferredCutCopyPromise=void 0,e.removeLastCutCopyEventListenerCallback&&(e.removeLastCutCopyEventListenerCallback(),e.removeLastCutCopyEventListenerCallback=void 0))},function(){e.lastDeferredPastePromise&&!e.lastDeferredPastePromise.fulfilled()&&(e.lastDeferredPastePromise.reject(),e.lastDeferredPastePromise=void 0,e.removeLastPasteEventListenerCallback&&(e.removeLastPasteEventListenerCallback(),e.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())},e.getClipboardCutCopyEventType=function(e){if(!e)return n.k;if(e===n.r.Copy)return n.k;if(e===n.r.Cut)return n.q;throw new n.t(n.jb,"cutCopyPasteFlags",e.toString())},e.prototype.restoreFocusToPreviouslyActiveElement=function(){if(this.activeElementIdToRestore){var e=document.getElementById(this.activeElementIdToRestore);e&&e.focus(),this.activeElementIdToRestore=void 0}},e.prototype.restoreSelection=function(){this.selectedRangeToRestore&&(!function(e){if(void 0===e&&(e=void 0),e){var t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)},e.prototype.clearCutCopyCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Object(n.ic)().ULS.shipAssertTag(595957697,o.LogCategory.msoulscat_ES_EWAJS,!_e(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),(e===this.lastDeferredCutCopyPromise||e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id)&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||Object(n.ic)().ULS.traceTag(596449290,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"SystemClipboardStorage.set: the ".concat(n.p,"/").concat(n.j," event listener was not called. Calling removeLastCutCopyEventListenerCallback()")),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)},e.prototype.clearPasteCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Te(!1),Object(n.ic)().ULS.shipAssertTag(595957698,o.LogCategory.msoulscat_ES_EWAJS,!_e(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),(e===this.lastDeferredPastePromise||e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id)&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||Object(n.ic)().ULS.traceTag(596449291,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"SystemClipboardStorage.get: the ".concat(n.E," event listener was not called. Calling removeLastPasteEventListenerCallback()")),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)},e.prototype.clearSystemClipboard=function(){var e=Object(n.sb)(),t={isKeyboardEvent:!1,commandType:n.r.Copy};this.set(e,t).then((function(){Object(n.ic)().ULS.traceTag(595935906,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")}),(function(){Object(n.ic)().ULS.traceTag(595935907,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")}))},e}(),Me=function(e){function t(t){return e.call(this,n.i.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},t)||this}return Object(l.__extends)(t,e),t}(n.h),De=function(){function e(){this.clipboardStorageType=n.g.InMemory,this.disposableImplementationExtension=Object(n.X)("InMemoryClipboardStorage")}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())},e.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(Object(n.sb)())},e.prototype.set=function(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[n.hb,n.hc,"data/shadow-workbook"]},e}(),We=function(e){function t(t){return e.call(this,n.i.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(l.__extends)(t,e),t}(n.h),Re=function(){function e(e,t,r,a){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=a,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=Object(n.X)("".concat(e))}return e.prototype.initialize=function(e,t){var r=this;return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then((function(e){return r.systemClipboardStrategy=e,t.then((function(e){return r.fullAccessClipboardStrategy=e,r.initialized=!0,Promise.resolve(r)}))}))},e.prototype.set=function(e,t){var r=this;try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new n.e(n.f.ClipboardStrategyNotInitialized));var a={systemClipboardOperationResult:Object(n.T)(n.Yb,"setresult",!1),fullAccessClipboardOperationResult:Object(n.T)(n.Yb,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(e),this.systemClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return a.systemClipboardOperationResult.failed=!0,a.systemClipboardOperationResult.clipboardOperationResultError=e,Object(n.Ib)(e,[n.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,n.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(a)})).then((function(a){return r.fullAccessClipboardStrategy?r.fullAccessClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return Object(n.ic)().ULS.traceTag(595933078,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '".concat(r.fullAccessClipboardStrategy&&r.fullAccessClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(t.id?t.id:n.jb,"', Error: ").concat(o.utils.getStringifiedError(e))),a.fullAccessClipboardOperationResult.failed=!0,a.fullAccessClipboardOperationResult.clipboardOperationResultError=e,Promise.resolve(a)})):(a.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(a))})).then((function(e){if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){var t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new n.e(n.f.SetClipboardItems,n.jb))}return Promise.resolve()}))}catch(e){return Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in system clipboard.set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new n.e(n.f.ClipboardStrategyNotInitialized));var r={systemClipboardOperationResult:Object(n.T)(n.Yb,"getresult",!1,void 0,Object(n.qb)()),fullAccessClipboardOperationResult:Object(n.T)(n.Yb,"getresult",!1,void 0,Object(n.qb)())};return this.systemClipboardStrategy.get(e).then((function(e){return r.systemClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.systemClipboardOperationResult),Promise.resolve(r)})).catch((function(e){return r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=e,Object(n.Hb)(e,n.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(e):Promise.resolve(r)})).then((function(r){return t.fullAccessClipboardStrategy?t.fullAccessClipboardStrategy.get(e).then((function(e){return r.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.fullAccessClipboardOperationResult),Promise.resolve(r)})).catch((function(a){return Object(n.ic)().ULS.traceTag(595933079,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '".concat(t.fullAccessClipboardStrategy&&t.fullAccessClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(e.id?e.id:n.jb,"', Error: ").concat(o.utils.getStringifiedError(a))),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=a,Promise.resolve(r)})):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r))})).then((function(r){if(r.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(r.fullAccessClipboardOperationResult.failed){var a=r.systemClipboardOperationResult.clipboardOperationResultError;return a||(a=r.fullAccessClipboardOperationResult.clipboardOperationResultError),a?Promise.reject(a):Promise.reject(new n.e(n.f.GetClipboardItems,n.jb))}return 0===Object(n.ob)(r.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(r.systemClipboardOperationResult.clipboardOperationResultError):t.validateAndReturnFullAccessData(r)}return r.fullAccessClipboardOperationResult.failed?Promise.resolve(Object(n.R)(r.systemClipboardOperationResult.clipboardItemsData)):function(){if(Object(n.Jb)()&&!Object(n.Lb)())return!0;return!1}()?t.pasteSourceReconciliationBasedOnlyOnTextPlain(r):t.pasteSourceReconciliation(r,e)}))}catch(e){return Promise.reject(new n.e(n.f.GetClipboardItems,"Failed in system clipboard.get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(e):(Object(n.ic)().ULS.shipAssertTag(595882509,o.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new n.e(n.f.ClipboardStrategyNotInitialized))):Promise.reject(new n.e(n.f.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new n.e(n.f.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(n.ec)([function(){e.systemClipboardStrategy&&e.systemClipboardStrategy.dispose()},function(){e.fullAccessClipboardStrategy&&e.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.pasteSourceReconciliation=function(e,t){var r=void 0;e.systemClipboardOperationResult.signatureData&&(r=e.systemClipboardOperationResult.signatureData.ccp_infra_timestamp);var a=void 0;return e.fullAccessClipboardOperationResult.signatureData&&(a=e.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),Object(n.ic)().ULS.traceTag(595719624,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard=".concat(r," ccpTimestampInFullAccessClipboard=").concat(a)),r?r>(a||0)?(Ue(e.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(Object(n.R)(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(Object(n.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):t.isTimestampStoredInSystemClipboard?(Ue(e.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(Object(n.R)(e.systemClipboardOperationResult.clipboardItemsData))):this.validateAndReturnFullAccessData(e)},e.prototype.validateAndReturnFullAccessData=function(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(Object(n.R)(e.fullAccessClipboardOperationResult.clipboardItemsData))},e.prototype.pasteSourceReconciliationBasedOnlyOnTextPlain=function(e){if(0===Object(n.ob)(e.systemClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(n.R)(e.systemClipboardOperationResult.clipboardItemsData));if(0===Object(n.ob)(e.fullAccessClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(n.R)(e.systemClipboardOperationResult.clipboardItemsData));var t=e.systemClipboardOperationResult.clipboardItemsData.items[n.hb],r=n.Bb.ensureOneLFPerNewLine(n.Bb.trimToLength(t)),a=e.fullAccessClipboardOperationResult.clipboardItemsData.items[n.hb];return r===n.Bb.ensureOneLFPerNewLine(n.Bb.trimToLength(a))?Promise.resolve(Object(n.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):r===ze().getCopyToClipboardLatencyMessage()?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[n.Ub]=n.Wb,Promise.resolve(Object(n.R)(e.systemClipboardOperationResult.clipboardItemsData)))},e}();function Ue(e,t){e.items[n.Ub]=n.Wb,t&&(e.items[n.Vb]=n.Xb)}var Fe=function(e){function t(t){return e.call(this,n.i.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},n.i.LocalStorage,t)||this}return Object(l.__extends)(t,e),t}(Re),Ne=function(e){function t(t){return e.call(this,n.i.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},n.i.InMemory,t)||this}return Object(l.__extends)(t,e),t}(Re),ke=function(e){function t(t){return e.call(this,n.g.LocalStorage,t)||this}return Object(l.__extends)(t,e),t}(function(e){function t(t,r){var a=e.call(this)||this;if(a.messageDestination=r,!r)throw new n.B(n.jb,"messageDestination");return a.clipboardStorageType=t,a.disposableImplementationExtension=Object(n.X)(r),a}return Object(l.__extends)(t,e),t.prototype.initialize=function(){var e=this;return this.innerInitialize().then((function(){return e}))},t.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),Object(n.ic)().ULS.traceTag(595947538,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"ClipboardStorageIframeProxy.get: isKeyboardEvent = ".concat(e.isKeyboardEvent,"; silentClipboardAccessFailures = ").concat(e.silentClipboardAccessFailures||!1));var t=Object(n.S)(Object(n.bb)(),"get",this.messageDestination,e.userHash);return this.postMessage(t,"get").then((function(e){return e.clipboardItemsData?Promise.resolve(Object(n.R)(e.clipboardItemsData)):Promise.resolve(Object(n.sb)())}))},t.prototype.set=function(e,t){var r;return this.disposableImplementationExtension.throwIfDisposed("set"),Object(n.ic)().ULS.traceTag(595947541,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"ClipboardStorageIframeProxy.set: isKeyboardEvent = ".concat(t.isKeyboardEvent,"; silentClipboardAccessFailures = ").concat(t.silentClipboardAccessFailures||!1)),r=Object(n.nb)(e)>0?Object(n.S)(Object(n.bb)(),"set",this.messageDestination,t.userHash,e.getData()):Object(n.S)(Object(n.bb)(),"set",this.messageDestination),this.postMessage(r,"set").then((function(){}))},t.prototype.clearClipboardNecessary=function(e,t){return Object(n.gc)(e,t)},t.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[n.hb,n.hc,"data/shadow-workbook"]},t.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},t}(F));function Je(e,t,r,a,s,l){var d=function(e,t,r){return new L(e,t,r)}(r,a,s);return function(e,t,r,a){var s=n.s.NoError;return o.utils.chainFallbackPromises(e,(function(e){return function(e,t,r,a){Object(n.ic)().ULS.traceTag(595716231,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '".concat(e.clipboardStrategyType,"'"));var s=function(){return function(){switch(e.clipboardStrategyType){case n.i.SystemClipboard:case n.i.SystemClipboardAndInMemory:return e;case n.i.SystemClipboardAndLocalStorage:return e.systemClipboardStrategyParameters;default:throw new n.L("createClipboardEnvironmentComponentsByType: getSystemClipboardParameters couldn't be used for ".concat(e.clipboardStrategyType))}}().skipFilesIfPlainTextExists},c=function(){switch(e.clipboardStrategyType){case n.i.LocalStorage:return e;case n.i.SystemClipboardAndLocalStorage:return e.localStorageStrategyParameters;default:throw new n.L("createClipboardEnvironmentComponentsByType: getLocalStorageParameters couldn't be used for ".concat(e.clipboardStrategyType))}},l=function(e){return r.createClipboardDataProcessor(e)},d=function(){return r.createClipboardMetaDataProcessor()},u=function(e){return r.createDualClipboardDataProcessor(e)},g=function(){return new k},f=function(e){return function(e){return new N(e)}(e)},m=function(){var e=c();return e.useSharedClipboardIframe?g():f(Object(n.wb)(e.sharedClipboardSchemaVersion))},h=function(){return(new J).initialize(Promise.resolve((e=s(),new xe(e))));var e},b=function(e){return function(e){return new Me(e)}(e).initialize(Promise.resolve(new De))},y=function(e,t){var r,o,s=c();return s.useSharedClipboardIframe?(function(e){var t={};e.wacCluster&&(t.wacCluster=e.wacCluster.trim()),e.sessionId&&(t.sessionId=e.sessionId),a&&(t.bulsEndpointUrl=a);var r=e.sharedClipboardOverrideOrigin?1:0;n.fc.initializeSharedClipboardSettings({sharedClipboardHostingApp:e.sharedClipboardHostingApp,sharedClipboardHostingApps:e.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:e.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:e.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:e.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:e.sharedClipboardExpirationInMinutes,whitelistOriginComponents:r}),i(t)}(s),function(e){return new We(e)}(t).initialize((r=e?n.z.localStorageMetadata:n.z.localStorageData,new ke(r)).initialize())):function(e){return new n.x(e)}(t).initialize(Promise.resolve((o=e?Object(n.vb)(s.sharedClipboardSchemaVersion):Object(n.ub)(s.sharedClipboardSchemaVersion),new n.w(o))))},S=function(e,r,a){return Promise.all([e,r]).then((function(e){var r=e[0];return function(e,r){return(r?r.initialize(e):Promise.resolve(void 0)).then((function(){return p(e,t,r)}))}(e[1],a).then((function(e){return{dataClipboardStrategy:r,metadataManager:e}}))}))};try{switch(e.clipboardStrategyType){case n.i.SystemClipboard:return S(h(),b(d()));case n.i.InMemory:return S(b(l(!1)),b(d()));case n.i.LocalStorage:return S(y(!1,l(!0)),y(!0,d()),m());case n.i.SystemClipboardAndLocalStorage:return S((C=u(!0),new Fe(C)).initialize(h(),y(!1)),y(!0,d()),m());case n.i.SystemClipboardAndInMemory:return S(function(){return(e=u(!1),new Ne(e)).initialize(h(),b());var e}(),b(d()))}return Promise.reject(new n.e(n.f.UnsupportedClipboardStrategyType,"Clipboard strategy type '".concat(e.clipboardStrategyType,"' is not supported")))}catch(t){return Promise.reject(new n.e(n.f.UnsupportedClipboardStrategyType,"failed to create clipboardStrategyType: '".concat(e.clipboardStrategyType,"' with error: ").concat(o.utils.getStringifiedError(t))))}var C}(e,t,r,a).then((function(t){return Object(n.ic)().ULS.traceTag(595716294,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '".concat(e.clipboardStrategyType,"' was created.")),t.infraInitializationError=s,t})).catch((function(t){var r=!1;if(Object(c.isChangeGateEnabled)("OfficeVSO:7488405_CheckIfLocalStorageSupported"))(r=Object(n.Nb)(t))&&(s=n.s.LocalStorageInaccessible);else if(t&&t.innerError&&"string"==typeof t.innerError)try{JSON.parse(t.innerError).reason===n.f.LocalStorageInitilizationInaccessible&&(s=n.s.LocalStorageInaccessible)}catch(e){}var a="clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '".concat(e.clipboardStrategyType,"'. Error: ").concat(o.utils.getStringifiedError(t));return Object(n.ic)().ULS.traceTag(595716230,o.LogCategory.msoulscat_ES_EWAJS,r?o.TraceLevel.Info:o.TraceLevel.Error,a),Promise.reject(new n.e(n.f.SelectClipboardStrategy,a,t))}))}))}(e,t,d,l).then((function(e){return{dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:d,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError}}))}function ze(){return Ge}var He;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(He||(He={}));var Ve={initializationStatus:He.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:n.fc.defaultPromiseTimeoutInMinutes,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:n.s.NoError},Ge={init:function(e,t,r,a,i,s,c,l,d,u,p,g,f,m,h,b,y,S,C){if(Ve.lastClipboardPlatformEnvironmentInitializationInfo)return Promise.resolve(Ve.lastClipboardPlatformEnvironmentInitializationInfo);e&&Object(o.initEwaUtils)(e);if(Object(n.Eb)(t),!r||!Array.isArray(r))return Promise.reject(new n.B(n.jb,"chromeExtensionIds"));Object(n.ic)().ULS.traceTag(596455702,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"ClipboardPlatformEnvironment.init: chromeExtensionIds = '".concat(JSON.stringify(r),"'")),Ve.chromeExtensionIds=qe(r),p&&(Ve.copyToClipboardLatencyMessage=p);"number"!=typeof u||isNaN(u)||(Ve.clipboardPromiseTimeoutInMinutes=u);return Ve.initializationStatus=He.StateReady,Je(m,f,h,b,y,C).then((function(e){return Ve.clipboardDataManager=e.clipboardDataManager,Ve.metadataManager=e.metadataManager,Ve.clipboardStrategy=e.dataClipboardStrategy,Ve.initializationError=e.infraInitializationError,Ve.initializationStatus=He.InitializationSucceed,Ve.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:m,dataClipboardCapabilities:Ve.clipboardStrategy&&Ve.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:Ve.clipboardStrategy&&Ve.clipboardStrategy.clipboardStrategyType,infraInitializationError:Ve.initializationError},Ve.lastClipboardPlatformEnvironmentInitializationInfo}))},getClipboardStrategy:function(){if(Be(),!Ve.clipboardStrategy)throw new n.u("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return Ve.clipboardStrategy},getChromeExtensionIds:function(){return Ke(),Ve.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return Ke(),Ve.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return Ke(),Ve.copyToClipboardLatencyMessage},getMetadataManager:function(){return Be(),Ve.metadataManager},getClipboardDataManager:function(){return Be(),Ve.clipboardDataManager},getInitializationError:function(){return Be(),Ve.initializationError}};function Be(){if(Ve.initializationStatus!==He.InitializationSucceed)throw new n.u("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function Ke(){if(Ve.initializationStatus<He.StateReady)throw new n.u("ClipboardPlatformEnvironment state is not ready. Call init(...).")}function qe(e){var t=[];if(!e)return t;for(var r=0,a=e;r<a.length;r++){var n=a[r];n&&"string"==typeof n&&n.trim().length>0&&t.push(n)}return t}r.d(t,"createClipboardItems",(function(){return n.R})),r.d(t,"getClipboardPlatformEnvironment",(function(){return ze}))},97:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var a=r(134),n={};function o(){return"undefined"==typeof __get_feature_gate_dictionary_variable?n:__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===a||"false"!==a&&t},t.getNumberFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===a)return t;if("infinity"===a||"+infinity"===a)return 1/0;if("-infinity"===a)return-1/0;var n=parseFloat(a);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===a)return t;var n=parseInt(a,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){var t=a.globalThis.__get_feature_gate_dictionary_variable;return a.globalThis.__get_feature_gate_dictionary_variable=e,t}},98:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var a=r(134);function n(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){var t;return null===(t=n()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=a.globalThis.__get_change_gate_dictionary_variable;return a.globalThis.__get_change_gate_dictionary_variable=e,t}}});
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/clipboardPlatform.min.js.map/7579133399f431a9c979c949e5562a99/clipboardPlatform.min.js.map