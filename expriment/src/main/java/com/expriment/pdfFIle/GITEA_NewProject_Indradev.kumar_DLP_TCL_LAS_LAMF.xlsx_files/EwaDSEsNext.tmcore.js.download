'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[32],{1257:function(r,B,a){a.r(B);r=a(0);var c=a(15);class b{constructor(l,k,w,n,x,m){l&&(this.N=l);k&&(this.S=k);w&&(this.M=w);n&&(this.F=n);null!=x&&(this.L=x);null!=m&&(this.C=m)}}Object(r.a)(b,"SerializableExceptionEntry",null,[]);class e{constructor(l,k,w,n,x){this.T=l;this.L=k;this.S=w;this.I=n;this.V=x}}Object(r.a)(e,"SerializableLogCache",null,[]);class f{constructor(l,k,w,n,x,m,u=!1,t=null,y=null){this.T=
this.G=0;this.C=this.M=null;this.D=0;this.G=m;this.T=n;this.M=l;this.C=k;this.D=1E3*x+w;u&&(this.O=1);t&&(this.A=t);y&&(this.E=y)}B6g(){if(!this.E)return 0;let l=7,k=0;this.E.N&&(l+=6+f.G$(this.E.N),k++);this.E.S&&(l+=6+f.G$(this.E.S),k++);this.E.M&&(l+=6+f.G$(this.E.M),k++);this.E.F&&(l+=6+f.G$(this.E.F),k++);this.E.L&&(l+=6+f.G$(this.E.L),k++);this.E.C&&(l+=6+f.G$(this.E.C),k++);1<k&&(l+=k-1);return l}Qah(){let l=a(1257).LogCache.JGi+f.G$(this.G)+f.G$(this.T)+this.M.length+f.G$(this.C)+f.G$(this.D)+
this.B6g();1===this.O&&(l+=6);if(this.A){l+=7;for(let k=0,w=this.A.length;k<w;++k)l+=this.A[k].length+3}return l}static G$(l){return(""+l).length}}Object(r.a)(f,"SerializableLogEntry",null,[]);var d=a(388);a.d(B,"LogCache",function(){return h});class h{constructor(l,k,w){this.KVc=0;this.zWb=null;this.OCa=this.VZb=this.mjb=0;this.NUc=l;this.IXa=k;this.A9=w;this.NUc=262144>l?l:262144;this.ADg=this.NUc-4*(this.IXa+25);this.reset()}reset(){this.zWb=[];this.mjb=25;this.KVc=(new Date).getTime()}get count(){return this.zWb.length}get pRb(){return this.VZb}set pRb(l){this.VZb=
l}DMg(l){if(l){l.message=this.CQb(l.message,"message",l.tag);var k=l.Hcd;k&&(k.name=this.CQb(k.name,"Exception.Name",l.tag),k.stack=this.CQb(k.stack,"Exception.Stack",l.tag),k.message=this.CQb(k.message,"Exception.Message",l.tag),k.file=this.CQb(k.file,"Exception.File",l.tag));if(l.Kg)for(var w=0;w<l.Kg.length;w++)l.Kg[w].length>this.IXa&&(l.Kg[w]=l.Kg[w].substr(0,this.IXa-13)+"... [trimmed]",c.ULS.sendTraceTag(3465240,100,50,"Trimmed arg {0} for log {1}",w,d.a(l.tag)));k=k?new b(k.name,k.stack,k.message,
k.file,k.line,k.column):null;l=new f(l.message,l.category,l.level,l.timestamp-this.KVc,l.Hyd,l.tag,l.tvi,l.Kg,k);k=l.Qah();0<this.VZb&&k+this.mjb>this.VZb&&(w=this.count,this.reset(),c.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",w));Array.add(this.zWb,l);this.mjb+=k}}CQb(l,k,w){let n=l;l&&l.length>this.IXa&&(n=l.substr(0,this.IXa-13)+"... [trimmed]",c.ULS.sendTraceTag(3465240,100,50,"Trimmed {0} for log {1}",k,d.a(w)));return n}get Zri(){return this.mjb>
this.ADg}serialize(){return c.ULS.Ec(new e(this.KVc,this.zWb,this.A9,this.OCa,1))}get aXd(){return this.NUc}get jyd(){return this.IXa}}h.JGi=31;Object(r.a)(h,"LogCache",null,[110,111])},1480:function(r,B,a){a.r(B);r=a(638);B=a(0);var c=a(15),b=a(88),e=a(82);class f{constructor(){$addHandler(document,"securitypolicyviolation",Object(b.a)(this,this.AKf,"onSecurityPolicyViolationEventHandler"))}AKf(va){va=va.rawEvent;let Ba=va.blockedURI;Ba=e.a.Mda(Ba);const Ea={};Ea.effectiveDirective=va.effectiveDirective;
Ea.violatedDirective=va.violatedDirective;Ea.originalPolicy=va.originalPolicy;Ea.blockedURI=Ba;Ea.disposition=va.disposition;c.ULS.sendTraceTag(588084128,306,15,"{0}",Ea)}dispose(){$removeHandler(document,"securitypolicyviolation",Object(b.a)(this,this.AKf,"onSecurityPolicyViolationEventHandler"))}}Object(B.a)(f,"ContentSecurityPolicyListener",null,[3]);var d=a(257);class h{constructor(){this.$a=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.$a.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const va=
this.$a.og("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");va&&va.dispose()}Kh(va){this.$a=va;this.$a.register(f,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").tc().Bc(()=>new f)}static main(){d.a.instance.si(new h)}}Object(B.a)(h,"ContentSecurityPolicyPackage",null,[4,5]);var l=a(40);class k{constructor(){this.File=this.Message=null;this.Column=this.Line=0;this.ClientAppVersion=this.Stack=null;this.AppMode=this.AppType=0;this.DeobfuscateWithSourceMaps=!1;this.DataPlumber=
this.SessionStartInfoJson=null;this.IsShuttingDown=!1;this.ErrorName=this.Flight=null}cSd(){return l.c(this)}}Object(B.a)(k,"DiagnosticsRequest",null,[]);var w=a(4),n=a(484),x=a(466),m=a(31);class u{constructor(va,Ba,Ea,pa,$a){this.vGa=va;this.BDa=Ba;this.n1=Ea;this.yIc=pa;this.fCg=$a}J5f(va,Ba){try{this.khh().send(this.LQh(va,Ba))}catch(Ea){c.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",Ea.toString())}}khh(){const va=new XMLHttpRequest;va.open("POST",this.vGa,!0);va.setRequestHeader("Content-Type",
"text/json; charset=utf-8");w.AFrameworkApplication.userSessionId&&va.setRequestHeader(x.a.$Fc,m.a.Pka(w.AFrameworkApplication.userSessionId));this.BDa&&va.setRequestHeader(x.a.kza,this.BDa);if(w.AFrameworkApplication.Hd){const Ba=w.AFrameworkApplication.Hd.YO;Ba&&va.setRequestHeader(x.a.EGc,Ba)}return va}LQh(va,Ba){if(!va)return null;Ba=Ba?"<stack>"+Ba+"</stack>":"";const Ea=new k;Ea.Message=va.message;Ea.File=va.source;Ea.Line=va.line;Ea.Column=va.column;Ea.Stack=Ba;Ea.ClientAppVersion=this.BDa;
Ea.AppType=this.n1;Ea.AppMode=this.yIc;Ea.DeobfuscateWithSourceMaps=this.fCg;w.AFrameworkApplication.fa.qa("JavaScriptCrashJsonTagEnabled")&&(Ea.SessionStartInfoJson=w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson||"",w.AFrameworkApplication.gf&&(Ea.DataPlumber=l.c(w.AFrameworkApplication.gf)),Ea.IsShuttingDown=w.AFrameworkApplication.ug,Ea.Flight=w.AFrameworkApplication.eF,Ea.ErrorName=n.a.P3e(va));return Ea.cSd()}}Object(B.a)(u,"JavascriptErrorReporter",null,[805]);class t{build(va,
Ba,Ea,pa,$a){return new u(va,Ba,Ea,pa,$a)}}Object(B.a)(t,"JavascriptErrorReporterFactory",null,[786]);class y{Kh(va){va.register(t,"Common.App.Diagnostics.JavascriptErrorReporterFactory").as("Common.IJavascriptErrorReporterFactory").tc().Bc(()=>new t)}get name(){return"Common.App.Diagnostics"}init(){}dispose(){}static main(){d.a.instance.si(new y)}}Object(B.a)(y,"DiagnosticsPackage",null,[4,5]);var v=a(52),A=a(105),z=a(228),C=a(38),H=a(167),I=a(424),S=a(39),P=a(60),D=a(42),G=a(1257);class E{constructor(va=
null,Ba=null,Ea=null,pa=null,$a=null,cb=null,ib=null,ta=null){this.jyd=3072;this.aXd=65536;this.Xng=6E4;this.qhg=2E3;this.eNe=1E4;this.Jxe=5E3;this.Gxe=!1;this.pRb=0;null!=va&&(this.jyd=va);null!=Ba&&(this.aXd=Ba);null!=Ea&&(this.Xng=Ea);null!=pa&&(this.qhg=pa);null!=$a&&(this.eNe=$a);null!=cb&&(this.Jxe=cb);null!=ib&&(this.Gxe=ib);null!=ta&&0<ta&&(this.pRb=ta)}}Object(B.a)(E,"UlsUploadConfiguration",null,[]);var O=a(388);class N{constructor(va,Ba,Ea=null){this.JUb=0;this.BLc=!1;this.iGb=0;this.vjb=
null;this.cob=0;this.Jg=null;this.TTd=this._disposing=!1;this.ZB=this.HVc=this.iTb=this.eUb=0;this.xyc=!1;this.QVa=0;Ea||(Ea=new E);this.lUc=va;this.f8=Ba;this.f8.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&c.ULS.disable();this.eJg=Ea.Xng;this.yIg=Ea.qhg;this.Hyg=Ea.eNe;this.fJg=Ea.Jxe;this.nwg=Ea.Gxe;this.rra=new G.LogCache(Ea.aXd,Ea.jyd,va);this.rra.pRb=Ea.pRb;this.mPd();this.Q0f();this.R0f()}Q0f(){this.vjb=[];this.BLc=!1}kV(va){1<this.Ugb?256>this.vjb.length?
Array.add(this.vjb,va):this.BLc=!0:(this.rra.DMg(va),this.gHi(va)&&!this.qOe()?(this.O_e("LogIndicatesError in HandleTrace"),c.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",O.a(va.tag))):this.rra.Zri&&(this.Awb(!1,!0),c.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))}gHi(va){return!!va&&(1===va.Hyd||10===va.level)}qOe(){return!1}dispose(){this._disposing||(this._disposing=!0,this.FMh(),c.ULS.WTd(null),window.clearTimeout(this.QVa),
window.clearTimeout(this.eUb),window.clearTimeout(this.iTb),this.iTb=this.eUb=this.QVa=0)}FMh(){this.mode=2;this.qbf();this.xyc=!1;this.JRe();this.O_e("FlushForAppClose")}oRb(va,Ba){va.OCa=this.iGb;return this.Yng(va.serialize(),Ba)?(this.iGb++,!0):!1}Yng(va,Ba){Ba=this.nwg||!Ba;this.Jg&&Ba||(this.Jg=new XMLHttpRequest);if(0===this.Jg.readyState||4===this.Jg.readyState)return this.Jg.open("POST",this.f8,Ba),this.Jg.setRequestHeader("Content-Type","application/json"),this.Jg.setRequestHeader(N.rSd,
this.lUc),Ba&&(this.Jg.timeout=this.fJg),this.Jg.send(va),!0;c.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{["UploadId"]:this.iGb,["XhrReadyState"]:this.Jg.readyState});return!1}u5i(){this.Jg&&this.Jg.abort()}Lzc(va,Ba,Ea){try{return window.setTimeout(()=>{c.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",Ba,Ea);va()},Ba)}catch(pa){c.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",
pa.toString());if(!this.TTd){this.TTd=!0;try{va()}finally{this.TTd=!1}}return 0}}R0f(){try{window.clearTimeout(this.eUb)}catch(va){c.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",va.toString())}this.eUb=this.Lzc(Object(b.a)(this,this.qbf,"handleDelayedLogs"),this.Hyg,"ResetDelayedLoggingTimer")}get Ugb(){return c.ULS.Ugb+this.cob}qbf(){const va=this.vjb.length;if(va){var Ba=this.vjb,Ea=this.BLc;this.Q0f();c.ULS.sendTraceTag(3731798,
100,50,"HandleDelayedLogs {0}",{["Count"]:va,["Limit"]:256,["ExceededLimit"]:Ea});this.cob++;for(Ea=0;Ea<va;Ea++)this.kV(Ba[Ea]);this.cob--}this.R0f()}mPd(){try{window.clearTimeout(this.iTb)}catch(va){c.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",va.toString())}this.iTb=this.Lzc(Object(b.a)(this,this.Awb,"flushImpl"),this.eJg,"ResetCadenceTimer")}get mode(){return this.ZB}set mode(va){const Ba=this.ZB;this.ZB=va;if(0===this.ZB&&0!==Ba)try{const Ea=
this.HVc;this.HVc=0;window.clearTimeout(Ea)}catch(Ea){c.ULS.sendTraceTag(0,100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",Ea.toString())}else 0!==this.ZB&&0===Ba&&(this.HVc=this.Lzc(Object(b.a)(this,this.JRe,"endThrottling"),this.yIg,"ThrottlingMode Setter"))}JRe(){this.mode=0;this.xyc&&(this.xyc=!1,this.Awb())}oOb(va){return 2===this.mode||1===this.mode&&!va}O_e(va){c.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",va);this.Awb(!0)}ywb(){this.M_e(0)}M_e(va){this.QVa||
(this.QVa=this.Lzc(Object(b.a)(this,this.Awb,"flushImpl"),va,"FlushAsynchronous"))}Awb(va,Ba){this.cob++;try{window.clearTimeout(this.QVa)}catch(pa){c.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",pa.toString())}this.QVa=0;if(this.rra.count)if(!Ba&&this.oOb(va))c.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",va?"sync":"async"),this.xyc=!0;else{this.mode=va?2:1;this.mPd();c.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",
va?"sync":"async",this.rra.count);try{var Ea=this.oRb(this.rra,va)}catch(pa){this.u5i(),Ea=!1}Ea?(this.rra.reset(),this.JUb=0):(this.JUb++,this.JUb<N.Cxf?this.M_e(N.bxc):(this.rra.reset(),this.iGb++,this.JUb=0))}else this.mPd();this.cob--}kzb(){}spb(){}}N.Cxf=3;N.bxc=15E3;N.rSd="X-UserSessionId";Object(B.a)(N,"UploadingUlsHost",null,[27,3]);class J{constructor(va,Ba,Ea,pa){this.OCa=va;this.f0c=Ba;this.sessionId=Ea;this.version=pa}}Object(B.a)(J,"UploadState",null,[]);var W=a(86),ea=a(537);class R extends Sys.EventArgs{constructor(va){super();
this.Kg=va}}Object(B.a)(R,"UlsLoggingEventArgs",Sys.EventArgs,[]);var Y=a(187);class U extends N{constructor(va,Ba,Ea,pa,$a,cb=null){super(w.AFrameworkApplication.userSessionId,U.oPh(U.RTh(va,pa),Ba,Ea,cb),new E(void 0,w.AFrameworkApplication.iai(),pa.Ad("BulsUploadFrequencyInMs",6E4),void 0,void 0,void 0,void 0,w.AFrameworkApplication.u3b));this.N9d=!1;this.qTc=this.Qnb=this.TSb=this.FG=null;this.rh=Ea;this.dqa=pa;(this.Lnb=this.dqa.Wa("RemoteUlsETag"))&&U.iSf(this.dqa.Wa("RemoteUlsSuppressions"));
$a&&(this.TSb=$a,this.TSb.TYc(Object(b.a)(this,this.WKf,"onSettingsRefreshed")))}get events(){return this.FG||(this.FG=new Sys.EventHandlerList)}spb(va){this.events.addHandler(U.rkg,va)}get cbb(){return null}get VGd(){return null}get y0c(){return this.dqa.qa("BUlsExceptionLoggingIsEnabled")}dispose(){this.N9d||(this.N9d=!0,super.dispose(),this.TSb&&this.TSb.qZf(Object(b.a)(this,this.WKf,"onSettingsRefreshed")))}WKf(va,Ba){Ba.D8a(U.sZd)&&(this.Qnb=this.l$e())}nUh(){return Error().stack}l$e(){let va=
null;if(this.dqa.Jp(U.sZd)){va=new Y.a;const Ba=this.dqa.ww(U.sZd);for(let Ea=0;Ea<Ba.length;Ea++)va.ia(Ba[Ea],!0)}return va}kV(va){this.Qnb||(this.Qnb=this.l$e());if(this.Qnb&&this.Qnb.kb(va.tag))try{!va.Hcd&&this.y0c?va.Hcd=new ea.a(Error()):va.message+=". JsCallStack: "+this.nUh()}catch(Ea){va.message+=" [Failed to add callstack for this tag. BUlsExceptionLoggingIsEnabled="+this.y0c+" ("+Ea.message+")]"}super.kV(va);const Ba=this.events.getHandler(U.rkg);va=new R(va);Ba&&Ba(null,va)}oRb(va,Ba){if(this.rh){if(!this.BMj)return!1;
const Ea=va.serialize();if(0<w.AFrameworkApplication.u3b&&Ea.length>w.AFrameworkApplication.u3b)return!1;va.OCa=this.iGb++;if(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.BULSUseFetchRequestCommonIsEnabled",!1))this.qYc(this.f8,Ea,3,1,va.OCa,this.cbb,this.VGd),this.vag()&&window.console&&window.console.log&&window.console.log("Send shuttingDown buls from common");else{if(this.vag())return this.Cyc(this.f8,Ea),!0;this.Lre(this.f8,Ea,Ba&&!this.cbb?0:3,1,Ba&&w.AFrameworkApplication.ug,
va.OCa,this.cbb,this.VGd)}return!0}return super.oRb(va,Ba)}Krc(va){try{if(va&&va.data&&va.data.responseHeaders&&U.Kzb in va.data.responseHeaders){var Ba=va.data.responseHeaders[U.Kzb];Ba!==this.Lnb&&(this.Lnb=Ba,U.iSf(va.data.responseHeaders[U.jnd]))}}catch(Ea){c.ULS.sendTraceTag(593847297,100,50,"Failed to process tag suppressions. [Message: {0}] [Stack: {1}]",Ea.message,Ea.stack)}}oqc(va){const Ba=va.data;if(!Ba)c.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",
va);else if(13===Ba.status)c.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),this.Yng(Ba.request.get_body(),!1);else if(!Ba.responseHeaders)c.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}, HttpStatusCode = {3}",Ba.id,Ba.HRa,Ba.me,Ba.httpStatus);else if(!(U.Boi in Ba.responseHeaders||(va=Ba.httpStatus,400<=va&&499>=va))){var Ea=Ba.state;Ea.f0c>=N.Cxf||(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.BULSUseFetchRequestCommonIsEnabled",
!1)?window.setTimeout(()=>{this.qYc(Ba.request.get_url(),Ba.request.get_body(),3,Ea.f0c+1,Ea.OCa,Ea.sessionId,Ea.version)},N.bxc):window.setTimeout(()=>{this.Lre(Ba.request.get_url(),Ba.request.get_body(),3,Ea.f0c+1,!1,Ea.OCa,Ea.sessionId,Ea.version)},N.bxc))}}Lre(va,Ba,Ea,pa,$a,cb,ib,ta){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.BULSUseFetchRequestCommonIsEnabled",!1)?this.qYc(va,Ba,Ea,pa,cb,ib,ta):this.rh.Mm(va,2,Ba,this.SJe(),!1,Ea,Object(b.a)(this,this.Krc,
"onSuccessfulUpload"),Object(b.a)(this,this.oqc,"onFailedUpload"),new J(cb,pa,ib,ta),null,$a,this.dqa.Ad("BulsClientRequestManagerQueueTimeInMS",3E4),void 0,"19",ib,void 0,ta,[U.Kzb,U.jnd])}qYc(va,Ba,Ea,pa,$a,cb,ib){this.rh.cMg(va,Ba,this.SJe(),Ea,Object(b.a)(this,this.Krc,"onSuccessfulUpload"),Object(b.a)(this,this.oqc,"onFailedUpload"),new J($a,pa,cb,ib),this.dqa.Ad("BulsClientRequestManagerQueueTimeInMS",3E4),cb,ib,[U.Kzb,U.jnd])}SJe(){let va=null;this.Lnb&&(va={},va[U.Kzb]=this.Lnb);if(this.y0c){const Ba=
w.AFrameworkApplication.sa;let Ea=null;Ba&&(Ea=Ba.Qa);Ea&&(va||(va={}),va[U.fgi]=Ea.Nca,va[U.ggi]=Ea.ri,va[U.lgi]=w.AFrameworkApplication.kri?"1":"0")}return va}Cyc(va,Ba){this.rh.Cyc(va,Ba)}vag(){return w.AFrameworkApplication.ug||w.AFrameworkApplication.$kc}get Uuj(){this.qTc||(this.qTc=this.dqa.Ad("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6E4));return this.qTc}get BMj(){const va=this.rh.e8a;return va&&(new Date).getTime()-this.rh.MCi.getTime()>=this.Uuj?!0:!va}static RTh(va,Ba){Ba=Ba.Wa("BulsEndpointUrl");
return U.Kmf(Ba)?Ba:va}static Kmf(va){return!(void 0===va||null===va)&&""!==va}static oPh(va,Ba,Ea,pa){va=U.sLg(va,Ba);va=U.zOg(va,Ea);va=U.RMg(va,pa);return va=U.wOg(va)}static sLg(va,Ba){return Ba?e.a.fl(va,"build",w.AFrameworkApplication.buildVersion):va}static zOg(va,Ba){if(!Ba)return va;Ba=Ba.YO;return Ba?va=e.a.fl(va,x.a.FGc,Ba):va}static RMg(va,Ba){return U.Kmf(Ba)?e.a.fl(va,"officeserverversion",Ba):va}static wOg(va){return w.AFrameworkApplication.userSessionId&&""!==w.AFrameworkApplication.userSessionId?
e.a.fl(va,w.AFrameworkApplication.$Ua,w.AFrameworkApplication.userSessionId):va}static iSf(va){c.ULS.$4b();if(va){va=va.split(",");for(const Ba of va)va=parseInt(Ba),!isNaN(va)&&isFinite(va)&&c.ULS.y0b(va)}}}U.Kzb="X-bULS-SuppressionETag";U.jnd="X-bULS-SuppressedTags";U.fgi="X-bULS-OfficeAppMode";U.ggi="X-bULS-OfficeAppType";U.lgi="X-bULS-UseSourceMaps";U.rkg="CommonUlsTraceEventKey";U.sZd="TagCallStackInclusionList";U.Boi="X-InvalidUlsJson";Object(B.a)(U,"CommonUlsHost",N,[]);var da=a(101);class T extends U{constructor(va,
Ba){super(va,!1,w.AFrameworkApplication.Hd,W.a.instance.og("Common.IRefreshableAppSettings")||w.AFrameworkApplication.fa,W.a.instance.og("Common.IRefreshableAppSettings"),Ba);this.P1j="usu";this.M1j="ufu";this.mb=null;this.Ra=new da.a}get $(){this.mb||(this.mb=0<P.a.getRegisteredEwaInstances().length?P.a.cs(document.body):null);return this.mb}kV(va){1===va.Hyd&&(va.message="Assert: "+va.message);super.kV(va)}qOe(){return!0}oRb(va,Ba){if(w.AFrameworkApplication.ug&&w.AFrameworkApplication.wdb)return!1;
let Ea=null;this.$&&(Ea=this.$.Mb.Kc("UserAction","CommonUlsHostOverrides:UploadLogs"));Ba=!w.AFrameworkApplication.wdb&&Ba;va=super.oRb(va,Ba);Ea&&Ea.stop();return va}Krc(va){super.Krc(va);this.Ra.raiseEvent(this.P1j,va)}oqc(va){super.oqc(va);this.Ra.raiseEvent(this.M1j,va)}}Object(B.a)(T,"CommonUlsHostOverrides",U,[782,27,3]);class ka{yfh(va,Ba){return new T(va,Ba)}}Object(B.a)(ka,"CommonHostFactory",null,[804]);var L=a(1),fa=a(61);class wa extends S.a{constructor(va){super();this.C5b=va;Sys.Application.registerDisposableObject(this)}spb(va){this.C5b.spb(va)}kV(va){this.C5b.kV(va)}kzb(va){this.C5b.kzb(va)}ywb(){this.C5b.ywb()}static la(va,
Ba=null){const Ea=new H.a;Object(I.a)(wa,w.AFrameworkApplication.lCa)||(Ba=Ba||new ka,D.a.Ili(()=>{var pa;if(w.AFrameworkApplication.browserUlsIsEnabled){var $a=va+"/RemoteUls.ashx";wa.$&&($a=wa.GNg($a));const cb=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7636252_BUlsOfficeServerVersion")?this.p9e():null;$a=Ba.yfh($a,cb);L.EwaSettings.isChangeGateEnabled("OfficeVSO:7636258_DisposeCommonUlsHostInExcel")&&(null===(pa=w.AFrameworkApplication.lCa)||void 0===pa?void 0:pa.dispose());w.AFrameworkApplication.lCa=
$a;c.ULS.QSa(50);c.ULS.WTd($a);Ea.setResult(new wa($a))}else c.ULS.disable()},!w.AFrameworkApplication.pKj()));return Ea.task}static GNg(va){const Ba=this.p9e();return e.a.fl(va,"officeserverversion",Ba)}static p9e(){return wa.$?fa.d(wa.$)?wa.$.workbookContext.BuildVersion:wa.$.ya.BuildVersion:null}static get $(){wa.mb||(wa.mb=0<P.a.getRegisteredEwaInstances().length?P.a.cs(document.body):null);return wa.mb}}wa.mb=null;Object(B.a)(wa,"EwaUlsHost",S.a,[782,27,3]);class oa extends z.a{constructor(va){super();
this.boa=va;this.Gb()}create(){C.TaskExtensions.za(wa.la(this.boa),va=>{va=va.result;A.a.Tl.Ha(135,va);this.qb(va)},this.ka)}}Object(B.a)(oa,"EwaUlsHostFactory",z.a,[]);var xa=a(159),bb=a(36);class Za{constructor(va){this.Oge=null;this.sBi=va}get sCd(){return this.Oge||(this.Oge={})}edj(va,Ba,Ea){!va&&Ba.source&&(va=bb.a.hq(this.sCd,Ba.source)+1,this.sCd[Ba.source]=va,va-1&va||c.ULS.sendTraceTag(537155536,0,15,`${va} errors seen for location=${Ba.source}`));Ba.source&&1!==bb.a.hq(this.sCd,Ba.source,
1)||(c.ULS.sendTraceTag(537155535,0,50,"JavaSctipCrashProcessor.ProcessJavascriptError: Sending request to log JavaScript crash in the server"),this.sBi.J5f(Ba,Ea))}}Object(B.a)(Za,"JavaScriptCrashProcessor",null,[505]);var La=a(75);Type.registerNamespace("_Ewa");Object(r.a)();Type.registerNamespace("Common.App.ContentSecurityPolicy");h.main();Type.registerNamespace("Common.App.Diagnostics");y.main();Type.registerNamespace("DiagUse");A.a.Tl.Ha(43,new oa(v.a.current.SK.ServerUriBase));(()=>{try{xa.a.vaf().continueWith(va=>
{try{if(A.a.Tl.Ba(42))c.ULS.sendTraceTag(537155532,0,50,"JavaScriptCrashProcessorBootstrapper: already initialized");else{const Ba=va.result,Ea=W.a.instance.resolve("Common.IJavascriptErrorReporterFactory").build(v.a.current.SK.ServerUriBase+Ba.LayoutsRelativeUri+"/diagnostics.ashx",Ba.BuildVersion,1,0,!0);A.a.Tl.Ha(42,new Za(Ea));c.ULS.sendTraceTag(537155533,0,50,"JavaScriptCrashProcessorBootstrapper: initialized and ready to be used")}}catch(Ba){c.ULS.sendTraceTag(537155531,0,15,`JavaScriptCrashProcessorBootstrapper: An exception occured while initializing JavascriptErrorProcessor, Message: ${Ba.message}, Callstack: ${Ba.stack}`)}},
3,null,La.a.current)}catch(va){c.ULS.sendTraceTag(537155530,0,15,`JavaScriptCrashProcessorBootstrapper: an exception occured, Message: ${va.message}, Callstack: ${va.stack}`)}})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tmcore.js.map/f7e7974e663dd361b2270a943e303667/EwaDSEsNext.tmcore.js.map