'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1165:function(r,B,a){a.d(B,"a",function(){return b});var c=a(517);const b=()=>{c.a.ni(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1487:function(r,B,a){a.r(B);var c=a(9);r=a(0);var b=a(714),e=a(15),f=a(845),d=a(8),h=a(73),l=a(196),k=a(380),w=a(35),n=a(58);class x{constructor(fa){this.$=fa}Mc(){return!1}executeCommand(fa,wa,oa){let xa=!1;fa=wa.command;const bb=w.a(this.$);11!==wa.Ve&&7!==wa.Ve&&6!==wa.Ve&&2!==wa.Ve&&14!==wa.Ve&&15!==wa.Ve&&16!==wa.Ve&&e.ULS.sendTraceTag(537149787,0,15,`ZoomCommandHandler.ExecuteCommand - unsupported zoom origin ${wa.Ve}`);const Za=6===wa.Ve;switch(wa.command){case -1365094462:case -1441674458:bb.fHc(Math.floor(10*
bb.zoom)/10+.1,Za);xa=!0;break;case 1056010365:case 1664364901:bb.fHc(Math.ceil(10*bb.zoom)/10-.1,Za);xa=!0;break;case 346087880:bb.fHc(d.a.E_,Za);xa=!0;break;case -1918142559:case 1517993347:h.a.Pc in oa?(oa=parseFloat(oa[h.a.Pc]),oa!==bb.zoom&&bb.eHc(oa,1517993347===wa.command),xa=!0):e.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:wa=parseFloat(oa[f.a.Value]);isNaN(wa)||bb.eHc(wa/100,!0);xa=!0;break;case 1409187195:bb.zoomFitToScreen();
xa=!0;break;case -1836771825:bb.zoomFitToScreenUndo(),xa=!0}return xa?n.Task.Ta(!0):l.a(fa)}Ac(fa,wa){switch(wa.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return w.a(this.$).DS();case -1365094462:case 1056010365:case -2096586688:return k.a(this.$);default:return!1}}Rc(){return!1}}Object(r.a)(x,"ZoomCommandHandler",null,[222]);class m extends b.a{constructor(fa){super(fa)}ld(){this.fd([new x(this.$)])}static la(fa){b.a.Rd(370,
new m(fa))}}Object(r.a)(m,"ZoomCommandHandlerFactory",b.a,[]);B=a(228);var u=a(91),t=a(27),y=a(86),v=a(550),A=a(51),z=a(5),C=a(171),H=a(71),I=a(301),S=a(132),P=a(44),D=a(33),G=a(12),E=a(11),O=a(109),N=a(21),J=a(317),W=a(133);class ea{constructor(fa){this.S6a=this.ohc=0;this.s4b=null;this.Okf=!1;this.$=fa;this.Okf=fa.zlc}Oti(){return N.h(this.$).eb?(e.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.pb.Gw?(e.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}sXi(fa){this.s4b=new Sys.UI.Point(Math.round(fa.Bva.center.x),Math.round(fa.Bva.center.y));this.ohc=w.a(this.$).zoom;this.S6a=fa.Bva.scale;let wa={["InitialZoom"]:this.ohc,["Location"]:"canvas",["InputMethod"]:fa.wb};W.b(this.$).qd(S.a.W9i,wa);e.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.s4b.x},${this.s4b.y}), initial zoom ${this.ohc}, initial scale ${this.S6a}`);
this.f$a(fa,"onGestureStart");return!0}rXi(fa){if(!this.S6a)return e.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.f$a(fa,"OnGestureEvent"),!0;if(!isFinite(this.S6a))return e.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.S6a}`),this.f$a(fa,"OnGestureEvent"),!0;const wa=fa.Bva.scale/this.S6a*this.ohc;w.a(this.$).Xqg(wa,this.s4b);e.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${wa}. Current scale ${fa.Bva.scale}`);this.f$a(fa,"OnGestureEvent");return!0}qXi(fa){w.a(this.$).Yqg();e.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.f$a(fa,"OnGestureEnd")}pXi(fa){e.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.f$a(fa,"OnGestureCancel")}f$a(fa,wa){var oa,xa,bb;this.Okf&&(e.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${wa},        eventArgs non-null: ${isNullOrUndefined(fa)}, gestureData non-null: ${isNullOrUndefined(null===
fa||void 0===fa?void 0:fa.Bva)},        srcEvent non-null: ${isNullOrUndefined(null===(oa=null===fa||void 0===fa?void 0:fa.Bva)||void 0===oa?void 0:oa.srcEvent)}`),null===(bb=null===(xa=null===fa||void 0===fa?void 0:fa.Bva)||void 0===xa?void 0:xa.srcEvent)||void 0===bb?void 0:bb.preventDefault())}}Object(r.a)(ea,"PinchToZoomAdapter",null,[470]);var R=a(39);class Y extends R.a{constructor(){super()}Ite(fa){this.addHandler("ZCIEK",fa)}KZf(fa){this.removeHandler("ZCIEK",fa)}oZc(fa){this.addHandler("ZCUIK",
fa)}dOd(fa){this.removeHandler("ZCUIK",fa)}ygj(){this.raiseEvent("ZCIEK")}xgj(){this.raiseEvent("ZCUIK")}zgj(){this.raiseEvent("ZCEK")}}Object(r.a)(Y,"ZoomEventManager",R.a,[467]);var U=a(22),da=a(89);class T extends R.a{constructor(fa){super();this.statusBarManager=null;this.L0e=!1;this.$=fa;this.$.da.hb(29,wa=>{this.statusBarManager=wa;wa.rJ(this)})}vq(fa){this.addHandler("Zoom",fa)}Wq(fa){this.removeHandler("Zoom",fa)}Az(){this.yn("QueryZoomStatus")&&this.raiseEvent("Zoom")}$r(fa,wa){return"QueryZoomStatus"!==
fa?!1:this.Odi(wa)}yn(){return w.a(this.$).DS()}dispose(){this.statusBarManager&&(this.statusBarManager.SF(this),this.statusBarManager=null);this.$=null;super.dispose()}maf(fa){fa=this.aai(fa);if(!fa)return null;fa=fa.getElementsByClassName("cui-ctl-mediumlabel");return 1!==fa.length?(e.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):fa[0]}Odi(fa){if(!this.$)return!1;const wa=w.a(this.$).iSb;let oa=!1;if(D.a.xn())U.a.equals(appChrome.selectors.getControlLabel(da.a.zoomStatusBarMenuOpen),
wa,!1)||(oa=!0);else{const xa=this.maf("HandleQueryZoomStatusCommand");xa?U.a.equals(fa.LabelText.toString(),wa,!1)||(xa.innerText="",oa=!0):oa=!0}oa&&this.EEj(fa,wa);return!0}EEj(fa,wa){fa.LabelText=wa;D.a.xn()&&(fa.Visible=!0)}aai(fa){var wa=G.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!wa)return wa=(wa=this.$.ea.ic)?wa.inEmbedView:!1,t.a.lp||wa||e.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${fa}`),
null;this.L0e||(this.L0e=!0,e.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${fa}`));return wa}}Object(r.a)(T,"ZoomStatusBarManager",R.a,[3,368,213]);class ka extends v.a{constructor(fa){super(fa);this.zoomEventManager=this.iya=this.WDb=null;this.aEb=-1;this.Nkf=!1;this.Zc=()=>{this.aEb=-1};e.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Rhb=new T(fa);this.X9i()&&(e.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),
this.lXg());this.Olj()}dispose(){this.Rhb&&(u.a.Ja(this.Rhb),this.Rhb=null);this.zoomEventManager&&(this.$.da.vU(419),this.zoomEventManager=null);this.Nkf&&this.Kph();super.dispose()}DS(){return!0}Xqg(fa,wa){fa=this.CKa(fa);if(N.h(this.$).rtl){const oa=Math.round(G.DOMElementExtensions.getBounds(this.$.Bf).width*w.a(this.$).zoom);this.WDb=new Sys.UI.Point(oa-wa.x,wa.y)}else this.WDb=wa;this.MSa(fa,!1,"ZoomWithPinch")}dHc(){return!0}cHc(fa,wa){var oa=t.a.isMac?.07:.15;fa=this.zoom+(fa?oa:-oa);fa=this.CKa(fa);
N.h(this.$).rtl?(oa=Math.round(G.DOMElementExtensions.getBounds(this.$.Bf).width*w.a(this.$).zoom),this.iya=new Sys.UI.Point(oa-wa.x,wa.y)):this.iya=wa;wa=this.zoom;this.MSa(fa,!0,"ZoomWithMouse");wa={["InitialZoom"]:wa,["FinalZoom"]:fa,["Location"]:"canvas"};W.b(this.$).qd(S.a.hck,wa)}Yqg(){this.WDb=null}eHc(fa,wa){this.MSa(this.CKa(fa),!1,wa?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Zqg(fa){isNaN(fa)?e.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):
this.MSa(this.CKa(fa),!1,"ZoomToLevelInExcelLive")}fHc(fa,wa){this.MSa(this.CKa(fa),!0,wa?"ZoomWithShortcuts":"ZoomWithButtons")}$8e(fa,wa){const oa=N.h(this.$).rtl,[xa,bb]=this.zjd(oa),[Za,La]=this.old(fa,bb);return this.iya?(fa=this.ijd(this.iya,fa,wa,bb,xa,"ZoomWithMouse"),this.iya=null,fa):this.WDb?this.ijd(this.WDb,fa,wa,bb,xa,"ZoomWithPinch"):N.h(this.$).ha.Sa.Z4?this.gck(fa,wa,bb,xa,Za,La,N.h(this.$).rtl):this.ick(fa,wa,bb,xa,Za,La,N.h(this.$).rtl)}F4f(fa,wa,oa){if(fa){e.ULS.sendTraceTag(537149782,
0,50,`Zoom To: (${fa.x} ${fa.y}) (new top-left) from zoom:${wa} to zoom:${oa}`);fa=new A.a(fa.x,fa.y);oa=N.h(this.$).rtl;[,oa]=this.zjd(oa);const [xa,bb]=this.old(wa,oa);N.h(this.$).lue(fa,xa,bb,"ApplicationZoom")}else e.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${wa} to zoom:${oa}`)}zoomFitToScreen(){const fa=this.zoom;var wa=N.h(this.$).rtl;const [oa,xa]=this.zjd(wa),[bb,Za]=this.old(fa,xa);var La=N.h(this.$).ha.Sa.Z4;(wa=La?this.b5e(this.Sab,bb,Za,!1):this.i9e(this.Sab,xa,oa,
bb,Za,wa,!1))?(wa=Math.min(bb/(wa.width+100),Za/(wa.height+100)),wa=this.fMh(wa),this.MSa(wa,!0,"ZoomWithFitToScreen"),La?N.h(this.$).ha.Sa.xta(N.h(this.$).ha.Sa.jc,!1):(La=P.v(N.h(this.$).ha.ra.activeRange,this.$),N.h(this.$).sg(La,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.aEb=fa,this.Nkf||this.iXg()):e.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${La}`)}zoomFitToScreenUndo(){this.MSa(this.aEb,!1,"ZoomWithFitToScreen")}HVd(){return-1!==
this.aEb}iXg(){const fa=N.h(this.$);fa&&(fa.ha.jC(this.Zc),fa.uE(this.Zc))}Kph(){const fa=N.h(this.$);fa&&(fa.ha.xB(this.Zc),fa.VF(this.Zc))}fMh(fa){fa=Math.min(fa,d.a.mMi);fa=Math.max(fa,d.a.gNi);return Math.round(100*fa)/100}MSa(fa,wa,oa){if(this.aHc()){var xa=N.h(this.$).view.visibleArea.toString();fa=this.CKa(fa);var bb=H.d(this.$.ua.na);bb||(bb=v.a.Zzf);N.h(this.$).Dh.M0(5,J.a.$Gc,oa);N.h(this.$).Dh.kma(J.a.$Gc,this.$.ea.se);e.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${fa} to sheet ${bb} origin ${oa} prevZoom ${this.zoom}`);
this.yHj(bb,fa);this.zoomEventManager.zgj();this.v_j(oa);this.G_j(wa);this.aEb=-1;k.b(this.$,oa);fa=N.h(this.$).view.visibleArea.toString();e.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${xa}, NewGridVisibleArea: ${fa}, IsShyRibbonActive: ${this.$.f_}`)}}MVh(fa){return(fa=E.HelperMethods.XC(this.$.Bf,this.$.domElement,fa))?fa:new Sys.UI.Point(0,0)}zjd(fa){const wa=this.MVh(fa);fa=this.A_h(wa,fa);return[wa,fa]}old(fa,wa){const oa=G.DOMElementExtensions.getBounds(this.$.Bf);
return[Math.round((oa.width-wa.x)*fa),Math.round((oa.height-wa.y)*fa)]}A_h(fa,wa){wa=E.HelperMethods.XC(N.h(this.$).domElement,this.$.domElement,wa);return wa?(fa=new Sys.UI.Point(Math.round(wa.x-fa.x),Math.round(wa.y-fa.y)),fa):new Sys.UI.Point(0,0)}ick(fa,wa,oa,xa,bb,Za,La){return(La=this.i9e(fa,oa,xa,bb,Za,La))?this.W7e(La,fa,wa,oa,xa,bb,Za):null}i9e(fa,wa,oa,xa,bb,Za,La=!0){var va=P.G(N.h(this.$).ha.ra.selectedRanges);if(La&&(va=va.xe(P.G(N.h(this.$).Tec())),!va))return e.ULS.sendTraceTag(537149777,
0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const Ba=N.h(this.$).Jb(va.topLeft);va=N.h(this.$).Jb(va.bottomRight);if(!Ba||!va)return e.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;fa=Ba.cell.SQ===va.cell.SQ&&Ba.cell.RQ===va.cell.RQ?this.BUh(fa,va,wa,oa,xa,Za):this.N9h(fa,Ba,va,wa,oa,xa,Za);return fa?La?this.w_e(fa,xa,bb):fa:(e.ULS.sendTraceTag(537149775,
0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}w_e(fa,wa,oa){if(0>fa.x||fa.x>wa)fa.x=0;if(0>fa.y||fa.y>oa)fa.y=0;fa.x+fa.width>wa&&(fa.width=wa-fa.x);fa.y+fa.height>oa&&(fa.height=oa-fa.y);return fa}N9h(fa,wa,oa,xa,bb,Za,La){wa=N.h(this.$).getCellBounds(wa.cell);if(!wa)return null;const va=N.h(this.$).getCellBounds(oa.cell);if(!va)return null;let Ba=bb.x;La&&(Ba=0,wa.x=Math.round(Za/fa)-wa.x-Math.round(wa.width),va.x=Math.round(Za/fa)-va.x-Math.round(va.width));fa=new Sys.UI.Bounds(Math.round((wa.x-
xa.x)*fa)-Ba,Math.round((wa.y-xa.y)*fa-bb.y),Math.round((va.x+va.width-wa.x)*fa),Math.round((va.y+va.height-wa.y)*fa));oa=oa.cell.getRange();e.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${oa.top}, b:${oa.bottom}, r:${oa.right}, l:${oa.left}) in bounds (${fa.x}, ${fa.y}, ${fa.width}, ${fa.height})`);return fa}BUh(fa,wa,oa,xa,bb,Za){const La=N.h(this.$).getCellBounds(wa.cell);if(!La)return null;let va=xa.x;
Za&&(va=0,La.x=Math.round(bb/fa)-La.x-Math.round(La.width));fa=new Sys.UI.Bounds(Math.round((La.x-oa.x)*fa)-va,Math.round((La.y-oa.y)*fa-xa.y),Math.round(La.width*fa),Math.round(La.height*fa));wa=wa.cell.getRange();e.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${wa.top}, l:${wa.left}) in bounds (${fa.x}, ${fa.y}, ${fa.width}, ${fa.height})`);return fa}gck(fa,wa,oa,xa,bb,Za){const La=this.b5e(fa,bb,Za);return La?this.W7e(La,fa,
wa,oa,xa,bb,Za):null}W7e(fa,wa,oa,xa,bb,Za,La){fa=new Sys.UI.Point(this.z8e(Za,fa.x,fa.width),this.z8e(La,fa.y,fa.height));return this.ijd(fa,wa,oa,xa,bb)}z8e(fa,wa,oa){return fa===oa?(e.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),fa/2):fa*wa/(fa-oa)}b5e(fa,wa,oa,xa=!0){const bb=N.h(this.$).ha.Sa.jc.domElement;var Za=E.HelperMethods.XC(bb,N.h(this.$).domElement,N.h(this.$).rtl);if(!Za)return e.ULS.sendTraceTag(537149771,
0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const La=N.h(this.$).Tyb();Za=new Sys.UI.Point(Math.round((Za.x-La.topLeft.x)*fa),Math.round((Za.y-La.topLeft.y)*fa));fa=new Sys.UI.Bounds(Za.x,Za.y,Math.round(bb.offsetWidth*fa),Math.round(bb.offsetHeight*fa));return xa?this.w_e(fa,wa,oa):fa}uAf(){this.Rhb.Az()}KQi(fa){"ZoomToLevelInExcelLive"===fa?this.zoomEventManager.ygj():this.zoomEventManager.xgj()}Olj(){this.zoomEventManager=this.$.da.Ha(419,new Y)}ijd(fa,
wa,oa,xa,bb,Za=""){var La=N.h(this.$).rtl?0:bb.x;bb="ZoomWithPinch"===Za||"ZoomWithMouse"===Za?new Sys.UI.Point(fa.x-La-Math.round(xa.x*wa),fa.y-bb.y-Math.round(xa.y*wa)):fa;bb=new Sys.UI.Point(Math.round(bb.x/wa),Math.round(bb.y/wa));e.ULS.shipAssertTag(537149770,0,!!wa,"Original zoom level must be different than 0");La=oa/wa;bb=new Sys.UI.Point(Math.round(bb.x*(1-1/La)),Math.round(bb.y*(1-1/La)));"ZoomWithMouse"===Za||"ZoomWithPinch"===Za?(bb.x+=Math.round((xa.x-N.h(this.$).Fr)*(La-1)),bb.y+=Math.round((xa.y-
N.h(this.$).DJ)*(La-1))):(La=Math.round(xa.x*(oa-wa)),0<La&&bb.x>La&&(bb.x+=La),wa=Math.round(xa.y*(oa-wa)),0<wa&&bb.y>wa&&(bb.y+=wa));"ZoomWithMouse"===Za&&(fa.x||(bb.x=0),fa.y||(bb.y=0));fa=N.h(this.$).Tyb();return new Sys.UI.Point(bb.x+fa.topLeft.x,bb.y+fa.topLeft.y)}lXg(){const fa=[];y.a.instance.Tb("Common.IGestureInputManager").execute(wa=>{0===wa.XZh()&&wa.qkj(document.body,new ea(this.$),fa)})}X9i(){return this.aHc()&&(t.a.kp&&t.a.YMa(67)||this.$.zlc)}yHj(fa,wa){k.a(this.$)?this.setZoomLevel(fa,
wa,this.s4d,d.a.OQf):this.setZoomLevel(fa,wa,this.zoomPerSheetId,this.Sab)}setZoomLevel(fa,wa,oa,xa){oa.remove(fa);wa!==xa&&oa.add(fa,wa)}v_j(fa){this.P8f();this.$.qAa(I.a.CZ("TriggerImmediateZoomOperations"));this.R7j();this.KQi(fa)}R7j(){this.Oxi()?this.$.tf():this.Rhb.Az();const fa=this.Rhb.maf("UpdateZoomStatusBar");fa&&(fa.innerText=this.iSb)}Oxi(){const fa=C.a(this.$);return fa?fa.yp.Vz===(D.a.DNa(this.$)?z.a.wuc:this.$.Cb+z.a.e2f):!1}G_j(fa){N.h(this.$).fck(fa);this.kTg()}kTg(){const fa=O.a(this.$);
if(fa)for(const wa of N.h(this.$).Ca.iz()){if(!wa){e.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!wa.ek)continue;const oa=wa.Ki;if(oa)for(let xa=0;xa<oa.count;xa++)if(2===oa.$f(xa).type){const bb=fa.vr(oa.$f(xa).Mg());bb?(bb.Uea(!1),e.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):e.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else e.ULS.sendTraceTag(537149769,
0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(r.a)(ka,"ZoomManager",v.a,[]);class L extends B.a{constructor(fa){super();this.$=fa;this.Gb()}create(){const fa=new ka(this.$);this.T7j(fa);this.$.da.Ha(368,fa);this.qb(fa)}T7j(fa){const wa=w.a(this.$);if(wa){var oa=wa.tld("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");fa.aUd(oa);fa.Pxc(wa.HEc)}else e.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static la(fa){fa.da.Ha(369,
new L(fa))}}Object(r.a)(L,"ZoomManagerFactory",B.a,[]);a=a(1165);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(()=>{c.a.Fa(fa=>{L.la(fa);m.la(fa)})})();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.zoom.js.map/1aeedd72924f9b7cf16c5a0f4613cb82/EwaDSEsNext.zoom.js.map