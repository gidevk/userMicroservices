/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1222:function(r,B,a){r=a(0);var c=a(15),b=a(88),e;(function(P){P[P.generalException=0]="generalException";P[P.invalidArgument=1]="invalidArgument";P[P.notAllowed=2]="notAllowed";P[P.apiNotAvailable=3]="apiNotAvailable";P[P.unresolvedPendingRequest=4]="unresolvedPendingRequest";P[P.timeout=5]="timeout";P[P.adalTimeout=6]="adalTimeout";P[P.userNotSignedIn=7]="userNotSignedIn";P[P.userAborted=8]="userAborted";P[P.silentSignInFailed=
9]="silentSignInFailed";P[P.invalidResourceUrl=10]="invalidResourceUrl";P[P.invalidGrant=11]="invalidGrant";P[P.connectionLost=12]="connectionLost";P[P.clientError=13]="clientError";P[P.serverError=14]="serverError"})(e||(e={}));Object(r.b)("ErrorCodes",e);a(1335);class f{constructor(P,D){this.requestCallback=this.requestParameters=null;this.requestParameters=P;this.requestCallback=D}}Object(r.a)(f,"OutstandingRequest",null,[]);class d{}d.PPi="AADSTS50058";d.invalidResourceUrl="AADSTS50001";d.KPi=
"AADSTS65001";d.$Pi="AADSTS70011";d.userAborted="13002";d.Daj="Popup Window is null";d.Caj="Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.RYj="tokenRevoked";Object(r.a)(d,"WopiHostErrorType",null,[]);var h=a(4),l=a(563),k=a(578),w=a(40),n=a(1334);class x{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(r.a)(x,"WopiIdentityInfo",null,[197]);class m{constructor(P,D,G){this.expiration=this.authority=
this.accessToken=null;this.accessToken=P;this.authority=D;this.expiration=G}}Object(r.a)(m,"WopiIdentityToken",null,[196]);var u=a(27),t=a(158),y=a(381),v=a(172),A=a(72),z=a(351);class C{constructor(P){this._initialized=!1;this.Zab={};this.iCc={};this.wO=h.AFrameworkApplication.sa.SD;this.Znd=P}s3a(P){this._initialized||(P.lo(v.a.YPf),P.Il(v.a.YPf,Object(b.a)(this,this.S1i,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(P,D,G=null){this.HOa(P,D);return new Promise((E,O)=>{if(this.vqd(D))if(D in
this.Zab)O("unresolvedPendingRequest");else{var N=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,w.c({["error"]:"Request timeout.",["callerId"]:D}));O("timeout")},12E4);this.agd(P,D,G,(J,W)=>{window.clearTimeout(N);J?E(J):(c.ULS.sendTraceTag(37856033,369,15,w.c({["error"]:e[W]})),O(W))})}else c.ULS.sendTraceTag(37856034,344,10,w.c({["error"]:"Caller is not allowed."})),O("notAllowed")})}getPrimaryIdentityInfo(P){return new Promise((D,G)=>{this.vqd(P)?this.q4h((E,O)=>{E?D(E):(c.ULS.sendTraceTag(37856064,
369,10,w.c({["error"]:O.toString()})),G(O))}):(c.ULS.sendTraceTag(37856065,344,10,w.c({["error"]:"Caller is not allowed."})),G("notAllowed"))})}getAuthContext(P){return new Promise((D,G)=>{const E=this.getAuthContextSync(P);E?D(E):G("notAllowed")})}getAuthContextSync(P){if(this.vqd(P)){const D=new n.a;D.upn=h.AFrameworkApplication.fa.Wa("UserPrincipalName");D.userId=h.AFrameworkApplication.fa.Wa("LoggableUserId");D.authority=h.AFrameworkApplication.fa.Wa("HostAuthAuthority");D.tenantId=h.AFrameworkApplication.fa.Wa("TenantId");
D.isAnonymous=h.AFrameworkApplication.fa.qa("IsAnonymousUser");D.supportsAuthToken=this.Hhi(P);P=h.AFrameworkApplication.fa.Wa("HostAuthType");D.authorityType="aad"===P.toLowerCase()?2:"msa"===P.toLowerCase()?1:0;return D}c.ULS.sendTraceTag(40751647,344,10,w.c({["error"]:"Caller is not allowed."}));return null}Hhi(P){const D=l.OAuthManagerSettings.aAb;return u.a.Xxa?D&&l.OAuthManagerSettings.Hgg?Array.contains(l.OAuthManagerSettings.Hgg,P.toLowerCase()):!1:D}agd(P,D,G,E){var O=[];Array.add(O,Object.assign(new A.a,
{name:"CallerId",string:D}));Array.add(O,Object.assign(new A.a,{name:y.a.GXd,string:P.correlationId}));t.a.sendTelemetryEvent(Object.assign(new z.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:O}));O=k.a.create().toString();const N="getAccessToken_"+O,J=this.wO.Kc("ComponentAttach",N);this.iCc[N]=J;const W={};W[y.a.HXd]=O;W[y.a.eSj]=P.resource;W[y.a.fSj]=P.scope;W[y.a.Gdg]=h.AFrameworkApplication.fa.Wa("HostAuthType");W[y.a.iSj]=h.AFrameworkApplication.fa.Wa("UserPrincipalName");
W[y.a.gSj]=P.silentLogin;W[y.a.bSj]=P.options;W[y.a.GXd]=P.correlationId;W[y.a.cSj]=D;G&&(W[y.a.addinName]=G.AddinName,W[y.a.aSj]=G.AddinTrustId);this.Znd.execute(ea=>{this.s3a(ea);ea.uj(v.a.getAuthToken,W)});this.Zab[O]=new f(P,E)}q4h(P){const D=h.AFrameworkApplication.fa.Wa("UserName"),G=h.AFrameworkApplication.fa.Wa("UserPrincipalName"),E=h.AFrameworkApplication.fa.Wa("LoggableUserIdSpace"),O=new x;O.email=G;O.displayName=D;switch(E){case "OrgIdPuid":O.authority="AzureActiveDirectoryAccount";break;
case "MsaCid":case "MsaPuid":O.authority="MicrosoftAccount";break;default:O.authority=E}P(O,null)}S1i(P){let D=null;try{let E=P.Values[y.a.HXd];const O=P.Values[y.a.$Rj],N=P.Values[y.a.Gdg],J=P.Values[y.a.hSj];let W=null,ea=null;const R=this.Zab[E];if("undefined"!==typeof R&&R){var G=[];Array.add(G,Object.assign(new A.a,{name:y.a.GXd,string:R.requestParameters.correlationId}));t.a.sendTelemetryEvent(Object.assign(new z.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:G}));
D=R.requestCallback;delete this.Zab[E];"undefined"!==typeof O&&O&&O.length?ea=new m(O,N,J):W=e[this.TKi(P)];G="getAccessToken_"+E;G in this.iCc&&(this.iCc[G].stop(),delete this.iCc[G]);D(ea,W)}else c.ULS.sendTraceTag(37856066,344,10,w.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:E}))}catch(E){P=P.Values[y.a.HXd],P in this.Zab&&delete this.Zab[P],this.Ymc(),c.ULS.sendTraceTag(37856067,344,10,w.c({["error"]:E.message,["stack"]:E.stack})),D&&D(null,"generalException")}}vqd(P){var D=
h.AFrameworkApplication.Bai();P=P.toLowerCase();for(const G of D)if(P===G.toLowerCase())return!0;D=l.OAuthManagerSettings.b_c;for(let G in D)if(P===D[G].toLowerCase())return!0;return!1}TKi(P){P=P.Values[y.a.dSj];this.Ymc();c.ULS.sendTraceTag(39068821,344,15,w.c({["error"]:P}));return P?-1<P.indexOf(d.PPi)?9:-1<P.indexOf(d.Daj)||-1<P.indexOf(d.Caj)?12:-1<P.indexOf(d.invalidResourceUrl)?10:-1<P.indexOf(d.userAborted)?8:-1<P.indexOf(d.$Pi)||-1<P.indexOf(d.KPi)||P===d.RYj?11:-1<P.indexOf(d.adalTimeout)?
6:0:13}HOa(P,D){P=this.kjj(P.resource);c.ULS.sendTraceTag(39921882,344,50,w.c({["callerId"]:D,["resource"]:P}))}Ymc(){c.ULS.sendTraceTag(39068822,344,50,w.c({["userAgent"]:window.navigator.userAgent}))}kjj(P){return(P?P:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(r.a)(C,"WopiIdentityManager",null,[175]);var H=a(257);class I{constructor(){this.$a=null}get name(){return"Common.App.WopiIdentity"}Kh(P){this.$a=P;P.register(C,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").tc().Bc(()=>
new C(P.Tb("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.zu(Object(b.a)(this,this.mB,"onFullAppSettingsReady"))}mB(){try{this.$a.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(P){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+P)}}dispose(){}static main(){H.a.instance.si(new I)}}Object(r.a)(I,"WopiIdentityPackage",null,[4,5]);a.d(B,"a",function(){return S});const S=()=>{Type.registerNamespace("Common.App.WopiIdentity");
I.main()}},1227:function(r,B,a){a.r(B);r=a(0);var c=a(7),b=a(15),e=a(4),f=a(167),d=a(197),h=a(87),l=a(198),k=a(63),w=a(50),n=a(38),x=a(232),m=a(117),u=a(534);class t{constructor(Za){Za=Za.split("|");this.sx=Za[1];this.RUc=Za[2];this.vYd=Za[3]}get solutionId(){return this.sx}get solutionVersion(){return this.RUc}get needToRestoreManifest(){return this.vYd===OSF.StoreTypeEnum.Registry.toString()}}Object(r.a)(t,"AddinStoreInfo",null,[]);class y{}Object(r.a)(y,"CustomFunctionRegistrationInfos",null,[]);
var v=a(204),A=a(75);const z=(Za,La,va)=>C(Za,La,v.a.none,A.a.current,va),C=(Za,La,va,Ba,Ea)=>{va=Za.continueWith(()=>{La(Za)},3,va,Ba);va.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,Ea)},4);return va},H=(Za,La,va)=>I(Za,La,v.a.none,A.a.current,va),I=(Za,La,va,Ba,Ea)=>{va=Za.Yo(()=>La(Za),3,va,Ba);va.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,Ea)},4);return n.TaskExtensions.IEc(va)},S=(Za,La,va)=>P(Za,La,v.a.none,A.a.current,va),P=(Za,La,va,Ba,Ea)=>{va=Za.Yo(()=>La(Za),3,va,Ba);va.continueWith(()=>
{b.ULS.sendTraceTag(537163461,0,10,Ea)},4);return va},D=(Za,La,va)=>G(Za,La,v.a.none,A.a.current,va),G=(Za,La,va,Ba,Ea)=>{va=Za.Yo(()=>La(Za),3,va,Ba);va.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,Ea)},4);return n.TaskExtensions.IEc(va)},E=(Za,La,va)=>O(Za,La,v.a.none,A.a.current,va),O=(Za,La,va,Ba,Ea)=>{va=Za.continueWith(()=>{La(Za)},3,va,Ba);va.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,Ea)},4);return va},N=(Za,La)=>{S(a(1227).CustomFunctionsInstaller.v6e("CustomFunctionsRuntimeLogging"),
va=>{if(va.result&&window.console)switch(va=J(Za.severity)+" "+Za.message+La,Za.severity){case 2:window.console.log&&window.console.log(va);break;case 0:window.console.info&&window.console.info(va);break;case 1:window.console.error&&window.console.error(va)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},J=Za=>{switch(Za){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var W=a(989);class ea{}Object(r.a)(ea,
"InstallationInfo",null,[]);class R{}Object(r.a)(R,"UninstallationInfo",null,[]);var Y=a(28),U=a(96),da=a(36),T=a(29),ka=a(1),L=a(22),fa=a(290),wa=a(804),oa=a(58);class xa{constructor(Za,La){this.qUc=Za;this._message=La}get severity(){return this.qUc}get message(){return this._message}}Object(r.a)(xa,"CustomFunctionLog",null,[]);a.d(B,"CustomFunctionsInstaller",function(){return bb});class bb{constructor(Za,La,va){this.Dxa=!1;this.rF={};this.$=Za;this.wj=La;this.Qpd().Tna();this.indexedDB=va;this.indexedDB.Me()&&
(this.Dxa=!0,this.indexedDB.initialize(bb.zAb,bb.AAb))}get rV(){return this.wj.rV}zhf(Za,La,va,Ba){if(Ba.invariantNamespace)for(let Ea=0;Ea<Ba.invariantNamespace.length;++Ea){const pa=Ba.invariantNamespace.charAt(Ea);if("."!==pa&&"_"!==pa&&"a">pa&&"z"<pa&&"A">pa&&"Z"<pa&&"0">pa&&"9"<pa)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${pa}', Position=${Ea}.`),Error.create("InvariantNamespace validation failed");}return H(this.l3g(va,
Ba.manifest),()=>H(this.fLd(Za),Ea=>{let pa=Ea.result;return(null===pa||void 0===pa?0:pa.isDynamicMetadata)?this.gMd(Za,La,pa,!1,!1,!1):H(this.Gbk(Za,La,Ba),$a=>{let cb;pa=(cb=new ea,cb.addinId=va,cb.locale=Ba.locale,cb.addinInvariantNamespace=Ba.invariantNamespace,cb.addinNamespace=Ba.namespace,cb.addinTitle=Ba.title,cb.isXllCompatible=Ba.isXllCompatible,cb.metadataContent=JSON.stringify(JSON.parse($a.result)),cb);return this.gMd(Za,La,pa,!1,bb.MIh(Ba.osfControl.getStoreType()),W.a(this.$,Ba))},
"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}Bhf(Za,La,va,Ba){if(!bb.mvd(va))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return H(this.fLd(Za),Ea=>{Ea=Ea.result;if(!Ea&&(Ea=da.a.Ic(this.rV,
Za),!Ea))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Za,La,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");Ea.metadataContent=JSON.stringify(JSON.parse(va));Ea.isDynamicMetadata=!0;return this.gMd(Za,La,Ea,!0,!0,Ba)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Ekg(Za,
La){this.wj.$ia();const va=Object(c.a)(new R,{solutionId:Za}),Ba=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Za,La,null)}.`;return H(this.PMd(Za),()=>H(this.WMd(Za),()=>this.b1d(this.wj,Za,La,va),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),Ba)}Gbk(Za,La,va){const Ba=new f.a;OSF.OUtil.xhrGet(va.metadataUrl,Ea=>{Ea?Ba.setResult(Ea):Ba.setException(Error.create("Invalid manifest"))},
Ea=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Za,La,null)}. ErrorCode: ${Ea}.`);Ba.As()});return Ba.task}Qpd(){return H(this.yuc(),Za=>{const La=Za.result;if(!La.length)return oa.Task.Ta(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Za=new d.a;const va=[];for(let Ba=
0;Ba<La.length;Ba++){const Ea=Object(h.a)(String,La[Ba]);Za.add(S(this.fLd(Ea),pa=>{if(pa=pa.result){const $a=da.a.Ic(this.rF,pa.addinId);$a&&$a===pa.metadataContent||(this.rF[pa.addinId]=pa.metadataContent,this.rV[Ea]=pa,va.push(pa))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return D(oa.Task.WhenAllEnumerable(Za),()=>{if(va.length){let Ba;const Ea=(Ba=new y,Ba.registrationInfos=va,Ba);return this.N2b(this.wj,La,Ea)}b.ULS.sendTraceTag(537163546,
0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return oa.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}Chf(){var Za=new f.a;new d.a;const La=[],va=[];Object.keys(this.rV).forEach(Ba=>{Ba=Object(h.a)(String,Ba);const Ea=da.a.Ic(this.rV,Ba);La.push(Ea);va.push(Ba)});if(!va.length)return Za.setResult(!0),Za.task;Za=Object(c.a)(new y,
{registrationInfos:La});return this.N2b(this.wj,va,Za)}yuc(){return S(this.Yid(u.a.ZZa),Za=>{Za=Za.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Za||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Za||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Mqg(Za){return this.qTd(u.a.ZZa,Sys.Serialization.JavaScriptSerializer.serialize(Za))}fLd(Za){return H(this.Yid(u.a.r5a(Za)),La=>{La=La.result||
"";return 0<La.length?oa.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(La,!0)):oa.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}ybk(Za,La){return H(this.URe(Za),()=>H(this.qTd(u.a.r5a(Za),Sys.Serialization.JavaScriptSerializer.serialize(La)),()=>bb.rTd(u.a.Jmd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}PMd(Za){return H(this.yXf(Za),
()=>H(this.QXf(u.a.r5a(Za)),()=>H(this.yuc(),La=>La.result.length?oa.Task.Ta(!0):bb.rTd(u.a.Jmd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}KUf(Za){return this.Yid(u.a.q5a(Za))}Jqg(Za,La){return H(this.URe(Za),
()=>this.qTd(u.a.q5a(Za),La),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}WMd(Za){return H(this.yXf(Za),()=>this.QXf(u.a.q5a(Za)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}URe(Za){return H(this.yuc(),La=>{La=La.result;const va=Za.toLowerCase();if(La.includes(va))return oa.Task.Ta(!0);La.push(va);return this.Mqg(La)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}yXf(Za){return H(this.yuc(),
La=>{La=La.result;const va=Za.toLowerCase();return La.includes(va)?(La.splice(Array.indexOf(La,va),1),this.Mqg(La)):oa.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}l3g(Za,La){if(ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Za=new OSF.AddinIdInfo(Za),Za.needToRestoreManifest()?this.Jqg(Za.getSolutionId(),La):oa.Task.Ta(!0);Za=new t(Za);return Za.needToRestoreManifest?this.Jqg(Za.solutionId,
La):oa.Task.Ta(!0)}Duj(Za){if(ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const va=new OSF.AddinIdInfo(Za);return va.needToRestoreManifest()?S(this.KUf(va.getSolutionId()),Ba=>{(Ba=Ba.result)&&OSF.OsfManifestManager.cacheManifestFromXml(va.getSolutionId(),va.getSolutionVersion(),Ba,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):oa.Task.Ta(!0)}const La=new t(Za);return La.needToRestoreManifest?
S(this.KUf(La.solutionId),va=>{(va=va.result)&&OSF.OsfManifestManager.cacheManifestFromXml(La.solutionId,La.solutionVersion,va,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):oa.Task.Ta(!0)}QXf(Za){return this.Dxa?this.indexedDB.C9c(Za):bb.Xmj(Za)}qTd(Za,La){return this.Dxa?this.indexedDB.Wdb(new wa.a(Za,La)):bb.rTd(Za,La)}Yid(Za){return this.Dxa?this.indexedDB.oLa(Za):bb.v6e(Za)}gMd(Za,La,va,Ba,Ea,pa){const $a=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Za,
La,null)}.`;return n.TaskExtensions.IEc(S(this.hMd(this.wj,Za,La,va,!1,Ba,pa),()=>Ea?this.ybk(Za,va):oa.Task.Ta(!0),$a))}hMd(Za,La,va,Ba,Ea,pa,$a){if(!pa&&(pa=da.a.Ic(this.rF,Ba.addinId))&&pa===Ba.metadataContent)return oa.Task.Ta(!0);this.rF[Ba.addinId]=Ba.metadataContent;this.rV[La]=Ba;$a||Za.xKb(La);Za.$ia();return H(this.okj(La,va,Ba),()=>this.NJd(Ba.addinId,Ea),"Failed to register functions for customfunction addin")}okj(Za,La,va){const Ba=new f.a,Ea=this.MHa(va);return this.U3(pa=>{N(bb.eub,
Za);(pa=pa.Result)&&204===pa.ResponseStatusCode?Ba.setResult(!0):(delete this.rF[va.addinId],delete this.rV[Za],z(this.PMd(Za),()=>{z(this.WMd(Za),()=>{this.jbg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Za}. Received status code ${pa?pa.ResponseStatusCode.toString():"Unknown"}.`),Ba.setResult(!1))},pa=>{pa=m.a.Ue(pa.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Za,
La,null)}. Errors: ${T.a.qc(pa)}.`);N(bb.dub,Za);delete this.rF[va.addinId];delete this.rV[Za];Ba.setResult(!1)},Ea,Ba,!0)}N2b(Za,La,va){const Ba=new f.a,Ea=Y.a.Ya.ze.m;La.forEach($a=>{$a=Object(h.a)(String,$a);Za.yDe($a)});Za.$ia();const pa=this.s1c(va);return this.U3($a=>{N(bb.eub,Sys.Serialization.JavaScriptSerializer.serialize(La));$a=$a.Result;let cb=!0;var ib=Sys.Serialization.JavaScriptSerializer.deserialize($a.ResponseBody.toString());ib=Array.isArray(ib.value)?ib.value:null;const ta=new d.a;
for(let Ya=0;Ya<ib.length;Ya++)if(!ib[Ya]){cb=!1;const Da=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${$a.ResponseStatusCode}.`;ta.add(H(this.PMd(La[Ya]),()=>{delete this.rF[va.registrationInfos[Ya].addinId];delete this.rV[La[Ya]];return this.WMd(La[Ya])},Da))}E(oa.Task.WhenAllEnumerable(ta),()=>{z(this.NJd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${Y.a.Ya.ze.m-
Ea} Millisecond.`);cb?Ba.setResult(cb):E(this.jbg(),()=>{Ba.setResult(cb)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},$a=>{$a=m.a.Ue($a.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${T.a.qc($a)}.`);
N(bb.dub,Sys.Serialization.JavaScriptSerializer.serialize(La));for($a=0;$a<va.registrationInfos.length;$a++)delete this.rF[va.registrationInfos[$a].addinId],delete this.rV[La[$a]];Ba.setResult(!1)},pa,Ba,!0)}b1d(Za,La,va,Ba){return H(this.H2j(Za,La,va,Ba),()=>this.NJd(Ba.solutionId,!1),"Failed to unregister functions for customfunction addin")}H2j(Za,La,va,Ba){const Ea=new f.a;Za.xKb(La);(Za=da.a.Ic(this.rV,La))&&delete this.rF[Za.addinId];delete this.rV[La];Ba=this.E1c(Ba);return this.U3(()=>{N(bb.D8c,
La);Ea.setResult(!0)},pa=>{pa=m.a.Ue(pa.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(La,va,null)}. Errors: ${T.a.qc(pa)}.`);N(bb.C8c,La);Ea.setResult(!1)},Ba,Ea,!1)}U3(Za,La,va,Ba,Ea){const pa=this.$.userOperationManager,$a=this.$.pa;let cb=null,ib=null,ta=null;const Ya=()=>{if(pa.GIa()||0<$a.va.V3||0<$a.Rk.V3)return!1;cb&&pa.ao(cb);ib&&$a.zs(ib);
ta&&$a.uy(ta);const Da=va.request;let ba=0;ka.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Da.RequestFlags&1&&256!==(Da.RequestFlags&256)||(ba=16):ba=Da.RequestFlags&1?0:16;pa.bF(new l.a(507,0,(ya,V,Z)=>{N(Ea?bb.B8c:bb.E8c,Da.RequestBody);return k.g($a.va,"ExecuteRichApiRequest",va,fa.b(ya,Za),fa.a(V,La),Z,null,0)},ba|64));return!0};Ya()||(cb=()=>{Ya()},ib=()=>{Ya()},ta=()=>{Ya()},pa.jr(cb),$a.kr(ib),$a.Ax(ta));return Ba.task}MHa(Za){const La={HttpMethod:"POST",
PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};La.RequestBody=JSON.stringify(Za);La.RequestFlags=1;ka.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(La.RequestFlags|=256);Za=this.$.pa.va.Oa(1);Za.request=La;return Za}s1c(Za){const La={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};La.RequestBody=JSON.stringify(Za);La.RequestFlags=1;ka.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(La.RequestFlags|=256);Za=this.$.pa.va.Oa(1);Za.request=La;return Za}E1c(Za){const La={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};La.RequestBody=JSON.stringify(Za);La.RequestFlags=1;ka.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(La.RequestFlags|=256);Za=this.$.pa.va.Oa(1);Za.request=La;return Za}NJd(Za,La){const va=w.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);return I(va,()=>{va.result.jPd();return Za&&La?
this.Duj(Za):oa.Task.Ta(!0)},this.$.ka,x.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}jbg(){const Za=new U.a(1949669462,0,this.$.xc,0,null);return this.$.Ia.Hb(Za)}static v6e(Za){try{return oa.Task.Ta(localStorage.getItem(Za))}catch(La){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${La.message||"Unknown"}`),oa.Task.Ta(null)}}static rTd(Za,
La){try{return localStorage.setItem(Za,La),oa.Task.Ta(!0)}catch(va){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${va.message||"Unknown"}`),oa.Task.Ta(!1)}}static Xmj(Za){try{return localStorage.removeItem(Za),oa.Task.Ta(!0)}catch(La){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${La.message||"Unknown"}`),
oa.Task.Ta(!1)}}static MIh(Za){return L.a.equals(Za,"registry",!0)||L.a.equals(Za,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static mvd(Za){if(!Za)return!1;try{JSON.parse(Za)}catch(La){return!1}return!0}}bb.zAb="CustomFunctionCache";bb.AAb="CustomFunction";bb.B8c=new xa(2,"CustomFunctions [Registration] [Begin] SolutionId=");bb.eub=new xa(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");bb.dub=new xa(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
bb.E8c=new xa(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");bb.D8c=new xa(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");bb.C8c=new xa(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(r.a)(bb,"CustomFunctionsInstaller",null,[868])},1231:function(r,B,a){a.r(B);r=a(0);var c=a(7),b=a(15),e=a(958),f=a(167),d=a(87),h=a(198),l=a(63),k=a(50),w=a(38),n=a(117),x=a(534),m=a(989);class u{constructor(N){N=N.split("|");this.sx=N[1];this.RUc=N[2];this.vYd=
N[3]}get solutionId(){return this.sx}get solutionVersion(){return this.RUc}get needToRestoreManifest(){return this.vYd===OSF.StoreTypeEnum.Registry.toString()}}Object(r.a)(u,"AddinStoreInfo",null,[]);class t{}Object(r.a)(t,"CustomFunctionRegistrationInfos",null,[]);const y=(N,J)=>{if(a(1231).CustomFunctionsLegacyInstaller.hyb("CustomFunctionsRuntimeLogging")&&window.console)switch(J=v(N.severity)+" "+N.message+J,N.severity){case 2:window.console.log&&window.console.log(J);break;case 0:window.console.info&&
window.console.info(J);break;case 1:window.console.error&&window.console.error(J)}},v=N=>{switch(N){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class A{}Object(r.a)(A,"InstallationInfo",null,[]);class z{}Object(r.a)(z,"UninstallationInfo",null,[]);var C=a(165),H=a(36),I=a(29),S=a(14),P=a(290),D=a(888),G=a(58);class E{constructor(N,J){this.qUc=N;this._message=J}get severity(){return this.qUc}get message(){return this._message}}Object(r.a)(E,"CustomFunctionLog",
null,[]);a.d(B,"CustomFunctionsLegacyInstaller",function(){return O});class O{constructor(N){this.rF={};this.$=N;this.Qpd().Tna()}zhf(N,J,W,ea){const R=new f.a;if(ea.invariantNamespace)for(J=0;J<ea.invariantNamespace.length;++J){const U=ea.invariantNamespace.charAt(J);if("."!==U&&"_"!==U&&"a">U&&"z"<U&&"A">U&&"Z"<U&&"0">U&&"9"<U)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${U}', Position=${J}.`),R.setResult(!1),
R.task}O.cacheManifest(W,ea.manifest);let Y=O.gLd(N);(null===Y||void 0===Y?0:Y.isDynamicMetadata)?this.fMd(N,Y,R,!1,!1):OSF.OUtil.xhrGet(ea.metadataUrl,U=>{Y=Object(c.a)(new A,{addinId:W,locale:ea.locale,addinInvariantNamespace:ea.invariantNamespace,addinNamespace:ea.namespace,addinTitle:ea.title,isXllCompatible:ea.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(U))});this.fMd(N,Y,R,!1,m.a(this.$,ea))},U=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${N}. ErrorCode: ${U}.`);
R.setResult(!1)});return R.task}Bhf(N,J,W,ea){J=new f.a;if(!O.mvd(W))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),J.setResult(!1),J.task;const R=O.gLd(N);if(!R)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),J.setResult(!1),J.task;R.metadataContent=JSON.stringify(JSON.parse(W));R.isDynamicMetadata=
!0;this.fMd(N,R,J,!0,ea);return J.task}Ekg(N){const J=new f.a,W=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);w.TaskExtensions.za(W,()=>{const ea=W.result;ea.$ia();const R=Object(c.a)(new z,{solutionId:N});O.QMd(N);O.XMd(N);w.TaskExtensions.za(this.b1d(ea,N,R),Y=>{C.b(Y)?J.setResult(Y.result):(Y.Lf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${N}.`):Y.vh&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${N}.`),
J.setResult(!1))},this.$.ka,0)},this.$.ka,3);return J.task}Qpd(){const N=new f.a,J=O.lLd();0<J.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const W=[];J.forEach(R=>{R=Object(d.a)(String,R);if(R=O.gLd(R)){const Y=H.a.Ic(this.rF,R.addinId);Y&&Y===R.metadataContent||(this.rF[R.addinId]=R.metadataContent,W.push(R))}});if(!W.length)return N.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
N.task;const ea=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);w.TaskExtensions.za(ea,()=>{const R=ea.result,Y=Object(c.a)(new t,{registrationInfos:W});w.TaskExtensions.za(this.N2b(R,J,Y),U=>{C.b(U)?N.setResult(U.result):(U.Lf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):U.vh&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
N.setResult(!1))},this.$.ka,0)},this.$.ka,3);return N.task}Cuj(N){N=new u(N);if(N.needToRestoreManifest){const J=O.Phj(N.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(N.solutionId,N.solutionVersion,J,this.$.ya.UICultureTag)}}fMd(N,J,W,ea,R){const Y=k.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);w.TaskExtensions.za(Y,()=>{w.TaskExtensions.za(this.hMd(Y.result,N,J,!1,ea,R),U=>{C.b(U)?((U=U.result)&&O.zbk(N,J),W.setResult(U)):(U.Lf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${N}.`):
U.vh&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${N}.`),W.setResult(!1))},this.$.ka,0)},this.$.ka,3)}hMd(N,J,W,ea,R,Y){if(!R&&(R=H.a.Ic(this.rF,W.addinId))&&R===W.metadataContent)return G.Task.Ta(!0);this.rF[W.addinId]=W.metadataContent;const U=new f.a;Y||N.xKb(J);N.$ia();N=this.MHa(W);return this.U3(da=>{y(O.eub,J);const T=da.Result;204===T.ResponseStatusCode?w.TaskExtensions.za(this.MJd(U,W.addinId,ea),
ka=>{ka.Lf?J?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${J}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${W.addinId}.`):ka.vh&&(J?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${J}.`):b.ULS.sendTraceTag(537163482,
0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${W.addinId}.`));U.setResult(!1)},this.$.ka,4):(da=()=>{delete this.rF[W.addinId];O.QMd(J);O.XMd(J);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${J}. Received status code ${T.ResponseStatusCode}.`);U.setResult(!1)},da=Object(c.a)(new D.a,{BMa:OSF.InfoType.Error,title:W.addinTitle,description:String.format(S.a.instance.nb(153),
S.a.instance.ga(1892)),buttonText:S.a.instance.ga(4),Kha:da,ugc:!1,Oia:da,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.QVd(da))},da=>{da=n.a.Ue(da.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${J}. Errors: ${I.a.qc(da)}.`);y(O.dub,J);delete this.rF[W.addinId];U.setResult(!1)},N,U,!0)}N2b(N,J,W){const ea=new f.a;J.forEach(Y=>{Y=Object(d.a)(String,Y);N.yDe(Y)});N.$ia();
const R=this.s1c(W);return this.U3(Y=>{y(O.eub,Sys.Serialization.JavaScriptSerializer.serialize(J));Y=Y.Result;let U=!0;var da=Sys.Serialization.JavaScriptSerializer.deserialize(Y.ResponseBody.toString());da=Array.isArray(da.value)?da.value:null;for(let T=0;T<da.length;T++)da[T]||(U=!1,delete this.rF[W.registrationInfos[T].addinId],O.QMd(J[T]),O.XMd(J[T]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${J[T]}. Received status code ${Y.ResponseStatusCode}.`));
w.TaskExtensions.za(this.MJd(ea,"",!1),T=>{T.Lf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):T.vh&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");ea.setResult(!1)},this.$.ka,4);ea.setResult(U)},Y=>{Y=n.a.Ue(Y.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(J)}. Errors: ${I.a.qc(Y)}.`);
y(O.dub,Sys.Serialization.JavaScriptSerializer.serialize(J));for(const U of W.registrationInfos)delete this.rF[U.addinId];ea.setResult(!1)},R,ea,!0)}b1d(N,J,W){const ea=new f.a;N.xKb(J);N=this.E1c(W);return this.U3(()=>{y(O.D8c,J);w.TaskExtensions.za(this.MJd(ea,W.solutionId,!1),R=>{R.Lf?J&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${J}.`):R.vh&&J&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${J}.`);
ea.setResult(!1)},this.$.ka,4)},R=>{R=n.a.Ue(R.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${J}. Errors: ${I.a.qc(R)}.`);y(O.C8c,J);ea.setResult(!1)},N,ea,!1)}U3(N,J,W,ea,R){const Y=this.$.userOperationManager,U=this.$.pa;let da=null,T=null,ka=null;const L=()=>{if(Y.GIa()||0<U.va.V3||0<U.Rk.V3)return!1;da&&Y.ao(da);T&&U.zs(T);ka&&U.uy(ka);const fa=W.request;Y.bF(new h.a(507,0,(wa,oa,xa)=>
{y(R?O.B8c:O.E8c,fa.RequestBody);return l.g(U.va,"ExecuteRichApiRequest",W,P.b(wa,N),P.a(oa,J),xa,null,0)},(fa.RequestFlags&1?0:16)|64));return!0};L()||(da=()=>{L()},T=()=>{L()},ka=()=>{L()},Y.jr(da),U.kr(T),U.Ax(ka));return ea.task}MHa(N){const J={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};J.RequestBody=JSON.stringify(N);J.RequestFlags=1;N=this.$.pa.va.Oa(1);N.request=J;return N}s1c(N){const J={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};
J.RequestBody=JSON.stringify(N);J.RequestFlags=1;N=this.$.pa.va.Oa(1);N.request=J;return N}E1c(N){const J={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};J.RequestBody=JSON.stringify(N);J.RequestFlags=1;N=this.$.pa.va.Oa(1);N.request=J;return N}MJd(N,J,W){const ea=k.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);w.TaskExtensions.za(ea,()=>{ea.result.jPd();J&&W&&this.Cuj(J);N.setResult(!0)},this.$.ka,3);return ea}Chf(){return G.Task.Ta(!0)}static lLd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(O.hyb(x.a.ZZa)||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(O.hyb(x.a.ZZa)||"[]"):null)||[]}static Nqg(N){O.sTd(x.a.ZZa,Sys.Serialization.JavaScriptSerializer.serialize(N))}static gLd(N){N=O.hyb(x.a.r5a(N))||"";return 0<N.length?Sys.Serialization.JavaScriptSerializer.deserialize(N,!0):null}static zbk(N,J){O.TRe(N);O.sTd(x.a.r5a(N),Sys.Serialization.JavaScriptSerializer.serialize(J))}static QMd(N){O.xXf(N);O.RXf(x.a.r5a(N))}static Phj(N){return O.hyb(x.a.q5a(N))}static Abk(N,J){O.TRe(N);O.sTd(x.a.q5a(N),
J)}static XMd(N){O.xXf(N);O.RXf(x.a.q5a(N))}static TRe(N){const J=O.lLd();N=N.toLowerCase();J.includes(N)||(J.push(N),O.Nqg(J))}static xXf(N){const J=O.lLd();N=N.toLowerCase();J.includes(N)&&(J.splice(Array.indexOf(J,N),1),O.Nqg(J))}static cacheManifest(N,J){N=new u(N);N.needToRestoreManifest&&O.Abk(N.solutionId,J)}static hyb(N){try{return localStorage.getItem(N)}catch(J){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${J.message||
"Unknown"}`),null}}static sTd(N,J){try{localStorage.setItem(N,J)}catch(W){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${W.message||"Unknown"}`)}}static RXf(N){try{localStorage.removeItem(N)}catch(J){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${J.message||"Unknown"}`)}}static mvd(N){if(!N)return!1;try{JSON.parse(N)}catch(J){return!1}return!0}}
O.B8c=new E(2,"CustomFunctions [Registration] [Begin] SolutionId=");O.eub=new E(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");O.dub=new E(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");O.E8c=new E(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");O.D8c=new E(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");O.C8c=new E(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(r.a)(O,"CustomFunctionsLegacyInstaller",null,[868])},
1269:function(r,B,a){r=a(0);var c=a(204),b=a(15);class e{}Object(r.a)(e,"AddinCommandsHost",null,[]);var f=a(1346),d=a(1429),h=a(885),l=a(63);const k=(H,I,S,P,D,G)=>{const E=H.Oa(9);E.sharedInfo=I;return l.g(H,"InsertAgaveTaskpane",E,S,P,D,G,0)},w=(H,I,S,P,D,G,E=null)=>{E=H.Oa(9,E);E.sharedInfo=I;return l.g(H,"ShowAgaveTaskpane",E,S,P,D,G,0)};var n=a(379),x=a(198),m=a(38),u=a(1),t=a(290),y=a(156);class v extends y.a{constructor(H){super();this.we=this.gEa="AddInCommandsDialog";this.Rb=5;this.dialogWidth=
695;this.dialogHeight=438;this.Wbh="100%";this.Tbh="408px";this.Ubh="15px";this.Vbh="0";this.lEg=H}get containerDiv(){return this.Th}Tw(){super.Tw();this.Th.style.width=this.Wbh;this.Th.style.height=this.Tbh;this.Th.style.marginTop=this.Ubh;this.Th.style.padding=this.Vbh}LD(){super.LD();this.ib.style.width=String.format("{0}px",this.dialogWidth);this.ib.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.lEg()}}Object(r.a)(v,"AddInCommandsDialog",y.a,[]);var A=a(58),
z=a(75);y=a(103);a.d(B,"a",function(){return C});class C extends e{constructor(H,I,S,P=null,D=null){super();this.$=H;this.Fd=I;this.ownerAddinInfo=S;this.Ud=D;this.Mdb=P||A.Task.Ta(!0)}Obh(){const H=this.Mdb;this.Mdb=A.Task.Ta(!0);return H}disposeHost(H){this.Fd.mRa(H)}setOwnerAddinEToken(H){this.ownerAddinInfo.eToken=H}showTaskpane(H,I,S){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let P=null,D=!1,G=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,
!0)).ULe(H.solutionId.substr(this.ownerAddinInfo.solutionId.length));P=I.getSharedRuntimeForTaskpane("Workbook",G);D=!!P&&1===P.LifeTime;this.Fd.BDe(D?this.ownerAddinInfo.solutionId:H.solutionId,D?P:null,null)||(this.Duf(D,!0),this.Mdb=this.Opd(H,P,(E,O)=>{E?(D&&(E.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,E.SharedRuntime=P),E.WebExtensionOsfControlType=3,this.Fd.VIa(E),S(E.InstanceId,O),this.Duf(D,!1),u.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&
b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),S(null,O))}))}getSettings(H,I){let S=this.Fd.Xaa(H.solutionId);S?I(this.Fd.QU(S).OsfPropertyBag):this.Mdb=this.Opd(H,null,P=>{P?I(P.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(H,I,S){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const P=this.$.pa.va,D=E=>{const O=E.Result,N=O?O.AgaveData:
null;N?(this.Fd.NKe(N,()=>{const J=new v(()=>{this.disposeHost(N.InstanceId)});J.initializeAndShow("",null,null);return J.containerDiv}),S(N.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),S(null,E.Errors?E.Errors[0].ErrorCause:5001))},G=C.XIa(H,this.ownerAddinInfo);this.Mdb=n.a(this.$.userOperationManager,(E,O,N)=>k(P,G,t.b(E,D),O,N,null),E=>new x.a(500,0,E,64),this.Ud)}createUILessSandbox(H,I,S){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");
const P=I.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),D=!!P&&1===P.LifeTime;(I=this.Fd.rLh(D?this.ownerAddinInfo.solutionId:H.solutionId,D?P:null))?S(I,0):this.Mdb=this.Opd(H,P,(G,E)=>{G?(D?(G.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,G.SharedRuntime=P,G.TaskpaneVisible=!1,G.WebExtensionOsfControlType=3,this.Fd.VIa(G)):(G.WebExtensionOsfControlType=4,this.Fd.NKe(G,()=>{C.Sgb.ia(G.InstanceId,new d.a);return C.Sgb.ma(G.InstanceId).taa})),S(G.InstanceId,E)):(b.ULS.sendTraceTag(537170636,
220,10,"UILess: instance id is null."),S(null,E))})}Opd(H,I,S){let P=null;const D=this.$.pa.va,G=W=>{const ea=W.Result;(P=ea?ea.AgaveData:null)||S(null,W.Errors?W.Errors[0].ErrorCause:5001)},E=C.XIa(H,this.ownerAddinInfo);I&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),E.SharedRuntimeId=I.Resid);let O=500;var N=(W,ea,R)=>k(D,E,t.b(W,G),ea,R,null);let J=0;void 0===E.IsToBePersisted||null===E.IsToBePersisted||E.IsToBePersisted||(O=538,N=(W,ea,R)=>{b.ULS.sendTraceTag(537170633,
220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));return w(D,E,t.b(W,G),ea,R,null)},J=16);J|=64;N=n.a(this.$.userOperationManager,N,W=>new x.a(O,0,W,J),this.Ud);return m.TaskExtensions.ts(N,()=>P?this.Hxd(D,P.InstanceId,(W,ea)=>{if(W){I||(P.PrimaryMarketplace.MarketplaceType=H.storeType);
H.assetId?H.assetId.toLowerCase().startsWith("wa")?P.AssetMarketplace={SolutionId:H.assetId,SolutionVersion:H.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:H.assetStoreId}:(P.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):P.AssetMarketplace=null;P.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;P.OwnerAddinStoreType=this.ownerAddinInfo.storeType;P.OsfPropertyBag=[];for(ea=0;ea<W.Settings.length;ea++){const R=[];
R[0]=W.Settings[ea].Name;R[1]=W.Settings[ea].Value;P.OsfPropertyBag[ea]=R}S(P,0)}else S(null,ea.Errors?ea.Errors[0].ErrorCause:5001)}):A.Task.Ta(!1),c.a.none,3,z.a.current)}Hxd(H,I,S){const P=D=>{S(D.Result,D)};return n.a(this.$.userOperationManager,(D,G,E)=>{D=t.b(D,P);const O=H.Oa(1);O.controlId=I;return l.g(H,"DdaLoadSettings",O,D,G,E,null,0)},D=>new x.a(501,0,D,80),this.Ud)}Duf(H,I){var S;H&&(null===(S=window.performance)||void 0===S?0:S.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${I}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(H){C.Sgb.kb(H)&&
C.Sgb.ma(H).initializeAndShowWithTitle()}static hideUILessDialog(H){C.Sgb.kb(H)&&C.Sgb.ma(H).hide()}static XIa(H,I){const S={};S.SolutionId=H.solutionId;S.Version=H.version;S.StoreType=I.storeType;S.StoreId=H.storeId;S.AssetId=H.solutionId;S.AssetStoreId="omex";S.TargetType=1;S.Width=350;S.OwnerAddinSolutionId=I.solutionId;S.OwnerAddinStoreType=I.storeType;S.SharedRuntimeId=null;S.Preload=!1;return S}}C.Sgb=new y.a;Object(r.a)(C,"WACExcelAddinCommandsHost",e,[])},1275:function(r,B,a){var c=a(9);r=
a(0);var b=a(714),e=a(15),f=a(107),d=a(4),h=a(1336),l=a(1),k=a(196),w=a(58);class n{constructor(C,H,I){this.iub=null;this.$=C;H?(e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.iub=new h.a(C,H,I)):e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Mc(){return!1}executeCommand(C,H,I){C=!1;switch(H.command){case 73979048:this.iub&&
this.iub.Kbj(H,f.a.instance,d.AFrameworkApplication.fa,I),C=!0}return C?w.Task.Ta(!0):k.a(H.command)}Ac(C,H){return 73979048===H.command&&l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Rc(){return!1}dispose(){this.iub&&this.iub.dispose()}}Object(r.a)(n,"DataFromPictureCommandHandler",null,[222,3]);var x=a(38),m=a(50),u=a(108),t=a(153),y=a(54),v=a(70);class A extends b.a{constructor(C){super(C)}ld(){const C=m.GetServiceTaskFactory.Pa(this.$.da,328,327,1),H=Object(v.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?
Object(u.c)(t.a.resolve(y.T,{Wb:this.Na})):m.GetServiceTaskFactory.Pa(this.$.da,484,485,1);x.TaskExtensions.za(x.TaskExtensions.Md([C,H],this.$.ka),()=>{this.fd([new n(this.$,C.result,H.result)])},this.$.ka,3)}static la(C){b.a.Rd(452,new A(C))}}Object(r.a)(A,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(B,"a",function(){return z});const z=()=>{c.a.Fa(C=>{A.la(C)})}},1334:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=
0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static VSh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(r.a)(c,"WopiAuthContext",null,[198])},1335:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{}c.SMf="OneDriveWOPI";Object(r.a)(c,"HostApplicationType",null,[])},1336:function(r,B,a){(function(c){a.d(B,
"a",function(){return C});var b=a(0),e=a(15),f=a(178),d=a(87),h=a(1342),l=a(39),k=a(258),w=a(44),n=a(379),x=a(198),m=a(63),u=a(96),t=a(14),y=a(21),v=a(40),A=a(1343),z=a(1);class C extends l.a{constructor(H,I,S){super();this.Dii=h.a.getTypeName();this.lAb=this.eU=this.Ud=null;this.imageHeight=this.imageWidth=0;this.yMa=this.errorMessage=this.tableData=null;this.jod=0;this.RWc=!1;this.$Le=P=>{if(P){var D={};if(({ot:D}=v.d(this.jnh(P.data))).returnValue&&(P=Object(d.a)(Object,D),"."===P.DataFromPictureWildcard))if(P.SessionId!==
this.yMa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),P.CmdType){case "ACK":this.RWc=!0;this.Bgg.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");
this.lAj();0<this.errorMessage.length?this.t5f():0<this.tableData.length&&this.L5f();break;case "insert_html":const E=this.$.pa.va;D={};var G=y.h(this.$).ha.ra.xd.clone();D.PasteId=f.a.create().toString();D.DestinationRanges=w.s(w.v(G,this.$));G=P.Parameters.split("|",3);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${G[0]}|${G[1]}|${G[2]}.`);
G=P.Parameters.indexOf("|");G=P.Parameters.indexOf("|",G+1);G=P.Parameters.indexOf("|",G+1);D.SourceHtml=P.Parameters.substring(G+1);D.CopyOperationId=null;const O=E.Oa(1,E.$b());O.pasteHtmlParameters=D;n.a(this.$.userOperationManager,(N,J,W)=>m.g(E,"pasteHtmlContent",O,N,J,W,null,64),N=>new x.a(204,0,N,1),null);this.jod++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.jod.toString()}`)}}};this.Cii=
(P,D)=>{if(P=D.VG)if(!D.parentPath||1>=D.parentPath.length||D.parentPath[1]!==this.yMa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");D=P.errorCode;switch(D){case null:case -1:this.errorMessage=t.a.instance.ga(2273);break;case 1:this.errorMessage=t.a.instance.ga(2274);
break;case 2:this.errorMessage=t.a.instance.ga(2275)}0<this.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${D?D.toString():"null"}.`);this.fve.stop();this.tableData=P.html;this.RWc&&(0<this.errorMessage.length?this.t5f():0<this.tableData.length&&this.L5f())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=H;this.augmentationLoopManager=
I;this.uploaderCreator=S;this.initialize()}dispose(){window.removeEventListener("message",this.$Le,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}i4i(H,I){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let S=new Image;S.onload=()=>{var P=document.createElement("canvas");P.width=S.width;P.height=S.height;const D=P.getContext("2d");try{D.drawImage(S,0,0,S.width,S.height)}catch(O){e.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${O.message}`);
return}let G;try{G=P.toDataURL("image/jpeg")}catch(O){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${O.message}`);return}P=G.split(",");if(2>P.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{P=P[1];try{var E=window.self.atob(P)}catch(O){e.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${O.message}`);
return}28E5<E.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),I.LNj()):(this.uwj(this.Ud,this.eU,P,S.width,S.height),URL.revokeObjectURL(S.src),S=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};S.src=H}Kbj(H,I,S,P){this.Ud=H;this.eU=P;this.uploaderCreator.qli(this.$,I,S,P,this)}uwj(H,I,S,P,D){this.yMa=f.a.create().toString();this.jod=0;this.lAb=S;this.imageWidth=P;this.imageHeight=
D;this.errorMessage=this.tableData="";this.RWc=!1;this.Bgg=this.$.Mb.vg("LoadResource","DataFromPictureTaskpaneLaunch");this.Bgg.start();this.Q6i(H,I);this.fve=this.$.Mb.vg("LoadResource","DataFromPictureAnnotation");this.fve.start();this.Z7j()}Z7j(){if(this.lAb.length){var H=window.self.atob(this.lAb);var I=new Uint8Array(H.length);for(let S=0;S<H.length;S++)I[S]=H.charCodeAt(S);this.augmentationLoopManager.Y7j(I,this.yMa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}Q6i(H,
I){I.SessionID=this.yMa;I.DataFromPictureAssetId="FA000000050";I.LoadDataFromPictureTaskpane=!0;H=new u.a(-859308420,H.method,H.mode,H.Ve,H.tabName);this.$.Ia.Hb(H,I)}uad(H){try{const I=c.from(H,"utf16le").toString("base64");return A.a.NIa(this.yMa,I)}catch(I){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}jnh(H){try{const I=A.a.NIa(this.yMa,H);return c.from(I,"base64").toString("utf16le")}catch(I){return e.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}lAj(){if(this.lAb.length){var H=k.a(this.$).Xaa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.imageData=this.uad(this.lAb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,S=>{S&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}L5f(){if(this.tableData.length){var H=
k.a(this.$).Xaa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.tableHtml=this.uad(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,S=>{S&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}t5f(){if(this.errorMessage.length){var H=
k.a(this.$).Xaa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.errorMessage=this.uad(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,S=>{S&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.$Le,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.O4a().xeb("DataFromPicture").ueb(()=>{}).activateAnnotation({annotationType:this.Dii,Au:!1,JK:this.Cii}).build())}}Object(b.a)(C,"DataFromPictureManager",l.a,[419])}).call(this,a(1337).wrg)},1337:function(r,B,a){(function(c){function b(){try{var D=new Uint8Array(1);D.__proto__={__proto__:Uint8Array.prototype,xdk:function(){return 42}};return"function"===typeof D.subarray&&0===D.subarray(1,1).byteLength}catch(G){return!1}}
function e(D,G){if((f.$O?2147483647:1073741823)<G)throw new RangeError("Invalid typed array length");f.$O?(D=new Uint8Array(G),D.__proto__=f.prototype):(null===D&&(D=new f(G)),D.length=G);return D}function f(D,G,E){if(!(f.$O||this instanceof f))return new f(D,G,E);if("number"===typeof D){if("string"===typeof G)throw Error("If encoding is specified then the first argument must be a string");return l(this,D)}return d(this,D,G,E)}function d(D,G,E,O){if("number"===typeof G)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&G instanceof ArrayBuffer){G.byteLength;if(0>E||G.byteLength<E)throw new RangeError("'offset' is out of bounds");if(G.byteLength<E+(O||0))throw new RangeError("'length' is out of bounds");G=void 0===E&&void 0===O?new Uint8Array(G):void 0===O?new Uint8Array(G,E):new Uint8Array(G,E,O);f.$O?(D=G,D.__proto__=f.prototype):D=k(D,G);G=D}else if("string"===typeof G){O=D;D=E;if("string"!==typeof D||""===D)D="utf8";if(!f.pkf(D))throw new TypeError('"encoding" must be a valid string encoding');
E=x(G,D)|0;O=e(O,E);G=O.write(G,D);G!==E&&(O=O.slice(0,G));G=O}else G=w(D,G);return G}function h(D){if("number"!==typeof D)throw new TypeError('"size" argument must be a number');if(0>D)throw new RangeError('"size" argument must not be negative');}function l(D,G){h(G);D=e(D,0>G?0:n(G)|0);if(!f.$O)for(var E=0;E<G;++E)D[E]=0;return D}function k(D,G){var E=0>G.length?0:n(G.length)|0;D=e(D,E);for(var O=0;O<E;O+=1)D[O]=G[O]&255;return D}function w(D,G){if(f.isBuffer(G)){var E=n(G.length)|0;D=e(D,E);if(0===
D.length)return D;G.copy(D,0,0,E);return D}if(G){if("undefined"!==typeof ArrayBuffer&&G.buffer instanceof ArrayBuffer||"length"in G)return(E="number"!==typeof G.length)||(E=G.length,E=E!==E),E?e(D,0):k(D,G);if("Buffer"===G.type&&I(G.data))return k(D,G.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function n(D){if(D>=(f.$O?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.$O?2147483647:
1073741823).toString(16)+" bytes");return D|0}function x(D,G){if(f.isBuffer(D))return D.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(D)||D instanceof ArrayBuffer))return D.byteLength;"string"!==typeof D&&(D=""+D);var E=D.length;if(0===E)return 0;for(var O=!1;;)switch(G){case "ascii":case "latin1":case "binary":return E;case "utf8":case "utf-8":case void 0:return v(D).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
E;case "hex":return E>>>1;case "base64":return z(D).length;default:if(O)return v(D).length;G=(""+G).toLowerCase();O=!0}}function m(D,G,E){var O=!1;if(void 0===G||0>G)G=0;if(G>this.length)return"";if(void 0===E||E>this.length)E=this.length;if(0>=E)return"";E>>>=0;G>>>=0;if(E<=G)return"";for(D||(D="utf8");;)switch(D){case "hex":D=G;G=E;E=this.length;if(!D||0>D)D=0;if(!G||0>G||G>E)G=E;O="";for(E=D;E<G;++E)D=O,O=this[E],O=16>O?"0"+O.toString(16):O.toString(16),O=D+O;return O;case "utf8":case "utf-8":return y(this,
G,E);case "ascii":D="";for(E=Math.min(this.length,E);G<E;++G)D+=String.fromCharCode(this[G]&127);return D;case "latin1":case "binary":D="";for(E=Math.min(this.length,E);G<E;++G)D+=String.fromCharCode(this[G]);return D;case "base64":return 0===G&&E===this.length?H.P0e(this):H.P0e(this.slice(G,E));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":G=this.slice(G,E);E="";for(D=0;D<G.length;D+=2)E+=String.fromCharCode(G[D]+256*G[D+1]);return E;default:if(O)throw new TypeError("Unknown encoding: "+
D);D=(D+"").toLowerCase();O=!0}}function u(D,G,E,O,N){if(0===D.length)return-1;"string"===typeof E?(O=E,E=0):2147483647<E?E=2147483647:-2147483648>E&&(E=-2147483648);E=+E;isNaN(E)&&(E=N?0:D.length-1);0>E&&(E=D.length+E);if(E>=D.length){if(N)return-1;E=D.length-1}else if(0>E)if(N)E=0;else return-1;"string"===typeof G&&(G=f.from(G,O));if(f.isBuffer(G))return 0===G.length?-1:t(D,G,E,O,N);if("number"===typeof G)return G&=255,f.$O&&"function"===typeof Uint8Array.prototype.indexOf?N?Uint8Array.prototype.indexOf.call(D,
G,E):Uint8Array.prototype.lastIndexOf.call(D,G,E):t(D,[G],E,O,N);throw new TypeError("val must be string, number or Buffer");}function t(D,G,E,O,N){function J(Y,U){return 1===W?Y[U]:Y.Zhj(U*W)}var W=1,ea=D.length,R=G.length;if(void 0!==O&&(O=String(O).toLowerCase(),"ucs2"===O||"ucs-2"===O||"utf16le"===O||"utf-16le"===O)){if(2>D.length||2>G.length)return-1;W=2;ea/=2;R/=2;E/=2}if(N)for(O=-1;E<ea;E++)if(J(D,E)===J(G,-1===O?0:E-O)){if(-1===O&&(O=E),E-O+1===R)return O*W}else-1!==O&&(E-=E-O),O=-1;else for(E+
R>ea&&(E=ea-R);0<=E;E--){ea=!0;for(O=0;O<R;O++)if(J(D,E+O)!==J(G,O)){ea=!1;break}if(ea)return E}return-1}function y(D,G,E){E=Math.min(D.length,E);for(var O=[];G<E;){var N=D[G],J=null,W=239<N?4:223<N?3:191<N?2:1;if(G+W<=E)switch(W){case 1:128>N&&(J=N);break;case 2:var ea=D[G+1];128===(ea&192)&&(N=(N&31)<<6|ea&63,127<N&&(J=N));break;case 3:ea=D[G+1];var R=D[G+2];128===(ea&192)&&128===(R&192)&&(N=(N&15)<<12|(ea&63)<<6|R&63,2047<N&&(55296>N||57343<N)&&(J=N));break;case 4:ea=D[G+1];R=D[G+2];var Y=D[G+
3];128===(ea&192)&&128===(R&192)&&128===(Y&192)&&(N=(N&15)<<18|(ea&63)<<12|(R&63)<<6|Y&63,65535<N&&1114112>N&&(J=N))}null===J?(J=65533,W=1):65535<J&&(J-=65536,O.push(J>>>10&1023|55296),J=56320|J&1023);O.push(J);G+=W}D=O.length;if(D<=S)O=String.fromCharCode.apply(String,O);else{E="";for(G=0;G<D;)E+=String.fromCharCode.apply(String,O.slice(G,G+=S));O=E}return O}function v(D,G){G=G||Infinity;for(var E,O=D.length,N=null,J=[],W=0;W<O;++W){E=D.charCodeAt(W);if(55295<E&&57344>E){if(!N){if(56319<E){-1<(G-=
3)&&J.push(239,191,189);continue}else if(W+1===O){-1<(G-=3)&&J.push(239,191,189);continue}N=E;continue}if(56320>E){-1<(G-=3)&&J.push(239,191,189);N=E;continue}E=(N-55296<<10|E-56320)+65536}else N&&-1<(G-=3)&&J.push(239,191,189);N=null;if(128>E){if(0>--G)break;J.push(E)}else if(2048>E){if(0>(G-=2))break;J.push(E>>6|192,E&63|128)}else if(65536>E){if(0>(G-=3))break;J.push(E>>12|224,E>>6&63|128,E&63|128)}else if(1114112>E){if(0>(G-=4))break;J.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw Error("Invalid code point");
}return J}function A(D){for(var G=[],E=0;E<D.length;++E)G.push(D.charCodeAt(E)&255);return G}function z(D){var G=H,E=G.jYj;D=(D.trim?D.trim():D.replace(/^\s+|\s+$/g,"")).replace(P,"");if(2>D.length)D="";else for(;0!==D.length%4;)D+="=";return E.call(G,D)}function C(D,G,E,O){for(var N=0;N<O&&!(N+E>=G.length||N>=D.length);++N)G[N+E]=D[N];return N}var H=a(1339);a(1340);var I=a(1341);B.wrg=f;B.Pck=function(D){+D!=D&&(D=0);return f.Aue(+D)};B.wck=50;f.$O=void 0!==c.$O?c.$O:b();B.Gdk=f.$O?2147483647:1073741823;
f.from=function(D,G,E){return d(null,D,G,E)};f.$O&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.Aue=function(D){h(D);return e(null,D)};f.UTg=function(D){return l(null,D)};f.isBuffer=function(D){return!(null==D||!D.WBg)};f.compare=function(D,G){if(!f.isBuffer(D)||!f.isBuffer(G))throw new TypeError("Arguments must be Buffers");if(D===G)return 0;
for(var E=D.length,O=G.length,N=0,J=Math.min(E,O);N<J;++N)if(D[N]!==G[N]){E=D[N];O=G[N];break}return E<O?-1:O<E?1:0};f.pkf=function(D){switch(String(D).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(D,G){if(!I(D))throw new TypeError('"list" argument must be an Array of Buffers');if(0===D.length)return f.Aue(0);var E;if(void 0===G)for(E=G=
0;E<D.length;++E)G+=D[E].length;G=f.UTg(G);var O=0;for(E=0;E<D.length;++E){var N=D[E];if(!f.isBuffer(N))throw new TypeError('"list" argument must be an Array of Buffers');N.copy(G,O);O+=N.length}return G};f.byteLength=x;f.prototype.WBg=!0;f.prototype.toString=function(){var D=this.length|0;return 0===D?"":0===arguments.length?y(this,0,D):m.apply(this,arguments)};f.prototype.equals=function(D){if(!f.isBuffer(D))throw new TypeError("Argument must be a Buffer");return this===D?!0:0===f.compare(this,
D)};f.prototype.compare=function(D,G,E,O,N){if(!f.isBuffer(D))throw new TypeError("Argument must be a Buffer");void 0===G&&(G=0);void 0===E&&(E=D?D.length:0);void 0===O&&(O=0);void 0===N&&(N=this.length);if(0>G||E>D.length||0>O||N>this.length)throw new RangeError("out of range index");if(O>=N&&G>=E)return 0;if(O>=N)return-1;if(G>=E)return 1;G>>>=0;E>>>=0;O>>>=0;N>>>=0;if(this===D)return 0;var J=N-O,W=E-G,ea=Math.min(J,W);O=this.slice(O,N);D=D.slice(G,E);for(G=0;G<ea;++G)if(O[G]!==D[G]){J=O[G];W=D[G];
break}return J<W?-1:W<J?1:0};f.prototype.includes=function(D,G,E){return-1!==this.indexOf(D,G,E)};f.prototype.indexOf=function(D,G,E){return u(this,D,G,E,!0)};f.prototype.lastIndexOf=function(D,G,E){return u(this,D,G,E,!1)};f.prototype.write=function(D,G,E,O){if(void 0===G)O="utf8",E=this.length,G=0;else if(void 0===E&&"string"===typeof G)O=G,E=this.length,G=0;else if(isFinite(G))G|=0,isFinite(E)?(E|=0,void 0===O&&(O="utf8")):(O=E,E=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var N=this.length-G;if(void 0===E||E>N)E=N;if(0<D.length&&(0>E||0>G)||G>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");for(N=!1;;)switch(O){case "hex":G=Number(G)||0;O=this.length-G;E?(E=Number(E),E>O&&(E=O)):E=O;O=D.length;if(0!==O%2)throw new TypeError("Invalid hex string");E>O/2&&(E=O/2);for(O=0;O<E;++O){N=parseInt(D.substr(2*O,2),16);if(isNaN(N))break;this[G+O]=N}return O;case "utf8":case "utf-8":return C(v(D,this.length-G),this,G,E);case "ascii":return C(A(D),
this,G,E);case "latin1":case "binary":return C(A(D),this,G,E);case "base64":return C(z(D),this,G,E);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":O=D;N=this.length-G;for(var J=[],W=0;W<O.length&&!(0>(N-=2));++W){var ea=O.charCodeAt(W);D=ea>>8;ea%=256;J.push(ea);J.push(D)}return C(J,this,G,E);default:if(N)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase();N=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.Uck||this,0)}};var S=4096;
f.prototype.slice=function(D,G){var E=this.length;D=~~D;G=void 0===G?E:~~G;0>D?(D+=E,0>D&&(D=0)):D>E&&(D=E);0>G?(G+=E,0>G&&(G=0)):G>E&&(G=E);G<D&&(G=D);if(f.$O)G=this.subarray(D,G),G.__proto__=f.prototype;else{E=G-D;G=new f(E,void 0);for(var O=0;O<E;++O)G[O]=this[O+D]}return G};f.prototype.Zhj=function(D){if(0!==D%1||0>D)throw new RangeError("offset is not uint");if(D+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[D]<<8|this[D+1]};f.prototype.copy=function(D,
G,E,O){E||(E=0);O||0===O||(O=this.length);G>=D.length&&(G=D.length);G||(G=0);0<O&&O<E&&(O=E);if(O===E||0===D.length||0===this.length)return 0;if(0>G)throw new RangeError("targetStart out of bounds");if(0>E||E>=this.length)throw new RangeError("sourceStart out of bounds");if(0>O)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length);D.length-G<O-E&&(O=D.length-G+E);var N=O-E;if(this===D&&E<G&&G<O)for(O=N-1;0<=O;--O)D[O+G]=this[O+E];else if(1E3>N||!f.$O)for(O=0;O<N;++O)D[O+G]=
this[O+E];else Uint8Array.prototype.set.call(D,this.subarray(E,E+N),G);return N};f.prototype.fill=function(D,G,E,O){if("string"===typeof D){"string"===typeof G?(O=G,G=0,E=this.length):"string"===typeof E&&(O=E,E=this.length);if(1===D.length){var N=D.charCodeAt(0);256>N&&(D=N)}if(void 0!==O&&"string"!==typeof O)throw new TypeError("encoding must be a string");if("string"===typeof O&&!f.pkf(O))throw new TypeError("Unknown encoding: "+O);}else"number"===typeof D&&(D&=255);if(0>G||this.length<G||this.length<
E)throw new RangeError("Out of range index");if(E<=G)return this;G>>>=0;E=void 0===E?this.length:E>>>0;D||(D=0);if("number"===typeof D)for(O=G;O<E;++O)this[O]=D;else for(D=f.isBuffer(D)?D:v((new f(D,O)).toString()),N=D.length,O=0;O<E-G;++O)this[O+G]=D[O%N];return this};var P=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1338))},1338:function(r){var B=function(){return this}();try{B=B||(new Function("return this"))()}catch(a){"object"===typeof window&&(B=window)}r.exports=B},1339:function(r,B){function a(f){var d=
f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}B.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};B.jYj=function(f){var d=a(f);var h=d[0];d=d[1];var l=new e(3*(h+d)/4-d),k=0,w=0<d?h-4:h,n;for(n=0;n<w;n+=4)h=b[f.charCodeAt(n)]<<18|b[f.charCodeAt(n+1)]<<12|b[f.charCodeAt(n+2)]<<6|b[f.charCodeAt(n+3)],l[k++]=h>>16&255,l[k++]=h>>8&255,l[k++]=h&255;2===d&&(h=b[f.charCodeAt(n)]<<2|b[f.charCodeAt(n+1)]>>
4,l[k++]=h&255);1===d&&(h=b[f.charCodeAt(n)]<<10|b[f.charCodeAt(n+1)]<<4|b[f.charCodeAt(n+2)]>>2,l[k++]=h>>8&255,l[k++]=h&255);return l};B.P0e=function(f){for(var d=f.length,h=d%3,l=[],k=0,w=d-h;k<w;k+=16383){for(var n=l,x=n.push,m,u=f,t=k+16383>w?w:k+16383,y=[],v=k;v<t;v+=3)m=(u[v]<<16&16711680)+(u[v+1]<<8&65280)+(u[v+2]&255),y.push(c[m>>18&63]+c[m>>12&63]+c[m>>6&63]+c[m&63]);m=y.join("");x.call(n,m)}1===h?(f=f[d-1],l.push(c[f>>2]+c[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],l.push(c[f>>10]+c[f>>
4&63]+c[f<<2&63]+"="));return l.join("")};var c=[],b=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(r=0;64>r;++r)c[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[r],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(r)]=r;b[45]=62;b[95]=63},1340:function(r,B){B.read=function(a,c,b,e,f){var d=8*f-e-1;var h=(1<<d)-1,l=h>>1,k=-7;f=b?f-1:0;var w=b?-1:1,n=a[c+f];f+=w;b=n&(1<<-k)-1;n>>=-k;for(k+=d;0<k;b=256*b+a[c+f],f+=w,k-=8);d=b&(1<<-k)-1;
b>>=-k;for(k+=e;0<k;d=256*d+a[c+f],f+=w,k-=8);if(0===b)b=1-l;else{if(b===h)return d?NaN:Infinity*(n?-1:1);d+=Math.pow(2,e);b-=l}return(n?-1:1)*d*Math.pow(2,b-e)};B.write=function(a,c,b,e,f,d){var h,l=8*d-f-1,k=(1<<l)-1,w=k>>1,n=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var x=e?1:-1,m=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,e=k):(e=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-e))&&(e--,h*=2),c=1<=e+w?c+n/h:c+n*Math.pow(2,1-w),2<=c*h&&(e++,h/=2),e+
w>=k?(c=0,e=k):1<=e+w?(c=(c*h-1)*Math.pow(2,f),e+=w):(c=c*Math.pow(2,w-1)*Math.pow(2,f),e=0));for(;8<=f;a[b+d]=c&255,d+=x,c/=256,f-=8);e=e<<f|c;for(l+=f;0<l;a[b+d]=e&255,d+=x,e/=256,l-=8);a[b+d-x]|=128*m}},1341:function(r){var B={}.toString;r.exports=Array.isArray||function(a){return"[object Array]"==B.call(a)}},1342:function(r,B,a){a.d(B,"a",function(){return b});r=a(0);B=a(741);var c=a(718);class b extends B.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,
{T_:b.getTypeName(),B_:b.Pd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Pd(){return["AugLoop_Core_Annotation"]}}Object(r.a)(b,"DetectedHtmlTableAnnotation",B.a,[])},1343:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{static NIa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const f=Array(256),d=Array(256);let h,l=0,k=0;let w,n="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var x=b.charCodeAt(h%b.length);if(256<=x)return"";l=
(l+f[h]+x)%256;x=f[h];f[h]=f[l];f[l]=x}for(h=0;256>h;h++)d[h]=f[256-h-1];l=h=0;for(b=0;b<e.length;b++){h=(h+1)%256;l=(l+f[h])%256;x=f[h];f[h]=f[l];f[l]=x;x=e.charCodeAt(b);if(256<=x)return"";w=x^f[(f[h]+f[l])%256];k=(k+d[h])%256;x=d[h];d[h]=d[k];d[k]=x;n+=String.fromCharCode(w^f[(d[h]+d[k])%256])}return n}}Object(r.a)(c,"RC4A",null,[])},1346:function(r,B,a){a.d(B,"a",function(){return b});r=a(0);a(15);var c=a(4);class b{constructor(e,f,d,h){this.$lb=e;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&
d.F1h();this.sx=f;this.TGg=h}get XFb(){return this.$lb}get solutionId(){return this.sx}get rVd(){return this.TGg}fLa(e){e=this.XFb+this.solutionId+e;return this.rVd?(e in b.h1b||(b.h1b[e]="AddinControl"+b.ESg++),b.h1b[e]):e}ULe(e){if(this.rVd){const d=b.h1b;for(let h in d){var f=h;if(e===d[h])return f.substr(this.XFb.length+this.solutionId.length)}}return e}g$e(e){e=this.XFb+this.solutionId+e;return this.rVd?(e in b.vZc||(b.vZc[e]="AddinTab"+b.OSg++),b.vZc[e]):e}}b.h1b={};b.vZc={};b.OSg=0;b.ESg=0;
Object(r.a)(b,"DefaultRibbonNamingProvider",null,[881])},1400:function(r,B,a){a.r(B);r=a(0);var c=a(15),b=a(87),e;(function(m){m[m.none=0]="none";m[m.testEvent=1]="testEvent";m[m.test1Event=2]="test1Event";m[m.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";m[m.worksheetActivatedEvent=11]="worksheetActivatedEvent";m[m.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";m[m.worksheetAddedEvent=13]="worksheetAddedEvent";m[m.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";
m[m.worksheetDeletedEvent=15]="worksheetDeletedEvent";m[m.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";m[m.worksheetFilteredEvent=17]="worksheetFilteredEvent";m[m.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";m[m.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";m[m.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";m[m.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";m[m.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";m[m.worksheetFormulaChangedEvent=
23]="worksheetFormulaChangedEvent";m[m.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";m[m.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";m[m.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";m[m.worksheetMovedEvent=27]="worksheetMovedEvent";m[m.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";m[m.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";m[m.workbookFormulaReferenceStyleChangedEvent=30]=
"workbookFormulaReferenceStyleChangedEvent";m[m.chartAddedEvent=50]="chartAddedEvent";m[m.chartActivatedEvent=51]="chartActivatedEvent";m[m.chartDeactivatedEvent=52]="chartDeactivatedEvent";m[m.chartDeletedEvent=53]="chartDeletedEvent";m[m.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";m[m.tableDataChangedEvent=101]="tableDataChangedEvent";m[m.tableAddedEvent=102]="tableAddedEvent";m[m.tableDeletedEvent=103]="tableDeletedEvent";m[m.tableFilteredEvent=104]="tableFilteredEvent";m[m.agaveVisualUpdateEvent=
150]="agaveVisualUpdateEvent";m[m.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";m[m.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";m[m.commentAddedEvent=250]="commentAddedEvent";m[m.commentDeletedEvent=251]="commentDeletedEvent";m[m.commentChangedEvent=252]="commentChangedEvent";m[m.invocationMessage=1E3]="invocationMessage";m[m.cancellationMessage=1001]="cancellationMessage";m[m.metadataMessage=1002]="metadataMessage";m[m.visualSelectionChangedEvent=
2E3]="visualSelectionChangedEvent";m[m.visualChangeEvent=2001]="visualChangeEvent";m[m.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";m[m.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";m[m.shapeActivatedEvent=2101]="shapeActivatedEvent";m[m.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";m[m.shapeAddedEvent=2103]="shapeAddedEvent";m[m.shapeDeletedEvent=2104]="shapeDeletedEvent";m[m.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";
m[m.wacOperationEvent=2201]="wacOperationEvent";m[m.recordingStateChangedEvent=2202]="recordingStateChangedEvent";m[m.workbookActivatedEvent=2203]="workbookActivatedEvent";m[m.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";m[m.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";m[m.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";m[m.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";
m[m.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";m[m.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";m[m.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";m[m.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";m[m.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";m[m.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";m[m.lineageActivityFilterUpdatedEvent=
2801]="lineageActivityFilterUpdatedEvent";m[m.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";m[m.pivotTableAddedEvent=2900]="pivotTableAddedEvent";m[m.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";m[m.namedItemAddedEvent=3E3]="namedItemAddedEvent";m[m.namedItemDeletedEvent=3001]="namedItemDeletedEvent";m[m.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";m[m.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";
m[m.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";m[m.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";m[m.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";m[m.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";m[m.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent";m[m.augmentationLoopAnnotationAddedEvent=65541]=
"augmentationLoopAnnotationAddedEvent"})(e||(e={}));Object(r.b)("MessageType",e);var f=a(780),d=a(258),h=a(753),l=a(59),k=a(38),w=a(165),n=a(1);a.d(B,"DdaEventDispatch",function(){return x});class x{constructor(m){this.JA=null;this.zig={};this.Big={};this.ced={};this.ACd={};this.qmd=(u,t)=>{u=this.$.Mb.Kc("Task","DdaEventDispatch.HandleServerEvent");t=t.S5f;for(let z=0;z<t.length;z++)switch(t[z].EventType){case 2:var y=t[z],v={};v.Name=y.Name;v.BindingType=y.BindingType;v.ColCount=y.ColCount;v.RowCount=
y.RowCount;this.zwa(y.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,v,null);break;case 4:this.zwa(t[z].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(y=t[z],y.InstanceId){v=Array(y.Entries.length);for(var A=0;A<y.Entries.length;A++)v[A]=x.sec(y.Entries[A],y.IsRemoteOverride);0<y.Entries.length&&1===y.Entries[0].Category?this.Ycj(y.InstanceId,v):y.InstanceId&&this.zwa(y.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)}else{this.ced=
{};this.ACd={};for(v=0;v<y.Entries.length;v++)this.GOe(y.Entries[v],y.IsRemoteOverride);y=JSON.stringify(this.ced);v=JSON.stringify(this.ACd);A=JSON.stringify(this.zig);const C=JSON.stringify(this.Big);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${y}, Number of Not Fired event: ${v}, Total Number of Fired event: ${A}, Total Number of Not Fired event: ${C}`)}}u.stop()};this.MMb=(u,t)=>{this.zwa(u,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};this.$=m;this.Kyc=this.qmd}Q0b(m){m&&
(this.$ia(),this.JA.push(m))}Svc(m){this.JA&&(Array.remove(this.JA,m),this.JA.length||(this.$.wantServerEvents=!1,this.$.fqj(this.Kyc),this.JA=null))}Ycj(m,u){const t=Object(b.a)(h.DdaFacade,d.a(this.$));k.TaskExtensions.za(t.f3h(m),y=>{if(w.b(y)){var v=y.result;y=t.tn(v);if(v)if(y.ekc)this.zwa(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u);else if(y.X7b)for(v=0;v<u.length;v++)y.X7b.push(u[v]);else y.X7b=u}else y.Lf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):
y.vh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ka,0)}vdj(m,u){const t=Object(b.a)(h.DdaFacade,d.a(this.$)),y=t.URh(m);y?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(y,u,this.MMb):t.leh(m,u)}GOe(m,u){let t=!1;const y=parseInt(m.Type,10);var v=m.Target;const A=Object(b.a)(h.DdaFacade,d.a(this.$));if((v=A.Gh.k3h(y,v))&&0<Object.keys(v).length){t=!0;for(let C in v)if(v=C,A.Gh.c2b(v)){const H=
Array(1);H[0]=x.sec(m,u);if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var z=H[0][3];if(void 0!==z&&null!==z&&(z=Object(b.a)(Object,l.a.Yh(z)))&&void 0!==z.triggerControlId&&null!==z.triggerControlId&&void 0!==z.triggerSource&&null!==z.triggerSource){let I=!1;u?(z.triggerSource="Unknown",I=!0):A.Urh(z.triggerControlId,v)&&(z.triggerSource="ThisLocalAddin",I=!0);I&&(H[0][3]=l.a.Ec(z))}}this.zwa(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,H)}}t?(this.bhc(e[y],
this.ced),this.bhc(e[y],this.zig)):(this.bhc(e[y],this.ACd),this.bhc(e[y],this.Big))}$ia(){this.JA||(this.JA=[],this.$.vte(this.Kyc),this.$.wantServerEvents=!0)}bhc(m,u){m in u||(u[m]=0);u[m]+=1}mH(m,u,t){const y={};y.Target=u;y.Category=65536;y.Type=m;y.Message=t;y.Id=-1;this.GOe(y,!1)}HLh(m,u){const t={Target:"",Category:2,Type:1E3};t.Message=u;t.Id=0;u=Array(1);u[0]=x.sec(t,!1);this.vdj(m,u)}vbc(m,u,t,y){const v={};v.Target=t;v.Category=65536;v.Type=u;v.Message=y;v.Id=-1;u=Array(1);u[0]=x.sec(v,
!1);this.zwa(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}GLh(m,u){this.zwa(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}zwa(m,u,t,y){if(this.JA){var v=Object(b.a)(h.DdaFacade,d.a(this.$));if(!v||u!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&u!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||v.Gh.c2b(m)){m=new f.a(u,m,t,y);for(let A=0,z=this.JA.length;A<z;A++)(u=this.JA[A])&&u(m)}}}static sec(m,u){const t=Array(6);t[0]=m.Category;t[1]=m.Type;t[2]=m.Target;t[3]=m.Message;
t[4]=m.Id;t[5]=u;return t}}Object(r.a)(x,"DdaEventDispatch",null,[])},1429:function(r,B,a){a.d(B,"a",function(){return b});r=a(0);B=a(156);var c=a(92);class b extends B.a{constructor(){super(void 0,void 0,void 0,!0);this.gEa="AddinCommandsUILessDialog";this.PVc="WACDialogTitleText";this.DX="0";this.CG=380;this.z1=190;this.we=this.gEa;this.Rb=5;this.Vxg=String.format("{0}px",this.CG);this.CX=String.format("{0}px",this.z1);this.Kcf=this.yt=!1;this.Tw()}Tw(){super.Tw();this.Th.style.width=this.Vxg;this.Th.style.height=
this.CX;this.Th.style.padding=this.DX}xy(e){this.LD();document.getElementById(this.Oh(this.PVc)).innerText=e}LD(){super.LD();this.ib.style.width=String.format("{0}px",this.CG);this.ib.style.height=String.format("{0}px",this.z1);this.ib.removeAttribute(c.a.Jd);this.ib.removeAttribute(c.a.dM)}hide(){this.Wzb()}get taa(){return this.Th}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(r.a)(b,"AddinCommandsUILessDialog",B.a,[901])},1460:function(r,
B,a){a.r(B);var c=a(517),b=a(980),e=a(1222),f=a(9),d=a(0),h=a(228),l=a(197),k=a(596);class w{constructor(){this.kib=null}get PYg(){this.kib||(this.kib=new l.a,this.kib.add(12),this.kib.add(11));return this.kib}nqi(K){return this.PYg.contains(K.operation)}U1j(K){const Ia=[],Db=K.payload;for(const dc of Db.batchedOperations)Ia.push(new k.a(K.operation,dc));return Ia}}Object(d.a)(w,"MacroRecorderBatchedEventList",null,[]);var n=a(15),x=a(59),m=a(128),u=a(653);class t{equals(K,Ia){return K===Ia}getHashCode(K){return K}cka(K){return K}}
Object(d.a)(t,"UserOperationNameComparer",null,[102,103]);class y{static zai(){y.Tc||(y.Tc=new u.a(new t),y.Tc.add(507),y.Tc.add(10),y.Tc.add(576),y.Tc.add(563),y.Tc.add(564),y.Tc.add(565),y.Tc.add(566),y.Tc.add(567),y.Tc.add(568),y.Tc.add(569),y.Tc.add(570),y.Tc.add(571),y.Tc.add(572),y.Tc.add(573),y.Tc.add(574),y.Tc.add(575),y.Tc.add(501),y.Tc.add(520),y.Tc.add(1),y.Tc.add(1002),y.Tc.add(129),y.Tc.add(198),y.Tc.add(500),y.Tc.add(519),y.Tc.add(538),y.Tc.add(1E3),y.Tc.add(1003),y.Tc.add(144),y.Tc.add(502),
y.Tc.add(505),y.Tc.add(179),y.Tc.add(205),y.Tc.add(134),y.Tc.add(230),y.Tc.add(103),y.Tc.add(110),y.Tc.add(112),y.Tc.add(113),y.Tc.add(124),y.Tc.add(133),y.Tc.add(154),y.Tc.add(162),y.Tc.add(168),y.Tc.add(172),y.Tc.add(201),y.Tc.add(222),y.Tc.add(227),y.Tc.add(513),y.Tc.add(534),y.Tc.add(539),y.Tc.add(545),y.Tc.add(600),y.Tc.add(547),y.Tc.add(555),y.Tc.add(558),y.Tc.add(562),y.Tc.add(585),y.Tc.add(1001),y.Tc.add(1005),y.Tc.add(1008),y.Tc.add(1010),y.Tc.add(1011),y.Tc.add(1012),y.Tc.add(1018),y.Tc.add(1029),
y.Tc.add(252),y.Tc.add(253),y.Tc.add(258),y.Tc.add(101),y.Tc.add(102),y.Tc.add(108),y.Tc.add(257),y.Tc.add(119),y.Tc.add(120),y.Tc.add(123),y.Tc.add(126),y.Tc.add(127),y.Tc.add(130),y.Tc.add(140),y.Tc.add(159),y.Tc.add(160),y.Tc.add(165),y.Tc.add(166),y.Tc.add(167),y.Tc.add(169),y.Tc.add(189),y.Tc.add(223),y.Tc.add(214),y.Tc.add(228),y.Tc.add(233),y.Tc.add(247),y.Tc.add(504),y.Tc.add(511),y.Tc.add(512),y.Tc.add(525),y.Tc.add(533),y.Tc.add(537),y.Tc.add(542),y.Tc.add(544),y.Tc.add(548),y.Tc.add(550),
y.Tc.add(551),y.Tc.add(552),y.Tc.add(554),y.Tc.add(577),y.Tc.add(584),y.Tc.add(586),y.Tc.add(587),y.Tc.add(588),y.Tc.add(592),y.Tc.add(1009),y.Tc.add(1016),y.Tc.add(1017));return y.Tc}}y.Tc=null;Object(d.a)(y,"MacroRecorderUnrecognizedEventList",null,[]);class v{constructor(K,Ia,Db){this.jwb=null;this.dKi=(dc,xc)=>{this.cag()&&this.$dd(xc)};this.Kwf=Ia;this.Jwf=Db;this.$=K;this.$.bR&&this.$.dRg(this.dKi);K.da.Ha(297,this)}init(K){this.$.bR&&(K?this.jwb=K:n.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}$dd(K){if(this.cag())try{if(this.Jwf.nqi(K)){var Ia=
this.Jwf.U1j(K);for(const Db of Ia)this.c_e(Db)}else this.c_e(K)}catch(Db){Ia=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${m.a(K.operation)}, Exception: ${Db.stack}`;n.ULS.sendTraceTag(537155423,0,10,Ia);try{this.ELh(K)}catch(dc){}}}c_e(K){var Ia=this.Kwf.B6e(K,!0);Ia?(this.jwb(Ia.eventId,x.a.Ec(K.payload)),n.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ia.eventId}`)):(Ia=this.Kwf.B6e(K,!1))?n.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ia.eventId}, but failed to match filters`):
y.zai().contains(K.operation)||(this.jwb(0,x.a.Ec(K.operation)),K=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${m.a(K.operation)}`,n.ULS.sendTraceTag(537155420,0,50,K))}ELh(K){this.jwb(222,x.a.Ec(K.operation))}cag(){return this.$.Bla&&this.jwb&&this.$.Uba?!0:!1}}Object(d.a)(v,"MacroRecorderEventHandler",null,[874]);var A=a(1);class z{constructor(){this.MLc=this.NLc=this.MRc=this.lWc=null}get operations(){this.MRc||(this.MRc=new l.a,this.dc());return this.MRc}get gGc(){this.lWc||
(this.lWc=new l.a,this.ag());return this.lWc}get KYe(){this.MLc||(this.MLc=new l.a);return this.MLc}get featureGates(){this.NLc||(this.NLc=new l.a,this.Ywa());return this.NLc}ag(){}Ywa(){}ud(K){this.gGc.add(K)}Sb(K){this.operations.contains(K)||this.operations.add(K)}Vob(){this.featureGates.add(585)}zqe(K){this.KYe.add(K)}}Object(d.a)(z,"MacroRecorderEventBase",null,[]);class C extends z{constructor(){super()}get eventId(){return 130}dc(){this.Sb(100)}}Object(d.a)(C,"AccessibilityCheckRunEvent",z,
[]);class H extends z{constructor(){super()}get eventId(){return 160}dc(){this.Sb(241)}ag(){this.ud(K=>K.addToPrintArea)}}Object(d.a)(H,"AddedToPrintAreaEvent",z,[]);class I extends z{constructor(){super()}get eventId(){return 65}dc(){this.Sb(516)}}Object(d.a)(I,"AutoFilterToggledEvent",z,[]);class S extends z{constructor(){super()}get eventId(){return 118}dc(){this.Sb(502)}ag(){this.ud(K=>!(K.H5a().FirstColumn===K.H5a().LastColumn&&K.H5a().FirstRow===K.H5a().LastRow))}}Object(d.a)(S,"AutoSumEvent",
z,[]);class P extends z{constructor(K,Ia){super();this.Hfa=K;this.F9j=Ia}get eventId(){return this.Hfa}dc(){this.Sb(529);this.Sb(594)}ag(){this.ud(K=>this.F9j.includes(K.tjd()))}}Object(d.a)(P,"ChartPropertyAppliedEventBase",z,[]);class D extends P{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(d.a)(D,"ChartAxisChangedEvent",P,[]);class G extends P{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(d.a)(G,"ChartAxisTitleChangedEvent",
P,[]);class E extends P{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(d.a)(E,"ChartDataLabelsChangedEvent",P,[]);class O extends P{constructor(){super(76,[-100])}}Object(d.a)(O,"ChartDataSelectedEvent",P,[]);class N extends P{constructor(){super(83,[500,501,502])}}Object(d.a)(N,"ChartDataTableChangedEvent",P,[]);var J=a(559),W=a(424),ea=a(87);class R extends z{constructor(){super()}}Object(d.a)(R,"RichApiRequestExecutedEventBase",z,[]);class Y{constructor(K,Ia,Db){this.response=
this.request=this.eventId=this.source=null;K&&(this.source=K.source,this.eventId=K.eventId,this.request=Ia,this.response=Db)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(d.a)(Y,"MacroRecorderRichApiRequestExecutedPayload",null,[123]);class U extends R{constructor(){super()}get eventId(){return 117}Dw(K){U.Y6||(U.Y6=new u.a(J.a.li()),U.Y6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),U.Y6.add("fa000000014"));return!!K&&U.Y6.contains(K.toLowerCase())}dc(){this.Sb(507);
this.Sb(10);this.Sb(576)}ag(){this.ud(K=>Object(W.a)(Y,K)&&(K=Object(ea.a)(Y,K),K.isValid&&this.Dw(K.source))?(n.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${K.eventId}`),!0):!1)}}U.Y6=null;Object(d.a)(U,"ChartFormatRichApiRequestExecutedEvent",R,[]);class da extends P{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(d.a)(da,"ChartGridlinesChangedEvent",P,[]);class T extends z{constructor(){super()}get eventId(){return 66}dc(){this.Sb(528)}}
Object(d.a)(T,"ChartInsertedEvent",z,[]);class ka extends P{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(d.a)(ka,"ChartLegendChangedEvent",P,[]);class L extends P{constructor(){super(75,[-101])}}Object(d.a)(L,"ChartRowColumnSwitchedEvent",P,[]);class fa extends P{constructor(){super(79,[0,1,2,-102])}}Object(d.a)(fa,"ChartTitleChangedEvent",P,[]);class wa extends P{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,
-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(d.a)(wa,"ChartTypeChangedEvent",P,[]);class oa extends z{constructor(){super()}get eventId(){return 131}dc(){this.Sb(521)}}Object(d.a)(oa,"ConnectorFloatingObjectResizedEvent",z,[]);class xa extends z{constructor(){super()}get eventId(){return 129}dc(){this.Sb(109)}}Object(d.a)(xa,"EntitySelectedEvent",z,[]);class bb extends z{constructor(){super()}get eventId(){return 49}dc(){this.Sb(149);this.Sb(147)}}Object(d.a)(bb,"FindCellEvent",
z,[]);class Za extends z{constructor(){super()}get eventId(){return 96}dc(){this.Sb(122)}}Object(d.a)(Za,"FloatingObjectAltTextAppliedEvent",z,[]);class La extends z{constructor(){super()}get eventId(){return 93}dc(){this.Sb(522)}}Object(d.a)(La,"FloatingObjectDeletedEvent",z,[]);class va extends z{constructor(){super()}get eventId(){return 94}dc(){this.Sb(524)}}Object(d.a)(va,"FloatingObjectMovedAndResizedEvent",z,[]);class Ba extends z{constructor(){super()}get eventId(){return 95}dc(){this.Sb(523)}}
Object(d.a)(Ba,"FloatingObjectRotatedEvent",z,[]);class Ea extends z{constructor(){super()}get eventId(){return 100}dc(){this.Sb(543)}}Object(d.a)(Ea,"GroupDetailsShownOrHiddenEvent",z,[]);class pa extends z{constructor(){super()}get eventId(){return 154}dc(){this.Sb(125)}}Object(d.a)(pa,"HyperlinksRemovedFromRangeEvent",z,[]);class $a extends R{constructor(){super()}get eventId(){return 125}Dw(K){$a.Y6||($a.Y6=new u.a(J.a.li()),$a.Y6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),$a.Y6.add("fa000000005"));
return!!K&&$a.Y6.contains(K.toLowerCase())}dc(){this.Sb(507);this.Sb(10);this.Sb(576)}ag(){this.ud(K=>Object(W.a)(Y,K)?(K=Object(ea.a)(Y,K),K.isValid&&this.Dw(K.source)):!1)}}$a.Y6=null;Object(d.a)($a,"IdeasRichApiRequestExecutedEvent",R,[]);class cb extends z{constructor(){super()}get eventId(){return 136}dc(){this.Sb(115)}}Object(d.a)(cb,"LinkedEntityConvertedEvent",z,[]);class ib extends z{constructor(){super()}get eventId(){return 148}dc(){this.Sb(114)}}Object(d.a)(ib,"LinkedEntityDisambiguationPaneToggledEvent",
z,[]);class ta extends z{constructor(){super()}get eventId(){return 127}dc(){this.Sb(119)}}Object(d.a)(ta,"MovedToEdgeEvent",z,[]);class Ya extends z{constructor(){super()}get eventId(){return 135}dc(){this.Sb(191)}Ywa(){this.Vob()}}Object(d.a)(Ya,"NamedSheetViewCreatedEvent",z,[]);class Da extends z{constructor(){super()}get eventId(){return 166}dc(){this.Sb(200)}Ywa(){this.Vob()}}Object(d.a)(Da,"NamedSheetViewDeletedEvent",z,[]);class ba extends z{constructor(){super()}get eventId(){return 133}dc(){this.Sb(192)}Ywa(){this.Vob()}}
Object(d.a)(ba,"NamedSheetViewExitedEvent",z,[]);class ya extends z{constructor(){super()}get eventId(){return 162}dc(){this.Sb(199)}Ywa(){this.Vob()}}Object(d.a)(ya,"NamedSheetViewRenamedEvent",z,[]);class V extends z{constructor(){super()}get eventId(){return 167}dc(){this.Sb(195)}Ywa(){this.Vob()}}Object(d.a)(V,"NamedSheetViewSwitchedEvent",z,[]);class Z extends z{constructor(){super()}get eventId(){return 99}dc(){this.Sb(174)}}Object(d.a)(Z,"OutlineLevelSetEvent",z,[]);class ja extends z{constructor(){super()}get eventId(){return 156}dc(){this.Sb(244)}}
Object(d.a)(ja,"PageBreakInsertedEvent",z,[]);class la extends z{constructor(){super()}get eventId(){return 157}dc(){this.Sb(245)}}Object(d.a)(la,"PageBreakRemovedEvent",z,[]);class ua extends z{constructor(){super()}get eventId(){return 158}dc(){this.Sb(246)}}Object(d.a)(ua,"PageBreaksAllResetEvent",z,[]);class eb extends z{constructor(){super()}get eventId(){return 112}dc(){this.Sb(503)}ag(){this.ud(K=>!!K.pasteParameters.ClientEstimationFloatingObjectId&&2===K.pasteParameters.CopyPasteTargetType&&
!K.isFromCurrentSession)}}Object(d.a)(eb,"PasteArtOtherWorkbookEvent",z,[]);class Eb extends z{constructor(){super()}get eventId(){return 52}dc(){this.Sb(503)}ag(){this.ud(K=>!!K.pasteParameters.ClientEstimationFloatingObjectId&&2===K.pasteParameters.CopyPasteTargetType&&K.isFromCurrentSession)}}Object(d.a)(Eb,"PasteArtSameWorkbookEvent",z,[]);class Wb extends z{constructor(){super()}get eventId(){return 110}dc(){this.Sb(204)}}Object(d.a)(Wb,"PasteHtmlEvent",z,[]);class Ab extends z{constructor(){super()}get eventId(){return 35}dc(){this.Sb(506)}}
Object(d.a)(Ab,"PasteRangeEvent",z,[]);class Jb extends z{constructor(){super()}get eventId(){return 111}dc(){this.Sb(503)}ag(){this.ud(K=>1===K.pasteParameters.CopyPasteTargetType)}}Object(d.a)(Jb,"PasteShadowWorkbookRangeEvent",z,[]);class Gb extends z{constructor(){super()}get eventId(){return 42}dc(){this.Sb(180)}}Object(d.a)(Gb,"PasteStringEvent",z,[]);class Nb extends z{constructor(){super()}get eventId(){return 134}dc(){this.Sb(220)}}Object(d.a)(Nb,"PendingMergeEvent",z,[]);class Ja extends z{constructor(){super()}get eventId(){return 122}dc(){this.Sb(510)}}
Object(d.a)(Ja,"PictureInsertedEvent",z,[]);class ab extends z{constructor(){super()}get eventId(){return 153}dc(){this.Sb(161)}}Object(d.a)(ab,"PivotDrillToggledEvent",z,[]);class wb extends z{constructor(K,Ia){super();this.Hfa=K;this.opType=Ia}get eventId(){return this.Hfa}dc(){this.Sb(225)}ag(){this.ud(K=>K.opType===this.opType)}}Object(d.a)(wb,"PivotTableSettingsChangedEventBase",z,[]);class xb extends wb{constructor(){super(171,4)}}Object(d.a)(xb,"PivotTableAllItemLabelsRepeatedEvent",wb,[]);
class rb extends wb{constructor(){super(184,17)}}Object(d.a)(rb,"PivotTableAltTextDescriptionChangedEvent",wb,[]);class za extends wb{constructor(){super(183,16)}}Object(d.a)(za,"PivotTableAltTextTitleChangedEvent",wb,[]);class Aa extends wb{constructor(){super(173,6)}}Object(d.a)(Aa,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",wb,[]);class pb extends wb{constructor(){super(172,5)}}Object(d.a)(pb,"PivotTableBlankLineAfterEachItemToggledEvent",wb,[]);class kb extends wb{constructor(){super(170,
3)}}Object(d.a)(kb,"PivotTableColumnGrandTotalShownEvent",wb,[]);class Cb extends z{constructor(){super()}get eventId(){return 98}dc(){this.Sb(132)}}Object(d.a)(Cb,"PivotTableCreatedEvent",z,[]);class ob extends wb{constructor(){super(177,10)}}Object(d.a)(ob,"PivotTableDisplayErrorStringToggledEvent",wb,[]);class qa extends wb{constructor(){super(178,11)}}Object(d.a)(qa,"PivotTableDisplayNullStringToggledEvent",wb,[]);class ma extends wb{constructor(){super(179,12)}}Object(d.a)(ma,"PivotTableErrorStringChangedEvent",
wb,[]);class Ga extends wb{constructor(){super(174,7)}}Object(d.a)(Ga,"PivotTableExpandCollapseButtonsShownEvent",wb,[]);class vb extends wb{constructor(){super(187,20)}}Object(d.a)(vb,"PivotTableIndentChangedEvent",wb,[]);class Ka extends wb{constructor(){super(176,9)}}Object(d.a)(Ka,"PivotTableItemsWithNoDataOnColumnsShownEvent",wb,[]);class Pa extends wb{constructor(){super(175,8)}}Object(d.a)(Pa,"PivotTableItemsWithNoDataOnRowsShownEvent",wb,[]);class fb extends wb{constructor(){super(186,19)}}
Object(d.a)(fb,"PivotTableLayoutTypeSetEvent",wb,[]);class Wa extends wb{constructor(){super(180,13)}}Object(d.a)(Wa,"PivotTableNullStringChangedEvent",wb,[]);class Ma extends z{constructor(){super()}get eventId(){return 149}dc(){this.Sb(219)}}Object(d.a)(Ma,"PivotTablePivotLocationChangedEvent",z,[]);class lb extends z{constructor(){super()}get eventId(){return 102}dc(){this.Sb(145)}}Object(d.a)(lb,"PivotTablePivotedEvent",z,[]);class Na extends wb{constructor(){super(182,15)}}Object(d.a)(Na,"PivotTableRefreshDataOnLoadToggledEvent",
wb,[]);class X extends z{constructor(){super()}get eventId(){return 104}dc(){this.Sb(50)}ag(){this.ud(K=>!!K.pivotTableId&&!!K.pivotTableName)}}Object(d.a)(X,"PivotTableRefreshedEvent",z,[]);class F extends wb{constructor(){super(168,1)}}Object(d.a)(F,"PivotTableRenamedEvent",wb,[]);class na extends wb{constructor(){super(169,2)}}Object(d.a)(na,"PivotTableRowGrandTotalShownEvent",wb,[]);class hb extends wb{constructor(){super(181,14)}}Object(d.a)(hb,"PivotTableSaveSourceDataWithFileToggledEvent",
wb,[]);var Ib=a(616);class vc extends z{constructor(){super()}get eventId(){return 155}dc(){this.Sb(131)}ag(){this.ud(K=>{K=Object(ea.a)(Ib.a,K);return!!K&&!!K.jLa()&&!!K.hierarchyName})}}Object(d.a)(vc,"PivotTableSortedEvent",z,[]);class nc extends wb{constructor(){super(185,18)}}Object(d.a)(nc,"PivotTableSubTotalsVisibilitySettingSetEvent",wb,[]);class Pb extends z{constructor(){super()}get eventId(){return 206}dc(){this.Sb(560)}}Object(d.a)(Pb,"PivotValueFieldSettingAppliedEvent",z,[]);class oc extends z{constructor(){super()}get eventId(){return 161}dc(){this.Sb(243)}}
Object(d.a)(oc,"PrintAreaClearedEvent",z,[]);class Ic extends z{constructor(){super()}get eventId(){return 159}dc(){this.Sb(241)}ag(){this.ud(K=>!K.addToPrintArea)}}Object(d.a)(Ic,"PrintAreaSetEvent",z,[]);class ec extends z{constructor(){super()}get eventId(){return 57}dc(){this.Sb(517)}}Object(d.a)(ec,"RangeAutoFilterClearedEvent",z,[]);class mb extends z{constructor(K,Ia){super();this.Hfa=K;this.S2d=Ia}get eventId(){return this.Hfa}dc(){this.Sb(11)}ag(){this.ud(K=>16===K.yZ().ValidMembers);this.ud(K=>
K.yZ().Font.ValidMembers===this.S2d)}}Object(d.a)(mb,"RangeFontFormattedEventBase",z,[]);class Ob extends mb{constructor(){super(3,4)}}Object(d.a)(Ob,"RangeBoldedEvent",mb,[]);class Ta extends z{constructor(){super()}get eventId(){return 2}dc(){this.Sb(11)}ag(){this.ud(K=>128===K.yZ().ValidMembers)}}Object(d.a)(Ta,"RangeBorderedEvent",z,[]);class sb{}sb.Qab="Table";sb.csc="Sheet";Object(d.a)(sb,"MacroRecorderEventConstants",null,[]);class zb extends z{constructor(){super()}get eventId(){return 113}dc(){this.Sb(208)}ag(){this.ud(K=>
K.getParameters().FilterType===sb.csc)}}Object(d.a)(zb,"RangeCheckedItemsFilteredEvent",z,[]);class db extends z{constructor(){super()}get eventId(){return 109}dc(){this.Sb(105)}}Object(d.a)(db,"RangeConditionalFormattingCreatedEvent",z,[]);class jb extends z{constructor(){super()}get eventId(){return 124}dc(){this.Sb(221)}}Object(d.a)(jb,"RangeConditionalFormattingRuleDeletedEvent",z,[]);class Ub extends z{constructor(){super()}get eventId(){return 29}dc(){this.Sb(508)}ag(){this.ud(K=>3===K.tt()||
1===K.tt()||4===K.tt())}}Object(d.a)(Ub,"RangeContentClearedEvent",z,[]);class xd extends z{constructor(){super()}get eventId(){return 40}dc(){this.Sb(104)}}Object(d.a)(xd,"RangeCopiedCutCellsInsertedEvent",z,[]);class ne extends z{constructor(){super()}get eventId(){return 114}dc(){this.Sb(209)}ag(){this.ud(K=>K.getParameters().FilterType===sb.csc)}}Object(d.a)(ne,"RangeCustomFilteredEvent",z,[]);class fe extends z{constructor(){super()}get eventId(){return 106}dc(){this.Sb(121)}}Object(d.a)(fe,
"RangeDataValidationChangedEvent",z,[]);class Bd extends mb{constructor(){super(4,64)}}Object(d.a)(Bd,"RangeDoubleUnderlinedEvent",mb,[]);class Ue extends z{constructor(){super()}get eventId(){return 69}dc(){this.Sb(190)}}Object(d.a)(Ue,"RangeDuplicatesRemovedEvent",z,[]);class mc extends z{constructor(){super()}get eventId(){return 1}dc(){this.Sb(527);this.Sb(12)}}Object(d.a)(mc,"RangeEditedEvent",z,[]);class Fc extends z{constructor(){super()}get eventId(){return 164}dc(){this.Sb(255)}ag(){this.ud(K=>
4===K.actionType)}}Object(d.a)(Fc,"RangeExternalLinksBrokeAllLinksEvent",z,[]);class bd extends z{constructor(){super()}get eventId(){return 119}dc(){this.Sb(255)}ag(){this.ud(K=>3===K.actionType)}}Object(d.a)(bd,"RangeExternalLinksBrokeLinkEvent",z,[]);class de extends z{constructor(){super()}get eventId(){return 205}dc(){this.Sb(256)}Ywa(){this.zqe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(d.a)(de,"RangeExternalLinksChangeSourceEvent",z,[]);class Md extends z{constructor(){super()}get eventId(){return 163}dc(){this.Sb(553)}ag(){this.ud(K=>
1===K.actionType)}}Object(d.a)(Md,"RangeExternalLinksRefreshedAllEvent",z,[]);class se extends z{constructor(){super()}get eventId(){return 77}dc(){this.Sb(553)}ag(){this.ud(K=>0===K.actionType)}}Object(d.a)(se,"RangeExternalLinksRefreshedEvent",z,[]);class tc extends z{constructor(){super()}get eventId(){return 165}dc(){this.Sb(224)}}Object(d.a)(tc,"RangeExternalLinksSetAutoRefreshEvent",z,[]);class dd extends z{constructor(){super()}get eventId(){return 5}dc(){this.Sb(11)}ag(){this.ud(K=>64===K.yZ().ValidMembers)}}
Object(d.a)(dd,"RangeFillColoredEvent",z,[]);class Hd extends z{constructor(){super()}get eventId(){return 59}dc(){this.Sb(155)}}Object(d.a)(Hd,"RangeFilledEvent",z,[]);class Xc extends z{constructor(){super()}get eventId(){return 115}dc(){this.Sb(176)}ag(){this.ud(K=>K.YU().AutoFilterType===sb.csc&&!!K.YU().CriteriaType)}}Object(d.a)(Xc,"RangeFilterAppliedEvent",z,[]);class gd extends z{constructor(){super()}get eventId(){return 58}dc(){this.Sb(176)}ag(){this.ud(K=>K.YU().AutoFilterType===sb.csc&&
!K.YU().CriteriaType)}}Object(d.a)(gd,"RangeFilterClearedEvent",z,[]);class je extends z{constructor(){super()}get eventId(){return 41}dc(){this.Sb(518)}}Object(d.a)(je,"RangeFilterReappliedEvent",z,[]);class Ee extends z{constructor(){super()}get eventId(){return 86}dc(){this.Sb(150)}}Object(d.a)(Ee,"RangeFlashFilledEvent",z,[]);class ae extends mb{constructor(){super(6,32)}}Object(d.a)(ae,"RangeFontColoredEvent",mb,[]);class Yb extends mb{constructor(){super(7,8)}}Object(d.a)(Yb,"RangeFontItalicizedEvent",
mb,[]);class Sc extends mb{constructor(){super(8,1)}}Object(d.a)(Sc,"RangeFontNamedEvent",mb,[]);class qd extends mb{constructor(){super(9,2)}}Object(d.a)(qd,"RangeFontSizedEvent",mb,[]);class Id extends z{constructor(){super()}get eventId(){return 74}dc(){this.Sb(215)}}Object(d.a)(Id,"RangeFormattedAsTableEvent",z,[]);class ic extends z{constructor(){super()}get eventId(){return 97}dc(){this.Sb(188)}}Object(d.a)(ic,"RangeGroupedOrUngroupedEvent",z,[]);class Gc extends z{constructor(){super()}get eventId(){return 60}dc(){this.Sb(11)}ag(){this.ud(K=>
2===K.yZ().ValidMembers)}}Object(d.a)(Gc,"RangeHorizontallyAlignedEvent",z,[]);class jd extends z{constructor(){super()}get eventId(){return 43}dc(){this.Sb(526)}}Object(d.a)(jd,"RangeHyperlinkAppliedEvent",z,[]);class ed extends z{constructor(){super()}get eventId(){return 63}dc(){this.Sb(11)}ag(){this.ud(K=>256===K.yZ().ValidMembers)}}Object(d.a)(ed,"RangeIndentChangedEvent",z,[]);class Qd extends z{constructor(){super()}get eventId(){return 53}dc(){this.Sb(156)}ag(){this.ud(K=>2===K.tt()||5===
K.tt()||6===K.tt()||7===K.tt())}}Object(d.a)(Qd,"RangeMergedEvent",z,[]);class te extends z{constructor(){super()}get eventId(){return 107}dc(){this.Sb(216)}}Object(d.a)(te,"RangeNamedCellStyleAppliedEvent",z,[]);class xe extends z{constructor(){super()}get eventId(){return 12}dc(){this.Sb(11)}ag(){this.ud(K=>32===K.yZ().ValidMembers)}}Object(d.a)(xe,"RangeNumberFormattedEvent",z,[]);var He=a(982);class We extends z{constructor(){super()}get eventId(){return 108}dc(){this.Sb(141)}ag(){this.ud(K=>
Object(W.a)(He.a,K))}}Object(d.a)(We,"RangeSortedEvent",z,[]);class ye extends mb{constructor(){super(10,128)}}Object(d.a)(ye,"RangeStrikedThroughEvent",mb,[]);class $e extends mb{constructor(){super(11,16)}}Object(d.a)($e,"RangeUnderlinedEvent",mb,[]);class jf extends z{constructor(){super()}get eventId(){return 61}dc(){this.Sb(11)}ag(){this.ud(K=>1===K.yZ().ValidMembers)}}Object(d.a)(jf,"RangeVerticallyAlignedEvent",z,[]);class gf extends z{constructor(){super()}get eventId(){return 62}dc(){this.Sb(11)}ag(){this.ud(K=>
8===K.yZ().ValidMembers)}}Object(d.a)(gf,"RangeWrapTextToggledEvent",z,[]);class rf extends z{constructor(){super()}get eventId(){return 103}dc(){this.Sb(51)}}Object(d.a)(rf,"RefreshedAllEvent",z,[]);class Mf extends z{constructor(){super()}get eventId(){return 47}dc(){this.Sb(148)}}Object(d.a)(Mf,"ReplaceAllEvent",z,[]);class Qa extends z{constructor(){super()}get eventId(){return 91}dc(){this.Sb(532)}ag(){this.ud(K=>95!==K.getShapeType()&&96!==K.getShapeType()&&97!==K.getShapeType()&&98!==K.getShapeType()&&
100!==K.getShapeType()&&102!==K.getShapeType()&&103!==K.getShapeType())}}Object(d.a)(Qa,"ShapeInsertedEvent",z,[]);class Zb extends z{constructor(){super()}get eventId(){return 92}dc(){this.Sb(531)}}Object(d.a)(Zb,"ShapeStyleSetEvent",z,[]);var nb=a(836);class Tb extends z{constructor(K,Ia){super();this.Hfa=K;this.S2d=Ia}get eventId(){return this.Hfa}dc(){this.Sb(581)}ag(){this.ud(K=>Object(W.a)(nb.a,K)&&4===K.getShapeTextFormat().ValidMembers);this.ud(K=>Object(W.a)(nb.a,K)&&K.getShapeTextFormat().Font.ValidMembers===
this.S2d)}}Object(d.a)(Tb,"ShapeTextFontFormattedEventBase",z,[]);class qb extends Tb{constructor(){super(193,4)}}Object(d.a)(qb,"ShapeTextBoldedEvent",Tb,[]);var Kb=a(984);class jc extends z{constructor(){super()}get eventId(){return 191}dc(){this.Sb(581)}ag(){this.ud(K=>Object(W.a)(Kb.a,K))}}Object(d.a)(jc,"ShapeTextChangedEvent",z,[]);class Ac extends Tb{constructor(){super(196,32)}}Object(d.a)(Ac,"ShapeTextFontColorChangedEvent",Tb,[]);class Jc extends Tb{constructor(){super(197,1)}}Object(d.a)(Jc,
"ShapeTextFontNameChangedEvent",Tb,[]);class hd extends Tb{constructor(){super(198,2)}}Object(d.a)(hd,"ShapeTextFontSizeChangedEvent",Tb,[]);class Cd extends z{constructor(){super()}get eventId(){return 199}dc(){this.Sb(581)}ag(){this.ud(K=>Object(W.a)(nb.a,K)&&2===K.getShapeTextFormat().ValidMembers)}}Object(d.a)(Cd,"ShapeTextHorizontallyAlignedEvent",z,[]);class ac extends Tb{constructor(){super(194,8)}}Object(d.a)(ac,"ShapeTextItalicizedEvent",Tb,[]);class Lc extends Tb{constructor(){super(195,
16)}}Object(d.a)(Lc,"ShapeTextUnderlinedEvent",Tb,[]);class rd extends z{constructor(){super()}get eventId(){return 200}dc(){this.Sb(581)}ag(){this.ud(K=>Object(W.a)(nb.a,K)&&1===K.getShapeTextFormat().ValidMembers)}}Object(d.a)(rd,"ShapeTextVerticallyAlignedEvent",z,[]);class Yd extends z{constructor(){super()}get eventId(){return 13}dc(){this.Sb(138)}}Object(d.a)(Yd,"SheetAddedEvent",z,[]);var ie=a(8);class Je extends z{constructor(){super()}get eventId(){return 142}dc(){this.Sb(237)}ag(){this.ud(K=>
!!K.insertDeleteMultiRangeParameters);this.ud(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>{K=K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>K.DeltaColumn&&!K.DeltaRow&&(!!K.InsertDeleteRange.FirstRow||K.InsertDeleteRange.LastRow!==ie.a.iB)||!K.DeltaColumn&&0>K.DeltaRow&&(!!K.InsertDeleteRange.FirstColumn||K.InsertDeleteRange.LastColumn!==ie.a.ky)})}}Object(d.a)(Je,"SheetCellsDeletedEvent",z,[]);class ff extends z{constructor(){super()}get eventId(){return 143}dc(){this.Sb(237)}ag(){this.ud(K=>
!!K.insertDeleteMultiRangeParameters);this.ud(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>{K=K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<K.DeltaColumn&&!K.DeltaRow&&(!!K.InsertDeleteRange.FirstRow||K.InsertDeleteRange.LastRow!==ie.a.iB)||!K.DeltaColumn&&0<K.DeltaRow&&(!!K.InsertDeleteRange.FirstColumn||K.InsertDeleteRange.LastColumn!==ie.a.ky)})}}Object(d.a)(ff,"SheetCellsInsertedEvent",z,[]);class Ae extends z{constructor(){super()}get eventId(){return 139}dc(){this.Sb(237)}ag(){this.ud(K=>
!!K.insertDeleteMultiRangeParameters);this.ud(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.ud(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===ie.a.iB)}}Object(d.a)(Ae,"SheetColumnDeletedEvent",
z,[]);class pf extends z{constructor(){super()}get eventId(){return 138}dc(){this.Sb(237)}ag(){this.ud(K=>!!K.insertDeleteMultiRangeParameters);this.ud(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.ud(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
ie.a.iB)}}Object(d.a)(pf,"SheetColumnInsertedEvent",z,[]);class he extends z{constructor(){super()}get eventId(){return 14}dc(){this.Sb(137)}}Object(d.a)(he,"SheetDeletedEvent",z,[]);class Va extends z{constructor(){super()}get eventId(){return 137}dc(){this.Sb(185)}}Object(d.a)(Va,"SheetDirectionChangedEvent",z,[]);class bc extends z{constructor(){super()}get eventId(){return 54}dc(){this.Sb(139)}}Object(d.a)(bc,"SheetDuplicatedEvent",z,[]);class yc extends z{constructor(){super()}get eventId(){return 15}dc(){this.Sb(207)}}
Object(d.a)(yc,"SheetNameEditedEvent",z,[]);class Hc extends z{constructor(){super()}get eventId(){return 90}dc(){this.Sb(151)}}Object(d.a)(Hc,"SheetPaneFrozenEvent",z,[]);class Zc extends z{constructor(){super()}get eventId(){return 120}dc(){this.Sb(226)}}Object(d.a)(Zc,"SheetPrintSettingsSavedEvent",z,[]);var Sd=a(881);class ue extends z{constructor(){super()}get eventId(){return 215}dc(){this.Sb(507)}Ywa(){this.zqe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}ag(){this.ud(K=>Object.getType(K)===
Sd.a)}}Object(d.a)(ue,"SheetProtectionPausedResumedEvent",z,[]);class Fe extends z{constructor(){super()}get eventId(){return 64}dc(){this.Sb(557)}}Object(d.a)(Fe,"SheetReorderedEvent",z,[]);class Be extends z{constructor(){super()}get eventId(){return 141}dc(){this.Sb(237)}ag(){this.ud(K=>!!K.insertDeleteMultiRangeParameters);this.ud(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ud(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.ud(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===ie.a.ky)}}Object(d.a)(Be,"SheetRowDeletedEvent",z,[]);class Ua extends z{constructor(){super()}get eventId(){return 140}dc(){this.Sb(237)}ag(){this.ud(K=>!!K.insertDeleteMultiRangeParameters);this.ud(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.ud(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.ud(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===ie.a.ky)}}Object(d.a)(Ua,"SheetRowInsertedEvent",z,[]);class Rb extends z{constructor(){super()}get eventId(){return 39}dc(){this.Sb(135)}}Object(d.a)(Rb,"SheetRowsColumnsAutoFitEvent",z,[]);class sc extends z{constructor(){super()}get eventId(){return 36}dc(){this.Sb(136)}}
Object(d.a)(sc,"SheetRowsColumnsResizedEvent",z,[]);class Mc extends z{constructor(){super()}get eventId(){return 68}dc(){this.Sb(183)}}Object(d.a)(Mc,"SheetShowGridlinesToggledEvent",z,[]);class id extends z{constructor(){super()}get eventId(){return 67}dc(){this.Sb(184)}}Object(d.a)(id,"SheetShowHeadingsToggledEvent",z,[]);class Ed extends z{constructor(){super()}get eventId(){return 89}dc(){this.Sb(213)}}Object(d.a)(Ed,"SheetSpellCheckedEvent",z,[]);class ee extends z{constructor(){super()}get eventId(){return 70}dc(){this.Sb(515)}}
Object(d.a)(ee,"SheetTabColoredEvent",z,[]);class oe extends z{constructor(){super()}get eventId(){return 71}dc(){this.Sb(157)}}Object(d.a)(oe,"SheetVisibilityChangedEvent",z,[]);class Xe extends z{constructor(){super()}get eventId(){return 126}dc(){this.Sb(239)}}Object(d.a)(Xe,"SheetsVisibilityChangedEvent",z,[]);class mf extends z{constructor(){super()}get eventId(){return 188}dc(){this.Sb(203)}}Object(d.a)(mf,"SlicerInsertedEvent",z,[]);class wf extends z{constructor(){super()}get eventId(){return 189}dc(){this.Sb(173)}ag(){this.ud(K=>
!K.clearFilter)}}Object(d.a)(wf,"SlicerSelectionAppliedEvent",z,[]);class Kf extends z{constructor(){super()}get eventId(){return 190}dc(){this.Sb(173)}ag(){this.ud(K=>K.clearFilter)}}Object(d.a)(Kf,"SlicerSelectionClearedEvent",z,[]);class af extends z{constructor(){super()}get eventId(){return 27}dc(){this.Sb(208)}ag(){this.ud(K=>K.getParameters().FilterType===sb.Qab)}}Object(d.a)(af,"TableCheckedItemsFilteredEvent",z,[]);class Wf extends z{constructor(){super()}get eventId(){return 144}dc(){this.Sb(237)}ag(){this.ud(K=>
!!K.insertDeleteMultiRangeParameters);this.ud(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Wf,"TableColumnDeletedEvent",z,[]);class Gf extends z{constructor(){super()}get eventId(){return 145}dc(){this.Sb(237)}ag(){this.ud(K=>!!K.insertDeleteMultiRangeParameters);this.ud(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);
this.ud(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Gf,"TableColumnInsertedEvent",z,[]);var cg=a(983);class Ha extends z{constructor(){super()}get eventId(){return 121}dc(){this.Sb(141)}ag(){this.ud(K=>Object(W.a)(cg.a,K))}}Object(d.a)(Ha,"TableColumnSortedEvent",z,[]);class yb extends z{constructor(){super()}get eventId(){return 105}dc(){this.Sb(193)}}Object(d.a)(yb,
"TableConvertedToRangeEvent",z,[]);class Xb extends z{constructor(){super()}get eventId(){return 16}dc(){this.Sb(206)}}Object(d.a)(Xb,"TableCreatedEvent",z,[]);class wc extends z{constructor(){super()}get eventId(){return 30}dc(){this.Sb(209)}ag(){this.ud(K=>K.getParameters().FilterType===sb.Qab)}}Object(d.a)(wc,"TableCustomFilteredEvent",z,[]);class Vc extends z{constructor(){super()}get eventId(){return 25}dc(){this.Sb(187)}ag(){this.ud(K=>1===K.options.OperationType)}}Object(d.a)(Vc,"TableCustomSortedEvent",
z,[]);class yd extends z{constructor(){super()}get eventId(){return 28}dc(){this.Sb(176)}ag(){this.ud(K=>K.YU().AutoFilterType===sb.Qab);this.ud(K=>0===K.YU().CriteriaType)}}Object(d.a)(yd,"TableFilterClearedEvent",z,[]);class Od extends z{constructor(){super()}get eventId(){return 32}dc(){this.Sb(176)}ag(){this.ud(K=>K.YU().AutoFilterType===sb.Qab);this.ud(K=>{const Ia=new l.a;Ia.add(1);Ia.add(2);Ia.add(8);Ia.add(9);Ia.add(10);Ia.add(11);Ia.add(12);Ia.add(13);Ia.add(14);Ia.add(15);Ia.add(16);Ia.add(17);
Ia.add(18);Ia.add(19);Ia.add(20);Ia.add(21);Ia.add(22);Ia.add(23);Ia.add(24);Ia.add(25);Ia.add(26);Ia.add(27);Ia.add(28);Ia.add(29);Ia.add(30);Ia.add(31);Ia.add(32);Ia.add(33);Ia.add(34);Ia.add(35);Ia.add(36);Ia.add(37);Ia.add(38);Ia.add(39);return Ia.contains(K.YU().CriteriaType)})}}Object(d.a)(Od,"TableItemFilteredEvent",z,[]);class be extends z{constructor(){super()}get eventId(){return 101}dc(){this.Sb(217)}}Object(d.a)(be,"TableRenamedEvent",z,[]);class Qb extends z{constructor(){super()}get eventId(){return 73}dc(){this.Sb(211)}}
Object(d.a)(Qb,"TableResizedEvent",z,[]);class zc extends z{constructor(){super()}get eventId(){return 44}dc(){this.Sb(514)}}Object(d.a)(zc,"TableRowColumnRearrangedEvent",z,[]);class Yc extends z{constructor(){super()}get eventId(){return 146}dc(){this.Sb(237)}ag(){this.ud(K=>!!K.insertDeleteMultiRangeParameters);this.ud(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ud(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(d.a)(Yc,"TableRowDeletedEvent",z,[]);class zd extends z{constructor(){super()}get eventId(){return 147}dc(){this.Sb(237)}ag(){this.ud(K=>!!K.insertDeleteMultiRangeParameters);this.ud(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.ud(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ud(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(zd,"TableRowInsertedEvent",z,[]);class ke extends z{constructor(){super()}get eventId(){return 26}dc(){this.Sb(177)}ag(){this.ud(K=>
K.YU().AutoFilterType===sb.Qab)}}Object(d.a)(ke,"TableSortedEvent",z,[]);class Td extends z{constructor(){super()}get eventId(){return 87}dc(){this.Sb(212)}}Object(d.a)(Td,"TableStyleAppliedEvent",z,[]);class Ge extends z{constructor(){super()}get eventId(){return 88}dc(){this.Sb(196)}}Object(d.a)(Ge,"TableStyleOptionToggledEvent",z,[]);class bf extends z{constructor(){super()}get eventId(){return 31}dc(){this.Sb(210)}ag(){this.ud(K=>K.getParameters().FilterType===sb.Qab)}}Object(d.a)(bf,"TableTop10FilteredEvent",
z,[]);class Fa extends z{constructor(){super()}get eventId(){return 207}dc(){this.Sb(238)}}Object(d.a)(Fa,"TextToColumnsEvent",z,[]);class aa extends z{constructor(){super()}get eventId(){return 128}dc(){this.Sb(559)}}Object(d.a)(aa,"ValuesSortedEvent",z,[]);class Xa extends z{constructor(){super()}get eventId(){return 55}dc(){this.Sb(197)}}Object(d.a)(Xa,"WorkbookCalculationModeSetEvent",z,[]);class Lb extends z{constructor(){super()}get eventId(){return 34}dc(){this.Sb(181)}ag(){this.ud(K=>!!K.parentCommentId)}}
Object(d.a)(Lb,"WorkbookCommentRepliedEvent",z,[]);class kc extends z{constructor(){super()}get eventId(){return 33}dc(){this.Sb(181)}ag(){this.ud(K=>!K.parentCommentId)}}Object(d.a)(kc,"WorkbookCommentedEvent",z,[]);class Nc extends z{constructor(){super()}get eventId(){return 56}dc(){this.Sb(128)}}Object(d.a)(Nc,"WorkbookRecalculatedEvent",z,[]);class ad extends z{constructor(){super()}get eventId(){return 46}dc(){this.Sb(171)}}Object(d.a)(ad,"WorkbookRedoEvent",z,[]);class sd extends z{constructor(){super()}get eventId(){return 45}dc(){this.Sb(170)}}
Object(d.a)(sd,"WorkbookUndoEvent",z,[]);class ce extends z{constructor(){super()}get eventId(){return 116}dc(){this.Sb(507);this.Sb(576);this.Sb(10)}ag(){this.ud(K=>{if(Object(W.a)(Y,K)&&(K=Object(ea.a)(Y,K),void 0!==K.source&&null!==K.source&&void 0!==K.eventId&&null!==K.eventId))return n.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${K.source}; eventId: ${K.eventId}.`),!0;n.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");
return!1})}}Object(d.a)(ce,"DefaultRichApiRequestExecutedEvent",z,[]);class Ce extends z{constructor(){super()}get eventId(){return 216}dc(){this.Sb(1022)}}Object(d.a)(Ce,"TablelAltTextEditedEvent",z,[]);class ve extends z{constructor(){super()}get eventId(){return 217}dc(){this.Sb(263)}}Object(d.a)(ve,"FloatingObjectZOrderChangedEvent",z,[]);var De=a(985);class le extends z{constructor(){super()}get eventId(){return 192}dc(){this.Sb(507)}ag(){this.ud(K=>Object(W.a)(De.a,K)?!0:!1)}}Object(d.a)(le,
"VisualPropertySetEvent",z,[]);class qf extends P{constructor(){super(219,[510])}}Object(d.a)(qf,"ChartSeriesDeletedEvent",P,[]);class Nf extends z{get eventId(){return 220}dc(){this.Sb(1027)}}Object(d.a)(Nf,"ChartDataChangedEvent",z,[]);class Tf extends P{constructor(){super(221,[512])}}Object(d.a)(Tf,"ChartSeriesDataChangedEvent",P,[]);class Oa{constructor(K){this.xb=null;this.$=K}get macroRecorderEvents(){this.xb||(this.xb=new l.a,this.xb.add(new mc),this.xb.add(new Ta),this.xb.add(new Ob),this.xb.add(new Bd),
this.xb.add(new dd),this.xb.add(new ae),this.xb.add(new Yb),this.xb.add(new Sc),this.xb.add(new qd),this.xb.add(new ye),this.xb.add(new $e),this.xb.add(new xe),this.xb.add(new Yd),this.xb.add(new he),this.xb.add(new yc),this.xb.add(new Xb),this.xb.add(new Wf),this.xb.add(new Gf),this.xb.add(new Yc),this.xb.add(new zd),this.xb.add(new pf),this.xb.add(new Ae),this.xb.add(new Ua),this.xb.add(new Be),this.xb.add(new Vc),this.xb.add(new ke),this.xb.add(new af),this.xb.add(new yd),this.xb.add(new Ub),this.xb.add(new wc),
this.xb.add(new bf),this.xb.add(new Od),this.xb.add(new kc),this.xb.add(new Lb),this.xb.add(new Ab),this.xb.add(new sc),this.xb.add(new Je),this.xb.add(new ff),this.xb.add(new Rb),this.xb.add(new xd),this.xb.add(new je),this.xb.add(new jd),this.xb.add(new Gb),this.xb.add(new zc),this.xb.add(new ad),this.xb.add(new sd),this.xb.add(new Mf),this.xb.add(new bb),this.xb.add(new Eb),this.xb.add(new Qd),this.xb.add(new bc),this.xb.add(new Xa),this.xb.add(new Nc),this.xb.add(new ec),this.xb.add(new gd),this.xb.add(new Hd),
this.xb.add(new Gc),this.xb.add(new jf),this.xb.add(new gf),this.xb.add(new ed),this.xb.add(new Fe),this.xb.add(new I),this.xb.add(new T),this.xb.add(new id),this.xb.add(new Mc),this.xb.add(new Ue),this.xb.add(new oe),this.xb.add(new ee),this.xb.add(new Qb),this.xb.add(new Id),this.xb.add(new L),this.xb.add(new O),this.xb.add(new se),this.xb.add(new wa),this.xb.add(new fa),this.xb.add(new G),this.xb.add(new ka),this.xb.add(new E),this.xb.add(new N),this.xb.add(new D),this.xb.add(new da),this.xb.add(new Ee),
this.xb.add(new Td),this.xb.add(new Ge),this.xb.add(new Ed),this.xb.add(new Hc),this.xb.add(new Qa),this.xb.add(new Zb),this.xb.add(new La),this.xb.add(new va),this.xb.add(new Ba),this.xb.add(new Za),this.xb.add(new ic),this.xb.add(new Cb),this.xb.add(new Z),this.xb.add(new Ea),this.xb.add(new be),this.xb.add(new lb),this.xb.add(new rf),this.xb.add(new X),this.xb.add(new yb),this.xb.add(new fe),this.xb.add(new te),this.xb.add(new We),this.xb.add(new db),this.xb.add(new Wb),this.xb.add(new Jb),this.xb.add(new eb),
this.xb.add(new zb),this.xb.add(new ne),this.xb.add(new Xc),this.xb.add(new S),this.xb.add(new Ja),this.xb.add(new bd),this.xb.add(new Zc),this.xb.add(new Ha),this.xb.add(new jb),this.xb.add(new Xe),this.xb.add(new ta),this.xb.add(new aa),this.xb.add(new xa),this.xb.add(new C),this.xb.add(new oa),this.xb.add(new ba),this.xb.add(new Nb),this.xb.add(new Ya),this.xb.add(new cb),this.xb.add(new Va),this.xb.add(new ib),this.xb.add(new Ma),this.xb.add(new ab),this.xb.add(new pa),this.xb.add(new vc),this.xb.add(new ja),
this.xb.add(new la),this.xb.add(new ua),this.xb.add(new Ic),this.xb.add(new H),this.xb.add(new oc),this.xb.add(new ya),this.xb.add(new Md),this.xb.add(new Fc),this.xb.add(new tc),this.xb.add(new Da),this.xb.add(new V),this.xb.add(new F),this.xb.add(new na),this.xb.add(new kb),this.xb.add(new xb),this.xb.add(new pb),this.xb.add(new Aa),this.xb.add(new Ga),this.xb.add(new Pa),this.xb.add(new Ka),this.xb.add(new ob),this.xb.add(new qa),this.xb.add(new ma),this.xb.add(new Wa),this.xb.add(new hb),this.xb.add(new Na),
this.xb.add(new za),this.xb.add(new rb),this.xb.add(new nc),this.xb.add(new fb),this.xb.add(new vb),this.xb.add(new mf),this.xb.add(new wf),this.xb.add(new Kf),this.xb.add(new jc),this.xb.add(new qb),this.xb.add(new ac),this.xb.add(new Lc),this.xb.add(new Ac),this.xb.add(new Jc),this.xb.add(new hd),this.xb.add(new Cd),this.xb.add(new rd),this.xb.add(new de),this.xb.add(new Pb),this.xb.add(new Fa),this.xb.add(new ue),this.xb.add(new Ce),this.xb.add(new ve),this.xb.add(new le),this.xb.add(new qf),this.xb.add(new Tf),
this.xb.add(new Nf),A.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.zmj());return this.xb}B6e(K,Ia){let Db=this.C6e(K,this.macroRecorderEvents,Ia);Db||(Db=this.C6e(K,Oa.tai(),Ia),!Db&&this.mmf(K,Oa.KMe,Ia)&&(Db=Oa.KMe));return Db}C6e(K,Ia,Db){const dc=new l.a;for(let xc of Ia)this.mmf(K,xc,Db)&&dc.add(xc);return 1===dc.count?dc.ma(0):1<dc.count?Oa.lTh(dc):null}mmf(K,Ia,Db){const dc=Oa.W6i(K,Ia);return Db?dc&&Oa.k$j(K,Ia):dc}zmj(){const K=new l.a;for(let Ia of this.xb){let Db=
!1;for(let dc of Ia.featureGates)if(!A.EwaSettings.xa(dc)){K.add(Ia);Db=!0;break}if(!Db)for(let dc of Ia.KYe)if(!A.EwaSettings.getBooleanFeatureGate(dc,!1)){K.add(Ia);break}}for(let Ia of K)this.xb.remove(Ia)}static tai(){Oa.lFb||(Oa.lFb=new l.a,Oa.lFb.add(new U),Oa.lFb.add(new $a));return Oa.lFb}static W6i(K,Ia){return Ia.operations.contains(K.operation)}static k$j(K,Ia){Ia=Ia.gGc;if(!Ia.count)return!0;let Db=!0;for(let dc of Ia)if(!dc(K.payload)){Db=!1;break}return Db}static lTh(K){let Ia=K.ma(0);
for(let Db of K)Db.gGc.count>Ia.gGc.count&&(Ia=Db);return Ia}}Oa.lFb=null;Oa.KMe=new ce;Object(d.a)(Oa,"MacroRecorderEventList",null,[]);class Fb extends h.a{constructor(K){super();this.$=K;this.Gb()}create(){this.qb(this.$.da.Ba(297)||new v(this.$,new Oa(this.$),new w))}static la(K){K.da.Ha(298,new Fb(K))}}Object(d.a)(Fb,"MacroRecorderEventHandlerFactory",h.a,[]);var $b=a(1275),Cc=a(7),Pc=a(566);class od{constructor(){this.axg=new l.a}get G3b(){return this.axg}V2h(K){n.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",K);const Ia=new l.a;for(let Db of this.G3b)for(let dc of Db.zGb)dc.id===K&&Ia.add(dc);return Ia}kqe(K){this.G3b.add(K)}umj(K){for(let Ia of this.G3b)if(Ia.sue===K.sue){this.G3b.remove(Ia);break}}static vqh(K,Ia,Db=null){K=od.UVh(K);0<K.length&&(od.mzc(K,!1),Db&&Db(Ia,K))}static UVh(K){const Ia=[];if(K&&K.zGb&&0<K.zGb.count)for(let Db of K.zGb)if(Db.controls&&0<Db.controls.count)for(let dc of Db.controls)if(dc.menuItems&&0<dc.menuItems.count)for(let xc of dc.menuItems)Array.add(Ia,
xc.id);return Ia}static mzc(K,Ia){if(K.length){var Db=[];for(const dc of K)Db.push(appChrome.actions.updateControlEnabledDisabledState(dc,Ia));appChrome.api.dispatch(Db)}}}Object(d.a)(od,"ContextMenuExtensibilityCache",null,[906,907]);var Ld=a(1499),Wd=a(88),Fd=a(4),$d=a(888),Ye=a(833);class zf{EZa(K,Ia=null){if(K=Ye.a.C4a(K)){appChrome.addInApi.dispatchActionsToInstallAddIn(K,Ia);for(const Db of K.tabs)if(Db.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(K,()=>{});break}}}hNd(K){(K=
Ye.a.C4a(K))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(K)}static Dqh(K,Ia,Db=null){K=zf.$5h(K);0<K.length&&(zf.mzc(K,!1),Db&&Db(Ia,K))}static $5h(K){const Ia=[];if(K&&(K=K.aW,K.Ss&&0<K.Ss.count))for(let Db of K.Ss)if(Db.groups&&0<Db.groups.length)for(const dc of Db.groups)if(dc.controls&&0<dc.controls.length)for(const xc of dc.controls)Array.add(Ia,xc.id);return Ia}static mzc(K){if(K.length){var Ia=[];for(const Db of K)Ia.push(appChrome.actions.updateControlEnabledDisabledState(Db,!0));appChrome.api.dispatch(Ia)}}}
Object(d.a)(zf,"OneLineRibbonExtensibilityManager",null,[910]);var kf=a(958);class Df{constructor(){this.F6d=this.JHc=null}get UWc(){return this.JHc||(this.JHc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set UWc(K){this.JHc=K}get pYg(){return this.F6d||(this.F6d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(K,Ia){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(K,Ia)}Old(K,
Ia,Db,dc,xc,Rc=null,fd=null){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",K);if((K=Ia.sja(xc.ownerAddinInfo.storeType,xc.ownerAddinInfo.solutionId))&&K.qB&&!K.qB.getIsUpgrading())if(Ia=null,0<K.qB.getNotificationParams().length&&(Ia=this.fAe(K.qB.getNotificationParams()[0]))&&2147758681===Ia.errorCode&&(K.isUpgraded=!0),2!==K.qB.getStatus()&&(1!==K.qB.getStatus()||Ia&&2147758681===Ia.errorCode))Ia&&this.Uag(K,Ia,fd);else try{Db.setOwnerAddinEToken(K.qB.getEToken()),xc.action(Db,dc.ida),Rc&&
Rc()}catch(ld){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Fd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?ld.stack:ld.message)),kf.a.PVd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}Uag(K,Ia,Db=null){const dc=K.qB;if(1===dc.getNotificationParams().length||Ia.ugc){const xc=Ia.Kha,Rc=Ia.Oia;Ia.Kha=()=>{dc.removeFirstNotification();if(0<dc.getNotificationParams().length){const fd=
this.fAe(dc.getNotificationParams()[0]);this.Uag(K,fd)}2147758681===Ia.errorCode&&(zf.Dqh(K.Lo,dc,Object(Wd.a)(this,this.Dgf,"initUpgradeStateDetectTask")),od.vqh(K.ftb,dc,Object(Wd.a)(this,this.Dgf,"initUpgradeStateDetectTask")));xc&&xc()};Ia.Oia=()=>{Rc&&Rc();Db&&Db()};kf.a.QVd(Ia)}}Dgf(K,Ia){let Db=null;Db=()=>{K.getIsUpgrading()?window.setTimeout(Db,1E3):K.getUpgradingFailed()?zf.mzc(Ia,!0):Fd.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Db,1E3)}fAe(K){const Ia=new $d.a;Ia.BMa=
K.infoType;Ia.id=K.id;Ia.title=K.title;Ia.description=K.description;Ia.buttonText=K.buttonTxt;Ia.Kha=K.buttonCallback;Ia.ugc=K.highPriority;Ia.Oia=K.dismissCallback;Ia.errorCode=K.errorCode;Ia.Jff=K.iframeNotificationUrl;return Ia}}Object(d.a)(Df,"AddinCommandsActionHandler",null,[905]);var Of=a(86),Bb=a(167),Vb=a(714),rc=a(5),Kc=a(756),cd=a(715);class Nd{constructor(K,Ia){this.Xa=K;this.lch=Ia}lQh(K){if(void 0!==K&&null!==K&&K===rc.a.OHe)K="ContextMenuCell";else return null;const Ia=this.Xa.Jc();
this.CPh(Ia,K);return Ia}CPh(K,Ia){Ia=this.lch.V2h(Ia);for(let Db of Ia){Ia=Db.controls;for(let dc of Ia)this.pPh(K,dc)}}pPh(K,Ia){var Db=Ia.iU[Kc.a.id];const dc=Ia.iU[Kc.a.uVa],xc=Ia.iU[Kc.a.yVa];let Rc="Image16by16",fd=Ia.iU[Kc.a.vVa];cd.c(xc)&&(Rc="None");0<Ia.menuItems.count?(Db=this.Xa.mw(Db,Db,dc,798637440),Db.mNb(Rc,xc,null),this.jQh(Db.menu,Ia),K.buttons.push(Db)):K.buttons.push(this.Xa.QIa(Db,dc,fd,xc,Rc,null,!1))}jQh(K,Ia){const Db=this.Xa.Jc();for(let dc of Ia.menuItems){Ia=dc.nma[Kc.a.id];
const xc=dc.nma[Kc.a.uVa],Rc=dc.nma[Kc.a.yVa];let fd="Image16by16";const ld=dc.nma[Kc.a.vVa];cd.c(Rc)&&(fd="None");Ia=this.Xa.QIa(Ia,xc,ld,Rc,fd,null,!1);Db.buttons.push(Ia)}K.uc.push(Db)}}Object(d.a)(Nd,"AddInCommandsContextMenuExtensibilityHandler",null,[870]);var Vd=a(882);class ge{constructor(){this.Bi=null;this.visible=!1}}Object(d.a)(ge,"AddinStatusCommandValues",null,[]);class we{static oej(K){const Ia=new ge;Ia.Bi=K.YZa;Ia.visible=Ia.Bi?!0:!1;return Ia}static ZAc(K,Ia,Db,dc,xc){const Rc=document.getElementById(Db);
Rc?we.qOj(K,Ia,Rc,dc,xc):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Db))}static qOj(K,Ia,Db,dc,xc){Db?K.YZa===CommonUIStrings.l_ErrorLoadingAddInsTitle?kf.a.cNj(Ia,Db,dc,xc):K.YZa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&kf.a.wOj(Ia,Db):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(d.a)(we,"AddinCommandsStatusHandler",null,[]);var Le=a(39),Te=a(231),Ca=a(14),Hb=a(33);class cc extends Le.a{constructor(K,
Ia){super();this.agaveCommandManager=this.statusBarManager=null;this.DEe=()=>{this.YF&&this.YF.fEe()};this.cbf=()=>{this.raiseEvent("LAC")};this.Wc=(Db,dc)=>{!Db.Yb&&Te.b(dc)&&this.statusBarManager&&(this.statusBarManager.SF(this),this.statusBarManager=null)};this.YF=Ia;this.$=K;this.uTj=Hb.a.xn()?document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]').getElementsByClassName("ms-Button-label")[0].id:K.Cb+"OfficeAddinLabel-Medium14";this.$.da.hb(29,Db=>{this.statusBarManager=
Db;Db.rJ(this)});this.$.ea.Oj(this.Wc);this.YF.LOg(this.cbf);this.$.da.hb(206,Db=>{this.agaveCommandManager=Db;Db.mQg(this.DEe)})}vq(K){this.addHandler("LAC",K)}Wq(K){this.removeHandler("LAC",K)}$r(K,Ia){if("QueryAddinLabel"!==K)return!1;Ia[Vd.a.LabelText]!==this.YF.YZa&&(K=we.oej(this.YF),Ia[Vd.a.LabelText]=K.Bi,Ia[Vd.a.Visible]=K.visible,window.setTimeout(()=>{this.ZAc()},0));return!0}yn(){return!0}ZAc(){this.$&&we.ZAc(this.YF,this.$.domElement,this.uTj,Ca.a.instance.ga(333),Ca.a.instance.ga(334))}dispose(){this.$.ea.pk(this.Wc);
this.YF.Cnj(this.cbf);this.agaveCommandManager&&(this.agaveCommandManager.Poj(this.DEe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.SF(this),this.statusBarManager=null);this.YF=this.$=null;super.dispose()}}Object(d.a)(cc,"AddinCommandsStatusBarManager",Le.a,[368,213]);var ca=a(736),ia=a(158),Sb=a(127),Oc=a(986),td=a(1344),Jd=a(112),qe=a(578),Ie=a(142);class Ze{constructor(){this.XZa=null}setErrorMessageForAddin(K,Ia){this.XZa||(this.XZa={});this.XZa[K]=Ia}mYh(K){return this.XZa&&
K in this.XZa?this.XZa[K]:null}}Object(d.a)(Ze,"AddinCommandsErrorManager",null,[]);var Oe=a(339),eg=a(101);class Qf{constructor(){this.Up=this.VN=0;this.qZc=null;this.Xtc=this.ODc=0;this.rqa=this.rMc=this.aIc=this.e6b=this.Oja=this.U9=null}get pZc(){this.aIc||(this.aIc=new l.a);return this.aIc}get ufd(){this.rMc||(this.rMc=new l.a);return this.rMc}get HIa(){this.rqa||(this.rqa=new l.a);return this.rqa}}Object(d.a)(Qf,"AddinCommandsListLoaderContext",null,[]);var gg=a(838);class ug{}Object(d.a)(ug,
"AppsForOfficeEntitlementQueryInfo",null,[]);var ng=a(40);const Lg=K=>{const Ia={};Ia.solutionId=K.solutionId;Ia.version=K.version;Ia.storeType=K.storeType;Ia.storeId=K.storeId;Ia.assetId=K.assetId;Ia.assetStoreId=K.assetStoreId;Ia.targetType=K.targetType;Ia.requireConsent=K.requireConsent||!1;Ia.isAddinCommands=!0;Ia.addinCommandsActionType=0;return Ia};class Ag{constructor(K,Ia){this.entitlement=K;this.metadata=Ia}Ohg(){const K=Lg(this.entitlement);K.targetType=this.targetType;return K}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(d.a)(Ag,"AddinEntitlementEx",null,[]);var hh=a(265),Cg=a(31);class Kg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(Kg,"AddinAbstract",null,[]);class Mg extends Sys.EventArgs{constructor(){super();this.Lo=this.kk=
null}}Object(d.a)(Mg,"InsertionParamEventArgs",Sys.EventArgs,[]);class Hg{constructor(K,Ia,Db,dc=null){this.XLb=Fd.AFrameworkApplication.fa.Wa("RoamingServiceHandlerWebServiceBase");this.appName=K;this.KEa=Ia;this.skb=Db;this.Gmb=dc}rac(K){this.QXe(K,"getAddinTeachingCalloutSettings",Object(Wd.a)(this,this.p4,"getRequestSuccessCallback"),Object(Wd.a)(this,this.PM,"getRequestFailureCallback"))}HHh(){const K=new l.a;K.add(this.appName);this.QXe(K,"getTeachingCalloutSettingsForAddinBetterEntryPoint",
Object(Wd.a)(this,this.N5h,"getRequestSuccessCallbackForBEP"),Object(Wd.a)(this,this.PM,"getRequestFailureCallback"))}QXe(K,Ia,Db,dc){const xc=new Sys.StringBuilder(this.XLb);xc.append("RoamingServiceHandler.ashx?action=");xc.append(Ia);xc.append("&");xc.append(this.Ojd(K));xc.append("&");xc.append(Fd.AFrameworkApplication.xi);Fd.AFrameworkApplication.Hd.Mm(xc.toString(),1,null,null,!0,2,Db,dc,null)}T3a(K){this.VXe(K,"saveAddinTeachingCalloutSettings")}MHh(K){this.VXe(K,"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}VXe(K,
Ia){const Db=new Sys.StringBuilder(this.XLb);Db.append("RoamingServiceHandler.ashx?action=");Db.append(Ia);Db.append("&");Db.append(Fd.AFrameworkApplication.xi);Ia=Db.toString();K=ng.c(K);Fd.AFrameworkApplication.Hd.Mm(Ia,2,K,null,!0,4,null,Object(Wd.a)(this,this.ON,"postRequestFailureCallback"),null)}p4(K){let Ia=!1,Db=null;try{if(0<K.data.me.length){const dc=Object(ea.a)(Object,ng.a(K.data.me)),xc=dc?dc[this.appName]:null;xc&&(Db=Object(ea.a)(Object,ng.a(xc.toString())))}Ia=!0}catch(dc){this.PM(null)}Ia&&
this.KEa&&this.KEa(Db)}N5h(K){let Ia=!1,Db=null;try{if(0<K.data.me.length){const dc=Object(ea.a)(Object,ng.a(K.data.me));Db=Object(ea.a)(String,dc[this.appName])||null}Ia=!0}catch(dc){this.PM(null)}Ia&&this.KEa&&(K={},K.Platforms=Db,this.KEa(K))}PM(K){this.skb&&this.skb(K?K.data:null)}ON(K){this.Gmb&&this.Gmb(K?K.data:null)}Ojd(K){const Ia=new Sys.StringBuilder("requestedsettings=");for(let Db=0;Db<K.count;Db++)Ia.append(K.ma(Db)),Db<K.count-1&&Ia.append(";");return Ia.toString()}}Object(d.a)(Hg,
"AddinTeachingUIRoamingRequestHandler",null,[]);class Ng extends Sys.EventArgs{constructor(K){super();this.solutionId=K.solutionId;this.assetId=K.assetId;this.storeType=K.storeType;this.storeId=K.storeId;this.assetStoreId=K.assetStoreId;this.targetType=K.targetType;this.width=K.width;this.height=K.height;this.displayName=K.displayName;this.version=K.version}}Object(d.a)(Ng,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Rf=a(351);class Ug{constructor(K){this.$Za=this.kk=null;this.cea=
!1;this.rqa=this.FSb=this.ona=this.Lg=this.xX=this.eO=null;this.Ra=K}get appName(){return Fd.AFrameworkApplication.fa.Wa("WebAppShortName")}get Ipb(){this.xX||(this.xX=new Hg(this.appName,Object(Wd.a)(this,this.p4,"getRequestSuccessCallback"),Object(Wd.a)(this,this.PM,"getRequestFailureCallback"),Object(Wd.a)(this,this.ON,"postRequestFailureCallback")));return this.xX}get Ksa(){this.FSb||(this.FSb=new l.a);return this.FSb}set Ksa(K){this.FSb=K}get HIa(){this.rqa||(this.rqa=new l.a);return this.rqa}set HIa(K){this.rqa=
K}QXc(K,Ia){window.addEventListener?(this.kk=K,this.$Za=Ia,window.addEventListener("LaunchAddinTaskpane",Object(Wd.a)(this,this.bFd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Wd.a)(this,this.WGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Wd.a)(this,this.SGb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Wd.a)(this,this.LGb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}m0d(K,Ia,Db,dc){this.Lg=K;this.Ksa=Ia;this.HIa=Db;this.ona=dc;n.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Ia?Ia.count.toString():"null",Db?Db.count.toString():"null");if(0<this.Ksa.count||0<this.HIa.count)K=new l.a,K.add(this.appName),this.Ipb.rac(K);else this.ona(new l.a,null)}bFd(){const K=new hh.ScriptSharpLegacyMap;this.$Za&&this.$Za.tabs&&!this.$Za.tabs[0].isOfficeTab&&
K.ia("SDX.FeatureFlags","NonOfficeTab");this.$la(Ug.dV(this.kk),"ClickOnLaunch",K);this.jma();this.$Za?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.$Za,()=>{const Ia=new Mg;Ia.kk=this.kk;this.Ra.raiseEvent(ca.a.Rwd,Ia)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}SGb(){this.$la(Ug.dV(this.kk),"ClickOnClose");this.jma()}WGb(){this.$la(Ug.dV(this.kk),"ClickOnDismiss");this.jma()}LGb(K){if(K&&(K=K.detail)&&K.id&&this.Oqd(K.id)){const Ia=
(K.action||"").toLowerCase();if(K.success&&"opened"===Ia)this.$la(Ug.dV(this.kk),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.jma(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Wd.a)(this,this.LGb,"onCampaignLaunchedHandler"),!0);else{let Db;try{Db=JSON.stringify(K),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Db)}catch(dc){Db="id : "+K.id+" telemetryEventName: "+
K.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Db+" Error: "+(dc?dc.toString():""))}}}}Oqd(K){K=Cg.a.cl(K);return-1!==K.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==K.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==K.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==K.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==K.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==K.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}fBa(K){if(this.appName){const Ia=
{},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=K;Ia[this.appName]=ng.c(Db);this.Ipb.T3a(Ia);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}jma(){if(!this.cea){const K=window.g_roamingAddinList;K&&(this.fBa(K),this.cea=!0)}}p4(K){K?this.nOb(K)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),
this.eO="AddinHasShown"in K&&K.AddinHasShown?K.AddinHasShown.toString():null,this.Ssb()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.ona(this.Ksa,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.eO=null,this.Ssb())}PM(K){n.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",K?K.httpStatus:-1);this.ona(this.Ksa,null)}ON(K){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",
K?K.httpStatus:-1)}Ssb(){const K=this.J9c();if(0===K.targetType)K.solutionId?this.jKd(K):this.$la(null,"NoSolutionId"),this.ing(K),this.ona(this.Ksa,null);else this.ona(this.Ksa,K);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",K.addinId)}jKd(K){const Ia=new ug;Ia.callbackFunc=Db=>{if(Db.errorCode){this.$la(K.solutionId,"FailToGetAppDetails");var dc=window.g_roamingAddinList;dc&&this.fBa(dc)}else if(Db.value)for(dc of Db.value)if(Db=dc[1],Db===K.solutionId){const xc={};xc.solutionId=
Db;xc.assetId=dc[5];xc.storeType=dc[12];xc.storeId=dc[11];xc.assetStoreId=dc[6];xc.targetType=dc[3];xc.width=dc[7];xc.height=dc[8];xc.displayName=dc[0];xc.version=dc[4];n.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",K.solutionId);dc=new Ng(xc);this.Ra.raiseEvent(ca.a.TVd,dc);break}};Ia.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ia.fromInsertDialog=!1;Ia.refresh=!1;this.Lg.queryEntitlementDetails(Ia)}nOb(K){if("LastTeachingUIShowTime"in K){if(K=+new Date-+new Date(K.LastTeachingUIShowTime.toString()),
K<Fd.AFrameworkApplication.fa.LM("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",K),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}J9c(){let K=new Oe.a(new Kg,0),Ia=new Oe.a(new Kg,0),Db=0,dc=0,xc=0;var Rc=new l.a;for(var fd of this.Ksa)Rc.add(fd);for(let ld of this.HIa)Rc.add(ld);for(let ld of Rc)if(!("excatalog"!==ld.storeType||cd.c(ld.installTimeInMS)||!ld.installTimeInMS||
ld.installTimeInMS<=Fd.AFrameworkApplication.fa.LM("DateTimeInMSForNewAddin",16409952E5))){Rc=Ug.dxb(ld);if(this.eO&&(fd=this.eO.split(","),0<fd.length&&Array.contains(fd,Rc))){xc++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Rc.startsWith("private_")?(K=Ug.m6e(ld,K),dc++):(Ia=Ug.m6e(ld,Ia),Db++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",dc,Db,xc);return 0<Ia.value?
Ia.key:0<K.value?K.key:Object.assign(new Kg,{addinId:null,targetType:-1,solutionId:null})}$la(K,Ia,Db=null){K={["AppTeachingUICalloutAction"]:Ia,["SDX.Id"]:K,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Db)for(let dc of Db.keys)K[dc]=Db.ma(dc);ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)}))}ing(K){K&&(window.g_roamingAddinList=this.eO?this.eO+","+K.addinId:K.addinId)}static dV(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,
K.storeType,K.assetId,null,null,K.storeId)}static m6e(K,Ia){return Ia.value<K.installTimeInMS?new Oe.a(Object.assign(new Kg,{addinId:Ug.dxb(K),targetType:K.targetType,solutionId:K.solutionId}),K.installTimeInMS):Ia}static dxb(K){return Telemetry.PrivacyRules.IsPrivateAddin(K.storeType,K.assetId,null,null,K.storeId)?"private_"+K.installTimeInMS:K.solutionId}}Object(d.a)(Ug,"PrivateCatalogTeachingCalloutHandler2",null,[]);var vg=a(82);const ph=()=>{const K=vg.a.GZ(window.location.href.toLowerCase(),
"wdomexsrctype");return!!K&&"4"===K},Ig=()=>vg.a.GZ(window.location.href.toLowerCase(),"wdtpl"),lh=()=>{const K=vg.a.GZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!K&&"1"===K};var wg=a(837),mh=a(701);class Bh{constructor(K){this.Pr=null;this.eu=K}get_current(){if(!this.Pr)throw Error.argumentOutOfRange();return this.Pr.data}moveNext(){if(!this.Pr)return this.Pr=this.eu,!!this.eu;if(!this.Pr.next)return!1;this.Pr=this.Pr.next;return!0}Eoc(){if(!this.Pr)return this.Pr=this.eu,!!this.eu;
if(!this.Pr.previous)return!1;this.Pr=this.Pr.previous;return!0}reset(){this.Pr=this.eu}}Object(d.a)(Bh,"ListEnumerator",null,[0]);class xf{constructor(K,Ia,Db){this.next=Db;this.previous=Ia;this.data=K}}Object(d.a)(xf,"ListNode",null,[]);class ra{constructor(){this.sA=this.kq=null;this._count=0}add(K){this.kq?this.sA=this.sA.next=new xf(K,this.sA,null):this.kq=this.sA=new xf(K,null,null);this._count=this.count+1}insert(K,Ia){if(K>this.count||0>K)throw Error.argumentOutOfRange("pos");if(K===this.count)this.add(Ia);
else{for(var Db=this.kq;0!==K--;)Db=Db.next;K=new xf(Ia,Db.previous,Db);K.previous?K.previous.next=K:this.kq=K;K.next?K.next.previous=K:this.sA=K;this._count=this.count+1}}remove(K){let Ia=this.kq;for(;Ia&&Ia.data!==K;)Ia=Ia.next;if(!Ia)return!1;Ia.previous?Ia.previous.next=Ia.next:this.kq=Ia.next;Ia.next?Ia.next.previous=Ia.previous:this.sA=Ia.previous;this._count=this.count-1;return!0}clear(){let K=this.kq,Ia;for(this.sA=this.kq=null;K;)Ia=K.next,K.previous=null,K.next=null,K=Ia;this._count=0}indexOf(K){let Ia=
this.kq,Db=0;for(;Ia&&Ia.data!==K;)Ia=Ia.next,Db++;return Ia?Db:-1}ma(K){return this.at(K).data}get count(){return this._count}getEnumerator(){return new Bh(this.kq)}[Symbol.iterator](){return Object(mh.a)(this.getEnumerator())}rdc(K){K=this.at(K);return new Bh(K)}toArray(){const K=Array(this.count);let Ia=0;for(let Db of this)K[Ia]=Db,Ia++;return K}at(K){let Ia=this.kq,Db=0;for(;Db!==K;){if(!Ia)throw Error.argumentOutOfRange("pos");Ia=Ia.next;Db++}return Ia}}Object(d.a)(ra,"List",null,[1]);class tb extends Sys.EventArgs{constructor(K){super();
this.properties=K}}Object(d.a)(tb,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class qc{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(qc,"MiniAddinInfo",null,[]);class Dc{constructor(K,Ia,Db){this.Ra=new eg.a;this.context=new Qf;this.vVc=this.uXd=this.YGa=this.eO=this.xX=null;this.contextActivationMgr=K;this.FSg=Ia;this.ZGa=Db;this.appName=Fd.AFrameworkApplication.fa.Wa("WebAppShortName")}get NPb(){this.vVc||(this.vVc=new Ug(this.Ra));return this.vVc}JOg(K){this.Ra.addHandler(ca.a.Dpb,
K)}dSg(K){this.Ra.addHandler(ca.a.TVd,K)}n1j(K){null!==K&&(this.context.VN=K[ca.a.xP],this.context.Up=K[ca.a.aM],this.context.ODc=this.context.Xtc=0,K=ca.a.$Ga in K?K[ca.a.$Ga]:0,-1!==this.context.VN&&0!==this.context.Up&&(this.context.U9=new ra,this.context.Oja=new ra,this.context.e6b=new ra,this.context.qZc=this.FSg.createAddinDataProvider(wg.a(this.context.VN),this.contextActivationMgr),this.context.qZc?this.context.qZc.getEntitlementsAsync(this.contextActivationMgr.ida,!0,K,Ia=>{this.L_i(Ia)}):
n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.VN)))}L_i(K){if(K&&0<K.length){this.context.ODc=K.length;const Db=Fd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Ig():null;for(let dc=0;dc<K.length;dc++){const xc=K[dc];if(Fd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&lh()&&xc&&xc.storeType&&"omex"===xc.storeType.toLowerCase()&&xc.assetId&&Db&&xc.assetId.toLowerCase()===
Db.toLowerCase()){var Ia={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:Dc.dV(xc)};ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.ki(Ia)}))}!xc||1!==xc.targetType&&-1!==xc.targetType?this.Dpc():(Ia={},Fd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Ia.solutionId=xc.solutionId,Ia.version=xc.version):(Ia.marketplaceId=xc.solutionId,Ia.marketplaceVersion=
xc.version),Ia.storeType=xc.storeType,Ia.storeId=xc.storeId,Ia.targetData=xc,Dc.OPb?this.contextActivationMgr.isAddinCommandsExAsync(Ia,Object(Wd.a)(this,this.g_i,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Ia,(Rc,fd,ld)=>{Rc?(fd&&this.context.U9.add(ld.targetData),10===this.context.VN&&(Rc=ld.targetData,fd=Rc.targetType,cd.c(ld.targetTypeForExp)||(fd=ld.targetTypeForExp,Rc.targetType=fd),this.context.Oja.add(Rc),0===fd&&this.context.e6b.add(Rc))):(ld=ld.targetData,
n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ld.solutionId,ld.storeType,ld.assetId,null,null,ld.storeId),ld.storeType));this.Dpc()}))}}else this.Dpc()}Dpc(){var K;(K=this.context).Xtc=K.Xtc+1;this.context.Xtc>=this.context.ODc&&(this.ZGa.h6f(this.context.VN,!1),0<this.context.ODc&&10===this.context.VN&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(K=!1,Fd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&
ph()&&(K=this.FGi()),this.SFi(),Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!K?Dc.OPb?this.NPb.m0d(this.contextActivationMgr,this.context.pZc,this.context.HIa,(Ia,Db)=>{const dc=new l.a;for(let xc of Ia)Ia=xc.Ohg(),Db&&Db.solutionId===xc.solutionId&&(Ia.showCallout=!0,this.NPb.ing(Db)),dc.add(Ia);this.ona(dc)}):this.aSh(this.context.U9):this.m0b(this.context.U9)):this.m0b(this.context.U9))}m0b(K){if(Dc.OPb)this.ona(this.Kah(this.context.pZc));
else{var Ia=new l.a;if(K)for(let Db of this.context.U9)Ia.add(Lg(Db));this.context.U9&&1>this.context.U9.count&&gg.a.Qgb(ca.a.Epb,"false",this.context.VN);K={["ack2"]:Ia};K[ca.a.xP]=this.context.VN;K[ca.a.aM]=this.context.Up;this.Ra.raiseEvent(ca.a.Dpb,new tb(K),this)}}Kah(K){const Ia=new l.a;if(K)for(let Db of K)Ia.add(Db.Ohg());return Ia}ona(K){K&&K.count||gg.a.Qgb(ca.a.Epb,"false",this.context.VN);K={["ack2"]:K};K[ca.a.xP]=this.context.VN;K[ca.a.aM]=this.context.Up;this.Ra.raiseEvent(ca.a.Dpb,
new tb(K),this)}fBa(K){if(this.appName){const Ia={},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=K;Ia[this.appName]=ng.c(Db);this.xX&&(this.xX.T3a(Ia),n.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}aSh(K){(this.YGa=K)?(K=new l.a,K.add(this.appName),this.xX=new Hg(this.appName,Object(Wd.a)(this,
this.p4,"getRequestSuccessCallback"),Object(Wd.a)(this,this.PM,"getRequestFailureCallback"),Object(Wd.a)(this,this.ON,"postRequestFailureCallback")),this.xX.rac(K)):(K={["ack2"]:new l.a},K[ca.a.xP]=this.context.VN,K[ca.a.aM]=this.context.Up,this.Ra.raiseEvent(ca.a.Dpb,new tb(K),this))}p4(K){K?this.nOb(K)?(n.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.eO="AddinHasShown"in K&&K.AddinHasShown?K.AddinHasShown.toString():null,this.Ssb()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),
this.m0b(this.YGa)):(n.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.eO=null,this.Ssb())}PM(K){n.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",K?K.httpStatus:-1);this.m0b(this.YGa)}ON(K){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",K?K.httpStatus:-1)}Ssb(){const K=this.J9c();0===K.targetType?(K.solutionId?(this.uXd=K.solutionId,this.jKd()):this.$la("NoSolutionId"),K.addinId&&
(window.g_roamingAddinList=this.eO?this.eO+","+K.addinId:K.addinId),this.Kqe(null)):this.Kqe(K.addinId);n.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",K.addinId)}jKd(){const K=new ug;K.callbackFunc=Ia=>{if(Ia.errorCode){this.$la("FailToGetAppDetails");var Db=window.g_roamingAddinList;Db&&this.fBa(Db)}else if(Ia.value)for(Db of Ia.value)if(Ia=Db[1],Ia===this.uXd){const dc={};dc.solutionId=Ia;dc.assetId=Db[5];dc.storeType=Db[12];dc.storeId=Db[11];dc.assetStoreId=Db[6];dc.targetType=
Db[3];dc.width=Db[7];dc.height=Db[8];dc.displayName=Db[0];dc.version=Db[4];Db=new Ng(dc);this.Ra.raiseEvent(ca.a.TVd,Db);break}};K.storeType=OSF.StoreTypeEnum.PrivateCatalog;K.fromInsertDialog=!1;K.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(K)}nOb(K){if("LastTeachingUIShowTime"in K){if(K=+new Date-+new Date(K.LastTeachingUIShowTime.toString()),K<Fd.AFrameworkApplication.fa.LM("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
K),!1}else n.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}J9c(){let K=new Oe.a(new qc,0),Ia=new Oe.a(new qc,0),Db=0,dc=0,xc=0;var Rc=new ra;if(0<this.context.U9.count)for(var fd of this.context.U9)Rc.add(fd);if(0<this.context.e6b.count)for(let ld of this.context.e6b)Rc.add(ld);for(let ld of Rc)if(!("excatalog"!==ld.storeType||cd.c(ld.installTimeInMS)||!ld.installTimeInMS||ld.installTimeInMS<=Fd.AFrameworkApplication.fa.LM("DateTimeInMSForNewAddin",16409952E5))){Rc=Dc.dxb(ld);
if(this.eO&&(fd=this.eO.split(","),0<fd.length&&Array.contains(fd,Rc))){xc++;n.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}Rc.startsWith("private_")?(K.value<ld.installTimeInMS&&(K=new Oe.a(Object.assign(new qc,{addinId:Rc,targetType:ld.targetType,solutionId:ld.solutionId}),ld.installTimeInMS)),dc++):(Ia.value<ld.installTimeInMS&&(Ia=new Oe.a(Object.assign(new qc,{addinId:Rc,targetType:ld.targetType,solutionId:ld.solutionId}),ld.installTimeInMS)),Db++)}n.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",dc,Db,xc);return 0<Ia.value?Ia.key:0<K.value?K.key:Object.assign(new qc,{addinId:null,targetType:-1,solutionId:null})}Kqe(K){const Ia=new l.a;for(let Db of this.YGa){const dc=Lg(Db);if(K){const xc=Dc.dxb(Db);K===xc&&(dc.showCallout=!0,window.g_roamingAddinList=this.eO?this.eO+","+K:K)}Ia.add(dc)}this.YGa&&1>this.YGa.count&&gg.a.Qgb(ca.a.Epb,"false",this.context.VN);K={["ack2"]:Ia};K[ca.a.xP]=this.context.VN;
K[ca.a.aM]=this.context.Up;this.Ra.raiseEvent(ca.a.Dpb,new tb(K),this)}FGi(){if(Dc.OPb)return this.GGi(this.context.ufd);var K=!1;if(this.context.Oja&&1>this.context.Oja.count)return K;const Ia=Ig();if(!Ia)return K;for(let Db of this.context.Oja)if(Db.storeId&&Db.storeId.toLowerCase()===Ia.toLowerCase()||Db.assetId&&Db.assetId.toLowerCase()===Ia.toLowerCase())K={["SDX_Id"]:Dc.dV(Db),["SDX_TargetType"]:cd.c(Db.targetType)?"":Db.targetType.toString()},ia.a.sendTelemetryEvent(Object.assign(new Rf.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Sb.a.ki(K)})),K=!0;return K}SFi(){if(Dc.OPb)this.TFi(this.context.ufd);else if(!(this.context.Oja&&1>this.context.Oja.count))if(this.ZGa.gmf()){var K=this.ZGa.f8e();K?(K=this.S3e(this.context.Oja,K),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(K=this.S3e(this.context.Oja,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.ZGa.E8f(K)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}S3e(K,
Ia){const Db={};let dc=!1;for(let xc of K)if(K=Dc.dV(xc))!Ia||K in Ia||(this.xK(xc,K),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===K.toLowerCase()?dc||(dc=!0,Db[K]=null):Db[K]=null;return Db}xK(K,Ia){var Db=K.installTimeInMS?(new Date(K.installTimeInMS)).toISOString():"";Db={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:cd.c(K.targetType)?"":K.targetType.toString(),["SDX.AdminDeploymentTime"]:Db};ia.a.sendTelemetryEvent(Object.assign(new Rf.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.ki(Db)}));1===K.targetType&&(K={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Sb.a.ki(K)})))}GGi(K){let Ia=!1;if(K&&1>K.count)return Ia;const Db=Ig();if(!Db)return Ia;for(let dc of K)if(dc.storeId&&dc.storeId.toLowerCase()===Db.toLowerCase()||dc.assetId&&dc.assetId.toLowerCase()===Db.toLowerCase())K=
{["SDX_Id"]:Dc.h8e(dc),["SDX_TargetType"]:cd.c(dc.targetType)?"":dc.targetType.toString()},ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Sb.a.ki(K)})),Ia=!0;return Ia}TFi(K){if(!(K&&1>K.count))if(this.ZGa.gmf()){var Ia=this.ZGa.f8e();Ia?(K=this.T3e(K,Ia),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(K=this.T3e(K,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.ZGa.E8f(K)}else n.ULS.sendTraceTag(528589915,
306,50,"Local storage got disabled")}T3e(K,Ia){const Db={};let dc=!1;for(let xc of K)if(K=Dc.h8e(xc))!Ia||K in Ia||(this.PIi(xc,K),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===K.toLowerCase()?dc||(dc=!0,Db[K]=null):Db[K]=null;return Db}PIi(K,Ia){var Db=K.installTimeInMS?(new Date(K.installTimeInMS)).toISOString():"";Db={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:cd.c(K.targetType)?"":K.targetType.toString(),["SDX.AdminDeploymentTime"]:Db};
ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.ki(Db)}));1===K.targetType&&(K={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Sb.a.ki(K)})))}g_i(K,Ia,Db,dc){K?(-1===dc.targetType&&(dc.targetType=Db.targetTypeForExp),K=new Ag(Db.targetData,dc),Ia&&this.context.pZc.add(K),10===this.context.VN&&(this.context.ufd.add(K),
0===K.targetType&&this.context.HIa.add(K))):(Ia=Db.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.storeType,Ia.assetId,null,null,Ia.storeId),Ia.storeType));this.Dpc()}$la(K){K={["AppTeachingUICalloutAction"]:K,["SDX.Id"]:this.uXd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Sb.a.ki(K)}))}static get OPb(){return Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static dV(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static h8e(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static dxb(K){return Telemetry.PrivacyRules.IsPrivateAddin(K.storeType,K.assetId,null,null,K.storeId)?
"private_"+K.installTimeInMS:K.solutionId}}Object(d.a)(Dc,"AddInCommandsListLoader",null,[]);class ud{constructor(K){this.xEg=K}get ida(){return this.xEg}insertOsfControl(K){return this.ida.insertOsfControl(K)}getManifestInvaildErrorString(){return this.ida.getManifestInvaildErrorString()}isAddinCommandsAsync(K,Ia){this.ida.isAddinCommandsAsync(K,Ia)}isAddinCommandsExAsync(K,Ia){this.ida.isAddinCommandsExAsync(K,Ia)}ownerAddinControlRecreated(K,Ia){this.ida.ownerAddinControlRecreated(K,Ia)}queryEntitlementDetails(K){this.ida.queryEntitlementDetails(K)}}
Object(d.a)(ud,"ContextActivationMgrWrapper",null,[879]);class Pd{createAddinDataProvider(K,Ia){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(K,Ia.ida)}static get instance(){Pd.Ma||(Pd.Ma=new Pd);return Pd.Ma}}Pd.Ma=null;Object(d.a)(Pd,"OSFAddinDataProviderFactory",null,[882]);class re{constructor(){this.Ver=1}}Object(d.a)(re,"CacheItem",null,[]);class Ke{constructor(K){this.fFa=K}pl(K){const Ia=this.fFa.getItem(K);if(Ia){let Db=new re;try{Db=Sys.Serialization.JavaScriptSerializer.deserialize(Ia,
!0)}catch(dc){return this.fFa.removeItem(K),null}return Db.Data?Db.Data:Db.data}return null}kRa(K){this.fFa.removeItem(K)}}Object(d.a)(Ke,"AppsDataCacheManager",null,[909]);var of=a(803);class sf{constructor(){new Ke(of.a.instance)}h6f(K,Ia){K=ca.a.Y4e()+K;of.a.instance.setItem(K,Ia.toString())}f8e(){var K=ca.a.i8e();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",K);K=of.a.instance.getItem(K);return ng.a(K)}E8f(K){const Ia=ca.a.i8e();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",
Ia);of.a.instance.setItem(Ia,ng.c(K))}gmf(){return!!of.a.instance.localStorage}static get instance(){sf.Ma||(sf.Ma=new sf);return sf.Ma}}sf.Ma=null;Object(d.a)(sf,"AddInCommandsCacheManager",null,[899]);class Dg{constructor(K){this.cDc=null;this.cea=!1;this.Ra=new eg.a;this.YLb=this.cqa=null;this.contextActivationMgr=K;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(Wd.a)(this,this.w1i,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",
Object(Wd.a)(this,this.WGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",Object(Wd.a)(this,this.SGb,"onCloseButtonClickedEventHandler"),!0))}get appName(){cd.b(this.cqa)&&(this.cqa=Fd.AFrameworkApplication.fa.Wa("WebAppShortName"));return this.cqa}DQg(K){this.Ra.addHandler(ca.a.bsf,K)}m0d(){this.contextActivationMgr.queryStoreDisabled("omex",K=>{K?n.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.Q_j()})}Q_j(){this.cDc=new Hg(this.appName,
Object(Wd.a)(this,this.p4,"getRequestSuccessCallback"),Object(Wd.a)(this,this.PM,"getRequestFailureCallback"),Object(Wd.a)(this,this.ON,"postRequestFailureCallback"));this.cDc.HHh()}p4(K){this.nOb(K)&&(n.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),this.GWd())}PM(K){n.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",K?K.httpStatus:-1)}ON(K){n.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",K?
K.httpStatus:-1)}nOb(K){if(!K)n.ULS.sendTraceTag(509690974,344,50,"userSettings is null");else if("Platforms"in K&&(this.YLb=Object(ea.a)(String,K.Platforms),!cd.b(this.YLb)&&(K=this.YLb.split(","),0<K.length&&Array.contains(K,"Web"))))return n.ULS.sendTraceTag(509690973,344,50,"callout has shown for this platform"),!1;return!0}GWd(){const K=Of.a.instance.Tb("Common.ISystemInitiatedFeedback");if(K){var Ia=this.RRh();cd.b(Ia)?n.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):K.execute(Db=>
{Db.logActivity(Ia,null)})}else n.ULS.sendTraceTag(509690972,344,50,"Error resolving ISystemInitiatedFeedback Future")}w1i(){this.xK("ClickOnLaunch");this.QQd();this.Ra.raiseEvent(ca.a.bsf)}SGb(){this.xK("ClickOnClose");this.QQd()}WGb(){this.xK("ClickOnDismiss");this.QQd()}RRh(){let K;switch(this.appName){case "Word":K="WordShowCalloutForBEPHomeTab";break;case "Excel":K="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":K="PPTShowCalloutForBEPHomeTab";break;default:K=""}return K}xK(K){K={["AppTeachingUICalloutAction"]:K,
["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)}))}QQd(){if(!this.cea)if(cd.b(this.appName))n.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");else{const K={};K[this.appName]=this.YLb?this.YLb+",Web":"Web";this.cDc&&(this.cDc.MHh(K),n.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.cea=
!0}}}Object(d.a)(Dg,"BetterEntryTeachingCalloutLauncher",null,[]);class Ch{constructor(K,Ia,Db,dc,xc,Rc){this.Up=K;this.kk=Ia;this.KW=Db;this.displayName=xc;this.Zqf=Rc}}Object(d.a)(Ch,"PostLaunchAddinCommandsParameters",null,[]);class ih{constructor(K,Ia,Db){this.cea=!1;this.xX=null;this.Za=K;this.Mkb=Ia;this.bib=Db}QXc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Wd.a)(this,this.bFd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",
Object(Wd.a)(this,this.WGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Wd.a)(this,this.SGb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Wd.a)(this,this.LGb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}bFd(){const K={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:ih.dV(this.Mkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};this.bib&&this.bib.tabs&&!this.bib.tabs[0].isOfficeTab&&(K["SDX.FeatureFlags"]="NonOfficeTab");ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)}));this.jma();this.bib?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.bib,()=>{const Ia=new Mg;Ia.kk=this.Mkb;this.Za.raiseEvent(ca.a.Rwd,Ia)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}SGb(){const K=
{["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:ih.dV(this.Mkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)}));this.jma()}WGb(){const K={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:ih.dV(this.Mkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object.assign(new Rf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)}));this.jma()}LGb(K){if(K&&(K=K.detail)&&K.id&&this.Oqd(K.id)){const Db=(K.action||"").toLowerCase();if(K.success&&"opened"===Db){var Ia={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:ih.dV(this.Mkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(Ia)}));
n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.jma();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Wd.a)(this,this.LGb,"onCampaignLaunchedHandler"),!0)}else try{Ia=JSON.stringify(K),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ia)}catch(dc){Ia="id : "+K.id+" telemetryEventName: "+K.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ia+" Error: "+
(dc?dc.toString():""))}}}Oqd(K){K=Cg.a.cl(K);return-1!==K.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==K.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==K.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==K.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==K.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==K.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}fBa(K){const Ia=Fd.AFrameworkApplication.fa.Wa("WebAppShortName");if(Ia){const Db={},dc={};dc.LastTeachingUIShowTime=
(new Date).toUTCString();dc.AddinHasShown=K;Db[Ia]=ng.c(dc);this.xX=new Hg(Ia,null,null,Object(Wd.a)(this,this.ON,"postRequestFailureCallback")),this.xX.T3a(Db),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,220,10,"Fail to save roaming service since AppName is null")}jma(){if(!this.cea){const K=window.g_roamingAddinList;K&&(this.fBa(K),this.cea=!0)}}ON(K){n.ULS.sendTraceTag(523535566,
220,10,"failed to POST data to Roaming Settings Service with status: {0}",K?K.httpStatus:-1)}static dV(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}}Object(d.a)(ih,"PrivateCatalogTeachingCalloutHandler",null,[]);class Fh{constructor(K){this.fee=null;this.Wbe=K}get fya(){return this.fee}EZa(K,Ia=null){this.Wbe.EZa(K,Ia);this.fee=K}hNd(K){this.Wbe.hNd(K)}}Object(d.a)(Fh,"RibbonExtensibilityManagerWithChangeDetection",null,[910]);var Vg=
a(887),Nh=a(103);class ch{static O5e(K){const Ia=new l.a;if(ch.MGe)for(var Db of ch.MGe)Ia.add(Db);Db=null;switch(K){case "Workbook":Db=ch.gbk;break;case "Document":Db=ch.psh;break;case "Presentation":Db=ch.dcj}if(Db)for(const dc of Db)Ia.add(dc);return Ia}}ch.MGe=["PrimaryCommandSurface","ContextMenu"];ch.gbk=null;ch.psh=null;ch.dcj=null;Object(d.a)(ch,"ExtensionPointType",null,[]);class Jg{constructor(K){this.jhe=null;if(cd.c(K))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),
Error.create("The agave key should not be null or undefined");this.Hvg=K}get zGb(){return this.jhe||(this.jhe=new l.a)}get sue(){return this.Hvg}}Object(d.a)(Jg,"ContextMenuExtensibility",null,[900]);class Kh{constructor(K,Ia=null,Db=0){if(cd.c(K))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.qEg=K;this.BHg=Ia;this.mAg=Db}get aW(){return this.qEg}get startedNode(){return this.BHg}get mRh(){return this.mAg}}
Object(d.a)(Kh,"RibbonExtensibility",null,[921]);class Gh{constructor(K){this.mzg=K.entitlement}get entitlement(){return this.mzg}createActionContext(K,Ia){K={};K.ownerAddinInfo=this.entitlement;K.action=Ia;return K}}Object(d.a)(Gh,"AddInCommandsContextProvider",null,[]);class ha{constructor(K,Ia,Db){this.Z5d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=K;this.eventBuilder=Ia;this.contextMenuBuilder=Db}get addinInfo(){return this.Z5d}Ofh(K){return new Gh(K)}createActionBuilder(K,
Ia){return OfficeExt.DefaultControlActionBinder.createActionBuilder(K,Ia.entitlement,Ia.manifest)}startApplyAddin(K){this.Z5d=K;const Ia=this.Ofh(K);this.actionBuilder=this.createActionBuilder(Ia,K)}endApplyAddin(){}Vfd(K,Ia,Db=0){return this.ribbonBuilder.Ss&&0<this.ribbonBuilder.Ss.count?new Kh(this.yQh(K,Ia),this.addinInfo.startedNode,Db):null}p1e(){var K=null;if(this.contextMenuBuilder.ioc&&0<this.contextMenuBuilder.ioc.count){K||(K=this.addinInfo.entitlement.solutionId);K=new Jg(K);for(let Ia of this.contextMenuBuilder.ioc)K.zGb.add(Ia);
return K}return null}yQh(K,Ia){return this.ribbonBuilder.Ss&&0<this.ribbonBuilder.Ss.count?new Ye.a(this.ribbonBuilder.Ss,K,Ia):null}}Object(d.a)(ha,"AddinCommandsBuilder",null,[]);class gb{constructor(K,Ia,Db,dc,xc,Rc,fd){this.QTa=new Nh.a;this.Up=K;this.Lg=Ia;this.To=Db;this.ribbonManager=dc;this.contextMenuManager=xc;this.YF=Rc;this.kha=fd;this.wO=Fd.AFrameworkApplication.sa.SD}hEb(K,Ia,Db,dc,xc,Rc,fd){const ld=(Dd,Rd,Pe,cf)=>{xc(Dd,Rd,Pe,cf);Dd=Vg.a[this.Up]+Rd.assetId;({value:Rd}=this.QTa.Ic(Dd)).returnValue&&
(Rd.stop(),this.QTa.remove(Dd))};if(0!==this.Up&&K){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",K.count);4===this.Up&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",dc)),this.$7g(K,dc),Rc());for(let Dd of K)if(K=Dd,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.To.WM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId))),this.lpg(K))if(fd&&
K.requireConsent)fd(K,Rd=>{try{if(this.wO){const cf=Vg.a[this.Up]+Rd.solutionId,Bf=this.wO.Kc("ComponentAttach",cf);this.QTa.ia(cf,Bf)}const Pe=this.YF.sja(Rd.storeType,Rd.solutionId);6!==this.Up&&(Pe&&(this.T4b(Pe),Pe.qB.purge(!1)),this.Lg.insertOsfControl(this.hJb(Rd,Ia,Db,ld)),Pe&&this.Lg.ownerAddinControlRecreated(Rd.solutionId,Rd.storeType))}catch(Pe){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.To.WM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.solutionId,Rd.ownerAddinStoreType||Rd.storeType,Rd.assetId,null,null,Rd.storeId),Rd.version,Rd.storeType,Rd.storeId,Pe.message)),ld(!1,Rd,null,null)}});else try{if(this.wO){const Pe=Vg.a[this.Up]+K.solutionId,cf=this.wO.Kc("ComponentAttach",Pe);this.QTa.ia(Pe,cf)}const Rd=this.YF.sja(K.storeType,K.solutionId);6!==this.Up&&(Rd&&(this.T4b(Rd),Rd.qB.purge(!1)),this.Lg.insertOsfControl(this.hJb(K,Ia,Db,ld)),Rd&&this.Lg.ownerAddinControlRecreated(K.solutionId,
K.storeType))}catch(Rd){n.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.To.WM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId,Rd.message)),ld(!1,K,null,null)}else ld(!1,K,null,null)}}hDi(K,Ia,Db,dc,xc,Rc){const fd=(ld,Dd,Rd,Pe)=>{Rc(ld,Dd,Rd,Pe);ld=Vg.a[this.Up]+Dd.solutionId;
({value:Dd}=this.QTa.Ic(ld)).returnValue&&(Dd.stop(),this.QTa.remove(ld))};if(6===this.Up&&K)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.To.WM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId))),this.lpg(K))try{if(this.wO){const Dd=Vg.a[this.Up]+K.solutionId,Rd=this.wO.Kc("ComponentAttach",Dd);this.QTa.ia(Dd,Rd)}const ld=this.YF.sja(K.storeType,K.solutionId);ld||fd(!1,K,null,null);
Fd.AFrameworkApplication.sa&&Fd.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.N1e(K,Ia,dc,xc,Db,Dd=>{fd(Dd,K,Db,ld.displayName)}):(this.N1e(K,Ia,dc,xc,Db),fd(!0,K,Db,ld.displayName))}catch(ld){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.To.WM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,
null,null,K.storeId),K.version,K.storeType,K.storeId,ld.message)),fd(!1,K,null,null)}else fd(!1,K,null,null)}kSi(K,Ia,Db,dc,xc,Rc){if(Rc)if(Rc._isAddinCommandsManifest(this.To.WM))try{Fd.AFrameworkApplication.sa&&Fd.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.M1e(K,Ia,Db,xc,Rc,fd=>{dc(fd,K,Rc,Rc.getDefaultDisplayName())}):(this.M1e(K,Ia,Db,xc,Rc),dc(!0,K,Rc,Rc.getDefaultDisplayName()))}catch(fd){n.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.To.WM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId,fd.message)),dc(!1,K,Rc,Rc.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.To.WM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,
K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId)),dc(!1,K,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.To.WM,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId)),dc(!1,K,null,null)}hJb(K,Ia,Db,dc){const xc={},Rc=document.createElement("div");Rc.setAttribute("visible",
"false");xc.div=Rc;xc.id=K.solutionId;xc.solutionId=K.solutionId;xc.version=K.version;xc.storeType=K.storeType;xc.storeId=K.storeId;xc.assetId=K.assetId;xc.assetStoreId=K.assetStoreId;xc.isvirtualOsfControl=!0;xc.virtualOsfControlActivationCallback=(fd,ld)=>{const Dd=this.YF.sja(K.storeType,K.solutionId);Dd&&(Dd.isUpgraded&&(K.isUpgraded=!0),this.T4b(Dd));this.kSi(K,Ia,Db,dc,fd,ld)};xc.reason=3===this.Up?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return xc}M1e(K,Ia,Db,dc,xc,Rc=null){const fd={};fd.solutionId=dc.getSolutionId();fd.version=dc.getVersion();fd.storeType=dc.getStoreType();fd.storeId=dc.getStoreId();fd.assetId=dc.getAssetId();fd.assetStoreId=dc.getAssetStoreId();fd.targetType=dc.getOsfControlType();let ld=null,Dd=null;if(Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))ld=(new OfficeExt.Parser.AddinCommandsManifestParser(this.To.WM,this.To.formFactor)).parseExtensions(fd,
xc,this.kha),Dd=ch.O5e(this.To.WM);else try{ld=(new OfficeExt.Parser.AddinCommandsManifestParser(this.To.WM,this.To.formFactor)).parseExtensions(fd,xc,this.kha),Dd=ch.O5e(this.To.WM)}catch(Pe){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Pe.message),Pe;}if(Dd&&0<Dd.count){if(Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Rd=Ia(K);Ia=Db(K);Db=!!Fd.AFrameworkApplication.fa&&
Fd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Rd=new ha(Rd,null,Ia);for(let Pe of Dd)Rd.commandSurface=Pe,ld.apply(Rd,this.kha,Db)}else try{let Pe=Ia(K),cf=Db(K),Bf=!!Fd.AFrameworkApplication.fa&&Fd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Rd=new ha(Pe,null,cf);for(let Bg of Dd)Rd.commandSurface=Bg,ld.apply(Rd,this.kha,Bf)}catch(Pe){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Pe.message),
Pe;}if(OSF.OUtil.checkFlight(14))try{let Pe=Rd.Vfd(K.solutionId,xc.getDefaultDisplayName()),cf=Rd.p1e();Pe&&this.ribbonManager.EZa(Pe,Rc);cf&&this.contextMenuManager.kqe(cf);this.YF.Sqe(dc,Pe,cf,xc.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",xc.getDefaultDisplayName())}catch(Pe){throw OfficeExt.DevConsole.log(Pe),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Pe.message),Pe;}else try{let Pe=Rd.Vfd(K.solutionId,xc.getDefaultDisplayName()),
cf=Rd.p1e();Pe&&this.ribbonManager.EZa(Pe);cf&&this.contextMenuManager.kqe(cf);this.YF.Sqe(dc,Pe,cf,xc.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",xc.getDefaultDisplayName())}catch(Pe){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Pe.message),Pe;}}}N1e(K,Ia,Db,dc,xc,Rc=null){const fd={};fd.solutionId=K.solutionId;fd.version=K.version;fd.storeType=K.storeType;fd.storeId=K.storeId;fd.assetId=K.assetId;fd.assetStoreId=
K.assetStoreId;fd.targetType=K.targetType;const ld=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.To.WM,this.To.formFactor);try{const Dd=Ia.getManifest(),Rd=ld.parse(fd,Dd,xc,this.kha,Ia.getSharedRuntimeId(),Ia),Pe=Db(K),cf=dc(K),Bf=new ha(Pe,null,cf);Bf.commandSurface="PrimaryCommandSurface";Rd.apply(Bf,this.kha,!0);if(Bf.ribbonBuilder.Ss&&0<Bf.ribbonBuilder.Ss.count){const Bg=Bf.Vfd(K.solutionId,Ia.getManifest().getDefaultDisplayName(),1);Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.EZa(Bg,Rc):Bg&&this.ribbonManager.EZa(Bg,Rc);this.YF.OMg(Ia,Bg,xc,Ia.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ia.getManifest().getDefaultDisplayName())}}catch(Dd){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ia.getManifest().getDefaultDisplayName(),Dd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Dd)}}T4b(K){K.Lo&&this.ribbonManager.hNd(K.Lo);
K.ftb&&this.contextMenuManager.umj(K.ftb);this.YF.amj(K.qB.getStoreType(),K.qB.getSolutionId())}$7g(K,Ia){Ia=wg.a(Ia);for(let Db of this.YF.Y6a){if(Db.qB.getStoreType()!==Ia)continue;let dc=!0;for(let xc of K){const Rc=xc;if(Rc&&Db.eof(Rc.storeType,Rc.solutionId)){dc=!1;break}}dc&&(this.T4b(Db),Db.qB.purge(!1))}}lpg(K){return!!K&&!!K.solutionId&&!!K.version&&!!K.storeType&&!!K.storeId}}Object(d.a)(gb,"AddInCommandsIntegration",null,[]);class hc{constructor(K,Ia,Db,dc,xc,Rc,fd,ld=null){this.Za=new eg.a;
this.cIc=K;this.$xg=Ia;this.zl=Db;this.xne=dc;this.lYa=xc;this.vvg=Rc;this.GSb=fd;this.hEg=ld;this.$Bg=Fd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}KOg(K){this.Za.addHandler(ca.a.Lte,K)}CQg(K){this.Za.addHandler(ca.a.Rwd,K)}cSg(K){this.Za.addHandler(ca.a.abg,K)}ROg(K){this.Za.addHandler(ca.a.s0c,K)}ADi(K,Ia,Db){const dc=Db[ca.a.Cpb],xc=void 0===Db[ca.a.aM]?0:Db[ca.a.aM];if(dc&&0!==xc)if(0>=dc.count&&4!==xc)this.dQf(new Ch(xc,null,null,Ia,null,
!0));else{var Rc=dc.count,fd=new Fh(new zf),ld=void 0===Db[ca.a.xP]?-1:Db[ca.a.xP],Dd=new gb(xc,this.zl,this.cIc,fd,this.$xg,this.lYa,this.GSb),Rd=og=>this.xne.i1g(og.solutionId,this.GSb,this.cIc,K),Pe=og=>this.xne.s0g(og.solutionId),cf=(og,jg,lg)=>{Rc--;lg=new Ch(xc,jg,fd,Ia,lg,0>=Rc);if(og&&jg)this.dQf(lg);else{if(3===xc||jg&&jg.isUpgraded)og="",jg&&(og=Telemetry.PrivacyRules.GetPrivacyCompliantId(jg.solutionId,jg.ownerAddinStoreType||jg.storeType,jg.assetId,null,null,jg.storeId)),jg={["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:og},ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.ki(jg)}));this.cQf(lg)}Rc||Fd.AFrameworkApplication.sa.updateCommandUI()},Bf=(og,jg,lg,zg)=>{cf(og,jg,zg)},Bg=()=>{this.NCd();0>=dc.count&&4===xc&&this.lYa.RSd()};6===xc?(ld=Db[ca.a.LJa],Db=Db[ca.a.MJa],Dd.hDi(dc.ma(0),ld,Db,Rd,Pe,(og,jg,lg,zg)=>{cf(og,jg,zg)})):Dd.hEb(dc,Rd,Pe,ld,Bf,Bg,this.hEg)}else ia.a.sendTelemetryEvent(Object.assign(new Rf.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.ki({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.cIc.WM)),this.cQf(new Ch(xc,null,null,Ia,null,!0))}cQf(K){this.NCd(K);this.Sbg(!1,K)}dQf(K){const Ia=K.kk;let Db=null;null!==Ia&&(Db=Ia.storeType,Db=Db.toLowerCase());if(K&&"omex"===Db&&(3===K.Up||Ia.isUpgraded)){var dc=
{["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.ownerAddinStoreType||Ia.storeType,Ia.assetId,null,null,Ia.storeId)};ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.ki(dc)}))}this.NCd(K);dc=lh()&&"omex"===Db&&!!K.KW&&!!Ia.solutionId&&2===K.Up&&Ia.solutionId.toLowerCase()===Ig().toLowerCase();var xc="excatalog"===Db&&3===K.Up;if("omex"===Db&&K.KW&&(3===
K.Up&&"hardcodedpreinstall"!==Db||Ia.isUpgraded)||dc||xc)dc=new Mg,dc.kk=Ia,dc.Lo=K.KW.fya,this.Za.raiseEvent(ca.a.s0c,dc);this.$Bg&&(dc=ph(),xc=Ig(),dc&&Ia&&"excatalog"===Ia.storeType&&K.KW&&5===K.Up&&xc&&(Ia.storeId&&Ia.storeId.toLowerCase()===xc.toLowerCase()||Ia.assetId&&Ia.assetId.toLowerCase()===xc.toLowerCase())&&(dc=new Mg,dc.kk=Ia,dc.Lo=K.KW.fya,this.Za.raiseEvent(ca.a.s0c,dc),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));Ia&&(sf.instance.h6f(wg.b(Db),
!0),"uploadfiledevcatalog"===Db&&(dc=this.vvg.createAddinDataProvider(Db,this.zl))&&dc.localCacheAddinCommands(this.zl.ida,Ia.solutionId,Ia.version,Ia.storeId),gg.a.Qgb(ca.a.Epb,"true",wg.b(Db)));this.Sbg(!0,K)}Sbg(K,Ia){K?Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ia.KW&&5===Ia.Up&&Ia.KW.fya&&void 0!==Ia.kk.showCallout&&null!==Ia.kk.showCallout&&Ia.kk.showCallout?(Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)?(new Ug(this.Za)).QXc(Ia.kk,Ye.a.C4a(Ia.KW.fya)):(new ih(this.Za,Ia.kk,Ye.a.C4a(Ia.KW.fya))).QXc(),K=new Mg,K.Lo=Ia.KW.fya,K.kk=Ia.kk,this.Za.raiseEvent(ca.a.abg,K)):3!==Ia.Up?Ia.Zqf&&this.lYa.RSd():Ia.KW&&Ia.KW.fya&&"hardcodedpreinstall"!==Ia.kk.storeType&&kf.a.eNj(Ia.displayName,Ia.KW.fya,Ia.kk.isAutoLaunched):3===Ia.Up?Ia.kk&&"uploadfiledevcatalog"===Ia.kk.storeType.toLowerCase()?(Ia=this.GSb.mYh(Ia.kk.solutionId),kf.a.PVd(Ia?Ia:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.lYa.o7f():Ia.Zqf&&this.lYa.RSd()}NCd(K=null){var Ia=K?K.kk:null;const Db=new Mg;if(Db.kk=Ia){var dc=this.lYa.sja(Ia.storeType,Ia.solutionId,6===K.Up?1:0);if(dc&&dc.Lo){Db.Lo=dc.Lo;var xc=Ig();xc=lh()&&!!Ia.solutionId&&!!xc&&Ia.solutionId.toLowerCase()===xc.toLowerCase()&&2===K.Up;if(3===K.Up&&"hardcodedpreinstall"!==Ia.storeType||xc)K="",dc.Lo.aW&&dc.Lo.aW.Ss&&(dc=dc.Lo.aW.Ss.ma(0))&&(K=dc.id),Ia={["SDX_CommandPlacement"]:K,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,
Ia.ownerAddinStoreType||Ia.storeType,Ia.assetId,null,null,Ia.storeId)},ia.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Sb.a.ki(Ia)}))}}this.Za.raiseEvent(ca.a.Lte,Db)}}Object(d.a)(hc,"LaunchAddinCommandsHandler",null,[902]);class uc{}uc.uVa="Alt";uc.vVa="Command";uc.id="Id";uc.yVa="Image16by16";uc.qSb="LabelText";uc.zVa="Title";uc.GROUP="Group";uc.U4d="Groups";uc.Uhb="Controls";uc.button="Button";uc.aba="FlyoutAnchor";uc.LARGE="Large";uc.SMALL=
"Small";Object(d.a)(uc,"AddinDataNodeConstants",null,[]);var kd=a(382);a(573);var Ud=a(570);a(140);class ze{constructor(K,Ia){this.lFa=this.A8d=null;if(cd.c(K)||cd.c(Ia))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.fyg=Ia;this._id=K;this.iU[uc.id]=this._id}get id(){return this._id||""}get iU(){return this.A8d||(this.A8d={})}get controlType(){return this.fyg||
""}get menuItems(){return this.lFa||(this.lFa=new l.a)}}Object(d.a)(ze,"ControlDefinition",null,[895]);class Re{constructor(K){this.Rfe=null;if(cd.c(K))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=K;this.nma[uc.id]=this._id}get nma(){return this.Rfe||(this.Rfe={})}get id(){return this._id||""}}Object(d.a)(Re,"MenuItemDefinition",null,[897]);class ef{constructor(K){this.tqa=
null;if(cd.c(K))throw n.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=K}get id(){return this._id}get controls(){return this.tqa||(this.tqa=new l.a)}}Object(d.a)(ef,"OfficeMenuDefinition",null,[896]);var df=a(25);class Zd{constructor(K,Ia,Db){this.YI=this.mWa=null;this.kRc=K;this.cWa=Ia;this.BVa=Db;this.FDg=new l.a}get Poc(){return this.kRc}get Gsb(){return this.cWa}get TWc(){return this.BVa}addButton(K){n.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",K.actionType);this.YI=new ze(this.lta(K.id),uc.button);this.YI.iU[uc.qSb]=K.label;this.YI.iU[uc.uVa]=K.label;this.YI.iU[uc.yVa]=K.icon["16"];this.Yqb(this.YI.iU[uc.id],K.action);this.IGa(this.YI.iU);this.mWa.controls.add(this.YI);this.YI=null}startBuildMenu(K){if(cd.c(this.mWa))this.mWa=new ef(K.id);else{const Ia=this.lta(K.id);this.YI=new ze(Ia,uc.aba);this.p0a(this.YI.iU,K);this.YI.iU[uc.yVa]=K.icon["16"];this.YI.iU[uc.vVa]=df.a.alwaysEnabled}}addMenuItem(K){n.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",K.actionType);const Ia=new Re(this.lta(K.id));this.p0a(Ia.nma,K);K.icon&&(Ia.nma[uc.yVa]=K.icon["16"]);this.Yqb(Ia.nma[uc.id],K.action);this.IGa(Ia.nma);this.YI.menuItems.add(Ia)}endBuildMenu(){cd.c(this.YI)?(this.ioc.add(this.mWa),this.mWa=null):(this.mWa.controls.add(this.YI),this.YI=null)}get ioc(){return this.FDg}Yqb(K,Ia){this.TWc.bindAction(K,Ia)}IGa(K){this.Gsb.IGa(K)}lta(K){return this.Poc.fLa(K)}p0a(K,Ia){K[uc.qSb]=Ia.label;K[uc.uVa]=Ia.label}}
Object(d.a)(Zd,"ContextMenuExtensibilityCreator",null,[894,890]);class M{constructor(K){this.$lb=K}get XFb(){return this.$lb}fLa(K){return this.XFb+K}}Object(d.a)(M,"DefaultContextMenuNamingProvider",null,[893]);var sa=a(1346);class Sa{bindAction(K,Ia){OfficeExt.DefaultControlActionBinder.bindAction(K,Ia)}}Object(d.a)(Sa,"DefaultUIControlActionBinder",null,[892]);class Mb{constructor(K){this.UDa=K}get command(){return this.UDa}IGa(K){K[uc.vVa]=this.command}}Object(d.a)(Mb,"DefaultUIControlCommandBinder",
null,[891]);var fc=a(32);class lc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(d.a)(lc,"AddInControl",null,[]);class pc{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(d.a)(pc,"AddInGroup",null,[]);class Tc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(d.a)(Tc,"AddInMenuItem",null,[]);class pd{constructor(){this.groups=
this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(d.a)(pd,"AddInTab",null,[]);class vd{constructor(K,Ia,Db,dc,xc,Rc){this.DSb=new l.a;this.jjb=this.vfa=this.nWa=null;this.kRc=K;this.BVa=Ia;this.cWa=Db;this.sx=dc;this.GSb=xc;this.E$d=Rc}get Poc(){return this.kRc}get Ss(){return this.DSb}get TWc(){return this.BVa}get Gsb(){return this.cWa}startBuildTab(K){const Ia=K.isOfficeTab?K.id:this.Poc.g$e(K.id),
Db=K.isOfficeTab?null:K.label;this.nWa=Object.assign(new pd,{id:Ia,title:Db,isOfficeTab:K.isOfficeTab,visible:K.visible,groups:[],tabType:K.tabType,insertBefore:K.insertBefore,insertAfter:K.insertAfter,autoFocus:K.autoFocus})}startBuildGroup(K){const Ia=this.lta(K.id);this.vfa=Object.assign(new pc,{id:Ia,mlrId:K.mlrId,title:K.label,controls:[],groupType:0})}addNativeGroup(K){this.vfa=Object.assign(new pc,{id:K.id,mlrId:K.mlrId,title:K.label,controls:[],groupType:1});this.nWa.groups.push(this.vfa)}addButton(K){const Ia=
this.lta(K.id);Ia&&(this.Yqb(Ia,K.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",K.actionType),K=Object.assign(new lc,{id:Ia,title:K.label,iconLocation:this.Fid(K),enabled:K.enabled,controlType:0,attributes:this.p0a()}),this.E$d.Vpe(new fc.a(Ia,this.Gsb.command.toString())),this.vfa.controls.push(K))}addNativeControl(K){K.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",K.actionType),K=Object.assign(new lc,{id:K.id,
title:"",iconLocation:"",enabled:K.enabled,controlType:2,attributes:this.p0a()}),this.vfa.controls.push(K))}startBuildMenu(K){const Ia=this.lta(K.id);Ia&&(this.jjb=Object.assign(new lc,{id:Ia,title:K.label,iconLocation:this.Fid(K),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(K){const Ia=this.lta(K.id);Ia&&(this.Yqb(Ia,K.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",K.actionType),K=Object.assign(new Tc,{id:Ia,title:K.label,iconLocation:this.Fid(K),
enabled:K.enabled,attributes:this.p0a()}),this.E$d.Vpe(new fc.a(Ia,this.Gsb.command.toString())),this.jjb.menuItems.push(K))}endBuildMenu(){cd.c(this.jjb.id)||this.vfa.controls.push(this.jjb);this.jjb=null}endBuildGroup(){cd.c(this.vfa.id)||this.nWa.groups.push(this.vfa);this.vfa=null}endBuildTab(){cd.c(this.nWa.id)||this.DSb.add(this.nWa);this.nWa=null}p0a(){const K={};this.IGa(K);return K}Fid(K){return K.icon["80"]?K.icon["80"]:K.icon["32"]}IGa(K){this.Gsb.IGa(K)}lta(K){return this.Poc.fLa(K)}Yqb(K,
Ia){this.TWc.bindAction(K,Ia)}}Object(d.a)(vd,"OneLineRibbonExtensibilityCreator",null,[889,890]);class Xd{constructor(K,Ia){this.$lb=K;this.BVa=new Sa;this.cWa=new Mb(Ia)}s0g(K){K=new M(K);return new Zd(K,this.cWa,this.BVa)}i1g(K,Ia,Db,dc){Db=new sa.a(this.$lb,K,Db,!0);return new vd(Db,this.BVa,this.cWa,K,Ia,dc)}}Object(d.a)(Xd,"UIExtensibilityFactory",null,[880]);var pe=a(96),Qe=a(885),hf=a(22),Ne=a(38),Ve=a(73),yf=a(50);class nf{constructor(K){this.XGa=this.bHa=this.kk=this.Lo=null;this.IXf=0;
this.z_i=()=>{if(this.kk&&this.XGa){const Ia=new pe.a(df.a.v2,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Ia,{["SourceControlId"]:this.XGa},null);n.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.fNj=(Ia,Db)=>{Ia=null;if(Db)if(Ia=Db,this.kk=Ia.kk,(this.Lo=Ia.Lo)&&this.Lo.aW&&this.Lo.aW.Ss&&(this.bHa=this.Lo.aW.Ss.ma(0)),this.bHa&&this.bHa.id)if(this.bHa.isOfficeTab)if(Db=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Ia=
this.kk.solutionId,Ia in Db?this.XGa=Db[Ia]:(Db=nf.GetPrivacyCompliantId(this.kk),n.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Db}`),this.XGa=this.$Rh(this.Lo)),this.XGa)if(hf.a.contains(this.bHa.id,rc.a.uW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ye.a.C4a(this.Lo),()=>{this.ucg(this.Pjd(this.XGa))});else{if(Db=this.$.Ia)Db.Cte(this.HLf),n.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else n.ULS.sendTraceTag(537170694,
220,10,"Failed to get button id for addin"),Db={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:nf.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(Db)})),this.W5();else this.wcg(this.Pjd(this.bHa.id),0);else n.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
Db={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:nf.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(Db)})),this.W5();else this.W5()};this.HLf=()=>{if(hf.a.contains(this.bHa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ia=this.$.Ia;Ia&&Ia.FZf(this.HLf);this.ucg(this.Pjd(this.XGa))}};this.B_i=
()=>{var Ia={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:nf.wVa(this.BC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(Ia)}));this.W5();let Db={};Db[Ve.a.Sf]=this.BC;Ia={};Ia.solutionId=this.BC.solutionId;Ia.assetId=this.BC.assetId;Ia.assetStoreId=this.BC.assetStoreId;Ia.height=0!=this.BC.height?this.BC.height:600;Ia.storeId=
this.BC.storeId;Ia.storeType=this.BC.storeType;Ia.targetType=this.BC.targetType;Ia.width=0!=this.BC.width?this.BC.width:600;Ia.displayName=this.BC.displayName;Ia.version=this.BC.version;Ia.isAddinCommands=!1;Db[ca.a.V9]=Ia;let dc=new pe.a(-741808261,0,0,2,null);Ne.TaskExtensions.za(yf.GetServiceTaskFactory.Pa(this.$.da,374,375,1),xc=>{xc=xc.result;null!=xc&&xc.insertAgave(Db,dc)},this.$.ka,3)};this.kUi=()=>{let Ia={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:nf.wVa(this.BC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(Ia)}));this.W5()};this.HVi=()=>{let Ia={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:nf.wVa(this.BC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(Ia)}));this.W5()};
this.ON=Ia=>{n.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Ia?Ia.httpStatus:-1}`)};this.$=K.$;this.addinUICommandHandler=K;this.appName=Fd.AFrameworkApplication.fa.Wa("WebAppShortName")||"Excel";this.JSg=Fd.AFrameworkApplication.fa.Ad("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static wVa(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,
K.storeType,K.assetId,null,null,K.storeId)}ulj(K){this.BC=K;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.B_i,!0),window.addEventListener("DismissCallout",this.HVi,!0),window.addEventListener("CloseCallout",this.kUi,!0))}Pjd(K){return"[id="+K+"]"}wcg(K,Ia){Ia>this.JSg?(window.clearTimeout(this.IXf),this.vcg("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+
K)?this.vcg(K):this.IXf=window.setTimeout(()=>{this.wcg(K,Ia+1)},1E3)}ucg(K){var Ia=document.querySelector("button[data-unique-id='RightPaddle']");if(Ia)K={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:nf.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)}));else if(Ia=document.querySelector("button"+
K),!Ia||"none"===window.getComputedStyle(Ia).display)if(Ia=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ia){Ia={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:nf.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(Ia)}));n.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");
this.W5();return}this.Zig(Ia,"ShowTeachingUIForAddinButton")}vcg(K){K=document.querySelector("button"+K);if(!K&&(K=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!K)){K={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:nf.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)}));n.ULS.sendTraceTag(537170690,
220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.W5();return}this.Zig(K,"ShowTeachingUIForAddinTab")}Zig(K,Ia){K.setAttribute("lpp-id","latestAddin");const Db=Of.a.instance.Tb("Common.ISystemInitiatedFeedback");Db&&K?(Db.execute(dc=>{dc.logActivity(Ia,null)}),K={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:nf.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)})),n.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(n.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),K={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:nf.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)})),this.W5())}$Rh(K){if(!K)return null;K=K.aW;if((null===K||void 0===K?0:K.Ss)&&0<K.Ss.count)for(let Ia of K.Ss)if(Ia.groups&&0<Ia.groups.length)for(const Db of Ia.groups)if(Db.controls&&0<Db.controls.length)for(const dc of Db.controls){if(dc.attributes&&0===dc.controlType&&dc.enabled)return dc.id;if(dc.menuItems)for(const xc of dc.menuItems)if(xc.attributes&&xc.enabled)return dc.id}return null}zPj(){var K=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");
if(K&&"none"!==window.getComputedStyle(K).display)n.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{K=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==K){K={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:nf.wVa(this.BC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)}));
n.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.W5();return}n.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Ia=Of.a.instance.Tb("Common.ISystemInitiatedFeedback");null==Ia||null==K?(K={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:nf.wVa(this.BC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Sb.a.ki(K)})),n.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.W5()):(Ia.execute(Db=>{Db.logActivity("ShowTeachingUIForContentAddin",null)}),K={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:nf.wVa(this.BC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki(K)})),n.ULS.sendTraceTag(527286664,
220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}fBa(K){const Ia={},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=K;Ia[this.appName]=ng.c(Db);this.Ipb=new Hg(this.appName,null,null,this.ON),this.Ipb.T3a(Ia),n.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}W5(){if(!this.cea){const K=window.g_roamingAddinList;K&&(this.fBa(K),this.cea=!0)}}}Object(d.a)(nf,"AddinTeachingCalloutHandler",
null,[]);var Hf=a(1269),bg=a(428),vf=a(11),Cf=a(196),Zf=a(42),If=a(21),tg=a(58),Eg=a(156),kg=a(192);class Oh extends Eg.a{constructor(K,Ia,Db,dc){super();this.CX="calc(100% - 46px)";this.A8="15px";this.DX="0";this.Bjb="WACDialogPanel";this.CG=695;this.Cjb=462;this.z1="80%";this.pib=350;this.jqa="100%";this.VS=null;this.Rb=5;this.we="AddinInstallDialog";this.kwg=K;this.OX=Ia;this.aJg=Db;this.nEg=dc}Tw(){super.Tw();this.Th.style.width=this.jqa;this.Th.style.height=this.CX;this.Th.style.marginTop=this.A8;
this.Th.style.padding=this.DX;document.getElementById(this.Oh("WACDialogButtonPanel")).style.display="none";this.aia.setAttribute("tabindex","0");$addHandler(this.aia,"keyup",Object(Wd.a)(this,this.onKeyUp,"onKeyUp"));const K=document.createElement("iframe");K.setAttribute("id","InstallAddinDialog");K.setAttribute("src","about:blank");K.setAttribute("width","100%");K.setAttribute("height","100%");K.setAttribute("marginHeight","0");K.setAttribute("marginWidth","0");K.setAttribute("frameBorder","0");
K.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const Ia=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.kwg,this.OX,this.aJg);K.setAttribute("src",Ia);this.VS=K;$addHandler(K,"load",Object(Wd.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(Wd.a)(this,this.onMessage,"onMessage"));this.Th.appendChild(K);this.Th.appendChild(this.Mgh())}Mgh(){const K=document.createElement("div");
K.setAttribute("tabindex","0");$addHandler(K,"focus",Object(Wd.a)(this,this.V_i,"onLoopPivotFocus"));return K}onKeyUp(K){13!==K.keyCode&&32!==K.keyCode||this.hide()}V_i(){this.aia.focus()}onLoad(){this.VS.focus()}onMessage(K){K=K.rawEvent;if(K.source===this.VS.contentWindow&&(K=(K=K.data)?K.split("|"):null)&&0<K.length&&("REFRESH_REQUIRED"===K[0]||"PRELOAD_MANIFEST"===K[0])){of.a.instance.setItem("refreshRequired","true");const Ia={};Ia.solutionId=K[1];Ia.version=Oh.UPi(K[3]);Ia.storeType=K[4];Ia.storeId=
K[5];Ia.assetId=K[6];Ia.targetType=Oh.N8i(K[2]);Ia.assetStoreId=K[7];Ia.width=parseInt(K[8]);Ia.height=parseInt(K[9]);this.nEg(Ia)}}rna(){this.Th.style.width=this.jqa;this.Th.style.height=this.CX;this.Th.style.marginTop=this.A8;this.Th.style.padding=this.DX;this.CG>kg.a.S_?(this.ib.style.width=String.format("{0}px",kg.a.S_),this.ib.style.overflowX="scroll",Fd.AFrameworkApplication.isRtl?this.ib.style.right="0":this.ib.style.left="0"):(this.ib.style.width=String.format("{0}px",this.CG),this.ib.style.overflowX=
"hidden");this.ib.offsetHeight>kg.a.R_||this.Cjb+50>kg.a.R_?(this.ib.style.height=String.format("{0}px",kg.a.R_),this.ib.style.overflowY="scroll",this.ib.style.top="0",Fd.AFrameworkApplication.isRtl?this.ib.style.right="0":this.ib.style.left="0",this.Th.style.minHeight=String.format("{0}px",this.pib)):(this.ib.style.overflowY="hidden",this.ib.style.top="10%",this.ib.style.height=this.z1);this.F$()}F$(){if(this.ib){var K=this.ib.style.zIndex;this.ib.style.zIndex="-9999";if(this.CG>kg.a.S_)Fd.AFrameworkApplication.isRtl?
this.ib.style.marginRight="0":this.ib.style.marginLeft="0";else{const Ia=String.format("{0}px",Math.floor(-this.ib.offsetWidth/2));Fd.AFrameworkApplication.isRtl?this.ib.style.marginRight=Ia:this.ib.style.marginLeft=Ia;Fd.AFrameworkApplication.isRtl?this.ib.style.right="50%":this.ib.style.left="50%"}this.ib.style.zIndex=String(K)}else n.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}LD(){super.LD();const K=document.getElementById(this.Oh(this.Bjb));K.style.width=String.format("{0}px",
this.CG);K.style.height=this.z1}get taa(){return this.Th}dispose(){super.dispose();$removeHandler(window,"message",Object(Wd.a)(this,this.onMessage,"onMessage"))}static N8i(K){switch(K){case "1":return 0;case "2":return 1;default:return 0}}static UPi(K){const Ia=K.split(".");for(let Db=0;Db<4-Ia.length;Db++)K+=".0";return K}}Object(d.a)(Oh,"AddinInstallDialog",Eg.a,[]);var ah;(function(K){K[K.OK=0]="OK";K[K.notReady=1]="notReady";K[K.storeDisabled=2]="storeDisabled";K[K.invokeFailure=3]="invokeFailure"})(ah||
(ah={}));Object(d.b)("AddinDetailsQueryError",ah);class Yh{constructor(K){this.YTc=K}next(K){this.YTc=(9301*this.YTc+49297)%233280;return Math.floor(this.YTc/233280*K)}}Object(d.a)(Yh,"Random",null,[]);class mi{constructor(){this.buttonText=this.buttonId=this.links=this.description=this.title=this.icon=this.buttonCommandId=this.commandId=this.id=null}}Object(d.a)(mi,"AddInListItemProps",null,[]);class Wc{constructor(){this.text=this.href=null}}Object(d.a)(Wc,"AddInListLinkProps",null,[]);var Kd=a(987),
jh=a(988),$i=a(587);class ni{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(d.a)(ni,"GallerySectionProps",null,[]);var vi=a(1345),Zh=a(179);class $h{constructor(K,Ia,Db,dc,xc,Rc=null){this.Ofa={};this.qkb={};this.TWa=0;this.Gie=!1;this.aib=0;this.Uae=!1;this.Hle=!0;this.a$d=0;this.ISb=Ia;this.iJ=null;this.XCg=Db;this.ZCg=dc;this.zGg=xc;this.fb=Rc||Fd.AFrameworkApplication.fa;K=this.txi?Object(Wd.a)(this,this.vDd,"onAddinDetailsRefreshed"):Object(Wd.a)(this,
this.LWf,"registerIcons");this.ISb.Wuc(K);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1));appChrome.addInApi.loadOfficeAddInIcons()}get VHe(){return this.qkb}LWf(K,Ia){if(Ia.IT)for(K=0;K<Ia.IT.length;K++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+Ia.IT[K].solutionId,Ia.IT[K].iconUrl);else n.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get txi(){return!!this.fb&&this.fb.isChangeGateEnabled("Microsoft.Office.SharedOnline.FlyoutGeneratorRefactorEnabled")}get Jsd(){return!!this.fb&&
this.fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}qKj(K){0===K.Jsa&&(this.aib|=1);1===K.Jsa&&(this.aib|=2);return!!this.aib}vDd(K,Ia){this.LWf(K,Ia);this.qKj(Ia)&&(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1)),this.fb.isChangeGateEnabled("OfficeVSO:7611216_UnderstandDataProvider")&&n.ULS.sendTraceTag(509224609,220,50,"UnderstandDataProvider, Flyout button enabled, collectionType: {0}",Oc.a[Ia.Jsa]),this.fb&&
this.fb.isChangeGateEnabled("OverflowTelemetryForAddinButton")&&this.IHi())}U9i(K){const Ia=[];var Db=new Yh((new Date).getDate());for(var dc=0;8>dc;dc++)Array.add(Ia,Db.next(K.count));Db=0;for(let xc of K){dc=!1;for(const Rc of Ia)if(Db===Rc){dc=!0;break}Db++;if(dc){let Rc;(Rc=xc.addinInfo).AUP=20*Rc.AUP}else if(1===xc.addinInfo.priority){let Rc;(Rc=xc.addinInfo).AUP=4*Rc.AUP}else if(2===xc.addinInfo.priority){let Rc;(Rc=xc.addinInfo).AUP=2*Rc.AUP}}K.Sc((xc,Rc)=>xc.addinInfo.AUP<Rc.addinInfo.AUP?
1:-1);return K}V9i(K){for(let Ia of K)if(1===Ia.addinInfo.priority){let Db;(Db=Ia.addinInfo).AUP=4*Db.AUP}else if(2===Ia.addinInfo.priority){let Db;(Db=Ia.addinInfo).AUP=2*Db.AUP}K.Sc((Ia,Db)=>Ia.addinInfo.AUP<Db.addinInfo.AUP?1:-1);return K}jaa(K,Ia){const Db={};Db.width=K;Db.height=Ia;Db.backgroundColor="transparent";return Db}b7c(){return{flexDirection:"column"}}u7c(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2",
"-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"}}VZh(){const K={},Ia={},Db={};Ia.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};Ia.inner={margin:"-4px"};Db.root=this.jaa(100,100);Db.flexContainer=this.b7c();Db.label=this.u7c();K.galleryButtonInExpanded=Db;K.galleryStack=Ia;return K}PQh(){return Object.assign(new vi.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"QuickSearchNoCategories_16",
Command:this.zGg,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}JPh(K,Ia,Db){K=Object.assign(new vi.a,{Id:Db,ExternalId:Db,Icon:"AddinFlyoutControl"+Ia.solutionId,Command:K===CommonUIStrings.l_PopularAddins?this.XCg:this.ZCg,LabelText:Ia.displayName,
FullIconStyle:{root:{width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"}},Alt:Ia.displayName});this.fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)&&(K.Alt=Ia.description);return K}aaj(K,Ia,Db){const dc=Object.assign(new ni,{SectionId:K,Title:K,GalleryButtons:[]});for(let xc=0;xc<Db;xc++)Array.add(dc.GalleryButtons,this.JPh(K,Ia[xc],this.Ofa[Ia[xc].solutionId]));return dc}j5h(){var K=[];const Ia=this.ISb.jgd(0);
Array.addRange(K,Ia.IT);const Db=this.ISb.jgd(1);Array.addRange(K,Db.IT);let dc=K.length;this.a$d=0<dc?5:6;Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&n.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",dc,ah[Ia.errorCode],Ia.IT.length,ah[Db.errorCode],Db.IT.length);K.sort((Pe,cf)=>{Pe=Zh.d(Pe.displayName);cf=Zh.d(cf.displayName);return Cg.a.localeCompare(Pe,cf)});const xc=
6<dc;xc&&(dc=5);if(this.fb.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))for(var Rc=0;Rc<dc;Rc++)this.Yze(K[Rc]);else for(Rc=0;Rc<dc;Rc++)if(!(K[Rc].solutionId in this.Ofa)){var fd="AddinGalleryButton"+this.TWa.toString();this.Ofa[K[Rc].solutionId]=fd;this.qkb[fd]=K[Rc].solutionId;this.TWa++}let ld=[];Rc=null;if(this.iJ)ld=this.iJ;else if(Rc=this.ISb.jgd(2),0===Rc.errorCode)if(this.fb.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))Rc.IT.forEach(Pe=>
{-1!==Pe.addinInfo.priority&&(this.Yze(Pe),ld.push(Pe))});else for(ld=Rc.IT,Rc=0;Rc<ld.length;Rc++)ld[Rc].solutionId in this.Ofa||(fd="AddinGalleryButton"+this.TWa.toString(),this.Ofa[ld[Rc].solutionId]=fd,this.qkb[fd]=ld[Rc].solutionId,this.TWa++);Rc=!0;ld.length||(Rc=!1);fd=0;if(Rc&&(fd=K.length?3>=K.length?9:6:12,ld=this.Jsd?this.RVg(ld,K):this.QVg(ld,K),fd>ld.length&&(fd=ld.length),Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&
!this.Gie&&!this.Jsd)){var Dd="",Rd="";for(let Pe=0;Pe<ld.length&&Pe<fd;Pe++)Dd+=ld[Pe].displayName,Dd+=",",Rd+=ld[Pe].solutionId,Rd+=",";n.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",fd,Dd,Rd);this.Gie=!0}Dd=Object.assign(new Pc.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Rd=Object.assign(new kd.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});
Array.add(Dd.ControlList,Rd);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));Dd=Object.assign(new Ud.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Dd,UpdateDynamically:!0});2!==Ia.errorCode||K.length?3===Ia.errorCode||3===Db.errorCode?(n.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),K=this.s1e("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Dd.MenuSectionList,K)):(0<
dc&&this.LIe(Dd,K,dc,"MRUAddins",CommonUIStrings.l_MyAddinSection,xc),Rc&&(this.Jsd?Array.add(Dd.MenuSectionList,this.EQh(ld,this.a$d)):this.LIe(Dd,ld,fd,"PopularAddins",CommonUIStrings.l_PopularAddins))):(n.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),K=this.s1e("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Dd.MenuSectionList,K));return Dd}EQh(K,Ia){const Db=Object.assign(new Pc.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[]}),
dc=Object.assign(new Kd.a,{Id:"PopularAddInsList",ExternalId:"PopularAddInsList",Items:[]});for(let xc=0;xc<0+Ia&&xc<K.length;xc++)this.hPh(dc.Items,K[xc]);Array.add(Db.ControlList,dc);return Db}hPh(K,Ia){const Db=[];var dc=Object.assign(new Wc,{text:CommonUIStrings.l_AddinListPrivacy,href:Ia.privacyUrl});Array.add(Db,dc);dc=Object.assign(new Wc,{text:CommonUIStrings.l_AddinListLicense,href:Ia.licenseUrl});Array.add(Db,dc);dc=Object.assign(new Wc,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+
Ia.solutionId});Array.add(Db,dc);Ia=Object.assign(new mi,{id:this.Ofa[Ia.solutionId],icon:"AddinFlyoutControl"+Ia.solutionId,title:Ia.displayName,description:Ia.description,links:Db,buttonText:CommonUIStrings.l_AddinListAdd,buttonId:this.Ofa[Ia.solutionId]+"Add",buttonCommandId:"2882601901",commandId:"1497204054"});Array.add(K,Ia)}Yze(K){if(!(K.solutionId in this.Ofa)){const Ia="AddinGalleryButton"+this.TWa.toString();this.Ofa[K.solutionId]=Ia;this.qkb[Ia]=K.solutionId;this.qkb[Ia+"Add"]=K.solutionId;
this.TWa++}}s1e(K,Ia){const Db=Object.assign(new Pc.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});K=Object.assign(new jh.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:K,Label:Ia});Array.add(Db.ControlList,K);return Db}QVg(K,Ia){var Db=new l.a;for(let dc=0;dc<K.length;dc++)Db.add(K[dc]);this.iJ||(8<Db.count&&(Db=this.U9i(Db)),this.iJ=Db.toArray());for(K=0;K<this.iJ.length;K++)for(Db=0;Db<Ia.length;Db++)if(this.iJ[K].solutionId.toLowerCase()===Ia[Db].solutionId.toLowerCase()){Array.remove(this.iJ,
this.iJ[K--]);break}return this.iJ}RVg(K,Ia){var Db=new l.a;for(let dc=0;dc<K.length;dc++)Db.add(K[dc]);this.iJ||(8<Db.count&&(Db=this.V9i(Db)),this.iJ=Db.toArray());if(this.Hle){for(K=0;K<this.iJ.length;K++)for(Db=0;Db<Ia.length;Db++)if(this.iJ[K].solutionId.toLowerCase()===Ia[Db].solutionId.toLowerCase()){Array.remove(this.iJ,this.iJ[K--]);break}this.Hle=!1}return this.iJ}LIe(K,Ia,Db,dc,xc,Rc=!1){const fd=Object.assign(new Pc.a,{Id:dc+"Section",ControlsId:dc+"Section.Controls",ControlList:[]});
dc=Object.assign(new $i.a,{Id:dc+"GalleryControl",ExternalId:dc+"GalleryControl",GalleryStyle:this.VZh(),Width:3,Type:4,GallerySections:[]});Array.add(K.MenuSectionList,fd);Array.add(fd.ControlList,dc);K=this.aaj(xc,Ia,Db);Rc&&Array.add(K.GalleryButtons,this.PQh());dc.GallerySections.push(K)}eaj(K){if(K)try{K.MenuItems=this.j5h()}catch(Ia){n.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(Ia?Ia.toString():""))}else n.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}IHi(){if(!this.Uae&&
this.wyc){var K=appChrome.selectors.getSelectedTabId();K&&Zh.a(K,"Home")&&((K=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(K,"").display||n.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.Uae=!0)}}get wyc(){return!!window.appChrome&&!!appChrome.selectors}}Object(d.a)($h,"AppsFlyoutGenerator",null,[3]);var Pi=a(70),Sh=a(108),wh=a(153),Th=a(54);class Qi{constructor(K,Ia,Db,dc,xc,Rc,fd=null){this.disposed=!1;this.i1b=null;this.Bpb=0;this.Zci=ld=>
{if(ld)if(ld=this.r_c.VHe[ld]){var Dd=this.Fd.Lg;Dd=Dd?Dd.getAppUILocale()||"en-US":"en-US";this.i1b=new Oh(ld,"wac_excel",Dd,Rd=>{this.Fd.jrc("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Rd);const Pe=new pe.a(-741808261,0,this.$.xc,0,null);this.$.Ia.Hb(Pe,{[ca.a.V9]:Rd,[Ve.a.Sf]:this.Fd.XIa(Rd)});this.i1b&&this.i1b.hide();A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(Rd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.solutionId,
Rd.storeType,Rd.assetId,null,null,Rd.storeId),ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:Sb.a.ki({SolutionId:Rd})})))});this.i1b.initializeAndShow("",null,null)}else n.ULS.sendTraceTag(509362328,220,10,"Solution id is null.");else n.ULS.sendTraceTag(509362329,220,10,"Control id is null.")};this.adi=ld=>{if(ld)if(ld=this.r_c.VHe[ld])if(ld=this.b0h(ld)){var Dd={[ca.a.V9]:ld,[Ve.a.Sf]:this.Fd.XIa(ld)},Rd=new pe.a(-741808261,
0,this.$.xc,0,"");this.$.Ia.Hb(Rd,Dd);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(ld=Telemetry.PrivacyRules.GetPrivacyCompliantId(ld.solutionId,ld.storeType,ld.assetId,null,null,ld.storeId),ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Sb.a.ki({SolutionId:ld})})))}else n.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.");else n.ULS.sendTraceTag(509362326,
220,10,"SolutionId is null.");else n.ULS.sendTraceTag(509362327,220,10,"Control id is null.")};this.RSi=(ld,Dd)=>{if(Dd)if(Dd)if(ld=Dd.kk){if(lh()||ph()){const Pe=this.$.ea.workbookContext.WebExtensions;if(Pe){let cf=!1;for(var Rd of Pe)if(Rd.PrimaryMarketplace.SolutionId.toLowerCase()===ld.solutionId.toLowerCase()){cf=!0;break}if(!cf){n.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{n.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");
return}}Dd=Dd.Lo;Rd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(ld.solutionId in Rd)Dd=Rd[ld.solutionId];else if(Dd=this.YVh(Dd),void 0===Dd||null===Dd){n.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Rd=new pe.a(df.a.v2,0,0,2,null);this.executeCommand(0,Rd,{["SourceControlId"]:Dd},null);ld.isAutoLaunched=!0}else n.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else n.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");
else n.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.vhf=(ld,Dd)=>{"Insert"==Dd.tabName&&(ld=this.$.Ia,null!=ld&&(ld.FZf(this.vhf),n.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.NPb.zPj())};this.A_i=(ld,Dd)=>{ld=null;Dd&&(ld=Dd);(null===ld||void 0===ld?0:ld.Lo)&&this.YFj(ld.Lo);this.$.tf();ld&&ld.kk&&this.oYg(ld.kk)};this.F3j=(ld,Dd)=>{Dd.Jsa===Oc.a.myAddins&&(this.Bpb|=1);Dd.Jsa===Oc.a.adminManaged&&(this.Bpb|=2);this.H$f()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",
!1))};this.$=K;n.ULS.shipAssertTag(537170659,0,!(void 0===Ia||null===Ia),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Zf.a.SY()}`);this.Fd=Ia;this.NHe=Db;this.g1b=dc;this.W9=xc;this.Fpb=Rc;this.To=new Qe.a;this.kha=new Ze;this.ddd=fd;td.a.$zb=td.a.FXe;this.n9c=new l.a;this.N2a=new l.a;this.sZc&&(this.lha=this.Fd.lha,null!==this.lha?(this.r_c=new $h(Fd.AFrameworkApplication.rb,this.lha,df.a.tmc.toString(),df.a.ymc.toString(),"1296389134",Fd.AFrameworkApplication.fa),
this.lha.Wuc(this.F3j)):n.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get sZc(){return Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}dispose(){void 0!==this.Fpb&&null!==this.Fpb&&(this.Fpb.dispose(),this.Fpb=null);this.Fd=this.$=null;this.disposed=!0}mKj(K,Ia){switch(K){case df.a.v2:K=this.WJj(Ia);
break;default:K=!1}return K}Mc(K,Ia){return 619219938===Ia?!this.H$f():!1}executeCommand(K,Ia,Db){K=Ne.TaskExtensions.Yj();Ia=Ia.command;switch(Ia){case 843847158:break;case df.a.tmc:this.Zci(Db.SourceControlId);break;case df.a.ymc:this.adi(Db.SourceControlId);break;case -2025863019:kf.a.PVd(Db[ca.a.rZc].toString(),()=>{If.h(this.$).focus()});break;case -1777565636:Hf.a.showUILessDialog(Db[ca.a.Hpb].toString());this.Fd.tNj(Db[ca.a.Hpb].toString());break;case 1592314317:Hf.a.hideUILessDialog(Db[ca.a.Hpb].toString());
this.Fd.Egi(Db[ca.a.Hpb].toString());break;case df.a.v2:K=this.Old(Db);break;case df.a.gEb:this.hEb(Db);break;case df.a.HR:this.iej(Db);break;case df.a.Ona:this.Ona(Db);break;case df.a.IAc:this.Fpb.ZAc();break;case df.a.refreshAddinCommands:this.mjj();break;case 1949669462:this.W9.o7f(!0);break;case -1014260128:K=this.executeDynamicAddInCommandsAPI(Db);break;case df.a.Jgb:this.Jgb();break;default:K=Cf.a(Ia)}return K}Ac(K,Ia,Db){K=!1;switch(Ia.command){case df.a.tmc:case df.a.ymc:K=!!Db;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case df.a.HR:case df.a.Ona:case df.a.IAc:case df.a.refreshAddinCommands:case 1949669462:case df.a.gEb:case -1014260128:case df.a.Jgb:K=
!0;break;case df.a.v2:K=!Fd.AFrameworkApplication.protectedFile}return K}H$f(){return 0!==this.Bpb&&this.$.AP&&!A.EwaSettings.xa(174)}Rc(K,Ia,Db){switch(Ia){case "PopulateAddInGallery":return A.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.PopulateAddinGallery",dataFields:Sb.a.ki({})})),this.r_c.eaj(Db),!0;default:return!1}}YVh(K){if(!K)return n.ULS.sendTraceTag(528098432,220,
10,"Failed to get button id for addin"),null;if((K=K.aW)&&K.Ss&&0<K.Ss.count)for(let Ia of K.Ss){if(Ia.groups&&1===Ia.groups.length){K=Ia.groups[0];if(K.controls&&1===K.controls.length){const Db=K.controls[0];if(Db.attributes&&!Db.controlType&&Db.enabled)return Db.id}K.controls&&n.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ia.groups&&n.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}iej(K){K&&ca.a.xP in K?this.HR(K[ca.a.xP],!0):n.ULS.sendTraceTag(509686151,
220,10,"queryAddinDetailsWithActionData: invalid actionData.")}HR(K,Ia=!1){this.Fd?(n.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",K,Ia),this.Fd.HR(K,Ia)):n.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..")}mjj(){if(this.W9.Rmc()){this.W9.fEe();var K=this.tgd();if(K&&0<K.count)for(let Ia of K)K={[ca.a.xP]:Ia,[ca.a.aM]:4,[ca.a.$Ga]:(new Date).getTime()},this.Ona(K)}else Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&(n.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.W9.Rmc()),this.HR(10,!0),this.HR(0,!0))}Ona(K){n.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${K[ca.a.aM]}, DataProvider ${K[ca.a.xP]}.`);this.W9.aCj();window.setTimeout(()=>{if(void 0===this.Fd||null===this.Fd)n.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Zf.a.SY()}`);
else{const Ia=new Dc(new ud(this.Fd.Lg),Pd.instance,sf.instance);Ia.JOg((Db,dc)=>{Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.HR(K[ca.a.xP]);this.hEb(dc.properties)});Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ia.dSg((Db,dc)=>{null==dc?ia.a.sendTelemetryEvent(Object(Cc.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.ki({["AppTeachingUICalloutAction"]:"InvalidEventArgs",
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):(this.NPb=new nf(this),this.NPb.ulj(dc),Db=this.$.Ia,null!=Db&&(Db.Cte(this.vhf),n.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ia.n1j(K)}},0)}Jgb(){if(this.lqi)if(void 0===this.Fd||null===this.Fd)n.ULS.sendTraceTag(509686154,220,10,"DdaFacadeService should not be null");else{const K=new Dg(this.Fd.Lg);K.DQg(()=>{this.Uwd()});K.m0d()}}get lqi(){return!A.EwaSettings.xa(174)&&this.$.ea.Dg.get(27)&&
this.$.AP}Uwd(){const K=document.getElementById("InsertAddInFlyout");if(null===K||void 0===K||"none"===window.getComputedStyle(K).display){const Ia=document.getElementById("RibbonOverflowMenu-overflow");null!=Ia?(Ia.onclick=function(){const Db=new Jd.a(0,1,500,()=>{const dc=document.getElementsByName("Add-ins")[0];null!=dc&&(dc.click(),n.ULS.sendTraceTag(509445257,341,50,"Launch flyout in overflow"))});Fd.AFrameworkApplication.ti.ig(Db);Ia.onclick=function(){}},Ia.click()):n.ULS.sendTraceTag(509677591,
220,10,"Cannot find flyout button on ribbon or overflow button")}else K.click(),n.ULS.sendTraceTag(509677590,220,50,"Launch flyout")}hEb(K){if(!this.disposed){n.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${K[ca.a.aM]}.`);try{if(A.EwaSettings.xa(174)){const Db=K[ca.a.Cpb];if(Db&&0<Db.count){const dc=Db.count;for(let xc=dc-1;0<=xc;xc--){const Rc=Db.ma(xc);OSF.OsfControl.isFirstPartyStoreString(Rc.storeType)||Db.remove(Db.ma(xc))}if(Db.count<dc){const xc=Object(Pi.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?
Object(Sh.c)(wh.a.resolve(Th.e,{Wb:0})):yf.GetServiceTaskFactory.Pa(this.$.da,5,4,0);Ne.TaskExtensions.za(xc,()=>{xc.result.sh(36,null)},this.$.ka,3)}if(!Db.count)return}}if(void 0===this.Fd||null===this.Fd)n.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Zf.a.SY()}`);else{var Ia=null;Ia=Fd.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new hc(this.To,this.NHe,new ud(this.Fd.Lg),new Xd(this.$.Cb,df.a.v2),this.W9,Pd.instance,
this.kha,(Db,dc)=>{const xc={};xc.InstanceId=qe.a.create().toString();xc.PrimaryMarketplace={};xc.PrimaryMarketplace.SolutionId=Db.solutionId;xc.PrimaryMarketplace.SolutionVersion=Db.version;xc.PrimaryMarketplace.MarketplaceType=Db.storeType;xc.PrimaryMarketplace.MarketplaceRef=Db.storeId;xc.WebExtensionType=1;this.Fd.FPj(xc,()=>{dc(Db)})}):new hc(this.To,this.NHe,new ud(this.Fd.Lg),new Xd(this.$.Cb,df.a.v2),this.W9,Pd.instance,this.kha);Ia.ROg(this.RSi);Ia.KOg(this.A_i);if(Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Db=new nf(this);Ia.CQg(Db.z_i);Ia.cSg(Db.fNj)}this.$.da.Ba(53).yp&&Ie.a.get_instance().Rj(5,null).continueWith(()=>{this.disposed||Ia.ADi(this.ddd,this.$.domElement,K)})}}catch(Db){n.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Db.message}.`)}}}Old(K){const Ia=Ne.TaskExtensions.Yj();K=K[this.To.qia];const Db=this.g1b.UWc(K),dc=new Hf.a(this.$,this.Fd,Db.ownerAddinInfo,Ia);return this.bbf(Ia,K,Db,dc)}bbf(K,Ia,Db,dc){this.g1b.Old(Ia,this.W9,dc,new ud(this.Fd.Lg),
Db,()=>{K=dc.Obh()},()=>{If.h(this.$).focus()});return K}oYg(K){const Ia=Ne.TaskExtensions.Yj();var Db=this.Fd.Xaa(K.solutionId);if(Db){var dc=this.Fd.QU(Db);if(vf.HelperMethods.Aw(dc)&&0!==dc.SharedRuntime.State)return}dc=this.g1b.pYg;const xc=K.solutionId in dc?dc[K.solutionId]:null;if(xc){const Rc=this.g1b.UWc(xc),fd=new Hf.a(this.$,this.Fd,Rc.ownerAddinInfo,Ia),ld=Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,null!==Rc.ownerAddinInfo?Rc.ownerAddinInfo.storeType:K.storeType,K.assetId,
null,null,K.storeId);dc=Dd=>{if(Dd){const Rd={};for(const Pe of Dd)Rd[Pe[0]]=Pe[1];(Dd=ca.a.Kte in Rd?Rd[ca.a.Kte]:null)&&"true"===Dd.toLowerCase()&&(n.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${K.storeType}, StoreId ${K.storeId}, SolutionId ${ld}.`),this.bbf(Ia,xc,Rc,fd))}};n.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${K.storeType}, StoreId ${K.storeId}, SolutionId ${ld}.`);if(Db)dc(this.Fd.QU(Db).OsfPropertyBag);else if(Db=
this.$.ea.workbookContext.WebExtensions)for(const Dd of Db)if((1===Dd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===K.targetType&&Dd.PrimaryMarketplace.MarketplaceType.toLowerCase()===K.storeType.toLowerCase()&&Dd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===K.storeId.toLowerCase()&&Dd.PrimaryMarketplace.SolutionId.toLowerCase()===K.solutionId.toLowerCase()){dc(Dd.OsfPropertyBag);break}}}kZd(K,Ia,Db=!1){K&&(!Db||Ia||this.n9c.contains(K)||this.n9c.add(K),(Db=
this.N2a.contains(K))&&Ia&&this.N2a.remove(K),Db||Ia||this.N2a.add(K))}YFj(K){if((K=K.aW)&&K.Ss)for(let Ia of K.Ss)if(Ia.groups)for(const Db of Ia.groups)if(Db.controls)for(const dc of Db.controls)if(this.kZd(dc.id,dc.enabled,!0),1===dc.controlType&&dc.menuItems)for(const xc of dc.menuItems)this.kZd(xc.id,xc.enabled,!0)}tgd(){const K=new l.a;A.EwaSettings.xa(52)&&(this.$.ea.Dg.get(27)&&(K.add(0),K.add(16)),this.$.ea.Dg.get(33)&&K.add(1),K.add(8));return K}executeDynamicAddInCommandsAPI(K){let Ia=
!0;if(void 0===K||null===K||void 0===K[ca.a.cvb]||null===K[ca.a.cvb])return tg.Task.Ta(!1);switch(K[ca.a.cvb]){case 1:Ia=this.B4j(K);break;case 2:Ia=this.bGj(K);break;case 4:this.N2a.clear();this.N2a.addRange(this.n9c);break;case 3:Ia=this.installContextualTab(K);break;default:Ia=!1}return tg.Task.Ta(Ia)}WJj(K){return K&&this.To.qia in K?(K=K[this.To.qia])?this.N2a.contains(K):!1:!1}B4j(K){var Ia=null;let Db=null,dc=null,xc=!0;void 0!==K[ca.a.G3]&&null!==K[ca.a.G3]&&void 0!==K[this.To.qia]&&null!==
K[this.To.qia]&&void 0!==K[ca.a.E3]&&null!==K[ca.a.E3]&&(Ia=K[ca.a.G3],Db=K[ca.a.S9b],dc=K[this.To.qia],xc=K[ca.a.E3]);if(!Ia||!dc)return n.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;K=(new sa.a(this.$.Cb,Ia,this.To,!0)).fLa(dc);Ia={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ia.AssetId=Db;Ia.MaskedTabId=K;Ia.IsToEnable=xc;n.ULS.sendTraceTag(537170648,220,50,x.a.Ec(Ia));this.kZd(K,xc);bg.a.nJ.updateCommandUI();return!0}bGj(K){var Ia,
Db,dc=null,xc=null;let Rc=null;var fd=null;let ld=!0;void 0!==K[ca.a.O$c]&&null!==K[ca.a.O$c]&&void 0!==K[ca.a.G3]&&null!==K[ca.a.G3]&&void 0!==K[this.To.qia]&&null!==K[this.To.qia]&&void 0!==K[ca.a.E3]&&null!==K[ca.a.E3]&&(dc=K[ca.a.O$c],xc=K[ca.a.G3],Rc=K[ca.a.S9b],fd=K[this.To.qia],ld=K[ca.a.E3]);if(!dc||!xc||!fd)return n.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;K=(new sa.a(this.$.Cb,xc,this.To,!0)).g$e(fd);fd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
fd.StoreType=dc;fd.AssetId=Rc;fd.MaskedTabId=K;fd.IsToShow=ld;n.ULS.sendTraceTag(537170646,220,15,x.a.Ec(fd));dc=this.W9.sja(dc,xc,1);xc=!1;if(null===(Db=null===(Ia=null===dc||void 0===dc?void 0:dc.Lo)||void 0===Ia?void 0:Ia.aW)||void 0===Db?0:Db.Ss)for(let Dd of dc.Lo.aW.Ss)if(Dd.id===K){xc=!0;break}if(!xc)return n.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ia=[];ld?appChrome.selectors.getSelectedTabId()!==K&&Ia.push(appChrome.actions.activateRibbonTab(K)):
(appChrome.selectors.getSelectedTabId()===K&&Ia.push(appChrome.actions.setCurrentTab(rc.a.uW)),Ia.push(appChrome.actions.deactivateRibbonTab(K)));appChrome.api.dispatch(Ia);return!0}b0h(K){if(this.lha){if(K=this.lha.VRh(K)){const Ia={};Ia.solutionId=K.solutionId;Ia.version=K.version;Ia.storeType=K.storeType;Ia.storeId=K.storeId;Ia.assetId=K.assetId;Ia.assetStoreId=K.assetStoreId;Ia.targetType=K.targetType;Ia.displayName=K.displayName;Ia.width=K.width;Ia.height=K.height;return Ia}n.ULS.sendTraceTag(509362324,
0,10,"Get addinDetail fail.");return null}n.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(K){let Ia=null,Db=null,dc=null;var xc=null;if(void 0!==K[ca.a.G3]&&null!==K[ca.a.G3]&&void 0!==K[ca.a.E3]&&null!==K[ca.a.E3]){const Rc=K[ca.a.E3];Ia=K[ca.a.G3];void 0!==Rc[ca.a.LJa]&&null!==Rc[ca.a.LJa]&&void 0!==Rc[ca.a.MJa]&&null!==Rc[ca.a.MJa]&&(Db=Rc[ca.a.LJa],dc=Rc[ca.a.MJa],xc=Rc[ca.a.P$c])}if(!(Ia&&dc&&Db&&xc))return n.ULS.sendTraceTag(537170644,220,
15,"InstallContextualTab failed to invalid parameters"),!1;K=this.W9.sja(xc.PrimaryMarketplace.MarketplaceType,xc.PrimaryMarketplace.SolutionId,1);if(null===K||void 0===K?0:K.Lo)return n.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;K={};K.solutionId=xc.PrimaryMarketplace.SolutionId;K.version=xc.PrimaryMarketplace.SolutionVersion;K.storeType=xc.PrimaryMarketplace.MarketplaceType;K.storeId=xc.PrimaryMarketplace.MarketplaceRef;xc.AssetMarketplace?(K.assetId=
xc.AssetMarketplace.SolutionId,K.assetStoreId=xc.AssetMarketplace.MarketplaceRef):(K.assetId=null,K.assetStoreId=null);K.targetType=xc.WebExtensionOsfControlType;K.width=xc.TaskpaneWidth;K.height=0;K.isAddinCommands=!0;xc=new l.a;xc.add(K);K={};K[ca.a.Cpb]=xc;K[ca.a.aM]=6;K[ca.a.LJa]=Db;K[ca.a.MJa]=dc;this.hEb(K);return!0}}Object(d.a)(Qi,"AddinUICommandHandler",null,[834,222,3]);var aj=a(67),ai=a(610),wi=a(19),bi=a(17);class xg extends Vb.a{constructor(K){super(K);this.handler=null;this.zKg=()=>{n.ULS.sendTraceTag(38410434,
0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.Bd&16384)}]`);const Ia=new Bb.a;this.$.da.hb(53,Rd=>{n.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Ia.setResult(Rd)});const Db=Ia.task,dc=new od,xc=Ld.a.getInstance(),Rc=new cc(this.$,xc),fd=yf.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),ld=this.Ujj(dc),Dd=Object(Pi.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")?
Object(Sh.c)(wh.a.resolve(Th.D,{Wb:this.Na})):yf.GetServiceTaskFactory.Pa(this.$.da,349,350,this.Na);return Ne.TaskExtensions.za(Ne.TaskExtensions.Md([Db,fd,ld,Dd],this.ka),()=>{n.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Ne.TaskExtensions.za(yf.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.Na),Rd=>{this.handler=new Qi(this.$,Rd.result,dc,new Df,xc,Rc,Of.a.instance.og("Common.IExternalUICommandDefinitionMapping"));
n.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.fd([this.handler]);this.$.da.Ha(198,this.handler)},this.ka,3)},this.ka,3)};this.Xmh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ia.Ucb(this.handler),this.$.da.vU(198),this.handler=null):n.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.vU(204);bi.a(wi.a,20,this.$.da,198)}}ld(){n.ULS.sendTraceTag(38410432,
0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");aj.a(this.$).add(Object(Cc.a)(new ai.a,{gAc:()=>{const K=this.$.ea.TH&&this.$.ea.Yb&&!!(this.$.Bd&16384)&&this.$.isEditMode;this.$.ea.Yb&&n.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${K}] IsSessionFullyLoaded [${this.$.ea.TH}] IsSessionActive [${this.$.ea.Yb}] ShowCommandUI [${!!(this.$.Bd&16384)}] IsEditMode [${this.$.isEditMode}]`);return K},A_b:this.zKg,
h8b:this.Xmh,Z3a:2}))}Ujj(K){const Ia=yf.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Na);return Ne.TaskExtensions.za(Ia,()=>{n.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ha(204,new Nd(Ia.result,K))},this.ka,3)}static la(K){Vb.a.Rd(199,new xg(K))}}Object(d.a)(xg,"AddinUICommandHandlerFactory",Vb.a,[]);var Ph=a(1227),Ri=a(1231),xh=a(717);class xi extends h.a{constructor(K){super();this.$=
K;this.Gb()}create(){let K;if(A.EwaSettings.xa(355)){const Ia=yf.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,this.Na);let Db;Db=A.EwaSettings.isChangeGateEnabled("OfficeVSO:7476522_IDBNewService2")?Object(Sh.c)(wh.a.resolve(Th.x)):yf.GetServiceTaskFactory.create(this.$.da,396,this.$.ka,this.Na);Ne.TaskExtensions.za(tg.Task.uG(Ia,Db),()=>{this.qb(Object(xh.a)(this.$.da,278,()=>new Ph.CustomFunctionsInstaller(this.$,Ia.result,Db.result)))},this.$.ka,3)}else K=Object(xh.a)(this.$.da,278,()=>
new Ri.CustomFunctionsLegacyInstaller(this.$)),this.qb(K)}static la(K){K.da.Ha(279,new xi(K))}}Object(d.a)(xi,"CustomFunctionsInstallerFactory",h.a,[]);var ci=a(91),Hh=a(49),yi=a(45);class uf{constructor(K,Ia){this.SQa=this.TQa=null;this.bjg=(Db,dc)=>{let xc=null,Rc=null,fd=null;dc?(Object(W.a)(504,dc)?(xc=dc.gHa,fd=dc.instanceId):Object(W.a)(231,dc)&&(xc=dc.get_element(),fd=dc.instanceId),xc)?(Rc=Object(ea.a)(829,Db),Rc)?this.iVf(fd,xc,Rc)||fd in this.SQa||(this.TQa[fd]=0,this.SQa[fd]=Hh.a.instance.GC(()=>
{10<=this.TQa[fd]||this.iVf(fd,xc,Rc)?(delete this.TQa[fd],this.SQa[fd].dispose(),delete this.SQa[fd]):this.TQa[fd]+=1},500,yi.a.uTg,!0,!1)):n.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):n.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):n.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=K;this.$=Ia;this.d0c=!1;this.$.da.Ha(224,this)}la(K){this.d0c?
n.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.d0c=!0,this.SQa={},this.TQa={},K?K.uPg(this.bjg):n.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(K){if(K){K.foj(this.bjg);K=this.SQa;for(let Ia in K)ci.a.Ja(K[Ia]);this.TQa=this.SQa=null;this.d0c=!1}else n.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}iVf(K,
Ia,Db){if(this.Opi(Db,K))return!1;K=Ia.querySelector("iframe");if(!K)return n.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;K=K.title;if(!K||!K.length)return n.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(K);return!0}Opi(K,Ia){return(K=K.Lg.getOsfControl(Ia))?K.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(d.a)(uf,"AgaveOnSelectedReadoutHandler",
null,[867]);class Ih extends h.a{constructor(K){super();this.$=K;this.Gb()}create(){const K=this.$.da;Ne.TaskExtensions.za(yf.GetServiceTaskFactory.Pa(K,211,212,this.Na),Ia=>{Ia=K.Ba(224)||new uf(Ia.result,this.$);this.qb(Ia)},this.ka,3)}static la(K){K.da.Ha(225,new Ih(K))}}Object(d.a)(Ih,"AgaveOnSelectedReadoutHandlerFactory",h.a,[]);var rg=a(753),Qg=a(52);const dh=(K,Ia)=>Qg.a.Gxd(65,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,Fd.AFrameworkApplication.fa.Ad("MaxRetriesForLoadingScript",
0),K,Ia);var zi=a(244);class Lh{constructor(K,Ia,Db){this.iframe=K;this.onSuccess=Ia;this.onError=Db;$addHandler(window,"message",Object(Wd.a)(this,this.lcf,"handleResponse"))}lcf(K){try{if(K&&K.rawEvent&&K.rawEvent.origin&&this.iframe&&this.iframe.id){var Ia=this.sOf(K.rawEvent.origin);const Db=this.sOf(document.domain);if(J.a.li().equals(Db,Ia))if(K.rawEvent.source&&K.rawEvent.source.frameElement&&K.rawEvent.source.frameElement.id&&J.a.li().equals(K.rawEvent.source.frameElement.id,this.iframe.id)){Ia=
null;try{Ia=JSON.parse(K.rawEvent.data)}catch(dc){n.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",dc.message)}Ia?(Ia.statusCode!==zi.a.ZO||void 0!==Ia.error&&Ia.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ia.statusCode,Ia.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.onSuccess(Ia.authorizationCode?Ia.authorizationCode:Ia.signInUrl)),$removeHandler(window,"message",Object(Wd.a)(this,this.lcf,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Db){n.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Db.message)}}sOf(K){let Ia=
"";try{K&&(Ia=-1<K.indexOf("//")?K.split("/")[2]:K.split("/")[0])&&(Ia=Ia.split(":")[0],Ia=Ia.split("?")[0])}catch(Db){n.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Db.message)}return Ia}static la(K,Ia,Db){new Lh(K,Ia,Db)}}Object(d.a)(Lh,"ResponseHandler",null,[]);var oi=a(261);class qh{constructor(K){this.vGa=K}tryAuthenticate(K,Ia){this.ubb(qh.nBg,()=>{K()},Ia)}tryAuthorize(K,Ia){this.ubb(qh.rwg,K,Ia)}getSignInUrl(K,Ia){this.ubb(qh.Tle,K,Ia)}signOut(K,Ia){this.ubb(qh.mHg,
K,Ia)}ubb(K,Ia,Db){var dc=new oi.QueryStringBuilder("AuthenticationProxyHandler.aspx");dc.hj("responseType",K);Fd.AFrameworkApplication.yZa(dc);dc=String.format("{0}{1}&{2}",this.vGa,dc.toString(),Fd.AFrameworkApplication.xi);const xc=document.createElement("iframe");xc.setAttribute("id","privateCatalogIframe");xc.setAttribute("name","privateCatalogIframe");xc.setAttribute("style","display: none");J.a.li().equals(K,qh.Tle)||xc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");
Lh.la(xc,Ia,Db);xc.setAttribute("src",dc);document.body.appendChild(xc)}}qh.rwg="authcode";qh.nBg="identitytoken";qh.Tle="signinurl";qh.mHg="signout";Object(d.a)(qh,"AuthenticationProxy",null,[]);class yg{}yg.getUserId="getUserId";yg.getLastStoreUpdate="laststoreupdate";yg.getEntitlement="getEntitlements";yg.getEToken="getEToken";yg.getManifest="getManifest";yg.getAppState="getAppState";yg.getKilledApps="getRemovedAddins";yg.getAppDetails="getAppDetails";yg.removeApps="removeAddin";yg.getLastPrivateCatalogUpdate=
"getLastPrivateCatalogUpdate";yg.getPrivateCatalogAddIns="getAddIns";yg.getPrivateCatalogManifests="getAppManifests";yg.isStoreDisabled="isStoreDisabled";Object(d.a)(yg,"S2SWebRequestActions",null,[]);var pi=a(581);class Uh{getUserId(K,Ia){const Db=new l.a;Db.add(new Oe.a("corr",K));this.QW(yg.getUserId,Db,1,Ia)}getLastStoreUpdate(K,Ia,Db){const dc=new l.a;dc.add(new Oe.a("lc",K));dc.add(new Oe.a("corr",Ia));this.QW(yg.getLastStoreUpdate,dc,1,Db)}getEntitlement(K,Ia,Db,dc){K=new l.a;K.add(new Oe.a("av",
Ia));K.add(new Oe.a("corr",Db));this.QW(yg.getEntitlement,K,1,dc)}getEToken(K,Ia,Db,dc,xc,Rc){const fd=new l.a;fd.add(new Oe.a("cmu",K));fd.add(new Oe.a("cmf",Ia));fd.add(new Oe.a("assetid",Db));fd.add(new Oe.a("expver",dc));fd.add(new Oe.a("corr",xc));this.QW(yg.getEToken,fd,1,Rc)}getManifest(K,Ia,Db,dc){const xc=new l.a;xc.add(new Oe.a("cmu",K));xc.add(new Oe.a("assetid",Ia));xc.add(new Oe.a("corr",Db));this.QW(yg.getManifest,xc,1,dc)}getAppState(K,Ia,Db){const dc=new l.a;dc.add(new Oe.a("ma",K));
dc.add(new Oe.a("corr",Ia));this.QW(yg.getAppState,dc,1,Db)}getKilledApps(K,Ia){const Db=new l.a;Db.add(new Oe.a("corr",K));this.QW(yg.getKilledApps,Db,1,Ia)}getAppDetails(K,Ia,Db,dc){const xc=new l.a;xc.add(new Oe.a("cmo",K));xc.add(new Oe.a("corr",Db));this.sendWithBody(yg.getAppDetails,xc,Ia,2,dc,!1)}removeApps(K,Ia,Db){const dc=new l.a;dc.add(new Oe.a("corr",Ia));this.sendWithBody(yg.removeApps,dc,K,2,Db,!1)}getLastPrivateCatalogUpdate(K,Ia,Db,dc,xc,Rc){const fd=new l.a;fd.add(new Oe.a("catalog",
"privatecatalog"));fd.add(new Oe.a("clientCode",K));fd.add(new Oe.a("clientVersion",Ia));fd.add(new Oe.a("corr",xc));K=String.format("authorizationCode={0}&refreshToken={1}",Db?Cg.a.pf(Db):"",dc?Cg.a.pf(dc):"");this.sendWithBody(yg.getLastPrivateCatalogUpdate,fd,K,2,Rc,!0)}getPrivateCatalogAddIns(K,Ia,Db,dc,xc,Rc){const fd=new l.a;fd.add(new Oe.a("catalog","privatecatalog"));fd.add(new Oe.a("clientCode",K));fd.add(new Oe.a("clientVersion",Ia));fd.add(new Oe.a("corr",xc));K=String.format("authorizationCode={0}&refreshToken={1}",
Db?Cg.a.pf(Db):"",dc?Cg.a.pf(dc):"");this.sendWithBody(yg.getPrivateCatalogAddIns,fd,K,2,Rc,!0)}getPrivateCatalogManifests(K,Ia,Db,dc,xc){const Rc=new l.a;Rc.add(new Oe.a("catalog","privatecatalog"));Rc.add(new Oe.a("corr",dc));K=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Cg.a.pf(K),Ia?Cg.a.pf(Ia):"",Db?Cg.a.pf(Db):"");this.sendWithBody(yg.getPrivateCatalogManifests,Rc,K,2,xc,!0)}isStoreDisabled(K,Ia){const Db=new l.a;Db.add(new Oe.a("corr",K));this.QW(yg.isStoreDisabled,
Db,2,Ia)}QW(K,Ia,Db,dc){this.sendWithBody(K,Ia,null,Db,dc,!1)}sendWithBody(K,Ia,Db,dc,xc,Rc){const fd=new oi.QueryStringBuilder("AddinServiceHandler.ashx");fd.hj("action",K);fd.hj("app",pi.a[Fd.AFrameworkApplication.sa.Qa.ri]);for(let ld of Ia)fd.hj(ld.key,ld.value);Ia=String.format("{0}{1}&{2}",Fd.AFrameworkApplication.sa.Qa.C_,fd.toString(),Fd.AFrameworkApplication.xi);Fd.AFrameworkApplication.Hd.Mm(Ia,dc,Db,null,!1,2,ld=>{let Dd=null,Rd=null;ld&&ld.data&&(ld.data.responseHeaders["X-BlockedForMinor"]&&
"1"===ld.data.responseHeaders["X-BlockedForMinor"].toString()&&(ld.data.httpStatus=451),Dd=ld.data.me,Rd=ld.data.responseHeaders);xc(ld.data.httpStatus,Dd,Rd)},ld=>{var Dd=null;let Rd=null;Rc&&ld&&ld.data&&ld.data.me&&(Dd=ld.data.me,Rd=ld.data.responseHeaders);xc(ld.data.httpStatus,Dd,Rd);if(Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Dd={message:"AddinServiceHandler request failed"};Dd.code=ld.data.httpStatus;Dd.action=K;
if(ld.data.request||ld.data.request.get_headers())Dd["X-UserSessionId"]=ld.data.request.get_headers()["X-UserSessionId"];408===ld.data.httpStatus||503===ld.data.httpStatus?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Dd)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Dd))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",ld.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+K,void 0,void 0,void 0,["X-UserKey"])}}Object(d.a)(Uh,"S2SWebRequestManager",
null,[]);class di extends h.a{constructor(K){super();this.hVf=this.ddaFacade=null;this.$=K;K.da.Ha(106,this);this.Gb()}get Fd(){return this.ddaFacade||(this.ddaFacade=new rg.DdaFacade(this.$,this.hVf,this.Zg))}create(){n.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Fd.AFrameworkApplication.disableWholeAppsForOfficeFeature?n.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${Fd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
A.EwaSettings.xa(359)?Of.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(K=>{K.isFeatureEnabled("mso_officeStore",!0).then(Ia=>{rg.DdaFacade.p6b=Ia;this.YJe();return null})}):this.YJe()}YJe(){const K=yf.GetServiceTaskFactory.Pa(this.$.da,224,225,this.Na),Ia=Qg.a.Gxd(64,()=>!(void 0===window.OSF||null===window.OSF),this.$.ya.MaxRetriesForLoadingScript,this.$.ka,this.Na,106),Db=dh(this.ka,this.Na);let dc,xc=[K,Ia,Db];const Rc=A.EwaSettings.isChangeGateEnabled("OfficeVSO:7637843_CreateRichApiRangeValuesPreview");
Rc&&(dc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(Sh.c)(wh.a.resolve(Th.r,{Wb:this.Na})):yf.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.Na),xc=[K,Ia,Db,dc]);Ne.TaskExtensions.za(Ne.TaskExtensions.Md(xc,this.$.ka),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?n.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Zf.a.SY()}`):
this.iki();n.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.hVf=K.result;Rc&&(this.Zg=dc.result);this.qb(this.Fd);n.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ka,3)}iki(){A.EwaSettings.xa(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Uh);this.$.ke.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Uh,new qh(Fd.AFrameworkApplication.fa.appSettings.WebServiceBase),A.EwaSettings.xa(70),
A.EwaSettings.xa(378));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Uh);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Uh)}dispose(){ci.a.Ja(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static la(K){new di(K)}}Object(d.a)(di,"DdaFacadeServiceFactory",h.a,[]);var ei=a(463);class Ai{constructor(K,Ia,Db,dc,xc,Rc){this.$=K;this.agaveCommandManager=Rc}Rc(){return!1}Mc(){return!1}Ac(K,Ia,Db,dc){let xc=
!1;switch(Ia.command){case -684355545:xc=!0;break;case -741808261:xc=!!Db;break;case -859308420:xc=!!dc&&1===dc.jw;break;case 418618014:xc=1===K&&!!dc&&1===dc.jw;break;case -167264441:xc=Hb.a.GBb(this.$)&&1===K&&!!dc&&1===dc.jw;break;case -515602470:Ia=A.EwaSettings.xa(217)&&2===K;xc=(1===K||Ia)&&!!dc&&1===dc.jw;break;case 2086613372:xc=A.EwaSettings.xa(217)&&2===K&&!!dc&&1===dc.jw;break;case -1336341324:xc=A.EwaSettings.xa(417)&&1===K&&!!dc&&1===dc.jw;break;case 451940422:xc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",
!1)&&1===K&&!!dc&&1===dc.jw;break;case -1444574190:case -336193495:xc=1===K&&!!dc&&1===dc.jw;break;case 1296389134:xc=1===K&&!!dc&&1===dc.jw;break;case df.a.W6a:xc=1===K&&!!dc&&1===dc.jw;break;case -1473679467:xc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===K&&!!dc&&1===dc.jw;break;case 1221897806:xc=A.EwaSettings.xa(155)&&2===K;break;case 1172793074:case 1930653487:xc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&2===K;break;case -1753056834:xc=!0;break;case 932597253:xc=!0;break;case 301511274:xc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:xc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:xc=this.$.isEditMode&&this.$.ea.TNb}return xc}executeCommand(K,Ia,Db){let dc=Ne.TaskExtensions.Yj();const xc=Ia.command;switch(Ia.command){case -1473679467:ei.a(this.$,488,
489,1,Rc=>{dc=Rc.jni(Db.SourceControlId,Ia)});break;case df.a.W6a:this.agaveCommandManager.dfh(Db.SourceControlId);break;case 1296389134:this.agaveCommandManager.GSj(Db.SourceControlId,Db.LabelText);break;case -684355545:this.agaveCommandManager.v2c();break;case -741808261:dc=this.agaveCommandManager.insertAgave(Db,Ia);ei.a(this.$,488,489,1,Rc=>{Rc.$Kg(Db)});break;case -1336341324:A.EwaSettings.xa(417)&&(dc=this.agaveCommandManager.cmd(Db,K,Ia));break;case 1172793074:A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(dc=this.agaveCommandManager.cmd(Db,K,Ia));break;case -859308420:case -515602470:case -167264441:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:dc=this.agaveCommandManager.cmd(Db,K,Ia);break;default:dc=Cf.a(xc)}return dc}}Object(d.a)(Ai,"AgaveCommandHandler",null,[222]);class Bi{}Object(d.a)(Bi,"Selection",null,[]);var Ci=a(1352),Si=a(1351),Ti=a(1353),
Zg=a(1349),yh=a(1347);class Di{}Object(d.a)(Di,"SmartLookupApplicationInterface",null,[]);class Ui{}Object(d.a)(Ui,"ApplicationProperties",null,[]);class Ei{}Object(d.a)(Ei,"EnterpriseUserInfo",null,[]);class fi{}Object(d.a)(fi,"FeatureGates",null,[]);class qi{constructor(K,Ia,Db=!0){this.NYj=9E5;this.QYj=3E5;this.ozd=null;this.zvf="";this.lzd=0;this.lub=Date.now;this.Gya=K;this.c$a=Ia;Db&&this.pgd()}B7h(){const K=this.lub();if(K<this.lzd+this.NYj)return K>this.lzd+this.QYj&&this.pgd(),this.zvf;this.pgd();
return""}pgd(){this.ozd=this.ozd||new Promise(K=>{this.C7h().then(Ia=>{this.zvf=Ia;this.lzd=this.lub();this.ozd=null;K(Ia)})})}C7h(){return this.c$a&&this.c$a.length?new Promise(K=>{this.Gya.tL("SmartLookup",this.c$a).then(Ia=>{Ia.IsSuccess?Ia.Token||(K(""),n.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(n.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Ia.ErrorCode+": "+Ia.ErrorMessage),K(""));K(Ia.Token)}).catch(Ia=>
{Ia=ng.c(Ia);n.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ia);K("")})}):(n.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(d.a)(qi,"SmartLookupAuthenticationManager",null,[851]);class ri{static fYh(){switch(Object(ea.a)(String,Fd.AFrameworkApplication.Ub.AudienceGroup)||""){case "Dogfood":if(Fd.AFrameworkApplication.fa){let K=Fd.AFrameworkApplication.fa.Wa("UserPrincipalName");
K=Cg.a.cl(K);const Ia=Fd.AFrameworkApplication.fa.Jp("SmartLookupINTEnabledForSKITeam")?Fd.AFrameworkApplication.fa.ww("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Ia,K)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static $6h(){switch(Fd.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Fd.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":Fd.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?"INT":
ri.fYh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(d.a)(ri,"Utils",null,[]);var Fi=a(565),gi=a(178);class pg{constructor(K){n.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.fwf=Fd.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");
this.tJi=Fd.AFrameworkApplication.fa.Wa("SmartLookupApprovedOriginPattern");this.c$a=Fd.AFrameworkApplication.fa.Wa("SmartLookupShredderServiceEndpoint");this.YJi=vg.a.eK(Fd.AFrameworkApplication.fa.Wa("AppCatalogUrl")||"");this.b$a=new fi;this.b$a.EnableAllTabV2=!0;this.b$a.EnableIntentService=!0;this.b$a.EnableInDocumentSearch=Fd.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.b$a.EnableLocalSearch=Fd.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.b$a.IntentServiceEndpoint=
ri.$6h();this.TJi=new qi(K,this.c$a)}get approvedOriginPattern(){return this.tJi}GSh(){return Promise.resolve(this.HSh())}HSh(){const K=new Ui;K.anid="";K.applicationVersion=Fd.AFrameworkApplication.buildVersion;K.appCorrelationId=gi.a.create().toString();K.themePlatform=pg.mak;K.lcid=Fd.AFrameworkApplication.lcid;K.launchUtcTime=(new Date).toUTCString();K.featureGates=this.b$a;var Ia=Fi.a.bK(Fd.AFrameworkApplication.lcid);Ia=Ia?Ia.name:null;K.market=this.gdc(Ia);K.uiLanguage=Ia;K.sessionId=Fd.AFrameworkApplication.userSessionId;
K.themeId=0;K.parentalControl=pg.k8i;const Db=new Ei;Db.CountryCode=this.gdc(Ia);Db.ServiceEndpoint=this.c$a;Db.IsGoLocal=!1;Db.IsEnabled=this.fwf;Db.IsEnterpriseEnabled=this.fwf;Db.TenantRoot=this.YJi;K.enterpriseUserInfo=Db;K.accessToken=this.TJi.B7h();return K}gdc(K){K=K.split("-");return K[K.length-1]}}pg.mak="web";pg.k8i="yes";Object(d.a)(pg,"SmartLookupManager",null,[827]);class Dh extends Le.a{constructor(K){super();this.$=K;this.isFirstLaunch=!1}Rc(){return!1}Mc(){return!1}Ac(K,Ia){K=A.EwaSettings.xa(127);
return-983891024===Ia.command&&K}executeCommand(K,Ia){K=Ne.TaskExtensions.Yj();-983891024===Ia.command&&this.iDi();return K}iDi(){var K=new pg(null);const Ia={};var Db=If.h(this.$).Jb(null).originalText;Db=Object(Cc.a)(new Bi,{neighborhood:Db,mentionStart:0,mentionLength:Db?Db.length:0});const dc=Object(Cc.a)(new Di,{selection:Db,entryPoint:0});K.GSh().then(Rc=>{Rc.applicationName=Dh.appName;Rc.isFirstLaunch=this.isFirstLaunch;Rc.themeId=5;Ia[Dh.smartLookupApplicationInterface]=JSON.stringify(dc);
Ia[Dh.RUg]=JSON.stringify(Rc);this.isFirstLaunch=!1});K=new Ci.a("ExcelOnline","Web","en-Us");Db=new Si.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const xc=new Ti.a;xc.optionalProperties[Zg.a.Ok]=Ca.a.instance.ga(1810);xc.optionalProperties[Zg.a.taskPaneWidth]=350;xc.optionalProperties[Zg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";xc.tr=Ia;yh.a.instance.qya(Db,"Taskpane","SmartLookupSDXTaskpane",K,xc)}}Dh.RUg="AppProperties";Dh.appName="Excel";Dh.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Object(d.a)(Dh,"SmartLookupCommandHandler",Le.a,[222]);class hi extends Vb.a{constructor(K){super(K)}ld(){ei.a(this.$,374,375,this.Na,K=>{this.fd([new Ai(this.$,null,null,null,null,K),new Dh(this.$)])})}static la(K){Vb.a.Rd(76,new hi(K))}}Object(d.a)(hi,"AgaveCommandHandlerFactory",Vb.a,[]);var Gi=a(1354),th=a(111);class $g{constructor(){this.Fd=null;this.ccb=(K,Ia,Db,dc,xc)=>{if(2===Db){K=xc?xc:{};Ia=K.callback;Db=K.refresh?K.refresh:!1;if(!Ia)return 16;Fd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&
null!=K.storeType?this.Fd.GSf(Ia,Db,K.storeType):this.Fd.Bda(Ia,Db)}return 32};this.Tuc=(K,Ia,Db,dc,xc)=>{if(2===Db){K=xc?xc:{};Ia=K.Observer;if(!Ia)return n.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(K)),16;if(!this.Fd||!this.Fd.lha)return n.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(K)),16;this.Fd.lha.Wuc(Ia)}return 32};
this.Wkj=(K,Ia,Db,dc,xc)=>{2===Db&&(K=xc?xc.callback:null)&&this.Fd.tPg(K);return 32};this.ini=(K,Ia,Db,dc,xc)=>{2===Db&&this.Fd.jrc(null,OSF.AgaveHostAction.InsertAgave,xc);return 32}}initialize(K){$g.initialized||(this.Fd=K,this.Hg(),$g.initialized=!0)}Hg(){Fd.AFrameworkApplication.rb.Je(df.a.ccb,th.a.frame,this.ccb,96);Fd.AFrameworkApplication.rb.Je(df.a.Tuc,th.a.frame,this.Tuc,96);Fd.AFrameworkApplication.rb.Qb(df.a.Kjj,th.a.frame,this.Wkj);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",
!1)&&Fd.AFrameworkApplication.rb.Je(df.a.shf,th.a.frame,this.ini,96)}static get instance(){$g.Ma||($g.Ma=new $g);return $g.Ma}}$g.Ma=null;$g.initialized=!1;Object(d.a)($g,"AgaveCommandActor",null,[]);var rh=a(1396),Vh=a(1350),uh=a(115),Wh=a(361),bj=a(358),cj=a(1273),Fg=a(18),Hi=a(353);class si{constructor(){this.BZd=this.aDc=null;this.Qv=0;this.ZCc=null}}Object(d.a)(si,"FirstPartyAddinTaskpaneOverrides",null,[]);class ii{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(d.a)(ii,"IdeasSelectionContext",null,[]);class Ii extends ii{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(d.a)(Ii,"IdeasTableSelectionContext",ii,[]);class Ji{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(d.a)(Ji,"AutoFilterRange",
null,[]);class Vi{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(d.a)(Vi,"IdeasAutoFilterSource",null,[]);class Ki{constructor(K,Ia){this.selection=K;this.tables=Ia}}Object(d.a)(Ki,"IdeasXLIMTableBoundaries",null,[]);var Og=a(63);const Wi=(K,Ia,Db,dc,xc,Rc,fd=null)=>{fd=K.Oa(9,fd);fd.sharedInfo=Ia;return Og.g(K,"ShowAgaveTaskpane",fd,Db,dc,xc,Rc,0)};var Wg=a(991),Xh=a(71),Xi=a(132),zh=a(44),Li=a(379),Qh=a(198),ji=a(182),Q=a(575),Ra=a(290),ub=a(109),gc=
a(133),Bc=a(53);class Uc extends Eg.a{constructor(){super();this.CX="calc(100% - 46px)";this.A8="15px";this.DX="0";this.Bjb="WACDialogPanel";this.CG=695;this.Cjb=462;this.z1="80%";this.pib=350;this.jqa="100%";this.Rb=5;this.we="AppsForOfficeInsertionDialog";this.sLc=!!Fd.AFrameworkApplication.fa&&Fd.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}Tw(){super.Tw();this.Th.style.width=this.jqa;this.Th.style.height=this.CX;this.Th.style.marginTop=this.A8;this.Th.style.padding=
this.DX}rna(){this.Th.style.width=this.jqa;this.Th.style.height=this.CX;this.Th.style.marginTop=this.A8;this.Th.style.padding=this.DX;this.CG>kg.a.S_?(this.ib.style.width=String.format("{0}px",kg.a.S_),this.ib.style.overflowX="scroll",Fd.AFrameworkApplication.isRtl?this.ib.style.right="0":this.ib.style.left="0"):(this.ib.style.width=String.format("{0}px",this.CG),this.ib.style.overflowX="hidden");this.ib.offsetHeight>kg.a.R_||this.Cjb+50>kg.a.R_?(this.ib.style.height=String.format("{0}px",kg.a.R_),
this.ib.style.overflowY="scroll",this.ib.style.top="0",Fd.AFrameworkApplication.isRtl?this.ib.style.right="0":this.ib.style.left="0",this.sLc||(this.ib.style.marginTop="-48px"),this.Th.style.minHeight=String.format("{0}px",this.pib)):(this.ib.style.overflowY="hidden",this.ib.style.top="10%",this.ib.style.height=this.z1);this.F$()}F$(){if(this.ib){var K=this.ib.style.zIndex;this.ib.style.zIndex="-9999";if(this.CG>kg.a.S_)Fd.AFrameworkApplication.isRtl?this.ib.style.marginRight="0":this.ib.style.marginLeft=
"0";else{const Ia=String.format("{0}px",Math.floor(-this.ib.offsetWidth/2));Fd.AFrameworkApplication.isRtl?this.ib.style.marginRight=Ia:this.ib.style.marginLeft=Ia;Fd.AFrameworkApplication.isRtl?this.ib.style.right="50%":this.ib.style.left="50%"}this.ib.style.zIndex=String(K)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}LD(){super.LD();const K=document.getElementById(this.Oh(this.Bjb));K.style.width=String.format("{0}px",this.CG);K.style.height=this.z1}get taa(){return this.Th}}
Object(d.a)(Uc,"AppsForOfficeInsertionDialog",Eg.a,[350]);class $c extends Eg.a{constructor(K=!0,Ia=!0){super();this.CX="calc(100% - 46px)";this.A8="15px";this.DX="0";this.Bjb="WACDialogPanel";this.CG=695;this.Cjb=462;this.z1="80%";this.pib=350;this.jqa="100%";this.Syg="auto";this.Tyg="5px";this.Uyg="auto";this.Qyg="40px";this.Ryg="100px";this.Vyg="200px";this.Rb=5;this.we="SDXDialog";this.RVb=K;this.Azb=Ia}Tw(){super.Tw();this.Th.style.width=this.jqa;this.Th.style.height=this.CX;this.Th.style.marginTop=
this.A8;this.Th.style.padding=this.DX}rna(){this.Th.style.width=this.jqa;this.Th.style.height=this.RVb?this.CX:"100%";this.Th.style.marginTop=this.RVb?this.A8:"0px";this.Th.style.padding=this.DX;this.RVb?(this.CG>kg.a.S_?(this.ib.style.width=String.format("{0}px",kg.a.S_),this.ib.style.overflowX="scroll",Fd.AFrameworkApplication.isRtl?this.ib.style.right="0":this.ib.style.left="0"):(this.ib.style.width=String.format("{0}px",this.CG),this.ib.style.overflowX="hidden"),this.ib.offsetHeight>kg.a.R_||
this.Cjb+50>kg.a.R_?(this.ib.style.height=String.format("{0}px",kg.a.R_),this.ib.style.overflowY="scroll",this.ib.style.top="0",Fd.AFrameworkApplication.isRtl?this.ib.style.right="0":this.ib.style.left="0",this.Th.style.minHeight=String.format("{0}px",this.pib)):(this.ib.style.overflowY="hidden",this.ib.style.top="10%",this.ib.style.height=this.z1),this.F$()):(this.ib.style.left=this.Syg,this.ib.style.right=this.Tyg,this.ib.style.top=this.Uyg,this.ib.style.bottom=this.Qyg,this.ib.style.width=this.Vyg,
this.ib.style.height=this.Ryg,this.ib.style.overflowX="hidden",this.ib.style.overflowY="hidden")}F$(){if(this.ib){var K=this.ib.style.zIndex;this.ib.style.zIndex="-9999";if(this.CG>kg.a.S_)Fd.AFrameworkApplication.isRtl?this.ib.style.marginRight="0":this.ib.style.marginLeft="0";else{const Ia=String.format("{0}px",Math.floor(-this.ib.offsetWidth/2));Fd.AFrameworkApplication.isRtl?this.ib.style.marginRight=Ia:this.ib.style.marginLeft=Ia;Fd.AFrameworkApplication.isRtl?this.ib.style.right="50%":this.ib.style.left=
"50%"}this.ib.style.zIndex=String(K)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}LD(){super.LD();const K=document.getElementById(this.Oh(this.Bjb));K.style.width=String.format("{0}px",this.CG);K.style.height=this.z1}get i5(){return this.RVb}get taa(){return this.Th}}Object(d.a)($c,"SDXDialog",Eg.a,[]);var nd=a(890),Ec=a(150),md=a(431),Ad;(function(K){K[K.Valid=2]="Valid";K[K.Invalid=4]="Invalid";K[K.All=6]="All"})(Ad||(Ad={}));Object(d.b)("MetadataState",Ad);
var Gd=a(350);class wd extends Le.a{constructor(K,Ia,Db,dc,xc){super();this.qoa={};this.ied={};this.bAa=this.sdxDialog=this.QZ=null;this.Ncb=!1;this.zRj=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"]]);this.dfh=Rc=>{Rc?(Rc=new pe.a(-847286761,Ve.a.zb,this.$.xc,0,Rc),this.$.Ia.Hb(Rc,
{["CalloutName"]:19})):n.ULS.sendTraceTag(509220127,220,10,"Control id is null.")};this.$ci=(Rc,fd,ld,Dd,Rd)=>{if(2!==ld)return 32;Rc=Rd[nd.a.Vvb];fd=Rd[nd.a.T$];ld=Rd[nd.a.gda];Rd=new rh.a;Rd.Fhc=ld.optionalProperties.InstanceToken;Rd.sourceLocationOverrideResourceId=ld.optionalProperties[Zg.a.sourceLocationOverrideResourceId];Rd.Kw=ld.tr;Rd.T$=fd;fd=null!=Rd.Fhc?Rd.Fhc:(new qe.a(gi.a.create(),1)).toString();ld=null!=Rd.Kw?Rd.Kw:{};Dd={};Dd.id=fd;Dd.solutionId=Rc.getId();Dd.version=Rc.BDa;Dd.storeType=
Rc.getStoreType();Dd.storeId=Rc.getStoreId();Dd.assetId=null;Dd.assetStoreId=null;Dd.settings=ld;Dd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Dd.osfControlType=OSF.OsfControlType.ContainerLevel;Dd.sourceLocationOverrideResourceId=Rd.sourceLocationOverrideResourceId;Dd.featureGates=Fd.AFrameworkApplication.fa.Z4e(Rc.getId());this.xmc(Rd,Dd);return 32};this.iEb=(Rc,fd,ld,Dd,Rd)=>{2===ld&&(this.QZ=new Uc,this.QZ.initializeAndShow("",null,null),Rc=Rd.CommandValueId,fd=[],fd.push(Rd.SourceControlId),
fd.push(Rc),fd.push(null),this.Fd.gsf(this.QZ.taa,fd));return 32};this.xmc=(Rc,fd)=>{this.sdxDialog=new $c;this.sdxDialog.initializeAndShow("",null,null);fd.div=this.sdxDialog.taa;Rc={};Rc.InstanceId=fd.id;Rc.WebExtensionType=2;Rc.PrimaryMarketplace={};Rc.PrimaryMarketplace.SolutionId=fd.solutionId;Rc.PrimaryMarketplace.MarketplaceType=fd.storeType;Rc.PrimaryMarketplace.MarketplaceRef=fd.storeId;Rc.PrimaryMarketplace.SolutionVersion=fd.version;Rc.SrcLocationOverrideResourceId=fd.sourceLocationOverrideResourceId;
Rc.WebExtensionOsfControlType=6;this.qoa[fd.solutionId]=fd.settings;const {Zbb:ld,owb:Dd}=this.loc([],fd.solutionId);Rc.OsfPropertyBag=ld;Rc.HostPropertyBag=Dd;this.Fd.VIa(Rc);this.Fd.Lg.insertOsfControl(fd)};this.vei=(Rc,fd,ld,Dd,Rd)=>{if(2!==ld)return 32;Rc=Rd[nd.a.Vvb];ld=Rd[nd.a.T$];Rd=Rd[nd.a.gda];fd=new rh.a;fd.Fhc=Rd.optionalProperties.InstanceToken;fd.Ok=Rd.optionalProperties[Zg.a.Ok];fd.EO=Rd.optionalProperties[Zg.a.EO];Zg.a.taskPaneWidth in Rd.optionalProperties&&(fd.taskPaneWidth=Rd.optionalProperties[Zg.a.taskPaneWidth]);
fd.sourceLocationOverrideResourceId=Rd.optionalProperties[Zg.a.sourceLocationOverrideResourceId];fd.Kw=Rd.tr;fd.onTaskPaneClose=Rd.optionalProperties[Zg.a.onTaskPaneClose];fd.T$=ld;ld=new pe.a(-859308420,0,2,0,"");Dd=Rc.getStoreType()===OSF.StoreType.Sdx;const Pe=new Wg.a;Pe.z4=Rd.optionalProperties.HeaderCssClass||Fg.a.K3a;Pe.pgb=Rd.optionalProperties.TitleCssClass;this.E7(ld,Rc.getId(),fd,Dd,Pe);return 32};this.$di=(Rc,fd,ld,Dd,Rd)=>{if(2!==ld)return 32;Rc=Rd[nd.a.Vvb].getId();Rd=Rd[nd.a.gda].optionalProperties[Zg.a.sourceLocationOverrideResourceId];
return Rc?(this.Fd.Lg.refreshOsfControl(Rc,Rd),32):8};this.Qaj=Rc=>{Rc=Rc.Result;if(Rc=null===Rc?null:Rc.SolutionId)this.Fd.oqe(Rc),ub.a(this.$).Yna(3,Rc)};this.bQf=(Rc,fd)=>{var ld;const Dd=(Rc=Rc.Result)?Rc.AgaveData:null;if(Dd){var Rd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Dd.PrimaryMarketplace.SolutionId,Dd.PrimaryMarketplace.MarketplaceType,null===(ld=null===Dd||void 0===Dd?void 0:Dd.AssetMarketplace)||void 0===ld?void 0:ld.SolutionId,null,null,Dd.PrimaryMarketplace.MarketplaceRef);n.ULS.shipAssertTag(537170434,
0,Dd.TaskpaneWidth===wd.Snh,`Taskpane width is ${Dd.TaskpaneWidth}, assetId is ${Rd}.`);if(ld=this.ied[Dd.PrimaryMarketplace.SolutionId])ld.aDc&&(Dd.TaskpaneTitle=ld.aDc),ld.ZCc&&(Dd.TaskpaneIconId=ld.ZCc),ld.BZd&&(Dd.TaskpaneButtonTooltip=ld.BZd),0<ld.Qv&&(Dd.TaskpaneWidth=ld.Qv);fd&&(Dd.FocusOnIframeWhenLoaded=fd.focusOnIframeWhenLoaded,fd.width&&(Dd.TaskpaneWidth=fd.width),Dd.TaskpaneIconCssClass=fd.jk,Dd.TaskpaneHeaderCssClass=fd.z4,Dd.TaskpaneTitleCssClass=fd.pgb,Dd.IsFirstPartyOptOutAppContextOptmization=
fd.isFirstPartyOptOutAppContextOptmization);if(this.qoa[Dd.PrimaryMarketplace.SolutionId]){const {Zbb:Pe,owb:cf}=this.loc(Dd.OsfPropertyBag,Dd.PrimaryMarketplace.SolutionId);Dd.OsfPropertyBag=Pe;Dd.HostPropertyBag=cf}Q.a(Dd)||(Dd.WebExtensionOsfControlType=1);Dd&&(this.Fd.oqe(Rc.SolutionId),this.Fd.VIa(Dd))}else n.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.ZIh=Rc=>{Rc&&(this.tdd.Fqf(Rc),this.ECe())};this.gQf=Rc=>
{Rc=Rc.toDataURL("image/jpeg");const fd=this.Fd.Xaa(wd.$df+"."+wd.dfc),ld={};ld.screenshot=Rc;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(fd,"onScreenshot",ld,()=>{})};this.rci=(Rc,fd,ld,Dd,Rd)=>{if(2!==ld)return 32;if(uh.a.ah(Rd)||Rd[nd.a.YGe]!==Vh.a.action)return 8;fd=Rd[nd.a.gda];return fd?(Rc=(Rc=this.j3h(Rd))?this.Fd.Xaa(Rc):null)?(Rd=this.Fd.ieh(Rd[nd.a.T$],fd.optionalProperties[Zg.a.SWc]),A.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(ld=this.Fd.QU(Rc),
ld.TaskpaneTitle!==fd.optionalProperties[Zg.a.Ok]&&(ld.TaskpaneTitle=fd.optionalProperties[Zg.a.Ok],ld.TaskpaneIconCssClass=fd.optionalProperties.IconCssClass,ld.TaskpaneIconUrl=fd.optionalProperties.TaskPaneIconUrl,ld.TaskpaneIconId=fd.optionalProperties.TaskPaneIconId,A.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(fd=this.Fd.Lg,fd.changeIframeTitle(Rc,ld.TaskpaneTitle),ld=fd.getOsfControl(Rc),fd.raiseOsfControlStatusChange(ld)):(fd=this.Fd.Lg.getOsfControl(Rc),this.Fd.Lg.raiseOsfControlStatusChange(fd)))),
OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Rc,Rd,this.MMb),32):8:8};this.MMb=(Rc,fd)=>{this.Fd.ALh(Rc,fd)};this.pMd=()=>{Ne.TaskExtensions.l3(yf.GetServiceTaskFactory.Pa(this.$.da,20,404,1),Rc=>{Rc.result.pwa()},this.$.ka)};this.$=K;this.viewBlockContainerHelpers=Db;this.Fd=Ia;this.tdd=dc;this.Uh=xc;this.Uh.Qb(df.a.tbg,th.a.frame,this.vei);this.Uh.Qb(df.a.x1f,th.a.frame,this.$di);this.Uh.Qb(df.a.IXe,th.a.frame,this.rci);this.Uh.Qb(df.a.xmc,th.a.frame,this.$ci);this.Uh.Qb(df.a.iEb,
th.a.frame,this.iEb)}mQg(K){this.addHandler(wd.yGd,K)}Poj(K){this.removeHandler(wd.yGd,K)}dispose(){ci.a.Ja(this.QZ);this.QZ=null;this.Ncb&&(this.$.ea.Zm(this.pMd),this.Ncb=!1);super.dispose()}v2c(){this.QZ&&this.QZ.hide()}GSj(K,Ia){var Db;if(K){this.raiseEvent(wd.yGd);const dc=K.split("|");this.tHi(K,Ia,dc);this.QZ=new Uc;this.QZ.initializeAndShow("",null,null);this.Fd.gsf(this.QZ.taa,dc);window[wd.GSg]=null!==(Db=this.zRj.get(K))&&void 0!==Db?Db:"Unknown"}}cmd(K,Ia,Db){var dc=Ne.TaskExtensions.Yj();
if(-515602470===Db.command||-167264441===Db.command||-336193495===Db.command||2086613372===Db.command||-1444574190===Db.command||-1336341324===Db.command||451940422===Db.command)dc=this.Oci(K,Ia,Db);418618014===Db.command&&(Ia=new rh.a,Ia.Ok=Ca.a.instance.ga(1823),dc=this.E7(Db,wd.pgi,Ia,!0));if((Db.tabName===this.$.Cb+rc.a.Z1f||Db.tabName===rc.a.a0)&&2===Db.Ve||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),K[Ve.a.Pc])||K[Ve.a.Pc]===rc.a.mV)return this.Qbf(K,Db);
if(7===Db.Ve&&K.SourceControlId===this.$.Cb+rc.a.vwa)return K.MenuItemId=rc.a.nLd,this.Qbf(K,Db);1221897806===Db.command&&(dc=this.cbg(Db,"Format"));if(1930653487===Db.command||1172793074===Db.command)dc=this.cbg(Db,"Data");-1753056834===Db.command&&(dc=this.oOj(Db));932597253===Db.command&&(n.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Ec.c(932597253,!0),Ia=new rh.a,Ia.Ok=Ca.a.instance.ga(2163),Ia.sourceLocationOverrideResourceId=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?wd.$aj:wd.bbj,Ia.focusOnIframeWhenLoaded=!0,Ia.taskPaneWidth=wd.Fff,dc={},dc.LaunchSource=Object(ea.a)(String,K.SourceControlId),dc.LaunchMode="Default",Ia.Kw=dc,dc=this.E7(Db,wd.abj,Ia,!0));301511274===Db.command&&(dc=this.zOj(Db));if(515196233===Db.command){Ia=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);dc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1);var xc=
this.$.da.Ba(465);xc&&(xc.hef(),Ia||dc)&&(xc.Kmi(),dc&&xc.xEj(10===Db.Ve));xc=new rh.a;xc.Ok=Ca.a.instance.ga(2237);const Rc={};Rc.SourceUILocation=Wh.a[Db.Ve];if(Ia||dc)Rc.SessionID=this.$.ea.sessionId,Ia&&this.SSd(Rc);xc.Kw=Rc;Ia=new Wg.a;Ia.z4=Fg.a.K3a;dc=this.E7(Db,wd.X6i,xc,!0,Ia,void 0,xc.Ok)}1723441034===Db.command&&(Ia=new rh.a,Ia.Ok=Ca.a.instance.ga(2249),Ia.focusOnIframeWhenLoaded=!0,Ia.taskPaneWidth=wd.Tdj,dc=new Wg.a,dc.z4=Fg.a.Wzh,dc=this.E7(Db,md.b,Ia,!0,dc));A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&K.LoadDataFromPictureTaskpane&&(Ia={},dc=new rh.a,dc.Ok=Ca.a.instance.ga(2276),Ia.SessionID=K.SessionID,dc.Kw=Ia,dc.focusOnIframeWhenLoaded=!0,dc=this.E7(Db,K.DataFromPictureAssetId,dc,!0));return dc}insertAgave(K,Ia){var Db=Ne.TaskExtensions.Yj();const dc=this.$;let xc;var Rc=K[ca.a.V9];xc=K[Ve.a.Sf];let fd=null;Wg.a.key in K&&(fd=K[Wg.a.key]);this.QZ&&this.QZ.hide();if(!xc||!Rc)return n.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Db;this.$.p5&&rc.a.Zoa in
K&&(xc.EnabledInViewMode=K[rc.a.Zoa]);K=this.vVh(Ia.command);if(!xc.EnabledInViewMode&&!dc.$s(null,!1,K))return Db;let ld=void 0===xc.IsToBePersisted||null===xc.IsToBePersisted||xc.IsToBePersisted?0:16;if(1===xc.TargetType)Db=this.Ani(xc,Rc,Ia,fd,ld);else{Rc=If.h(dc);Db=this.viewBlockContainerHelpers.Ghb(Rc);const Dd=dc.ea.isNamedObjectViewMode?dc.na.sheetName:dc.na.name;let Rd,Pe,cf,Bf;Db?(Rc=Db.je,Rd=Rc.Be.top,Pe=Rc.Be.left,cf=Db.TI.x,Bf=Db.TI.y):(Rd=Pe=1,Db=this.viewBlockContainerHelpers.NLa(Rc),
cf=Db.x,Bf=Db.y);const Bg=this.$.pa.va.$b();ld|=64;Db=Li.a(this.$.userOperationManager,(og,jg,lg)=>{var zg=dc.pa.va,Xg=Rd,Tg=Pe,Yg=cf,Rh=Bf;og=Ra.b(og,this.Qaj);const li=zg.Oa(9,Bg);li.sharedInfo=xc;li.sheetName=Dd;li.positionRow=Xg;li.positionCol=Tg;li.positionOffsetX=Yg;li.positionOffsetY=Rh;return Og.g(zg,"InsertWebExtension",li,og,jg,lg,null,0)},og=>new Qh.a(534,0,og,ld),Ia)}return Db}Jbh(){var K=Of.a.instance.Tb("Common.App.ICustomerFeedbackUiWrapper");if(!A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",
!1)){var Ia=Of.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.tdd?this.tdd.ilb?this.ECe():Ia.instance.z$c(this.ZIh):n.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Ia={};Fd.AFrameworkApplication.fa.Jqe(Ia);K=K.instance.getContext(Ia);Ia={};"telemetryGroup"in K&&(Ia=K.telemetryGroup);Ia.processSessionId=K.sessionId;Ia.officeBuild=K.build;K.telemetryGroup=Ia;K.feedbackType=-1;K.userVoiceEnabled=!1;"disableIncludeScreenshot"in K||(K.disableIncludeScreenshot=
!1);"screenshot"in K||(K.screenshot=!1);K.disableScreenshotPreview=!1;K.includeScreenshotSelectedDefault=!0;return K}vQf(K){if(!this.bAa&&A.EwaSettings.getBooleanFeatureGate(wd.iii,!1)){var Ia=this.Oid();Ia=this.Zze(Ia);const Db=new Wg.a;Db.jk=Fg.a.Lvb;Db.z4=Fg.a.yUe;Db.pgb=Fg.a.Obd;this.bAa=this.Uxc(Ia,null,!1,null,Db);gc.b(this.$).qd(Xi.a.qbj,{["Location"]:K?Wh.a[K.Ve]:0,["InputMethod"]:K?bj.a[K.method]:0},void 0,!0);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",
!1)&&this.l0d()}}SSd(K){const Ia=this.$.ea.Dg.get(17);Of.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Db=>{Db.isFeatureEnabled("mso_sendASmile",Ia).then(dc=>{K.FeedbackEnabled=Ia&&dc;return null})})}oui(){return this.Fd.Jzi(this.Fd.VKa(wd.vMa,this.Oid()))}cbg(K,Ia){const Db=If.h(this.$),dc=new rh.a;var xc={};xc.ActiveTab=Ia;xc.DatapaneFlighting=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);xc.MergeIvyBiDataSources=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeIvyBiDataSources",
!1);xc.ComboChartUIInXLO=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ComboChartUIInXLO",!1);xc.AceFlighting=!0;xc.ThemeColorsFlighting=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&A.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");xc.UOMirror=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);xc.FormatTaskPaneAceButtonDark=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);xc.FormatTaskPaneBetterFeedbackButton=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);xc.FormatTaskPaneBetterScrollbar=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);xc.FormatTaskPaneUXImprovePhase2=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);xc.ChartTPNewFontAndColorTheme=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",
!1);this.SSd(xc);xc.startTimeMs=Date.now();xc.UserSessionId=this.$.ya.UserSessionId;(Ia=Db.ha.Sa.fo)&&(xc.SubSelection=Ia);n.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${xc.UserSessionId}, UILocation: ${void 0===K.Ve||null===K.Ve?"Null":Wh.a[K.Ve]}, SubSelection: ${Ia||"ChartRoot"}`);dc.Kw=xc;dc.Ok=Ca.a.instance.ga(984);xc=new Wg.a;xc.z4=Fg.a.K3a;return this.E7(K,wd.H6g,dc,!0,xc)}oOj(K){const Ia=new rh.a;Ia.Kw={};Ia.Ok=Ca.a.instance.ga(1809);Ia.EO=wd.Gsf;const Db=new Wg.a;
Db.z4=Fg.a.K3a;return this.E7(K,wd.Gsf,Ia,!0,Db,void 0,Ia.Ok)}zOj(K){const Ia=new rh.a;Ia.Kw={};Ia.Ok=Ca.a.instance.ga(2187);const Db=new Wg.a;Db.z4=Fg.a.yBh;Db.pgb=Fg.a.CUe;return this.E7(K,wd.cPi,Ia,!0,Db)}Qbf(K,Ia){const Db=wd.$df;var dc=K[Ve.a.Pc].toString();const xc={},Rc=new rh.a;Rc.Ok=Ca.a.instance.ga(9);switch(dc){case "A0":xc.query=(K[Ve.a.Sf]||"").split("|").slice(2,Hi.a.j1).join("|");break;case "A1":xc.query=K.CommandValueId;break;case "Help":xc.gwdropdownflightinfo=A.EwaSettings.xa(222);
xc.query="";break;case rc.a.nLd:A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Rc.Ok=Ca.a.instance.ga(1775),Rc.sourceLocationOverrideResourceId=wd.dfc,xc.feedback=this.Jbh()):xc.query=dc;break;case "HelpArticle":xc.query=K[Ve.a.Sf];break;case "ContactSupport":xc.query=dc;Rc.sourceLocationOverrideResourceId=wd.Rbh;break;case "ShowTraining":case "WhatsNew":xc.query=dc;break;default:return tg.Task.Ta(!0)}Rc.Kw=xc;dc=new Wg.a;dc.z4=Fg.a.K3a;return this.E7(Ia,
Db,Rc,!1,dc,K[rc.a.Zoa]||!1)}Zze(K){const Ia={};Ia.SolutionId=wd.vMa;Ia.Version="0.0.0.0";Ia.StoreType=OSF.StoreType.Sdx;Ia.StoreId=OSF.StoreType.Sdx;Ia.AssetId=null;Ia.AssetStoreId=null;Ia.Height=0;Ia.Width=0;Ia.TargetType=OSF.OsfControlTarget.TaskPane;Ia.IsToBePersisted=!1;Ia.SourceLocationOverrideResourceId=K;Ia.SharedRuntimeId=K;return Ia}Oci(K,Ia,Db){function dc(){fd.LaunchMode="Default";xc.Ok=Ca.a.instance.ga(1822);xc.EO=wd.G1b;xc.jk=Fg.a.Lvb;Rc.jk=Fg.a.Lvb}const xc=new rh.a,Rc=new Wg.a,fd=
{};this.bAa&&this.SSd(fd);fd.LaunchSource="";fd.StartTimeMs=Date.now();fd.CorrelationId=gi.a.create().toString();xc.Kw=fd;xc.focusOnIframeWhenLoaded=!0;xc.taskPaneWidth=wd.Fff;Rc.z4=Fg.a.yUe;Rc.pgb=Fg.a.Obd;switch(Db.command){case -1444574190:let Rd;fd.LaunchMode="RecommendedPivotTables";fd.SelectionContext="";fd.LaunchSource="PivotTableHandRaise"===Object(ea.a)(String,K.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&A.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
K.SourceSelection){var ld=K.SourceSelection.split(",")[0];Ia=A.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:ld,aUf:Rd,range:Dd}=zh.ab(ld,this.$.ua)).returnValue&&!If.h(this.$).tb.n5(Dd))K=this.$.ua.getItemByName(ld),fd.SelectionContext=JSON.stringify(Object(Cc.a)(new ii,{address:Rd,addressWithSheet:ld+"!"+Dd.ZC(!1),sheetId:Xh.d(K),sheetName:ld,isSheetEmpty:!1,columnCount:Dd.width,rowCount:Dd.height,columnIndex:Dd.left+Ia,rowIndex:Dd.top+Ia,selectionType:"Continuous"}));
else if((K=this.$.Bb.getItemByName(Object(ea.a)(String,K.SourceSelection)))&&Xh.n(K)){var Dd=ji.a(K,!0);ld=this.$.ua.getItemByName(K.sheetName);fd.SelectionContext=JSON.stringify(Object(Cc.a)(new Ii,{tableName:K.name,hasTableHeaders:ji.d(K),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Dd.ZC(!1),addressWithSheet:ld.name+"!"+Dd.ZC(!1),sheetId:Xh.d(ld),sheetName:ld.name,isSheetEmpty:!1,columnCount:Dd.width,rowCount:Dd.height,columnIndex:Dd.left+Ia,rowIndex:Dd.top+Ia,selectionType:"Continuous"}))}}xc.Ok=
Ca.a.instance.ga(1821);xc.EO=wd.i$i;xc.jk=Fg.a.SWe;Rc.jk=Fg.a.SWe;break;case -336193495:fd.LaunchMode="RecommendedCharts";xc.Ok=Ca.a.instance.ga(1820);xc.EO=wd.qij;xc.jk=Fg.a.TWe;Rc.jk=Fg.a.TWe;break;case -1336341324:if(!A.EwaSettings.xa(417))return tg.Task.Ta(!1);fd.LaunchMode="NL";xc.EO=wd.G1b;switch(A.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:xc.Ok=Ca.a.instance.ga(1825);fd.NLLaunchModeBrandingCandidatesIndex=1;break;
case 2:xc.Ok=Ca.a.instance.ga(1826);fd.NLLaunchModeBrandingCandidatesIndex=2;break;default:xc.Ok=Ca.a.instance.ga(1824),fd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!A.EwaSettings.xa(217))return tg.Task.Ta(!1);fd.LaunchMode="ChartDesigner";fd.LaunchSelectionMode=Ia.toString();xc.Ok=Ca.a.instance.ga(1827);xc.EO=wd.G1b;break;case 451940422:fd.LaunchSource="AutoFilter";Dd=JSON.parse(K.CommandValueId);fd.AutoFilterSource=JSON.stringify(Object.assign(new Vi,{autoFilterRange:{sheetName:Dd.AutoFilterRange.SheetName,
firstColumn:Dd.AutoFilterRange.FirstColumn,lastColumn:Dd.AutoFilterRange.LastColumn,firstRow:Dd.AutoFilterRange.FirstRow,lastRow:Dd.AutoFilterRange.LastRow},autoFilterType:Dd.AutoFilterType,itemIndex:Dd.ItemIndex,id:Dd.Id}));dc();break;case -167264441:fd.LaunchMode="ExcelIntelligence";fd.TableName=K.tableName;xc.Ok=Ca.a.instance.ga(2287);xc.EO=wd.G1b;xc.jk=Fg.a.Lvb;Rc.jk=Fg.a.Lvb;break;default:A.EwaSettings.xa(217)&&(fd.LaunchSelectionMode=Ia.toString()),A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",
!1)&&(fd.XlimTableBoundaries=this.E8h()),dc()}xc.sourceLocationOverrideResourceId=this.Oid();return this.bAa?this.bAa.Yo(()=>this.k5f(fd,xc)):this.Lli(Db,xc,Rc,fd)}Lli(K,Ia,Db,dc){this.bAa=this.Uxc(this.Zze(Ia.sourceLocationOverrideResourceId),Ia,!1,K,Db,!1);return A.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(dc.NoActionMsgOnFirstInstance=!0,this.qoa[wd.vMa]=dc,this.bAa):this.bAa.Yo(()=>this.k5f(dc,Ia))}k5f(K,Ia){const Db=this.Fd.Xaa(this.Fd.VKa(wd.vMa,Ia.sourceLocationOverrideResourceId));
if(Db){this.qoa[wd.vMa]=K;const {Zbb:dc,owb:xc}=this.loc(this.Fd.QU(Db).OsfPropertyBag,wd.vMa);this.Fd.QU(Db).OsfPropertyBag=dc;this.Fd.QU(Db).HostPropertyBag=xc}this.qya(wd.vMa,"LaunchIdeasAction",K,Ia);return tg.Task.Ta(!0)}Oid(){const K=Fd.AFrameworkApplication.Ub.AudienceGroup;if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(K){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(K){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}E7(K,
Ia,Db=null,dc=!1,xc=null,Rc=!1,fd=null){Ne.TaskExtensions.Yj();Db||(Db=new rh.a);const ld={};ld.SolutionId=Ia;ld.Version="0.0.0.0";ld.StoreType=dc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;ld.StoreId=dc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;ld.AssetId=null;ld.AssetStoreId=null;ld.Height=0;ld.Width=0;ld.TargetType=OSF.OsfControlTarget.TaskPane;ld.IsToBePersisted=!1;ld.SourceLocationOverrideResourceId=Db.sourceLocationOverrideResourceId;if(Db.Ok||fd)this.ied[Ia]=Object(Cc.a)(new si,{aDc:Db.Ok,
BZd:fd,ZCc:Db.EO});A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Db.Kw||(Db.Kw={}),Db.Kw.ShowFeedback=this.$.isFeedbackEnabled,this.qoa[Ia]=Db.Kw):Db.Kw&&(this.qoa[Ia]=Db.Kw);Ia={};Ia[Ve.a.Sf]=ld;fd={};fd.solutionId=ld.SolutionId;fd.version=ld.Version;fd.storeType=ld.StoreType;fd.storeId=ld.StoreId;fd.assetId=ld.AssetId;fd.assetStoreId=ld.AssetStoreId;fd.height=ld.Height;fd.targetType=ld.TargetType;fd.width=ld.Width;fd.isAddinCommands=
!dc;Ia[ca.a.V9]=fd;xc||(xc=new Wg.a);xc.focusOnIframeWhenLoaded=Db.focusOnIframeWhenLoaded;xc.width=Db.taskPaneWidth;Ia[Wg.a.key]=xc;Ia[rc.a.Zoa]=Rc;return this.insertAgave(Ia,K)}Ani(K,Ia,Db,dc,xc){const Rc=(Rd,Pe)=>{var cf=Rd.SolutionId;const Bf=OSF.OsfControl.isFirstPartyStoreString(Rd.StoreType);Bf&&Rd.SourceLocationOverrideResourceId&&(cf=this.Fd.VKa(cf,Rd.SourceLocationOverrideResourceId));var Bg=this.Fd.BDe(cf,null,Rd.SharedRuntimeId);if(Bf){if(A.EwaSettings.xa(263)&&Bg&&(cf=this.Fd.Xaa(cf))){const {Zbb:og,
owb:jg}=this.loc(this.Fd.QU(cf).OsfPropertyBag,Rd.SolutionId);if(cf=this.Fd.Lg.getOsfControl(cf))cf.setSettings(og),cf.setHostSettings(jg)}Rd.SharedRuntimeId&&Bg||this.Fd.Lg.refreshOsfControl(Rd.SolutionId,Rd.SourceLocationOverrideResourceId)}if(!Bg){const og=this.$.pa.va.$b();let jg=519;Bg=(lg,zg,Xg)=>{var Tg=this.$.pa.va;lg=Ra.b(lg,this.bQf);const Yg=Tg.Oa(9,og);Yg.sharedInfo=Rd;return Og.g(Tg,"InsertAgaveTaskpane",Yg,lg,zg,Xg,dc,0)};void 0===Rd.IsToBePersisted||null===Rd.IsToBePersisted||Rd.IsToBePersisted||
(jg=538,Bg=(lg,zg,Xg)=>{const Tg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.SolutionId,Rd.StoreType,Rd.AssetId,null,null,Rd.StoreId);n.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Rd.StoreType}, StoreId ${Rd.StoreId}, SolutionId ${Tg}.`);return Wi(this.$.pa.va,Rd,Ra.b(lg,this.bQf),zg,Xg,dc,og)});xc|=64;return Li.a(this.$.userOperationManager,Bg,lg=>new Qh.a(jg,0,lg,xc),Pe)}return Ne.TaskExtensions.sba()},fd=Rd=>{var Pe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.solutionId,
Rd.storeType,Rd.assetId,null,null,Rd.storeId);n.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Pe} from ${Rd.storeType}.`);Pe={};const cf=new l.a;cf.add(Rd);Pe[ca.a.Cpb]=cf;Pe[ca.a.aM]=3;Rd=new pe.a(df.a.gEb,0,this.$.xc,0,null);return this.$.Ia.Hb(Rd,Pe)};if(!A.EwaSettings.xa(52)||K.StoreId===OSF.StoreType.FirstParty)return Rc(K,Db,dc);if(Ia.isAddinCommands)return fd(Ia);const ld=new Bb.a,Dd={};Dd.solutionId=K.SolutionId;Dd.version=K.Version;Dd.storeType=K.StoreType;Dd.storeId=K.StoreId;
Dd.targetData=K;this.Fd.Lg.isAddinCommandsAsync(Dd,(Rd,Pe,cf)=>{ld.setResult(Pe);Rd||(Rd=cf.targetData,Pe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Rd.SolutionId,Rd.StoreType,Rd.AssetId,null,null,Rd.StoreId),n.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Pe} from ${Rd.StoreType} during addin inserting`))});return Ne.TaskExtensions.ts(ld.task,Rd=>Rd.result?fd(Ia):Rc(K,Db,dc),this.$.ka)}loc(K,Ia){if(!this.qoa[Ia])return{Zdk:K,owb:null};const Db={},dc={};if(K)for(const [Rc,
fd]of K)Db[Rc]=fd;K=this.qoa[Ia];for(var xc of Object.keys(K))Ia=K[xc],xc===wd.aJh&&A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Db[xc]=dc[xc]=Sys.Serialization.JavaScriptSerializer.serialize(Ia):Db[xc]=dc[xc]=Sys.Serialization.JavaScriptSerializer.serialize(Ia.toString());xc=Object.keys(Db).map(Rc=>[Rc,Db[Rc].toString()]);K=Object.keys(dc).map(Rc=>[Rc,dc[Rc].toString()]);return{Zbb:xc,owb:K}}tHi(K,Ia,Db){const dc=this.$.ya.UserSessionId,xc=this.$.ya.UICultureTag,
Rc=this.$.ya.UICultureTagLcid,fd=this.$.ya.WacHostId;let ld="",Dd="";5<=Db.length&&(ld=Db[3],Dd=Db[4]);this.uHi(ld,Dd,K,Ia,xc,Rc,dc,fd)}uHi(K,Ia,Db,dc,xc,Rc,fd,ld){const Dd={};Dd.a=fd;Dd.b=Db;Dd.c=dc;Dd.d=K;Dd.e=Ia;Dd.f=xc;Dd.g=Rc;Dd.h=ld;Bc.b().Ze(36,Dd)}ECe(){if(cj.a.aBf())n.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.gQf);return}catch(K){n.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(K?
K.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.gQf)}catch(K){n.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(K?K.toString():null))}}}Uxc(K,Ia=null,Db=!1,dc=null,xc=null,Rc=!0){var fd=K.SolutionId;let ld=tg.Task.Ta(!1);K&&fd&&K.SharedRuntimeId&&(dc=dc||new pe.a(-859308420,0,2,0,""),fd={},fd.solutionId=K.SolutionId,fd.version=K.Version,fd.storeType=K.StoreType,fd.storeId=K.StoreId,fd.assetId=K.AssetId,fd.assetStoreId=K.AssetStoreId,fd.height=
K.Height,fd.targetType=K.TargetType,fd.width=0,fd.isAddinCommands=!1,fd.sharedRuntimeId=K.SharedRuntimeId,K.Preload=Rc,xc=xc?xc:new Wg.a,xc.width=0,Ia&&(xc.focusOnIframeWhenLoaded=Ia.focusOnIframeWhenLoaded,Rc=new si,Ia.Ok&&(Rc.aDc=Ia.Ok),0<Ia.taskPaneWidth&&(Rc.Qv=Ia.taskPaneWidth),Ia.EO&&(Rc.ZCc=Ia.EO),A.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&Ia.Kw&&(this.qoa[K.SolutionId]=Ia.Kw),this.ied[K.SolutionId]=Rc),Ia={},Ia[Ve.a.Sf]=K,Ia[ca.a.V9]=fd,Ia[Wg.a.key]=xc,Ia[rc.a.Zoa]=
Db,ld=this.insertAgave(Ia,dc));return ld}qya(K,Ia,Db,dc=null){if(K&&Ia){K=new Si.a(K,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const xc=new Ci.a("ExcelOnline","Web",this.$.ya.UICultureTag),Rc=new Ti.a;Rc.optionalProperties[Zg.a.SWc]=Db;dc&&(dc.sourceLocationOverrideResourceId&&(Rc.optionalProperties[Zg.a.sourceLocationOverrideResourceId]=dc.sourceLocationOverrideResourceId),dc.Ok&&(Rc.optionalProperties[Zg.a.Ok]=dc.Ok),dc.jk&&(Rc.optionalProperties.IconCssClass=dc.jk),dc.yZd&&(Rc.optionalProperties.TaskPaneIconUrl=
dc.yZd),dc.EO&&(Rc.optionalProperties.TaskPaneIconId=dc.EO));yh.a.instance.qya(K,Vh.a.action,Ia,xc,Rc)}}j3h(K){if(!uh.a.ah(K)){var Ia=K[nd.a.Vvb];if(Ia&&(Ia=Ia.getId(),K=K[nd.a.gda],Ia&&K))return this.VKa(Ia,K.optionalProperties[Zg.a.sourceLocationOverrideResourceId])}return null}VKa(K,Ia=null){return K&&Ia?`${K}.${Ia}`:K}vVh(K){switch(K){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return A.EwaSettings.xa(217)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;
case 515196233:return 1023;default:return 1}}l0d(){this.$.ea.Kf?this.pMd():(this.$.ea.Zj(this.pMd),this.Ncb=!0)}E8h(){var K=this.$.da.Ba(20);if(!K)return this.l0d(),"";K=K.pwa();if(!K)return this.l0d(),"";var Ia=this.$.ua.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.na.name);Ia=Xh.d(Ia);var Db=If.h(this.$).ha.ra.selectedRanges;const dc=[];for(const Rc of Db){Db=new Gd.a(Rc,Ia);var xc=K.F5a(Db,Ad.Valid);Db=[];if(xc)for(const fd of xc)(xc=fd.table.Ry)&&(xc=xc.range.toString())&&
Db.push(xc);Db=new Ki(Rc.toString(),Db);dc.push(Db)}return JSON.stringify(dc)}}wd.iii="Microsoft.Office.Excel.IdeasXLOPreload";wd.yGd="IDS";wd.$df="FA000000012";wd.vMa="FA000000005";wd.pgi="HelloWorld";wd.H6g="FA000000014";wd.dfc="Help.GiveFeedback.Url";wd.Rbh="Help.ContactSupport.Url";wd.aJh="feedback";wd.Gsf="FA000000066";wd.bbj="PowerBi.Url";wd.$aj="PowerBi.DevUrl";wd.abj="FA000000054";wd.cPi="FA000000064";wd.X6i="FA000000075";wd.G1b="AnalyzeDataTaskPane";wd.qij="RecommendedChartsTaskPane";wd.i$i=
"PivotTableTaskPane";wd.Snh=350;wd.Fff=320;wd.Tdj=320;wd.GSg="g_InstallOrigin";Object(d.a)(wd,"AgaveCommandManager",Le.a,[808,809]);class me extends h.a{constructor(K){super();this.$=K;this.Gb()}create(){const K=this.$.da,Ia=yf.GetServiceTaskFactory.create(K,106,this.ka,this.Na),Db=yf.GetServiceTaskFactory.create(K,104,this.ka,this.Na),dc=Qg.a.loadScript(35,0,this.Na,void 0,void 0,375);Ne.TaskExtensions.za(Ne.TaskExtensions.Md([Db,Ia,dc],this.ka),()=>{let xc=null;A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)&&(xc=Of.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);$g.instance.initialize(Ia.result);const Rc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(xh.a)(this.$.da,374,()=>new wd(this.$,Ia.result,Db.result,xc,Fd.AFrameworkApplication.rb)):new wd(this.$,Ia.result,Db.result,xc,Fd.AFrameworkApplication.rb);K.Ha(206,Rc);this.qb(K.Ba(374)||K.Ha(374,Rc))},this.ka,3);Of.a.instance.register(Gi.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").tc().Bc(()=>
new Gi.a(this.$.nv))}static la(K){K.da.Ha(375,new me(K))}}Object(d.a)(me,"AgaveCommandManagerFactory",h.a,[]);var Me=a(568);class Se{constructor(){this.initialized=!1;this.agaveCommandManager=this.Fd=this.w1a=null;this.gU={}}initialize(K){A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.Awj(K)}jni(K,Ia){let Db=Ne.TaskExtensions.Yj();if(this.initialized&&K&&0<K.length){let dc=this.iSh(K);K in this.gU&&(Db=this.agaveCommandManager.insertAgave(dc,
Ia))}return Db}$Kg(K){this.initialized&&(K=K[Ve.a.Sf]||{},!K.SolutionId||K.SolutionId in this.gU||this.Fd.Bda(Ia=>{this.Bda(Ia)},!0))}Vdi(K){this.initialized&&(K=K||"")&&0<K.length&&K in this.gU&&(delete this.gU[K],this.Fd.Bda(Ia=>{this.Bda(Ia)},!0))}iSh(K){return K in this.gU?this.gU[K]:{}}Bda(K){var Ia=!1;if(K&&!K.errorCode){if(K.value)for(const Db of K.value)K=Db[1],Db[3]==OSF.OsfControlTarget.InContent&&K&&0<K.length&&!(K in this.gU)&&(Ia={NoReporting:!1,IsSystemInitiated:!1},Ia.description=Db[2],
Ia.iconUrl=Db[9],Ia[ca.a.V9]={solutionId:Db[1],version:Db[4],storeType:Db[12],storeId:Db[11],assetId:Db[5],assetStoreId:Db[6],targetType:Db[3],width:Db[7],height:Db[8],displayName:Db[0],id:Db[1]},Ia[Ve.a.Sf]={SolutionId:Db[1],Version:Db[4],StoreType:Db[12],StoreId:Db[11],AssetId:Db[5],AssetStoreId:Db[6],TargetType:Db[3],Width:Db[7],Height:Db[8],Id:Db[1]},this.gU[K]=Ia,Ia=!0);Ia&&this.Ifh()}}Ifh(){let K=[];for(const Ia in this.gU)K.push({id:Ia,controlType:0,title:this.gU[Ia][ca.a.V9].displayName});
if(0<K.length){for(const Ia in this.gU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Ia,this.gU[Ia].iconUrl);this.S7g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:Se.hBf,isOfficeTab:!0,groups:[{id:Se.Dhf,title:Se.Ehf,controls:K}]}]});for(const Ia in this.gU)this.w1a.addCommandToMaps(Object(Cc.a)(new fc.a(Ia,"-1473679467"),{legacyControlId:Ia}))}}S7g(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:Se.hBf,isOfficeTab:!0,groups:[{id:Se.Dhf,title:Se.Ehf,controls:[]}]}]})}Awj(K){const Ia=
yf.GetServiceTaskFactory.Pa(K.da,374,375,1),Db=yf.GetServiceTaskFactory.create(K.da,106,K.ka,1);Ne.TaskExtensions.za(Ne.TaskExtensions.Md([Ia,Db],K.ka),()=>{this.agaveCommandManager=Ia.result;this.w1a=Of.a.instance.og("Common.IExternalUICommandDefinitionMapping")||new Me.a(K.Cb,K);Fd.AFrameworkApplication.rb.Qb(df.a.tXf,th.a.frame,(dc,xc,Rc,fd,ld)=>{this.Vdi(ld)});this.Fd=Db.result;this.Fd.Bda(dc=>{this.Bda(dc)},!0);this.initialized=!0},K.ka,3)}}Se.hBf="tabinsert";Se.Dhf="installedContentAddins";
Se.Ehf=Ca.a.instance.ga(2285);Object(d.a)(Se,"AgaveCommandRibbon",null,[807]);class Jf extends h.a{constructor(K){super();this.$=K;this.Gb()}create(){if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){const K=this.$.da,Ia=new Se;Ia.initialize(this.$);this.qb(K.Ba(488)||K.Ha(488,Ia))}}static la(K){K.da.Ha(489,new Jf(K))}}Object(d.a)(Jf,"AgaveCommandRibbonFactory",h.a,[]);var dg=a(1335),Ef=a(750);class tf{constructor(){this.Q$d=this.k$d=
this.Afa=null;this.Hkb=0}get displayName(){return this.Afa}set displayName(K){this.Afa=K}get email(){return this.k$d}set email(K){this.k$d=K}get federationProvider(){return this.Q$d}set federationProvider(K){this.Q$d=K}get identityType(){return this.Hkb}set identityType(K){this.Hkb=K}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(K){switch(K){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Ia){switch(K){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}static Tgh(K){const Ia=new tf;Ia.displayName=K.displayName;Ia.email=K.email;
switch(K.authority){case dg.a.SMf:Ia.identityType=1;break;default:Ia.identityType=0}Ia.federationProvider="";return Ia}}Object(d.a)(tf,"OfficeIdentityInfo",null,[]);class fg{static get ySe(){return fg.qzg}static sdc(K){return K in fg.ySe?fg.ySe[K].toString():K}}fg.map=null;fg.qzg={["GeneralException"]:Ef.a.generalException,["AccessDenied"]:Ef.a.OWc,["ApiNotAvailable"]:Ef.a.apiNotAvailable,["UserNotSignedIn"]:Ef.a.userNotSignedIn,["UserAborted"]:Ef.a.userAborted,["UnsupportedUserIdentity"]:Ef.a.y3j,
["InvalidResourceUrl"]:Ef.a.invalidResourceUrl,["InvalidGrant"]:Ef.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:Ef.a.ISg,["ResourceNotAllowed"]:Ef.a.muj,["ClientError"]:Ef.a.clientError,["ServerError"]:Ef.a.serverError};Object(d.a)(fg,"SingleSignOnErrorCodeMap",null,[]);class hg{constructor(K,Ia){this.uSb=K;this.Hkb=Ia}get accessToken(){return this.uSb}set accessToken(K){this.uSb=K}get tokenIdenityType(){return this.Hkb}set tokenIdenityType(K){this.Hkb=K}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(K){switch(K){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Ia){switch(K){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(d.a)(hg,"SingleSignOnToken",null,[]);class sg{constructor(){this.C6d=null;this.Hke=this.iYb=this.bE="";this.Vle=!0;this.options=null}get authChallenge(){return this.C6d}set authChallenge(K){this.C6d=
K}get correlationId(){return this.bE}set correlationId(K){this.bE=K}get policy(){return null}set policy(K){}get resource(){return this.iYb}set resource(K){this.iYb=K}get scope(){return this.Hke}set scope(K){this.Hke=K}get silentLogin(){return this.Vle}set silentLogin(K){this.Vle=K}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(K){switch(K){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Ia){switch(K){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(d.a)(sg,"TokenParameters",null,[474]);class Rg{constructor(K,Ia){this.bjb=Ia;this.Oy=K}get roamingSettings(){return null}getAccessToken(K){const Ia=this.bjb.getOsfControl(this.Oy),Db=Ia.getManifest(),dc=Db.getMarketplaceID();this.HOa(K,dc);return OfficeExtension.WacRuntime.Utility.createPromise((xc,Rc)=>{Ia.isFirstParty()&&this.bjb._enableFirstPartySSO?this.gqi(Db,K)?Of.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(K,
dc).then(fd=>{xc(fd)},fd=>{Rc(fd)}):Rc(Ef.a.OWc):Rc(Ef.a.apiNotAvailable)}).then(xc=>{let Rc;switch(xc.authority){case dg.a.SMf:Rc=1;break;default:Rc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new hg(xc.accessToken,Rc))},xc=>{this.logErrorResponse(K,dc,xc);return xc?OfficeExtension.WacRuntime.Utility.createPromise((Rc,fd)=>{fd(OfficeExtension.WacRuntime.Utility.createRichApiException(xc,fg.sdc(xc)))}):OfficeExtension.WacRuntime.Utility.createPromise((Rc,fd)=>{fd(OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.generalException,
fg.sdc(Ef.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const K=this.bjb.getOsfControl(this.Oy);K.getManifest();const Ia=K.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((Db,dc)=>{Of.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ia).then(xc=>{Db(xc)},xc=>{dc(xc.toString())})}).then(Db=>{Db=tf.Tgh(Db);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Db)},Db=>Db?OfficeExtension.WacRuntime.Utility.createPromise((dc,
xc)=>{xc(OfficeExtension.WacRuntime.Utility.createRichApiException(Db,fg.sdc(Db)))}):OfficeExtension.WacRuntime.Utility.createPromise((dc,xc)=>{xc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.generalException,fg.sdc(Ef.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(K){switch(K){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 1:return this.zRh(Ia);case 3:return this.TSh();case 2:return this.p4h()}K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}zRh(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,sg);return this.getAccessToken(K)}TSh(){return this.getAuthContext()}p4h(){return this.getPrimaryIdentityInfo()}gqi(K,Ia){let Db=!1;const dc=K.getWebApplicationAuthorizations();K=null;for(const xc of dc)if(xc.getResource().toLowerCase()===Ia.resource.toLowerCase()){K=xc;Db=!0;break}if(!Db)return!1;Ia=Ia.scope.split(" ,+");for(const xc of Ia)if(xc&&xc.length){Ia=
!1;for(const Rc of K.getScopes())xc.toLowerCase()===Rc.toLowerCase()&&(Ia=!0);if(!Ia)return!1}return!0}HOa(K,Ia){K=this.RAf(K.resource);n.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Ia,["resource"]:K})}logErrorResponse(K,Ia,Db){K=this.RAf(K.resource);n.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Ia,["resource"]:K,["error"]:Db})}RAf(K){return K.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(d.a)(Rg,"AuthenticationService",null,[]);class Pg{create(K,
Ia){return new Rg(K,Ia)}}Object(d.a)(Pg,"AuthenticationServiceFactory",null,[]);var Gg=a(155),nh=a(869),eh=a(990),Ff=a(970);class Pf{}Pf.generalException="generalException";Pf.invalidArgument="invalidArgument";Pf.notAllowed="notAllowed";Pf.apiNotAvailable="apiNotAvailable";Pf.unresolvedPendingRequest="unresolvedPendingRequest";Pf.timeout="timeout";Pf.adalTimeout="adalTimeout";Pf.userNotSignedIn="userNotSignedIn";Pf.userAborted="userAborted";Pf.silentSignInFailed="silentSignInFailed";Pf.invalidResourceUrl=
"invalidResourceUrl";Pf.invalidGrant="invalidGrant";Pf.connectionLost="connectionLost";Pf.clientError="clientError";Pf.serverError="serverError";Object(d.a)(Pf,"WopiHostErrorCodes",null,[]);var lf=a(563);class Uf{}Object(d.a)(Uf,"OAuthCallerMetadata",null,[]);var Xf=a(27);class ig{constructor(K){this.Gya=K;this.hzg=Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}mKg(K,Ia,Db,dc,xc,Rc){if(!this.Gya)return dc=new eh.a,dc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(dc);const fd=new Uf;fd.AddinName=xc;fd.AddinTrustId=Rc;let ld=-1;Rc=null;if(dc&&this.Mlf())Rc=this.Gya.Kjg(ca.a.rDc,K,dc,ig.j8e(xc),fd);else{const Dd=Date.now();Rc=this.Gya.tL(ca.a.rDc,K,fd).then(Rd=>{ld=Date.now()-Dd;const Pe=(Ia||Db)&&"login_required"===Rd.ErrorCode;return(Ia&&("interaction_required"===Rd.ErrorCode||"consent_required"===Rd.ErrorCode||"invalid_grant"===Rd.ErrorCode)||Pe)&&this.Mlf()?this.Gya.Kjg(ca.a.rDc,K,null,ig.j8e(xc),fd):Promise.resolve(Rd)})}return Rc.then(Dd=>
{const Rd=new eh.a;Dd.IsSuccess?(Rd.token=Dd.Token,Dd.Telemetry&&(Rd.tUa=Dd.Telemetry.fromCache,Rd.expiresOn=Dd.Telemetry.expiresOn)):(Rd.errorCode=this.SKi(Dd),Rd.GZd=this.m8i(Dd));return Rd}).catch(()=>{const Dd=new eh.a;Dd.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Dd)}).then(Dd=>{Dd.xha="OauthManager";0<=ld&&(Dd.Ryb=ld);return Dd})}Isi(K){const Ia=(Fd.AFrameworkApplication.fa.Wa(Fd.AFrameworkApplication.Z7)||"").toLowerCase();return(Xf.a.Xxa||"teams"===
Ia&&lf.OAuthManagerSettings.aAb)&&!ig.nsi(K)||!this.Gya||!this.Gya.j7a()?!1:!0}Mlf(){return this.hzg||1!==Ff.a.Gcc()}SKi(K){switch(K.ErrorCode){case "UserCancelled":case "interaction_required":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":K=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:K=K.ErrorCode===Pf.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:K.ErrorCode===Pf.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:K.ErrorCode===Pf.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
K.ErrorCode===Pf.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:K.ErrorCode===Pf.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return K}m8i(K){let Ia="";(K=RegExp("AADSTS(\\d+)").exec(K.ErrorMessage))&&1<K.length&&(Ia=K[1]);return Ia}static j8e(K){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,K)}static nsi(K){if(!K)return!1;K=K.toLowerCase();for(const Ia of nh.AppsForOfficeSingleSignOnManager.k_e)if(Ia===
K)return!0;return!1}}Object(d.a)(ig,"AppsforOfficeTokenFromOauthManager",null,[869]);class Yf{constructor(K){this.$Ji=K}static ppa(){if(Fd.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var K=null;try{K=Of.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ia){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ia)}K=new ig(K);Yf.Ma=new Yf(K)}}static getInstance(){Yf.Nbe||(Yf.ppa(),Yf.Nbe=!0);return Yf.Ma}}Yf.Ma=null;Yf.Nbe=!1;Object(d.a)(Yf,"AppsForOfficeOauthManagerFactory",
null,[852]);var $f=a(1334),ag=a(141);class qg{constructor(K,Ia,Db,dc){this.menuItemId=K;this.dG=Ia;this.ZTj=Db;this.LJh=dc}}Object(d.a)(qg,"NewDocumentParameters",null,[]);const kh=K=>{var Ia=K.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Db=Ia.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Db.addParameter("shortcuts","String[]",1,null,0);Ia.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",
0);Db=Ia.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Db.addParameter("shortcuts","Object",1,null,0);Ia=K.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Db=Ia.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Db.addParameter("pickerCustomizationJsonString","String",1,null,0);Ia=K.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",
3,2);Db=Ia.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Db.addParameter("appName","String",1,null,0);Db.addParameter("target","String",1,null,0);Ia=K.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Db=Ia.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Db.addParameter("base64File","String",1,null,0);Ia=K.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);Ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Db=Ia.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Db.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ia=K.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ia.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Db=Ia.addMethod("Register",1,"Void",0,0,"Register",0);Db.addParameter("metadata","String",1,null,0);Db.addParameter("javascript","String",1,null,0);Ia=K.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ia.addProperty("Enabled",1,"Boolean",1,!1,null,0);Ia.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ia.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ia=K.addEnumType("Microsoft.Authentication.IdentityType");Ia.addEnumField("OrganizationAccount",
0);Ia.addEnumField("MicrosoftAccount",1);Ia=K.addEnumType("Microsoft.Authentication.AuthorityType");Ia.addEnumField("External",0);Ia.addEnumField("Msa",1);Ia.addEnumField("Aad",2);Ia=K.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ia.addProperty("DisplayName",4,"String",1,!1,null,0);Ia.addProperty("Email",3,"String",1,!1,null,0);Ia.addProperty("FederationProvider",2,"String",1,!1,null,0);Ia.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ia.addProperty("AppId",4,"String",1,!1,null,0);Ia.addProperty("Authority",2,"String",1,!1,null,0);Ia.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ia.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ia.addProperty("TenantId",6,"String",1,!1,null,0);Ia.addProperty("Upn",
1,"String",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ia.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Db=Ia.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Db.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ia.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Ia.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ia=K.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Ia.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ia.addProperty("CorrelationId",7,"String",1,!1,null,0);Ia.addProperty("Policy",4,"String",1,!1,null,0);Ia.addProperty("Resource",2,"String",1,!1,null,0);Ia.addProperty("Scope",
5,"String",1,!1,null,0);Ia.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ia.addProperty("AccessToken",2,"String",1,!1,null,0);Ia.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ia.addProperty("Id",1,"String",1,
!0,null,0);Ia.addProperty("Value",2,"Object",1,!1,null,0);Ia=K.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Db=Ia.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Db.addParameter("id","String",1,null,0);Db=Ia.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Db.addParameter("id","String",1,null,0);Ia=K.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Db=Ia.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Db.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ia=K.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ia.addEnumField("Inactive",0);Ia.addEnumField("Background",1);Ia.addEnumField("Visible",2);Ia=K.addEnumType("Microsoft.AppRuntime.Visibility");
Ia.addEnumField("Hidden",1);Ia.addEnumField("Visible",2);Ia=K.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ia.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Db=Ia.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Db.addParameter("jsonCreate","String",1,null,0);Db=Ia.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Db.addParameter("jsonUpdate",
"String",1,null,0);Db=Ia.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Db.addParameter("id","String",1,null,0);Db=Ia.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Db.addParameter("id","String",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia=K.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ia.addProperty("Id",2,"String",1,!0,null,0);Db=Ia.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Db.addParameter("visibility","Boolean",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia=K.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ia.addProperty("Enabled",3,"Boolean",1,!1,null,0);Ia.addProperty("Id",2,"String",1,!0,null,0);Ia.addProperty("Label",4,"String",1,!0,null,0);Db=Ia.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Db.addParameter("enabled","Boolean",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Ia=K.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ia.addMethod("GetCount",3,"Int32",1,1,"Count",0);Db=Ia.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Db.addParameter("key","String",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ia=K.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ia.addEnumField("Unknown",0);Ia.addEnumField("Basic",
1);Ia.addEnumField("Premium",2);Ia=K.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Db=Ia.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Db.addParameter("feature","String",1,null,0);Db.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Db=Ia.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Db.addParameter("feature","String",1,null,0);Db=Ia.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Db.addParameter("feature","String",1,null,0);Db.addParameter("fallbackValue","Boolean",1,null,0);Ia.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Db=Ia.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Db.addParameter("experienceId","String",1,null,0);Db=Ia.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Db.addParameter("feature","String",1,null,0);Ia=K.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ia.addProperty("Id",5,"String",1,!0,null,0);Ia.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Ia.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ia=K.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Ia.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ia=K.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Ia.addMethod("Disable",3,"Void",0,1,"Disable",0);Ia.addMethod("Enable",2,"Void",0,1,"Enable",0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var Vf=a(185);class ti{constructor(K,Ia){this.zDg=K;this.VDg=Ia}createAndOpenWorkbook(K){if(K&&
K.length>this.zDg)throw n.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",K.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.invalidArgument,Vf.a.ga(1769));const Ia=new qg("blank","agave",K?"streamBase64":"streamEmpty",K);let Db=null;return OfficeExtension.WacRuntime.Utility.createPromise((dc,xc)=>{const Rc=new ag.StandardDialog;Rc.Rb=4;Rc.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,fd=>{2===fd||0===fd?xc("Cancelled"):
(Db=window.open(""),this.VDg.create(dc,xc,Ia).Y1a())})}).then(dc=>{if(!dc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.generalException,Vf.a.ga(1765));try{Db.top.location.href=dc}catch(xc){n.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Xf.a.kp,xc),n.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Db.location.replace(dc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},dc=>{if("Cancelled"===dc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.BGd,Vf.a.ga(1768));Db.close();this.hXj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 1:return this.Beh(Ia)}K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Beh(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.createAndOpenWorkbook(K)}hXj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.generalException,
Vf.a.ga(1765));}}Object(d.a)(ti,"WacWorkbook",null,[]);const Yi=(K,Ia)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof K+", objectId="+K+", value="+Ia);return null},dj=K=>{K.add("InternalTest","PreviewExecutionMethod",Yi)};var oh=a(258),Af=a(748),bh=a(749);class fh{constructor(K){this.mb=K}get $(){return this.mb}}Object(d.a)(fh,"RichApiPreviewExecutionContext",null,[]);var mg=a(24),Sg=a(995),sh=a(214),Ah=a(218),Mh=a(114),ki=a(12);class kj extends Ah.a{constructor(K,
Ia,Db,dc,xc){super(K,"Select Data");this.htmlSanitizationHelper=this.Zqb=null;this.kMe=Ia;this.d9c=Db;this.htmlSanitizationHelper=xc;this.callback=dc}get pc(){return"DdaBindingPrompt"}start(K,Ia){let Db="<div class='"+Mh.a.Cyh+" "+Fg.a.vo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Mh.a.RC+"' /></div>";Db=String.format(Db,Cg.a.Og(this.d9c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.htmlSanitizationHelper.jh(this.Pb,Db);this.Zqb=
ki.DOMElementExtensions.getElementById(this.Pb,"bindingText");K=Ia?K.d4a(Ia,this.d9c.DdaBindingsMethod.BindingId):null;(null===K||void 0===K?0:K.IsValidRef)?(Ia=new mg.Range(K.Reference.FirstRow+1,K.Reference.FirstColumn+1,K.Reference.LastRow+1,K.Reference.LastColumn+1,!1,!1),this.Zqb.value=K.Reference.SheetName+"!"+Ia):(K=If.h(this.$).ha,this.Zqb.value=Xh.f(this.$.na)||!K.ra.eh?"":K.Gia);this.initialize();this.fg()}fq(){this.J3c();this.addButton(0);this.addButton(1);super.fq()}setFocus(){ki.DOMElementExtensions.setFocus(this.Zqb)}validate(){return!0}commit(){let K=
this.Zqb.value.trim();const Ia=K.indexOf("!");-1!==Ia&&(K=this.t7h(K.substring(0,Ia))+K.substr(Ia));this.kMe.addBinding(this.d9c,K,0,this.callback);return!0}rta(){this.kMe.nQ.Cf(Af.a.internalError,this.callback);super.rta()}t7h(K){K=hf.a.trimStart(K.trim(),"=");return K.length?K.startsWith("'")&&K.endsWith("'")?K:vf.HelperMethods.D$b(K):""}}Object(d.a)(kj,"DdaBindingPrompt",Ah.a,[]);class lj{constructor(K){this.ea=K}Cf(K,Ia){if(Ia){const Db={};Db.Error=K;Db.Version=this.ea.se;Ia(Db)}}UKa(K,Ia){this.Cf(K,
Ia)}sH(K,Ia){this.Cf(Af.a.Q0e(K.Errors[0].MessageId),Ia)}uv(K){K&&K(this.$P())}$P(){const K={Error:0};K.Version=this.ea.se;return K}}Object(d.a)(lj,"DdaErrorGenerator",null,[]);var gh=a(255);class Mi{constructor(K,Ia,Db){this.$=K;this.nQ=Ia;this.dA=Db}DBd(K,Ia){const Db=K.DdaGoToByIdMethod.GoToType,dc=K.DdaGoToByIdMethod.SelectionMode,xc=K.DdaGoToByIdMethod.Id.toString().trim(),Rc=fd=>{const ld=this.$.ua.getItemByName(fd.SheetName);(null===ld||void 0===ld?0:ld.visible)?(If.h(this.$).sg(fd,null,null,
null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.nQ.uv(Ia)):this.nQ.Cf(Af.a.k5g,Ia)};0===Db?this.TOi(xc,dc,K.DdaMethod.ControlId,Rc,Ia):1===Db?this.XOi(xc,dc,Rc,Ia):this.nQ.Cf(Af.a.v3j,Ia)}TOi(K,Ia,Db,dc,xc){this.dA.ddaGetBinding(Db,K,Rc=>{if(!gh.a(Rc)&&Rc.Result&&Rc.Result.Reference){Rc=Rc.Result;var fd={};fd.SheetName=Rc.Reference.SheetName;fd.FirstRow=Rc.Reference.FirstRow;fd.FirstColumn=Rc.Reference.FirstColumn;fd.LastRow=Rc.Reference.LastRow;fd.LastColumn=Rc.Reference.LastColumn;
Mi.EZc(fd,Ia);1!==Rc.BindingType?dc(fd):this.dA.ddaGetBindingData(Db,K,1,0,2,0,0,-1,-1,ld=>{gh.a(ld)||!ld.Result?this.nQ.sH(ld,xc):(ld=ld.Result,2!==Ia&&(fd.FirstRow-=ld.Headers.length,0>fd.FirstRow&&(fd.FirstRow=0)),dc(fd))},xc)}else this.nQ.UKa(Af.a.xdg,xc)},xc)}XOi(K,Ia,Db,dc){var xc=zh.A(K);xc?(xc=zh.v(xc,this.$),Mi.EZc(xc,Ia),Db(xc)):this.$.ea.isNamedObjectViewMode&&this.$.Bb.Kk(K)?this.$.Bb.na=this.$.Bb.getItemByName(K):(xc=Rc=>{gh.a(Rc)||!Rc.Result?this.$.ua.contains(K)?(Rc={},Rc.SheetName=
K,Rc.FirstRow=0,Rc.FirstColumn=0,Rc.LastRow=0,Rc.LastColumn=0,Db(Rc)):this.nQ.UKa(Af.a.xdg,dc):(Rc=Rc.Result,Mi.EZc(Rc,Ia),Db(Rc))},this.$.ua.na?this.dA.parseRangeForGoto(K,this.$.ua.na.name,xc,dc):this.dA.parseRange(K,xc,dc))}static EZc(K,Ia){K.LastRow=2===Ia?K.FirstRow:K.LastRow;K.LastColumn=2===Ia?K.FirstColumn:K.LastColumn}}Object(d.a)(Mi,"DdaNavigator",null,[]);const mj=(K,Ia,Db,dc,xc,Rc)=>{const fd=K.Oa(1);fd.request=Ia;return Og.g(K,"ExecuteRichApiRequest",fd,Db,dc,xc,Rc,0)};var nj=a(303),
Ni;(function(K){K[K.unsupported=0]="unsupported";K[K.surface=1]="surface";K[K.combo=2]="combo";K[K.column=3]="column";K[K.column3D=4]="column3D";K[K.bar=5]="bar";K[K.bar3D=6]="bar3D";K[K.line=7]="line";K[K.line3D=8]="line3D";K[K.pie=9]="pie";K[K.pie3D=10]="pie3D";K[K.scatter=11]="scatter";K[K.bubble=12]="bubble";K[K.area=13]="area";K[K.area3D=14]="area3D";K[K.doughnut=15]="doughnut";K[K.radar=16]="radar";K[K.stock=17]="stock";K[K.waterfall=18]="waterfall";K[K.funnel=19]="funnel";K[K.treemap=20]="treemap";
K[K.sunburst=21]="sunburst";K[K.boxWhisker=22]="boxWhisker";K[K.histogram=23]="histogram";K[K.pareto=24]="pareto";K[K.regionMap=25]="regionMap";K[K.noVisibleSeries=26]="noVisibleSeries";K[K.complexDataSource=27]="complexDataSource";K[K.pivotChart=28]="pivotChart"})(Ni||(Ni={}));Object(d.b)("ChartCategory",Ni);class oj{constructor(K,Ia){this.source=K;this.eventId=Ia}}Object(d.a)(oj,"MacroRecorderEventData",null,[]);class vh{constructor(K,Ia,Db){this.parentName=K;this.$=Ia;this.request=Db}L5h(K){var Ia;
if(void 0===K||null===K||void 0===K.RequestBody||null===K.RequestBody)return null;const Db=JSON.parse(K.RequestBody);if(void 0!==K.ActiveChartId&&null!==K.ActiveChartId){Db.ActiveChartId=K.ActiveChartId;const dc=If.h(this.$).ha.Sa.jc;if(null===(Ia=null===dc||void 0===dc?void 0:dc.floatingObject)||void 0===Ia?0:Ia.ed)Db.ActiveChartType=Ni[dc.floatingObject.ed.ChartCategory]}void 0!==K.SheetMultiRange&&null!==K.SheetMultiRange&&(Db.SheetName=K.SheetMultiRange.SheetName);return Db}X5h(K){if(void 0===
K||null===K||void 0===K.Result||null===K.Result)return null;K=K.Result;return void 0===K.ResponseBody||null===K.ResponseBody||K.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(K.ResponseBody.join(""))}qxi(K){return!!K&&!(void 0===K.eventId||null===K.eventId)&&0<K.eventId.length}ak(K){return()=>{if(this.$.Uba){const Ia=this.s1g(this.request);if(this.qxi(Ia)){const Db=this.L5h(this.request),dc=this.X5h(K);if(Db&&!uh.a.isEmpty(Db)&&dc&&!uh.a.isEmpty(dc))return n.ULS.sendTraceTag(537163164,0,
50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Y(Ia,Db,dc);n.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Db?"(not null)":"(null)"}; responseInfo: ${dc?"(not null)":"(null)"}`}`)}}return new Y(null,null,null)}}s1g(K){const Ia=this.rxi(K.SolutionId),Db=vh.r5h(K);if(Db&&Ia)return n.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Db,["request.SolutionId"]:K.SolutionId})}`),
new oj(K.SolutionId,Db);K=JSON.stringify({["recorderEventId"]:Db,["isRecorderAwareAddin"]:Ia,["request.SolutionId"]:K.SolutionId});n.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${K}`);return null}rxi(K){if(!K)return!1;K=K.toLowerCase();return vh.wai().contains(K)}static wai(){vh.AAa||(vh.AAa=new u.a(J.a.li()),vh.AAa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),vh.AAa.add("fa000000005"),vh.AAa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),vh.AAa.add("fa000000014"),vh.AAa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return vh.AAa}static r5h(K){let Ia=null;var Db=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Db.test(K.RequestBody))Ia=Db.exec(K.RequestBody)[1];else{K=K.RequestHeaders;if(!K)return Ia;Db=ie.a.DRi.toLowerCase();for(let dc=0;dc<K.length;dc++)if(K[dc].Name.toLowerCase()===Db){Ia=K[dc].Value;break}}return Ia}}vh.AAa=null;Object(d.a)(vh,"DdaRichApiRequestRecorder",null,[]);class pj extends nj.a{constructor(K,Ia,Db,dc,xc,Rc,fd,ld){super(10,0,Ia,ld);this.Knb=Db;this.Xjb=
dc;this.w3=xc;this.qGa=Rc;this.request=fd;this.nQd=new vh("10",K,fd)}get VFc(){return this.qGa}get Tt(){return this.Knb}get Taa(){return this.Xjb}R2(K){return super.R2(K)||this.e4g(K)}ak(){return this.nQd.ak(this.zd)}rgb(){const K={OperationType:3};K.RichApiRequest=this.request;return K}e4g(K){return(Ia,Db,dc)=>mj(K,this.request,Ra.b(Ia,this.Knb),Ra.a(Db,this.Xjb),dc,this.w3)}}Object(d.a)(pj,"DdaRichApiRequestBatchOperation",nj.a,[]);class qj extends Qh.a{constructor(K,Ia,Db,dc){super(576,0,Db,dc);
this.nQd=new vh("576",K,Ia)}ak(){return this.nQd.ak(this.zd)}}Object(d.a)(qj,"DdaRichApiRequestOperation",Qh.a,[]);class ej{constructor(K,Ia){this.nI=(Db,dc)=>{this.nQ.UKa(Af.a.internalError,dc)};this.$=K;this.nQ=Ia}ddaAddBinding(K,Ia,Db,dc,xc,Rc,fd){this.TJ((ld,Dd,Rd)=>{var Pe=this.$.pa.va,cf=this.$ja();ld=Ra.b(ld,Rc);Dd=Ra.a(Dd,this.nI);const Bf=Pe.Oa(9);Bf.controlId=K;Bf.bindingId=Ia;Bf.bindingType=Db;Bf.currentSheetName=cf;Bf.formula=dc;Bf.options=xc;return Og.g(Pe,"DdaAddBinding",Bf,ld,Dd,Rd,
fd,0)},fd,563)}ddaReleaseBinding(K,Ia,Db,dc){this.TJ((xc,Rc,fd)=>{var ld=this.$.pa.va;xc=Ra.b(xc,Db);Rc=Ra.a(Rc,this.nI);const Dd=ld.Oa(9);Dd.controlId=K;Dd.bindingId=Ia;return Og.g(ld,"DdaReleaseBinding",Dd,xc,Rc,fd,dc,0)},dc,564)}ddaGetBinding(K,Ia,Db,dc){this.TJ((xc,Rc,fd)=>{var ld=this.$.pa.va;xc=Ra.b(xc,Db);Rc=Ra.a(Rc,this.nI);const Dd=ld.Oa(1);Dd.controlId=K;Dd.bindingId=Ia;return Og.g(ld,"DdaGetBinding",Dd,xc,Rc,fd,dc,0)},dc,565,16)}ddaGetAllBindings(K,Ia,Db){this.TJ((dc,xc,Rc)=>{var fd=this.$.pa.va;
dc=Ra.b(dc,Ia);xc=Ra.a(xc,this.nI);const ld=fd.Oa(1);ld.controlId=K;return Og.g(fd,"DdaGetAllBindings",ld,dc,xc,Rc,Db,0)},Db,566,16)}ddaGetBindingData(K,Ia,Db,dc,xc,Rc,fd,ld,Dd,Rd,Pe){this.TJ((cf,Bf,Bg)=>{var og=this.$.pa.va,jg=this.$ja();cf=Ra.b(cf,Rd);Bf=Ra.a(Bf,this.nI);const lg=og.Oa(1);lg.controlId=K;lg.bindingId=Ia;lg.coerceType=Db;lg.valueFormat=dc;lg.filterType=xc;lg.startRow=Rc;lg.startCol=fd;lg.rowCount=ld;lg.colCount=Dd;lg.currentSheetName=jg;return Og.g(og,"DdaGetBindingData",lg,cf,Bf,
Bg,Pe,0)},Pe,567,16)}ddaSetBindingData(K,Ia,Db,dc,xc,Rc,fd){this.TJ((ld,Dd,Rd)=>{var Pe=this.$.pa.va,cf=this.$ja();ld=Ra.b(ld,Rc);Dd=Ra.a(Dd,this.nI);const Bf=Pe.Oa(9);Bf.controlId=K;Bf.bindingId=Ia;Bf.startRow=Db;Bf.startCol=dc;Bf.currentSheetName=cf;Bf.bindingData=xc;return Og.g(Pe,"DdaSetBindingData",Bf,ld,Dd,Rd,fd,0)},fd,568)}ddaGetSelectedData(K,Ia,Db,dc,xc,Rc,fd){this.TJ((ld,Dd,Rd)=>{var Pe=this.$.pa.va,cf=this.$ja();ld=Ra.b(ld,Rc);Dd=Ra.a(Dd,this.nI);const Bf=Pe.Oa(1);Bf.controlId=K;Bf.coerceType=
Ia;Bf.valueFormat=Db;Bf.filterType=dc;Bf.currentSheetName=cf;Bf.formula=xc;return Og.g(Pe,"DdaGetSelectedData",Bf,ld,Dd,Rd,fd,0)},fd,569,16)}ddaSetSelectedData(K,Ia,Db,dc,xc){this.TJ((Rc,fd,ld)=>{var Dd=this.$.pa.va,Rd=this.$ja();Rc=Ra.b(Rc,dc);fd=Ra.a(fd,this.nI);const Pe=Dd.Oa(9);Pe.controlId=K;Pe.currentSheetName=Rd;Pe.formula=Ia;Pe.bindingData=Db;return Og.g(Dd,"DdaSetSelectedData",Pe,Rc,fd,ld,xc,0)},xc,570)}ddaLoadSettings(K,Ia,Db){this.TJ((dc,xc,Rc)=>{var fd=this.$.pa.va;dc=Ra.b(dc,Ia);xc=Ra.a(xc,
this.nI);const ld=fd.Oa(1);ld.controlId=K;return Og.g(fd,"DdaLoadSettings",ld,dc,xc,Rc,Db,0)},Db,501,16)}ddaSaveSettings(K,Ia,Db,dc,xc){this.TJ((Rc,fd,ld)=>{var Dd=this.$.pa.va;Rc=Ra.b(Rc,dc);fd=Ra.a(fd,this.nI);const Rd=Dd.Oa(9);Rd.controlId=K;Rd.settings=Ia;Rd.overwriteIfStale=Db;return Og.g(Dd,"DdaSaveSettings",Rd,Rc,fd,ld,xc,0)},xc,571)}ddaAddRowsColumns(K,Ia,Db,dc,xc,Rc){this.TJ((fd,ld,Dd)=>{var Rd=this.$.pa.va,Pe=this.$ja();fd=Ra.b(fd,xc);ld=Ra.a(ld,this.nI);const cf=Rd.Oa(9);cf.controlId=K;
cf.bindingId=Ia;cf.isRow=Db;cf.currentSheetName=Pe;cf.bindingData=dc;return Og.g(Rd,"DdaAddRowsColumns",cf,fd,ld,Dd,Rc,0)},Rc,572)}ddaDeleteAllDataValues(K,Ia,Db,dc){this.TJ((xc,Rc,fd)=>{var ld=this.$.pa.va,Dd=this.$ja();xc=Ra.b(xc,Db);Rc=Ra.a(Rc,this.nI);const Rd=ld.Oa(9);Rd.controlId=K;Rd.bindingId=Ia;Rd.currentSheetName=Dd;return Og.g(ld,"DdaDeleteAllDataValues",Rd,xc,Rc,fd,dc,0)},dc,573)}ddaClearBindingFormats(K,Ia,Db,dc){this.TJ((xc,Rc,fd)=>{var ld=this.$.pa.va,Dd=this.$ja();xc=Ra.b(xc,Db);Rc=
Ra.a(Rc,this.nI);const Rd=ld.Oa(9);Rd.controlId=K;Rd.bindingId=Ia;Rd.currentSheetName=Dd;return Og.g(ld,"DdaClearBindingFormats",Rd,xc,Rc,fd,dc,0)},dc,574)}ddaSetBindingFormats(K,Ia,Db,dc,xc,Rc){this.TJ((fd,ld,Dd)=>{var Rd=this.$.pa.va,Pe=this.$ja();fd=Ra.b(fd,xc);ld=Ra.a(ld,this.nI);const cf=Rd.Oa(9);cf.controlId=K;cf.bindingId=Ia;cf.currentSheetName=Pe;cf.bindingData=Db;cf.isSetFormats=dc;return Og.g(Rd,"DdaSetBindingFormats",cf,fd,ld,Dd,Rc,0)},Rc,575)}parseRange(K,Ia,Db){this.TJ((dc,xc,Rc)=>{const fd=
this.$.pa.va.$b();return Og.v(this.$.pa.va,K,-1,Ra.b(dc,Ia),Ra.a(xc,this.nI),Rc,Db,fd)},Db,162,16)}parseRangeForGoto(K,Ia,Db,dc){this.TJ((xc,Rc,fd)=>{const ld=this.$.pa.va.$b();return Og.w(this.$.pa.va,K,Ia,Ra.b(xc,Db),Ra.a(Rc,this.nI),fd,dc,ld)},dc,562,16)}executeRichApiRequest(K,Ia,Db){A.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(K.RequestFlags&=8191);if(A.EwaSettings.xa(233))this.SHh(this.$.pa.va.$b(),Ia,()=>{this.nQ.UKa(Af.a.internalError,Db)},Db,K);
else{let dc=rg.DdaFacade.sjd(K);!A.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.pb.Gw||dc&16?(dc|=64,this.$.userOperationManager.bF(new qj(this.$,K,(xc,Rc,fd)=>mj(this.$.pa.va,K,Ra.b(xc,Ia),Ra.a(Rc,this.nI),fd,Db),dc))):(this.nQ.UKa(Af.a.ZGc,Db),n.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}$ja(){return this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.activeItemName}TJ(K,Ia,Db,dc=0){!A.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.pb.Gw||dc&16?this.$.userOperationManager.bF(new Qh.a(Db,0,K,dc|64)):(this.nQ.UKa(Af.a.ZGc,Ia),n.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}SHh(K,Ia,Db,dc,xc){let Rc=rg.DdaFacade.sjd(xc);if(!A.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.pb.Gw||Rc&16){var fd=this.$.Mb.Kc("UserAction","Rich Api request");this.$.userOperationManager.Oc(new pj(this.$,K,Ia,Db,dc,fd,xc,Rc|64),null)}else this.nQ.UKa(Af.a.ZGc,dc),n.ULS.sendTraceTag(537163158,
0,50,"Write operation is not allowed")}}Object(d.a)(ej,"DdaWebServiceHelper",null,[]);class fj{constructor(K,Ia,Db,dc){this.zJh=K;this.fileSize=Ia;this.yQj=dc}}Object(d.a)(fj,"DocumentFile",null,[]);class Jh{}Jh.generalException="GeneralException";Jh.FUg="ApiNotFound";Jh.BGd="OperationCancelled";Jh.invalidArgument="InvalidArgument";Object(d.a)(Jh,"ErrorCodes",null,[]);class gj{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(d.a)(gj,"WacApiDelegates",null,[]);var Ej=a(624);class Zi extends gj{constructor(K,Ia){super();this.Fof=(Db,dc)=>{Db=Zi.Vch(Db,dc);if(!Ej.a(this.$,Db))return!0;Db=this.$.shortcutKeyManager.E9e(Db);return!!Db&&0<Db.length};this.addinId=K;this.$=Ia}replaceShortcuts(K){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,K,this.Fof)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(K){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(K,
this.Fof)}static zhh(K,Ia){const Db=document.createEvent("KeyboardEvent");if(Xf.a.xF)Db.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(K&8),!!(K&32),!!(K&4),!!(K&256));else{const dc=[];K&4&&dc.push("Shift");K&8&&dc.push("Control");K&32&&dc.push("Alt");Db.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,dc.join(" "),!1,"en-US")}K=new Sys.UI.DomEvent(Db);K.keyCode=Ia;return K}static Vch(K,Ia){if(Xf.a.Ff)switch(Ia){case 189:Ia=173;break;case 187:Ia=61;break;case 186:Ia=59}return Zi.zhh(K,
Ia)}}Object(d.a)(Zi,"ExcelWacApiDelegates",gj,[]);class Eh{constructor(K){this.HJa={};this.NLi=K}ULg(K,Ia){this.Ofc(K)||(this.HJa[K]={});if(this.msi(K))return n.ULS.sendTraceTag(537163157,344,50,`App ${K} has reach the limit of number of cached files.`),Af.a.wMi;this.HJa[K][Ia.zJh.toString()]=Ia;return Af.a.success}HXh(K,Ia){let Db=null;this.Ofc(K)&&(Db=this.HJa[K][Ia.toString()]);Db||n.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${K}, fileHandler:${Ia}] doesn't exist`);return Db}Ofc(K){return K in
this.HJa}Tlj(K,Ia){if(this.Ofc(K)){const Db=this.HJa[K];delete Db[Ia.toString()];1>Object.keys(Db).length&&delete this.HJa[K];return Ia.toString()in Db?Af.a.internalError:Af.a.success}return Af.a.internalError}msi(K){return this.Ofc(K)?Object.keys(this.HJa[K]).length>=this.NLi:!1}static getInstance(K){return K.da.Ba(200)||K.da.Ha(200,new Eh(Eh.OLi))}static DPi(){return++Eh.p3g}}Eh.nLi=4194304;Eh.OLi=1;Eh.p3g=0;Object(d.a)(Eh,"GetFileApiHelper",null,[]);class rj{constructor(K){this.Oy=K}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.Oy)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){switch(K){case 1:return this.iQi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}iQi(){this.notifyActionHandlerReady();return null}}Object(d.a)(rj,"AddinInternalService",null,[]);class sj{constructor(K,Ia){this.BG=Ia;this.Oy=K}getAppRuntimeState(){return this.BG.getAppRuntimeState(this.Oy)?2:1}setAppRuntimeState(K){switch(K){case 2:K=!0;break;case 1:K=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.invalidArgument,Vf.a.ga(1769));}this.BG.setAppRuntimeState(this.Oy,K)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K,Ia){switch(K){case 2:return this.ISh();case 1:return this.RBj(Ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,
Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}ISh(){return this.getAppRuntimeState()}RBj(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"int");this.setAppRuntimeState(K);return null}}Object(d.a)(sj,"AppRuntimeService",null,[]);var hj=a(996);class tj{constructor(K,Ia,Db,dc){this.sx=K;this.y1=Db;this.Ky=dc.Lg.getOsfControl(Ia)}disable(){try{if(!Vf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.YIe();
if(!this.dof())return this.ZIe();this.y1.y2j(this.sx)}catch(K){return n.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",K.message||"Unknown"),this.WIe()}return null}enable(){try{if(!Vf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.YIe();if(!this.dof())return this.ZIe();this.y1.Pjj(this.sx)}catch(K){return n.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
K.message||"Unknown"),this.WIe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){switch(K){case 1:return this.vDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 3:return this.zqh();case 2:return this.qvh()}K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}zqh(){return this.disable()}qvh(){return this.enable()}vDa(){this._OnAccess();return null}YIe(){return hj.a(Ef.a.notImplemented,
Vf.a.ga(1770))}ZIe(){return hj.a(Ef.a.sharedRuntimeNotAvailable,Vf.a.ga(1774))}WIe(){return hj.a(Ef.a.generalException,Vf.a.ga(1765))}dof(){const K=this.Ky.getSharedRuntimeId();return!!K&&0<K.length}}Object(d.a)(tj,"BeforeDocumentCloseNotification",null,[]);class uj{constructor(){this.vme=this.Cge=this.lA=!1}get enabled(){return this.lA}set enabled(K){this.lA=K}get nativeRuntime(){return this.Cge}set nativeRuntime(K){this.Cge=K}get streamingEnabled(){return this.vme}set streamingEnabled(K){this.vme=
K}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(K){switch(K){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Ia){switch(K){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Ia){K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(d.a)(uj,"CustomFunctionEngineStatus",null,[]);class vj{constructor(K,Ia,Db){this.MBg=K;this.NBg=Ia;this.FFg=Db}get status(){const K=new uj;K.enabled=this.MBg;K.streamingEnabled=this.NBg;K.nativeRuntime=!1;return K}register(K){return OfficeExtension.WacRuntime.Utility.createPromise(this.FFg(K))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(K){switch(K){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 1:return this.Gkj(Ia)}K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Gkj(K){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"string");return this.register(Ia,K)}}Object(d.a)(vj,"CustomFunctionManager",null,[]);var Fj=a(969);class wj{constructor(K,Ia,Db,dc){this.o7d="";this.KUb=0;this.cP=K;this._id=Ia;this.Oy=Db;this.BG=dc}get id(){return this._id}_RegisterStateChange(){this.KUb||this.cP.execute(K=>
{this.o7d=K.FAa(this._id,Ia=>{this.BG.FLh(this.Oy,this._id,JSON.stringify(Ia))})});this.KUb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.KUb--;this.KUb||this.cP.execute(K=>{K.LMd(this._id,this.o7d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(K){switch(K){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 6:return this.ivg();case 7:return this.kvg()}K=
this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}ivg(){return this._RegisterStateChange()}kvg(){return this._UnregisterStateChange()}}Object(d.a)(wj,"LicenseFeature",null,[]);class xj{constructor(K,Ia){this.cP=Of.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.Oy=K;this.BG=Ia;this.yEg=this.BG.Lg.getOsfControl(this.Oy)}getFeatureTier(K,Ia){return OfficeExtension.WacRuntime.Utility.createPromise(Db=>{const dc=1===Ia?1:2===
Ia?2:0;this.cP.execute(xc=>{xc.getFeatureTier(K,dc).then(Rc=>{Db(this.a1h(Rc))},()=>{Db(Ia)})})})}getLicenseFeature(K){K=new wj(this.cP,K,this.Oy,this.BG);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}isFeatureEnabled(K,Ia){return OfficeExtension.WacRuntime.Utility.createPromise(Db=>{this.cP.execute(dc=>{dc.isFeatureEnabled(K,Ia).then(xc=>{Db(xc)},()=>{Db(Ia)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(K=>{this.cP.execute(Ia=>{Ia=
Ia.isFreemiumUpsellEnabled();K(Ia)})})}launchUpsellExperience(K){if(this.yEg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.cP.execute(Ia=>{Ia.launchUpsellExperience(K)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.OWc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K,Ia){switch(K){case 6:return this.jvg(Ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 2:return this.BYh(Ia);case 5:return this.$0h(Ia);
case 1:return this.Zsi(Ia);case 3:return this.Hti();case 4:return this.IDi(Ia)}K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}BYh(K){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"int");return this.getFeatureTier(Ia,K)}$0h(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.getLicenseFeature(K)}Zsi(K){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,
0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"boolean");return this.isFeatureEnabled(Ia,K)}Hti(){return this.isFreemiumUpsellEnabled()}IDi(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.launchUpsellExperience(K)}jvg(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");this._TestFireStateChangedEvent(K);return null}a1h(K){switch(K){case 1:return 1;case 2:return 2;default:return 0}}}Object(d.a)(xj,"License",
null,[]);var Gj=a(165);const Hj=(K,Ia,Db)=>dc=>(xc,Rc)=>{Ne.TaskExtensions.za(yf.GetServiceTaskFactory.create(Ia.da,279,Ia.ka,1),fd=>{fd=fd.result;let ld=!1;var Dd=Db.Lg.getOsfControl(K);let Rd=null;Dd&&(Rd=Dd.getStoreType(),(Dd=Dd.getManifest())&&Dd.getSharedRuntimeForCustomFunctions("Workbook")&&(ld=!0));Ne.TaskExtensions.za(fd.Bhf(K,Rd,dc,ld),Pe=>{Gj.b(Pe)?Pe.result?xc(null):Rc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.invalidArgument,Ca.a.instance.ga(1769))):Rc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.generalException,
Ca.a.instance.ga(1765)))},Ia.ka,3)},Ia.ka,3)};class yj{constructor(K){if(!K)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Mzd=K}areShortcutsInUse(K){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,Db)=>{this.Mzd.checkShortcutsInUse(K).then(dc=>{Ia(dc)}).catch(dc=>{Db(dc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((K,Ia)=>{this.Mzd.getShortcuts().then(Db=>{K(Db)}).catch(Db=>{Ia(Db)})})}replaceShortcuts(K){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,
Db)=>{this.Mzd.replaceShortcuts(K).then(()=>{Ia(null)}).catch(dc=>{Db(dc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Ia){switch(K){case 3:return this.wWg(Ia);case 1:return this.y7h();case 2:return this.nrj(Ia)}K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}wWg(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"Array<string>");return this.areShortcutsInUse(K)}y7h(){return this.getShortcuts()}nrj(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"any");return this.replaceShortcuts(K)}}Object(d.a)(yj,"ActionService",
null,[]);var Ij=a(781),zj=a(524);class ui{constructor(K,Ia,Db){this.yRc=this.Hae=null;this.HTb=K;this.Phe=Ia;if(this.fb=Db)this.Hae=this.fb.Wa("GetAccessTokenOAuthFirstPartyAllowList")}R2h(){this.yRc||(this.yRc=zj.a.gq(Of.a.instance.Tb("Common.App.OAuth.IOAuthManager")));return this.yRc}Rti(K,Ia){if(!this.Phe||""===this.HTb||!this.fb)return!1;const Db=this.Phe.getOsfControl(this.HTb);if(!Db)return!1;let dc=!1;this.Hae.split(";").forEach(xc=>{Ia===xc&&(dc=!0)});return this.fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",
!1)&&1===Fd.AFrameworkApplication.sa.Qa.ri&&Db.isFirstParty()&&K===ui.dUg&&dc&&Zh.d(Db.getSolutionId())===ui.fUg}getAccessTokenFirstPartyOAuth(K,Ia){let Db;Db=this.Rti(K,Ia)?dc=>{const xc=this.R2h();xc.continueWith(()=>{xc.result.tL(K,Ia).then(Rc=>{dc(Rc);return Rc})})}:dc=>{dc(Object.assign(new Ij.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(Db)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Ia){switch(K){case 1:return this.yRh(Ia)}K=this.invokeMethod(K,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}yRh(K){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"string");return this.getAccessTokenFirstPartyOAuth(Ia,K)}}ui.dUg="Maker";ui.fUg="fa000000043";Object(d.a)(ui,"Auth",null,[]);class Aj{constructor(){this.bsa=null}k7h(){this.bsa||(this.bsa=zj.a.gq(Of.a.instance.Tb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.bsa}getSharedFilePickerResponse(K){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,
Db)=>{try{const dc=this.k7h();tg.Task.WAA.call(null,dc).continueWith(()=>{const xc=dc.result;if(xc){let Rc={};({ot:Rc}=ng.d(K)).returnValue?xc.Phd(Rc).then(fd=>{fd&&0<fd.length?Ia(fd):Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(fd=>{Db(fd)}):Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(dc){Db(dc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Ia){this.invokePropertySet(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Ia){switch(K){case 1:return this.j7h(Ia)}K=this.invokeMethod(K,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}j7h(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.getSharedFilePickerResponse(K)}}Object(d.a)(Aj,"SharedFilePicker",null,[]);class Bj{createInstance(K,Ia,Db="",dc=null,xc=null){switch(K){case "Microsoft.Office.ActionService":return new yj(Ia);case "Microsoft.Office.SharedFilePicker":return new Aj;case "Microsoft.Office.Auth":return new ui(Db,
dc,xc)}return null}}Object(d.a)(Bj,"WacApiHost",null,[]);class Cj{constructor(K,Ia,Db,dc,xc){this.g_b=null;this.SSb=K;this.Oy=Ia;this.BG=Db;this.mb=dc;this.poe=xc}hostName(){return"ExcelOnline"}appId(){return this.SSb}createInstance(K){switch(K){case "Microsoft.Authentication.AuthenticationService":return Of.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.Oy,this.BG.Lg);case "Microsoft.Authentication.TokenParameters":return new sg;case "Microsoft.ExcelServices.CustomFunctionManager":K=
A.EwaSettings.xa(114);var Ia=A.EwaSettings.xa(115);return new vj(K,Ia,Hj(this.SSb,this.mb,this.BG));case "Microsoft.AppRuntime.AppRuntimeService":return new sj(this.Oy,this.BG);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return K=oh.a(this.mb),new tj(this.SSb,this.Oy,K,this.BG);case "Microsoft.DynamicRibbon.DynamicRibbon":return K=oh.a(this.mb),new Fj.DynamicRibbon(this.SSb,this.Oy,this.BG,K,K.tn(this.Oy).xl);case "Microsoft.Office.Licensing.License":return new xj(this.Oy,
this.BG);case "Microsoft.InternalService.AddinInternalService":return new rj(this.Oy);default:if(this.g_b||(this.g_b=new Bj),Fd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)){if(Ia=this.g_b.createInstance(K,this.poe,this.Oy,this.BG.Lg,Fd.AFrameworkApplication.fa))return Ia}else if(Ia=this.g_b.createInstance(K,this.poe))return Ia}n.ULS.sendTraceTag(537163155,0,10,`Typename: ${K} is an invalid parameter for the RichApiHost.CreateInstance method.`);
throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ef.a.generalException,Ef.a.generalException);}}Object(d.a)(Cj,"RichApiHost",null,[]);var Jj=a(390),Dj=a(28),Kj=a(125),ij=a(36),Lj=a(104),Mj=a(293),Nj=a(46),Oj=a(259),Pj=a(6),Qj=a(74);class Lf{constructor(K,Ia,Db,dc){this.htmlSanitizationHelper=this.rangePicker=null;this.$=K;this.Fd=Ia;this.htmlSanitizationHelper=dc;this.Ie=new lj(K.ea);this.dA=new ej(K,this.Ie);this.Fzf=Db;this.Kac=new Map}get nQ(){return this.Ie}dispose(){this.$=this.Kac=
null}Mc(){return!1}Rc(){return!1}executeCommand(K,Ia,Db){K=Ia.command;switch(K){case 451041795:this.Ie.Cf(Db[Ve.a.Sf],Db[Ve.a.w3]);break;case 974713501:this.gdi(Db[Ve.a.Sf],Db[Ve.a.w3]);break;case 1237877382:this.Ie.uv(Db[Ve.a.w3]);break;default:return Cf.a(K)}return tg.Task.Ta(!0)}Ac(K,Ia,Db){if(K=!!Db)switch(Ia.command){case 974713501:case 1237877382:case 451041795:break;default:K=!1}return K}gdi(K,Ia){var Db;const dc=K.DdaMethod;"undefined"===typeof dc.DispatchId?this.Ie.Cf(Af.a.internalError,
Ia):Lf.csi(K)||this.$.Bd&1?(dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new kj(this.$,this,K,Ia,this.htmlSanitizationHelper)).start(this.Fd,K.DdaMethod.ControlId):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.K6h(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.yGj(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(K,this.hhd(K.DdaMethod.ControlId),0,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?
this.nTh(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.bCj(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.mTh(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Slj(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.mSh(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.Hxd(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(K,Ia):dc.DispatchId===
OSF.DDA.MethodDispId.dispidAddRowsMethod?(K.DdaAddRowsColumns.IsRow=!0,this.mre(K,Ia)):dc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(K.DdaAddRowsColumns.IsRow=!1,this.mre(K,Ia)):dc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.loh(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.d8g(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(K.DdaSetBindingFormats.IsSetFormats=!0,this.x6f(K,Ia)):dc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?
(K.DdaSetBindingFormats.IsSetFormats=!1,this.x6f(K,Ia)):dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(K,K.DdaBindingsMethod.ItemName,K.DdaBindingsMethod.FailOnCollision?2:1,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.FYh(Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.DBd(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?
this.EXh(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.FXh(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Ulj(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(K.DdaMethod.ControlId,K),this.Ie.uv(Ia)):dc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?A.EwaSettings.xa(23)?this.Ie.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Ia):this.UMi(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?A.EwaSettings.xa(23)?this.Ie.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ia):this.PMi(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(K,Ia):dc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(K,Ia):this.Ie.Cf(Af.a.FGd,Ia),A.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&dc.DispatchId!==
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(K=this.Fd.QU(K.DdaMethod.ControlId),Ia="",K&&(Ia=rg.DdaFacade.getSolutionId(K,this.$),Ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia,K.OwnerAddinStoreType||K.PrimaryMarketplace.MarketplaceType,null===(Db=K.AssetMarketplace)||void 0===Db?void 0:Db.SolutionId,null,null,K.PrimaryMarketplace.MarketplaceRef)),n.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${dc.DispatchId}, AppID: ${Ia}`))):this.Ie.Cf(Af.a.jPe,Ia)}nTh(K,Ia){K.DdaGetBindingData.CoerceType=
Lf.p5b(K.DdaGetBindingData.CoerceType);K.DdaGetBindingData.FilterType=Lf.tZe(K.DdaGetBindingData.FilterType);K.DdaGetBindingData.ValueFormat=Lf.epg(K.DdaGetBindingData.ValueFormat);if(this.qlc(K.DdaGetBindingData.CoerceType,Ia)){if(K.DdaGetBindingData){const Db=K.DdaGetBindingData;0===Db.FilterType&&(Db.FilterType=2);Db.StartCol|=0;Db.StartRow|=0;Db.ColCount=void 0===Db.ColCount?-1:Db.ColCount;Db.RowCount=void 0===Db.RowCount?-1:Db.RowCount}this.dA.ddaGetBindingData(K.DdaMethod.ControlId,K.DdaGetBindingData.BindingId,
K.DdaGetBindingData.CoerceType,K.DdaGetBindingData.ValueFormat,K.DdaGetBindingData.FilterType,K.DdaGetBindingData.StartRow,K.DdaGetBindingData.StartCol,K.DdaGetBindingData.RowCount,K.DdaGetBindingData.ColCount,Db=>{if(gh.a(Db)||!Db.Result)this.Ie.sH(Db,Ia);else{const dc=this.Ie.$P();dc.Data=Lf.Wze(Db.Result);Ia(dc)}},Ia)}}bCj(K,Ia){K.DdaSetBindingData.CoerceType=Lf.p5b(K.DdaSetBindingData.CoerceType);if(this.qlc(K.DdaSetBindingData.CoerceType,Ia)){var Db=Lf.t1c(K.DdaSetBindingData.CoerceType,K.DdaSetBindingData.Data);
Lf.lic(Db)?this.Ie.Cf(Af.a.FEc,Ia):(1===Db.CoerceType&&(Db.CellFormat||(Db.CellFormat=K.DdaSetBindingData.CellFormat),Db.TableOptions||(Db.TableOptions=K.DdaSetBindingData.TableOptions)),K.DdaSetBindingData&&(K.DdaSetBindingData.StartCol|=0,K.DdaSetBindingData.StartRow|=0),this.dA.ddaSetBindingData(K.DdaMethod.ControlId,K.DdaSetBindingData.BindingId,K.DdaSetBindingData.StartRow,K.DdaSetBindingData.StartCol,Db,dc=>{gh.a(dc)?this.Ie.sH(dc,Ia):this.Ie.uv(Ia)},Ia))}}K6h(K,Ia){K.DdaGetBindingData.CoerceType=
Lf.p5b(K.DdaGetBindingData.CoerceType);K.DdaGetBindingData.ValueFormat=Lf.epg(K.DdaGetBindingData.ValueFormat);K.DdaGetBindingData.FilterType=Lf.tZe(K.DdaGetBindingData.FilterType);if(this.qlc(K.DdaGetBindingData.CoerceType,Ia)){var Db=this.hhd(K.DdaMethod.ControlId);Db?this.dA.ddaGetSelectedData(K.DdaMethod.ControlId,K.DdaGetBindingData.CoerceType,K.DdaGetBindingData.ValueFormat,K.DdaGetBindingData.FilterType,Db,dc=>{if(gh.a(dc))this.Ie.sH(dc,Ia);else{const xc=this.Ie.$P();xc.Data=Lf.Wze(dc.Result);
Ia(xc)}},Ia):this.Ie.Cf(Af.a.m9e,Ia)}}EXh(K,Ia){const Db=K[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],dc=K[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],xc=K.DdaMethod.ControlId,Rc=Eh.getInstance(this.$);if(0>=dc)n.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Ie.Cf(Af.a.zoi,Ia);else if(dc>Eh.nLi)n.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Ie.Cf(Af.a.e4e,Ia);else{var fd=
null;switch(Db){case 1:fd="Compressed";break;case 0:fd="Text";break;case 2:fd="Pdf";break;default:n.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Db} is not supported.`);this.Ie.Cf(Af.a.fZe,Ia);return}if("Text"===fd)n.ULS.sendTraceTag(537163218,344,15,`Requested file type ${fd} is not supported.`),this.Ie.Cf(Af.a.fZe,Ia);else{A.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(K=new Sys.StringBuilder,K.append(Sg.a(this.$,fd)),"Pdf"===fd&&sh.a.Qk(K,
ie.a.PSf,"WholeWorkbook"),K=K.toString()):K=Sg.a(this.$,fd);var ld=null,Dd=new XMLHttpRequest;Dd.onreadystatechange=()=>{if(4===Dd.readyState)if(200===Dd.status){var Rd=Dd.response;if(Rd){ld=new Uint8Array(Rd);Rd=this.Ie.$P();var Pe=ld.length,cf=Eh.DPi(),Bf={},Bg=0;for(let og=0;og<Pe;og+=dc){const jg=[],lg=og+dc<Pe?og+dc:Pe;for(let zg=0,Xg=og;Xg<lg;zg++,Xg++)jg[zg]=ld[Xg];Bf[(Bg++).toString()]=jg}Bf=new fj(cf,Pe,dc,Bf);Bf=Rc.ULg(xc,Bf);Bf!==Af.a.success?this.Ie.Cf(Bf,Ia):(Rd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=
cf,Rd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Pe,n.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${fd}, the file size is ${Pe}`),Ia(Rd))}else n.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${fd}.`),this.Ie.Cf(Af.a.internalError,Ia)}else 500===Dd.status?this.Ie.Cf(Af.a.Q0e(parseInt(Dd.statusText,10)),Ia):(n.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${fd}.`),
this.Ie.Cf(Af.a.lPi,Ia))};Dd.open("GET",K,!0);Dd.responseType="arraybuffer";Dd.setRequestHeader("If-Modified-Since","0");Dd.send(null)}}}FXh(K,Ia){var Db=K[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],dc=K[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];K=K.DdaMethod.ControlId;(Db=Eh.getInstance(this.$).HXh(K,Db))?(Db=Db.yQj,0>dc||dc>=Object.keys(Db).length?this.Ie.Cf(Af.a.fji,Ia):(dc=Db[dc.toString()],Db=this.Ie.$P(),Db[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=
dc,Db[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=dc.length,Ia(Db))):this.Ie.Cf(Af.a.internalError,Ia)}Ulj(K,Ia){var Db=K[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];K=K.DdaMethod.ControlId;Db=Eh.getInstance(this.$).Tlj(K,Db);Db===Af.a.success?this.Ie.uv(Ia):this.Ie.Cf(Db,Ia)}yGj(K,Ia){K.DdaSetBindingData.CoerceType=Lf.p5b(K.DdaSetBindingData.CoerceType);if(this.qlc(K.DdaSetBindingData.CoerceType,Ia)){var Db=this.hhd(K.DdaMethod.ControlId);if(Db){var dc=Lf.t1c(K.DdaSetBindingData.CoerceType,
K.DdaSetBindingData.Data),xc=If.h(this.$).ha;1===dc.CoerceType&&(!dc.Data&&xc.ra.u5&&(dc.Headers||(dc.Headers=[]),dc.Headers.length||dc.Headers.push([]),dc.Headers[0].length||dc.Headers[0].push("")),Lf.lic(dc)||(dc.CellFormat||(dc.CellFormat=K.DdaSetBindingData.CellFormat),dc.TableOptions||(dc.TableOptions=K.DdaSetBindingData.TableOptions)));if(Lf.lic(dc))this.Ie.Cf(Af.a.FEc,Ia);else{var Rc=xc.ra.xd.clone(),fd=xc.ra.activeCell.clone();this.dA.ddaSetSelectedData(K.DdaMethod.ControlId,Db,dc,ld=>{var Dd;
if(gh.a(ld))this.Ie.sH(ld,Ia);else{ld=Rc.clone();const Rd=dc.Headers?dc.Headers[0].length:dc.Data[0].length;1!==dc.CoerceType||dc.Data?1===dc.CoerceType&&(null===(Dd=dc.TableOptions)||void 0===Dd?0:Dd.length)&&0==dc.TableOptions[0]?(ld.top+=1,ld.bottom=ld.top+dc.Data.length-1):ld.bottom=ld.top+dc.Data.length-(1===dc.CoerceType?0:1):ld.bottom=ld.top+1;ld.right=ld.left+Rd-1;Dd=ld.contains(fd)?fd:ld.topLeft;xc.updateSelection(ld,Dd,0);this.Ie.uv(Ia)}},Ia)}}else this.Ie.Cf(Af.a.ACe,Ia)}}addBinding(K,
Ia,Db,dc){Ia?this.dA.ddaAddBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,K.DdaBindingsMethod.BindingType,Ia,Db,xc=>{if(gh.a(xc))this.Ie.sH(xc,dc);else{const Rc=this.Ie.$P();Rc.Bindings=Array(1);Rc.Bindings[0]=this.Fd.R2b(xc.Result);dc(Rc)}},dc):this.Ie.Cf(Af.a.xzj,dc)}mTh(K,Ia){this.dA.ddaGetBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,Db=>{if(gh.a(Db)||!Db.Result)this.Ie.sH(Db,Ia);else{const dc=this.Ie.$P();dc.Bindings=Array(1);dc.Bindings[0]=this.Fd.R2b(Db.Result);Ia(dc)}},
Ia)}FYh(K){const Ia=this.Ie.$P(),Db={};Db[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ia[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Db;K(Ia)}Slj(K,Ia){this.dA.ddaReleaseBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,Db=>{gh.a(Db)?this.Ie.sH(Db,Ia):this.Ie.uv(Ia)},Ia)}mSh(K,Ia){this.dA.ddaGetAllBindings(K.DdaMethod.ControlId,Db=>{if(gh.a(Db))this.Ie.sH(Db,Ia);else{const dc=this.Ie.$P();if(Db.Result){Db=Db.Result;dc.Bindings=
Array(Db.length);for(let xc=0;xc<Db.length;xc++)dc.Bindings[xc]=this.Fd.R2b(Db[xc])}else dc.Bindings=null;Ia(dc)}},Ia)}Hxd(K,Ia){this.dA.ddaLoadSettings(K.DdaMethod.ControlId,Db=>{if(gh.a(Db))this.Ie.sH(Db,Ia);else{const dc=this.Ie.$P();dc.Properties=Db.Result;Ia(dc)}},Ia)}saveSettings(K,Ia){const Db={Settings:[]};for(let dc=0;dc<K.DdaSettingsMethod.Properties.length;dc++){const xc={};xc.Name=K.DdaSettingsMethod.Properties[dc][0];xc.Value=K.DdaSettingsMethod.Properties[dc][1];Db.Settings[dc]=xc}this.dA.ddaSaveSettings(K.DdaMethod.ControlId,
Db,K.DdaSettingsMethod.OverwriteIfStale,dc=>{gh.a(dc)?this.Ie.sH(dc,Ia):this.Ie.uv(Ia)},Ia)}mre(K,Ia){const Db=Lf.t1c(1,K.DdaAddRowsColumns.Data);Lf.lic(Db)?this.Ie.Cf(Af.a.FEc,Ia):this.dA.ddaAddRowsColumns(K.DdaMethod.ControlId,K.DdaAddRowsColumns.BindingId,K.DdaAddRowsColumns.IsRow,Db,dc=>{gh.a(dc)?this.Ie.sH(dc,Ia):this.Ie.uv(Ia)},Ia)}loh(K,Ia){this.dA.ddaDeleteAllDataValues(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,Db=>{gh.a(Db)?this.Ie.sH(Db,Ia):this.Ie.uv(Ia)},Ia)}d8g(K,Ia){this.dA.ddaClearBindingFormats(K.DdaMethod.ControlId,
K.DdaClearBindingFormats.BindingId,Db=>{gh.a(Db)?this.Ie.sH(Db,Ia):this.Ie.uv(Ia)},Ia)}x6f(K,Ia){const Db={},dc=K.DdaSetBindingFormats.IsSetFormats;dc?Db.CellFormat=K.DdaSetBindingFormats.CellFormat:Db.TableOptions=K.DdaSetBindingFormats.TableOptions;this.dA.ddaSetBindingFormats(K.DdaMethod.ControlId,K.DdaSetBindingFormats.BindingId,Db,dc,xc=>{gh.a(xc)?this.Ie.sH(xc,Ia):this.Ie.uv(Ia)},Ia)}executeRichApiRequest(K,Ia){var Db;const dc=K.ArrayData,xc={},Rc=If.h(this.$).ha;if(dc){if("WacPartition"===
dc[0]){this.wHh(K,Ia);return}const cf=Object(ea.a)(rg.DdaFacade,oh.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===dc[0]){var fd=cf.tn(K.DdaMethod.ControlId);fd&&(fd.ekc=!0,fd.bSf())}xc.HttpMethod=dc[1];xc.PathAndQuery=dc[2];xc.RequestHeaders=Lf.E5e(dc[3]);xc.RequestBody=dc[4];xc.AppPermission=dc[5];fd=dc[6];xc.RequestFlags=fd;var ld=0;if(Xh.i(this.$.na))switch(Rc.Oe){case 1:ld=2;break;case 2:ld=3;break;case 128:ld=4;break;default:ld=1}var Dd=null;Rc.Sa.IA&&(Dd=Rc.Sa.IA.ej);xc.SheetMultiRange=
zh.r(Rc.ra.selectedRanges,this.$);xc.ActiveCell=zh.v(Rc.ra.activeCell,this.$);xc.ActiveChartId=Dd;xc.SelectionState=ld;ld=this.Fd.QU(K.DdaMethod.ControlId);xc.InstanceId=ld?ld.InstanceId:"";if(ld&&ld.PrimaryMarketplace){let Bf;if(ld.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)Bf=ld.PrimaryMarketplace.SolutionId,Dd=ld.PrimaryMarketplace.MarketplaceType;else{if(!ld.OwnerAddinSolutionId){n.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");
this.Ie.Cf(Af.a.UAb,Ia);return}if(!ld.OwnerAddinStoreType){n.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Ie.Cf(Af.a.UAb,Ia);return}Bf=ld.OwnerAddinSolutionId;Dd=ld.OwnerAddinStoreType}let Bg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Bf,Dd,null===(Db=ld.AssetMarketplace)||void 0===Db?void 0:Db.SolutionId,null,null,ld.PrimaryMarketplace.MarketplaceRef);xc.CompliantSolutionId=Bg;xc.SolutionId=Bf;xc.MarketplaceType=Dd;xc.SolutionVersion=ld.PrimaryMarketplace.SolutionVersion;
xc.StoreLocation=ld.PrimaryMarketplace.MarketplaceRef}else xc.SolutionId=xc.MarketplaceType="",xc.CompliantSolutionId="";xc.IsEventsEnabled=void 0===cf||null===cf||cf.Gh.c2b(xc.InstanceId);xc.RequestGuid=gi.a.create().toString();Db=xc.RequestBody.length;if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Db>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.Ie.Cf(Af.a.Isj,Ia);n.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Db} exceeded the limit`);return}A.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&
fd&4096&&(Db=new fh(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Db,dj,dc),xc.RequestBody=dc[4])}const Rd=Lf.N8e(xc.RequestHeaders);Lf.AHd++;const Pe=Dj.a.Ya.Zb;A.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&xc&&xc.RequestBody&&n.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${xc.RequestBody.length}`);this.dA.executeRichApiRequest(xc,cf=>{var Bf;this.E5f(Pe,!0,cf.ServerCorrelationId);let Bg=null,og=null;var jg=cf.ServerCorrelationId;
if(null===(Bf=null===cf||void 0===cf?void 0:cf.Errors)||void 0===Bf?0:Bf[0])Bg=cf.Errors[0].MessageIdName,og=cf.Errors[0].Description,A.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&Qj.a(this.$).kd.WL(cf.Errors[0].MessageId);if(gh.a(cf)||!cf.Result)this.R9a(jg,Rd,"Server error",Bg,og),this.Ie.sH(cf,Ia);else{let zg=null;if(A.EwaSettings.xa(233))if((Bf=cf.Result)&&Bf.length){for(let Yg=0;Yg<Bf.length;Yg++)if(Bf[Yg].RequestGuid===xc.RequestGuid){zg=Bf[Yg];break}zg||this.Ie.sH(cf,
Ia)}else zg=cf.Result;else zg=cf.Result;if(!Bg&&zg&&zg.ResponseBody&&zg.ResponseBody[0])if(cf=zg.ResponseBody[0],cf.startsWith('{"Error":')){1<zg.ResponseBody.length&&(cf=cf.substring(0,cf.indexOf("}")+1),cf+="}");try{var lg=x.a.Yh(cf);lg.Error&&this.R9a(jg,Rd,"Pipeline error",lg.Error.Code,lg.Error.Message)}catch(Yg){this.R9a(jg,Rd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.R9a(jg,Rd);else this.R9a(jg,Rd,"Server error",Bg,og);const Xg=(jg=zg.SheetMultiRange)?jg.SheetName:
null;lg=zg.ActiveChartId;const Tg=zg.SelectionState;cf=5===Tg&&!!jg||6===Tg||7===Tg||8===Tg;if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.pb.Gw&&cf)this.Ie.Cf(Af.a.ZGc,Ia),n.ULS.sendTraceTag(537163211,0,50,`${Tg.toString()} is not allowed`);else if(5===Tg&&jg){if(this.$.ua&&Xg)if(this.$.ua.Kk(Xg))this.nXc(Xg);else{let Yg=null;Yg=()=>{this.$.ua.Kk(Xg)&&(n.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.nXc(Xg),this.$.ua.SKb(Yg))};
this.$.ua.npb(Yg);if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Rh=null;Rh=()=>{this.$.ua.Kk(Xg)&&(this.nXc(Xg),this.$.ua.Gna(Rh))};this.$.ua.iha(Rh)}}}else if(6===Tg||7===Tg||8===Tg||9===Tg){if(jg){const Yg=zh.g(jg.Ranges);if(Xg&&zh.db(Yg,!0))if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.ua.Kk(Xg)){let Rh=null;Rh=()=>{this.nng(Rc,Yg,Xg,Tg);this.$.ua.Gna(Rh)};this.$.ua.iha(Rh)}else this.nng(Rc,
Yg,Xg,Tg)}7===Tg?(lg="38.{"+Zh.e(lg)+"}",ub.a(this.$).Yna(0,lg,!0)):8===Tg&&ub.a(this.$).Yna(2,lg,!0);9===Tg&&(this.$.ya.ApiCallToSetPageLayout=!0)}zg.PostProcessActions?(jg=x.a.Yh(zg.PostProcessActions),this.Vaj(jg).then(()=>{this.eeb(zg,Ia);this.aed(K.DdaMethod.ControlId,xc);return Promise.resolve(null)},Yg=>{this.eeb(zg,Ia,Yg);return Promise.reject(Yg)})):this.eeb(zg,Ia)}},cf=>{this.E5f(Pe,!1,null);this.R9a(null,Rd,"Web service error");Ia(cf)})}aed(K,Ia){const Db=Object(ea.a)(rg.DdaFacade,oh.a(this.$));
(null===Db||void 0===Db?0:Db.mQd)&&Db.tn(K)&&Lf.xKj(Ia.RequestHeaders)&&(n.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${K}; SolutionId: ${Ia.SolutionId}.`),Db.mQd.zwh(K))}wHh(K,Ia){var Db=this.Fd.QU(K.DdaMethod.ControlId);const dc=rg.DdaFacade.getSolutionId(Db,this.$);var xc=null;xc=rg.DdaFacade.Cva(Db,this.$);xc=new Zi(xc,this.$);xc=new Cj(dc,K.DdaMethod.ControlId,this.Fd,this.$,xc);const Rc={ResponseHeaders:[]};Rc.ResponseBody=
Array(1);Db=Lf.E5e(K.ArrayData[3]);const fd=Lf.N8e(Db);Db=new ti(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.Fzf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(xc,kh,Db,K.ArrayData).then(ld=>{if(!ld)return this.Ayd(!1,"The rich api executor call failed",fd),n.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Rc.ResponseStatusCode=500,this.eeb(Rc,Ia),null;this.Ayd(!0,"The rich api executor call succeeded",fd);Rc.ResponseStatusCode=ld[0];Rc.ResponseBody[0]=ld[2];
this.eeb(Rc,Ia);return null},ld=>{Rc.ResponseStatusCode=400;Rc.ResponseBody[0]=ld.toString();this.Ayd(!1,"The rich api executor call failed",fd);n.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${dc}`);this.eeb(Rc,Ia);return null})}E5f(K,Ia,Db){Lf.AHd--;K=Kj.a(Dj.a.Ya,K);n.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${K}, requests pending:${Lf.AHd}, request result:${Ia?"success":"false"}, server correlationid: ${Db}.`)}eeb(K,Ia,
Db=null){const dc=Array(3);dc[0]=K.ResponseStatusCode;dc[1]=Lf.g8h(K.ResponseHeaders);const xc=[];var Rc=!1;if(Db&&K.ResponseBody){const fd=x.a.Yh(K.ResponseBody.join(""));fd.Error||(Rc={},Rc.Error=Db,Rc.TraceIds=fd.TraceIds,Rc.ProcessedResults={},Rc.ProcessedResults.Results=fd.Results,xc[0]=x.a.Ec(Rc),Rc=!0)}dc[2]=Rc?xc:K.ResponseBody;K=this.Ie.$P();K.Data=dc;Ia(K)}DBd(K,Ia){(new Mi(this.$,this.Ie,this.dA)).DBd(K,Ia)}UMi(K,Ia){n.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Db=
K[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],dc=K[ca.a.tZc],xc=K[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];K=this.$.da.Ba(232).J2a.VMi(K.DdaMethod.ControlId,Db,dc,xc);K===Af.a.success?this.Ie.uv(Ia):(n.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.Ie.Cf(K,Ia))}PMi(K,Ia){n.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Db=K[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],dc=K[ca.a.tZc],xc=K[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];
this.$.da.Ba(232).J2a.rAj(K.DdaMethod.ControlId,Db,dc,xc);this.Ie.uv(Ia)}getAccessToken(K,Ia){n.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Db=(xc,Rc)=>{var fd;if(xc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)xc=this.Ie.$P(),xc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Rc.accessToken,Ia(xc);else{Rc=this.Fd.QU(K.DdaMethod.ControlId);let ld=null!==Rc.OwnerAddinStoreType?Rc.OwnerAddinStoreType:Rc.PrimaryMarketplace.MarketplaceType;n.ULS.sendTraceTag(537163202,
0,10,`${({["errorCode"]:xc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(rg.DdaFacade.getSolutionId(Rc,this.$),ld,null===(fd=Rc.AssetMarketplace)||void 0===fd?void 0:fd.SolutionId,null,null,Rc.PrimaryMarketplace.MarketplaceRef),["storeType"]:ld})}.`);this.Ie.Cf(xc,Ia)}},dc=!A.EwaSettings.xa(23);Ne.TaskExtensions.za(yf.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),xc=>{const Rc=this.Fd.Lg,fd=Yf.getInstance();nh.AppsForOfficeSingleSignOnManager.getInstance(Rc,xc.result,
fd).getAccessToken(K.DdaMethod.ControlId,dc,K,Db)},this.$.ka)}getAuthContext(K,Ia){Ne.TaskExtensions.za(yf.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),()=>{var Db=this.Fd.Lg.getOsfControl(K.DdaMethod.ControlId);if(Db.isFirstParty()){Db=Db.getManifest();var dc=Db.getMarketplaceID(),xc=Db.getWebApplicationId(),Rc=Db.getWebApplicationMsaId();Of.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(dc).then(fd=>{const ld=this.Ie.$P(),Dd={};Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
xc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Rc||xc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=fd.upn;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=fd.userId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=fd.authority;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=$f.a.VSh(fd.authorityType);Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=fd.isAnonymous;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
fd.tenantId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=fd.supportsAuthToken;ld[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Dd;Ia(ld)},fd=>{const ld=this.Ie.$P(),Dd={},Rd=new $f.a;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=xc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Rc||xc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Rd.upn;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Rd.userId;
Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Rd.authority;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Rd.authorityType;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Rd.isAnonymous;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Rd.tenantId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=fd;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Rd.supportsAuthToken;ld[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Dd;ld.Error=1;Ia(ld)})}},this.$.ka)}Pri(K){const Ia=If.h(this.$).ha;return 16===Ia.Oe&&!!Ia.Sa.jc&&!!Ia.Sa.jc.floatingObject&&hf.a.equals(Ia.Sa.jc.floatingObject.id,K,!0)}hhd(K){const Ia=If.h(this.$).ha;return Ia.ra.eh?1===Ia.Oe||this.Pri(K)?Ia.Gia:null:null}qlc(K,Ia){return 1!==K&&2!==K&&3!==K?(this.Ie.Cf(Af.a.RFe,Ia),!1):!0}Ayd(K,Ia,Db){const dc={};dc.a=this.$.ya.UserSessionId;dc.b=K;dc.c=Ia;dc.d=null;dc.e=Db;Bc.b().Ze(37,dc)}R9a(K,Ia,Db=null,dc=null,xc=null){const Rc={};K&&(Rc.ServerCorrelationId=
K);void 0!==Ia&&null!==Ia&&(Rc.Source=Ia);Db&&(Rc.ErrorType=Db);dc&&(Rc.MessageId=dc);xc&&(Rc.StatusDescription=xc);A.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&dc&&"ExternalDataRefreshFailed"===dc&&(Rc.StatusDescription="");n.ULS.sendTraceTag(50688452,0,50,x.a.Ec(Rc))}Vaj(K){let Ia=new Promise(Db=>{Db(null)});for(let Db=0;Db<K.length;Db++)Ia=this.Uaj(Ia,K[Db]);return Ia}Uaj(K,Ia){return Object(Gg.a)(this,void 0,void 0,function*(){if(!Ia)return n.ULS.sendTraceTag(537163201,
0,10,"Null PostProcessAction."),K.then(()=>Promise.reject(Lf.G4a(Jh.generalException,Ca.a.instance.ga(1765),null)));switch(Ia.actionType){case 1:case 2:K=K.then(()=>{const xc=Object(ea.a)(rg.DdaFacade,oh.a(this.$));if(xc.tn(Ia.controlId))switch(xc.Gh.pci(Ia),Ia.messageType){case 14:case 100:xc.lQd.x2b(Ia);break;case 11:case 12:xc.Dvj.Gqb(Ia);break;case 51:case 52:xc.Bvj.Gqb(Ia);break;case 2101:case 2102:xc.Cvj.Gqb(Ia);break;case 2E3:xc.Evj.x2b(Ia);break;case 2201:this.$.Bla&&xc.mQd.qXg(Ia);break;
case 2203:xc.Fvj.rXg(Ia);break;case 2700:A.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&xc.kQd.x2b(Ia);break;case 65541:xc.jQd.pXg(Ia)}else n.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Ia.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:K=K.then(()=>{this.aci(Ia);return Promise.resolve(null)});break;case 15:A.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(K=K.then(()=>{this.Pdi(Ia);return Promise.resolve(null)}));
break;case 4:K=K.then(()=>{if(A.EwaSettings.xa(102)){var xc=If.h(this.$).ha.ra.activeCell;xc.top!==Ia.row+1&&xc.left!==Ia.column+1&&(xc=zh.v(mg.Range.Hc(Ia.row+1,Ia.column+1),this.$),If.h(this.$).sg(xc,null,null,null,3,"DdaMethodHandler.ShowCard"));ei.a(this.$,243,242,0,Rc=>{Rc.mfb(Ia.row+1,Ia.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:K=K.then(()=>{Object(ea.a)(rg.DdaFacade,oh.a(this.$)).Gh.qRe(Ia.controlId,Ia.isEnableEvents);return Promise.resolve(null)});break;case 5:K=K.then(()=>
this.zlh(Ia));break;case 6:K=K.then(()=>this.R6i(Ia));break;case 8:K=K.then(()=>{A.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(ea.a)(rg.DdaFacade,oh.a(this.$)).c8g();const xc=new Oj.a(Pj.a.Pj,5,null);Nj.a(this.$).Br(xc);return Promise.resolve(null)});break;case 9:K=K.then(()=>this.fCj(Ia));break;case 10:K=K.then(()=>this.nbk(Ia));break;case 11:K=K.then(()=>this.mbk());break;case 12:K=K.then(()=>this.jbk());break;case 13:K=K.then(()=>
this.kbk(Ia));break;case 14:K=K.then(()=>this.lbk(Ia));break;case 16:K=K.then(()=>Promise.resolve(Ia));break;case 17:K=K.then(()=>this.wyj(Ia,Object(ea.a)(rg.DdaFacade,oh.a(this.$))));break;case 18:If.h(this.$).focus();break;case 19:this.gbf(Ia.entryType,!1,Ia.options);break;case 20:this.gbf(Ia.entryType,!0,Ia.options);break;case 21:const Db=oh.a(this.$);K=K.then(()=>Db.jQd.Ibi(Ia));break;case 22:const dc=oh.a(this.$);K=K.then(()=>dc.jQd.Jbi(Ia));break;case 23:A.EwaSettings.isChangeGateEnabled("OfficeVSO:7637843_CreateRichApiRangeValuesPreview")&&
Hb.a.GBb(this.$)&&this.Fd.f2f.xei(Ia.worksheetId,Ia.anchorCell,Ia.values,Ia.options);break;case 24:A.EwaSettings.isChangeGateEnabled("OfficeVSO:7637843_CreateRichApiRangeValuesPreview")&&Hb.a.GBb(this.$)&&this.Fd.f2f.Kci(Ia.worksheetId);break;default:K=K.then(()=>Promise.reject(Lf.G4a(Jh.FUg,Ca.a.instance.ga(1766),null)))}return K})}Pdi(K){var Ia=Object(ea.a)(rg.DdaFacade,oh.a(this.$)).tn(K.controlId);if(Ia&&!(0===K.operationType^!Ia.bea)){If.h(this.$).uAb=!0;switch(K.operationType){case 0:var Db=
new Mj.a(document.createElement("input"));Db.text=K.range;Ia.tmi(If.h(this.$).Ng.Wjh(Db,new Jj.a(this.$)));Ia.bea.startEdit(!0);break;case 1:Ia.gYf();this.rangePicker=null;break;case 2:Ia.bea.Gng(K.range);break;case 3:Ia.bea.Gng(K.startingRange);Ia=K.expandSelection;Db=K.getNextDataRegionCell;let dc=0;switch(K.keyboardDirectionValue){case 2:dc=38;K=Ia&&Db?105288353:Ia?-31900117:Db?542791952:137938150;break;case 3:dc=40;K=Ia&&Db?-1297307319:Ia?-1603798598:Db?1713663844:-798660877;break;case 0:dc=37;
K=Ia&&Db?-403586027:Ia?2039316657:Db?-2012742350:-1470715894;break;case 1:dc=39;K=Ia&&Db?784916030:Ia?589730764:Db?1324884057:-1231471547;break;default:K=1461300262}Ia=this.a7b("keydown",dc,Ia,Db);If.h(this.$).$Lb(Ia,new pe.a(K,1,0,8,null))}If.h(this.$).uAb=!1}}a7b(K,Ia,Db,dc){const xc=document.createEvent("KeyboardEvent");if(Xf.a.xF)xc.initKeyboardEvent(K,!1,!1,window.self,"A",0,dc,!1,Db,!1);else{let Rc="";Db&&(Rc+="Shift");dc&&(Rc+=0<Rc.length?" Control":"Control");xc.initKeyboardEvent(K,!1,!1,
window.self,"A",0,Rc,!1,"en-US")}K=new Sys.UI.DomEvent(xc);K.keyCode=Ia;return K}aci(K){switch(K.operationType){case 1:Ne.TaskExtensions.za(yf.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1),Ia=>{Ia.result.jPd()},this.$.ka,3);break;case 2:if(K=Object(ea.a)(rg.DdaFacade,oh.a(this.$)).tn(K.controlId))K.ekc=!0,K.bSf()}}zlh(K){const Ia=K.fileBase64;return Ia&&Ia.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(Lf.G4a(Jh.invalidArgument,Ca.a.instance.ga(1769),"Application.CreateWorkbook")):
(new Promise((Db,dc)=>{const xc=new ag.StandardDialog;xc.Rb=4;xc.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Rc=>{2!==Rc&&0!==Rc||dc(Lf.G4a(Jh.BGd,Ca.a.instance.ga(1768),"Application.CreateWorkbook"));Rc=new qg("blank","agave",Ia?"streamBase64":"streamEmpty",Ia);this.Fzf.create(Db,dc,Rc).Y1a()})})).then(Db=>{this.Kac.set(K.fakeFileId,Db);return Promise.resolve(null)},Db=>Db?Promise.reject(Db):Promise.reject(Lf.G4a(Jh.generalException,Ca.a.instance.ga(1765),
"Application.CreateWorkbook")))}R6i(K){return new Promise((Ia,Db)=>{if(this.Kac.has(K.fakeFileId)){const dc=this.Kac.get(K.fakeFileId);Db=new ag.StandardDialog;Db.Rb=4;Db.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,xc=>{1===xc&&vf.HelperMethods.nf(dc,void 0,void 0,"DdaMethodHandler.fileUrl");Ia(null)})}else Db(Lf.G4a(Jh.generalException,Ca.a.instance.ga(1765),"Document.Open"))})}fCj(K){return new Promise(Ia=>{Object(ea.a)(rg.DdaFacade,oh.a(this.$)).g2f=
K.runtimeCalculationMode;const Db=this.$.da.Ba(268);Db&&Db.GCd(3===K.runtimeCalculationMode);Ia(null)})}nbk(K){Hb.a.oDb(this.$)&&this.$.da.Ba(331).feb(0,K.urlStr,!0,!0,null);return Promise.resolve(null)}mbk(){Hb.a.oDb(this.$)&&this.$.da.Ba(331).feb(1,null,!0,!0,null);return Promise.resolve(null)}jbk(){Hb.a.oDb(this.$)&&this.$.da.Ba(331).nRe();return Promise.resolve(null)}kbk(K){Hb.a.oDb(this.$)&&this.$.da.Ba(331).feb(5,K.urlStr,!0,!0,null);return Promise.resolve(null)}lbk(K){if(Hb.a.oDb(this.$)){const Ia=
this.$.da.Ba(331);for(const Db of Ia.Saa)Db.IsActive&&Db.HostEditUrl&&Db.UrlStr===K.hostEditUrlStr&&vf.HelperMethods.nf(Db.HostEditUrl,"_blank")}return Promise.resolve(null)}wyj(K,Ia){const Db=bh.a.bL;K=x.a.Yh(K.payload);const dc={};"eventId"in K&&"payload"in K&&(dc.eventId=K.eventId,dc.payload=K.payload);Ia.mH(2201,Db,x.a.Ec(dc));return Promise.resolve(null)}gbf(K,Ia,Db){const dc=this.$.da.Ba(5);dc&&(K=this.STh(K))&&(Ia?dc.removeEntry(K):dc.Yqe(K,Db))}STh(K){switch(K){case 0:return 64;case 1:if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}nXc(K){K=
Object(ea.a)(Lj.a,this.$.ua.getItemByName(K));(null===K||void 0===K?0:K.visible)&&K.activate(!0)}nng(K,Ia,Db,dc){var xc=K.ra.Mq;const Rc=xc<Ia.length&&Ia[xc].contains(K.ra.activeCell);K=Rc?K.ra.activeCell:Ia[0].topLeft;xc=Rc?xc:0;If.h(this.$).KZ(Ia,xc,Db,null,K,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===dc)}static get Qmh(){Lf.Cqa||(Lf.Cqa={},Lf.Cqa[Microsoft.Office.WebExtension.CoercionType.Table]=1,Lf.Cqa[Microsoft.Office.WebExtension.CoercionType.Text]=2,Lf.Cqa[Microsoft.Office.WebExtension.CoercionType.Matrix]=
3,Lf.Cqa[Microsoft.Office.WebExtension.CoercionType.Html]=4,Lf.Cqa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return Lf.Cqa}static get Tmh(){Lf.njb||(Lf.njb={},Lf.njb[Microsoft.Office.WebExtension.FilterType.All]=1,Lf.njb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return Lf.njb}static get Umh(){Lf.ojb||(Lf.ojb={},Lf.ojb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,Lf.ojb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return Lf.ojb}static E5e(K){if(!K||
!K.length)return null;const Ia=Array(K.length/2);for(let Db=0;Db<K.length/2;Db++)Ia[Db]={},Ia[Db].Name=K[2*Db],Ia[Db].Value=K[2*Db+1];return Ia}static g8h(K){if(!K||!K.length)return null;const Ia=Array(2*K.length);for(let Db=0;Db<K.length;Db++)Ia[2*Db]=K[Db].Name,Ia[2*Db+1]=K[Db].Value;return Ia}static qed(K){if(!K||!K.length)return null;const Ia=Array(K.length);for(let Db=0,dc=K.length;Db<dc;Db++){const xc=K[Db].length;if(xc){Ia[Db]=Array(xc);for(let Rc=0;Rc<xc;Rc++)Ia[Db][Rc]=null==K[Db][Rc]?null:
K[Db][Rc].toString()}else return null}return Ia}static p5b(K){return"string"===typeof K?ij.a.hq(Lf.Qmh,K,0):K}static tZe(K){return"string"===typeof K?ij.a.hq(Lf.Tmh,K,0):K}static epg(K){return"string"===typeof K?ij.a.hq(Lf.Umh,K,0):K}static csi(K){switch(K.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static t1c(K,Ia){const Db={};Db.CoerceType=K;1===Db.CoerceType?(Db.Data=Lf.qed(Ia.Rows),Db.Headers=Lf.qed(Ia.Headers)):Db.Data=Lf.qed(Ia);return Db}static Wze(K){return 1===
K.CoerceType?{["Headers"]:K.Headers,["Rows"]:K.Data}:K.Data}static lic(K){return 1===K.CoerceType?!K.Data&&!K.Headers:!K.Data}static N8e(K){let Ia="Unknown";if(!K)return Ia;for(let Db=0;Db<K.length;Db++)if(K[Db].Name.toLowerCase()===ie.a.Gvj){Ia=K[Db].Value;break}return Ia}static xKj(K){if(!K)return!1;const Ia=ie.a.ERi.toLowerCase();for(let Db=0;Db<K.length;Db++)if(K[Db].Name.toLowerCase()===Ia)return!0;return!1}static G4a(K,Ia,Db){const dc={};dc.Code=K;dc.Message=Ia;dc.Location=Db;dc.ActionIndex=
0;return dc}}Lf.Cqa=null;Lf.njb=null;Lf.ojb=null;Lf.AHd=0;Object(d.a)(Lf,"DdaMethodHandler",null,[222,3]);class jj extends Vb.a{constructor(K){super(K)}ld(){const K=yf.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.Na),Ia=yf.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.Na),Db=dh(this.ka,this.Na);let dc=tg.Task.Ta(null);dc=A.EwaSettings.isChangeGateEnabled("OfficeVSO:7621821_migrate-HtmlSanitizationHelper-to-new-service")?Object(Sh.c)(wh.a.resolve(Th.w,{Wb:this.Na})):yf.GetServiceTaskFactory.Pa(this.$.da,
498,499,this.Na);Ne.TaskExtensions.za(Ne.TaskExtensions.Md([K,Ia,Db,dc],this.ka),()=>{const Rc=K.result,fd=Of.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.fd([new Lf(this.$,Rc,fd,dc.result)])},this.ka,3);const xc=Of.a.instance;Ne.TaskExtensions.za(yf.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,this.Na),()=>{xc.register(Pg,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").tc().Bc(()=>new Pg)},this.$.ka)}static la(K){Vb.a.Rd(82,
new jj(K))}}Object(d.a)(jj,"DdaCommandHandlerFactory",Vb.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.ni(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(b.a)();
Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(e.a)();(()=>{f.a.Fa(K=>{Fb.la(K)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object($b.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(K=>{A.EwaSettings.xa(52)&&xg.la(K)})})();(()=>{f.a.Fa(K=>{A.EwaSettings.xa(114)&&xi.la(K)})})();f.a.Fa(Ih.la);f.a.Fa(di.la);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(()=>{f.a.Fa(K=>{hi.la(K);me.la(K);
Jf.la(K)})})();f.a.Fa(jj.la)},1499:function(r,B,a){r=a(0);var c=a(197),b=a(101);class e{constructor(){this.lQe=this.displayName=this.ftb=this.Lo=this.qB=null;this.isUpgraded=!1}eof(d,h){return this.qB.getStoreType().toLowerCase()===d.toLowerCase()&&this.qB.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(r.a)(e,"AddinCommandsResourceItem",null,[]);a.d(B,"a",function(){return f});class f{constructor(){this.bIc=null;this.OMc=0;this.sOc=!1;this.Za=new b.a;this.FBg=new c.a}LOg(d){this.Za.addHandler("AddinCommandsLoadingMessageChanged",
d)}Cnj(d){this.Za.removeHandler("AddinCommandsLoadingMessageChanged",d)}get YZa(){return this.bIc}Ieb(d){d!==this.bIc&&(this.bIc=d,this.Za.raiseEvent("AddinCommandsLoadingMessageChanged"))}aCj(){this.OMc++;this.YZa||this.Ieb(CommonUIStrings.l_LoadingAddInsTitle)}RSd(){this.OMc--;this.Rmc()&&(this.sOc?this.YZa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Ieb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Ieb(null))}o7f(d=!1){this.sOc=!0;this.Ieb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:
CommonUIStrings.l_ErrorLoadingAddInsTitle)}fEe(){this.sOc=!1;this.Rmc()?this.Ieb(null):this.Ieb(CommonUIStrings.l_LoadingAddInsTitle)}Rmc(){return 0>=this.OMc}get Y6a(){return this.FBg}sja(d,h,l=0){for(let k of this.Y6a)if(k.eof(d,h)&&(!k.Lo||k.Lo.mRh===l))return k;return null}Sqe(d,h,l,k){const w=new e;w.qB=d;w.Lo=h;w.ftb=l;w.displayName=k;this.Y6a.add(w)}OMg(d,h,l,k){const w=new e;w.qB=d;w.Lo=h;w.ftb=null;w.lQe=l;w.displayName=k;this.Y6a.add(w)}amj(d,h){let l=0;for(let k of this.Y6a)k.qB.getStoreType()===
d&&k.qB.getSolutionId()===h?this.Y6a.removeAt(l):l++}static getInstance(){f.Ma||(f.Ma=new f);return f.Ma}}f.Ma=null;Object(r.a)(f,"AddinCommandsResourceManager",null,[])},748:function(r,B,a){a.d(B,"a",function(){return b});r=a(0);var c=a(36);class b{static get RMi(){return b.Zfe||(b.Zfe={["-2002156328"]:b.RFe,["-1954750170"]:b.m9e,["317650254"]:b.P9g,["-1005263101"]:b.soi,["1353664579"]:b.Jzj,["159671765"]:b.toi,["1446690022"]:b.e4e,["1150069548"]:b.FEc,["-1409306331"]:b.ACe,["338507772"]:b.aMe,["-457159301"]:b.H7i,
["-1037701970"]:b.rmh,["-1893322318"]:b.yoi,["965579896"]:b.tmh,["93287890"]:b.smh,["358088857"]:b.SCj,["-1223650923"]:b.aMe,["2007306190"]:b.Q5g,["1549955423"]:b.Yye,["-1275974171"]:b.xoi,["382101082"]:b.U6i,["-898776235"]:b.xOi,["335464256"]:b.nOi,["1677378049"]:b.woi,["-261992848"]:b.r2j,["-980820954"]:b.Yye,["-931375837"]:b.T6i,["929186550"]:b.Vth,["-982144310"]:b.Sdj,["-785741187"]:b.qoi,["2125217573"]:b.Aoi,["299124955"]:b.roi,["1669853884"]:b.Uvj,["-1515932330"]:b.Q9g,["314621024"]:b.CNh,["-300049690"]:b.U5g,
["14766835"]:b.dIj,["-1251992761"]:b.jPe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.EGa,["49173765"]:b.EGa,["-907155566"]:b.EGa,["-1201603824"]:b.EGa,["1541165282"]:b.EGa,["-1347753427"]:b.EGa,["134912532"]:b.EGa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static Q0e(e){return c.a.hq(b.RMi,
e.toString(),b.internalError)}}b.success=0;b.RFe=1E3;b.m9e=1001;b.P9g=1002;b.soi=1003;b.Jzj=1004;b.toi=1005;b.e4e=1008;b.fZe=1009;b.invalidSheetName=1014;b.FEc=2E3;b.ACe=2001;b.aMe=2002;b.H7i=2003;b.rmh=2004;b.yoi=2005;b.tmh=2007;b.smh=2008;b.SCj=2009;b.Q5g=2014;b.xzj=3E3;b.Yye=3002;b.xoi=3004;b.U6i=3005;b.xOi=3006;b.nOi=3007;b.woi=3008;b.r2j=3009;b.T6i=3010;b.dIj=4002;b.FGd=5E3;b.internalError=5001;b.jPe=5002;b.UAb=5004;b.v3j=5007;b.fji=5008;b.C0f=5011;b.invalidOrTimedOutSession=5012;b.ZGc=5016;
b.EGa=5102;b.Isj=5103;b.responsePayloadSizeLimitExceeded=5104;b.k5g=7001;b.xdg=7002;b.Vth=8E3;b.Sdj=8001;b.qoi=8010;b.Aoi=8011;b.roi=8012;b.Uvj=8020;b.Q9g=8021;b.CNh=8022;b.U5g=8023;b.wMi=11E3;b.lPi=11001;b.zoi=11002;b.Zfe=null;Object(r.a)(b,"DdaErrorIds",null,[])},749:function(r,B,a){a.d(B,"a",function(){return e});r=a(0);var c=a(15),b=a(115);class e{constructor(){this.zMd=0;this.yW={};this.Nta={}}k3h(f,d){return this.yW[e.w1c(f,d)]}qRe(f,d){d||void 0!==this.Nta[f]&&null!==this.Nta[f]?d&&void 0!==
this.Nta[f]&&null!==this.Nta[f]&&delete this.Nta[f]:this.Nta[f]=1}c2b(f){return void 0===this.Nta[f]||null===this.Nta[f]}pci(f){const d=e.w1c(f.messageType,f.targetId);1===f.actionType?this.Udi(f.controlId,f.messageType,d):2===f.actionType&&this.Mei(f.controlId,f.messageType,d)}Hmj(f){if(f){var d=Object.keys(this.yW);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.yW[h],d[f]&&(delete d[f],Object.keys(d).length||delete this.yW[h])}}aN(f,d){f=e.w1c(f,d);f=this.yW[f];return!!f&&0<Object.keys(f).length}Hfi(){return!b.a.isEmpty(this.yW)}$of(){return 0<
this.zMd}rYh(){const f=[],d=this.yW;for(let k in d){var h=k,l=d[k];for(let w in l){l=w;const n={};n.eventType=parseInt(h.split("#")[0],10);n.targetId=h.split("#")[1];n.addinId=l;f.push(n)}}return f}Udi(f,d,h){if(this.yW[h])h=this.yW[h],h[f]=h[f]?h[f]+1:1;else{let l={};l[f]=1;this.yW[h]=l}100===d&&this.zMd++}Mei(f,d,h){if(this.yW[h]){const l=this.yW[h];if(f){const k=l[f];1===k?(delete l[f],Object.keys(l).length||delete this.yW[h]):l[f]=k-1;100===d&&this.zMd--}else c.ULS.sendTraceTag(537170459,0,50,
`The OsfControl[${f}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static w1c(f,d){return String.format("{0}#{1}",f,d)}}e.bL="Workbook";Object(r.a)(e,"RichApiEventRegistration",null,[])},750:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.OWc="AccessDenied";c.notSupported=
"NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.BGd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.y3j="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.ISg="AddinIsAlreadyRequestingToken";c.muj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.Hch="ControlIdNotFound";c.bvj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition=
"InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(r.a)(c,"ErrorCodes",null,[])},753:function(r,B,a){a.r(B);var c=a(0),b=a(7),e=a(15),f=a(1347),d=a(88),h=a(101);class l{constructor(Va,bc,yc){this._id=Va;this.xvg=bc;this.Fxg=yc;this.kif=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get HSg(){return this.xvg}get t$g(){return this.Fxg}execute(Va,bc,yc){yc=yc||{};yc.commandMode=this.kif;bc.invokeAppCommand(this.HSg,this.t$g,yc,()=>{Va.p0i(this.id)})}}
Object(c.a)(l,"AddinNativeActionBase",null,[98]);class k extends l{constructor(Va,bc){super(1,Va,bc);this.kif=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(k,"AddinTakeSnapshotAction",l,[]);class w{meh(Va){return new l(3,Va,this.YRh().getNativeActionName(3))}YRh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(w,"AddinNativeActionManager",null,[83]);var n=a(156);class x{invokeAppCommand(Va,bc,yc,Hc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Va,
bc,yc,Hc)}static getInstance(){x.Ma||(x.Ma=new x);return x.Ma}}x.Ma=null;Object(c.a)(x,"OSFAddinCommandsRuntimeManager",null,[82]);var m=a(4),u=a(192),t=a(27);class y extends n.a{constructor(Va,bc,yc){super();this.x9=null;this.PVc="WACDialogTitleText";this.DX="0";this.A8="15px";this.Uxg="0px";this.CX="calc(100% - 30px)";this.Txg="100%";this.Bje=0;this.Za=new h.a;this.zvg=new w;this.Rb=5;this.we=this.gEa=yc;this.dLc=Va;this.y9d=bc;this.sLc=!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}ZQg(Va){this.Za.addHandler("OnDialogClosedEventKey",
Va)}WEj(){this.nFa=null}Tw(){super.Tw();this.Th.style.width="100%";this.Th.style.height=this.Azb?this.CX:this.Txg;this.Th.style.marginTop=this.Azb?this.A8:this.Uxg;this.Th.style.padding=this.DX}LD(){super.LD();this.ib.style.width=String.format("{0}px",this.dLc*window.innerWidth/100);this.ib.style.height=String.format("{0}px",this.y9d*window.innerHeight/100);this.ib.style.minWidth="0px";this.sLc&&m.AFrameworkApplication.isRtl&&100===this.dLc&&(this.ib.style.right="0px",this.ib.style.marginRight="0px");
this.x9=document.getElementById(this.Oh(this.PVc));this.x9.style.position="absolute";this.x9.style.whiteSpace="nowrap";this.x9.style.textOverflow="ellipsis";m.AFrameworkApplication.isRtl?(this.x9.style.right="14px",this.x9.style.left="44px"):(this.x9.style.right="44px",this.x9.style.left="14px")}xy(Va){super.xy(Va);this.x9&&this.x9.setAttribute("title",Va)}get taa(){return this.Th}pPd(){this.ib.style.width=String.format("{0}px",this.dLc*window.innerWidth/100);this.ib.style.height=String.format("{0}px",
this.y9d*window.innerHeight/100);this.ib.style.overflowY="hidden";this.ib.style.overflowX="hidden";this.ib.style.marginTop="";this.ib.style.top="";t.a.g5&&m.AFrameworkApplication.isRtl?(this.ib.style.right="",this.ib.style.marginRight=""):(this.ib.style.left="",this.ib.style.marginLeft="")}hide(){this.zvg.meh(this.gEa).execute(this,x.getInstance(),{});this.Bje=window.setTimeout(()=>{this.Za.raiseEvent("OnDialogClosedEventKey",this.gEa);u.a.prototype.hide.call(this)},500)}p0i(Va){3===Va&&(window.clearTimeout(this.Bje),
this.Za.raiseEvent("OnDialogClosedEventKey",this.gEa),super.hide())}}Object(c.a)(y,"AppsForOfficeDialog",n.a,[67,68]);class v{constructor(){this.dialog=this.we=null}}Object(c.a)(v,"DialogInfo",null,[]);class A{}A.url="url";A.height="height";A.width="width";A.f$c="displayInIframe";A.tgc="hideTitle";Object(c.a)(A,"DialogSettings",null,[]);class z{constructor(){this.height=this.width=0;this.we=this.controlId=this.pageUrl=null;this.tgc=this.f$c=!1}}Object(c.a)(z,"DisplayDialogParams",null,[]);class C extends Sys.EventArgs{constructor(Va,
bc,yc=null,Hc="",Zc=""){super();this.controlId=Va;this.messageType=bc;this.messageContent=yc;this.messageOrigin=Hc;this.targetOrigin=Zc}}Object(c.a)(C,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class H extends Sys.EventArgs{constructor(Va,bc,yc=null,Hc="",Zc=""){super();this.controlId=Va;this.messageType=bc;this.messageContent=yc;this.messageOrigin=Hc;this.targetOrigin=Zc}}Object(c.a)(H,"OnMessageParentEventArgs",Sys.EventArgs,[]);var I=a(40),S=a(31),P=a(178),D=a(103);class G{constructor(Va){this.Za=
new h.a;this.zl=Va}gRg(Va){this.Za.addHandler("OnMessageParentEventKey",Va)}fRg(Va){this.Za.addHandler("OnMessageDialogEventKey",Va)}showDialog(Va,bc,yc,Hc){if(G.o8.kb(bc))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),yc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Rb=I.b(Va),sc=Rb[A.url];if(this.zl.getOsfControl(bc).checkAppDomains(sc)){var Zc=new z;Zc.width=Rb[A.width];Zc.height=Rb[A.height];Zc.pageUrl=sc;Zc.f$c=
Rb[A.f$c];Zc.tgc=Rb[A.tgc];Zc.controlId=bc;Zc.we=P.a.create().toString();var Sd=new v;Sd.we=Zc.we;var ue=this.zl.getOsfControl(Zc.controlId).getManifest().getDefaultDisplayName(),Fe=this.zl.getOsfControl(Zc.controlId).getStoreType().toLowerCase();Va=null;Va=(4===m.AFrameworkApplication.sa.Qa.ri&&"hardcodedpreinstall"===Fe||"sdxcatalog"===Fe)&&Zc.tgc?this.createAndShowAppsForOfficeDialog(Zc.width,Zc.height,Zc.we,!0,ue):this.createAndShowAppsForOfficeDialog(Zc.width,Zc.height,Zc.we,!1,ue);var Be=this.zl.getOsfControl(Zc.controlId),
Ua=Be.getManifest();bc={};bc.id=Zc.we;bc.solutionId=Be.getSolutionId();bc.version=Be.getVersion();bc.storeType=Fe;bc.storeId=Be.getStoreId();bc.assetId=Be.getAssetId();bc.assetStoreId=Be.getAssetStoreId();bc.ownerAddinSolutionId=Be.getOwnerAddinSolutionId();bc.ownerAddinStoreType=Be.getOwnerAddinStoreType();bc.appDomains=Ua.getAppDomains();bc.dialogUrl=sc;bc.osfControlType=1;bc.agaveName=ue;bc.div=Va.taa;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(bc.solutionId,
bc.ownerAddinStoreType||bc.storeType,bc.assetId,null,null,bc.storeId),S.a.mu(Zc.pageUrl));this.zl.insertDialogControl(bc);Va.ZQg(Object(d.a)(this,this.CVi,"onDialogClosed"));Sd.dialog=Va;G.o8.ia(Zc.controlId,Sd);Hc&&Hc(bc);yc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),yc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Rb){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",
Rb.message),yc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}VMi(Va,bc,yc,Hc){m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Hc&&(Hc=yc);try{const Zc=this.fLa(Va);Zc&&this.Za.raiseEvent("OnMessageParentEventKey",new H(Zc,OSF.DialogMessageType.DialogMessageReceived,bc,yc,Hc))}catch(Zc){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Zc.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}zsb(Va,
bc){if(G.o8.kb(Va))try{const yc=G.o8.ma(Va);yc.dialog&&yc.dialog.hide();this.zl.purgeDialogControl(yc.we);G.o8.remove(Va);bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(yc){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",yc.message),bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}rAj(Va,
bc,yc,Hc){m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Hc&&(Hc=yc);if(G.o8.kb(Va)&&(Va=G.o8.ma(Va),Va.dialog))try{this.Za.raiseEvent("OnMessageDialogEventKey",new C(Va.we,OSF.DialogMessageType.DialogParentMessageReceived,bc,yc,Hc))}catch(Zc){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Zc.message)}}fLa(Va){let bc=null;for(let yc of G.o8)if(yc.value.we===Va){bc=yc.key;
break}return bc}CVi(Va,bc){if(Va=this.fLa(bc))this.zl.purgeDialogControl(bc),G.o8.remove(Va),this.Za.raiseEvent("OnMessageParentEventKey",new H(Va,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(Va,bc,yc,Hc,Zc){Va=new y(Va,bc,yc);Zc=Hc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Zc);Hc&&(Va.Azb=!1,Va.yt=!1);Va.initializeAndShow(Zc,null,null);Va.WEj();return Va}static fai(){return G.o8}static getInstance(Va){G.Ma||(G.Ma=new G(Va));return G.Ma}}
G.Ma=null;G.o8=new D.a;Object(c.a)(G,"AppsForOfficeDialogManager",null,[40]);var E=a(869),O=a(702),N=a(559),J=a(197),W=a(385),ea=a(986);class R{constructor(){this.AUP=this.priority=0}}Object(c.a)(R,"AddinDetailInfo",null,[]);class Y{constructor(){this.Cfb=null;this.errorCode=0;this.failure=null}}Object(c.a)(Y,"AddinCollection",null,[]);class U extends Sys.EventArgs{constructor(Va,bc){super();this.Jsa=Va;this.IT=bc}}Object(c.a)(U,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class da{constructor(Va){this.errorCode=
Va;this.IT=[];this.failure=null}}Object(c.a)(da,"GetAddinDetailsResult",null,[]);var T=a(736),ka=a(891);class L{}Object(c.a)(L,"GetEntitlementDetailsParameters",null,[]);var fa=a(179),wa=a(187),oa=a(83);class xa{constructor(Va,bc,yc=null){this.Za=new h.a;this.n8=new O.a(N.a.li());this.Hy=new W.a;this.xSc=null;this.ENc="https://store-images.s-microsoft.com";this.eVc=new wa.a;this.eVc.add(OSF.StoreTypeEnum.MarketPlace,0);this.eVc.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.fb=Va;this.zl=bc;this.tfa=
yc;if(this.Poh||this.SLe)this.ENc=xa.P_h(Va,this.ENc);this.Ure(Object(d.a)(this,this.vDd,"onAddinDetailsRefreshed"))}get Poh(){return!!this.fb&&this.fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)}get SLe(){return!!this.fb&&this.fb.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled")}get U_e(){return!!this.fb&&this.fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get MBb(){return this.fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Lg(){return this.zl.value}jgd(Va){if(!this.sqd(Va))return Va=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:ea.a[Va]}),Object.assign(new da(1),{failure:Va});if(this.Hy.ma(Va).failure)return Object.assign(new da(this.Hy.ma(Va).errorCode),{failure:this.Hy.ma(Va).failure});e.ULS.shipAssertTag(509870082,220,!!this.Hy.ma(Va).Cfb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Va);const bc=new da(0);for(let yc of this.Hy.ma(Va).Cfb)this.n8.kb(yc)&&
Array.add(bc.IT,this.n8.ma(yc));return bc}VRh(Va){return this.n8.kb(Va)?this.n8.ma(Va):null}Wuc(Va){if(Va){this.Ure(Va);for(let yc of this.Hy.keys)if(this.sqd(yc)&&!this.Hy.ma(yc).failure){e.ULS.shipAssertTag(509870081,220,!!this.Hy.ma(yc).Cfb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",yc);var bc=[];for(let Hc of this.Hy.ma(yc).Cfb)Array.add(bc,this.n8.ma(Hc));bc=new U(yc,bc);Va(null,bc)}}}HR(Va,bc=!1){0!==Va&&10!==Va?e.ULS.sendTraceTag(509870080,220,50,
"QueryAddinDetails: skipping providerType: {0}.",ka.a[Va]):this.hej(Va,Object(d.a)(this,this.C1i,"onQueryAddinDetailsCompleted"),bc)}Ure(Va){this.Za.addHandler(T.a.Mte,Va)}C1i(Va,bc,yc){if(yc)if(xa.eIi(Va,yc,window.performance.now()-bc),0===yc.errorCode){let Zc;if(yc.value){let Sd=0;Zc=Array(yc.value.length);yc.value.forEach(ue=>{Zc[Sd++]=ue})}else Zc=[];this.hAf(Va,Zc)}else if(-1===yc.errorCode||10===yc.errorCode)this.hAf(Va,[]);else{var Hc={};Hc.collectionType=ea.a[Va];Hc.invokeResultCode=yc.errorCode;
Hc["queryResult.Value"]=yc.value?String.format("Length: {0}",yc.value.length):"null";Hc.queryStart=bc;Hc.queryDuration=window.performance.now()-bc;this.Hy.ia(Va,Object.assign(new Y(Va),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Hc)}));e.ULS.sendTraceTag(512231324,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",ea.a[Va],this.Hy.ma(Va).failure.toString(),JSON.stringify(this.Hy.ma(Va).failure))}else Hc=
{},Hc.collectionType=ea.a[Va],Hc.queryResult=yc?"not null":"null",Hc.queryStart=bc,Hc.queryDuration=window.performance.now()-bc,this.Hy.ia(Va,Object.assign(new Y(Va),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Hc)})),e.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",ea.a[Va],this.Hy.ma(Va).failure.toString(),JSON.stringify(this.Hy.ma(Va).failure))}umd(Va){const bc=
{};bc.collectionType=ea.a[Va];this.Hy.ia(Va,Object.assign(new Y(Va),{errorCode:2,failure:Error.create("The store is disabled.",bc)}));e.ULS.sendTraceTag(510253056,220,10,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",ea.a[Va],this.Hy.ma(Va).failure.toString(),JSON.stringify(this.Hy.ma(Va).failure))}jLj(){return this.sqd(2)?this.fb.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Hy.ma(2).failure:!1:!0}hej(Va,bc,yc=!1){e.ULS.sendTraceTag(510248470,
220,50,"QueryAddinDetailsInternal: storeType: {0}.",Va);Va!==OSF.StoreTypeEnum.MarketPlace&&Va!==OSF.StoreTypeEnum.PrivateCatalog?e.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Va):(this.jLj()&&this.queryStoreDisabled(0,(Hc,Zc)=>{Zc?this.umd(2):(Hc=window.performance.now(),bc(2,Hc,this.Y3h()))}),this.queryStoreDisabled(Va,(Hc,Zc)=>{if(Hc===OSF.StoreTypeEnum.MarketPlace&&Zc)this.umd(0);else if(Hc===OSF.StoreTypeEnum.PrivateCatalog&&Zc)this.umd(1);else{var Sd=window.performance.now();
this.Lg.getEntitlementDetails(Object.assign(new L,{storeType:Hc,refresh:yc}),ue=>{bc(this.eVc.ma(Hc),Sd,ue)})}}))}hAf(Va,bc){Va=new U(Va,bc);this.Za.raiseEvent(T.a.Mte,Va)}vDd(Va,bc){Va=Object.assign(new Y(bc.Jsa),{Cfb:new J.a});var yc=bc.IT;for(const Hc of yc)yc=Hc.solutionId,this.n8.kb(yc)?this.n8.ia(yc,this.EMi(this.n8.ma(yc),bc.Jsa,Hc)):this.n8.add(yc,Hc),Va.Cfb.add(yc);this.Hy.ia(bc.Jsa,Va)}sqd(Va){return this.Hy.kb(Va)?!!this.n8:!1}get yWg(){return this.tfa?!this.tfa.AreThirdPartyAddInsAllowed||
this.tfa.AppsForOfficeThirdPartyIsDisabled:!this.fb.qa("AreThirdPartyAddInsAllowed")||this.fb.qa("AppsForOfficeThirdPartyIsDisabled")}get hvi(){return this.tfa?!this.tfa.AppsForOfficeAllowExternalMarketplace:!this.fb.qa("AppsForOfficeAllowExternalMarketplace")}get XIb(){return this.tfa?this.tfa.PopularAddinDetailsJsonString:this.fb.Wa("PopularAddinDetailsJsonString")}queryStoreDisabled(Va,bc){if(this.yWg)bc(Va,!0);else if(Va===OSF.StoreTypeEnum.MarketPlace&&this.hvi)bc(Va,!0);else{const yc=xa.nYj(Va);
if(yc){const Hc=window.performance.now();this.Lg.queryStoreDisabled(yc,Zc=>{e.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Va,Zc,Hc,window.performance.now()-Hc);bc(Va,Zc)})}else bc(Va,!1)}}EMi(Va,bc,yc){if(!Va)return yc;if(!yc)return Va;if(this.U_e)return 2===bc?xa.Txf(yc,Va):xa.Txf(Va,yc);if(2===bc)return Va.addinInfo=yc.addinInfo,Va;yc.addinInfo=Va.addinInfo;return yc}Y3h(){if(this.SLe){if(!this.xSc){var Va=JSON.parse(this.XIb);
this.dMh(Va);this.xSc=Va}return xa.jAe(this.xSc)}Va=JSON.parse(this.XIb);this.y_e(Va);return xa.jAe(Va)}dMh(Va){this.U_e&&xa.DVg(Va);this.NVg(Va);this.y_e(Va)}NVg(Va){const bc=this.o1g();for(var yc=0;yc<Va.length&&0<bc.count;yc++){const Hc=Va[yc];if(bc.kb(Hc.solutionId)){let Zc=String.format("Found an override, solutionId: {0}",Hc.solutionId);const Sd=bc.ma(Hc.solutionId);Sd&&(isNaN(Sd.addinInfo.priority)||(Zc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Zc,Hc.addinInfo.priority,Sd.addinInfo.priority),
Hc.addinInfo.priority=Sd.addinInfo.priority),isNaN(Sd.addinInfo.AUP)||(Zc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Zc,Hc.addinInfo.AUP,Sd.addinInfo.AUP),Hc.addinInfo.AUP=Sd.addinInfo.AUP),Sd.displayName&&(Zc=String.format("{0}; DisplayName: update {1} to {2}",Zc,Hc.displayName,Sd.displayName),Hc.displayName=Sd.displayName),Sd.iconUrl&&(Zc=String.format("{0}; IconUrl: update {1} to {2}",Zc,Hc.iconUrl,Sd.iconUrl),Hc.iconUrl=Sd.iconUrl),Sd.description&&(Zc=String.format("{0}; Description: update {1} to {2}",
Zc,Hc.description,Sd.description),Hc.description=Sd.description));bc.remove(Hc.solutionId);this.MBb&&e.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Zc)}}for(let Hc of bc.keys)yc=bc.ma(Hc),yc.displayName&&yc.iconUrl&&yc.addinInfo&&(Va.push(yc),this.MBb&&e.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(yc)))}o1g(){const Va=new O.a(N.a.li());let bc=this.fb.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins",
"");if(!bc)return Va;bc=bc.trim();if(12>=bc.length)return 0<bc.length&&e.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",bc),Va;this.MBb&&e.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",bc);try{const yc=[],Hc=bc.split("|");for(let Zc=Hc.length-1;0<=Zc;Zc--){const Sd=Hc[Zc],ue=Sd.split("\\");if(2>ue.length){yc.push(Sd);continue}const Fe=xa.E8i(ue);Fe?Va.kb(Fe.solutionId)||Va.add(Fe.solutionId,Fe):yc.push(Sd)}this.MBb&&
0<yc.length&&e.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",yc.join("|"));this.MBb&&0<Va.count&&e.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Va.count,JSON.stringify(oa.toArray(Va.values)));return Va}catch(yc){e.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",bc,yc.toString())}return Va}y_e(Va){for(let bc=0;bc<Va.length;bc++)fa.c(Va[bc].iconUrl.toLowerCase(),
"http",0)||(Va[bc].iconUrl=String.format("{0}/image/apps.{1}",this.ENc,Va[bc].iconUrl))}static eIi(Va,bc,yc){const Hc={};Hc.AddinCollectionType=ea.a[Va];Hc.ErrorCode=bc.errorCode;Hc.AddinCount=bc.value?bc.value.length:0;e.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",yc,JSON.stringify(Hc))}static jAe(Va){const bc={errorCode:0};bc.value=Va;return bc}static nYj(Va){return Va===OSF.StoreTypeEnum.MarketPlace?"omex":Va===OSF.StoreTypeEnum.PrivateCatalog?
"excatalog":null}static Txf(Va,bc){bc.solutionId=bc.solutionId||Va.solutionId;bc.version=bc.version||Va.version;bc.storeType=bc.storeType||Va.storeType;bc.storeId=bc.storeId||Va.storeId;bc.assetId=bc.assetId||Va.assetId;bc.assetStoreId=bc.assetStoreId||Va.assetStoreId;bc.displayName=bc.displayName||Va.displayName;bc.provider=bc.provider||Va.provider;bc.description=bc.description||Va.description;bc.iconUrl=bc.iconUrl||Va.iconUrl;bc.webApplicationId=bc.webApplicationId||Va.webApplicationId;bc.highResolutionIconUrl=
bc.highResolutionIconUrl||Va.highResolutionIconUrl;bc.licenseUrl=bc.licenseUrl||Va.licenseUrl;bc.privacyUrl=bc.privacyUrl||Va.privacyUrl;bc.addinInfo=bc.addinInfo||Va.addinInfo;isNaN(bc.targetType)&&(bc.targetType=Va.targetType);isNaN(bc.height)&&(bc.height=Va.height);isNaN(bc.width)&&(bc.width=Va.width);return bc}static DVg(Va){for(const bc of Va)isNaN(bc.targetType)&&(bc.targetType=1),bc.assetId=bc.assetId||bc.solutionId,bc.storeId=bc.storeId||"en-US",bc.storeType=bc.storeType||"omex",bc.assetStoreId=
bc.assetStoreId||"omex",isNaN(bc.width)&&(bc.width=0),isNaN(bc.height)&&(bc.height=0)}static E8i(Va){const bc={};let yc=0;yc<Va.length&&0<Va[yc].trim().length&&Va[yc].trim().toLowerCase().startsWith("wa")&&(bc.solutionId=Va[yc].trim(),bc.addinInfo=Object.assign(new R,{priority:Number.NaN,AUP:Number.NaN}),++yc<Va.length&&0<Va[yc].trim().length&&(bc.addinInfo.priority=parseInt(Va[yc].trim())),++yc<Va.length&&0<Va[yc].trim().length&&(bc.addinInfo.AUP=parseInt(Va[yc].trim())),++yc<Va.length&&0<Va[yc].trim().length&&
(bc.displayName=Va[yc].trim()),++yc<Va.length&&0<Va[yc].trim().length&&(bc.iconUrl=Va[yc].trim()),++yc<Va.length&&0<Va[yc].trim().length&&(bc.description=Va[yc].trim()));return bc.solutionId?bc:null}static P_h(Va,bc){Va=Va.Wa("AddinImageStoreServiceUrl");if(!Va)return bc;Va=Va.toLowerCase();return Va.startsWith("http://")||Va.startsWith("https://")?Va:bc}}Object(c.a)(xa,"AddinDetailsManager",null,[346]);var bb=a(837),Za=a(1346),La=a(1429),va=a(958),Ba=a(183),Ea=a(1354),pa=a(126),$a=a(86),cb=a(365),
ib=a(91),ta=a(653),Ya=a(87),Da=a(424),ba=a(558),ya=a(167),V=a(39),Z=a(5),ja=a(885),la=a(1269),ua=a(84);class eb{constructor(){this.command=0;this.properties=null}}Object(c.a)(eb,"DdaRequestInfo",null,[]);var Eb=a(748),Wb=a(73);class Ab extends ua.a{constructor(Va,bc){super();this.requests=[];this.disposed=this.l4b=!1;this.dg=()=>{if(!this.disposed){this.grid.Xb.dm(this.dg);this.l4b=!1;const yc=this.requests;this.requests=[];for(let Hc of yc)this.ddaFacade.kK(Hc.command,Hc.properties)}};this.ddaFacade=
Va;this.grid=bc}coh(Va,bc){this.disposed||(this.l4b||(this.grid.Xb.rm(this.dg),this.l4b=!0),this.requests.push(Object(b.a)(new eb,{command:Va,properties:bc})))}dispose(){if(!this.disposed){this.disposed=!0;this.l4b&&this.grid.Xb.dm(this.dg);var Va=this.requests;this.requests=null;for(let bc of Va)(Va=bc.properties?bc.properties[Wb.a.w3]:null)&&this.ddaFacade.Cf(Eb.a.UAb,Va);this.ddaFacade=this.grid=null;super.dispose()}}static w$g(Va,bc){var yc=!1;974713501===Va&&(bc=(Va=bc?bc[Wb.a.Sf]:null)?Va.DdaMethod:
null)&&bc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(yc=Va.ArrayData,yc=!!yc&&64===(yc[6]&64));return yc}}Object(c.a)(Ab,"DdaCellEditDelayRequestHandler",ua.a,[]);var Jb=a(780);class Gb extends Jb.a{constructor(Va,bc,yc,Hc,Zc,Sd,ue){super(Va,bc,yc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Hc;this.messageContent=Zc;this.messageOrigin=Sd;this.targetOrigin=ue}}Object(c.a)(Gb,"DialogMessageReceivedEventArgs",Jb.a,[]);
class Nb extends Jb.a{constructor(Va,bc,yc,Hc,Zc,Sd,ue){super(Va,bc,yc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Hc;this.messageContent=Zc;this.messageOrigin=Sd;this.targetOrigin=ue}}Object(c.a)(Nb,"DialogParentMessageReceivedEventArgs",Jb.a,[]);var Ja=a(1),ab=a(21);class wb{constructor(Va){this.Lg=this.s_c=null;this.f0i=(bc,yc)=>{this.handlers.kb(yc.controlId)&&(bc=new Gb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,yc.controlId,null,
yc.messageType,yc.messageContent,yc.messageOrigin,yc.targetOrigin),this.handlers.ma(yc.controlId)(bc),yc.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(yc.controlId))};this.e0i=(bc,yc)=>{this.noc.kb(yc.controlId)&&(bc=new Nb(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,yc.controlId,null,yc.messageType,yc.messageContent,yc.messageOrigin,yc.targetOrigin),this.noc.ma(yc.controlId)(bc))};this.handlers=new D.a;this.noc=new D.a;this.Vg=Va;this.J2a.gRg(this.f0i);this.J2a.fRg(this.e0i)}get J2a(){this.s_c||
(this.s_c=G.getInstance(this.contextActivationMgr));return this.s_c}get contextActivationMgr(){!this.Lg&&this.Vg&&(this.Lg=this.Vg.Lg);return this.Lg}addHandler(Va,bc,yc,Hc){if(Ja.EwaSettings.xa(23))this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,yc);else{e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Zc=Sd=>{Sd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(Va,bc),this.Vg.uv(yc)):(e.ULS.sendTraceTag(537170501,
0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Vg.Cf(Sd,yc))};this.handlers.kb(Va)?Zc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Va,Hc,Zc)}}GMg(Va,bc,yc){Ja.EwaSettings.xa(23)?this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,yc):(e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.noc.ia(Va,bc),this.Vg.uv(yc))}removeHandler(Va,bc){Ja.EwaSettings.xa(23)?this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
bc):this.handlers.kb(Va)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.J2a.zsb(Va,yc=>{this.handlers.remove(Va);yc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Vg.uv(bc):(e.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Vg.Cf(yc,bc))})):this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,bc)}Zmj(Va,bc){Ja.EwaSettings.xa(23)?this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
bc):(e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.noc.remove(Va),this.Vg.uv(bc))}showDialog(Va,bc,yc){try{Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&ab.h(this.Vg.$).eb&&ab.h(this.Vg.$).No(!0),this.J2a.showDialog(bc,Va,yc,Hc=>{this.Vg.WMg(this.l2g(Hc))})}catch(Hc){e.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Hc.message}`),yc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}l2g(Va){const bc=
{};bc.InstanceId=Va.id;bc.WebExtensionType=Va.osfControlType===OSF.OsfControlTarget.InContent?0:1;bc.PrimaryMarketplace={};bc.PrimaryMarketplace.SolutionId=Va.solutionId;bc.PrimaryMarketplace.SolutionVersion=Va.version;bc.PrimaryMarketplace.MarketplaceRef=Va.storeId;bc.PrimaryMarketplace.MarketplaceType=Va.storeType;bc.OwnerAddinSolutionId=Va.ownerAddinSolutionId;bc.OwnerAddinStoreType=Va.ownerAddinStoreType;return bc}static la(Va){if(!Va.$.da.Ba(232)){const bc=new wb(Va);Va.$.da.Ha(232,bc)}}}Object(c.a)(wb,
"DialogMessageReceivedEventManager",null,[864]);class xb{constructor(Va,bc){this.JA=null;this.Hfa=Va;this.bIg=bc}Q0b(Va){Va&&(this.JA||(this.JA=[]),this.JA.push(Va))}Svc(Va){this.JA&&Array.remove(this.JA,Va)}get eventId(){return this.Hfa}get targetId(){return this.bIg}get vfi(){return 0<this.JA.length}lLi(Va){return this.eventId!==Va.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Va.ddaBinding.Name:
!0}Q3b(Va){this.JA&&Array.forEach(this.JA,bc=>{bc(Va)})}yna(){this.JA=[]}}Object(c.a)(xb,"DdaEventRegistration",null,[]);class rb{constructor(Va){this.WE=null;this.Swa=!1;this.Zc=()=>{this.WE.forEach(bc=>{bc.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&bc.Q3b(new Jb.a(bc.eventId,"",null))})};this.Vg=Va}invokeDdaMethod(Va,bc){const yc={};yc[Wb.a.Sf]=Va;yc[Wb.a.w3]=bc;this.Vg.kK(974713501,yc)}registerDdaEventAsync(Va,bc,yc,Hc,Zc){rb.FBb(Va)?(rb.nrd(Va)&&this.Nnd(),this.WE||(this.WE=
[]),bc=this.ewb(Va,yc),bc||(bc=new xb(Va,yc),this.WE.push(bc)),bc.Q0b(Hc),this.Vg.uv(Zc)):this.Vg.Cf(-1,Zc)}unregisterDdaEventAsync(Va,bc,yc,Hc,Zc){rb.FBb(Va)?((Va=this.ewb(Va,yc))&&Va.Svc(Hc),this.Vg.uv(Zc)):this.Vg.Cf(-1,Zc)}Nnd(){this.Swa||(ab.h(this.Vg.$).ha.$L(this.Zc),this.Swa=!0)}ewb(Va,bc){if(!this.WE)return null;for(let yc=0;yc<this.WE.length;yc++){const Hc=this.WE[yc];if(Hc.eventId===Va&&Hc.targetId===bc)return Hc}return null}static FBb(Va){return Va===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static nrd(Va){return Va===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(rb,"EmbeddingPage",null,[831]);var za=a(189);class Aa extends Jb.a{constructor(Va,bc,yc,Hc,Zc,Sd,ue,Fe){super(Va,bc,yc);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Sd-Hc.Reference.FirstColumn;this.columnCount=Fe;Va=Math.max(Zc,Hc.Reference.FirstRow);Zc=Math.min(Zc+ue-1,Hc.Reference.LastRow);Va>Zc?this.startRow=this.rowCount=void 0:(this.startRow=Va-Hc.Reference.FirstRow,this.rowCount=Zc-Va+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}
Object(c.a)(Aa,"DdaBindingSelectionEventArgs",Jb.a,[]);var pb=a(207),kb=a(24),Cb=a(44),ob=a(50),qa=a(425),ma=a(33),Ga=a(38),vb=a(575),Ka=a(124),Pa=a(52),fb=a(96),Wa=a(12),Ma=a(11),lb=a(109);class Na{}Na.ZCh="ewa-wx-disabled-div";Na.YCh="ewa-wx-container-div";Na.zUe="ewa-ptp-nov2-flex";Object(c.a)(Na,"CssClassNames",null,[]);var X=a(70),F=a(108),na=a(153),hb=a(54);const Ib=Na.ZCh,vc=Na.YCh;class nc extends za.a{constructor(Va,bc,yc,Hc=!1){super();this.jeb=0;this.WE=null;this.Swa=!1;this.Mtc=null;this.xU=
0;this.Y7b=this.pWa=this.Z8d=this.B6d=null;this.lde=!1;this.NRc=this.bea=this.N3d=null;this.Zc=()=>{this.enabled&&(this.BAj(),this.Mtc=Cb.d(ab.h(this.$).ha.ra.selectedRanges))};this.pbf=Zc=>{Zc.controlId===this.Cd.InstanceId&&Array.forEach(this.WE,Sd=>{Sd.lLi(Zc)&&Sd.Q3b(Zc)})};this.QBf=Zc=>{if((Zc=Object(Ya.a)(504,Zc))&&!Zc.Et())if(!this.Cd||OSF.OsfControl.isFirstPartyStoreString(this.Cd.PrimaryMarketplace.MarketplaceType)||this.$.AP){Zc.hf=this.Cd;Zc.wj=this.Vg;this.N3d=Zc;this.zzc(Zc.gHa);const Sd=
Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&ma.a.Gd(this.$)&&Ma.HelperMethods.Aw(this.Cd)&&this.Cd.Preload&&!this.Cd.TaskpaneVisible;Sd?Zc.UEd():Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Zc.UEd(),(this.Cd.SharedRuntime&&1===this.Cd.SharedRuntime.LifeTime||this.Cd.SharedRuntimeId)&&!this.Cd.TaskpaneVisible&&Zc.Sg(!1)):((this.Cd.SharedRuntime&&1===this.Cd.SharedRuntime.LifeTime||this.Cd.SharedRuntimeId)&&
!this.Cd.TaskpaneVisible&&Zc.Sg(!1),Zc.UEd());this.h7a||(ma.a.Gd(this.$)?Sd||Zc.E6():qa.a(this.$).result.yI(Zc,!0));this.$.da.Ba(77).vYf(this.QBf);this.m$=Object(Ya.a)(254,Zc)}else e.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Zc,Sd)=>{3===Sd.control.floatingObject.type&&Sd.control.floatingObject.xl.InstanceId===this.h1.WebExtensionId&&(this.m$=Object(Ya.a)(254,Sd.control),this.zzc(Sd.control.Od.firstChild),lb.a(this.$).Mvc(this.onFloatingObjectControlAdded))};
this.mb=Va.$;this.Vg=Va;this.Cd=yc;this.Cd.InstanceId=yc.SrcLocationOverrideResourceId?Va.VKa(yc.InstanceId,yc.SrcLocationOverrideResourceId):yc.InstanceId;this.Wg=bc;this.h1={};this.h1.WebExtensionId=yc.InstanceId;this.DNf="osfControl_"+yc.InstanceId;this.W9c="disabled_"+yc.InstanceId;this.h1.BindingData=yc.BindingData;this.h7a=this.Vg.h7a(yc.InstanceId);this.cic=this.Vg.cic(yc.InstanceId);this.Ohe=yc.WebExtensionOsfControlType;this.ZQf=Hc}get controlId(){return this.Cd.InstanceId}tmi(Va){this.bea||
(this.bea=Va)}gYf(){this.bea&&(this.bea.dispose(),this.bea=null)}get controlType(){return this.Cd.WebExtensionType}get ownerAddinSolutionId(){return this.Cd.OwnerAddinSolutionId}get $(){return this.mb}get enabled(){return!this.xU}get visible(){return this.Cd.TaskpaneVisible}get oy(){return this.NRc}get YP(){return this.Cd.SrcLocationOverrideResourceId?this.Vg.VKa(this.Cd.PrimaryMarketplace.SolutionId,this.Cd.SrcLocationOverrideResourceId):this.Cd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Cd.SrcLocationOverrideResourceId}get xl(){return this.Cd}get m$(){return this.B6d}set m$(Va){this.B6d=
Va}get osfControlType(){return this.Ohe}get jua(){return this.Z8d}set jua(Va){this.Z8d=Va}get X7b(){return this.pWa}set X7b(Va){this.pWa=Va}get focusOnIframeWhenLoaded(){return this.Cd.FocusOnIframeWhenLoaded}get ekc(){return this.lde}set ekc(Va){this.lde=Va}dpd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Cd.PrimaryMarketplace.MarketplaceType)&&Ja.EwaSettings.xa(174)){const bc=Object(X.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(F.c)(na.a.resolve(hb.e,{Wb:0})):ob.GetServiceTaskFactory.Pa(this.$.da,
5,4,0);Ga.TaskExtensions.za(bc,()=>{bc.result.sh(36,null)},this.ka,3);return this}if(1===this.Cd.WebExtensionType)Ga.TaskExtensions.za(qa.a(this.$),bc=>{bc.result.ytb(this.$.da,77,5,this.QBf,1)},this.ka,3);else{var Va=this.AZe();const bc=lb.a(this.$);Va||(Va={Type:3},Va.Id=this.h1.WebExtensionId,Va.WebExtensionData=this.Cd,Va.ContentHtml="<div/>",Va.Version=0,Va.AbsoluteLeft=0,Va.AbsoluteTop=0,Va.AbsoluteRight=0,Va.AbsoluteBottom=0,Va.Width=0,Va.Height=0,Va.ZOrder=0,Va.OriginDeltaX=0,Va.OriginDeltaY=
0,Va=new pb.a(Va),bc.I6b(Va,null),Va=bc.vr(Va.Mg()));Va?(this.zzc(Va.Od.firstChild),this.m$=Object(Ya.a)(254,Va)):bc.I0b(this.onFloatingObjectControlAdded)}return this}xgf(Va){this.zzc(Va);return this}cqc(){this.ZQf||this.Vg.Lg.purgeOsfControl(this.controlId,!1);this.Bkg(!0);const Va=this.AZe();Va&&lb.a(this.$).deleteFloatingObject(Va);this.Vg.Gh.Hmj(this.controlId);this.Vg.Gh.qRe(this.controlId,!0);this.NRc=null}fFd(Va){this.h1=Va}invokeDdaMethod(Va,bc){if(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled){var yc={};yc[Wb.a.Sf]=Va;yc[Wb.a.w3]=bc;this.Vg.kK(974713501,yc)}else this.Vg.Cf(Eb.a.UAb,bc)}Wjj(Va,bc,yc,Hc){if(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!nc.ysh(Va)||void 0!==bc&&null!==bc&&void 0!==this.d4a(bc)&&null!==this.d4a(bc))if(e.ULS.sendTraceTag(36444195,0,50,`eventId: ${Va}, targetId: ${bc}`),nc.Yjf(Va)&&this.rhi(),nc.nrd(Va)&&this.Nnd(),nc.Wjf(Va))Ja.EwaSettings.xa(23)?this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Hc):this.Vg.$.da.Ba(232).addHandler(this.controlId,yc,Hc,bc);else if(nc.Xjf(Va))Ja.EwaSettings.xa(23)?this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hc):this.Vg.$.da.Ba(232).GMg(this.controlId,yc,Hc);else{nc.Vjf(Va)&&this.rbf(-1777565636,Hc);this.WE||(this.WE=[]);var Zc=this.ewb(Va,bc);Zc||(Zc=new xb(Va,bc),this.WE.push(Zc));Zc.yna();Zc.Q0b(yc);this.Vg.uv(Hc);Va===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.pWa&&(this.Y7b=yc)}else this.Vg.Cf(3002,Hc);else this.Vg.Cf(-1,
Hc)}B2j(Va,bc,yc,Hc){nc.Wjf(Va)?Ja.EwaSettings.xa(23)?this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hc):this.Vg.$.da.Ba(232).removeHandler(this.controlId,Hc):nc.Xjf(Va)?Ja.EwaSettings.xa(23)?this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hc):this.Vg.$.da.Ba(232).Zmj(this.controlId,Hc):(nc.Vjf(Va)&&this.rbf(1592314317,Hc),bc=this.ewb(Va,bc),this.enabled?(bc&&(bc.Svc(yc),bc.vfi||Array.remove(this.WE,bc),this.WE.length?nc.Yjf(Va)&&this.Ckg(!1):this.Bkg(!1)),
this.Vg.uv(Hc)):this.Vg.Cf(-1,Hc))}la(Va){Wa.DOMElementExtensions.getElementById(Va,this.DNf)||Va.appendChild(Wa.DOMElementExtensions.yf(this.oy))}showHide(Va){Wa.DOMElementExtensions.setVisible(this.oy,Va)}resize(Va,bc){Wa.DOMElementExtensions.Sv(this.oy,Va);Wa.DOMElementExtensions.SI(this.oy,bc)}fOe(Va){if(!this.xU&&!Wa.DOMElementExtensions.getElementById(this.oy,this.W9c)&&this.oy){const bc=document.createElement("div");bc.id=this.W9c;bc.className=Ib;bc.style.backgroundImage="url("+Pa.a.current.Un(103)+
")";bc.style.opacity=Va?"1":"0";bc.style.backgroundRepeat="no-repeat";bc.style.backgroundPosition="center";this.oy.insertBefore(bc,this.oy.firstChild)}this.xU++}nvh(){0<this.xU&&this.xU--;this.xU||(Wa.DOMElementExtensions.yf(Wa.DOMElementExtensions.getElementById(this.oy,this.W9c)),this.Swa&&!Cb.R(this.Mtc,ab.h(this.$).ha.ra.selectedRanges)&&this.Zc(null,null))}d4a(Va){if(!this.h1||!this.h1.BindingData)return null;for(let bc=0;bc<this.h1.BindingData.length;bc++)if(this.h1.BindingData[bc].Name===Va)return this.h1.BindingData[bc];
return null}getDefaultIconUrl(){const Va=this.G7e();return Va?Va.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Cd.TaskpaneTitle)return this.Cd.TaskpaneTitle;const Va=this.G7e();return Va?Va.getDefaultDisplayName():null}bSf(){if(this.pWa&&this.Y7b){const Va=new Jb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.pWa);this.Y7b(Va);this.Y7b=this.pWa=null}}Sg(Va){this.N3d&&this.N3d.Sg(Va)}ECj(){this.$.ea.isNamedObjectViewMode&&this.Mwi()&&(this.$.da.Ba(34).DCj(this.oy),
this.showHide(!1));if(this.Vg.Cak){if(!this.ZQf){const Va={};Va.div=this.oy;Va.id=this.Cd.InstanceId;Va.solutionId=this.Cd.PrimaryMarketplace.SolutionId;Va.version=this.Cd.PrimaryMarketplace.SolutionVersion;Va.storeId=this.Cd.PrimaryMarketplace.MarketplaceRef;Va.storeType=this.Cd.PrimaryMarketplace.MarketplaceType;Va.ownerAddinSolutionId=this.Cd.OwnerAddinSolutionId;Va.ownerAddinStoreType=this.Cd.OwnerAddinStoreType;this.Cd.AssetMarketplace?(Va.assetId=this.Cd.AssetMarketplace.SolutionId,Va.assetStoreId=
this.Cd.AssetMarketplace.MarketplaceRef):(Va.assetId=null,Va.assetStoreId=null);Va.settings=this.Cd.OsfPropertyBag;Va.hostSettings=this.Cd.HostPropertyBag;Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Va.reason=this.h7a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.cic?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Va.reason=this.h7a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
Microsoft.Office.WebExtension.InitializationReason.Inserted;Va.osfControlType=0===this.Cd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Va.isForUILessAction=4===this.Cd.WebExtensionOsfControlType;Va.sourceLocationOverrideResourceId=this.Cd.SrcLocationOverrideResourceId;Va.focusOnIframeWhenLoaded=this.Cd.FocusOnIframeWhenLoaded;vb.a(this.Cd)&&(Va.featureGates=m.AFrameworkApplication.fa.Z4e(Va.solutionId));Va.hostInfoFlags=0;this.jua&&(Va.hostInfoFlags|=2);Ma.HelperMethods.Aw(this.Cd)&&
(Va.hostInfoFlags|=1);this.$.AP||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Va.hostInfoFlags|=4);Ja.EwaSettings.xa(553)&&(Va.hostInfoFlags|=8);Va.sharedRuntimeId=this.Cd.SharedRuntime?this.Cd.SharedRuntime.Resid:this.Cd.SharedRuntimeId;!Ma.HelperMethods.Aw(this.Cd)||this.Cd.Preload||vb.a(this.Cd)||this.Vg.Lg.getOsfControl(a(753).DdaFacade.getSolutionId(this.Cd,this.$))||(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&
this.Vg.pMf(this.Cd):this.Vg.pMf(this.Cd));Va.initialDisplayMode=this.Cd.TaskpaneVisible?2:1;Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Va.titleOverride=this.xl.TaskpaneTitle);this.Vg.Lg.insertOsfControl(Va)}this.xU=0}else this.fOe(!0)}Bkg(Va){this.Ckg(Va);this.k2j()}rhi(){this.jeb||this.Wg.Q0b(this.pbf);this.jeb++}Ckg(Va){0<this.jeb&&(Va?this.jeb=0:this.jeb--,this.jeb||this.Wg.Svc(this.pbf))}Nnd(){if(!this.Swa){const Va=ab.h(this.$).ha;this.Mtc=Cb.d(ab.h(this.$).ha.ra.selectedRanges);
Va.$L(this.Zc);this.Swa=!0}}k2j(){this.Swa&&(ab.h(this.$).ha.NR(this.Zc),this.Swa=!1)}yzj(Va){var bc=new kb.Range(Va.Reference.FirstRow+1,Va.Reference.FirstColumn+1,Va.Reference.LastRow+1,Va.Reference.LastColumn+1,!1,!1);1===Va.BindingType&&(Va.HasHeaders&&--bc.top,Va.HasTotals&&(bc.bottom+=1));var yc=ab.h(this.$).ha.ra.selectedRanges;Va=bc.b7a(this.Mtc);yc=bc.b7a(yc);return(bc=bc.xe(ab.h(this.$).ha.ra.activeRange))&&(Ka.e(Va)&&!Ka.e(yc)||!Ka.e(Va)&&!Ka.e(yc)&&!Cb.R(Va,yc))?bc:null}BAj(){Array.forEach(this.WE,
Va=>{if(Va.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Va.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Vg.Gh.c2b(this.controlId))if(Va.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Va.Q3b(new Jb.a(Va.eventId,this.controlId,null));else if(Va.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const bc=this.d4a(Va.targetId);if((null===bc||void 0===bc?0:bc.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.Bb.na.sheetName:
this.$.ua.na.name)===bc.Reference.SheetName){const yc=this.yzj(bc);yc&&Va.Q3b(new Aa(Va.eventId,this.controlId,this.Vg.R2b(bc),bc,yc.top-1,yc.left-1,yc.height,yc.width))}}})}ewb(Va,bc){if(!this.WE)return null;for(let yc=0;yc<this.WE.length;yc++){const Hc=this.WE[yc];if(Hc.eventId===Va&&Hc.targetId===bc)return Hc}return null}AZe(){const Va=lb.a(this.$).RU;for(let bc=Va.length-1;0<=bc;--bc){const yc=Va[bc];if(3===yc.floatingObject.type&&yc.floatingObject.xl.InstanceId===this.h1.WebExtensionId)return yc}return null}Mwi(){for(let Va=
0;Va<this.$.Bb.count;Va++)if(this.$.Bb.getItem(Va).imageId===this.h1.WebExtensionId)return!0;return!1}zzc(Va){this.NRc=Va;this.oy.id=this.DNf;this.oy.className=vc;this.oy.dir=this.$.isChromeRtl?"rtl":"ltr";this.ECj()}G7e(){if(!this.enabled)return null;const Va=vb.a(this.xl)?"":this.xl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.xl.PrimaryMarketplace.SolutionId,Va)}rbf(Va,bc){if(Ja.EwaSettings.xa(23))this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
bc);else try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Ohe)this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,bc);else{const yc={};yc[T.a.Hpb]=this.controlId;const Hc=new fb.a(Va,0,this.$.isEditMode?2:1,0,null);this.$.Ia.Hb(Hc,yc);this.Vg.uv(bc)}}catch(yc){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${yc.message}.`),this.Vg.Cf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
bc)}}static ysh(Va){return Va===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Va===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Yjf(Va){return Va===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Va===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Va===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static nrd(Va){return Va===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Va===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Wjf(Va){return Va===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Xjf(Va){return Va===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Vjf(Va){return Va===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(nc,"OsfControl",za.a,[863]);class Pb{constructor(){this.a_a={}}add(Va){this.a_a[Va]=!0}remove(Va){delete this.a_a[Va]}clear(){for(const Va of Object.keys(this.a_a))delete this.a_a[Va]}Gcf(){return 0<Object.keys(this.a_a).length}XRh(){return Object.keys(this.a_a)}}Object(c.a)(Pb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,
[]);var oc=a(59);class Ic{constructor(Va,bc,yc){this.ZWf=this.YWf=0;this.SNb=this.Qbb=null;this.HTi=()=>{var Hc=ab.h(this.$).ha.Sa.IA;if(this.Xqd(Hc)&&(Hc=this.vxb(Hc))){var Zc={};Zc.chartId=Hc;Zc.worksheetId=this.aka();Zc=oc.a.Ec(Zc);this.vja(51,Hc,Zc);this.vja(51,this.aka(),Zc)}};this.ITi=()=>{if(this.Qbb){var Hc={};Hc.chartId=this.Qbb;Hc.worksheetId=this.SNb;Hc=oc.a.Ec(Hc);this.vja(52,this.Qbb,Hc);this.vja(52,this.SNb,Hc)}Hc=ab.h(this.$).ha.Sa.IA;this.Xqd(Hc)?(this.Qbb=this.vxb(Hc),this.SNb=this.aka()):
this.SNb=this.Qbb=null};this.$=Va;this.Gh=bc;this.Wg=yc}Gqb(Va){51===Va.messageType?this.YWf=this.wHa(Va.actionType,this.YWf,this.HTi):52===Va.messageType&&(this.ZWf=this.wHa(Va.actionType,this.ZWf,this.ITi))}wHa(Va,bc,yc){if(1===Va)bc||ab.h(this.$).ha.Sa.DYc(yc),bc++,this.xGj();else if(2===Va){if(1>bc)return bc;1===bc&&ab.h(this.$).ha.Sa.vNd(yc);bc--}return bc}vja(Va,bc,yc){bc&&this.Gh.aN(Va,bc)&&this.Wg.mH(Va,bc,yc)}vxb(Va){return Va&&Va.floatingObject?(Va=Va.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===Va.length?Va[0]:null:null}aka(){const Va=this.$.ua.na;return Va&&0===Va.cG?Va.sheetId:null}xGj(){const Va=ab.h(this.$).ha.Sa.IA;this.Xqd(Va)&&(this.Qbb=this.vxb(Va),this.SNb=this.aka())}Xqd(Va){return!!Va&&!!Va.floatingObject&&0===Va.floatingObject.type}}Object(c.a)(Ic,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var ec=a(749),mb=a(201),Ob=a(620),Ta=a(104),sb=a(354),zb=a(58);class db extends ua.a{constructor(Va,bc,yc){super();this.xU=this.JAa=0;this.Zc=(Hc,Zc)=>{if(this.enabled&&!(this.Rlf()||
null!==Zc&&void 0!==Zc&&Zc.lpf)&&(Hc=Object(Ya.a)(Ta.a,this.$.ua.na))&&0===Hc.cG){const Sd=Hc.sheetId,ue=this.X3e();let Fe=null,Be=null;this.Gh.$of()&&(Fe=this.grid.tb.uh(this.grid.ha.ra.activeCell),Be=Sd in this.$lc?this.$lc[Sd]:null);this.Ywe(Sd,ue)&&Ga.TaskExtensions.za(zb.Task.Ta(!0),()=>{this.Tei(Sd,ue);this.Eei(Sd,ue,Fe,Be)},this.ka);this.ePe(Sd,ue,Fe)}};this.$=Va;this.Gh=bc;this.Wg=yc;this.grid=ab.h(Va);this.nOa={};this.$lc={}}get enabled(){return!this.xU&&0<this.JAa}x2b(Va){Object(Ya.a)(sb.a,
this.$.ua);1===Va.actionType?(this.JAa||this.grid.ha.$L(this.Zc),this.JAa++):2!==Va.actionType||1>this.JAa||(1===this.JAa&&this.grid.ha.NR(this.Zc),this.JAa--)}kzc(Va){Va?this.xU++:(0<this.xU&&this.xU--,this.xU||this.Zc(null,new Ob.a(!1)))}X3e(){return this.grid.ha.ra.selectedRanges}Ywe(Va,bc){return Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!Va&&mb.e(this.nOa)||Va in this.nOa)&&!Cb.R(this.nOa[Va],bc):Va in this.nOa&&!Cb.R(this.nOa[Va],
bc)}ePe(Va,bc,yc){this.nOa[Va]=Cb.d(bc);this.$lc[Va]=yc}Rlf(){return this.grid.eb||this.grid.ei}ZZe(Va,bc){this.Gh.aN(14,Va)&&this.Wg.mH(14,Va,bc);this.Gh.aN(14,ec.a.bL)&&this.Wg.mH(14,ec.a.bL,bc)}Tei(Va,bc){const yc={};yc.worksheetId=Va;yc.address=this.Tjd(bc);bc=oc.a.Ec(yc);this.ZZe(Va,bc)}Eei(Va,bc,yc,Hc){if(this.Gh.$of()){var Zc="";let Sd="";Hc&&(Zc=Hc.ej);yc&&(Sd=yc.ej);Hc?yc?(bc=yc.usedRange.b7a(bc),Zc!==Sd&&this.wbc(Zc,"",Va),this.wbc(Sd,this.Tjd(bc),Va)):this.wbc(Zc,"",Va):yc&&(Zc=yc.usedRange.b7a(bc),
this.wbc(Sd,this.Tjd(Zc),Va))}}wbc(Va,bc,yc){if(this.Gh.aN(100,Va)){const Hc={};Hc.address=bc;Hc.worksheetId=yc;this.Wg.mH(100,Va,oc.a.Ec(Hc))}}Tjd(Va){return Cb.i(Va,",",this.$,!1)}dispose(){0<this.JAa&&this.grid.ha.NR(this.Zc);this.$lc=this.nOa=null;this.JAa=0;this.Wg=this.Gh=this.$=this.grid=null}}Object(c.a)(db,"RichApiEventSelectionChangedHandler",ua.a,[]);var jb=a(350);class Ub extends db{constructor(Va,bc,yc){super(Va,bc,yc);this.lrf=this.mrf=null}X3e(){return jb.a.Itb(this.grid.ha.rangePicker.RK)}Ywe(Va,
bc){return this.mrf!==Va||!Cb.R(this.lrf,bc)}ePe(Va,bc){this.mrf=Va;this.lrf=Cb.d(bc)}Rlf(){return!this.grid.eb&&!this.grid.ei}ZZe(Va,bc){this.Gh.aN(2700,ec.a.bL)&&this.Wg.mH(2700,ec.a.bL,bc)}}Object(c.a)(Ub,"RichApiEventPickedRangesChangedHandler",db,[]);class xd{constructor(Va,bc,yc){this.fRa=this.eRa=0;this.UHa=this.Oha=null;this.qFf=()=>{var Hc=ab.h(this.$).ha.Sa.IA;if(0<this.fRa&&this.Oha&&this.UHa){var Zc={};Zc.shapeId=this.Oha;Zc.worksheetId=this.UHa;Zc=oc.a.Ec(Zc);this.fireEvent(2102,this.Oha,
Zc)}this.Gyi(Hc)?(this.Oha=this.K0j(Hc),this.UHa=this.aka(),this.Oha&&this.UHa)?0<this.eRa&&(Hc={},Hc.shapeId=this.Oha,Hc.worksheetId=this.UHa,Hc=oc.a.Ec(Hc),this.fireEvent(2101,this.Oha,Hc)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Oha}', or worksheet id: '${this.UHa}' from a Floating object or gridview.`):this.UHa=this.Oha=null};this.$=Va;this.Gh=bc;this.Wg=yc}Gqb(Va){const bc=ab.h(this.$).ha;1===Va.actionType?(this.eRa||this.fRa||bc.Sa.DYc(this.qFf),
2101===Va.messageType?this.eRa++:2102===Va.messageType&&this.fRa++):2===Va.actionType&&(2101===Va.messageType?this.eRa=0<this.eRa?this.eRa-1:0:2102===Va.messageType&&(this.fRa=0<this.fRa?this.fRa-1:0),this.eRa||this.fRa||bc.Sa.vNd(this.qFf))}Gyi(Va){return!!Va&&!!Va.floatingObject&&(0===Va.floatingObject.type||7===Va.floatingObject.type||1===Va.floatingObject.type||3===Va.floatingObject.type||5===Va.floatingObject.type)}K0j(Va){if(!Va||!Va.floatingObject)return null;Va=Va.floatingObject.id;var bc=
Va.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));bc=bc&&1===bc.length?bc[0]:null;return bc?bc:(e.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${Va}', but we failed.`),null)}aka(){const Va=this.$.ua.na;return Va&&0===Va.cG?Va.sheetId:null}fireEvent(Va,bc,yc){bc&&this.Gh.aN(Va,bc)&&this.Wg.mH(Va,bc,yc)}}Object(c.a)(xd,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class ne{constructor(Va,bc,yc){this.bXf=this.aXf=this.cXf=this.$Wf=
0;this.b6i=(Hc,Zc)=>{Hc=Object(Ya.a)(Ta.a,Zc.na);this.X8a(Hc)&&(Zc={},Zc.worksheetId=Hc.sheetId,Zc=oc.a.Ec(Zc),this.vja(11,Hc.sheetId,Zc))};this.e6i=(Hc,Zc)=>{Hc=Object(Ya.a)(Ta.a,Zc.OF);this.X8a(Hc)&&(Zc={},Zc.worksheetId=Hc.sheetId,Zc=oc.a.Ec(Zc),this.vja(12,Hc.sheetId,Zc))};this.c6i=(Hc,Zc)=>{Hc=Object(Ya.a)(Ta.a,Zc.na);this.X8a(Hc)&&(Zc={},Zc.worksheetId=Hc.sheetId,Hc=oc.a.Ec(Zc),this.vja(11,null,Hc,!0))};this.d6i=(Hc,Zc)=>{Hc=Object(Ya.a)(Ta.a,Zc.OF);this.X8a(Hc)&&(Zc={},Zc.worksheetId=Hc.sheetId,
Hc=oc.a.Ec(Zc),this.vja(12,null,Hc,!0))};this.$=Va;this.Gh=bc;this.Wg=yc}Gqb(Va){11===Va.messageType?Va.targetId===ec.a.bL?this.tXg(Va.actionType):this.sXg(Va.actionType):12===Va.messageType&&(Va.targetId===ec.a.bL?this.uXg(Va.actionType):this.vXg(Va.actionType))}sXg(Va){this.$Wf=this.wHa(Va,this.$Wf,this.b6i)}vXg(Va){this.cXf=this.wHa(Va,this.cXf,this.e6i)}tXg(Va){this.aXf=this.wHa(Va,this.aXf,this.c6i)}uXg(Va){this.bXf=this.wHa(Va,this.bXf,this.d6i)}wHa(Va,bc,yc){1===Va?bc=this.b0c(bc,yc):2===Va&&
(bc=this.I9c(bc,yc));return bc}b0c(Va,bc){Va||this.$.ua.Yf(bc);Va++;return Va}I9c(Va,bc){if(1>Va)return Va;1===Va&&this.$.ua.yg(bc);Va--;return Va}X8a(Va){return!!Va&&0===Va.cG}vja(Va,bc,yc,Hc=!1){bc=Hc?ec.a.bL:bc;this.Gh.aN(Va,bc)&&this.Wg.mH(Va,bc,yc)}}Object(c.a)(ne,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var fe=a(243),Bd=a(13),Ue=a(229);class mc extends Sys.EventArgs{constructor(Va,bc,yc,Hc){super();this.sheet=Va;this.N5g=bc;this.offsetX=yc;this.offsetY=Hc}}Object(c.a)(mc,"ClickInActiveCellEventArgs",
Sys.EventArgs,[]);class Fc{constructor(Va,bc,yc){this.g5b=null;this.Zud=!1;this.onPointerDown=Hc=>{let Zc;3===Hc.wb?({h1a:Zc}=this.gridView.Ncc(Hc.clientPoint),this.Zud=!!Zc&&this.gridView.ha.ra.mPe(Zc)):this.Zud=!1;this.g5b=Hc.clientPoint;return!1};this.jd=Hc=>{if(this.gridView.inRangePicker||this.gridView.ei||this.Zud||Hc.shiftKey||Hc.ctrlKey||Hc.Ea.button!==Sys.UI.MouseButton.leftButton||!this.g5b||!Hc.clientPoint||Hc.clientPoint.x!==this.g5b.x||Hc.clientPoint.y!==this.g5b.y)return!1;const Zc=
({h1a:Hc}=this.gridView.Ncc(Hc.clientPoint)).returnValue,Sd=Object(Ya.a)(Ta.a,this.$.ua.na);if(Zc&&Sd&&0===Sd.cG){if(!this.gridView.ha.ra.f4.contains(Hc))return!1;Hc=new mc(Sd,Hc,Ma.HelperMethods.VHd(Zc.x),Ma.HelperMethods.VHd(Zc.y));this.f6i(Hc)}return!1};this.$=Va;this.gridView=ab.h(Va);this.Gh=bc;this.Wg=yc;this.xlj()}dispose(){this.$2j()}xlj(){for(const Va of this.gridView.Cn){const bc=Va.domElement;fe.a.instance.ta(Bd.a.pointerDown,bc,this.onPointerDown);Ue.a.instance.ta(Bd.a.click,bc,this.jd)}}$2j(){for(const Va of this.gridView.Cn){const bc=
Va.domElement;fe.a.instance.Aa(Bd.a.pointerDown,bc,this.onPointerDown);Ue.a.instance.Aa(Bd.a.click,bc,this.jd)}}f6i(Va){var bc=Va.sheet;if(this.X8a(bc)){var yc={};yc.worksheetId=bc.sheetId;yc.address=Va.N5g.toString();yc.offsetX=Va.offsetX;yc.offsetY=Va.offsetY;Va=bc.sheetId;this.Gh.aN(21,Va)&&(bc=oc.a.Ec(yc),this.Wg.mH(21,Va,bc));Va=ec.a.bL;this.Gh.aN(21,Va)&&(yc=oc.a.Ec(yc),this.Wg.mH(21,Va,yc))}}X8a(Va){return!!Va&&0===Va.cG}}Object(c.a)(Fc,"RichApiEventSingleClickedHandler",null,[]);class bd{constructor(Va,
bc,yc){this.mKb=0;this.Ebb=this.Nbb=null;this.CMf=()=>{const Hc=ab.h(this.$).ha.Sa.IA;if(Hc)if(this.Rpf(Hc)){const Zc=this.aka();this.bed(Zc);this.Nbb=Hc.floatingObject.id;this.Ebb=Zc}else this.Nbb&&(this.bed(this.Ebb),this.Ebb=this.Nbb=null);else this.Nbb&&(this.bed(this.Ebb),this.Ebb=this.Nbb=null)};this.$=Va;this.Gh=bc;this.Wg=yc}x2b(Va){2E3===Va.messageType&&(1===Va.actionType?(this.mKb||ab.h(this.$).ha.Sa.DYc(this.CMf),this.mKb++,this.LCj()):2===Va.actionType&&this.mKb&&(1===this.mKb&&ab.h(this.$).ha.Sa.vNd(this.CMf),
this.mKb--))}bed(Va){var bc;const yc={};yc.worksheetId=Va;yc.revisionLoad=!1;if(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(Ja.EwaSettings.xa(616)||Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Hc=ab.h(this.$).ha.Sa.IA;(null===(bc=null===Hc||void 0===Hc?void 0:Hc.floatingObject)||void 0===bc?0:bc.ed)?yc.selectedVisualId=Hc.floatingObject.ed.VisualID:yc.selectedVisualId=null}bc=
oc.a.Ec(yc);Va&&this.Gh.aN(2E3,Va)&&this.Wg.mH(2E3,Va,bc)}aka(){const Va=this.$.ua.na;return Va&&0===Va.cG?Va.sheetId:null}LCj(){const Va=ab.h(this.$).ha.Sa.IA;this.Rpf(Va)&&(this.Nbb=Va.floatingObject.id,this.Ebb=this.aka())}Rpf(Va){return!!Va&&Va.xvd()}}Object(c.a)(bd,"RichApiEventVisualSelectionChangedHandler",null,[]);class de{constructor(Va,bc,yc){this.nKb=0;this.Hqg=!0;this.Jbc=0;this.Std=!0;this.JDe=()=>{const Hc=document.hasFocus();if(this.Hqg!==Hc){if(Hc){const Zc=oc.a.Ec({});this.Wg.mH(2203,
ec.a.bL,Zc)}this.Hqg=Hc}};this.KDe=Hc=>{(0<Hc.timeRemaining()||Hc.didTimeout)&&this.JDe();window.requestIdleCallback(this.KDe)};this.$=Va;this.Gh=bc;this.Wg=yc;window.requestIdleCallback||(this.Std=!1)}rXg(Va){1===Va.actionType?(this.nKb||this.KXg(),this.nKb++):2!==Va.actionType||1>this.nKb||(1===this.nKb&&this.mph(),this.nKb--)}KXg(){if(this.Gh.aN(2203,ec.a.bL))if(this.Std){const Va={};Va.timeout=this.$.ya.CheckFocusTimeout;this.Jbc=window.requestIdleCallback(this.KDe,Va)}else this.Jbc=window.setInterval(this.JDe,
this.$.ya.CheckFocusTimeInterval)}mph(){this.Std?window.cancelIdleCallback(this.Jbc):window.clearInterval(this.Jbc)}}Object(c.a)(de,"RichApiEventWorkbookActivatedHandler",null,[]);var Md;(function(Va){Va[Va.none=0]="none";Va[Va.registerEvent=1]="registerEvent";Va[Va.unregisterEvent=2]="unregisterEvent";Va[Va.customFunction=3]="customFunction";Va[Va.showCard=4]="showCard";Va[Va.createWorkbook=5]="createWorkbook";Va[Va.openWorkbook=6]="openWorkbook";Va[Va.enableEvents=7]="enableEvents";Va[Va.closeWorkbook=
8]="closeWorkbook";Va[Va.setCalculationMode=9]="setCalculationMode";Va[Va.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Va[Va.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Va[Va.workbookLinksEnableContent=12]="workbookLinksEnableContent";Va[Va.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Va[Va.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Va[Va.rangePicker=15]="rangePicker";Va[Va.enableRichApiRecording=16]="enableRichApiRecording";Va[Va.recordAction=
17]="recordAction";Va[Va.focus=18]="focus";Va[Va.businessBarShow=19]="businessBarShow";Va[Va.businessBarHide=20]="businessBarHide";Va[Va.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";Va[Va.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";Va[Va.showRangeValuesPreview=23]="showRangeValuesPreview";Va[Va.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(Md||(Md={}));Object(c.b)("PostProcessActionType",Md);var se=a(258);class tc{constructor(Va,bc,yc){this.ENf=
null;this.$dd=(Hc,Zc)=>{const Sd=ec.a.bL,ue={};ue.eventId=Hc;ue.payload=Zc;this.Gh.aN(2201,Sd)&&this.Wg.mH(2201,Sd,oc.a.Ec(ue))};this.$=Va;this.Gh=bc;this.Wg=yc;this.Uli()}qXg(Va){1===Va.actionType?(this.$.Uba=!0,Object(Ya.a)(a(753).DdaFacade,se.a(this.$)).aed(!0)):2===Va.actionType&&(this.$.Uba=!1);this.ENf=Va.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${Md[Va.actionType]}; controlId: ${this.ENf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Uba}.`)}zwh(Va){Object(Ya.a)(a(753).DdaFacade,
se.a(this.$)).b_e(Va,this.$.Uba)}Uli(){this.$.bR&&Ga.TaskExtensions.za(ob.GetServiceTaskFactory.Pa(this.$.da,297,298,1),Va=>{(Va=Va.result)&&Va.init(this.$dd)},this.$.ka,3)}}Object(c.a)(tc,"RichApiMacroRecorderEventHandler",null,[]);class dd{}Object(c.a)(dd,"StyleCacheItem",null,[]);class Hd{constructor(Va,bc,yc){this.$=Va;this.gridView=bc;this.Zg=yc}Aha(Va){this.range=Va;this.x5b=Array(Va.width);this.lCc=Array.from({length:Va.height},()=>Array(Va.width))}uCj(Va,bc,yc,Hc){this.bof(Va,bc)&&(this.lCc[Va-
this.range.top][bc-this.range.left]||(this.lCc[Va-this.range.top][bc-this.range.left]={backgroundColor:yc.backgroundColor}),yc.backgroundColor=Hc)}wCj(Va,bc,yc){if(this.bof(Va,bc)){Va=kb.Range.Hc(Va,bc);var Hc=this.gridView.Jb(Va);Hc&&(this.x5b[bc-this.range.left]||(this.x5b[bc-this.range.left]=Hc.width),bc=this.Zg.lWd(this.gridView,[Va],yc,!1),"Success"!==bc.kind&&e.ULS.sendTraceTag(509223560,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${bc.reason}`))}}restore(){this.range&&
(this.x5b.forEach((Va,bc)=>{Va=this.Zg.lWd(this.gridView,[kb.Range.Hc(this.range.top,this.range.left+bc)],Va,!1);"Success"!==Va.kind&&e.ULS.sendTraceTag(509220497,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${Va.reason}`)}),this.lCc.forEach((Va,bc)=>{Va.forEach((yc,Hc)=>{Hc=kb.Range.Hc(this.range.top+bc,this.range.left+Hc);if(Hc=this.gridView.Jb(Hc))Hc.cell.backgroundColor=yc.backgroundColor})}),this.x5b=this.lCc=this.range=void 0)}bof(Va,bc){if(!this.range)return e.ULS.sendTraceTag(509223559,
0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),!1;(Va=this.range.contains(kb.Range.Hc(Va,bc)))||e.ULS.sendTraceTag(509223558,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");return Va}}Object(c.a)(Hd,"InstantaneousGridContentRestorer",null,[]);var Xc=a(217),gd=a(135);class je{constructor(Va,bc,yc,Hc){this.W4h=Zc=>{const Sd=Zc.dd.block;if(this.Jt.xe(Sd.Be)){this.RPf([Sd.Be]);const ue=ab.h(this.$).pX(Sd.Be),
Fe=()=>this.KPf([Sd.Be]);setTimeout(()=>{ue.skeletonMode?setTimeout(()=>{ue.skeletonMode?e.ULS.sendTraceTag(509220498,0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time"):Fe()},je.ftg):Fe()},je.Ttg)}};this.KPa=(Zc,Sd)=>{0===Sd.Uq&&576!==Sd.Gf.operation.operationName&&this.Xzb(!0)};this.BFd=Zc=>{this.dBc&&(this.DLh(Zc),this.o0())};this.$=Va;this.Gh=bc;this.Wg=yc;this.gridView=ab.h(this.$);this.Ghc=new Hd(this.$,this.gridView,Hc)}xei(Va,bc,yc,Hc){this.rnf(Va)?
(bc=this.Q3g(bc,yc))?this.GQa?e.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):(this.worksheetId=Va,this.Jt=bc,this.values=yc,this.Foa(Hc)):e.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):e.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}Kci(Va){this.rnf(Va)?
this.Xzb(!1):e.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}Foa(Va){this.RPf(this.E2e());Va&&(e.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(Va)}`),Va.autoexpandTable&&this.U3g(),Va.autofitColumns&&this.u3g());this.dBc=this.gridView.QN.Foa(this.Jt,this.W4h).then(bc=>{e.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");
this.GQa=bc;this.Ghc.Aha(this.Jt);this.KPf(this.E2e());this.$.userOperationManager.jr(this.KPa);bc.I1f.then(()=>this.BFd(!0),()=>this.BFd(!0));return Promise.resolve()},bc=>{e.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${bc}`);this.o0();return Promise.resolve()})}Xzb(Va){this.dBc&&(e.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),
this.dBc.then(()=>{const bc=this.GQa;this.BFd(Va);bc&&bc.Qka("RichApiRangeValuesPreview")},()=>{e.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}Q3g(Va,bc){Va=Cb.ab(Va,this.$.ua);if(Va.returnValue)return new kb.Range(Va.range.top,Va.range.left,Va.range.top+bc.length-1,Va.range.left+bc[0].length-1,!0,!0)}rnf(Va){const bc=this.$.ua.na;return bc&&Va===bc.sheetId}RPf(Va){this.Qed(Va,(bc,yc,Hc,Zc)=>{Zc.cell.Mbb=this.values[bc][yc];
return!0})}KPf(Va){this.Hoa&&this.Qed(Va,(bc,yc,Hc,Zc)=>{this.Ghc.uCj(Hc.top,Hc.left,Zc,this.IYh(Hc.top));return!0});if(this.U_a){const bc=this.Jt.b7a(Va);0<bc.length&&this.U_a&&this.U_a.forEach((yc,Hc)=>{this.Ghc.wCj(bc[0].top,this.Jt.left+Hc,yc)})}}Qed(Va,bc){for(let Hc=0;Hc<this.values.length;++Hc)for(let Zc=0;Zc<this.values[Hc].length;++Zc){const Sd=kb.Range.Hc(this.Jt.top+Hc,this.Jt.left+Zc);if(!Va||Va.some(ue=>ue.contains(Sd))){var yc=this.gridView.wu(Sd);if((!yc||Sd.equals(yc.topLeft))&&(yc=
this.gridView.Jb(Sd))&&!bc(Hc,Zc,Sd,yc))return}}}E2e(){return this.gridView.Ca.iz().filter(Va=>Va.na===this.$.na).map(Va=>Va.Be)}DLh(Va){this.Gh.aN(3400,this.worksheetId)&&(Va=oc.a.Ec({type:"RangeValuesPreviewDismissed",source:"Local",Fdk:Va}),this.Wg.mH(3400,this.worksheetId,Va))}o0(){this.$.userOperationManager.ao(this.KPa);this.Euj();this.Hoa=this.worksheetId=this.dBc=this.values=this.Jt=this.GQa=void 0}U3g(){if(this.Jt){var Va=this.H8h(this.Jt);if(Va){e.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");
var bc=(Sd,ue)=>{var Fe;return null===(Fe=this.gridView.Jb(kb.Range.Hc(Sd,ue)))||void 0===Fe?void 0:Fe.backgroundColor},yc=Va.usedRange.top;if(Va.attributes&16){var Hc=bc(Va.usedRange.top,Va.usedRange.left);++yc}var Zc=bc(yc,Va.usedRange.left);bc=bc(yc+1,Va.usedRange.left);this.Hoa={uig:Va.usedRange.top,ind:Hc,fZj:Zc,$Zg:bc}}else e.ULS.sendTraceTag(509223561,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else e.ULS.sendTraceTag(509227291,
0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}u3g(){this.U_a=Array(this.Jt.width);let Va=!1;this.Qed(void 0,(bc,yc,Hc,Zc)=>{var Sd;if(this.gridView.wu(Hc))return Va=!0,!1;bc=Zc.cell;bc=bc.GHe(bc.Mbb);bc>Zc.width&&(this.U_a[yc]=Object(gd.a)(null!==(Sd=this.U_a[yc])&&void 0!==Sd?Sd:0,bc));return!0});Va&&(this.U_a=void 0)}Euj(){this.Ghc.restore();Cb.z(this.Jt,(Va,bc)=>{Va=kb.Range.Hc(Va,bc);if(Va=this.gridView.Jb(Va))Va.cell.Mbb=
void 0})}IYh(Va){return this.Hoa.ind&&Va===this.Hoa.uig?this.Hoa.ind:0===(Va-this.Hoa.uig-(this.Hoa.ind?1:0))%2?this.Hoa.fZj:this.Hoa.$Zg}H8h(Va){const bc=Xc.b(this.gridView.$,Va,!0);if(!(1<bc.length)){var yc=Zc=>{var Sd;const ue=null!==(Sd=this.gridView.tb.G8h(Zc))&&void 0!==Sd?Sd:this.gridView.tb.I8h(Zc);if(ue)return ue},Hc=yc(Va);if(Hc&&0===bc.length)return Hc;if(0!==bc.length&&(Va=Cb.Y(Va,bc[0].usedRange),1===Va.length))return yc(Va[0])}}}je.Ttg=20;je.ftg=100;Object(c.a)(je,"RichApiRangeValuesPreview",
null,[]);class Ee{}Object(c.a)(Ee,"SessionRecreationInfo",null,[]);class ae{constructor(Va,bc,yc){this.$=Va;this.Gh=bc;this.runtimeCalculationMode=yc}ePi(){return Ja.EwaSettings.xa(234)?this.Gh.Hfi()||0!==this.runtimeCalculationMode:!1}x1g(){var Va={};Va.eventRegistrationInfos=this.Gh.rYh();Va.runtimeCalculationMode=this.runtimeCalculationMode;Va=Object(b.a)(new Ee,{runtimeState:Va});const bc={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};bc.RequestBody=JSON.stringify(Va);
bc.RequestFlags=1;return bc}}Object(c.a)(ae,"RichApiRuntimeStateHandler",null,[]);class Yb{constructor(Va,bc,yc,Hc,Zc,Sd,ue,Fe,Be){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Va;this.processUtcTime=bc;this.dequeueUtcTime=yc;this.inQueueDurationInMS=Hc;this.executionDurationInMS=Zc;this.operationCount=Sd;this.ServerCorrelationId=
ue;this.UserOperationName=Fe;this.IsDocumentHidden=Be}}Object(c.a)(Yb,"UserOperationQueueItemsStatisticsData",null,[]);var Sc=a(335),qd=a(34),Id=a(18),ic=a(302),Gc=a(51),jd=a(603),ed=a(71),Qd=a(60),te=a(77);class xe extends Sc.a{constructor(Va,bc,yc){super(yc,Va);this.uwa=this.hashCode=null;this.h6b=!1;this.Ym=(Hc,Zc)=>{Zc.dd.hash===this.hashCode&&this.uwa&&Object(Ya.a)(a(753).DdaFacade,this.$.da.Ba(35)).$Nj(this.uwa.InstanceId)};this.rf=(Hc,Zc)=>{switch(Zc.dd.block.state){case 1:case 3:case 5:this.oea(Zc)}};
this.Ej=()=>{this.HJb(!0)};this.Go=(Hc,Zc)=>{this.isVisible&&this.JUa(Zc.OF);this.clearCache()};this.Zd=(Hc,Zc)=>{this.MTa(Zc.na,!!Zc.OF)};this.nB=()=>{this.$.ea.Xma()};this.oVa=bc;this.domElement.classList.add(qd.a.fac);this.domElement.classList.add(Id.a.vo);yc.tabIndex=0;this.MTa(this.$.na,!1);this.Gc.la("mousedown",this.nB);this.Gc.la("contextmenu",Hc=>{te.g(Hc)});this.$.ua.sJ(this.Go);this.$.Bb.sJ(this.Go);this.$.Bb.Yf(this.Zd);this.$.ua.Yf(this.Zd);this.Ca.Us(this.rf);this.Ca.TG(this.Ym);this.Ca.dw(this.Ej);
this.ev(this.qza)}get Ca(){return this.oVa}dispose(){this.$&&(this.$.ua.XK(this.Go),this.$.Bb.XK(this.Go),this.$.Bb.yg(this.Zd),this.$.ua.yg(this.Zd));this.oVa&&(this.oVa.Dr(this.rf),this.oVa.rI(this.Ym),this.oVa.Xw(this.Ej));this.ty(this.qza);this.clearCache();ib.a.Ja(this.oVa);this.oVa=null;Wa.DOMElementExtensions.yf(this.domElement);super.dispose()}DCj(Va){Wa.DOMElementExtensions.yf(Wa.DOMElementExtensions.getElementById(this.domElement,Va.id));this.domElement.appendChild(Va)}qpd(){if(this.uwa&&
!this.h6b){var Va=Object(Ya.a)(a(753).DdaFacade,se.a(this.$)).tn(this.uwa.InstanceId);Va&&(Va.resize(this.uwa.Width,this.uwa.Height),Va.la(this.domElement),Va.showHide(!0),this.h6b=!0)}}Z8a(){return!0}oea(Va){this.uwa=Va.dd.block.ae;this.h6b=!1;this.qpd()}JUa(Va){this.$.ea.T4&&Va&&(Va.Tu||(Va.Tu=new ic.a),Va.Tu.ui=new Gc.a(this.domElement.scrollLeft,this.domElement.scrollTop),Va.Tu.$Ib=20)}clearCache(){this.Ca.kRa(this.hashCode);this.uwa=this.hashCode=null;this.h6b=!1}MTa(Va,bc){if(this.isVisible=
!!Va&&ed.o(Va))this.hashCode=this.Ca.Asa(Va,Qd.a.m8b,this.hashCode),this.Mzc(bc)}static xHa(Va){if(!Va.da.Ba(34)){const bc=Va.Bf;Va.da.Ha(34,new xe(Va,new jd.a(Va,Va.ea,Va.pa.Rk,3,0),bc.appendChild(bc.ownerDocument.createElement("div"))))}}}Object(c.a)(xe,"WebExtensionView",Sc.a,[853,515,3]);var He=a(231),We=a(379),ye=a(443),$e=a(198),jf=a(63),gf=a(117),rf=a(49),Mf=a(45),Qa=a(165),Zb=a(116),nb=a(67),Tb=a(28),qb=a(29),Kb=a(255),jc=a(22),Ac=a(14),Jc=a(290),hd=a(757),Cd=a(53),ac=a(158),Lc=a(889);const rd=
Va=>{ac.a.sendOtelEvent(Object.assign(new Lc.a,{otelEvent:Va}))},Yd=Va=>{ac.a.sendOtelCustomerContent(Object.assign(new Lc.a,{otelEvent:Va}))};var ie=a(888),Je=a(25),ff=a(155),Ae=a(735);class pf{constructor(Va,bc,yc){this.$uc=0;this.fpe=new Set;this.$=Va;this.Gh=bc;this.Wg=yc}pXg(Va){1===Va.actionType?this.Gh.aN(65541,ec.a.bL)?this.$uc++:e.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===Va.actionType&&0<this.$uc&&this.$uc--}ySi(Va,bc){if(0===this.$uc)e.ULS.sendTraceTag(509649753,
0,50,"No event listeners. Event not fired.");else if(bc){Va=bc.VG;var yc=[];yc.push({content:JSON.stringify(bc.VG),annotationType:Ae.a.rwa(Va),id:Va.id});this.Wg.mH(65541,ec.a.bL,JSON.stringify({annotationProperties:yc}))}else e.ULS.sendTraceTag(509649752,0,10,"Event args are null")}Ibi(Va){return Object(ff.a)(this,void 0,void 0,function*(){if(!this.Gh.aN(65541,ec.a.bL))e.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!this.fpe.has(Va.annotationType)){var bc=yield ob.GetServiceTaskFactory.n4(this.$.da,
328,327,1);bc.mZa(Va.annotationType);bc.s2(Va.annotationType,this.ySi.bind(this));this.fpe.add(Va.annotationType)}})}Jbi(Va){return Object(ff.a)(this,void 0,void 0,function*(){(yield ob.GetServiceTaskFactory.n4(this.$.da,328,327,1)).mPb(JSON.parse(Va.content));e.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${Va.signalType}`)})}}Object(c.a)(pf,"RichApiAugmentationLoopHandler",null,[]);a.d(B,"DdaFacade",function(){return he});class he extends V.a{constructor(Va,bc,yc){super();this.Wg=
this.zl=this.ea=null;this.sf=[];this.RJa=null;this.disposed=this.initialized=this.fSb=this.GLe=!1;this.eDa=null;this.hsc=[];this.ALe=[];this.pQa=[];this.x2a=null;this.MHd=new ta.a(N.a.li());this.f1b=new O.a(N.a.li());this.GIb=[];this.bPf=[];this.qub=350;this.dya=this.nfa=null;this.wWc=!1;this.HSb=this.olb=this.kke=this.jke=this.$je=this.ike=this.hke=this.fke=this.bke=this.gke=this.cke=this.eke=this.ake=this.dke=null;this.xf=()=>{this.eDa=this.ea.Tm.WebExtensions;for(var Hc=this.sf.length-1;0<=Hc;--Hc){var Zc=
this.sf[Hc],Sd;if(Sd=!this.wLh(Zc.controlId))Sd=Zc,Sd=Ja.EwaSettings.xa(114)?!Sd.jua:!0;Sd&&(Zc.cqc(),this.sf.splice(Hc,1))}if(this.eDa)for(let ue=0,Fe=this.eDa.length;ue<Fe;ue++)Hc=this.eDa[ue],(Zc=this.tn(Hc.WebExtensionId))&&Zc.fFd(Hc)};this.grc=Hc=>{this.raiseEvent("csc",Hc.getID())};this.jrc=(Hc,Zc,Sd)=>{if(Zc===OSF.AgaveHostAction.KeyboardShortcuts){var ue=Object(Ya.a)(Object,Sd);Zc={};Zc.keyCode=ue.keyCode;Zc.type="keydown";Zc.ctrlKey=ue.ctrlKey;Zc.shiftKey=ue.shiftKey;Zc.altKey=ue.altKey;
Zc.metaKey=ue.metaKey;ue=this.tn(Hc);Hc=ue.m$;Zc.srcElement=Object(Da.a)(504,Hc)?Hc.gHa:ab.h(this.$).mc;Hc=new Sys.UI.DomEvent(Zc);ue=he.Cva(ue.xl,this.$);Zc={};Zc.focusedAddinId=ue;ue=new fb.a(1461300262,1,this.$.xc,6,null);ab.h(this.$).$Lb(Hc,ue,Zc)}else if(Zc===OSF.AgaveHostAction.Select)this.dbf(!0);else if(Zc===OSF.AgaveHostAction.UnSelect)this.dbf(!1);else if(Zc===OSF.AgaveHostAction.CancelDialog)this.kK(-684355545,null);else if(Zc===OSF.AgaveHostAction.InsertAgave)Hc={},Sd&&(this.olb=Sd,Hc[T.a.V9]=
Sd,Hc[Wb.a.Sf]=this.XIa(Sd),this.kK(-741808261,Hc));else if(Zc===OSF.AgaveHostAction.ClickTrust)this.GZc&&Sd&&(this.olb=Sd);else if(Zc===OSF.AgaveHostAction.OsfControlLoad)this.GZc&&this.olb&&Sd&&this.tWg(this.olb,Sd)&&Sd.storeType&&(this.olb=null,this.HR(bb.b(Sd.storeType)));else if(Zc===OSF.AgaveHostAction.InsertDevManifest)Hc={},Sd&&(Hc[T.a.V9]=Sd,Hc[Wb.a.Sf]=this.XIa(Sd),this.kK(-741808261,Hc));else if(Zc===OSF.AgaveHostAction.InsertDevManifestError)Hc=Object(Ya.a)(Object,Sd),Hc={[T.a.rZc]:this.zl.getDevManifestInvalidUrlErrorString(Hc.manifestUrl)},
this.kK(-2025863019,Hc);else if(Zc===OSF.AgaveHostAction.NotifyHostError)Hc={[T.a.rZc]:this.zl.getManifestInvaildErrorString()},this.kK(-2025863019,Hc);else if(Zc===OSF.AgaveHostAction.RefreshAddinCommands)Ja.EwaSettings.xa(52)&&this.kK(Je.a.refreshAddinCommands,null);else if(Zc===OSF.AgaveHostAction.CtrlF6Exit||Zc===OSF.AgaveHostAction.CtrlF6ExitShift){if(ue=this.$.da.Ba(15)){(Hc=this.tn(Hc).m$)&&Hc.dCc();t.a.Ff&&document.activeElement.blur();var Fe={keyCode:117,type:"keydown",ctrlKey:!0};Fe.shiftKey=
Zc===OSF.AgaveHostAction.CtrlF6ExitShift;Fe.srcElement=Object(Da.a)(504,Hc)?Hc.gHa:ab.h(this.$).mc;Hc=new Sys.UI.DomEvent(Fe);ue.Oma(Hc)}}else if(Zc===OSF.AgaveHostAction.PageIsReady){if((Hc=this.tn(Hc).m$)&&Hc.h_a===OSF.OsfControlTarget.TaskPane&&(Hc=this.$.da.Ba(183))&&this.sf){Zc=ma.a.Gd(this.$);for(ue of this.sf)he.XMa(ue.YP)&&(Zc?Hc.eg(!0,!1):Hc.setFocusOnToolbarFirstElement())}}else if(Zc===OSF.AgaveHostAction.TabExit){Zc=this.tn(Hc);const Rb=Zc.m$;if(Rb)if(Rb.h_a===OSF.OsfControlTarget.InContent)Rb.Qqf();
else{if(Rb.h_a===OSF.OsfControlTarget.TaskPane)if(ma.a.Gd(this.$))t.a.Ff&&document.activeElement.blur(),Ba.UISurfaces.mj().then(sc=>{const Mc=Object(Da.a)(504,Rb)?Rb:null;Mc?Mc.isResizable?sc.focusResizeHandle():sc.focusTabbedTaskPaneArea():sc.focusTabbedTaskPaneArea();return null});else if(Zc=this.$.da.Ba(183))t.a.Ff&&document.activeElement.blur(),(Hc=document.getElementById(this.$.Cb+Z.a.ipc))&&Wa.DOMElementExtensions.isVisible(Hc)?Wa.DOMElementExtensions.setFocus(Hc):Zc.setFocusOnToolbarFirstElement()}else Zc&&
4===Zc.osfControlType&&this.zl.notifyAgave(Hc,OSF.AgaveHostAction.TabIn)}else if(Zc===OSF.AgaveHostAction.TabExitShift)(Zc=this.tn(Hc),ue=Zc.m$)?ue.h_a===OSF.OsfControlTarget.InContent?ue.Rqf():ue.h_a===OSF.OsfControlTarget.TaskPane&&(Hc=Object(Da.a)(504,ue)?ue:null)&&(t.a.Ff&&document.activeElement.blur(),Hc.v7f()):Zc&&4===Zc.osfControlType&&this.zl.notifyAgave(Hc,OSF.AgaveHostAction.TabIn);else if(Zc===OSF.AgaveHostAction.EscExit||Zc===OSF.AgaveHostAction.ExitNoFocusable||Zc===OSF.AgaveHostAction.ExitNoFocusableShift)if(ue=
this.tn(Hc).m$)ue.dCc();else{if(Zc===OSF.AgaveHostAction.EscExit){Zc=null;for(Fe of G.fai())if(Fe.value.we===Hc){Fe.value.dialog.hide();Zc=Fe.key;break}Zc&&(Hc=this.tn(Zc))&&4!==Hc.osfControlType&&this.Lg.notifyAgave(Zc,OSF.AgaveHostAction.TabIn)}}else if(Zc===OSF.AgaveHostAction.InstallCustomFunctions)if(Ja.EwaSettings.xa(114)){nb.a(this.$).p0e(()=>!1);var Be=this.$.da;Ga.TaskExtensions.za(ob.GetServiceTaskFactory.Pa(Be,278,279,1),Rb=>{Rb=Rb.result;Be.Ba(278)||Be.Ha(278,Rb);const sc=Sd.osfControl.getStoreType();
Rb.zhf(Sd.osfControl.getSolutionId(),sc,he.GWh(Sd.osfControl),Sd).Tna()},this.ka,3)}else e.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Zc===OSF.AgaveHostAction.UninstallCustomFunctions)if(Ja.EwaSettings.xa(114)){nb.a(this.$).p0e(()=>!1);var Ua=this.$.da;Ga.TaskExtensions.za(ob.GetServiceTaskFactory.Pa(Ua,278,279,1),Rb=>{Rb=Rb.result;Ua.Ba(278)||Ua.Ha(278,Rb);Rb.Ekg(Sd.solutionId,Sd.storeType).Tna()},this.ka,
3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Zc===OSF.AgaveHostAction.SendTelemetryEvent?rd(Sd):Zc===OSF.AgaveHostAction.SendCustomerContent?Yd(Sd):Zc===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.kDi(Sd):Zc===OSF.AgaveHostAction.RefreshRibbonGallery?(Hc=this.$.da.Ba(519))&&Hc.pmd(Sd):Zc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.enj(Sd.solutionId),ma.a.Gd(this.$)||(Hc=this.$.da.Ba(183))&&
Hc.KB(),Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&m.AFrameworkApplication.rb.$d(Je.a.tXf,2,Sd.solutionId)):Zc===OSF.AgaveHostAction.GetOriginalControlId&&(Hc=new Za.a(this.$.Cb,Sd.ownerAddinSolutionId,new ja.a,!0),Sd.originalControlId=Hc?Hc.ULe(Sd.controlId):Sd.controlId)};this.CAj=(Hc,Zc)=>{const Sd=Array(2);Sd[0]=Zc;Sd[1]=null;this.Wg.HLh(Hc,JSON.stringify(Sd))};this.L5i=()=>{this.$.na&&ed.o(this.$.na)&&this.$.da.Ba(34).qpd()};
this.od=()=>{this.Ssf()};this.AR=(Hc,Zc)=>{var Sd,ue;1===Zc.Uq&&(Hc=Zc.Gf)&&(Zc=new Yb(Zb.toTimestamp(Hc.enqueueUtcTime),Zb.toTimestamp(Hc.processUtcTime),Zb.toTimestamp(Hc.dequeueUtcTime),Zb.getElapsedMilliseconds(Hc.enqueueUtcTime,Hc.processUtcTime),Zb.getElapsedMilliseconds(Hc.processUtcTime,Hc.dequeueUtcTime),Hc.operationCount,(null===(ue=null===(Sd=Hc.operation)||void 0===Sd?void 0:Sd.zd)||void 0===ue?0:ue.ServerCorrelationId)?Hc.operation.zd.ServerCorrelationId:null,Hc.operation?Enum.toString(ye.a,
Hc.operation.operationName):null,hd.a.JH(Zb.getElapsedMilliseconds(Hc.enqueueUtcTime,Tb.a.Ya.Zb))),Sd=Sys.Serialization.JavaScriptSerializer.serialize(Zc),e.ULS.sendTraceTag(50872916,0,50,Sd))};this.Wc=(Hc,Zc)=>{!this.ea.Yb&&He.a(Zc)?(Array.forEach(this.sf,this.cEf),this.sf.length=0,this.fSb=!1):(Zc.GH&&(e.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.$0f()),this.$K(),Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(this.fSb=!1))};this.Io=()=>{Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.$0f());this.$K();Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.fSb=!1)};this.cEf=Hc=>{Hc.cqc();this.raiseEvent("cd",Hc.controlId)};this.mb=Va;this.JZc=bc;this.initialize(yc);wb.la(this);this.g2f=0;(Va=(Va=!(t.a.lp||t.a.Wba))&&(!Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||
!t.a.Ff))&&OfficeExt.ShortcutKeyDispatchManager.init();this.GBg={}}get j2b(){return this.nfa||(this.nfa=new Ea.a(this.$.nv))}kse(Va){this.addHandler("cd",Va)}eoj(Va){this.removeHandler("cd",Va)}vPg(Va){this.addHandler("csc",Va)}goj(Va){this.removeHandler("csc",Va)}sPg(Va){this.addHandler("ca",Va)}doj(Va){this.removeHandler("ca",Va)}tPg(Va){this.addHandler("ci",Va)}uPg(Va){this.addHandler("ekros",Va)}foj(Va){this.removeHandler("ekros",Va)}oHd(Va,bc){try{return JSON.parse(Va)[bc].toLowerCase()}catch(yc){return""}}sJj(Va){const bc=
this.oHd(Va,"AudienceGroup"),yc=this.oHd(Va,"SessionOrigin");try{const Hc=parseInt(this.oHd(Va,"Ring"),10);if("automation"!==bc&&"bluechicken"!==yc&&-2<=Hc)return!0}catch(Hc){if("automation"!==bc&&"bluechicken"!==yc)return!0}return!1}get Lg(){if(!this.zl){const Va={},bc=!(this.$.Bd&1),yc=Pa.a.current.SK,Hc=this.$.workbookContext,Zc=pa.a.nL+pa.a.D5b;Va.pageBaseUrl=yc.LayoutsContentUrlPrefix;Va.appName=OSF.AppName.ExcelWebApp;Va.appVersion="16";Va.appSettings=this.G_h();Va.singleSignOnSettings=E.AppsForOfficeSingleSignOnManager.G7h();
Va.clientMode=bc?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Va.appUILocale=this.$.ya.UICultureTag;Va.dataLocale=this.$.ya.DataCultureTag;Va.docUrl=Hc.ClientUrl;Va.hostControl=this;Va.formFactor=OSF.FormFactor.Default;Va.lcid=this.$.pG.toString();Va.localizedScriptsUrl=pa.a.nL+pa.a.m5c;Va.localizedImagesUrl=Zc;Va.localizedStylesUrl=pa.a.nL+pa.a.LGe;Va.localizedResourcesUrl=Zc;Va.osfOmexBaseUrl=yc.OsfOmexBaseUrl;Va.firstPartyManifestCDNUrl=yc.FirstPartyAddInManifestCDN;Va.sdxAssetsToPrefetchMapping=
m.AFrameworkApplication.fa.Wa("SdxAssetsToPrefetchMapping");Va.sdxCdnUrl=yc.SdxCdnUrl;Va.sdxDmsUrl=yc.SdxDmsUrl;Va.devCatalogUrl=yc.DevCatalogUrl;Va.controlStatusChanged=this.grc;Va.notifyHost=this.jrc;Va.allowExternalMarketplace=this.$.ea.Dg.get(27)&&he.p6b;Va.enableAddinCommands=Ja.EwaSettings.xa(52);Va.enableBlackForestRedirect=Ja.EwaSettings.xa(87);Va.enableMyOrg=this.$.ea.Dg.get(33);Va.enableMyApps=this.$.ea.Dg.get(34);Va.enableDevCatalog=Ja.EwaSettings.xa(43);Va.enablePrivateCatalog=this.oKj();
Va.showSignOutFromPrivateCatalogMessage=this.$.ea.Dg.get(36);Va.enableUploadFileDevCatalog=Ja.EwaSettings.xa(52)&&!Ja.EwaSettings.xa(254);Va.userNameHashCode=S.a.mu(m.AFrameworkApplication.userName);Va.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();Va.enableSingleSignOnForAddin=!Ja.EwaSettings.xa(23)&&m.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Va.enableDisplayBlockedMinorError=Ja.EwaSettings.xa(171);Va.hideAppsExtensionUrl=m.AFrameworkApplication.hideAppsExtensionUrl;
Va.enableAnonymousUseLegacyCatalogService=Ja.EwaSettings.xa(162);Va.enableInsertDialogAccessibilityFix=Ja.EwaSettings.xa(169);Va.disableAppsForOfficeThirdParty=Ja.EwaSettings.xa(174);Va.enableFirstPartySSO=Ja.EwaSettings.xa(186);Va.wacSessionId=this.$.ya.UserSessionId;Va.disableLogging=!this.$.ya.AriaLoggingIsEnabled;Va.enableFirstPartySDXErrorMessages=Ja.EwaSettings.xa(198);Va.enableRichApiCellEditDelay=Ja.EwaSettings.xa(178);Va.isHostDocumentDomain=Ja.EwaSettings.xa(209);Va.loggableUserId=m.AFrameworkApplication.fa.Wa("LoggableUserId");
Va.sessionStartInfoJson=m.AFrameworkApplication.fa.Wa("SessionStartInfoJson");Va.wopiHostOriginFromPostMessage=m.AFrameworkApplication.wopiHostOriginFromPostMessage;Va.wopiHostOriginFromWacPropBag=m.AFrameworkApplication.fa.Wa("PostMessageOrigin");Va.wacIsEmbedded=m.AFrameworkApplication.fa.qa("IsEmbedded");Va.accessibilityAllowFocusAddinTaskpane=m.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");Va.enableRemoveAppCommandsAddin=m.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");
Va.isHostFrameTrustCheckEnabledForAddIns=m.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");Va.isHostFrameTrusted=m.AFrameworkApplication.isHostFrameTrusted;Va.agaveAddinUploadEnabled=Ja.EwaSettings.xa(45);Va.hostAllowedOfficeStore=m.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");Va.hostAllowedSdxEmbedding=m.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");Va.hostInstallAddIns=m.AFrameworkApplication.fa.Wa("HostInstallAddIns");Va.hostInstallAddInsIsEnabled=m.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");
Va.approvedAddIns=m.AFrameworkApplication.fa.Wa("ApprovedAddIns");Va.addinEnforceHttpsIsEnabled=this.sJj(Va.sessionStartInfoJson);Va.hostFeatureGateFlag=0;Va.isUpnCheckEnabled=m.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");Va.wacUpn=m.AFrameworkApplication.fa.Wa("UserPrincipalName");Va.isReactRibbonEnabled=ma.a.isReactRibbonEnabled();Va.enableSetFocusOnTaskpaneOnUserAction=Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Va.isSafariWithIndexedDBDisabled=
Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&t.a.JNa;Va.isIndexedDBDisabled=Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&t.a.JNa||Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&t.a.Ff;Va.enableCustomShortcuts=!0;Va.changeGetModifierKeyStringOutputOrder=Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Va.officeJsUrl=m.AFrameworkApplication.jO("OfficeJs/excel.js",5);
Va.enableOfficeJsUrlParam=Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.zl=new OSF.ContextActivationManager(Va);this.zl.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.zl.setWSA(m.AFrameworkApplication.Kn);this.zl&&"undefined"!==typeof this.zl.hostCheckReadyHandler&&m.AFrameworkApplication.rQg(Object(d.a)(this.zl,this.zl.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const Sd=$a.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.zl.setOAuthManager(Sd)}catch(Sd){}}return this.zl}get Cak(){return this.wWc}get Gh(){return this.dke}get Pna(){return this.ake}get lQd(){return this.eke}get kQd(){return this.cke}get Dvj(){return this.gke}get Bvj(){return this.bke}get Cvj(){return this.fke}get Evj(){return this.hke}get Fvj(){return this.ike}get mQd(){return this.jke}get f2f(){return this.kke}get rV(){return this.GBg}get $(){return this.mb}get jQd(){return this.$je}R2b(Va){const bc={};bc.Name=Va.Name;bc.BindingType=Va.BindingType;
bc.HasHeaders=Va.HasHeaders;Va.IsValidRef&&(bc.ColCount=Va.Reference.LastColumn-Va.Reference.FirstColumn+1,bc.RowCount=Va.Reference.LastRow-Va.Reference.FirstRow+1);return bc}get sZc(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)}gsf(Va,bc){const yc=this.z0g(bc);let Hc=null;if(m.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==bc&&"LaunchAddinDialogFromTellMe"===bc[0])null!==yc.assetId&&"undefined"!==typeof yc.assetId&&(Hc="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.sZc){const Zc=this.$.ea.Dg.get(27);Zc&&null!==bc&&"InsertMoreAddInsFromFooter"===bc[0]?Hc="{98143890-AC66-440E-A448-ED8771A02D52}":Zc&&null!==bc&&"AddinFlyoutMoreButton"===bc[0]&&(Hc="0")}this.zl.launchInsertDialog(Va,Hc,yc)}get lha(){return this.Gpb}get Gpb(){this.GZc&&
!this.HSb&&(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7611171_AddinDetailsManagerConfigEnabled")?this.HSb=new xa(m.AFrameworkApplication.fa,new ba.a(()=>this.zl),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.hhg,["AreThirdPartyAddInsAllowed"]:this.$.AP,["PopularAddinDetailsJsonString"]:he.XIb}):this.HSb=new xa(new cb.a({["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace.toString(),["AppsForOfficeThirdPartyIsDisabled"]:this.hhg.toString(),
["AreThirdPartyAddInsAllowed"]:this.$.AP.toString(),["PopularAddinDetailsJsonString"]:he.XIb}),new ba.a(()=>this.zl)));return this.HSb}get hhg(){return Ja.EwaSettings.xa(174)}get allowExternalMarketplace(){return this.$.ea.Dg.get(27)}get GZc(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}static get XIb(){return'[{"displayName":"Bing Maps","solutionId":"wa102957661","version":"1.5.0.0","description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1770}},{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":20064}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":40}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":359}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1369}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.4.0.0","description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674774/Asset_733b35d6-e5e0-4163-b45d-3396185864bd/WIKIPEDIAAPPFOROFFICELICENSETE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":368}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":1,"AUP":3146}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1364}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":68}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":6262}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":673}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":2790}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":588}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":358}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"wa104380330","version":"1.3.0.1","description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":597}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":1812}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"wa104380662","version":"1.0.0.7","description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":1,"AUP":434}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":353}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":-1,"AUP":1299}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":371}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":297}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":935}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1421}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":373}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":8162}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":192}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":696}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":382}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":10559}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":-1,"AUP":1674}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1315}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":640}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":441}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","description":"Use Microsoft Excel\u2019s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":2,"AUP":1112}},{"displayName":"iServer365 Import Tool","solutionId":"wa200000421","version":"2.1.4.7","description":"Import data from Excel Workbooks to your iServer365 Repository","iconUrl":"31253.df1e5367-d9bc-46a7-8259-9b24225f294e.24914354-af15-4aa0-8ead-1c9d3e44a16d.8c184953-6f7c-4728-add7-e9aa9aa1c7a1.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":471}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":83858}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","version":"1.0.0.58","description":"Build your models in Excel using Refinitiv\u2019s unique content and analytics","iconUrl":"22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":356}},{"displayName":"Money in Excel","solutionId":"wa200001306","version":"2.3.0.1","description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.aspx","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":1382}},{"displayName":"McGraw Hill","solutionId":"wa200002270","version":"3.0.0.0","description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":2,"AUP":118855}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1991}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":272}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","description":"Strengthen your analysis and build better financial models using PitchBook\u2019s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":768}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":129}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":185}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","version":"1.1.0.0","description":"Create, edit, and reuse formulas.","iconUrl":"42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":382}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":404}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":403}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":2501}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":120}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.0.0","description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":120}},{"displayName":"AI Formula Generator Bot for Excel","solutionId":"wa200004935","version":"1.0.0.0","description":"Transform your text instructions into Excel formulas in seconds with the help of AI.","iconUrl":"15321.02bef729-7dee-4518-80a6-f1201acff812.20f898b8-6e94-4547-b2c1-2680aff4db58.e0447c81-0b85-428e-8e98-0c3ecefac08c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://excelformulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":286}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":19}}]'}HR(Va,
bc){this.Gpb&&this.Gpb.HR(Va,bc)}Tuc(Va){this.Gpb&&this.Gpb.Wuc(Va)}tWg(Va,bc){return N.a.li().equals(Va.solutionId,bc.solutionId)&&N.a.li().equals(Va.storeType,bc.storeType)}Bda(Va,bc){if(m.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.GSf(Va,bc,OSF.StoreTypeEnum.MarketPlace);else{const yc={};yc.callbackFunc=Va;yc.storeType=OSF.StoreTypeEnum.MarketPlace;yc.fromInsertDialog=!1;yc.refresh=bc;this.zl.queryEntitlementDetails(yc)}}GSf(Va,bc,yc){const Hc=
{};Hc.callbackFunc=Va;Hc.storeType=yc;Hc.fromInsertDialog=!1;Hc.refresh=bc;this.zl.queryEntitlementDetails(Hc)}invokeDdaMethod(Va,bc){const yc=this.tn(Va.DdaMethod.ControlId);yc?yc.invokeDdaMethod(Va,bc):this.Cf(Eb.a.internalError,bc)}registerDdaEventAsync(Va,bc,yc,Hc,Zc){(bc=this.tn(bc))?he.FBb(Va)?bc.Wjj(Va,yc,Hc,Zc):this.Cf(Eb.a.FGd,Zc):this.Cf(Eb.a.internalError,Zc)}unregisterDdaEventAsync(Va,bc,yc,Hc,Zc){(bc=this.tn(bc))?he.FBb(Va)?bc.B2j(Va,yc,Hc,Zc):this.Cf(Eb.a.FGd,Zc):this.Cf(Eb.a.internalError,
Zc)}dispose(){this.disposed||(this.$.em(this.od),this.ea.pk(this.Wc),this.ea.MR(this.Io),this.ea.Lv(this.xf),this.JZc.detach(this),this.$.userOperationManager.ao(this.AR),this.hsc=this.sf=this.Wg=this.JZc=this.mb=null,this.RJa&&(this.RJa.dispose(),this.RJa=null),ib.a.Ja(this.lQd),ib.a.Ja(this.kQd),this.x2a&&(this.x2a.dispose(),this.x2a=null),super.dispose(),this.disposed=!0,e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}khd(Va){return(Va=this.tn(Va))?Va.getDefaultIconUrl():null}kzc(Va){if(this.GLe!==
Va){this.GLe=Va;for(let bc=0,yc=this.sf.length;bc<yc;bc++){const Hc=this.sf[bc];Va?Hc.fOe(!1):Hc.nvh()}this.lQd.kzc(Va);this.kQd.kzc(Va)}}aXh(Va){return(Va=this.tn(Va))?Va.getDefaultDisplayName():null}Cf(Va,bc,yc=!0){const Hc={};Hc[Wb.a.Sf]=Va;Hc[Wb.a.w3]=bc;this.kK(451041795,Hc,yc)}uv(Va){const bc={};bc[Wb.a.w3]=Va;this.kK(1237877382,bc)}kK(Va,bc,yc=!0){const Hc=new fb.a(Va,0,this.$.xc,0,null),Zc=bc?bc[Wb.a.w3]:null;this.x2a&&ab.h(this.$).eb&&Ab.w$g(Va,bc)?this.x2a.coh(Va,bc):(Va=this.$.Ia.Hb(Hc,
bc),yc&&Ga.TaskExtensions.za(Va,Sd=>{Qa.a(Sd)?this.Cf(Eb.a.internalError,Zc,!1):Sd.result||(ab.h(this.$).eb?this.Cf(Eb.a.UAb,Zc,!1):this.Cf(Eb.a.internalError,Zc,!1))},this.ka,8))}Xbh(Va){return!!this.uja(bc=>he.getSolutionId(bc.xl,this.$)===he.getSolutionId(Va,this.$)&&bc.xl.PrimaryMarketplace.MarketplaceType===Va.PrimaryMarketplace.MarketplaceType&&bc.xl.PrimaryMarketplace.MarketplaceRef===Va.PrimaryMarketplace.MarketplaceRef&&bc.xl.PrimaryMarketplace.SolutionVersion===Va.PrimaryMarketplace.SolutionVersion)}tn(Va){return this.uja(bc=>
bc.controlId.startsWith(Va))}kLh(Va){return this.uja(bc=>bc.jua===Va)}BZe(Va){return this.uja(bc=>bc.YP===Va&&!!bc.jua)}RZe(Va,bc,yc,Hc){return this.uja(Zc=>Zc.YP===Va&&Zc.xl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===bc.toLowerCase()&&Zc.xl.PrimaryMarketplace.MarketplaceType.toLowerCase()===yc.toLowerCase()&&!!Zc.xl.SharedRuntime&&!!Zc.xl.SharedRuntime.Resid&&!!Hc&&!!Hc.Resid&&Zc.xl.SharedRuntime.Resid.toLowerCase()===Hc.Resid.toLowerCase())}dXg(Va,bc){if(Va=this.tn(Va))Va.la(bc),Va.showHide(!0)}$Nj(Va){(Va=
this.tn(Va))&&Va.showHide(!1)}VIa(Va){var bc;if(1!==Va.WebExtensionType||this.$.Bd&8388608&&Va.TaskpaneVisible||this.$.Bd&8388608&&!Va.TaskpaneVisible&&Ma.HelperMethods.Aw(Va)){let yc=null;Ma.HelperMethods.Aw(Va)&&(yc=he.Cva(Va,this.$),Va.TaskpaneWidth||(Va.TaskpaneWidth=this.qub));const Hc=(new nc(this,this.Wg,Va)).dpd();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Va.PrimaryMarketplace.SolutionId,Va.OwnerAddinStoreType||
Va.PrimaryMarketplace.MarketplaceType,null===(bc=Va.AssetMarketplace)||void 0===bc?void 0:bc.SolutionId,null,null,Va.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Va.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ma.HelperMethods.Aw(Va)}`);yc&&(Hc.jua=yc);this.sf.push(Hc);this.dya=null;this.h7a(Va.InstanceId)||(Va=String.format("{0}|{1}|{2}|{3}|{4}",Va.PrimaryMarketplace.SolutionId,Va.PrimaryMarketplace.SolutionVersion,Va.PrimaryMarketplace.MarketplaceRef,Va.PrimaryMarketplace.MarketplaceType,
Va.WebExtensionType),this.raiseEvent("ci",Va))}}FPj(Va,bc){Va.TaskpaneWidth=this.qub;Va.TaskpaneVisible=!0;const yc={};yc.SolutionId=Va.PrimaryMarketplace.SolutionId;yc.TargetType=Va.WebExtensionType;yc.Version=Va.PrimaryMarketplace.SolutionVersion;yc.StoreType=Va.PrimaryMarketplace.MarketplaceType;yc.StoreId=Va.PrimaryMarketplace.MarketplaceRef;Va.AssetMarketplace?(yc.AssetId=Va.AssetMarketplace.SolutionId,yc.AssetStoreId=Va.AssetMarketplace.MarketplaceRef):(yc.AssetId=null,yc.AssetStoreId=null);
yc.Width=Va.TaskpaneWidth;const Hc=new nc(this,this.Wg,Va,!0);Hc.dpd();this.sf.push(Hc);const Zc=()=>{this.mRa(Hc.controlId);this.Lg.purgeOsfControl(Hc.controlId,!1);bc()};let Sd=null;Sd=rf.a.instance.GC(()=>{Hc.oy&&(ib.a.Ja(Sd),Sd=null,this.Lg.insertBlankControlWithErrorUX(this.hJb(Hc,yc),Zc))},100,Mf.a.Smh)}Vfh(Va){if(Va&&Va.length){var bc=[];Va.forEach(yc=>{if(yc.ContainsCustomFunctions){const Hc=he.Cva(yc,this.$);this.MHd.contains(Hc)||(this.MHd.add(Hc),this.bPf.push(yc));this.Xbh(yc)||bc.push(yc)}});
bc.length&&this.NIe(bc)}}NKe(Va,bc){this.tn(Va.InstanceId)||(bc=bc(),Va=(new nc(this,this.Wg,Va)).xgf(bc),this.sf.push(Va),this.dya=null)}tNj(Va){he.q2a.kb(Va)&&he.q2a.ma(Va).initializeAndShowWithTitle()}Egi(Va){he.q2a.kb(Va)&&he.q2a.ma(Va).hide()}f3h(Va){var bc=null;let yc,Hc,Zc=null;yc=he.qld(Va,!0);if(!yc)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),zb.Task.Ta(null);(Hc=this.zl.getOsfControl(he.getSolutionId(yc,this.$)))&&
(bc=Hc.getManifest())&&(Zc=bc.getSharedRuntimeForCustomFunctions("Workbook"));if(bc=Zc&&1===Zc.LifeTime?this.RZe(yc.PrimaryMarketplace.SolutionId,yc.PrimaryMarketplace.MarketplaceRef,yc.PrimaryMarketplace.MarketplaceType,Zc):this.kLh(Va))return zb.Task.Ta(bc.controlId);const Sd=new ya.a;Ma.HelperMethods.tlc(Zc)&&(yc.SharedRuntime=Zc);Va=Hc?Hc.getNotificationParams():[];if(!Va.length)return this.qJe(yc);this.Wag(Va,()=>{Ga.TaskExtensions.za(Sd.task,()=>{this.qJe(yc)},this.ka,3)},()=>{});return Sd.task}URh(Va){Va=
he.qld(Va,!1);if(!Va)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let bc=null;var yc=this.zl.getOsfControl(he.getSolutionId(Va,this.$));yc&&(yc=yc.getManifest())&&(bc=yc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Ma.HelperMethods.tlc(bc)&&(Va=this.RZe(Va.PrimaryMarketplace.SolutionId,Va.PrimaryMarketplace.MarketplaceRef,Va.PrimaryMarketplace.MarketplaceType,bc))?Va.controlId:null}leh(Va,bc){var yc=he.qld(Va,!1);if(yc){var Hc=
null,Zc=this.zl.getOsfControl(he.getSolutionId(yc,this.$));Zc&&(Zc=Zc.getManifest())&&(Hc=Zc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Ma.HelperMethods.tlc(Hc)){yc.SharedRuntime=Hc;var Sd=yc.PrimaryMarketplace.SolutionId;Zc=yc.PrimaryMarketplace.SolutionVersion;var ue=OSF.OsfManifestManager.getCachedManifest(Sd,Zc);if(ue)if(this.f1b.kb(Va))Hc=this.f1b.ma(Va),Ga.TaskExtensions.za(Hc,Ua=>{(Ua=Ua.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Ua,bc,this.Wg.MMb)},
this.ka,3);else{var Fe={};Fe.solutionId=Sd;Fe.version=Zc;Fe.storeType=yc.PrimaryMarketplace.MarketplaceType;Fe.storeId=yc.PrimaryMarketplace.MarketplaceRef;yc.AssetMarketplace?(Fe.assetId=yc.AssetMarketplace.SolutionId,Fe.assetStoreId=yc.AssetMarketplace.MarketplaceRef):(Fe.assetId=null,Fe.assetStoreId=null);Fe.targetType=OSF.OsfControlTarget.TaskPane;var Be=new ya.a;yc=Ga.TaskExtensions.Yj();yc=new la.a(this.$,this,Fe,yc);Hc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Sd,Hc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(ue,
Hc,Zc);yc.createUILessSandbox(Fe,ue,(Ua,Rb)=>{Ua&&!Rb?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Ua,bc,this.Wg.MMb),Be.setResult(Ua)):Be.setResult(null);this.f1b.remove(Va)});this.f1b.ia(Va,Be.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}yDe(Va){(Va=this.BZe(Va))&&(Va.xl.SharedRuntime||this.xKb(Va.controlId))}xKb(Va){(Va=this.BZe(Va))&&this.mRa(Va.controlId)}Urh(Va,bc){if(!this.sf||!Va||!bc)return!1;
if(Va.toLowerCase()===bc.toLowerCase())return!0;let yc=null,Hc=null;for(let Zc=0,Sd=this.sf.length;Zc<Sd;Zc++){const ue=this.sf[Zc];if(ue.ownerAddinSolutionId&&(ue.controlId===Va&&(yc=ue.ownerAddinSolutionId.toLowerCase()),ue.controlId===bc&&(Hc=ue.ownerAddinSolutionId.toLowerCase()),yc&&Hc))break}return yc&&yc===Hc?!0:!1}WMg(Va){this.tn(Va.InstanceId)||(Va=new nc(this,this.Wg,Va),this.sf.push(Va),this.dya=null)}XXf(Va){if(this.sf&&0<=Va&&Va<this.sf.length){const bc=this.sf[Va],yc=bc.oy;this.sf.splice(Va,
1);this.cEf(bc);Wa.DOMElementExtensions.yf(yc)}}mRa(Va){if(this.sf)for(let bc=0,yc=this.sf.length;bc<yc;bc++)if(this.sf[bc].controlId===Va){this.XXf(bc);break}}enj(Va){if(this.sf){Va=Va.toLowerCase();for(let bc=0,yc=this.sf.length;bc<yc;bc++)if(Va===this.sf[bc].ownerAddinSolutionId.toLowerCase()){this.XXf(bc);break}}}JXg(Va){Va.Mi&&(this.tn(Va.floatingObject.xl.InstanceId)||(this.cic(Va.floatingObject.xl.InstanceId)||this.hsc.push(Va.floatingObject.xl.InstanceId),this.VIa(Va.floatingObject.xl)),this.ea.isNamedObjectViewMode&&
this.dXg(Va.floatingObject.xl.InstanceId,Va.Od))}NZe(Va){return null==this.sf?null:this.sf.find(bc=>1===bc.controlType&&jc.a.equals(bc.YP,Va,!0))}Xaa(Va){if(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return Va=this.NZe(Va),null===Va||void 0===Va?void 0:Va.controlId;if(this.sf)for(let bc=0,yc=this.sf.length;bc<yc;bc++)if(1===this.sf[bc].controlType&&jc.a.equals(this.sf[bc].YP,Va,!0))return this.sf[bc].controlId;return null}Jzi(Va){return(Va=this.NZe(Va))?
Va.visible:!1}NKh(Va){const bc=[];if(this.sf)for(let yc=0,Hc=this.sf.length;yc<Hc;yc++)jc.a.equals(this.sf[yc].YP,Va,!0)&&bc.push(this.sf[yc].controlId);return bc}rLh(Va,bc){if(!bc||!Va)return null;if(this.sf)for(let yc=0,Hc=this.sf.length;yc<Hc;yc++)if(1===this.sf[yc].controlType&&jc.a.equals(this.sf[yc].YP,Va,!0)&&this.sf[yc].xl.SharedRuntime&&jc.a.equals(this.sf[yc].xl.SharedRuntime.Resid,bc.Resid,!0))return this.sf[yc].controlId;return null}VKa(Va,bc=null){return Va?bc?`${Va}.${bc}`:Va:""}BDe(Va,
bc,yc){if(this.dya===Va)return!0;this.dya=Va;let Hc=null,Zc=!1;if(!Hc&&this.sf)for(let Sd=0,ue=this.sf.length;Sd<ue;Sd++)if(1===this.sf[Sd].controlType&&jc.a.equals(this.sf[Sd].YP,Va,!0)){let Fe=!1,Be=!1;bc?(Fe=!0,Be=!!this.sf[Sd].xl.SharedRuntime&&jc.a.equals(this.sf[Sd].xl.SharedRuntime.Resid,bc.Resid,!0)):yc&&(Fe=!0,Be=jc.a.equals(this.sf[Sd].xl.SharedRuntimeId,yc,!0));if(!Fe||Be){Be&&this.sf[Sd].Sg(!0);Hc=this.sf[Sd].controlId;Zc=!0;this.dya=null;break}}Hc&&this.raiseEvent("ca",Hc);return Zc}setAppRuntimeState(Va,
bc){var yc;if(Va){const Hc=this.tn(Va);if(Hc&&Ma.HelperMethods.Aw(Hc.xl))Hc.Sg(bc),bc&&(this.raiseEvent("ca",Va),(null===(yc=Hc.oy)||void 0===yc?0:yc.firstChild)&&(Va=Hc.oy.firstChild.title)&&0<Va.length&&this.j2b.tAj(Va));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ac.a.instance.ga(2250));}else throw e.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Ac.a.instance.ga(2251));
}getAppRuntimeState(Va){if(Va)if((Va=this.tn(Va))&&Ma.HelperMethods.Aw(Va.xl))Va=Va.xl.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ac.a.instance.ga(2250));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Ac.a.instance.ga(2251));return Va}d4a(Va,bc){return(Va=this.tn(Va))?Va.d4a(bc):null}h7a(Va){return this.DDe(this.hsc,Va)}cic(Va){return this.DDe(this.ALe,
Va)}oqe(Va){this.ALe.push(Va)}QU(Va){return(Va=this.tn(Va))?Va.xl:null}ICd(Va){this.raiseEvent("ekros",Va,this)}pMf(Va){if(Va){var bc=this.tn(Va.InstanceId);bc&&(Va.SharedRuntime||Va.SharedRuntimeId||(this.mRa(bc.controlId),this.Lg.purgeOsfControl(bc.controlId,!1)),bc={},bc.SolutionId=Va.PrimaryMarketplace.SolutionId,bc.TargetType=Va.WebExtensionType,bc.Version=Va.PrimaryMarketplace.SolutionVersion,bc.StoreType=Va.PrimaryMarketplace.MarketplaceType,bc.StoreId=Va.PrimaryMarketplace.MarketplaceRef,
Va.AssetMarketplace?(bc.AssetId=Va.AssetMarketplace.SolutionId,bc.AssetStoreId=Va.AssetMarketplace.MarketplaceRef):(bc.AssetId=null,bc.AssetStoreId=null),bc.Width=Va.TaskpaneWidth,bc.SharedRuntimeId=Va.SharedRuntimeId,this.$ig(bc))}}$ia(){this.Wg.$ia()}mH(Va,bc,yc){this.Wg.mH(Va,bc,yc)}b_e(Va,bc){bc=he.Ejh(bc);Va=this.QU(Va);this.Wg.vbc(Va.InstanceId,2202,ec.a.bL,bc)}aed(Va){for(let bc=0,yc=this.sf.length;bc<yc;bc++)this.b_e(this.sf[bc].controlId,Va)}BLh(Va,bc){bc=he.Reh(bc);this.Wg.vbc(Va,65539,
"",bc)}FLh(Va,bc,yc){this.Wg.vbc(Va,1,bc,yc)}ALh(Va,bc){this.Wg.GLh(Va,bc)}ieh(Va,bc){return[[2,1E3,"",JSON.stringify([Va,bc]),0,!1]]}oqi(){return!!this.Pna&&this.Pna.Gcf()}c8g(){this.Pna&&this.Pna.clear()}CLh(){if(this.Pna&&this.Pna.Gcf()){var Va=this.Pna.XRh();for(const bc of Va){Va=this.NKh(bc);for(const yc of Va)this.Wg.vbc(yc,65540,"","{}")}}}Pjj(Va){this.Pna.add(Va)}y2j(Va){this.Pna.remove(Va)}uja(Va){if(!this.sf)return null;for(const bc of this.sf)if(Va(bc))return bc;return null}qJe(Va){const bc=
new ya.a,yc=he.Cva(Va,this.$);if(Ma.HelperMethods.Aw(Va))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.ZOf(Va,Hc=>{Hc?(Va.InstanceId=Hc.InstanceId,Va.WebExtensionOsfControlType=3,Va.TaskpaneVisible=!1,this.VIa(Va),bc.setResult(Va.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Va.PrimaryMarketplace.SolutionId,Va.PrimaryMarketplace.MarketplaceType,null,null,null,Va.PrimaryMarketplace.MarketplaceRef)} failed`),
bc.setException(Error.create("Null insert data")))});else{he.q2a.ia(Va.InstanceId,new La.a);const Hc=he.q2a.ma(Va.InstanceId).taa;this.Ufh(Va,Hc,yc);this.ZOf(Va,null);bc.setResult(Va.InstanceId)}return bc.task}Ufh(Va,bc,yc){this.tn(Va.InstanceId)||(Va=new nc(this,this.Wg,Va),Va.jua=yc,Va.xgf(bc),this.sf.push(Va),this.dya=null)}ZOf(Va,bc){const yc=he.Cva(Va,this.$);if(!this.MHd.contains(yc))this.GIb.push(Va),1<=this.GIb.length&&this.$Of(Va,bc);else if(bc)for(const Hc of this.bPf)if(he.Cva(Hc,this.$)===
yc){bc(Hc,0);break}}$Of(Va,bc){let yc=null;const Hc={};Hc.SolutionId=he.getSolutionId(Va,this.$);Hc.TargetType=Va.WebExtensionType;Hc.Version=Va.PrimaryMarketplace.SolutionVersion;Hc.StoreType=Va.PrimaryMarketplace.MarketplaceType;Hc.StoreId=Va.PrimaryMarketplace.MarketplaceRef;Va.AssetMarketplace?(Hc.AssetId=Va.AssetMarketplace.SolutionId,Hc.AssetStoreId=Va.AssetMarketplace.MarketplaceRef):(Hc.AssetId=null,Hc.AssetStoreId=null);Hc.Width=Va.TaskpaneWidth;Hc.ContainsCustomFunctions=!0;Ma.HelperMethods.Aw(Va)&&
(Hc.SharedRuntimeId=Va.SharedRuntime.Resid);const Zc=this.$.pa.va;Va=this.$.pa.va.$b();const Sd=Zc.Oa(9,Va);Sd.sharedInfo=Hc;const ue=Be=>{Be=gf.a.Ue(Be.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${qb.a.qc(Be)}`)},Fe=Be=>{Be&&!Kb.a(Be)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Hc.SolutionId,Hc.StoreType,Hc.AssetId,null,
null,Hc.StoreId)} finish with errors: ${qb.a.qc(Be.Errors)}`);this.GIb.shift();0<this.GIb.length&&this.$Of(this.GIb[0],bc)};if(bc){const Be=Ua=>{const Rb=Ua.Result;(yc=Rb?Rb.AgaveData:null)||bc(null,Ua.Errors?Ua.Errors[0].ErrorCause:5001);bc(yc,0)};Va=(Ua,Rb,sc)=>jf.g(Zc,"InsertAgaveTaskpane",Sd,Jc.b(Ua,Fe,Be),Jc.a(Rb,ue),sc,null,0)}else Va=(Be,Ua,Rb)=>jf.g(Zc,"InsertAgaveTaskpane",Sd,Jc.b(Be,Fe),Jc.a(Ua,ue),Rb,null,0);We.a(this.$.userOperationManager,Va,Be=>new $e.a(519,0,Be,64),null)}oKj(){return this.$.ke.get(35)}dNd(Va){Va=
this.tn(Va);(null===Va||void 0===Va?0:Va.bea)&&Va.gYf()}nQi(Va){var bc=this.uja(yc=>he.XMa(yc.YP));bc&&(bc=this.Lg.getOsfControl(bc.controlId))&&bc.notifyAgave(OSF.AgaveHostAction.SendMessage,Va)}bri(){return!!this.uja(Va=>1===Va.controlType&&he.XMa(Va.YP))}ari(){const Va=this.uja(bc=>he.XMa(bc.YP));return Va?Va.oy?Wa.DOMElementExtensions.isVisible(Va.oy):!1:!1}DDj(){const Va=this.uja(bc=>he.XMa(bc.YP));Va&&(Va.Sg(!0),this.raiseEvent("ca",Va.controlId))}initialize(Va){const {DdaEventDispatch:bc}=
a(1400),yc=void 0===this.$||null===this.$||Ja.EwaSettings.xa(234);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");yc&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(xe.xHa(this.$),this.ea=this.$.ea,this.Wg=new bc(this.$),this.$.hl(this.od),this.ea.Oj(this.Wc),this.ea.ZL(this.Io),this.ea.ju(this.xf),this.$.userOperationManager.jr(this.AR),this.Ssf(),
this.O_i(),this.hli(),this.$.da.Ha(35,this),this.JZc.la(this),yc&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.dke=new ec.a,yc&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.gke=new ne(this.$,this.Gh,this.Wg),new Fc(this.$,this.Gh,this.Wg),this.eke=new db(this.$,this.Gh,this.Wg),this.cke=new Ub(this.$,this.Gh,this.Wg),this.bke=new Ic(this.$,this.Gh,this.Wg),this.fke=new xd(this.$,this.Gh,this.Wg),this.hke=
new bd(this.$,this.Gh,this.Wg),this.ike=new de(this.$,this.Gh,this.Wg),this.$.bR&&(this.jke=new tc(this.$,this.Gh,this.Wg)),Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7637843_CreateRichApiRangeValuesPreview")&&(this.kke=new je(this.$,this.Gh,this.Wg,Va)),Ja.EwaSettings.xa(178)&&(this.x2a=new Ab(this,ab.h(this.$))),Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.ake=new Pb),this.$je=new pf(this.$,this.Gh,this.Wg),this.initialized=!0,e.ULS.sendTraceTag(537170520,
0,50,"DdaFacade is initialized"))}wLh(Va){if(!this.eDa)return null;for(let bc=0,yc=this.eDa.length;bc<yc;bc++)if(Va.startsWith(this.eDa[bc].WebExtensionId))return this.eDa[bc];return null}Ssf(){var Va,bc=this.ea;if(bc.Yb&&!this.fSb){if(bc.workbookContext){if(this.wWc=this.$.ea.Dg.get(22),null===(Va=bc.workbookContext.WebExtensions)||void 0===Va?0:Va.length){Va=bc.workbookContext.WebExtensions;bc=!1;for(let yc=Va.length-1;0<=yc;yc--){if(!this.ea.isNamedObjectViewMode){this.hsc.push(Va[yc].InstanceId);
if(1!==Va[yc].WebExtensionType){Va.splice(yc,1);continue}if(Ma.HelperMethods.Aw(Va[yc])&&0!==Va[yc].SharedRuntime.State)1===Va[yc].SharedRuntime.State?Va[yc].TaskpaneVisible=!1:2===Va[yc].SharedRuntime.State?Va[yc].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Va[yc].ContainsCustomFunctions&&!Va[yc].TaskpaneVisible&&!vb.a(Va[yc])){Va.splice(yc,1);continue}}const Hc=OSF.OsfControl.isFirstPartyStoreString(Va[yc].PrimaryMarketplace.MarketplaceType);
if(Ja.EwaSettings.xa(174)&&!Hc&&(Va.splice(yc,1),!bc)){bc=!0;const Zc=Object(X.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(F.c)(na.a.resolve(hb.e,{Wb:3})):ob.GetServiceTaskFactory.Pa(this.$.da,5,4,3);Ga.TaskExtensions.za(Zc,()=>{Zc.result.sh(36,null)},this.ka,3)}Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Va[yc].PrimaryMarketplace&&he.XMa(Va[yc].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),
Va.splice(yc,1))}this.NIe(Va)}}else this.wWc=!1;this.fSb=!0}}dbf(Va){const bc=ab.h(this.$),yc=bc.ha.Sa.jc;if(yc&&Va){Va=!1;if(this.sf)for(const Hc of this.sf)if(he.XMa(Hc.YP)||he.pui(Hc.YP)){Va=!0;break}Va||bc.ha.Sa.hH(yc)}}O_i(){this.Lg&&this.ea.isNamedObjectViewMode&&this.$.na&&ed.o(this.$.na)&&(this.$.da.Ba(34).XQ?this.$.da.Ba(34).qpd():this.$.da.Ba(34).ev(this.L5i))}NIe(Va){let bc=null;bc=yc=>{const Hc=yc.WebExtensionData,Zc=yc.IsTaskPane,Sd=yc.RecordHandler,ue=()=>{this.pQa.shift();0<this.pQa.length&&
bc(this.pQa[0])};if(this.Xaa(Hc.PrimaryMarketplace.SolutionId))ue();else{Zc&&(Hc.WebExtensionOsfControlType=1);var Fe=vb.a(Hc);if(!Zc||Hc.TaskpaneVisible||Fe||Hc.SharedRuntime&&0!==Hc.SharedRuntime.State||Hc.ContainsCustomFunctions){var Be=new nc(this,this.Wg,Hc,!Zc);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Hc.PrimaryMarketplace.SolutionId,Hc.PrimaryMarketplace.MarketplaceType,null,null,null,Hc.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Hc.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ma.HelperMethods.Aw(Hc)}`);
Be.dpd();Ma.HelperMethods.Aw(Hc)&&(Be.jua=he.Cva(Hc,this.$),Hc.TaskpaneWidth=this.qub);Fe&&(Hc.WebExtensionToolTip="");!Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&Zc&&Hc.TaskpaneVisible&&!Fe&&(Hc.TaskpaneWidth=this.qub);this.sf.push(Be);var Ua=this.dya=null;Ua=rf.a.instance.GC(()=>{Be.oy&&(ib.a.Ja(Ua),Ua=null,Sd&&Sd(yc,Be),ue())},100,Mf.a.Rmh)}else ue()}};for(let yc=0;yc<Va.length;yc++){if(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const Hc=
Va[yc].WebExtensionType===OSF.OsfControlTarget.TaskPane,Zc=vb.a(Va[yc]);Hc&&!Zc&&(Va[yc].TaskpaneWidth=this.qub)}if(!this.tn(Va[yc].InstanceId))if(1!==Va[yc].WebExtensionType)this.VIa(Va[yc]);else if(!Ja.EwaSettings.xa(52))this.xob(Va[yc],bc);else if(this.$.Bd&8388608||Va[yc].TaskpaneVisible){const Hc={};Hc.solutionId=Va[yc].PrimaryMarketplace.SolutionId;Hc.version=Va[yc].PrimaryMarketplace.SolutionVersion;Hc.storeType=Va[yc].PrimaryMarketplace.MarketplaceType;Hc.storeId=Va[yc].PrimaryMarketplace.MarketplaceRef;
Hc.targetData=Va[yc];this.Lg.isAddinCommandsAsync(Hc,(Zc,Sd,ue)=>{if(Zc){var Fe=ue.targetData;if(Sd)if(Hc.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Zc=Hc.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Sd=Hc.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Zc||Sd)&&Ma.HelperMethods.Aw(Fe)&&this.xob(Fe,bc);else if(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.sdi(ue,bc);else{let Be=
!1;this.Bda(Ua=>{if(!Ua.errorCode){if(Ua.value)for(const Rb of Ua.value){if(Be)break;Be=fa.e(Rb[1])===fa.e(Fe.PrimaryMarketplace.SolutionId)}Be?Ma.HelperMethods.Aw(Fe)&&this.xob(Fe,bc):(Ua={},Ua.SolutionId=ue.solutionId,Ua.Version=ue.version,Ua.StoreType=Fe.PrimaryMarketplace.MarketplaceType,Ua.StoreId=ue.storeId,Ua.AssetId=null,Ua.AssetStoreId=null,Ua.Width=Fe.TaskpaneWidth,Ua.TargetType=Fe.WebExtensionType,Fe.TaskpaneVisible=!0,this.Xoe(Ua,Fe,bc))}},!0)}else this.xob(Fe,bc)}else Zc=ue.targetData,
e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Zc.PrimaryMarketplace.SolutionId,Zc.PrimaryMarketplace.MarketplaceType,null,null,null,Zc.PrimaryMarketplace.MarketplaceRef)} from ${Zc.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}sdi(Va,bc){let yc=!1;this.Bda(Hc=>{const Zc=Va.targetData;if(!Hc.errorCode){if(Hc.value)for(const Sd of Hc.value){if(yc)break;yc=fa.e(Sd[1])===fa.e(Zc.PrimaryMarketplace.SolutionId)}yc?
Ma.HelperMethods.Aw(Zc)&&this.xob(Zc,bc):(Hc={},Hc.SolutionId=Va.solutionId,Hc.Version=Va.version,Hc.StoreType=Zc.PrimaryMarketplace.MarketplaceType,Hc.StoreId=Va.storeId,Hc.AssetId=null,Hc.AssetStoreId=null,Hc.TargetType=Zc.WebExtensionType,Hc.Width=Zc.TaskpaneWidth,Zc.TaskpaneVisible=!0,this.Xoe(Hc,Zc,bc))}},!0)}xob(Va,bc){const yc={};yc.WebExtensionData=Va;yc.IsTaskPane=!0;this.pQa.push(yc);1===this.pQa.length&&bc(yc)}Xoe(Va,bc,yc){const Hc={};Hc.ActivationInfo=Va;Hc.WebExtensionData=bc;Hc.IsTaskPane=
!1;Hc.RecordHandler=(Zc,Sd)=>{const ue=Zc.ActivationInfo;this.Lg.insertBlankControlWithErrorUX(this.hJb(Sd,ue),()=>{this.mRa(Sd.controlId);this.Lg.purgeOsfControl(Sd.controlId,!1);this.$ig(ue)})};this.pQa.push(Hc);1===this.pQa.length&&yc(Hc)}$ig(Va){var bc={};bc.solutionId=Va.SolutionId;bc.version=Va.Version;bc.storeType=Va.StoreType;bc.storeId=Va.StoreId;bc.assetId=Va.AssetId;bc.assetStoreId=Va.AssetStoreId;bc.targetType=Va.TargetType;bc.sharedRuntimeId=Va.SharedRuntimeId;Va=new J.a;Va.add(bc);bc=
{};bc[T.a.Cpb]=Va;bc[T.a.aM]=3;Va=new fb.a(Je.a.gEb,0,this.$.xc,0,null);this.$.Ia.Hb(Va,bc)}hJb(Va,bc){const yc={};yc.div=Va.oy;yc.id=Va.controlId;yc.solutionId=bc.SolutionId;yc.version=bc.Version;yc.storeId=bc.StoreId;yc.storeType=bc.StoreType;yc.osfControlType=OSF.OsfControlTarget.TaskPane;return yc}$0f(){if(Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const yc=[];for(var Va=0;Va<this.sf.length;Va++){var bc=this.sf[Va];0!==bc.osfControlType&&3!==bc.osfControlType&&
4!==bc.osfControlType||yc.push(bc)}Va=!1;for(bc=0;bc<yc.length;bc++){const Hc=yc[bc];this.mRa(Hc.controlId);!Va&&Hc&&Hc.xl&&(Va=Ma.HelperMethods.Aw(Hc.xl))}Va&&this.kK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}Ja.EwaSettings.xa(355)&&Ga.TaskExtensions.za(ob.GetServiceTaskFactory.Pa(this.$.da,278,279,3),yc=>{yc&&(yc=yc.result)&&(this.$.da.Ba(278)||this.$.da.Ha(278,yc),yc.Chf().Tna())},this.ka,3)}$K(){var Va=new ae(this.$,this.Gh,this.g2f);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,
0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Ja.EwaSettings.xa(234)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Gh||null===this.Gh));if(Va.ePi()){const bc=()=>{},yc=Zc=>{Zc=gf.a.Ue(Zc.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${qb.a.qc(Zc)}.`)},Hc=Va.x1g();Va=he.sjd(Hc);Va|=64;this.$.userOperationManager.bF(new $e.a(507,
0,(Zc,Sd,ue)=>jf.g(this.$.pa.va,"ExecuteRichApiRequest",this.y1g(Hc),Jc.b(Zc,bc),Jc.a(Sd,yc),ue,null,0),Va))}}y1g(Va){const bc=this.$.pa.va.Oa(1);bc.request=Va;return bc}DDe(Va,bc){if(Va)for(let yc=0;yc<Va.length;yc++)if(jc.a.equals(Va[yc],bc,!0))return!0;return!1}z0g(Va){const bc={};bc.navigationMode=OSF.OsfNavigationMode.DefaultMode;bc.assetId=null;bc.category=null;if(!Va||3>Va.length)return bc;if(Va[0]){const yc=parseInt(Va[0],10);isNaN(parseInt(yc,10))||(bc.navigationMode=yc)}Va[1]&&(bc.assetId=
Va[1]);Va[2]&&(bc.category=Va[2]);return bc}hli(){if(Ja.EwaSettings.xa(60)){var Va=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Va&&"*"!==Va.trim()){this.RJa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new rb(this),Va,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.ke.get(2));try{this.RJa.init()}catch(bc){try{this.RJa.dispose()}catch(yc){}this.RJa=null;e.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+bc.message)}Va=
{};Va.a=this.$.ya.UserSessionId;Cd.b().Ze(39,Va)}}}Wag(Va,bc,yc){const Hc=he.M_g(Va[0]),Zc=Hc.Kha,Sd=Hc.Oia;Hc.Kha=()=>{Zc&&Zc();const ue=Hc.BMa!==OSF.InfoType.Error?bc:null;Va.shift();Va.length?this.Wag(Va,ue,yc):ue&&ue()};Hc.Oia=()=>{Sd&&Sd();yc&&Hc.BMa!==OSF.InfoType.Error&&yc()};va.a.QVd(Hc)}G_h(){const Va={};Va.AddinRibbonControlsOverriddenByApi=Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();Va.AddinActionDefinitionHybridMode=Ja.EwaSettings.xa(556).toString();
Va.UseActionIdForUILessCommand=Ja.EwaSettings.xa(559).toString();Va.AllowStorageAccessByUserActivationOnIFrame=Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Va.RequirementSetRibbonApiOnePointTwo=Ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Va.flightingTreatmentVariables=m.AFrameworkApplication.fa.Cbc;Va.ShortcutInfoArrayInUserPreferenceData=Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();
Va.DisabledChangeGates=m.AFrameworkApplication.fa.Wa("DisabledChangeGates");return Va}static get p6b(){return he.B8d}static set p6b(Va){he.B8d=Va}static getSolutionId(Va){let bc=Va.PrimaryMarketplace.SolutionId;Ja.EwaSettings.xa(261)&&Va.OwnerAddinSolutionId&&(bc=Va.OwnerAddinSolutionId);return bc}static sjd(Va){let bc=0;Ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Va.RequestFlags&1&&256!==(Va.RequestFlags&256)||(bc=16):bc=Va.RequestFlags&1?0:16;return bc}static Cva(Va,
bc){bc=he.getSolutionId(Va,bc);return he.a4e(bc,Va.PrimaryMarketplace.SolutionVersion,Va.PrimaryMarketplace.MarketplaceType,Va.PrimaryMarketplace.MarketplaceRef)}static Ejh(Va){return JSON.stringify({["recording"]:Va})}static Reh(Va){const bc={};bc.visibility=Va?"Visible":"Hidden";return JSON.stringify(bc)}static GWh(Va){let bc=Va.getSolutionId(),yc=Va.getVersion(),Hc=Va.getStoreType();Va=Va.getStoreId();return he.a4e(bc,yc,Hc,Va)}static a4e(Va,bc,yc,Hc){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",Va,bc,he.e8h(yc).toString(),Hc)}static qld(Va,bc){var yc=Va.split("|");if(7>yc.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==yc[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${yc[0]}'.`),null;let Hc=yc[1];const Zc=yc[2],Sd=he.f8h(yc[3]),ue=yc[4];yc=yc[5];Hc&&Hc.length||(Hc=yc);yc={};yc.InstanceId=String.format("{{{0}}}",P.a.create().toString());
yc.WebExtensionOsfControlType=4;yc.WebExtensionType=1;yc.PrimaryMarketplace={};yc.PrimaryMarketplace.SolutionId=Hc;yc.PrimaryMarketplace.SolutionVersion=Zc;yc.PrimaryMarketplace.MarketplaceRef=ue;yc.PrimaryMarketplace.MarketplaceType=Sd;yc.ContainsCustomFunctions=bc?!0:!1;bc&&(yc.OsfPropertyBag=[["customFunctionAddinId",Va]]);return yc}static f8h(Va){Va=parseInt(Va,10);return Va===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:Va===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Va===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:Va===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Va===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Va===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Va===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Va===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Va===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Va===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:Va===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null}static e8h(Va){return Va===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Va===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Va===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Va===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Va===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Va===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Va===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:Va===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
Va===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Va===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Va===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}XIa(Va){const bc={};bc.Version=Va.version;bc.AssetId=Va.assetId;bc.AssetStoreId=Va.assetStoreId;bc.StoreType=Va.storeType;bc.Height=Va.height;bc.SolutionId=Va.solutionId;bc.StoreId=Va.storeId;bc.TargetType=Va.targetType;bc.Width=1===bc.TargetType?0:Va.width;bc.SharedRuntimeId=Va.sharedRuntimeId;return bc}static FBb(Va){return Va===
OSF.DDA.EventDispId.dispidSettingsChangedEvent||Va===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Va===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Va===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Va===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Va===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Va===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||Va===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static M_g(Va){return Object(b.a)(new ie.a,
{BMa:Va.infoType,id:Va.id,title:Va.title,description:Va.description,buttonText:Va.buttonTxt,Kha:Va.buttonCallback,ugc:Va.highPriority,Oia:Va.dismissCallback,errorCode:Va.errorCode,Jff:Va.iframeNotificationUrl})}static XMa(Va){let bc="FA000000014"===Va;bc||(bc="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Va);return bc}static pui(Va){return"FA000000005"===Va}}he.q2a=new D.a;he.B8d=!0;Object(c.a)(he,"DdaFacade",V.a,[210,828,829,830,831,3])},780:function(r,B,a){a.d(B,"a",function(){return c});r=
a(0);class c{constructor(b,e,f,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=f;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(r.a)(c,"DdaEventArgs",null,[])},833:function(r,B,a){r=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(r.a)(c,"AddInDataTransferObject",null,[]);a.d(B,"a",function(){return b});class b{constructor(e,f,d){this.DSb=e;this.tvg=f;this.uvg=
d}get Ss(){return this.DSb}get sMg(){return this.tvg}get tMg(){return this.uvg}static C4a(e){return(e=e.aW)?Object.assign(new c,{tabs:e.Ss.toArray(),id:e.sMg,title:e.tMg}):null}}Object(r.a)(b,"OneLineRibbonExtensibility",null,[])},837:function(r,B,a){a.d(B,"a",function(){return c});a.d(B,"b",function(){return b});const c=e=>{let f=null;switch(e){case 0:f="omex";break;case 1:f="spcatalog";break;case 2:f="spapp";break;case 3:f="filesystem";break;case 4:f="exchange";break;case 6:f="registry";break;case 7:f=
"inmemory";break;case 8:f="uploadfiledevcatalog";break;case 9:f="hardcodedpreinstall";break;case 10:f="excatalog";break;case 16:f="wopicatalog"}return f},b=e=>{let f=-1;switch(e.toLowerCase()){case "omex":f=0;break;case "spcatalog":f=1;break;case "spapp":f=2;break;case "filesystem":f=3;break;case "exchange":f=4;break;case "registry":f=6;break;case "inmemory":f=7;break;case "uploadfiledevcatalog":f=8;break;case "hardcodedpreinstall":f=9;break;case "excatalog":f=10;break;case "wopicatalog":f=16}return f}},
869:function(r,B,a){a.r(B);r=a(0);var c=a(197),b=a(15),e=a(103);class f{constructor(){this.startTime=0;this.callback=null}}Object(r.a)(f,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(r.a)(d,"AccessTokenInformation",null,[84]);var h=a(990);class l{constructor(){this.token=null;this.expiresOn=0;this.xha=this.authChallenge=null}}Object(r.a)(l,"CachedTokenInfo",null,[]);class k{constructor(){this.jTb=new c.a;this.e$=this.d$=!1;this.hpa=this.authChallenge=null;this.startTime=
this.retryCount=0;this.Qte=null}get callbacks(){return this.jTb}}Object(r.a)(k,"SSORequestInfo",null,[]);class w extends k{constructor(){super();this.errorCode=0}}Object(r.a)(w,"SSOFailedRequestInfo",k,[]);var n=a(4);class x{constructor(I,S,P,D){this.gT=new c.a;this.GG=new c.a;this.mqa=null;this.Smb=new c.a;this.Fee=Promise.resolve(null);this.Rle=!1;this.iYb=S;this.HTb=I;this.ume=P;this.yvg=D}wLj(I){if(this.mqa&&this.mqa.authChallenge===I.authChallenge){if(Date.now()/1E3+x.ELi>this.mqa.expiresOn)return this.mqa=
null,!1;I=new h.a;I.token=this.mqa.token;I.expiresOn=this.mqa.expiresOn;I.xha=this.mqa.xha;I.tUa=!0;I.Ryb=0;this.izb(I);return!0}return!1}SJj(I){for(let S=0;S<this.GG.count;S++)if(this.GG.ma(S).authChallenge===I.authChallenge&&this.GG.ma(S).hpa===I.hpa){let P;(P=this.GG.ma(S)).retryCount=P.retryCount+1;I.retryCount=this.GG.ma(S).retryCount;if(this.GG.ma(S).retryCount<x.bMi||!this.GG.ma(S).d$&&I.d$||!this.GG.ma(S).e$&&I.e$){if(!this.GG.ma(S).d$&&I.d$||!this.GG.ma(S).e$&&I.e$)I.retryCount=0;this.GG.removeAt(S);
break}I=new h.a;I.errorCode=this.GG.ma(S).errorCode;this.izb(I);return!0}return!1}jOg(I,S){for(let P=0;P<this.GG.count;P++)if(this.GG.ma(P).hpa===I.hpa&&this.GG.ma(P).authChallenge===I.authChallenge)return;this.GG.add(Object.assign(new w,{d$:I.d$,e$:I.e$,authChallenge:I.authChallenge,hpa:I.hpa,errorCode:S,retryCount:I.retryCount}))}get resource(){return this.iYb}$fd(I,S,P,D,G,E){const {AppsForOfficeSingleSignOnManager:O}=a(869);""===P&&(P=null);if(this.Rle)O.Q5(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
null,null);else{var N=null;for(let J of this.gT)if(J.d$===I&&J.e$===S&&J.authChallenge===P&&J.hpa===G){N=J;break}N||(N=Object.assign(new k,{d$:I,e$:S,authChallenge:P,Qte:D,hpa:G,retryCount:0,startTime:O.vw()}),this.gT.add(N));N.retryCount=0;N.callbacks.add(E);this.Fee=this.Fee.then(()=>{var {AppsForOfficeSingleSignOnManager:J}=a(869);if(0<this.gT.count){var W=this.gT.ma(0);if(this.wLj(W)||this.SJj(W))return null;for(let R=0;R<this.Smb.count;)this.Smb.ma(R)+x.$Wj<J.vw()?this.Smb.removeAt(R):R++;if(this.Smb.count>=
x.YLi||this.gT.count>=x.zLi)return W=new h.a,W.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.izb(W),null;let ea=null;n.AFrameworkApplication.sa&&(J=n.AFrameworkApplication.sa.SD)&&(ea=J.Kc("ComponentAttach",this.HTb+x.IHg));return W.hpa.mKg(this.resource,W.d$,W.e$,W.authChallenge,this.yvg,W.Qte).then(R=>{ea&&ea.stop();this.izb(R)},()=>{ea&&ea.stop();const R=new h.a;R.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.izb(R)})}return null})}}izb(I){const {AppsForOfficeSingleSignOnManager:S}=
a(869);try{if(this.gT.count){var P=this.gT.ma(0);this.gT.removeAt(0);var D=null;I.errorCode||(D=new d,D.accessToken=I.token);I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.jOg(P,I.errorCode);var G={};null!=I.Ryb&&(G.getTokenSilentTime=I.Ryb.toString());null!=
I.Xkd&&(G.getTokenPopupTime=I.Xkd.toString());null!=I.Eid&&(G.getIDTokenTime=I.Eid.toString());null!=I.tUa&&(G.tokenCached=I.tUa.toString());I.GZd&&(G.detailedError=I.GZd);I.xha&&(G.authLibrary=I.xha);P.retryCount&&(G.retryCount=P.retryCount);for(var E of P.callbacks)S.Q5(E,I.errorCode,D,G);null!=I.tUa&&I.tUa||this.Smb.add(P.startTime);if(!I.errorCode)for(null!=I.expiresOn&&(this.mqa=Object.assign(new l,{token:I.token,expiresOn:I.expiresOn,authChallenge:P.authChallenge,xha:I.xha})),this.GG.clear(),
E=0;E<this.gT.count;)if(this.gT.ma(E).authChallenge===P.authChallenge){for(let O of this.gT.ma(E).callbacks)S.Q5(O,I.errorCode,D,G);this.gT.removeAt(E)}else E++}}catch(O){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",O.message)}}shutdown(){this.Rle=!0;this.gT.clear()}}x.$Wj=6E4;x.YLi=6;x.zLi=6;x.bMi=3;x.ELi=300;x.IHg="GetAccessToken";Object(r.a)(x,"SSOCallbackManager",null,[]);var m=a(736),u=a(563),t=a(127),y=a(82),v=a(27),A=a(31),z=a(158),C=a(351);a.d(B,
"AppsForOfficeSingleSignOnManager",function(){return H});class H{constructor(I,S,P=null){this.$Hc=new e.a;const D=new c.a;S&&D.add(S.$Ji);P&&D.addRange(P);this.zl=I;this.NIg=D}agd(I,S,P,D,G,E,O,N,J,W){W=Object.assign(new f,{startTime:H.vw(),callback:W});try{const Y=!!P&&""!==P;var ea=W.startTime;const U=this.getOsfControl(I);let da=U.getStoreType()||"",T=U.getOwnerAddinStoreType()||"",ka=U.getSolutionId()||"";const L=U.getVersion()||"";da=da.toLowerCase();T=T.toLowerCase();ka=ka.toLowerCase();var R=
y.a.Did(S)||"";const fa=y.a.Did(U.getIframeUrl())||"",wa=R.toLowerCase()===fa.toLowerCase();R=da;"inmemory"===da&&(R=T);const oa=Telemetry.PrivacyRules.GetPrivacyCompliantId(ka,R,U.getAssetId(),null,null,U.getStoreId()),xa={["callInstanceId"]:ea.toString(),["controlSolutionId"]:oa,["controlVersion"]:L,["storeType"]:da,["ownerStoreType"]:T,["allowConsentPrompt"]:D.toString(),["forMSGraphAccess"]:G.toString(),["allowSignInPrompt"]:E.toString(),["hasAddinAuthChallenge"]:Y.toString(),["securityOriginEqualsSourceLocation"]:wa.toString(),
["singleSignOnEnabled"]:O.toString(),["accountTypeFilter"]:N||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",xa);z.a.sendTelemetryEvent(Object.assign(new C.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:t.a.ki(xa)}));ea=!0;const bb=n.AFrameworkApplication.fa.Wa("HostAuthType");switch(N){case "aad":ea="aad"===bb;break;case "msa":ea="msa"===bb;break;default:ea=!N||"noFilter"===N}if(ea){N=null;if(O)for(let Za of this.NIg)if(Za.Isi(ka)){N=Za;break}N?this.isSSOAddin(I)?(O=!0,
"omex"===R&&(O=!1),"spapp"===R||"spcatalog"===R?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),H.Q5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):G&&!O?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),H.Q5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(G&&"exchange"===R&&(D=!1),this.$fd(I,S,P,R,D,E,J,N,W))):(b.ULS.sendTraceTag(22402395,
344,10,"GetAccessToken: current Addin is not a SSO Addin."),H.Q5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):H.Q5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else H.Q5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Y){this.Ymc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Y.message),H.Q5(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(I,
S,P,D){this.agd(I,P[m.a.tZc]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,S,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,D)}$fd(I,S,
P,D,G,E,O,N,J){this.$Hc.kb(I)?D=this.$Hc.ma(I):(D=new x(I,this.getWebApplicationResource(I).split(",")[0],D,this.getDefaultDisplayName(I)),this.$Hc.add(I,D));const W=D.resource;I=H.W5h(W,this.getWebApplicationId(I));const ea=OfficeExt.WACUtils.getHostSecure(S);I&&ea?I.toLowerCase()===ea.toLowerCase()?D.$fd(G,E,P,O,N,J):(H.IOa('SSO Resource "'+W+'" cannot be used from "'+S+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),
H.Q5(J,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(I||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ea||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),H.Q5(J,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}Ymc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(I){return this.zl.getOsfControl(I)}isSSOAddin(I){return this.getOsfControl(I).getManifest().isSSOAddin()}getWebApplicationId(I){return this.getOsfControl(I).getManifest().getWebApplicationId()}getWebApplicationResource(I){return this.getOsfControl(I).getManifest().getWebApplicationResource()}getDefaultDisplayName(I){return this.getOsfControl(I).getManifest().getDefaultDisplayName()}static G7h(){try{const I=
{};v.a.Xxa&&u.OAuthManagerSettings.aAb&&(I.UiHostSupportsAuthTokenAddinList=H.k_e);I.UiHostSupportsAuthToken=u.OAuthManagerSettings.aAb;return I}catch(I){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",I.message)}return null}static getInstance(I,S,P=null){H.Ma||(H.Ma=new H(I,P));return H.Ma}static IOa(I){window.console.warn&&window.console.warn(I)}static W5h(I,S){if(!I)return"";S||(S="");let P=I.toLowerCase();var D=S.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(D)||
(H.IOa('SSO App Id "'+S+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));P.endsWith(D)||(H.IOa('SSO Resource "'+I+'" does not end with App Id "'+S+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!P.startsWith("https://")&&!P.startsWith("api://"))return H.IOa('SSO Resource "'+I+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(S=0;S<I.length;S++){D=I.charAt(S);const G=A.a.charCodeAt(I,S);if(33>G||126<G||"&"===D||"?"===D||"#"===D||"%"===D||"\\"===D)return H.IOa('SSO Resource "'+I+'" contains an invalid character "'+D+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+D+"' in resource URI."),""}if(0<=I.indexOf("::"))return H.IOa('SSO Resource "'+I+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
I.length)return H.IOa('SSO Resource "'+I+'" is '+I.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+I.length+"."),"";P.startsWith("api://")&&(P="https://"+P.substring(6,P.length));return 8===P.length?"":OfficeExt.WACUtils.getHostSecure(P)||""}static Q5(I,S,P,D){var G=I.startTime;let E=0;0<G&&(E=H.vw()-G);G={["callInstanceId"]:G.toString(),["callDuration"]:E.toString(),["errorCode"]:S.toString()};if(D)for(let O in D)G[O]=
D[O];b.ULS.sendTraceTag(51401116,344,50,"{0}",G);z.a.sendTelemetryEvent(Object.assign(new C.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:t.a.ki(G)}));I.callback(S,P)}static vw(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(I){}return Date.now()}}H.k_e="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");H.Ma=null;Object(r.a)(H,
"AppsForOfficeSingleSignOnManager",null,[41])},885:function(r,B,a){a.d(B,"a",function(){return b});r=a(0);var c=a(14);class b{constructor(){this.DXe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.BXe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1633),c.a.instance.ga(1637)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1634),c.a.instance.ga(1638)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1635),c.a.instance.ga(1639)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1636),c.a.instance.ga(1640)]};this.oac=null}get qia(){return"SourceControlId"}get WM(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}F1h(){if(!this.oac){this.oac={};for(const e of Object.keys(this.DXe))this.oac[e]=this.DXe[e];for(const e of Object.keys(this.BXe))this.oac[e]=this.BXe[e][0]}}}Object(r.a)(b,"AddinCommandsStringProvider",null,[866])},888:function(r,B,a){a.d(B,"a",function(){return c});
r=a(0);class c{constructor(){this.BMa=0;this.Kha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.ugc=!1;this.Jff=this.Oia=null}}Object(r.a)(c,"AddInCommandsNotificationParameters",null,[])},958:function(r,B,a){r=a(0);var c=a(15),b=a(88),e=a(163),f=a(13),d=a(92);class h extends Sys.UI.Control{constructor(D,G,E,O){super(document.createElement("div"));this.KS=this.IS=this.Uv=this.zG=this.IG=this.gqa=this.Fra=null;this.ykb=this.Uqa=!1;this.content=this.Dp=null;this.i1=0;
this.Iye=null;this.TT=0;this.jLf=null;this.Rme=D;this.bie=G;this.nP=E;this.cH=O;this.hg=G.ownerDocument;this.Xfc=this.yt=this.Skb=!1}get dW(){this.Fra||(this.Fra=this.hg.createElement("div"),this.Fra.id=this.Oh("WACCalloutOuter"),this.Fra.className="WACCalloutOuter",this.Fra.setAttribute(d.a.Jd,d.a.D_a),this.Fra.style.width=this.i1+"px");return this.Fra}get Vqb(){if(!this.gqa){this.gqa=this.hg.createElement("div");this.gqa.id=this.Oh("WACCalloutBeakContainer");this.gqa.className="WACCalloutBeakContainer";
var D="CalloutBeakTopFilled_32x16x32";if(5===this.TT||6===this.TT||4===this.TT)D="CalloutBeakBottomFilled_32x16x32";D=e.createClusteredImage(32,16,D,"WACCalloutBeak",!0,"");this.gqa.appendChild(D)}return this.gqa}set Vqb(D){this.gqa=D}get fNa(){return this.Skb}get title(){return this.Dp}set title(D){this.Dp!==D&&(this.Dp=D,this.IS&&(this.IS.innerText=this.Dp))}get yt(){return this.Uqa}set yt(D){this.Uqa!==D&&(this.Uqa=D,this.IG&&(this.IG.contains(this.Uv)&&!this.Uqa?this.IG.removeChild(this.Uv):!this.IG.contains(this.Uv)&&
this.Uqa&&this.gqe()))}get Xfc(){return this.ykb}set Xfc(D){this.ykb!==D&&(this.ykb=D,this.IG&&(this.IG.contains(this.IS)&&!this.ykb?this.IG.removeChild(this.IS):!this.IG.contains(this.IS)&&this.ykb&&this.Dre()))}show(){this.Skb||(this.lgh(),this.sm(),this.bie.appendChild(this.dW),this.dW.style.display="Block",this.IGj(),this.Skb=!0,this.jLf&&this.jLf())}dismiss(){this.Skb&&(this.saa(),this.bie.removeChild(this.dW),this.Skb=!1,this.cH&&this.cH())}dispose(){this.dismiss();this.IS=this.Uv=this.zG=this.gqa=
this.IG=this.Fra=null;Sys.Component.prototype.dispose.call(this)}Oh(D){return this.get_element().id+D}lgh(){this.IG=this.hg.createElement("div");this.IG.id=this.Oh("WACCalloutHeader");this.IG.className="WACCalloutHeader";this.yt&&this.gqe();this.Xfc&&this.Dre();this.zG=this.hg.createElement("div");this.zG.id=this.Oh("WACCalloutContent");this.zG.className="WACCalloutContent";this.zG.style.width=190<this.i1?this.i1-26+"px":"164px";this.zG.appendChild(this.content);this.dW.appendChild(this.Vqb);this.dW.appendChild(this.IG);
this.dW.appendChild(this.zG)}gqe(){this.Uv=this.hg.createElement("a");this.Uv.className="WACCalloutCloseAnchor";this.Uv.id=this.Oh("WACCalloutCloseAnchor");this.Uv.href="#";this.IG.appendChild(this.Uv);const D=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Uv.appendChild(D)}Dre(){this.IS=this.hg.createElement("div");this.IS.className="WACCalloutTitle UIFontBold";this.IS.style.width=190<this.i1?this.i1-30+"px":"160px";this.IS.id=
this.Oh("WACCalloutTitle");this.IS.innerText=this.title;this.IG.contains(this.Uv)?this.IG.insertBefore(this.IS,this.Uv):this.IG.appendChild(this.IS)}IGj(){var D=this.Rme;let G;if(1===this.TT){var E=this.Iye.y+16;G=-16}else 2===this.TT||3===this.TT||0===this.TT?(E=D.y+D.height+15,G=-15):(E=D.y-this.dW.clientHeight-15-2,G=this.dW.clientHeight-1);this.dW.style.top=E+"px";this.Vqb.style.top=G+"px";1===this.TT?(D=this.Iye.x-16,this.dW.style.left="50%",this.dW.style.marginLeft=-this.i1/2+"px",E=Sys.UI.DomElement.getBounds(this.dW),
this.Vqb.style.left=D-E.x+"px"):(E=D.x+this.Rme.width/2,2===this.TT||5===this.TT?(D=20,E-=36):0===this.TT||4===this.TT?(D=this.i1/2-16,E-=this.i1/2):(D=this.i1-20-32,E=E-this.i1+36),this.dW.style.left=E+"px",this.Vqb.style.left=D+"px")}sm(){this.yt&&!this.KS&&(this.KS=Object(b.a)(this,this.N$,"closeHandler"),this.nP.ta(f.a.click,this.Uv,this.KS,null))}saa(){this.yt&&this.KS&&(this.nP.Aa(f.a.click,this.Uv,this.KS),this.KS=null)}N$(){this.dismiss();return!0}}Object(r.a)(h,"Callout",Sys.UI.Control,[605]);
class l extends h{constructor(D,G,E,O,N,J=null){super(D,E,N.fX,J);this.hge=0;this.i1=this.K1h(O);this.YYa=G;this.ff=N;this.aYj=7;this.Bl=this.YYa.ownerDocument.createElement("div");this.Bl.className="ModalCalloutControlOverlay";this.Bl.tabIndex=0;this.YYa.insertBefore(this.Bl,this.YYa.firstChild)}show(){this.fNa||(this.ff.ztc(),this.ff.JP(!1),this.Bl.style.zIndex=String(this.ff.n2),super.show(),this.Gj(),this.hge=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.aYj))}dismiss(){this.fNa&&
(this.ff.BM(!1),this.Xj(),this.YYa&&this.YYa.contains(this.Bl)&&this.YYa.removeChild(this.Bl),super.dismiss(),window.clearTimeout(this.hge))}Gj(){this.ff.Isa(Object(b.a)(this,this.dismiss,"dismiss"));this.ff.By.ta(f.a.click,this.Bl,Object(b.a)(this,this.jd,"onClick"))}Xj(){this.ff.idb(Object(b.a)(this,this.dismiss,"dismiss"));this.ff.By.Aa(f.a.click,this.Bl,Object(b.a)(this,this.jd,"onClick"))}jd(){this.dismiss();return!0}K1h(D){let G=0;switch(D){case 0:G=190;break;case 1:G=250;break;case 2:G=300;
break;case 3:G=360}return G}}Object(r.a)(l,"ModalCallout",h,[]);var k=a(464),w=a(183);class n extends l{constructor(D,G,E,O,N,J=null){super(D,G,E,O,N,J);this.WWb=null}show(){if(!this.fNa){const D=Object.assign(new k.a,{onShow:()=>{l.prototype.show.call(this)}});w.UISurfaces.xH().then(G=>{const E=G.externalNotification();this.WWb=G.addNotification(E,D);return null},G=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null})}}dismiss(){this.fNa&&this.WWb&&(w.UISurfaces.xH().then(D=>
{D.removeNotification(this.WWb);return this.WWb=null},D=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null}),super.dismiss())}}Object(r.a)(n,"ReactManagedModalCallout",l,[]);var x=a(4);class m{static Xhh(D,G,E){return x.AFrameworkApplication.sa.Qa.dR?new n(D,G,E,3,x.AFrameworkApplication.sa,null):new l(D,G,E,3,x.AFrameworkApplication.sa,null)}}Object(r.a)(m,"ModalCalloutControlFactory",null,[]);var u=a(56),t=a(883),y=a(591),v=a(884),A=a(141),z=a(57),C=a(41),
H=a(86),I=a(833),S=a(715);a.d(B,"a",function(){return P});class P{static get j2b(){return P.nfa||(P.nfa=H.a.instance.og("Common.Utils.IAriaNotifier"))}static UIe(D,G,E,O){P.eJ&&P.eJ.fNa&&P.eJ.dismiss();P.eJ=m.Xhh(G,D,D);P.eJ.content=E;S.b(O)||(P.eJ.title=O,P.eJ.Xfc=!0);D=new Sys.UI.Bounds(0,0,z.a.Rec(),z.a.Qec());P.eJ.TT=P.pUh(D,G,P.eJ.i1);P.eJ.show();P.j2b&&P.j2b.sendNotification(E.innerText,!0)}static J6c(D,G,E,O=null){w.UISurfaces.xH().then(N=>{let J=null;P.Omb&&(N.removeNotification(P.Omb),P.Omb=
null);const W=N.callout(Object.assign(new t.a,{target:D,title:G,content:E,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new v.a,{onDismiss:()=>{N.removeNotification(J)},directionalHint:null!=O?O:null})})),ea=Object.assign(new k.a,{expirationOptions:Object.assign(new y.a,{displayTimeoutSeconds:7,onExpire:()=>{N.removeNotification(P.Omb)}})});J=P.Omb=N.addNotification(W,ea);return null},N=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
N);return null})}static PVd(D,G=null){P.eJ&&P.eJ.fNa&&P.eJ.dismiss();const E=new A.StandardDialog;E.qTa=!1;E.Rb=0;E.Xz(u.a.WCi,CommonUIStrings.l_DialogError,S.b(D)?P.j4e():D,G)}static QVd(D){P.eJ&&P.eJ.fNa&&P.eJ.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",D.errorCode));const G=S.b(D.description)?P.j4e():D.description,E=new A.StandardDialog;let O=null;D.Kha?(E.Rb=1,E.wc(1,D.buttonText),E.C0(1)):E.Rb=0;O=N=>{1===N?D.Kha():D.Oia&&D.Oia()};
E.qTa=!1;0===D.BMa?E.Xz(D.errorCode,D.title?D.title:CommonUIStrings.l_DialogError,G,O):1===D.BMa?E.jS(D.title?D.title:CommonUIStrings.l_DialogWarning,G,O):E.Eoa(D.title?D.title:CommonUIStrings.l_DialogInfo,G,O)}static pUh(D,G,E){let O=4;const N=D.x+D.width-G.x-G.width;G.x-D.x+G.width/2<=E/2?O=5:N+G.width/2<=E/2&&(O=6);return O}static dNj(D,G,E,O=!1){(G=I.a.C4a(G))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(G,N=>{N&&(O||P.J6c(N,
E,D,5))})}static eNj(D,G,E=!1){P.dNj(G.startedNode?G.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,D),G,G.startedNode?G.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,D),E)}static cNj(D,G,E,O){if(P.gog)D=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,E,O,CommonUIStrings.l_InsertionDialogRefresh)),P.J6c(G,D,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{G=
C.a.ep(G);var N=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),J=document.createElement("span");J.innerText=N[0];var W=document.createElement("span");W.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,E,O,CommonUIStrings.l_InsertionDialogRefresh);W.className="UIFontBold";E=document.createElement("span");E.innerText=N[1];O=document.createElement("div");Sys.UI.DomElement.addCssClass(O,"ModalCalloutControl");O.appendChild(J);O.appendChild(W);O.appendChild(E);
P.UIe(D,G,O,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static wOj(D,G){var E=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,O=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;P.gog?P.J6c(G,E,O):(G=C.a.ep(G),P.UIe(D,G,P.d2g(O),E))}static d2g(D){const G=document.createElement("div");Sys.UI.DomElement.addCssClass(G,"ModalCalloutControl");G.innerText=D;return G}static j4e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get gog(){return x.AFrameworkApplication.sa.Qa.Ni&&
x.AFrameworkApplication.sa.Qa.dR}}P.eJ=null;P.Omb=null;P.nfa=null;Object(r.a)(P,"AddInCommandsNotificationFactory",null,[])},969:function(r,B,a){a.r(B);r=a(0);var c=a(15),b=a(1499),e=a(158),f=a(127),d=a(736),h=a(750),l=a(351);class k{constructor(u,t,y,v){this.lA=!1;this._id=u;this.sx=t;this.y1=y;this.Cd=v}get enabled(){return this.lA}set enabled(u){const {DynamicRibbon:t}=a(969);var y=this.Cd.OwnerAddinStoreType?this.Cd.OwnerAddinStoreType:this.Cd.PrimaryMarketplace.MarketplaceType;const v=this.Cd.PrimaryMarketplace.MarketplaceRef,
A=this.Cd.AssetMarketplace?this.Cd.AssetMarketplace.SolutionId:null,z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.sx,y,null,null,null,v);y={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Cd.OwnerAddinSolutionId,y,A,null,null,v),["ownerAddinStoreType"]:y,["ribbonControlType"]:"Button",["toggle"]:u};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:t.dDc+"ControlUpdate",dataFields:f.a.ki(y)}));this.lA=u;this.y1.kK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,
["SolutionId"]:this.sx,["PrivacyCompliantSolutionId"]:z,["SourceControlId"]:this.id,["MethodData"]:this.lA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(u){switch(u){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u,
t){switch(u){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertySetAsync(u,t){this.invokePropertySet(u,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,t){switch(u){case 5:return this.kDj(t);case 1:return this.vDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,t){u=this.invokeMethod(u,
t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}kDj(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setEnabled(u);return null}vDa(){this._OnAccess();return null}}Object(r.a)(k,"RibbonButton",null,[]);class w{constructor(u,t,y,v){this._id=u;this.sx=t;this.y1=y;this.Cd=v}get id(){return this._id}setVisibility(u){const {DynamicRibbon:t}=a(969),y=this.Cd.OwnerAddinStoreType?this.Cd.OwnerAddinStoreType:this.Cd.PrimaryMarketplace.MarketplaceType;
var v=this.Cd.PrimaryMarketplace.MarketplaceRef;const A=this.Cd.AssetMarketplace?this.Cd.AssetMarketplace.SolutionId:null,z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.sx,y,A,null,null,v);v={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Cd.OwnerAddinSolutionId,y,A,null,null,v),["ownerAddinStoreType"]:y,["ribbonControlType"]:"Tab",["toggle"]:u};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:t.dDc+"ControlUpdate",dataFields:f.a.ki(v)}));this.y1.kK(-1014260128,
{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.sx,["PrivacyCompliantSolutionId"]:z,["StoreType"]:y,["SourceControlId"]:this.id,["MethodData"]:u})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(u){switch(u){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertySetAsync(u,t){this.invokePropertySet(u,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,t){switch(u){case 3:return this.oHj(t);case 1:return this.vDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,t){u=this.invokeMethod(u,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}oHj(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setVisibility(u);
return null}vDa(){this._OnAccess();return null}}Object(r.a)(w,"RibbonTab",null,[]);var n=a(996),x=a(185);a.d(B,"DynamicRibbon",function(){return m});class m{constructor(u,t,y,v,A){this.sx=u;this.BG=y;this.y1=v;this.Cd=A;this.bjb=this.BG.Lg;this.Ky=this.bjb.getOsfControl(t);this.yDg=this.Ky.getManifest()}get buttons(){return null}executeRequestCreate(u){try{var t=this.Cd.OwnerAddinStoreType?this.Cd.OwnerAddinStoreType:this.Cd.PrimaryMarketplace.MarketplaceType;const v=this.Cd.PrimaryMarketplace.MarketplaceRef,
A=this.Cd.AssetMarketplace?this.Cd.AssetMarketplace.SolutionId:null;var y=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.sx,t,A,null,null,v);const z={["addinSolutionId"]:y,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Cd.OwnerAddinSolutionId,t,A,null,null,v),["ownerAddinStoreType"]:this.Cd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:m.dDc+"ExecuteRequestCreate",dataFields:f.a.ki(z)}));const C=x.a.Yh(u);u={};
t={};t[d.a.LJa]=this.Ky;t[d.a.MJa]=C;t[d.a.P$c]=this.Cd;u[d.a.cvb]=3;u[d.a.G3]=this.sx;u[d.a.S9b]=y;u[d.a.E3]=t;this.y1.kK(-1014260128,u);let H=m.ucc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,H)}catch(v){y=m.ucc("ExecuteRequestCreate",!1,v.toString()),c.ULS.sendTraceTag(538572825,0,50,y)}return null}executeRequestUpdate(u){try{var t=this.Cd.OwnerAddinStoreType?this.Cd.OwnerAddinStoreType:this.Cd.PrimaryMarketplace.MarketplaceType;const v=this.Cd.PrimaryMarketplace.MarketplaceRef,
A=this.Cd.AssetMarketplace?this.Cd.AssetMarketplace.SolutionId:null;var y=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.sx,t,A,null,null,v);const z={["addinSolutionId"]:y,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Cd.OwnerAddinSolutionId,t,A,null,null,v),["ownerAddinStoreType"]:this.Cd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:m.dDc+"ExecuteRequestUpdate",dataFields:f.a.ki(z)}));const C=x.a.Yh(u);u={};
t={};t[d.a.LJa]=this.Ky;t[d.a.MJa]=C;t[d.a.P$c]=this.Cd;u[d.a.cvb]=3;u[d.a.G3]=this.sx;u[d.a.S9b]=y;u[d.a.E3]=t;this.y1.kK(-1014260128,u);let H=m.ucc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,H)}catch(v){y=m.ucc("ExecuteRequestUpdate",!1,v.toString()),c.ULS.sendTraceTag(538572823,0,50,y)}return null}getButton(u){let t=null;if(!this.kkf())return this.XIe();if(u&&0<u.length){if(!this.QDe(u))return this.oJe(u);t=new k(u,this.sx,this.y1,this.Cd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}getTab(u){let t=
null;if(!this.kkf())return this.XIe();if(this.Ky.getOwnerAddinControlRecreated())return this.jhh();if(u&&0<u.length){if(!this.QDe(u))return this.oJe(u);t=new w(u,this.sx,this.y1,this.Cd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(u){switch(u){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertySetAsync(u,t){this.invokePropertySet(u,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u){switch(u){case 1:return this.vDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,t){switch(u){case 7:return this.NHh(t);case 6:return this.OHh(t);case 3:return this.VTh(t);
case 5:return this.D8h(t)}u=this.invokeMethod(u,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}NHh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestCreate(u)}OHh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestUpdate(u)}VTh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getButton(u)}D8h(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,
0,"string");return this.getTab(u)}vDa(){this._OnAccess();return null}oJe(u){return n.a(h.a.Hch,x.a.ga(1771)+u)}XIe(){return n.a(h.a.bvj,x.a.ga(1767))}jhh(){return n.a(h.a.hostRestartNeeded,x.a.ga(1772))}kkf(){var u=this.Ky.getSharedRuntimeId();u=!!u&&0<u.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",u));return u}QDe(u){const t=this.yDg.getRibbonExtensionControlMap();return u in t||this.Z6g(u)}Z6g(u){var t=this.nLh();if(t){t=t.lQe;
for(const y of t.tabs){if(y.id===u)return!0;for(const v of y.groups)for(const A of v.controls){if(A.id===u)return!0;if("Menu"===A.type){t=A;for(const z of t.items)if(z.id===u)return!0}}}}return!1}nLh(){return b.a.getInstance().sja(this.Cd.PrimaryMarketplace.MarketplaceType,this.Cd.PrimaryMarketplace.SolutionId,1)}static ucc(u,t,y){const v={};v.methodName="DynamicRibbon."+u;v.result=t?"Succeeded":"Failed";v.message=y;return x.a.Ec(v)}}m.dDc="Office.Online.Extensibility.Ribbon.";Object(r.a)(m,"DynamicRibbon",
null,[])},980:function(r,B,a){a.d(B,"a",function(){return b});var c=a(981);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},986:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);var c;(function(b){b[b.myAddins=0]="myAddins";b[b.adminManaged=1]="adminManaged";b[b.popular=2]="popular"})(c||(c={}));Object(r.b)("AddinCollectionType",c)},989:function(r,B,a){a.d(B,"a",function(){return c});const c=(b,e)=>{let f=
!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},990:function(r,B,a){a.d(B,"a",function(){return c});r=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.xha=this.tUa=this.Eid=this.Xkd=this.Ryb=this.GZd=null}}Object(r.a)(c,"AppsForOfficeOauthResult",null,[])},996:function(r,B,a){a.d(B,"a",function(){return c});const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((f,d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,
e))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/4efcbbd423c7f73a44e30716c023ab2d/EwaDSEsNext.agave.js.map