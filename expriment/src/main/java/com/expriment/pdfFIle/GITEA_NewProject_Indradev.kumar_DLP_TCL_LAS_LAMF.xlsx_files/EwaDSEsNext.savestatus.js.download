'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1236:function(r,B,a){r=a(0);var c=a(88),b=a(15),e=a(140),f=a(41);class d{constructor(A){this.uga=this.oga=this.yga=this.xga=null;this.Xae=this.see=this.px=this.ML=!1;this.eTc=this.Kee=null;this.Bee=0;this.fb=this.Hee=null;this.D1=A;this.gA=3;this.Qkb=!0}initialize(A,z,C){this.xga=this.dkd(A,z);this.yga=CommonUIStrings.l_SavingStatus;this.oga=CommonUIStrings.l_ReadOnlyStatus;this.uga=CommonUIStrings.l_ReviewModeStatus;
this.D1&&this.D1.execute(H=>{H.PYc(Object(c.a)(this,this.lRb,"updateToSavingStatus"))});this.px=!0;this.fb=C;return!0}Yea(A,z){this.ML=A;this.gA=z;this.uS(this.Qkb)}uS(A){!this.Qkb&&A&&(this.Hee=new Date);this.Qkb=A;A=null;3===this.gA&&(A=this.Qkb?this.xga:this.yga);this.Yqh(A)}dkd(A,z){return A?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):z&&z.length?String.format(CommonUIStrings.l_SavedToStatus,z):CommonUIStrings.l_SavedStatus}lRb(){this.uS(!1)}L1h(){switch(this.gA){case 1:return this.oga;
case 2:return this.uga;default:return null}}ksi(A){return this.see===this.ML&&this.Bee===this.gA&&this.Kee===A}d$c(A){appChrome.getHeaderApi().then(z=>{z.updateDocumentTitleStatus(this.ML,A,this.L1h(),this.Hee,this.Qkb);this.Xae=!0;return null});this.eTc=null}Yqh(A){this.px&&e.c()&&!this.ksi(A)&&(!this.Xae&&this.fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.d$c(A):f.a.YOd()?(this.eTc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.eTc=window.requestIdleCallback(()=>{this.d$c(A)})):window.requestAnimationFrame(()=>{this.d$c(A)}),this.see=this.ML,this.Kee=A,this.Bee=this.gA)}}Object(r.a)(d,"ReactSaveStatusUIHandler",null,[558]);var h=a(172);class l{constructor(A,z){this.ns=null;this.xga=CommonUIStrings.l_SavedStatus;this.yga=CommonUIStrings.l_SavingStatus;this.oga=CommonUIStrings.l_ReadOnlyStatus;this.uga=CommonUIStrings.l_ReviewModeStatus;this.oVb=z;this.D1=A;this.gA=3;this.Vra=!0}Nt(){this.D1&&this.D1.execute(A=>{A.PYc(Object(c.a)(this,
this.lRb,"updateToSavingStatus"))});this.oVb.execute(A=>{this.ns=A})}Yea(A,z){this.gA=z;3===z?this.uS(this.Vra):2===z?this.J0d(this.uga):this.J0d(this.oga)}lRb(){this.uS(!1)}uS(A){this.Vra=A;this.J0d(this.Vra?this.xga:this.yga)}J0d(A){this.ns&&this.ns.uj(h.a.E1j,this.Mbh(A))}Mbh(A){const z={};z.StatusText=A;return z}}Object(r.a)(l,"SaveStatusPostMessageHandler",null,[558]);var k=a(94),w=a(130),n=a(57);class x{constructor(A,z,C,H){this.uga=this.oga=this.yga=this.xga=null;this.iFa=0;this.mE=this.STc=
this.ADa=this.zIc=this.hGa=null;this.Sd=A;this.V8=z;this.D1=C;this.fj=H;this.Lce=!0;this.ML=!1;this.gA=3;this.Vra=!0}initialize(A,z){if(!this.Sd)return!1;this.xga=this.dkd(A,z);this.yga=CommonUIStrings.l_SavingStatus;this.oga=CommonUIStrings.l_ReadOnlyStatus;this.uga=CommonUIStrings.l_ReviewModeStatus;this.Nt();return!0}dkd(A,z){return A?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):z&&z.length?String.format(CommonUIStrings.l_SavedToStatus,z):CommonUIStrings.l_SavedStatus}Nt(){this.V8&&
this.V8.execute(A=>{A.oRg(Object(c.a)(this,this.$Ke,"createStatusAndModeElements"));A.hRg(Object(c.a)(this,this.dOj,"showHideSaveStatusElement"));A.lZj&&this.$Ke(null,null)});this.D1&&this.D1.execute(A=>{A.PYc(Object(c.a)(this,this.lRb,"updateToSavingStatus"))})}Rv(){this.mE&&this.Sd&&this.Sd.qG(this.mE)}dOj(A,z){this.Yea("true"===z,this.gA)}Yea(A,z){this.ML=A;this.gA=z;this.zIc&&(this.zIc.style.display=this.ML||3===this.gA||!this.hGa?"none":"");this.ADa&&(this.ADa.style.display=this.ML||3===this.gA?
"none":"",this.ADa.innerText=1===this.gA?this.oga:this.uga,this.ADa.title=1===this.gA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.STc&&(this.STc.style.display=this.ML||1===this.gA||!this.hGa&&!this.ADa?"none":"");this.mE&&(this.mE.style.display=this.ML||1===this.gA?"none":"",this.uS(this.Vra),this.mE.title=CommonUIStrings.l_SaveStatusTooltip)}$Ke(A,z){A=document.getElementById(k.CuiHelper.Odf);z&&z.Qak||!A||""===this.xga||""===this.yga||""===this.oga||""===
this.uga||(this.hGa=document.getElementById(k.CuiHelper.j3b),this.zIc=k.CuiHelper.Wta(A,"BreadcrumbAppModeDash","-",null,!1),this.ADa=k.CuiHelper.Wta(A,"BreadcrumbAppModeStatus",1===this.gA?this.oga:this.uga,null,!1),this.lmg(this.ADa),this.STc=k.CuiHelper.Wta(A,"BreadcrumbSaveStatusDash","-",null,!1),this.mE=k.CuiHelper.Wta(A,"BreadcrumbSaveStatus",this.xga,null,!1),this.lmg(this.mE),this.Yea(this.ML,this.gA))}lRb(){this.uS(!1)}uS(A){this.Vra=A;this.U6j(this.Vra?this.xga:this.yga)}U6j(A){!this.mE||
3!==this.gA&&2!==this.gA||(this.Lce&&!this.Vra?(this.iFa=this.mE.offsetWidth<this.iFa?this.iFa:this.mE.offsetWidth,this.L3j(this.yga),this.Lce=!1):this.mE.innerText=A)}lmg(A){A.style.direction=this.fj?"rtl":"ltr";A.style.width="auto";A.style.textAlign=this.fj?"right":"left";A.style.display=this.ML?"none":"";A.setAttribute("Unselectable","on")}L3j(A){this.mE&&(this.mE.style.width="",this.mE.innerText=A,this.iFa=this.mE.offsetWidth<this.iFa?this.iFa:this.mE.offsetWidth,A=w.a.TA(this.mE),this.mE.style.width=
this.iFa-n.a.zD(A.paddingLeft)-n.a.zD(A.paddingRight)+1+"px")}}Object(r.a)(x,"SaveStatusUIHandler",null,[558]);var m=a(4),u=a(98);class t{constructor(){this.TTc=this.RSc=this.inb=this.$a=null}get name(){return"Common.App.SaveStatus"}Kh(A){this.$a=A;m.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&m.AFrameworkApplication.hideHeaderEmbedded?this.$a.register(l,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Bc(()=>new l(this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"),
this.$a.Tb("Postmessage.IHostPostmessenger"))):m.AFrameworkApplication.sa.Qa.Xof||(m.AFrameworkApplication.sa.Qa.Bu?this.$a.register(d,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Bc(()=>new d(this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"))):this.$a.register(x,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").tc().Bc(()=>new x(u.EventHandlerManager.instance,this.$a.Tb("Common.App.Header.HeaderEventSource"),
this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"),m.AFrameworkApplication.isRtl)))}init(){m.AFrameworkApplication.fa.zu(Object(c.a)(this,this.mB,"onFullAppSettingsReady"))}mB(){const A=m.AFrameworkApplication.fa,z=!!m.AFrameworkApplication.sa.Qa&&4===m.AFrameworkApplication.sa.Qa.ri;if(A.qa("WordEditorAutoSaveImprovementIsEnabled")||A.qa("PptEditorSaveStatusInHeaderEnabled")||z&&A.qa("SimplifiedReactRibbonUxIsEnabled")||A.qa("ExcelSaveStatusInHeaderEnabled")||A.qa("VisioSaveStatusInHeaderEnabled"))m.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&
m.AFrameworkApplication.hideHeaderEmbedded?(this.TTc=this.$a.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.TTc.Nt():m.AFrameworkApplication.sa.Qa.Xof||A.qa("PreventSaveStatusInitializationWithHiddenHeader")&&m.AFrameworkApplication.hideHeader||(m.AFrameworkApplication.sa.Qa.Bu?(this.RSc=this.$a.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.RSc.initialize(A.qa("IsSkyDrive"),A.Wa("HostNameToIncludeInSavedStatus"),m.AFrameworkApplication.fa):(this.inb=this.$a.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.inb.initialize(A.qa("IsSkyDrive"),A.Wa("HostNameToIncludeInSavedStatus")))}dispose(){this.inb&&this.inb.Rv()}}Object(r.a)(t,"PackageManager",null,[4,5]);var y=a(257);a.d(B,"a",function(){return v});const v=()=>{Type.registerNamespace("Common.App.SaveStatus");y.a.instance.si(new t)}},1289:function(r,B,a){var c=a(9);r=a(0);var b=a(86),e=a(228),f=a(231),d=a(29),h=a(21);class l{constructor(x,m){this.Cke=this.eOc=!1;this.Kza=(u,t)=>{(null===t||void 0===t?0:t.jH)&&d.a.uWg([t.jH])&&(this.qMb=!0)};this.Io=
()=>{this.qMb=!1};this.Wc=(u,t)=>{f.b(t)&&this.Yea(!0);this.qMb=!1};this.od=()=>{this.ZM=this.$.ZM;this.Yea()};this.eKf=()=>{this.uS()};this.iJf=()=>{this.ZM=this.$.ZM};this.ODd=()=>{h.h(this.$).Ca.Xw(this.ODd);this.ZM=this.$.ZM};this.O3f=m;this.$=x;this.$.userOperationManager.jr(this.iJf);this.$.hl(this.od);this.$.ea.PRg(this.eKf);this.$.ea.Oj(this.Wc);this.$.S0b(this.Kza);this.$.ea.ZL(this.Io);this.Yea()}get NCi(){return this.$.ea?this.$.ea.Jrf:!1}get ZM(){return this.eOc}set ZM(x){x?this.eOc=!0:
h.h(this.$)&&h.h(this.$).Ca&&(h.h(this.$).Ca.R4()?this.eOc=!1:h.h(this.$).Ca.dw(this.ODd));this.uS()}get qMb(){return this.Cke}set qMb(x){this.Cke=x;this.uS()}dispose(){this.$&&(this.$.em(this.od),this.$.Xvc(this.Kza),this.$.userOperationManager&&this.$.userOperationManager.ao(this.iJf),this.$.ea&&(this.$.ea.$pj(this.eKf),this.$.ea.pk(this.Wc),this.$.ea.MR(this.Io)),h.h(this.$)&&h.h(this.$).Ca&&h.h(this.$).Ca.Xw(this.ODd))}Yea(x=!1){x=!this.$.isEditMode||x;this.O3f.Yea(x,this.$.isEditMode?3:1);this.uS()}uS(){this.$.isEditMode&&
this.O3f.uS(!this.ZM&&!this.NCi&&!this.qMb)}}Object(r.a)(l,"SaveStatusManager",null,[3]);var k=a(717);class w extends e.a{constructor(x){super();this.Uc=x;this.Gb()}create(){const x=b.a.instance;x.Tb("Common.App.SaveStatus.ISaveStatusUIHandler").execute(m=>{const u=new l(this.Uc,m);x.register(l,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").tc().Bc(()=>u);m=Object(k.a)(this.Uc.da,300,()=>x.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.qb(m)})}static la(x){x.da.Ha(299,
new w(x))}}Object(r.a)(w,"SaveStatusFactory",e.a,[]);a.d(B,"a",function(){return n});const n=()=>{c.a.Fa(w.la)}},1436:function(r,B,a){a.r(B);r=a(1236);a=a(1289);Type.registerNamespace("_Ewa");Object(r.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/f8c37073498d6f66d1297fd4ad34c351/EwaDSEsNext.savestatus.js.map